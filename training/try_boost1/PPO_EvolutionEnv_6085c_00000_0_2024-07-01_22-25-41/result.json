{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0727411976320167, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.042350426966897, "policy_loss": -0.01400165593695923, "vf_loss": 4.053910422985292, "vf_explained_var": -0.0006695212076266352, "kl": 0.012208301712373283, "entropy": 2.2900292312756134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 4695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -75.0, "episode_reward_min": -949.0, "episode_reward_mean": -418.55555555555554, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 3618, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -41.855555555555554}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160.0, -97.0, -730.0, -859.0, -157.0, -316.0, -725.0, -728.0, -949.0, -485.0, -306.0, -142.0, -375.0, -75.0, -383.0, -581.0, -263.0, -203.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -120.0, 0.0, 0.0, 0.0, 10.0, -60.0, 0.0, 0.0, 10.0, 10.0, 3.0, -1.0, -9.0, 0.0, 10.0, 20.0, 10.0, -140.0, 0.0, -210.0, 0.0, 0.0, -135.0, -135.0, -60.0, -135.0, -55.0, 0.0, 0.0, -165.0, 0.0, -62.0, -100.0, -10.0, -2.0, 0.0, -170.0, -350.0, 0.0, 11.0, -65.0, -70.0, 10.0, -3.0, -3.0, 1.0, 8.0, -1.0, -45.0, -115.0, 0.0, 10.0, 0.0, -65.0, 40.0, -6.0, -60.0, 0.0, -120.0, 0.0, 0.0, -295.0, 0.0, -230.0, -45.0, -90.0, -75.0, 0.0, 10.0, -160.0, -45.0, -206.0, 0.0, 0.0, 0.0, -160.0, -177.0, 0.0, 20.0, -100.0, -70.0, -165.0, 0.0, -120.0, -104.0, 0.0, -390.0, 0.0, 0.0, 10.0, 0.0, -5.0, -295.0, -65.0, -57.0, 10.0, 10.0, -103.0, 10.0, 7.0, 0.0, -300.0, 0.0, -2.0, 20.0, 0.0, -1.0, 10.0, -40.0, 29.0, 20.0, -100.0, 40.0, 0.0, -65.0, 0.0, 10.0, -75.0, -1.0, -155.0, -115.0, -2.0, 0.0, -1.0, 24.0, -70.0, 5.0, -6.0, -55.0, 0.0, 0.0, 5.0, 5.0, -105.0, 20.0, 16.0, -35.0, 19.0, 0.0, 0.0, 10.0, 9.0, -165.0, 0.0, 19.0, 0.0, -81.0, 0.0, -175.0, 0.0, 18.0, -60.0, 0.0, -183.0, -151.0, -180.0, -15.0, 0.0, -10.0, -1.0, 20.0, -40.0, 0.0, 5.0, -116.0, 3.0, -25.0, -139.0, 30.0, 10.0, 10.0, 20.0, 0.0, -8.0, 20.0, 0.0, -80.0, -185.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2896460196692168, "mean_inference_ms": 2.3254241003315617, "mean_action_processing_ms": 0.8833342745655643, "mean_env_wait_ms": 1.8558316162621153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07383028666178386, "StateBufferConnector_ms": 0.015450848473442925, "ViewRequirementAgentConnector_ms": 0.6578498416476779}, "num_episodes": 18, "episode_return_max": -75.0, "episode_return_min": -949.0, "episode_return_mean": -418.55555555555554, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 23.800912972370718, "num_env_steps_trained_throughput_per_sec": 23.800912972370718, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 168060.791, "restore_workers_time_ms": 0.022, "training_step_time_ms": 168060.728, "sample_time_ms": 3961.978, "learn_time_ms": 164076.288, "learn_throughput": 24.379, "synch_weights_time_ms": 17.676}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "6085c_00000", "date": "2024-07-01_22-28-39", "timestamp": 1719887319, "time_this_iter_s": 168.18805503845215, "time_total_s": 168.18805503845215, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.18805503845215, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.920920502092045, "ram_util_percent": 82.43765690376569}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.030111210992415, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5394899102318655, "policy_loss": -0.007763101895393345, "vf_loss": 2.546020213217019, "vf_explained_var": -0.0032770539244142967, "kl": 0.006163980710601013, "entropy": 2.2811617476236834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 14085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 90.0, "episode_reward_min": -949.0, "episode_reward_mean": -251.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 7236, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -25.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160.0, -97.0, -730.0, -859.0, -157.0, -316.0, -725.0, -728.0, -949.0, -485.0, -306.0, -142.0, -375.0, -75.0, -383.0, -581.0, -263.0, -203.0, -254.0, -24.0, -16.0, 90.0, -106.0, 79.0, -258.0, -39.0, -85.0, -142.0, -158.0, -112.0, -254.0, 0.0, -51.0, 22.0, -225.0, 22.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -120.0, 0.0, 0.0, 0.0, 10.0, -60.0, 0.0, 0.0, 10.0, 10.0, 3.0, -1.0, -9.0, 0.0, 10.0, 20.0, 10.0, -140.0, 0.0, -210.0, 0.0, 0.0, -135.0, -135.0, -60.0, -135.0, -55.0, 0.0, 0.0, -165.0, 0.0, -62.0, -100.0, -10.0, -2.0, 0.0, -170.0, -350.0, 0.0, 11.0, -65.0, -70.0, 10.0, -3.0, -3.0, 1.0, 8.0, -1.0, -45.0, -115.0, 0.0, 10.0, 0.0, -65.0, 40.0, -6.0, -60.0, 0.0, -120.0, 0.0, 0.0, -295.0, 0.0, -230.0, -45.0, -90.0, -75.0, 0.0, 10.0, -160.0, -45.0, -206.0, 0.0, 0.0, 0.0, -160.0, -177.0, 0.0, 20.0, -100.0, -70.0, -165.0, 0.0, -120.0, -104.0, 0.0, -390.0, 0.0, 0.0, 10.0, 0.0, -5.0, -295.0, -65.0, -57.0, 10.0, 10.0, -103.0, 10.0, 7.0, 0.0, -300.0, 0.0, -2.0, 20.0, 0.0, -1.0, 10.0, -40.0, 29.0, 20.0, -100.0, 40.0, 0.0, -65.0, 0.0, 10.0, -75.0, -1.0, -155.0, -115.0, -2.0, 0.0, -1.0, 24.0, -70.0, 5.0, -6.0, -55.0, 0.0, 0.0, 5.0, 5.0, -105.0, 20.0, 16.0, -35.0, 19.0, 0.0, 0.0, 10.0, 9.0, -165.0, 0.0, 19.0, 0.0, -81.0, 0.0, -175.0, 0.0, 18.0, -60.0, 0.0, -183.0, -151.0, -180.0, -15.0, 0.0, -10.0, -1.0, 20.0, -40.0, 0.0, 5.0, -116.0, 3.0, -25.0, -139.0, 30.0, 10.0, 10.0, 20.0, 0.0, -8.0, 20.0, 0.0, -80.0, -185.0, 10.0, -5.0, -8.0, -190.0, -20.0, -1.0, -5.0, 20.0, -4.0, -1.0, -40.0, 10.0, 7.0, 0.0, -13.0, 13.0, -3.0, -18.0, -20.0, 0.0, 0.0, 10.0, 10.0, 8.0, -4.0, 0.0, 0.0, -45.0, 7.0, -2.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, -5.0, 10.0, 0.0, 10.0, 0.0, 0.0, -41.0, -115.0, 20.0, 15.0, 0.0, 10.0, -20.0, 30.0, 0.0, 9.0, 0.0, 0.0, 40.0, 10.0, 0.0, -45.0, -35.0, 9.0, -15.0, 0.0, -2.0, 0.0, -170.0, 0.0, -19.0, -5.0, 10.0, 0.0, 13.0, 15.0, 13.0, 10.0, -86.0, 10.0, 0.0, -2.0, -35.0, -2.0, -11.0, -40.0, -5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, -75.0, 0.0, 0.0, 15.0, -75.0, -6.0, -11.0, -35.0, 10.0, 0.0, 0.0, 0.0, -7.0, -30.0, 0.0, -90.0, -6.0, 0.0, 0.0, 0.0, -2.0, 0.0, -5.0, -125.0, 0.0, 20.0, 0.0, -67.0, 0.0, -55.0, -115.0, 0.0, -7.0, 0.0, 5.0, -15.0, 0.0, -3.0, 20.0, 10.0, -30.0, -3.0, 7.0, 0.0, 6.0, -3.0, -4.0, 0.0, -1.0, -5.0, -23.0, 0.0, -1.0, -20.0, -11.0, 0.0, 10.0, -10.0, 0.0, -10.0, -8.0, 20.0, -4.0, -6.0, 20.0, 10.0, 10.0, -115.0, 10.0, 0.0, 10.0, -60.0, 0.0, 20.0, 0.0, -85.0, -5.0, 5.0, 7.0, 0.0, 0.0, 5.0, -2.0, 0.0, -11.0, 0.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.861698318646709, "mean_inference_ms": 3.0835475885682584, "mean_action_processing_ms": 1.0453938698369312, "mean_env_wait_ms": 2.2635091613771015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.17192761103312174, "StateBufferConnector_ms": 0.015285280015733507, "ViewRequirementAgentConnector_ms": 1.2622462378607855}, "num_episodes": 18, "episode_return_max": 90.0, "episode_return_min": -949.0, "episode_return_mean": -251.25, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 23.908570017125054, "num_env_steps_trained_throughput_per_sec": 23.908570017125054, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 167682.412, "restore_workers_time_ms": 0.019, "training_step_time_ms": 167682.356, "sample_time_ms": 6412.859, "learn_time_ms": 161248.158, "learn_throughput": 24.806, "synch_weights_time_ms": 16.087}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "6085c_00000", "date": "2024-07-01_22-31-27", "timestamp": 1719887487, "time_this_iter_s": 167.43094110488892, "time_total_s": 335.61899614334106, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2338820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 335.61899614334106, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.60084745762712, "ram_util_percent": 82.78389830508475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.193126920167123, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.344584108186098, "policy_loss": -0.0020341271099399406, "vf_loss": 2.345773582349316, "vf_explained_var": 0.023245221592239934, "kl": 0.004223258141685497, "entropy": 2.2851906065234995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 23475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 90.0, "episode_reward_min": -949.0, "episode_reward_mean": -162.64814814814815, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 10854, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -16.264814814814816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160.0, -97.0, -730.0, -859.0, -157.0, -316.0, -725.0, -728.0, -949.0, -485.0, -306.0, -142.0, -375.0, -75.0, -383.0, -581.0, -263.0, -203.0, -254.0, -24.0, -16.0, 90.0, -106.0, 79.0, -258.0, -39.0, -85.0, -142.0, -158.0, -112.0, -254.0, 0.0, -51.0, 22.0, -225.0, 22.0, 1.0, 8.0, 63.0, 58.0, -3.0, 13.0, 34.0, 24.0, 22.0, 35.0, -32.0, -10.0, -29.0, 12.0, 24.0, 45.0, -7.0, 4.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -120.0, 0.0, 0.0, 0.0, 10.0, -60.0, 0.0, 0.0, 10.0, 10.0, 3.0, -1.0, -9.0, 0.0, 10.0, 20.0, 10.0, -140.0, 0.0, -210.0, 0.0, 0.0, -135.0, -135.0, -60.0, -135.0, -55.0, 0.0, 0.0, -165.0, 0.0, -62.0, -100.0, -10.0, -2.0, 0.0, -170.0, -350.0, 0.0, 11.0, -65.0, -70.0, 10.0, -3.0, -3.0, 1.0, 8.0, -1.0, -45.0, -115.0, 0.0, 10.0, 0.0, -65.0, 40.0, -6.0, -60.0, 0.0, -120.0, 0.0, 0.0, -295.0, 0.0, -230.0, -45.0, -90.0, -75.0, 0.0, 10.0, -160.0, -45.0, -206.0, 0.0, 0.0, 0.0, -160.0, -177.0, 0.0, 20.0, -100.0, -70.0, -165.0, 0.0, -120.0, -104.0, 0.0, -390.0, 0.0, 0.0, 10.0, 0.0, -5.0, -295.0, -65.0, -57.0, 10.0, 10.0, -103.0, 10.0, 7.0, 0.0, -300.0, 0.0, -2.0, 20.0, 0.0, -1.0, 10.0, -40.0, 29.0, 20.0, -100.0, 40.0, 0.0, -65.0, 0.0, 10.0, -75.0, -1.0, -155.0, -115.0, -2.0, 0.0, -1.0, 24.0, -70.0, 5.0, -6.0, -55.0, 0.0, 0.0, 5.0, 5.0, -105.0, 20.0, 16.0, -35.0, 19.0, 0.0, 0.0, 10.0, 9.0, -165.0, 0.0, 19.0, 0.0, -81.0, 0.0, -175.0, 0.0, 18.0, -60.0, 0.0, -183.0, -151.0, -180.0, -15.0, 0.0, -10.0, -1.0, 20.0, -40.0, 0.0, 5.0, -116.0, 3.0, -25.0, -139.0, 30.0, 10.0, 10.0, 20.0, 0.0, -8.0, 20.0, 0.0, -80.0, -185.0, 10.0, -5.0, -8.0, -190.0, -20.0, -1.0, -5.0, 20.0, -4.0, -1.0, -40.0, 10.0, 7.0, 0.0, -13.0, 13.0, -3.0, -18.0, -20.0, 0.0, 0.0, 10.0, 10.0, 8.0, -4.0, 0.0, 0.0, -45.0, 7.0, -2.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, -5.0, 10.0, 0.0, 10.0, 0.0, 0.0, -41.0, -115.0, 20.0, 15.0, 0.0, 10.0, -20.0, 30.0, 0.0, 9.0, 0.0, 0.0, 40.0, 10.0, 0.0, -45.0, -35.0, 9.0, -15.0, 0.0, -2.0, 0.0, -170.0, 0.0, -19.0, -5.0, 10.0, 0.0, 13.0, 15.0, 13.0, 10.0, -86.0, 10.0, 0.0, -2.0, -35.0, -2.0, -11.0, -40.0, -5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, -75.0, 0.0, 0.0, 15.0, -75.0, -6.0, -11.0, -35.0, 10.0, 0.0, 0.0, 0.0, -7.0, -30.0, 0.0, -90.0, -6.0, 0.0, 0.0, 0.0, -2.0, 0.0, -5.0, -125.0, 0.0, 20.0, 0.0, -67.0, 0.0, -55.0, -115.0, 0.0, -7.0, 0.0, 5.0, -15.0, 0.0, -3.0, 20.0, 10.0, -30.0, -3.0, 7.0, 0.0, 6.0, -3.0, -4.0, 0.0, -1.0, -5.0, -23.0, 0.0, -1.0, -20.0, -11.0, 0.0, 10.0, -10.0, 0.0, -10.0, -8.0, 20.0, -4.0, -6.0, 20.0, 10.0, 10.0, -115.0, 10.0, 0.0, 10.0, -60.0, 0.0, 20.0, 0.0, -85.0, -5.0, 5.0, 7.0, 0.0, 0.0, 5.0, -2.0, 0.0, -11.0, 0.0, 18.0, -4.0, 10.0, 5.0, 0.0, -3.0, -7.0, 0.0, -5.0, 10.0, -5.0, 9.0, 0.0, -11.0, -1.0, -5.0, -1.0, 10.0, 10.0, 10.0, -13.0, -8.0, 30.0, 10.0, 0.0, 10.0, 3.0, -1.0, 0.0, 19.0, 0.0, 30.0, 0.0, -9.0, -2.0, 0.0, 7.0, -4.0, 20.0, -1.0, 17.0, 0.0, 0.0, 20.0, -39.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, -8.0, 19.0, 10.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -5.0, 20.0, 0.0, 0.0, -4.0, -1.0, 10.0, 18.0, 0.0, -4.0, 0.0, -2.0, 0.0, 0.0, 30.0, -2.0, 0.0, -7.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, -15.0, 8.0, 9.0, 0.0, 0.0, 0.0, 10.0, 5.0, -2.0, 10.0, -2.0, 10.0, 0.0, -1.0, 5.0, -9.0, -2.0, 0.0, -2.0, -40.0, 20.0, 10.0, 0.0, -9.0, 0.0, 10.0, 20.0, -14.0, 16.0, -9.0, -6.0, -4.0, -10.0, -13.0, 0.0, 0.0, -12.0, 10.0, 0.0, 0.0, -20.0, -14.0, 10.0, -3.0, 0.0, -1.0, 9.0, 0.0, 0.0, 10.0, 0.0, -3.0, 0.0, -1.0, -2.0, 10.0, 0.0, -11.0, 10.0, 0.0, -14.0, 0.0, 9.0, 10.0, 10.0, 0.0, 20.0, -9.0, 0.0, 10.0, -1.0, 0.0, 8.0, 30.0, -13.0, -4.0, 9.0, 20.0, -18.0, 10.0, -19.0, -1.0, 0.0, -4.0, 0.0, 0.0, -4.0, -12.0, -8.0, 17.0, 0.0, 0.0, 0.0, -2.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5863300219634198, "mean_inference_ms": 4.148447340531358, "mean_action_processing_ms": 1.2213322896865075, "mean_env_wait_ms": 2.76547320918327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3756072786119249, "StateBufferConnector_ms": 0.034662087758382164, "ViewRequirementAgentConnector_ms": 1.9617142500700775}, "num_episodes": 18, "episode_return_max": 90.0, "episode_return_min": -949.0, "episode_return_mean": -162.64814814814815, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.8077512070238, "num_env_steps_trained_throughput_per_sec": 19.8077512070238, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 179101.998, "restore_workers_time_ms": 0.023, "training_step_time_ms": 179101.93, "sample_time_ms": 8932.019, "learn_time_ms": 170146.766, "learn_throughput": 23.509, "synch_weights_time_ms": 15.384}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "6085c_00000", "date": "2024-07-01_22-34-49", "timestamp": 1719887689, "time_this_iter_s": 201.97321319580078, "time_total_s": 537.5922093391418, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 537.5922093391418, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 64.00354609929079, "ram_util_percent": 82.07482269503545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.732549962468041, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.719884161332164, "policy_loss": -0.002531968972212273, "vf_loss": 2.72183737413317, "vf_explained_var": 0.026311988806445252, "kl": 0.005787570562341065, "entropy": 2.277610379565384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 32865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 103.0, "episode_reward_min": -949.0, "episode_reward_mean": -117.70833333333333, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 14472, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -11.770833333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160.0, -97.0, -730.0, -859.0, -157.0, -316.0, -725.0, -728.0, -949.0, -485.0, -306.0, -142.0, -375.0, -75.0, -383.0, -581.0, -263.0, -203.0, -254.0, -24.0, -16.0, 90.0, -106.0, 79.0, -258.0, -39.0, -85.0, -142.0, -158.0, -112.0, -254.0, 0.0, -51.0, 22.0, -225.0, 22.0, 1.0, 8.0, 63.0, 58.0, -3.0, 13.0, 34.0, 24.0, 22.0, 35.0, -32.0, -10.0, -29.0, 12.0, 24.0, 45.0, -7.0, 4.0, 103.0, -14.0, -43.0, -3.0, 70.0, 19.0, 18.0, 69.0, 9.0, 28.0, -1.0, -36.0, 13.0, 99.0, 8.0, -22.0, 10.0, -19.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -120.0, 0.0, 0.0, 0.0, 10.0, -60.0, 0.0, 0.0, 10.0, 10.0, 3.0, -1.0, -9.0, 0.0, 10.0, 20.0, 10.0, -140.0, 0.0, -210.0, 0.0, 0.0, -135.0, -135.0, -60.0, -135.0, -55.0, 0.0, 0.0, -165.0, 0.0, -62.0, -100.0, -10.0, -2.0, 0.0, -170.0, -350.0, 0.0, 11.0, -65.0, -70.0, 10.0, -3.0, -3.0, 1.0, 8.0, -1.0, -45.0, -115.0, 0.0, 10.0, 0.0, -65.0, 40.0, -6.0, -60.0, 0.0, -120.0, 0.0, 0.0, -295.0, 0.0, -230.0, -45.0, -90.0, -75.0, 0.0, 10.0, -160.0, -45.0, -206.0, 0.0, 0.0, 0.0, -160.0, -177.0, 0.0, 20.0, -100.0, -70.0, -165.0, 0.0, -120.0, -104.0, 0.0, -390.0, 0.0, 0.0, 10.0, 0.0, -5.0, -295.0, -65.0, -57.0, 10.0, 10.0, -103.0, 10.0, 7.0, 0.0, -300.0, 0.0, -2.0, 20.0, 0.0, -1.0, 10.0, -40.0, 29.0, 20.0, -100.0, 40.0, 0.0, -65.0, 0.0, 10.0, -75.0, -1.0, -155.0, -115.0, -2.0, 0.0, -1.0, 24.0, -70.0, 5.0, -6.0, -55.0, 0.0, 0.0, 5.0, 5.0, -105.0, 20.0, 16.0, -35.0, 19.0, 0.0, 0.0, 10.0, 9.0, -165.0, 0.0, 19.0, 0.0, -81.0, 0.0, -175.0, 0.0, 18.0, -60.0, 0.0, -183.0, -151.0, -180.0, -15.0, 0.0, -10.0, -1.0, 20.0, -40.0, 0.0, 5.0, -116.0, 3.0, -25.0, -139.0, 30.0, 10.0, 10.0, 20.0, 0.0, -8.0, 20.0, 0.0, -80.0, -185.0, 10.0, -5.0, -8.0, -190.0, -20.0, -1.0, -5.0, 20.0, -4.0, -1.0, -40.0, 10.0, 7.0, 0.0, -13.0, 13.0, -3.0, -18.0, -20.0, 0.0, 0.0, 10.0, 10.0, 8.0, -4.0, 0.0, 0.0, -45.0, 7.0, -2.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, -5.0, 10.0, 0.0, 10.0, 0.0, 0.0, -41.0, -115.0, 20.0, 15.0, 0.0, 10.0, -20.0, 30.0, 0.0, 9.0, 0.0, 0.0, 40.0, 10.0, 0.0, -45.0, -35.0, 9.0, -15.0, 0.0, -2.0, 0.0, -170.0, 0.0, -19.0, -5.0, 10.0, 0.0, 13.0, 15.0, 13.0, 10.0, -86.0, 10.0, 0.0, -2.0, -35.0, -2.0, -11.0, -40.0, -5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, -75.0, 0.0, 0.0, 15.0, -75.0, -6.0, -11.0, -35.0, 10.0, 0.0, 0.0, 0.0, -7.0, -30.0, 0.0, -90.0, -6.0, 0.0, 0.0, 0.0, -2.0, 0.0, -5.0, -125.0, 0.0, 20.0, 0.0, -67.0, 0.0, -55.0, -115.0, 0.0, -7.0, 0.0, 5.0, -15.0, 0.0, -3.0, 20.0, 10.0, -30.0, -3.0, 7.0, 0.0, 6.0, -3.0, -4.0, 0.0, -1.0, -5.0, -23.0, 0.0, -1.0, -20.0, -11.0, 0.0, 10.0, -10.0, 0.0, -10.0, -8.0, 20.0, -4.0, -6.0, 20.0, 10.0, 10.0, -115.0, 10.0, 0.0, 10.0, -60.0, 0.0, 20.0, 0.0, -85.0, -5.0, 5.0, 7.0, 0.0, 0.0, 5.0, -2.0, 0.0, -11.0, 0.0, 18.0, -4.0, 10.0, 5.0, 0.0, -3.0, -7.0, 0.0, -5.0, 10.0, -5.0, 9.0, 0.0, -11.0, -1.0, -5.0, -1.0, 10.0, 10.0, 10.0, -13.0, -8.0, 30.0, 10.0, 0.0, 10.0, 3.0, -1.0, 0.0, 19.0, 0.0, 30.0, 0.0, -9.0, -2.0, 0.0, 7.0, -4.0, 20.0, -1.0, 17.0, 0.0, 0.0, 20.0, -39.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, -8.0, 19.0, 10.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -5.0, 20.0, 0.0, 0.0, -4.0, -1.0, 10.0, 18.0, 0.0, -4.0, 0.0, -2.0, 0.0, 0.0, 30.0, -2.0, 0.0, -7.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, -15.0, 8.0, 9.0, 0.0, 0.0, 0.0, 10.0, 5.0, -2.0, 10.0, -2.0, 10.0, 0.0, -1.0, 5.0, -9.0, -2.0, 0.0, -2.0, -40.0, 20.0, 10.0, 0.0, -9.0, 0.0, 10.0, 20.0, -14.0, 16.0, -9.0, -6.0, -4.0, -10.0, -13.0, 0.0, 0.0, -12.0, 10.0, 0.0, 0.0, -20.0, -14.0, 10.0, -3.0, 0.0, -1.0, 9.0, 0.0, 0.0, 10.0, 0.0, -3.0, 0.0, -1.0, -2.0, 10.0, 0.0, -11.0, 10.0, 0.0, -14.0, 0.0, 9.0, 10.0, 10.0, 0.0, 20.0, -9.0, 0.0, 10.0, -1.0, 0.0, 8.0, 30.0, -13.0, -4.0, 9.0, 20.0, -18.0, 10.0, -19.0, -1.0, 0.0, -4.0, 0.0, 0.0, -4.0, -12.0, -8.0, 17.0, 0.0, 0.0, 0.0, -2.0, 13.0, 10.0, -6.0, -8.0, 16.0, 29.0, 6.0, 30.0, 0.0, 30.0, -4.0, -6.0, -17.0, 30.0, -7.0, -19.0, 6.0, 4.0, -1.0, -4.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, -7.0, -46.0, 0.0, -9.0, 9.0, 0.0, -3.0, 0.0, -15.0, 10.0, -10.0, 10.0, -1.0, -3.0, 10.0, 15.0, 10.0, 0.0, 10.0, 20.0, 20.0, -15.0, 0.0, 0.0, -8.0, 12.0, -16.0, 0.0, 20.0, -6.0, 2.0, -3.0, -2.0, 20.0, 10.0, 17.0, -4.0, 0.0, 10.0, -22.0, -3.0, 10.0, 0.0, 0.0, -5.0, 15.0, 25.0, 30.0, 0.0, -6.0, 0.0, 0.0, 0.0, 10.0, 0.0, 7.0, 10.0, 9.0, -8.0, 10.0, -6.0, -6.0, -1.0, -6.0, 8.0, 9.0, 5.0, -4.0, 12.0, 19.0, 8.0, -4.0, -20.0, -5.0, -8.0, -9.0, 0.0, -8.0, 0.0, 15.0, -11.0, 0.0, 10.0, 10.0, -16.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 10.0, 0.0, -7.0, 0.0, 0.0, -3.0, 0.0, 7.0, 10.0, -6.0, 5.0, 0.0, 0.0, 10.0, 14.0, 6.0, 10.0, 21.0, 20.0, 7.0, 11.0, 0.0, 0.0, 0.0, -8.0, -5.0, 0.0, 24.0, 0.0, -4.0, -4.0, 5.0, 0.0, 0.0, 10.0, -3.0, -4.0, -20.0, 0.0, -13.0, 20.0, 15.0, -27.0, -5.0, 0.0, 20.0, -6.0, 0.0, 0.0, 10.0, 0.0, -6.0, -3.0, -4.0, -4.0, -6.0, 18.0, -2.0, -2.0, -4.0, -2.0, -10.0, -3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.160657851528084, "mean_inference_ms": 5.017917417158262, "mean_action_processing_ms": 1.348755864498054, "mean_env_wait_ms": 3.1451341661589702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3104153606626723, "StateBufferConnector_ms": 0.03165370888180203, "ViewRequirementAgentConnector_ms": 1.7496503061718411}, "num_episodes": 18, "episode_return_max": 103.0, "episode_return_min": -949.0, "episode_return_mean": -117.70833333333333, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 17.542656594718974, "num_env_steps_trained_throughput_per_sec": 17.542656594718974, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 191330.415, "restore_workers_time_ms": 0.023, "training_step_time_ms": 191330.317, "sample_time_ms": 10319.82, "learn_time_ms": 180983.296, "learn_throughput": 22.101, "synch_weights_time_ms": 14.974}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "6085c_00000", "date": "2024-07-01_22-38-37", "timestamp": 1719887917, "time_this_iter_s": 228.06920289993286, "time_total_s": 765.6614122390747, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 765.6614122390747, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 70.37341772151899, "ram_util_percent": 81.45031645569621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.658562809209854, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6839423304167798, "policy_loss": -0.002850205255501246, "vf_loss": 2.6861645178292126, "vf_explained_var": 0.030262343558513573, "kl": 0.006280155603352209, "entropy": 2.266635232941665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 42255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 103.0, "episode_reward_min": -949.0, "episode_reward_mean": -79.55555555555556, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 19899, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -7.955555555555556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160.0, -97.0, -730.0, -859.0, -157.0, -316.0, -725.0, -728.0, -949.0, -485.0, -306.0, -142.0, -375.0, -75.0, -383.0, -581.0, -263.0, -203.0, -254.0, -24.0, -16.0, 90.0, -106.0, 79.0, -258.0, -39.0, -85.0, -142.0, -158.0, -112.0, -254.0, 0.0, -51.0, 22.0, -225.0, 22.0, 1.0, 8.0, 63.0, 58.0, -3.0, 13.0, 34.0, 24.0, 22.0, 35.0, -32.0, -10.0, -29.0, 12.0, 24.0, 45.0, -7.0, 4.0, 103.0, -14.0, -43.0, -3.0, 70.0, 19.0, 18.0, 69.0, 9.0, 28.0, -1.0, -36.0, 13.0, 99.0, 8.0, -22.0, 10.0, -19.0, 31.0, -48.0, 88.0, 0.0, 19.0, 53.0, 51.0, 102.0, 27.0, 19.0, 26.0, 2.0, -54.0, -2.0, -8.0, 26.0, 4.0, 77.0, 13.0, 31.0, 66.0, 14.0, 38.0, 27.0, -10.0, -4.0, 11.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -120.0, 0.0, 0.0, 0.0, 10.0, -60.0, 0.0, 0.0, 10.0, 10.0, 3.0, -1.0, -9.0, 0.0, 10.0, 20.0, 10.0, -140.0, 0.0, -210.0, 0.0, 0.0, -135.0, -135.0, -60.0, -135.0, -55.0, 0.0, 0.0, -165.0, 0.0, -62.0, -100.0, -10.0, -2.0, 0.0, -170.0, -350.0, 0.0, 11.0, -65.0, -70.0, 10.0, -3.0, -3.0, 1.0, 8.0, -1.0, -45.0, -115.0, 0.0, 10.0, 0.0, -65.0, 40.0, -6.0, -60.0, 0.0, -120.0, 0.0, 0.0, -295.0, 0.0, -230.0, -45.0, -90.0, -75.0, 0.0, 10.0, -160.0, -45.0, -206.0, 0.0, 0.0, 0.0, -160.0, -177.0, 0.0, 20.0, -100.0, -70.0, -165.0, 0.0, -120.0, -104.0, 0.0, -390.0, 0.0, 0.0, 10.0, 0.0, -5.0, -295.0, -65.0, -57.0, 10.0, 10.0, -103.0, 10.0, 7.0, 0.0, -300.0, 0.0, -2.0, 20.0, 0.0, -1.0, 10.0, -40.0, 29.0, 20.0, -100.0, 40.0, 0.0, -65.0, 0.0, 10.0, -75.0, -1.0, -155.0, -115.0, -2.0, 0.0, -1.0, 24.0, -70.0, 5.0, -6.0, -55.0, 0.0, 0.0, 5.0, 5.0, -105.0, 20.0, 16.0, -35.0, 19.0, 0.0, 0.0, 10.0, 9.0, -165.0, 0.0, 19.0, 0.0, -81.0, 0.0, -175.0, 0.0, 18.0, -60.0, 0.0, -183.0, -151.0, -180.0, -15.0, 0.0, -10.0, -1.0, 20.0, -40.0, 0.0, 5.0, -116.0, 3.0, -25.0, -139.0, 30.0, 10.0, 10.0, 20.0, 0.0, -8.0, 20.0, 0.0, -80.0, -185.0, 10.0, -5.0, -8.0, -190.0, -20.0, -1.0, -5.0, 20.0, -4.0, -1.0, -40.0, 10.0, 7.0, 0.0, -13.0, 13.0, -3.0, -18.0, -20.0, 0.0, 0.0, 10.0, 10.0, 8.0, -4.0, 0.0, 0.0, -45.0, 7.0, -2.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, -5.0, 10.0, 0.0, 10.0, 0.0, 0.0, -41.0, -115.0, 20.0, 15.0, 0.0, 10.0, -20.0, 30.0, 0.0, 9.0, 0.0, 0.0, 40.0, 10.0, 0.0, -45.0, -35.0, 9.0, -15.0, 0.0, -2.0, 0.0, -170.0, 0.0, -19.0, -5.0, 10.0, 0.0, 13.0, 15.0, 13.0, 10.0, -86.0, 10.0, 0.0, -2.0, -35.0, -2.0, -11.0, -40.0, -5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, -75.0, 0.0, 0.0, 15.0, -75.0, -6.0, -11.0, -35.0, 10.0, 0.0, 0.0, 0.0, -7.0, -30.0, 0.0, -90.0, -6.0, 0.0, 0.0, 0.0, -2.0, 0.0, -5.0, -125.0, 0.0, 20.0, 0.0, -67.0, 0.0, -55.0, -115.0, 0.0, -7.0, 0.0, 5.0, -15.0, 0.0, -3.0, 20.0, 10.0, -30.0, -3.0, 7.0, 0.0, 6.0, -3.0, -4.0, 0.0, -1.0, -5.0, -23.0, 0.0, -1.0, -20.0, -11.0, 0.0, 10.0, -10.0, 0.0, -10.0, -8.0, 20.0, -4.0, -6.0, 20.0, 10.0, 10.0, -115.0, 10.0, 0.0, 10.0, -60.0, 0.0, 20.0, 0.0, -85.0, -5.0, 5.0, 7.0, 0.0, 0.0, 5.0, -2.0, 0.0, -11.0, 0.0, 18.0, -4.0, 10.0, 5.0, 0.0, -3.0, -7.0, 0.0, -5.0, 10.0, -5.0, 9.0, 0.0, -11.0, -1.0, -5.0, -1.0, 10.0, 10.0, 10.0, -13.0, -8.0, 30.0, 10.0, 0.0, 10.0, 3.0, -1.0, 0.0, 19.0, 0.0, 30.0, 0.0, -9.0, -2.0, 0.0, 7.0, -4.0, 20.0, -1.0, 17.0, 0.0, 0.0, 20.0, -39.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, -8.0, 19.0, 10.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -5.0, 20.0, 0.0, 0.0, -4.0, -1.0, 10.0, 18.0, 0.0, -4.0, 0.0, -2.0, 0.0, 0.0, 30.0, -2.0, 0.0, -7.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, -15.0, 8.0, 9.0, 0.0, 0.0, 0.0, 10.0, 5.0, -2.0, 10.0, -2.0, 10.0, 0.0, -1.0, 5.0, -9.0, -2.0, 0.0, -2.0, -40.0, 20.0, 10.0, 0.0, -9.0, 0.0, 10.0, 20.0, -14.0, 16.0, -9.0, -6.0, -4.0, -10.0, -13.0, 0.0, 0.0, -12.0, 10.0, 0.0, 0.0, -20.0, -14.0, 10.0, -3.0, 0.0, -1.0, 9.0, 0.0, 0.0, 10.0, 0.0, -3.0, 0.0, -1.0, -2.0, 10.0, 0.0, -11.0, 10.0, 0.0, -14.0, 0.0, 9.0, 10.0, 10.0, 0.0, 20.0, -9.0, 0.0, 10.0, -1.0, 0.0, 8.0, 30.0, -13.0, -4.0, 9.0, 20.0, -18.0, 10.0, -19.0, -1.0, 0.0, -4.0, 0.0, 0.0, -4.0, -12.0, -8.0, 17.0, 0.0, 0.0, 0.0, -2.0, 13.0, 10.0, -6.0, -8.0, 16.0, 29.0, 6.0, 30.0, 0.0, 30.0, -4.0, -6.0, -17.0, 30.0, -7.0, -19.0, 6.0, 4.0, -1.0, -4.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, -7.0, -46.0, 0.0, -9.0, 9.0, 0.0, -3.0, 0.0, -15.0, 10.0, -10.0, 10.0, -1.0, -3.0, 10.0, 15.0, 10.0, 0.0, 10.0, 20.0, 20.0, -15.0, 0.0, 0.0, -8.0, 12.0, -16.0, 0.0, 20.0, -6.0, 2.0, -3.0, -2.0, 20.0, 10.0, 17.0, -4.0, 0.0, 10.0, -22.0, -3.0, 10.0, 0.0, 0.0, -5.0, 15.0, 25.0, 30.0, 0.0, -6.0, 0.0, 0.0, 0.0, 10.0, 0.0, 7.0, 10.0, 9.0, -8.0, 10.0, -6.0, -6.0, -1.0, -6.0, 8.0, 9.0, 5.0, -4.0, 12.0, 19.0, 8.0, -4.0, -20.0, -5.0, -8.0, -9.0, 0.0, -8.0, 0.0, 15.0, -11.0, 0.0, 10.0, 10.0, -16.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 10.0, 0.0, -7.0, 0.0, 0.0, -3.0, 0.0, 7.0, 10.0, -6.0, 5.0, 0.0, 0.0, 10.0, 14.0, 6.0, 10.0, 21.0, 20.0, 7.0, 11.0, 0.0, 0.0, 0.0, -8.0, -5.0, 0.0, 24.0, 0.0, -4.0, -4.0, 5.0, 0.0, 0.0, 10.0, -3.0, -4.0, -20.0, 0.0, -13.0, 20.0, 15.0, -27.0, -5.0, 0.0, 20.0, -6.0, 0.0, 0.0, 10.0, 0.0, -6.0, -3.0, -4.0, -4.0, -6.0, 18.0, -2.0, -2.0, -4.0, -2.0, -10.0, -3.0, -3.0, 2.0, 0.0, -5.0, 0.0, 17.0, 0.0, 0.0, 0.0, 20.0, -1.0, 0.0, -11.0, 0.0, 10.0, 0.0, -35.0, 10.0, -11.0, -10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 9.0, 20.0, 20.0, 9.0, 0.0, -4.0, -10.0, 6.0, -1.0, -12.0, 0.0, -4.0, 10.0, -2.0, 17.0, -1.0, 0.0, 0.0, 10.0, -11.0, 20.0, -3.0, 5.0, 0.0, -1.0, 10.0, -2.0, 10.0, 10.0, 0.0, -5.0, 0.0, 0.0, 10.0, 20.0, 17.0, 10.0, 8.0, 9.0, 0.0, 20.0, 0.0, -2.0, -9.0, -2.0, 0.0, 30.0, 20.0, 0.0, 0.0, -3.0, 0.0, 19.0, 40.0, -4.0, 9.0, 2.0, -9.0, 10.0, 28.0, -12.0, 10.0, 0.0, -11.0, 0.0, -1.0, 0.0, -7.0, 11.0, 10.0, 0.0, -5.0, 20.0, -6.0, -3.0, 0.0, -10.0, 10.0, 9.0, 10.0, -1.0, 10.0, 10.0, 0.0, -12.0, 10.0, -8.0, -1.0, 4.0, -3.0, 9.0, -17.0, 5.0, 10.0, -7.0, -15.0, 10.0, 20.0, -12.0, 0.0, -8.0, -2.0, 8.0, 0.0, -55.0, 0.0, 20.0, -16.0, 10.0, -5.0, -15.0, 5.0, -1.0, 0.0, 0.0, 29.0, -19.0, -11.0, 0.0, -17.0, -20.0, 10.0, 10.0, 0.0, 10.0, 19.0, 20.0, -5.0, 0.0, -3.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -3.0, -7.0, 10.0, 0.0, -2.0, 10.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 8.0, -1.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -20.0, -1.0, 0.0, 0.0, 4.0, 10.0, -3.0, 20.0, 0.0, 10.0, 0.0, -3.0, -1.0, 10.0, -2.0, 0.0, -4.0, -2.0, 7.0, 0.0, 36.0, 0.0, -1.0, 10.0, 0.0, 20.0, -3.0, -10.0, -4.0, 0.0, 30.0, 0.0, 4.0, 0.0, 5.0, -8.0, 10.0, -9.0, -10.0, 10.0, 5.0, 20.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 3.0, 7.0, 0.0, 10.0, -2.0, 8.0, -10.0, 10.0, -1.0, -4.0, 30.0, 7.0, -9.0, -20.0, -5.0, -26.0, 9.0, 9.0, 0.0, -2.0, 10.0, -75.0, 10.0, 0.0, 30.0, 0.0, 3.0, 20.0, 6.0, 4.0, 0.0, 9.0, -19.0, -1.0, -1.0, -12.0, 20.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.711084007487262, "mean_inference_ms": 5.738571997661112, "mean_action_processing_ms": 1.4945472197537277, "mean_env_wait_ms": 3.5656995038749666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2816337527650775, "StateBufferConnector_ms": 0.02917882167931759, "ViewRequirementAgentConnector_ms": 2.7005409953570125}, "num_episodes": 27, "episode_return_max": 103.0, "episode_return_min": -949.0, "episode_return_mean": -79.55555555555556, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.981332707040423, "num_env_steps_trained_throughput_per_sec": 20.981332707040423, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 191193.467, "restore_workers_time_ms": 0.022, "training_step_time_ms": 191193.378, "sample_time_ms": 10790.209, "learn_time_ms": 180371.162, "learn_throughput": 22.176, "synch_weights_time_ms": 19.476}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "6085c_00000", "date": "2024-07-01_22-41-48", "timestamp": 1719888108, "time_this_iter_s": 190.71919798851013, "time_total_s": 956.3806102275848, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 956.3806102275848, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 60.76766917293234, "ram_util_percent": 81.68496240601505}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.405645939596671, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.843787053725717, "policy_loss": -0.003171093868244443, "vf_loss": 2.8460843383059844, "vf_explained_var": 0.028750026606904053, "kl": 0.008738067226982813, "entropy": 2.243094527530975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 51645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 103.0, "episode_reward_min": -258.0, "episode_reward_mean": 1.03, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -190.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": 0.103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.0, -254.0, -24.0, -16.0, 90.0, -106.0, 79.0, -258.0, -39.0, -85.0, -142.0, -158.0, -112.0, -254.0, 0.0, -51.0, 22.0, -225.0, 22.0, 1.0, 8.0, 63.0, 58.0, -3.0, 13.0, 34.0, 24.0, 22.0, 35.0, -32.0, -10.0, -29.0, 12.0, 24.0, 45.0, -7.0, 4.0, 103.0, -14.0, -43.0, -3.0, 70.0, 19.0, 18.0, 69.0, 9.0, 28.0, -1.0, -36.0, 13.0, 99.0, 8.0, -22.0, 10.0, -19.0, 31.0, -48.0, 88.0, 0.0, 19.0, 53.0, 51.0, 102.0, 27.0, 19.0, 26.0, 2.0, -54.0, -2.0, -8.0, 26.0, 4.0, 77.0, 13.0, 31.0, 66.0, 14.0, 38.0, 27.0, -10.0, -4.0, 11.0, -23.0, 24.0, 22.0, 30.0, 64.0, 49.0, -6.0, 32.0, -36.0, 34.0, -18.0, 72.0, 61.0, 18.0, 93.0, 55.0, 99.0, 78.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 20.0, 0.0, -8.0, 20.0, 0.0, -80.0, -185.0, 10.0, -5.0, -8.0, -190.0, -20.0, -1.0, -5.0, 20.0, -4.0, -1.0, -40.0, 10.0, 7.0, 0.0, -13.0, 13.0, -3.0, -18.0, -20.0, 0.0, 0.0, 10.0, 10.0, 8.0, -4.0, 0.0, 0.0, -45.0, 7.0, -2.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, -5.0, 10.0, 0.0, 10.0, 0.0, 0.0, -41.0, -115.0, 20.0, 15.0, 0.0, 10.0, -20.0, 30.0, 0.0, 9.0, 0.0, 0.0, 40.0, 10.0, 0.0, -45.0, -35.0, 9.0, -15.0, 0.0, -2.0, 0.0, -170.0, 0.0, -19.0, -5.0, 10.0, 0.0, 13.0, 15.0, 13.0, 10.0, -86.0, 10.0, 0.0, -2.0, -35.0, -2.0, -11.0, -40.0, -5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, -75.0, 0.0, 0.0, 15.0, -75.0, -6.0, -11.0, -35.0, 10.0, 0.0, 0.0, 0.0, -7.0, -30.0, 0.0, -90.0, -6.0, 0.0, 0.0, 0.0, -2.0, 0.0, -5.0, -125.0, 0.0, 20.0, 0.0, -67.0, 0.0, -55.0, -115.0, 0.0, -7.0, 0.0, 5.0, -15.0, 0.0, -3.0, 20.0, 10.0, -30.0, -3.0, 7.0, 0.0, 6.0, -3.0, -4.0, 0.0, -1.0, -5.0, -23.0, 0.0, -1.0, -20.0, -11.0, 0.0, 10.0, -10.0, 0.0, -10.0, -8.0, 20.0, -4.0, -6.0, 20.0, 10.0, 10.0, -115.0, 10.0, 0.0, 10.0, -60.0, 0.0, 20.0, 0.0, -85.0, -5.0, 5.0, 7.0, 0.0, 0.0, 5.0, -2.0, 0.0, -11.0, 0.0, 18.0, -4.0, 10.0, 5.0, 0.0, -3.0, -7.0, 0.0, -5.0, 10.0, -5.0, 9.0, 0.0, -11.0, -1.0, -5.0, -1.0, 10.0, 10.0, 10.0, -13.0, -8.0, 30.0, 10.0, 0.0, 10.0, 3.0, -1.0, 0.0, 19.0, 0.0, 30.0, 0.0, -9.0, -2.0, 0.0, 7.0, -4.0, 20.0, -1.0, 17.0, 0.0, 0.0, 20.0, -39.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, -8.0, 19.0, 10.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -5.0, 20.0, 0.0, 0.0, -4.0, -1.0, 10.0, 18.0, 0.0, -4.0, 0.0, -2.0, 0.0, 0.0, 30.0, -2.0, 0.0, -7.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, -15.0, 8.0, 9.0, 0.0, 0.0, 0.0, 10.0, 5.0, -2.0, 10.0, -2.0, 10.0, 0.0, -1.0, 5.0, -9.0, -2.0, 0.0, -2.0, -40.0, 20.0, 10.0, 0.0, -9.0, 0.0, 10.0, 20.0, -14.0, 16.0, -9.0, -6.0, -4.0, -10.0, -13.0, 0.0, 0.0, -12.0, 10.0, 0.0, 0.0, -20.0, -14.0, 10.0, -3.0, 0.0, -1.0, 9.0, 0.0, 0.0, 10.0, 0.0, -3.0, 0.0, -1.0, -2.0, 10.0, 0.0, -11.0, 10.0, 0.0, -14.0, 0.0, 9.0, 10.0, 10.0, 0.0, 20.0, -9.0, 0.0, 10.0, -1.0, 0.0, 8.0, 30.0, -13.0, -4.0, 9.0, 20.0, -18.0, 10.0, -19.0, -1.0, 0.0, -4.0, 0.0, 0.0, -4.0, -12.0, -8.0, 17.0, 0.0, 0.0, 0.0, -2.0, 13.0, 10.0, -6.0, -8.0, 16.0, 29.0, 6.0, 30.0, 0.0, 30.0, -4.0, -6.0, -17.0, 30.0, -7.0, -19.0, 6.0, 4.0, -1.0, -4.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, -7.0, -46.0, 0.0, -9.0, 9.0, 0.0, -3.0, 0.0, -15.0, 10.0, -10.0, 10.0, -1.0, -3.0, 10.0, 15.0, 10.0, 0.0, 10.0, 20.0, 20.0, -15.0, 0.0, 0.0, -8.0, 12.0, -16.0, 0.0, 20.0, -6.0, 2.0, -3.0, -2.0, 20.0, 10.0, 17.0, -4.0, 0.0, 10.0, -22.0, -3.0, 10.0, 0.0, 0.0, -5.0, 15.0, 25.0, 30.0, 0.0, -6.0, 0.0, 0.0, 0.0, 10.0, 0.0, 7.0, 10.0, 9.0, -8.0, 10.0, -6.0, -6.0, -1.0, -6.0, 8.0, 9.0, 5.0, -4.0, 12.0, 19.0, 8.0, -4.0, -20.0, -5.0, -8.0, -9.0, 0.0, -8.0, 0.0, 15.0, -11.0, 0.0, 10.0, 10.0, -16.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 10.0, 0.0, -7.0, 0.0, 0.0, -3.0, 0.0, 7.0, 10.0, -6.0, 5.0, 0.0, 0.0, 10.0, 14.0, 6.0, 10.0, 21.0, 20.0, 7.0, 11.0, 0.0, 0.0, 0.0, -8.0, -5.0, 0.0, 24.0, 0.0, -4.0, -4.0, 5.0, 0.0, 0.0, 10.0, -3.0, -4.0, -20.0, 0.0, -13.0, 20.0, 15.0, -27.0, -5.0, 0.0, 20.0, -6.0, 0.0, 0.0, 10.0, 0.0, -6.0, -3.0, -4.0, -4.0, -6.0, 18.0, -2.0, -2.0, -4.0, -2.0, -10.0, -3.0, -3.0, 2.0, 0.0, -5.0, 0.0, 17.0, 0.0, 0.0, 0.0, 20.0, -1.0, 0.0, -11.0, 0.0, 10.0, 0.0, -35.0, 10.0, -11.0, -10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 9.0, 20.0, 20.0, 9.0, 0.0, -4.0, -10.0, 6.0, -1.0, -12.0, 0.0, -4.0, 10.0, -2.0, 17.0, -1.0, 0.0, 0.0, 10.0, -11.0, 20.0, -3.0, 5.0, 0.0, -1.0, 10.0, -2.0, 10.0, 10.0, 0.0, -5.0, 0.0, 0.0, 10.0, 20.0, 17.0, 10.0, 8.0, 9.0, 0.0, 20.0, 0.0, -2.0, -9.0, -2.0, 0.0, 30.0, 20.0, 0.0, 0.0, -3.0, 0.0, 19.0, 40.0, -4.0, 9.0, 2.0, -9.0, 10.0, 28.0, -12.0, 10.0, 0.0, -11.0, 0.0, -1.0, 0.0, -7.0, 11.0, 10.0, 0.0, -5.0, 20.0, -6.0, -3.0, 0.0, -10.0, 10.0, 9.0, 10.0, -1.0, 10.0, 10.0, 0.0, -12.0, 10.0, -8.0, -1.0, 4.0, -3.0, 9.0, -17.0, 5.0, 10.0, -7.0, -15.0, 10.0, 20.0, -12.0, 0.0, -8.0, -2.0, 8.0, 0.0, -55.0, 0.0, 20.0, -16.0, 10.0, -5.0, -15.0, 5.0, -1.0, 0.0, 0.0, 29.0, -19.0, -11.0, 0.0, -17.0, -20.0, 10.0, 10.0, 0.0, 10.0, 19.0, 20.0, -5.0, 0.0, -3.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -3.0, -7.0, 10.0, 0.0, -2.0, 10.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 8.0, -1.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -20.0, -1.0, 0.0, 0.0, 4.0, 10.0, -3.0, 20.0, 0.0, 10.0, 0.0, -3.0, -1.0, 10.0, -2.0, 0.0, -4.0, -2.0, 7.0, 0.0, 36.0, 0.0, -1.0, 10.0, 0.0, 20.0, -3.0, -10.0, -4.0, 0.0, 30.0, 0.0, 4.0, 0.0, 5.0, -8.0, 10.0, -9.0, -10.0, 10.0, 5.0, 20.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 3.0, 7.0, 0.0, 10.0, -2.0, 8.0, -10.0, 10.0, -1.0, -4.0, 30.0, 7.0, -9.0, -20.0, -5.0, -26.0, 9.0, 9.0, 0.0, -2.0, 10.0, -75.0, 10.0, 0.0, 30.0, 0.0, 3.0, 20.0, 6.0, 4.0, 0.0, 9.0, -19.0, -1.0, -1.0, -12.0, 20.0, 5.0, 0.0, 0.0, 0.0, 5.0, -41.0, 0.0, 4.0, -1.0, 10.0, 0.0, 19.0, -2.0, 10.0, 0.0, -3.0, -11.0, 10.0, -1.0, 10.0, -8.0, 2.0, 9.0, 0.0, -2.0, 20.0, -6.0, 5.0, 0.0, -3.0, -3.0, -4.0, 0.0, 0.0, 4.0, 8.0, -2.0, 0.0, -6.0, 30.0, 0.0, 0.0, 0.0, 9.0, 13.0, -1.0, 20.0, 30.0, 0.0, -7.0, 0.0, 0.0, 17.0, 0.0, -2.0, 30.0, 0.0, 0.0, 0.0, 4.0, 0.0, 20.0, 20.0, 0.0, 0.0, -45.0, 0.0, -20.0, 10.0, 9.0, 0.0, 0.0, 10.0, 17.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -24.0, 10.0, -3.0, -27.0, -22.0, 10.0, 10.0, 0.0, 0.0, 7.0, -5.0, 9.0, 10.0, 10.0, -17.0, 10.0, -10.0, 0.0, -7.0, 0.0, -4.0, -11.0, 10.0, -6.0, 0.0, 10.0, 10.0, -8.0, -2.0, 20.0, -5.0, -2.0, 10.0, 20.0, 30.0, -1.0, -6.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, 16.0, 15.0, 20.0, -2.0, 40.0, 1.0, 0.0, -9.0, -18.0, -6.0, 20.0, 0.0, -8.0, 20.0, 6.0, -4.0, 30.0, -1.0, 9.0, 8.0, 30.0, -2.0, -3.0, 30.0, 0.0, 0.0, -3.0, -7.0, 18.0, -10.0, 7.0, 10.0, 10.0, 10.0, 0.0, 18.0, 22.0, 3.0, 0.0, 9.0, 19.0, -2.0, 20.0, 10.0, 26.0, -4.0, -1.0, -3.0, 9.0, -9.0, 20.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.35684563270407, "mean_inference_ms": 6.600723226113056, "mean_action_processing_ms": 1.6678017019042464, "mean_env_wait_ms": 4.054563857463162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.290912389755249, "StateBufferConnector_ms": 0.03115057945251465, "ViewRequirementAgentConnector_ms": 2.845076560974121}, "num_episodes": 18, "episode_return_max": 103.0, "episode_return_min": -258.0, "episode_return_mean": 1.03, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 23.293918749352734, "num_env_steps_trained_throughput_per_sec": 23.293918749352734, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 187947.666, "restore_workers_time_ms": 0.024, "training_step_time_ms": 187947.579, "sample_time_ms": 10723.425, "learn_time_ms": 177192.969, "learn_throughput": 22.574, "synch_weights_time_ms": 19.603}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "6085c_00000", "date": "2024-07-01_22-44-39", "timestamp": 1719888279, "time_this_iter_s": 171.73700714111328, "time_total_s": 1128.1176173686981, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b912f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1128.1176173686981, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 54.19291666666667, "ram_util_percent": 82.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.5097831188172455, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6929333413751744, "policy_loss": -0.005015765133247383, "vf_loss": 2.6968860083240798, "vf_explained_var": 0.0355626320940491, "kl": 0.010630980125707519, "entropy": 2.2316139219667965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 61035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 103.0, "episode_reward_min": -78.0, "episode_reward_mean": 20.92, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": 2.092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 1.0, 8.0, 63.0, 58.0, -3.0, 13.0, 34.0, 24.0, 22.0, 35.0, -32.0, -10.0, -29.0, 12.0, 24.0, 45.0, -7.0, 4.0, 103.0, -14.0, -43.0, -3.0, 70.0, 19.0, 18.0, 69.0, 9.0, 28.0, -1.0, -36.0, 13.0, 99.0, 8.0, -22.0, 10.0, -19.0, 31.0, -48.0, 88.0, 0.0, 19.0, 53.0, 51.0, 102.0, 27.0, 19.0, 26.0, 2.0, -54.0, -2.0, -8.0, 26.0, 4.0, 77.0, 13.0, 31.0, 66.0, 14.0, 38.0, 27.0, -10.0, -4.0, 11.0, -23.0, 24.0, 22.0, 30.0, 64.0, 49.0, -6.0, 32.0, -36.0, 34.0, -18.0, 72.0, 61.0, 18.0, 93.0, 55.0, 99.0, 78.0, 58.0, -78.0, -1.0, 77.0, -6.0, -8.0, 43.0, 8.0, 5.0, 33.0, 43.0, 25.0, 42.0, 4.0, 6.0, -16.0, -5.0, 23.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [5.0, 7.0, 0.0, 0.0, 5.0, -2.0, 0.0, -11.0, 0.0, 18.0, -4.0, 10.0, 5.0, 0.0, -3.0, -7.0, 0.0, -5.0, 10.0, -5.0, 9.0, 0.0, -11.0, -1.0, -5.0, -1.0, 10.0, 10.0, 10.0, -13.0, -8.0, 30.0, 10.0, 0.0, 10.0, 3.0, -1.0, 0.0, 19.0, 0.0, 30.0, 0.0, -9.0, -2.0, 0.0, 7.0, -4.0, 20.0, -1.0, 17.0, 0.0, 0.0, 20.0, -39.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, -8.0, 19.0, 10.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -5.0, 20.0, 0.0, 0.0, -4.0, -1.0, 10.0, 18.0, 0.0, -4.0, 0.0, -2.0, 0.0, 0.0, 30.0, -2.0, 0.0, -7.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, -15.0, 8.0, 9.0, 0.0, 0.0, 0.0, 10.0, 5.0, -2.0, 10.0, -2.0, 10.0, 0.0, -1.0, 5.0, -9.0, -2.0, 0.0, -2.0, -40.0, 20.0, 10.0, 0.0, -9.0, 0.0, 10.0, 20.0, -14.0, 16.0, -9.0, -6.0, -4.0, -10.0, -13.0, 0.0, 0.0, -12.0, 10.0, 0.0, 0.0, -20.0, -14.0, 10.0, -3.0, 0.0, -1.0, 9.0, 0.0, 0.0, 10.0, 0.0, -3.0, 0.0, -1.0, -2.0, 10.0, 0.0, -11.0, 10.0, 0.0, -14.0, 0.0, 9.0, 10.0, 10.0, 0.0, 20.0, -9.0, 0.0, 10.0, -1.0, 0.0, 8.0, 30.0, -13.0, -4.0, 9.0, 20.0, -18.0, 10.0, -19.0, -1.0, 0.0, -4.0, 0.0, 0.0, -4.0, -12.0, -8.0, 17.0, 0.0, 0.0, 0.0, -2.0, 13.0, 10.0, -6.0, -8.0, 16.0, 29.0, 6.0, 30.0, 0.0, 30.0, -4.0, -6.0, -17.0, 30.0, -7.0, -19.0, 6.0, 4.0, -1.0, -4.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, -7.0, -46.0, 0.0, -9.0, 9.0, 0.0, -3.0, 0.0, -15.0, 10.0, -10.0, 10.0, -1.0, -3.0, 10.0, 15.0, 10.0, 0.0, 10.0, 20.0, 20.0, -15.0, 0.0, 0.0, -8.0, 12.0, -16.0, 0.0, 20.0, -6.0, 2.0, -3.0, -2.0, 20.0, 10.0, 17.0, -4.0, 0.0, 10.0, -22.0, -3.0, 10.0, 0.0, 0.0, -5.0, 15.0, 25.0, 30.0, 0.0, -6.0, 0.0, 0.0, 0.0, 10.0, 0.0, 7.0, 10.0, 9.0, -8.0, 10.0, -6.0, -6.0, -1.0, -6.0, 8.0, 9.0, 5.0, -4.0, 12.0, 19.0, 8.0, -4.0, -20.0, -5.0, -8.0, -9.0, 0.0, -8.0, 0.0, 15.0, -11.0, 0.0, 10.0, 10.0, -16.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 10.0, 0.0, -7.0, 0.0, 0.0, -3.0, 0.0, 7.0, 10.0, -6.0, 5.0, 0.0, 0.0, 10.0, 14.0, 6.0, 10.0, 21.0, 20.0, 7.0, 11.0, 0.0, 0.0, 0.0, -8.0, -5.0, 0.0, 24.0, 0.0, -4.0, -4.0, 5.0, 0.0, 0.0, 10.0, -3.0, -4.0, -20.0, 0.0, -13.0, 20.0, 15.0, -27.0, -5.0, 0.0, 20.0, -6.0, 0.0, 0.0, 10.0, 0.0, -6.0, -3.0, -4.0, -4.0, -6.0, 18.0, -2.0, -2.0, -4.0, -2.0, -10.0, -3.0, -3.0, 2.0, 0.0, -5.0, 0.0, 17.0, 0.0, 0.0, 0.0, 20.0, -1.0, 0.0, -11.0, 0.0, 10.0, 0.0, -35.0, 10.0, -11.0, -10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 9.0, 20.0, 20.0, 9.0, 0.0, -4.0, -10.0, 6.0, -1.0, -12.0, 0.0, -4.0, 10.0, -2.0, 17.0, -1.0, 0.0, 0.0, 10.0, -11.0, 20.0, -3.0, 5.0, 0.0, -1.0, 10.0, -2.0, 10.0, 10.0, 0.0, -5.0, 0.0, 0.0, 10.0, 20.0, 17.0, 10.0, 8.0, 9.0, 0.0, 20.0, 0.0, -2.0, -9.0, -2.0, 0.0, 30.0, 20.0, 0.0, 0.0, -3.0, 0.0, 19.0, 40.0, -4.0, 9.0, 2.0, -9.0, 10.0, 28.0, -12.0, 10.0, 0.0, -11.0, 0.0, -1.0, 0.0, -7.0, 11.0, 10.0, 0.0, -5.0, 20.0, -6.0, -3.0, 0.0, -10.0, 10.0, 9.0, 10.0, -1.0, 10.0, 10.0, 0.0, -12.0, 10.0, -8.0, -1.0, 4.0, -3.0, 9.0, -17.0, 5.0, 10.0, -7.0, -15.0, 10.0, 20.0, -12.0, 0.0, -8.0, -2.0, 8.0, 0.0, -55.0, 0.0, 20.0, -16.0, 10.0, -5.0, -15.0, 5.0, -1.0, 0.0, 0.0, 29.0, -19.0, -11.0, 0.0, -17.0, -20.0, 10.0, 10.0, 0.0, 10.0, 19.0, 20.0, -5.0, 0.0, -3.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -3.0, -7.0, 10.0, 0.0, -2.0, 10.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 8.0, -1.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -20.0, -1.0, 0.0, 0.0, 4.0, 10.0, -3.0, 20.0, 0.0, 10.0, 0.0, -3.0, -1.0, 10.0, -2.0, 0.0, -4.0, -2.0, 7.0, 0.0, 36.0, 0.0, -1.0, 10.0, 0.0, 20.0, -3.0, -10.0, -4.0, 0.0, 30.0, 0.0, 4.0, 0.0, 5.0, -8.0, 10.0, -9.0, -10.0, 10.0, 5.0, 20.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 3.0, 7.0, 0.0, 10.0, -2.0, 8.0, -10.0, 10.0, -1.0, -4.0, 30.0, 7.0, -9.0, -20.0, -5.0, -26.0, 9.0, 9.0, 0.0, -2.0, 10.0, -75.0, 10.0, 0.0, 30.0, 0.0, 3.0, 20.0, 6.0, 4.0, 0.0, 9.0, -19.0, -1.0, -1.0, -12.0, 20.0, 5.0, 0.0, 0.0, 0.0, 5.0, -41.0, 0.0, 4.0, -1.0, 10.0, 0.0, 19.0, -2.0, 10.0, 0.0, -3.0, -11.0, 10.0, -1.0, 10.0, -8.0, 2.0, 9.0, 0.0, -2.0, 20.0, -6.0, 5.0, 0.0, -3.0, -3.0, -4.0, 0.0, 0.0, 4.0, 8.0, -2.0, 0.0, -6.0, 30.0, 0.0, 0.0, 0.0, 9.0, 13.0, -1.0, 20.0, 30.0, 0.0, -7.0, 0.0, 0.0, 17.0, 0.0, -2.0, 30.0, 0.0, 0.0, 0.0, 4.0, 0.0, 20.0, 20.0, 0.0, 0.0, -45.0, 0.0, -20.0, 10.0, 9.0, 0.0, 0.0, 10.0, 17.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -24.0, 10.0, -3.0, -27.0, -22.0, 10.0, 10.0, 0.0, 0.0, 7.0, -5.0, 9.0, 10.0, 10.0, -17.0, 10.0, -10.0, 0.0, -7.0, 0.0, -4.0, -11.0, 10.0, -6.0, 0.0, 10.0, 10.0, -8.0, -2.0, 20.0, -5.0, -2.0, 10.0, 20.0, 30.0, -1.0, -6.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, 16.0, 15.0, 20.0, -2.0, 40.0, 1.0, 0.0, -9.0, -18.0, -6.0, 20.0, 0.0, -8.0, 20.0, 6.0, -4.0, 30.0, -1.0, 9.0, 8.0, 30.0, -2.0, -3.0, 30.0, 0.0, 0.0, -3.0, -7.0, 18.0, -10.0, 7.0, 10.0, 10.0, 10.0, 0.0, 18.0, 22.0, 3.0, 0.0, 9.0, 19.0, -2.0, 20.0, 10.0, 26.0, -4.0, -1.0, -3.0, 9.0, -9.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 0.0, 20.0, 0.0, 20.0, 20.0, -17.0, -6.0, 6.0, -71.0, -13.0, 0.0, 5.0, -2.0, 0.0, -2.0, 0.0, 2.0, -10.0, 0.0, -2.0, 10.0, -6.0, 10.0, -3.0, 30.0, 0.0, 0.0, 0.0, 30.0, -3.0, 4.0, 22.0, -10.0, 4.0, 0.0, -5.0, 0.0, -2.0, -1.0, 4.0, 0.0, 0.0, -2.0, 0.0, 0.0, -12.0, -4.0, -4.0, 10.0, 0.0, -6.0, -2.0, 0.0, 10.0, -2.0, 10.0, 0.0, 0.0, 10.0, 10.0, -2.0, 0.0, 7.0, 10.0, -6.0, -2.0, 20.0, -2.0, -2.0, -4.0, 0.0, 7.0, 9.0, -12.0, 10.0, -8.0, -30.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 20.0, -14.0, 0.0, -5.0, 10.0, 6.0, -4.0, 0.0, 30.0, 10.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 20.0, -1.0, 15.0, 0.0, 10.0, 1.0, 19.0, -11.0, 8.0, 0.0, 0.0, 10.0, 3.0, -5.0, 0.0, -4.0, 7.0, 10.0, 0.0, 0.0, 20.0, -1.0, 10.0, 0.0, 0.0, -3.0, -5.0, -5.0, 5.0, 10.0, -1.0, -2.0, -4.0, 0.0, 9.0, -7.0, 20.0, 4.0, 0.0, -4.0, -4.0, -3.0, 0.0, -6.0, 6.0, 9.0, -14.0, -6.0, 10.0, 4.0, -2.0, -10.0, 5.0, 0.0, -12.0, 0.0, -7.0, -2.0, 10.0, -5.0, 10.0, -12.0, 10.0, -9.0, 0.0, -4.0, -5.0, -1.0, 20.0, 17.0, 0.0, -3.0, -13.0, 10.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.730143376717914, "mean_inference_ms": 7.098162129224318, "mean_action_processing_ms": 1.7589101240808669, "mean_env_wait_ms": 4.3407450350112615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2533869743347168, "StateBufferConnector_ms": 0.030219316482543945, "ViewRequirementAgentConnector_ms": 2.6094205379486084}, "num_episodes": 18, "episode_return_max": 103.0, "episode_return_min": -78.0, "episode_return_mean": 20.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.4039846316486333, "num_env_steps_trained_throughput_per_sec": 2.4039846316486333, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 398798.594, "restore_workers_time_ms": 0.022, "training_step_time_ms": 398798.513, "sample_time_ms": 9654.881, "learn_time_ms": 389111.734, "learn_throughput": 10.28, "synch_weights_time_ms": 20.686}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "6085c_00000", "date": "2024-07-01_23-12-23", "timestamp": 1719889943, "time_this_iter_s": 1663.9267101287842, "time_total_s": 2792.0443274974823, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e5430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2792.0443274974823, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 31.928089887640443, "ram_util_percent": 81.43932584269663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5760015969459245, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0502098988420285, "policy_loss": -0.0028802147498393988, "vf_loss": 3.052233005776065, "vf_explained_var": 0.029682356017593125, "kl": 0.00857106197272726, "entropy": 2.2085177630281296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 70425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 132.0, "episode_reward_min": -78.0, "episode_reward_mean": 25.19, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 50.0}, "policy_reward_mean": {"policy_0": 2.519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 103.0, -14.0, -43.0, -3.0, 70.0, 19.0, 18.0, 69.0, 9.0, 28.0, -1.0, -36.0, 13.0, 99.0, 8.0, -22.0, 10.0, -19.0, 31.0, -48.0, 88.0, 0.0, 19.0, 53.0, 51.0, 102.0, 27.0, 19.0, 26.0, 2.0, -54.0, -2.0, -8.0, 26.0, 4.0, 77.0, 13.0, 31.0, 66.0, 14.0, 38.0, 27.0, -10.0, -4.0, 11.0, -23.0, 24.0, 22.0, 30.0, 64.0, 49.0, -6.0, 32.0, -36.0, 34.0, -18.0, 72.0, 61.0, 18.0, 93.0, 55.0, 99.0, 78.0, 58.0, -78.0, -1.0, 77.0, -6.0, -8.0, 43.0, 8.0, 5.0, 33.0, 43.0, 25.0, 42.0, 4.0, 6.0, -16.0, -5.0, 23.0, 82.0, 126.0, -23.0, 76.0, 48.0, 132.0, 16.0, -21.0, 41.0, 63.0, 120.0, -27.0, 57.0, -27.0, 27.0, 53.0, -59.0, 23.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -4.0, -12.0, -8.0, 17.0, 0.0, 0.0, 0.0, -2.0, 13.0, 10.0, -6.0, -8.0, 16.0, 29.0, 6.0, 30.0, 0.0, 30.0, -4.0, -6.0, -17.0, 30.0, -7.0, -19.0, 6.0, 4.0, -1.0, -4.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, -7.0, -46.0, 0.0, -9.0, 9.0, 0.0, -3.0, 0.0, -15.0, 10.0, -10.0, 10.0, -1.0, -3.0, 10.0, 15.0, 10.0, 0.0, 10.0, 20.0, 20.0, -15.0, 0.0, 0.0, -8.0, 12.0, -16.0, 0.0, 20.0, -6.0, 2.0, -3.0, -2.0, 20.0, 10.0, 17.0, -4.0, 0.0, 10.0, -22.0, -3.0, 10.0, 0.0, 0.0, -5.0, 15.0, 25.0, 30.0, 0.0, -6.0, 0.0, 0.0, 0.0, 10.0, 0.0, 7.0, 10.0, 9.0, -8.0, 10.0, -6.0, -6.0, -1.0, -6.0, 8.0, 9.0, 5.0, -4.0, 12.0, 19.0, 8.0, -4.0, -20.0, -5.0, -8.0, -9.0, 0.0, -8.0, 0.0, 15.0, -11.0, 0.0, 10.0, 10.0, -16.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 10.0, 0.0, -7.0, 0.0, 0.0, -3.0, 0.0, 7.0, 10.0, -6.0, 5.0, 0.0, 0.0, 10.0, 14.0, 6.0, 10.0, 21.0, 20.0, 7.0, 11.0, 0.0, 0.0, 0.0, -8.0, -5.0, 0.0, 24.0, 0.0, -4.0, -4.0, 5.0, 0.0, 0.0, 10.0, -3.0, -4.0, -20.0, 0.0, -13.0, 20.0, 15.0, -27.0, -5.0, 0.0, 20.0, -6.0, 0.0, 0.0, 10.0, 0.0, -6.0, -3.0, -4.0, -4.0, -6.0, 18.0, -2.0, -2.0, -4.0, -2.0, -10.0, -3.0, -3.0, 2.0, 0.0, -5.0, 0.0, 17.0, 0.0, 0.0, 0.0, 20.0, -1.0, 0.0, -11.0, 0.0, 10.0, 0.0, -35.0, 10.0, -11.0, -10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 9.0, 20.0, 20.0, 9.0, 0.0, -4.0, -10.0, 6.0, -1.0, -12.0, 0.0, -4.0, 10.0, -2.0, 17.0, -1.0, 0.0, 0.0, 10.0, -11.0, 20.0, -3.0, 5.0, 0.0, -1.0, 10.0, -2.0, 10.0, 10.0, 0.0, -5.0, 0.0, 0.0, 10.0, 20.0, 17.0, 10.0, 8.0, 9.0, 0.0, 20.0, 0.0, -2.0, -9.0, -2.0, 0.0, 30.0, 20.0, 0.0, 0.0, -3.0, 0.0, 19.0, 40.0, -4.0, 9.0, 2.0, -9.0, 10.0, 28.0, -12.0, 10.0, 0.0, -11.0, 0.0, -1.0, 0.0, -7.0, 11.0, 10.0, 0.0, -5.0, 20.0, -6.0, -3.0, 0.0, -10.0, 10.0, 9.0, 10.0, -1.0, 10.0, 10.0, 0.0, -12.0, 10.0, -8.0, -1.0, 4.0, -3.0, 9.0, -17.0, 5.0, 10.0, -7.0, -15.0, 10.0, 20.0, -12.0, 0.0, -8.0, -2.0, 8.0, 0.0, -55.0, 0.0, 20.0, -16.0, 10.0, -5.0, -15.0, 5.0, -1.0, 0.0, 0.0, 29.0, -19.0, -11.0, 0.0, -17.0, -20.0, 10.0, 10.0, 0.0, 10.0, 19.0, 20.0, -5.0, 0.0, -3.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -3.0, -7.0, 10.0, 0.0, -2.0, 10.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 8.0, -1.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -20.0, -1.0, 0.0, 0.0, 4.0, 10.0, -3.0, 20.0, 0.0, 10.0, 0.0, -3.0, -1.0, 10.0, -2.0, 0.0, -4.0, -2.0, 7.0, 0.0, 36.0, 0.0, -1.0, 10.0, 0.0, 20.0, -3.0, -10.0, -4.0, 0.0, 30.0, 0.0, 4.0, 0.0, 5.0, -8.0, 10.0, -9.0, -10.0, 10.0, 5.0, 20.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 3.0, 7.0, 0.0, 10.0, -2.0, 8.0, -10.0, 10.0, -1.0, -4.0, 30.0, 7.0, -9.0, -20.0, -5.0, -26.0, 9.0, 9.0, 0.0, -2.0, 10.0, -75.0, 10.0, 0.0, 30.0, 0.0, 3.0, 20.0, 6.0, 4.0, 0.0, 9.0, -19.0, -1.0, -1.0, -12.0, 20.0, 5.0, 0.0, 0.0, 0.0, 5.0, -41.0, 0.0, 4.0, -1.0, 10.0, 0.0, 19.0, -2.0, 10.0, 0.0, -3.0, -11.0, 10.0, -1.0, 10.0, -8.0, 2.0, 9.0, 0.0, -2.0, 20.0, -6.0, 5.0, 0.0, -3.0, -3.0, -4.0, 0.0, 0.0, 4.0, 8.0, -2.0, 0.0, -6.0, 30.0, 0.0, 0.0, 0.0, 9.0, 13.0, -1.0, 20.0, 30.0, 0.0, -7.0, 0.0, 0.0, 17.0, 0.0, -2.0, 30.0, 0.0, 0.0, 0.0, 4.0, 0.0, 20.0, 20.0, 0.0, 0.0, -45.0, 0.0, -20.0, 10.0, 9.0, 0.0, 0.0, 10.0, 17.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -24.0, 10.0, -3.0, -27.0, -22.0, 10.0, 10.0, 0.0, 0.0, 7.0, -5.0, 9.0, 10.0, 10.0, -17.0, 10.0, -10.0, 0.0, -7.0, 0.0, -4.0, -11.0, 10.0, -6.0, 0.0, 10.0, 10.0, -8.0, -2.0, 20.0, -5.0, -2.0, 10.0, 20.0, 30.0, -1.0, -6.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, 16.0, 15.0, 20.0, -2.0, 40.0, 1.0, 0.0, -9.0, -18.0, -6.0, 20.0, 0.0, -8.0, 20.0, 6.0, -4.0, 30.0, -1.0, 9.0, 8.0, 30.0, -2.0, -3.0, 30.0, 0.0, 0.0, -3.0, -7.0, 18.0, -10.0, 7.0, 10.0, 10.0, 10.0, 0.0, 18.0, 22.0, 3.0, 0.0, 9.0, 19.0, -2.0, 20.0, 10.0, 26.0, -4.0, -1.0, -3.0, 9.0, -9.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 0.0, 20.0, 0.0, 20.0, 20.0, -17.0, -6.0, 6.0, -71.0, -13.0, 0.0, 5.0, -2.0, 0.0, -2.0, 0.0, 2.0, -10.0, 0.0, -2.0, 10.0, -6.0, 10.0, -3.0, 30.0, 0.0, 0.0, 0.0, 30.0, -3.0, 4.0, 22.0, -10.0, 4.0, 0.0, -5.0, 0.0, -2.0, -1.0, 4.0, 0.0, 0.0, -2.0, 0.0, 0.0, -12.0, -4.0, -4.0, 10.0, 0.0, -6.0, -2.0, 0.0, 10.0, -2.0, 10.0, 0.0, 0.0, 10.0, 10.0, -2.0, 0.0, 7.0, 10.0, -6.0, -2.0, 20.0, -2.0, -2.0, -4.0, 0.0, 7.0, 9.0, -12.0, 10.0, -8.0, -30.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 20.0, -14.0, 0.0, -5.0, 10.0, 6.0, -4.0, 0.0, 30.0, 10.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 20.0, -1.0, 15.0, 0.0, 10.0, 1.0, 19.0, -11.0, 8.0, 0.0, 0.0, 10.0, 3.0, -5.0, 0.0, -4.0, 7.0, 10.0, 0.0, 0.0, 20.0, -1.0, 10.0, 0.0, 0.0, -3.0, -5.0, -5.0, 5.0, 10.0, -1.0, -2.0, -4.0, 0.0, 9.0, -7.0, 20.0, 4.0, 0.0, -4.0, -4.0, -3.0, 0.0, -6.0, 6.0, 9.0, -14.0, -6.0, 10.0, 4.0, -2.0, -10.0, 5.0, 0.0, -12.0, 0.0, -7.0, -2.0, 10.0, -5.0, 10.0, -12.0, 10.0, -9.0, 0.0, -4.0, -5.0, -1.0, 20.0, 17.0, 0.0, -3.0, -13.0, 10.0, 2.0, 40.0, 4.0, -10.0, 10.0, 20.0, -7.0, 10.0, 10.0, 10.0, -5.0, 10.0, 30.0, 10.0, 10.0, -3.0, -9.0, 37.0, 2.0, 10.0, 29.0, -12.0, -1.0, -5.0, -2.0, -5.0, 20.0, -2.0, -25.0, 6.0, 3.0, 10.0, 10.0, 20.0, 20.0, 10.0, 3.0, -7.0, 10.0, 0.0, 0.0, 19.0, 17.0, 6.0, -7.0, 4.0, 0.0, 10.0, -1.0, 0.0, 0.0, 7.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 50.0, 5.0, -8.0, 10.0, 10.0, -2.0, -5.0, -1.0, -14.0, -1.0, 17.0, 10.0, -15.0, 9.0, -4.0, 0.0, -6.0, -11.0, 0.0, 0.0, 10.0, -4.0, 2.0, 7.0, 30.0, 10.0, 10.0, -18.0, -3.0, 0.0, -7.0, 10.0, 9.0, 10.0, 20.0, -4.0, -8.0, 6.0, -3.0, 0.0, 13.0, 20.0, 15.0, 0.0, 30.0, 0.0, -5.0, 0.0, 0.0, 0.0, 40.0, 40.0, -13.0, -2.0, -3.0, -5.0, 5.0, 8.0, -8.0, -1.0, -6.0, -2.0, 10.0, 0.0, -7.0, -3.0, 0.0, 29.0, 6.0, -3.0, 5.0, 20.0, 0.0, -27.0, 10.0, 2.0, -4.0, -6.0, 0.0, -4.0, -3.0, 5.0, -1.0, 0.0, 0.0, 5.0, 20.0, -5.0, -1.0, 0.0, 10.0, -1.0, 20.0, 0.0, 10.0, 0.0, -2.0, 7.0, 0.0, 0.0, -1.0, 19.0, -8.0, -9.0, 10.0, -25.0, -21.0, -16.0, 20.0, -10.0, -1.0, 1.0, -1.0, 0.0, 0.0, -3.0, 16.0, 6.0, -2.0, 0.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.725818925408363, "mean_inference_ms": 7.0506852241743125, "mean_action_processing_ms": 1.7638083457445886, "mean_env_wait_ms": 4.369011939904045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12672781944274902, "StateBufferConnector_ms": 0.018838882446289062, "ViewRequirementAgentConnector_ms": 2.082585334777832}, "num_episodes": 18, "episode_return_max": 132.0, "episode_return_min": -78.0, "episode_return_mean": 25.19, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.035833048158366, "num_env_steps_trained_throughput_per_sec": 33.035833048158366, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 364083.852, "restore_workers_time_ms": 0.021, "training_step_time_ms": 364083.775, "sample_time_ms": 8834.338, "learn_time_ms": 355219.112, "learn_throughput": 11.261, "synch_weights_time_ms": 19.477}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "6085c_00000", "date": "2024-07-01_23-14-24", "timestamp": 1719890064, "time_this_iter_s": 121.09445810317993, "time_total_s": 2913.1387856006622, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e5550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2913.1387856006622, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.127325581395347, "ram_util_percent": 79.8424418604651}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.765545325715956, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.124597500218624, "policy_loss": -0.0036903938773228005, "vf_loss": 3.1274555527110195, "vf_explained_var": 0.04280242346092281, "kl": 0.008323413894677471, "entropy": 2.175523683184379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 79815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 145.0, "episode_reward_min": -78.0, "episode_reward_mean": 29.09, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 60.0}, "policy_reward_mean": {"policy_0": 2.909}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, 31.0, -48.0, 88.0, 0.0, 19.0, 53.0, 51.0, 102.0, 27.0, 19.0, 26.0, 2.0, -54.0, -2.0, -8.0, 26.0, 4.0, 77.0, 13.0, 31.0, 66.0, 14.0, 38.0, 27.0, -10.0, -4.0, 11.0, -23.0, 24.0, 22.0, 30.0, 64.0, 49.0, -6.0, 32.0, -36.0, 34.0, -18.0, 72.0, 61.0, 18.0, 93.0, 55.0, 99.0, 78.0, 58.0, -78.0, -1.0, 77.0, -6.0, -8.0, 43.0, 8.0, 5.0, 33.0, 43.0, 25.0, 42.0, 4.0, 6.0, -16.0, -5.0, 23.0, 82.0, 126.0, -23.0, 76.0, 48.0, 132.0, 16.0, -21.0, 41.0, 63.0, 120.0, -27.0, 57.0, -27.0, 27.0, 53.0, -59.0, 23.0, 92.0, 26.0, -24.0, 39.0, 25.0, 32.0, 32.0, 10.0, 96.0, -11.0, 13.0, 73.0, 8.0, 99.0, 5.0, 23.0, 145.0, 38.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-4.0, -4.0, -6.0, 18.0, -2.0, -2.0, -4.0, -2.0, -10.0, -3.0, -3.0, 2.0, 0.0, -5.0, 0.0, 17.0, 0.0, 0.0, 0.0, 20.0, -1.0, 0.0, -11.0, 0.0, 10.0, 0.0, -35.0, 10.0, -11.0, -10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 9.0, 20.0, 20.0, 9.0, 0.0, -4.0, -10.0, 6.0, -1.0, -12.0, 0.0, -4.0, 10.0, -2.0, 17.0, -1.0, 0.0, 0.0, 10.0, -11.0, 20.0, -3.0, 5.0, 0.0, -1.0, 10.0, -2.0, 10.0, 10.0, 0.0, -5.0, 0.0, 0.0, 10.0, 20.0, 17.0, 10.0, 8.0, 9.0, 0.0, 20.0, 0.0, -2.0, -9.0, -2.0, 0.0, 30.0, 20.0, 0.0, 0.0, -3.0, 0.0, 19.0, 40.0, -4.0, 9.0, 2.0, -9.0, 10.0, 28.0, -12.0, 10.0, 0.0, -11.0, 0.0, -1.0, 0.0, -7.0, 11.0, 10.0, 0.0, -5.0, 20.0, -6.0, -3.0, 0.0, -10.0, 10.0, 9.0, 10.0, -1.0, 10.0, 10.0, 0.0, -12.0, 10.0, -8.0, -1.0, 4.0, -3.0, 9.0, -17.0, 5.0, 10.0, -7.0, -15.0, 10.0, 20.0, -12.0, 0.0, -8.0, -2.0, 8.0, 0.0, -55.0, 0.0, 20.0, -16.0, 10.0, -5.0, -15.0, 5.0, -1.0, 0.0, 0.0, 29.0, -19.0, -11.0, 0.0, -17.0, -20.0, 10.0, 10.0, 0.0, 10.0, 19.0, 20.0, -5.0, 0.0, -3.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -3.0, -7.0, 10.0, 0.0, -2.0, 10.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 8.0, -1.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -20.0, -1.0, 0.0, 0.0, 4.0, 10.0, -3.0, 20.0, 0.0, 10.0, 0.0, -3.0, -1.0, 10.0, -2.0, 0.0, -4.0, -2.0, 7.0, 0.0, 36.0, 0.0, -1.0, 10.0, 0.0, 20.0, -3.0, -10.0, -4.0, 0.0, 30.0, 0.0, 4.0, 0.0, 5.0, -8.0, 10.0, -9.0, -10.0, 10.0, 5.0, 20.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 3.0, 7.0, 0.0, 10.0, -2.0, 8.0, -10.0, 10.0, -1.0, -4.0, 30.0, 7.0, -9.0, -20.0, -5.0, -26.0, 9.0, 9.0, 0.0, -2.0, 10.0, -75.0, 10.0, 0.0, 30.0, 0.0, 3.0, 20.0, 6.0, 4.0, 0.0, 9.0, -19.0, -1.0, -1.0, -12.0, 20.0, 5.0, 0.0, 0.0, 0.0, 5.0, -41.0, 0.0, 4.0, -1.0, 10.0, 0.0, 19.0, -2.0, 10.0, 0.0, -3.0, -11.0, 10.0, -1.0, 10.0, -8.0, 2.0, 9.0, 0.0, -2.0, 20.0, -6.0, 5.0, 0.0, -3.0, -3.0, -4.0, 0.0, 0.0, 4.0, 8.0, -2.0, 0.0, -6.0, 30.0, 0.0, 0.0, 0.0, 9.0, 13.0, -1.0, 20.0, 30.0, 0.0, -7.0, 0.0, 0.0, 17.0, 0.0, -2.0, 30.0, 0.0, 0.0, 0.0, 4.0, 0.0, 20.0, 20.0, 0.0, 0.0, -45.0, 0.0, -20.0, 10.0, 9.0, 0.0, 0.0, 10.0, 17.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -24.0, 10.0, -3.0, -27.0, -22.0, 10.0, 10.0, 0.0, 0.0, 7.0, -5.0, 9.0, 10.0, 10.0, -17.0, 10.0, -10.0, 0.0, -7.0, 0.0, -4.0, -11.0, 10.0, -6.0, 0.0, 10.0, 10.0, -8.0, -2.0, 20.0, -5.0, -2.0, 10.0, 20.0, 30.0, -1.0, -6.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, 16.0, 15.0, 20.0, -2.0, 40.0, 1.0, 0.0, -9.0, -18.0, -6.0, 20.0, 0.0, -8.0, 20.0, 6.0, -4.0, 30.0, -1.0, 9.0, 8.0, 30.0, -2.0, -3.0, 30.0, 0.0, 0.0, -3.0, -7.0, 18.0, -10.0, 7.0, 10.0, 10.0, 10.0, 0.0, 18.0, 22.0, 3.0, 0.0, 9.0, 19.0, -2.0, 20.0, 10.0, 26.0, -4.0, -1.0, -3.0, 9.0, -9.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 0.0, 20.0, 0.0, 20.0, 20.0, -17.0, -6.0, 6.0, -71.0, -13.0, 0.0, 5.0, -2.0, 0.0, -2.0, 0.0, 2.0, -10.0, 0.0, -2.0, 10.0, -6.0, 10.0, -3.0, 30.0, 0.0, 0.0, 0.0, 30.0, -3.0, 4.0, 22.0, -10.0, 4.0, 0.0, -5.0, 0.0, -2.0, -1.0, 4.0, 0.0, 0.0, -2.0, 0.0, 0.0, -12.0, -4.0, -4.0, 10.0, 0.0, -6.0, -2.0, 0.0, 10.0, -2.0, 10.0, 0.0, 0.0, 10.0, 10.0, -2.0, 0.0, 7.0, 10.0, -6.0, -2.0, 20.0, -2.0, -2.0, -4.0, 0.0, 7.0, 9.0, -12.0, 10.0, -8.0, -30.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 20.0, -14.0, 0.0, -5.0, 10.0, 6.0, -4.0, 0.0, 30.0, 10.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 20.0, -1.0, 15.0, 0.0, 10.0, 1.0, 19.0, -11.0, 8.0, 0.0, 0.0, 10.0, 3.0, -5.0, 0.0, -4.0, 7.0, 10.0, 0.0, 0.0, 20.0, -1.0, 10.0, 0.0, 0.0, -3.0, -5.0, -5.0, 5.0, 10.0, -1.0, -2.0, -4.0, 0.0, 9.0, -7.0, 20.0, 4.0, 0.0, -4.0, -4.0, -3.0, 0.0, -6.0, 6.0, 9.0, -14.0, -6.0, 10.0, 4.0, -2.0, -10.0, 5.0, 0.0, -12.0, 0.0, -7.0, -2.0, 10.0, -5.0, 10.0, -12.0, 10.0, -9.0, 0.0, -4.0, -5.0, -1.0, 20.0, 17.0, 0.0, -3.0, -13.0, 10.0, 2.0, 40.0, 4.0, -10.0, 10.0, 20.0, -7.0, 10.0, 10.0, 10.0, -5.0, 10.0, 30.0, 10.0, 10.0, -3.0, -9.0, 37.0, 2.0, 10.0, 29.0, -12.0, -1.0, -5.0, -2.0, -5.0, 20.0, -2.0, -25.0, 6.0, 3.0, 10.0, 10.0, 20.0, 20.0, 10.0, 3.0, -7.0, 10.0, 0.0, 0.0, 19.0, 17.0, 6.0, -7.0, 4.0, 0.0, 10.0, -1.0, 0.0, 0.0, 7.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 50.0, 5.0, -8.0, 10.0, 10.0, -2.0, -5.0, -1.0, -14.0, -1.0, 17.0, 10.0, -15.0, 9.0, -4.0, 0.0, -6.0, -11.0, 0.0, 0.0, 10.0, -4.0, 2.0, 7.0, 30.0, 10.0, 10.0, -18.0, -3.0, 0.0, -7.0, 10.0, 9.0, 10.0, 20.0, -4.0, -8.0, 6.0, -3.0, 0.0, 13.0, 20.0, 15.0, 0.0, 30.0, 0.0, -5.0, 0.0, 0.0, 0.0, 40.0, 40.0, -13.0, -2.0, -3.0, -5.0, 5.0, 8.0, -8.0, -1.0, -6.0, -2.0, 10.0, 0.0, -7.0, -3.0, 0.0, 29.0, 6.0, -3.0, 5.0, 20.0, 0.0, -27.0, 10.0, 2.0, -4.0, -6.0, 0.0, -4.0, -3.0, 5.0, -1.0, 0.0, 0.0, 5.0, 20.0, -5.0, -1.0, 0.0, 10.0, -1.0, 20.0, 0.0, 10.0, 0.0, -2.0, 7.0, 0.0, 0.0, -1.0, 19.0, -8.0, -9.0, 10.0, -25.0, -21.0, -16.0, 20.0, -10.0, -1.0, 1.0, -1.0, 0.0, 0.0, -3.0, 16.0, 6.0, -2.0, 0.0, 0.0, 7.0, -2.0, -2.0, 18.0, 32.0, 10.0, 10.0, 28.0, -2.0, -7.0, 7.0, -1.0, 8.0, -2.0, 0.0, -3.0, 17.0, 17.0, 20.0, -1.0, -29.0, -5.0, 10.0, -26.0, 0.0, -7.0, -16.0, 0.0, 10.0, 10.0, 0.0, -1.0, 10.0, 20.0, 40.0, -26.0, 0.0, -1.0, -1.0, -2.0, 0.0, -4.0, 20.0, 0.0, 0.0, 0.0, -6.0, 10.0, 3.0, -3.0, 5.0, 9.0, -1.0, 0.0, -16.0, 20.0, -6.0, 30.0, -3.0, 0.0, -1.0, 20.0, -13.0, -7.0, 10.0, 0.0, 4.0, 10.0, -7.0, 0.0, 15.0, 0.0, -7.0, -14.0, 10.0, 0.0, 4.0, -3.0, 20.0, 0.0, 0.0, 10.0, 0.0, 8.0, 10.0, 10.0, 19.0, 10.0, 10.0, 19.0, 0.0, -1.0, 0.0, -11.0, -3.0, 10.0, 10.0, 0.0, 0.0, -6.0, -10.0, -15.0, 6.0, -2.0, 26.0, -4.0, 18.0, -3.0, -13.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -8.0, 0.0, 20.0, 1.0, 10.0, 30.0, -3.0, -13.0, 6.0, -1.0, 19.0, 7.0, 0.0, 0.0, -3.0, -4.0, 20.0, 20.0, 20.0, 9.0, -10.0, 30.0, 10.0, 0.0, 0.0, 0.0, -15.0, 0.0, -17.0, -9.0, 1.0, 23.0, 7.0, -5.0, 5.0, 15.0, -11.0, -9.0, 29.0, 30.0, 0.0, -10.0, 10.0, -8.0, -8.0, 0.0, -1.0, 0.0, 30.0, 18.0, 9.0, 10.0, 9.0, 10.0, 60.0, 0.0, 30.0, -9.0, -7.0, 12.0, 0.0, 0.0, -6.0, 20.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.4907691970664585, "mean_inference_ms": 6.676349948010169, "mean_action_processing_ms": 1.7169732891878584, "mean_env_wait_ms": 4.241593372678912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11614537239074707, "StateBufferConnector_ms": 0.01656651496887207, "ViewRequirementAgentConnector_ms": 1.9673991203308105}, "num_episodes": 18, "episode_return_max": 145.0, "episode_return_min": -78.0, "episode_return_mean": 29.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.892082167860856, "num_env_steps_trained_throughput_per_sec": 32.892082167860856, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 337142.294, "restore_workers_time_ms": 0.02, "training_step_time_ms": 337142.22, "sample_time_ms": 8140.035, "learn_time_ms": 328973.087, "learn_throughput": 12.159, "synch_weights_time_ms": 18.468}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "6085c_00000", "date": "2024-07-01_23-16-26", "timestamp": 1719890186, "time_this_iter_s": 121.62292408943176, "time_total_s": 3034.761709690094, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b912f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3034.761709690094, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.008092485549135, "ram_util_percent": 80.10289017341042}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.609447947744363, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5805447932376393, "policy_loss": -0.002923310938300178, "vf_loss": 3.58266202634135, "vf_explained_var": 0.0403452894113823, "kl": 0.008060746914701983, "entropy": 2.1515046477444764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 89205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 145.0, "episode_reward_min": -78.0, "episode_reward_mean": 34.71, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -71.0}, "policy_reward_max": {"policy_0": 60.0}, "policy_reward_mean": {"policy_0": 3.471}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, -23.0, 24.0, 22.0, 30.0, 64.0, 49.0, -6.0, 32.0, -36.0, 34.0, -18.0, 72.0, 61.0, 18.0, 93.0, 55.0, 99.0, 78.0, 58.0, -78.0, -1.0, 77.0, -6.0, -8.0, 43.0, 8.0, 5.0, 33.0, 43.0, 25.0, 42.0, 4.0, 6.0, -16.0, -5.0, 23.0, 82.0, 126.0, -23.0, 76.0, 48.0, 132.0, 16.0, -21.0, 41.0, 63.0, 120.0, -27.0, 57.0, -27.0, 27.0, 53.0, -59.0, 23.0, 92.0, 26.0, -24.0, 39.0, 25.0, 32.0, 32.0, 10.0, 96.0, -11.0, 13.0, 73.0, 8.0, 99.0, 5.0, 23.0, 145.0, 38.0, -29.0, 40.0, 73.0, 26.0, 93.0, 46.0, 16.0, 28.0, 64.0, 30.0, 10.0, 59.0, 72.0, 49.0, 30.0, -39.0, 114.0, -9.0, 79.0, -9.0, 36.0, 72.0, 22.0, 96.0, 25.0, 65.0, 72.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [6.0, 4.0, 0.0, 9.0, -19.0, -1.0, -1.0, -12.0, 20.0, 5.0, 0.0, 0.0, 0.0, 5.0, -41.0, 0.0, 4.0, -1.0, 10.0, 0.0, 19.0, -2.0, 10.0, 0.0, -3.0, -11.0, 10.0, -1.0, 10.0, -8.0, 2.0, 9.0, 0.0, -2.0, 20.0, -6.0, 5.0, 0.0, -3.0, -3.0, -4.0, 0.0, 0.0, 4.0, 8.0, -2.0, 0.0, -6.0, 30.0, 0.0, 0.0, 0.0, 9.0, 13.0, -1.0, 20.0, 30.0, 0.0, -7.0, 0.0, 0.0, 17.0, 0.0, -2.0, 30.0, 0.0, 0.0, 0.0, 4.0, 0.0, 20.0, 20.0, 0.0, 0.0, -45.0, 0.0, -20.0, 10.0, 9.0, 0.0, 0.0, 10.0, 17.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -24.0, 10.0, -3.0, -27.0, -22.0, 10.0, 10.0, 0.0, 0.0, 7.0, -5.0, 9.0, 10.0, 10.0, -17.0, 10.0, -10.0, 0.0, -7.0, 0.0, -4.0, -11.0, 10.0, -6.0, 0.0, 10.0, 10.0, -8.0, -2.0, 20.0, -5.0, -2.0, 10.0, 20.0, 30.0, -1.0, -6.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, 16.0, 15.0, 20.0, -2.0, 40.0, 1.0, 0.0, -9.0, -18.0, -6.0, 20.0, 0.0, -8.0, 20.0, 6.0, -4.0, 30.0, -1.0, 9.0, 8.0, 30.0, -2.0, -3.0, 30.0, 0.0, 0.0, -3.0, -7.0, 18.0, -10.0, 7.0, 10.0, 10.0, 10.0, 0.0, 18.0, 22.0, 3.0, 0.0, 9.0, 19.0, -2.0, 20.0, 10.0, 26.0, -4.0, -1.0, -3.0, 9.0, -9.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 0.0, 20.0, 0.0, 20.0, 20.0, -17.0, -6.0, 6.0, -71.0, -13.0, 0.0, 5.0, -2.0, 0.0, -2.0, 0.0, 2.0, -10.0, 0.0, -2.0, 10.0, -6.0, 10.0, -3.0, 30.0, 0.0, 0.0, 0.0, 30.0, -3.0, 4.0, 22.0, -10.0, 4.0, 0.0, -5.0, 0.0, -2.0, -1.0, 4.0, 0.0, 0.0, -2.0, 0.0, 0.0, -12.0, -4.0, -4.0, 10.0, 0.0, -6.0, -2.0, 0.0, 10.0, -2.0, 10.0, 0.0, 0.0, 10.0, 10.0, -2.0, 0.0, 7.0, 10.0, -6.0, -2.0, 20.0, -2.0, -2.0, -4.0, 0.0, 7.0, 9.0, -12.0, 10.0, -8.0, -30.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 20.0, -14.0, 0.0, -5.0, 10.0, 6.0, -4.0, 0.0, 30.0, 10.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 20.0, -1.0, 15.0, 0.0, 10.0, 1.0, 19.0, -11.0, 8.0, 0.0, 0.0, 10.0, 3.0, -5.0, 0.0, -4.0, 7.0, 10.0, 0.0, 0.0, 20.0, -1.0, 10.0, 0.0, 0.0, -3.0, -5.0, -5.0, 5.0, 10.0, -1.0, -2.0, -4.0, 0.0, 9.0, -7.0, 20.0, 4.0, 0.0, -4.0, -4.0, -3.0, 0.0, -6.0, 6.0, 9.0, -14.0, -6.0, 10.0, 4.0, -2.0, -10.0, 5.0, 0.0, -12.0, 0.0, -7.0, -2.0, 10.0, -5.0, 10.0, -12.0, 10.0, -9.0, 0.0, -4.0, -5.0, -1.0, 20.0, 17.0, 0.0, -3.0, -13.0, 10.0, 2.0, 40.0, 4.0, -10.0, 10.0, 20.0, -7.0, 10.0, 10.0, 10.0, -5.0, 10.0, 30.0, 10.0, 10.0, -3.0, -9.0, 37.0, 2.0, 10.0, 29.0, -12.0, -1.0, -5.0, -2.0, -5.0, 20.0, -2.0, -25.0, 6.0, 3.0, 10.0, 10.0, 20.0, 20.0, 10.0, 3.0, -7.0, 10.0, 0.0, 0.0, 19.0, 17.0, 6.0, -7.0, 4.0, 0.0, 10.0, -1.0, 0.0, 0.0, 7.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 50.0, 5.0, -8.0, 10.0, 10.0, -2.0, -5.0, -1.0, -14.0, -1.0, 17.0, 10.0, -15.0, 9.0, -4.0, 0.0, -6.0, -11.0, 0.0, 0.0, 10.0, -4.0, 2.0, 7.0, 30.0, 10.0, 10.0, -18.0, -3.0, 0.0, -7.0, 10.0, 9.0, 10.0, 20.0, -4.0, -8.0, 6.0, -3.0, 0.0, 13.0, 20.0, 15.0, 0.0, 30.0, 0.0, -5.0, 0.0, 0.0, 0.0, 40.0, 40.0, -13.0, -2.0, -3.0, -5.0, 5.0, 8.0, -8.0, -1.0, -6.0, -2.0, 10.0, 0.0, -7.0, -3.0, 0.0, 29.0, 6.0, -3.0, 5.0, 20.0, 0.0, -27.0, 10.0, 2.0, -4.0, -6.0, 0.0, -4.0, -3.0, 5.0, -1.0, 0.0, 0.0, 5.0, 20.0, -5.0, -1.0, 0.0, 10.0, -1.0, 20.0, 0.0, 10.0, 0.0, -2.0, 7.0, 0.0, 0.0, -1.0, 19.0, -8.0, -9.0, 10.0, -25.0, -21.0, -16.0, 20.0, -10.0, -1.0, 1.0, -1.0, 0.0, 0.0, -3.0, 16.0, 6.0, -2.0, 0.0, 0.0, 7.0, -2.0, -2.0, 18.0, 32.0, 10.0, 10.0, 28.0, -2.0, -7.0, 7.0, -1.0, 8.0, -2.0, 0.0, -3.0, 17.0, 17.0, 20.0, -1.0, -29.0, -5.0, 10.0, -26.0, 0.0, -7.0, -16.0, 0.0, 10.0, 10.0, 0.0, -1.0, 10.0, 20.0, 40.0, -26.0, 0.0, -1.0, -1.0, -2.0, 0.0, -4.0, 20.0, 0.0, 0.0, 0.0, -6.0, 10.0, 3.0, -3.0, 5.0, 9.0, -1.0, 0.0, -16.0, 20.0, -6.0, 30.0, -3.0, 0.0, -1.0, 20.0, -13.0, -7.0, 10.0, 0.0, 4.0, 10.0, -7.0, 0.0, 15.0, 0.0, -7.0, -14.0, 10.0, 0.0, 4.0, -3.0, 20.0, 0.0, 0.0, 10.0, 0.0, 8.0, 10.0, 10.0, 19.0, 10.0, 10.0, 19.0, 0.0, -1.0, 0.0, -11.0, -3.0, 10.0, 10.0, 0.0, 0.0, -6.0, -10.0, -15.0, 6.0, -2.0, 26.0, -4.0, 18.0, -3.0, -13.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -8.0, 0.0, 20.0, 1.0, 10.0, 30.0, -3.0, -13.0, 6.0, -1.0, 19.0, 7.0, 0.0, 0.0, -3.0, -4.0, 20.0, 20.0, 20.0, 9.0, -10.0, 30.0, 10.0, 0.0, 0.0, 0.0, -15.0, 0.0, -17.0, -9.0, 1.0, 23.0, 7.0, -5.0, 5.0, 15.0, -11.0, -9.0, 29.0, 30.0, 0.0, -10.0, 10.0, -8.0, -8.0, 0.0, -1.0, 0.0, 30.0, 18.0, 9.0, 10.0, 9.0, 10.0, 60.0, 0.0, 30.0, -9.0, -7.0, 12.0, 0.0, 0.0, -6.0, 20.0, -1.0, -1.0, -2.0, 6.0, -1.0, -6.0, 0.0, 0.0, 6.0, -8.0, -10.0, -14.0, -6.0, -10.0, 20.0, -6.0, 14.0, 20.0, 10.0, 13.0, -8.0, -7.0, 0.0, -1.0, -1.0, 0.0, 8.0, 30.0, 10.0, 7.0, -6.0, 26.0, -4.0, -1.0, 0.0, 0.0, -1.0, 4.0, 10.0, 20.0, -2.0, 0.0, 18.0, 9.0, -3.0, -2.0, 30.0, 20.0, -1.0, 16.0, -4.0, 10.0, 16.0, 7.0, -11.0, -7.0, -4.0, 0.0, 10.0, 20.0, -5.0, 20.0, -7.0, 20.0, 4.0, -26.0, 0.0, 0.0, -1.0, 0.0, -4.0, 30.0, -10.0, -21.0, 0.0, -13.0, 10.0, 14.0, 0.0, 10.0, -2.0, 40.0, 0.0, 0.0, -7.0, -3.0, 10.0, 50.0, 10.0, 20.0, -12.0, -4.0, -2.0, -13.0, 35.0, -1.0, 7.0, 0.0, 3.0, -1.0, -5.0, 7.0, -11.0, 6.0, 20.0, 0.0, -9.0, 0.0, 10.0, -8.0, -3.0, 5.0, 5.0, -3.0, 10.0, -12.0, 0.0, 21.0, 28.0, 0.0, 0.0, 10.0, 0.0, 0.0, -2.0, 26.0, 0.0, 20.0, 10.0, 0.0, 19.0, -1.0, 10.0, -8.0, 10.0, -6.0, 30.0, 20.0, 0.0, 0.0, -3.0, -4.0, 9.0, -12.0, 0.0, -1.0, 28.0, 2.0, -7.0, 0.0, 20.0, -9.0, -8.0, 19.0, -5.0, -9.0, 0.0, -4.0, -2.0, -12.0, -7.0, -11.0, 30.0, 0.0, 9.0, 20.0, 20.0, 4.0, 0.0, -9.0, 0.0, 40.0, -8.0, 7.0, -2.0, -4.0, -14.0, -5.0, -3.0, 0.0, 12.0, 8.0, 10.0, 10.0, 20.0, 10.0, -6.0, 10.0, 0.0, 10.0, -5.0, 20.0, -8.0, -5.0, -15.0, 35.0, 15.0, -8.0, -7.0, -6.0, -3.0, -7.0, 6.0, 2.0, -6.0, 30.0, 0.0, 0.0, 0.0, -4.0, -10.0, 18.0, 0.0, -1.0, -6.0, 0.0, 19.0, -8.0, -2.0, 20.0, 30.0, 20.0, -6.0, -5.0, 0.0, -8.0, 2.0, 0.0, 10.0, 31.0, 0.0, -2.0, 40.0, 0.0, 10.0, 0.0, 10.0, 28.0, 0.0, 10.0, 0.0, -2.0, -5.0, 20.0, 0.0, 0.0, -6.0, 19.0, 4.0, 0.0, -2.0, -5.0, 0.0, -2.0, -6.0, -7.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 8.0, 20.0, 18.0, -1.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.97563508169, "mean_inference_ms": 5.969688100532766, "mean_action_processing_ms": 1.5828559168018241, "mean_env_wait_ms": 3.8886932636084395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0818946361541748, "StateBufferConnector_ms": 0.013295412063598633, "ViewRequirementAgentConnector_ms": 0.7134802341461182}, "num_episodes": 27, "episode_return_max": 145.0, "episode_return_min": -78.0, "episode_return_mean": 34.71, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.2071834203436, "num_env_steps_trained_throughput_per_sec": 33.2071834203436, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 315473.652, "restore_workers_time_ms": 0.019, "training_step_time_ms": 315473.582, "sample_time_ms": 7622.035, "learn_time_ms": 307823.484, "learn_throughput": 12.994, "synch_weights_time_ms": 17.76}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 10, "trial_id": "6085c_00000", "date": "2024-07-01_23-18-27", "timestamp": 1719890307, "time_this_iter_s": 120.46680903434753, "time_total_s": 3155.2285187244415, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b91511f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3155.2285187244415, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.338823529411762, "ram_util_percent": 81.02411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.25053875848762, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5762760519600523, "policy_loss": -0.0028281894171411116, "vf_loss": 3.578391038952544, "vf_explained_var": 0.015974438120635807, "kl": 0.007132018804989781, "entropy": 2.1266182824826467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 98595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 218.0, "episode_reward_min": -78.0, "episode_reward_mean": 40.94, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -71.0}, "policy_reward_max": {"policy_0": 149.0}, "policy_reward_mean": {"policy_0": 4.094}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.0, 58.0, -78.0, -1.0, 77.0, -6.0, -8.0, 43.0, 8.0, 5.0, 33.0, 43.0, 25.0, 42.0, 4.0, 6.0, -16.0, -5.0, 23.0, 82.0, 126.0, -23.0, 76.0, 48.0, 132.0, 16.0, -21.0, 41.0, 63.0, 120.0, -27.0, 57.0, -27.0, 27.0, 53.0, -59.0, 23.0, 92.0, 26.0, -24.0, 39.0, 25.0, 32.0, 32.0, 10.0, 96.0, -11.0, 13.0, 73.0, 8.0, 99.0, 5.0, 23.0, 145.0, 38.0, -29.0, 40.0, 73.0, 26.0, 93.0, 46.0, 16.0, 28.0, 64.0, 30.0, 10.0, 59.0, 72.0, 49.0, 30.0, -39.0, 114.0, -9.0, 79.0, -9.0, 36.0, 72.0, 22.0, 96.0, 25.0, 65.0, 72.0, 64.0, 53.0, 12.0, 69.0, 54.0, 63.0, -29.0, 75.0, 66.0, 145.0, 70.0, 218.0, 10.0, 42.0, 124.0, 64.0, 20.0, 84.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 26.0, -4.0, -1.0, -3.0, 9.0, -9.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 0.0, 20.0, 0.0, 20.0, 20.0, -17.0, -6.0, 6.0, -71.0, -13.0, 0.0, 5.0, -2.0, 0.0, -2.0, 0.0, 2.0, -10.0, 0.0, -2.0, 10.0, -6.0, 10.0, -3.0, 30.0, 0.0, 0.0, 0.0, 30.0, -3.0, 4.0, 22.0, -10.0, 4.0, 0.0, -5.0, 0.0, -2.0, -1.0, 4.0, 0.0, 0.0, -2.0, 0.0, 0.0, -12.0, -4.0, -4.0, 10.0, 0.0, -6.0, -2.0, 0.0, 10.0, -2.0, 10.0, 0.0, 0.0, 10.0, 10.0, -2.0, 0.0, 7.0, 10.0, -6.0, -2.0, 20.0, -2.0, -2.0, -4.0, 0.0, 7.0, 9.0, -12.0, 10.0, -8.0, -30.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 20.0, -14.0, 0.0, -5.0, 10.0, 6.0, -4.0, 0.0, 30.0, 10.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 20.0, -1.0, 15.0, 0.0, 10.0, 1.0, 19.0, -11.0, 8.0, 0.0, 0.0, 10.0, 3.0, -5.0, 0.0, -4.0, 7.0, 10.0, 0.0, 0.0, 20.0, -1.0, 10.0, 0.0, 0.0, -3.0, -5.0, -5.0, 5.0, 10.0, -1.0, -2.0, -4.0, 0.0, 9.0, -7.0, 20.0, 4.0, 0.0, -4.0, -4.0, -3.0, 0.0, -6.0, 6.0, 9.0, -14.0, -6.0, 10.0, 4.0, -2.0, -10.0, 5.0, 0.0, -12.0, 0.0, -7.0, -2.0, 10.0, -5.0, 10.0, -12.0, 10.0, -9.0, 0.0, -4.0, -5.0, -1.0, 20.0, 17.0, 0.0, -3.0, -13.0, 10.0, 2.0, 40.0, 4.0, -10.0, 10.0, 20.0, -7.0, 10.0, 10.0, 10.0, -5.0, 10.0, 30.0, 10.0, 10.0, -3.0, -9.0, 37.0, 2.0, 10.0, 29.0, -12.0, -1.0, -5.0, -2.0, -5.0, 20.0, -2.0, -25.0, 6.0, 3.0, 10.0, 10.0, 20.0, 20.0, 10.0, 3.0, -7.0, 10.0, 0.0, 0.0, 19.0, 17.0, 6.0, -7.0, 4.0, 0.0, 10.0, -1.0, 0.0, 0.0, 7.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 50.0, 5.0, -8.0, 10.0, 10.0, -2.0, -5.0, -1.0, -14.0, -1.0, 17.0, 10.0, -15.0, 9.0, -4.0, 0.0, -6.0, -11.0, 0.0, 0.0, 10.0, -4.0, 2.0, 7.0, 30.0, 10.0, 10.0, -18.0, -3.0, 0.0, -7.0, 10.0, 9.0, 10.0, 20.0, -4.0, -8.0, 6.0, -3.0, 0.0, 13.0, 20.0, 15.0, 0.0, 30.0, 0.0, -5.0, 0.0, 0.0, 0.0, 40.0, 40.0, -13.0, -2.0, -3.0, -5.0, 5.0, 8.0, -8.0, -1.0, -6.0, -2.0, 10.0, 0.0, -7.0, -3.0, 0.0, 29.0, 6.0, -3.0, 5.0, 20.0, 0.0, -27.0, 10.0, 2.0, -4.0, -6.0, 0.0, -4.0, -3.0, 5.0, -1.0, 0.0, 0.0, 5.0, 20.0, -5.0, -1.0, 0.0, 10.0, -1.0, 20.0, 0.0, 10.0, 0.0, -2.0, 7.0, 0.0, 0.0, -1.0, 19.0, -8.0, -9.0, 10.0, -25.0, -21.0, -16.0, 20.0, -10.0, -1.0, 1.0, -1.0, 0.0, 0.0, -3.0, 16.0, 6.0, -2.0, 0.0, 0.0, 7.0, -2.0, -2.0, 18.0, 32.0, 10.0, 10.0, 28.0, -2.0, -7.0, 7.0, -1.0, 8.0, -2.0, 0.0, -3.0, 17.0, 17.0, 20.0, -1.0, -29.0, -5.0, 10.0, -26.0, 0.0, -7.0, -16.0, 0.0, 10.0, 10.0, 0.0, -1.0, 10.0, 20.0, 40.0, -26.0, 0.0, -1.0, -1.0, -2.0, 0.0, -4.0, 20.0, 0.0, 0.0, 0.0, -6.0, 10.0, 3.0, -3.0, 5.0, 9.0, -1.0, 0.0, -16.0, 20.0, -6.0, 30.0, -3.0, 0.0, -1.0, 20.0, -13.0, -7.0, 10.0, 0.0, 4.0, 10.0, -7.0, 0.0, 15.0, 0.0, -7.0, -14.0, 10.0, 0.0, 4.0, -3.0, 20.0, 0.0, 0.0, 10.0, 0.0, 8.0, 10.0, 10.0, 19.0, 10.0, 10.0, 19.0, 0.0, -1.0, 0.0, -11.0, -3.0, 10.0, 10.0, 0.0, 0.0, -6.0, -10.0, -15.0, 6.0, -2.0, 26.0, -4.0, 18.0, -3.0, -13.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -8.0, 0.0, 20.0, 1.0, 10.0, 30.0, -3.0, -13.0, 6.0, -1.0, 19.0, 7.0, 0.0, 0.0, -3.0, -4.0, 20.0, 20.0, 20.0, 9.0, -10.0, 30.0, 10.0, 0.0, 0.0, 0.0, -15.0, 0.0, -17.0, -9.0, 1.0, 23.0, 7.0, -5.0, 5.0, 15.0, -11.0, -9.0, 29.0, 30.0, 0.0, -10.0, 10.0, -8.0, -8.0, 0.0, -1.0, 0.0, 30.0, 18.0, 9.0, 10.0, 9.0, 10.0, 60.0, 0.0, 30.0, -9.0, -7.0, 12.0, 0.0, 0.0, -6.0, 20.0, -1.0, -1.0, -2.0, 6.0, -1.0, -6.0, 0.0, 0.0, 6.0, -8.0, -10.0, -14.0, -6.0, -10.0, 20.0, -6.0, 14.0, 20.0, 10.0, 13.0, -8.0, -7.0, 0.0, -1.0, -1.0, 0.0, 8.0, 30.0, 10.0, 7.0, -6.0, 26.0, -4.0, -1.0, 0.0, 0.0, -1.0, 4.0, 10.0, 20.0, -2.0, 0.0, 18.0, 9.0, -3.0, -2.0, 30.0, 20.0, -1.0, 16.0, -4.0, 10.0, 16.0, 7.0, -11.0, -7.0, -4.0, 0.0, 10.0, 20.0, -5.0, 20.0, -7.0, 20.0, 4.0, -26.0, 0.0, 0.0, -1.0, 0.0, -4.0, 30.0, -10.0, -21.0, 0.0, -13.0, 10.0, 14.0, 0.0, 10.0, -2.0, 40.0, 0.0, 0.0, -7.0, -3.0, 10.0, 50.0, 10.0, 20.0, -12.0, -4.0, -2.0, -13.0, 35.0, -1.0, 7.0, 0.0, 3.0, -1.0, -5.0, 7.0, -11.0, 6.0, 20.0, 0.0, -9.0, 0.0, 10.0, -8.0, -3.0, 5.0, 5.0, -3.0, 10.0, -12.0, 0.0, 21.0, 28.0, 0.0, 0.0, 10.0, 0.0, 0.0, -2.0, 26.0, 0.0, 20.0, 10.0, 0.0, 19.0, -1.0, 10.0, -8.0, 10.0, -6.0, 30.0, 20.0, 0.0, 0.0, -3.0, -4.0, 9.0, -12.0, 0.0, -1.0, 28.0, 2.0, -7.0, 0.0, 20.0, -9.0, -8.0, 19.0, -5.0, -9.0, 0.0, -4.0, -2.0, -12.0, -7.0, -11.0, 30.0, 0.0, 9.0, 20.0, 20.0, 4.0, 0.0, -9.0, 0.0, 40.0, -8.0, 7.0, -2.0, -4.0, -14.0, -5.0, -3.0, 0.0, 12.0, 8.0, 10.0, 10.0, 20.0, 10.0, -6.0, 10.0, 0.0, 10.0, -5.0, 20.0, -8.0, -5.0, -15.0, 35.0, 15.0, -8.0, -7.0, -6.0, -3.0, -7.0, 6.0, 2.0, -6.0, 30.0, 0.0, 0.0, 0.0, -4.0, -10.0, 18.0, 0.0, -1.0, -6.0, 0.0, 19.0, -8.0, -2.0, 20.0, 30.0, 20.0, -6.0, -5.0, 0.0, -8.0, 2.0, 0.0, 10.0, 31.0, 0.0, -2.0, 40.0, 0.0, 10.0, 0.0, 10.0, 28.0, 0.0, 10.0, 0.0, -2.0, -5.0, 20.0, 0.0, 0.0, -6.0, 19.0, 4.0, 0.0, -2.0, -5.0, 0.0, -2.0, -6.0, -7.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 8.0, 20.0, 18.0, -1.0, 7.0, 0.0, 0.0, 30.0, 0.0, 10.0, -4.0, 30.0, -2.0, -1.0, -3.0, -2.0, 6.0, 0.0, 8.0, 2.0, 0.0, 0.0, 14.0, 10.0, -5.0, 0.0, 24.0, 0.0, 10.0, -14.0, 10.0, 2.0, 19.0, -25.0, 20.0, -10.0, 0.0, 16.0, 4.0, -9.0, 0.0, 32.0, -9.0, -5.0, 27.0, 3.0, 10.0, 20.0, 20.0, 0.0, -3.0, -3.0, 9.0, 29.0, -3.0, -5.0, -10.0, 10.0, 9.0, -17.0, 9.0, 28.0, 0.0, 9.0, -5.0, 10.0, 10.0, 7.0, -24.0, -10.0, 0.0, -4.0, 20.0, -15.0, 0.0, -16.0, 13.0, 20.0, 8.0, 8.0, -7.0, 10.0, 6.0, 7.0, 0.0, 8.0, 15.0, 3.0, 0.0, -5.0, 24.0, 0.0, 0.0, 4.0, 30.0, 0.0, 10.0, 7.0, 24.0, 20.0, -1.0, 16.0, -1.0, 20.0, 50.0, 0.0, 10.0, -1.0, 17.0, 0.0, -1.0, 19.0, 19.0, 0.0, -3.0, 0.0, 20.0, -1.0, 0.0, 40.0, 149.0, 10.0, 24.0, 10.0, 0.0, -24.0, 10.0, 0.0, 0.0, 18.0, 0.0, 10.0, -7.0, -3.0, 0.0, -8.0, 0.0, 30.0, -13.0, 13.0, 18.0, -14.0, 0.0, -1.0, 0.0, 0.0, 9.0, 10.0, 20.0, 10.0, 18.0, 30.0, -1.0, 19.0, 9.0, 9.0, 0.0, 20.0, 18.0, -3.0, -3.0, 10.0, 0.0, -2.0, -7.0, 20.0, 11.0, 20.0, 0.0, -2.0, -2.0, 3.0, 10.0, -8.0, 0.0, -1.0, 0.0, 15.0, 6.0, 10.0, 20.0, -15.0, 20.0, -13.0, -5.0, 46.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.614598528640048, "mean_inference_ms": 5.50363039662413, "mean_action_processing_ms": 1.4835501891644642, "mean_env_wait_ms": 3.6180111759878093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07085871696472168, "StateBufferConnector_ms": 0.010213375091552734, "ViewRequirementAgentConnector_ms": 0.5199391841888428}, "num_episodes": 18, "episode_return_max": 218.0, "episode_return_min": -78.0, "episode_return_mean": 40.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.91384400704383, "num_env_steps_trained_throughput_per_sec": 32.91384400704383, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 310820.515, "restore_workers_time_ms": 0.018, "training_step_time_ms": 310820.446, "sample_time_ms": 7532.817, "learn_time_ms": 303259.857, "learn_throughput": 13.19, "synch_weights_time_ms": 17.217}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 11, "trial_id": "6085c_00000", "date": "2024-07-01_23-20-28", "timestamp": 1719890428, "time_this_iter_s": 121.54206418991089, "time_total_s": 3276.7705829143524, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3276.7705829143524, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 29.29360465116279, "ram_util_percent": 80.90406976744185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9021010221510775, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.356704620152109, "policy_loss": -0.0017287403247909297, "vf_loss": 3.357877461953412, "vf_explained_var": 0.021807841053659033, "kl": 0.005558959596447003, "entropy": 2.110154348719742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 107985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 218.0, "episode_reward_min": -82.0, "episode_reward_mean": 50.02, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -70.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 5.002}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 82.0, 126.0, -23.0, 76.0, 48.0, 132.0, 16.0, -21.0, 41.0, 63.0, 120.0, -27.0, 57.0, -27.0, 27.0, 53.0, -59.0, 23.0, 92.0, 26.0, -24.0, 39.0, 25.0, 32.0, 32.0, 10.0, 96.0, -11.0, 13.0, 73.0, 8.0, 99.0, 5.0, 23.0, 145.0, 38.0, -29.0, 40.0, 73.0, 26.0, 93.0, 46.0, 16.0, 28.0, 64.0, 30.0, 10.0, 59.0, 72.0, 49.0, 30.0, -39.0, 114.0, -9.0, 79.0, -9.0, 36.0, 72.0, 22.0, 96.0, 25.0, 65.0, 72.0, 64.0, 53.0, 12.0, 69.0, 54.0, 63.0, -29.0, 75.0, 66.0, 145.0, 70.0, 218.0, 10.0, 42.0, 124.0, 64.0, 20.0, 84.0, 32.0, -11.0, 112.0, 26.0, 216.0, 68.0, 107.0, 54.0, 155.0, 69.0, 105.0, 87.0, 34.0, 83.0, -82.0, 158.0, 34.0, -31.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-4.0, -5.0, -1.0, 20.0, 17.0, 0.0, -3.0, -13.0, 10.0, 2.0, 40.0, 4.0, -10.0, 10.0, 20.0, -7.0, 10.0, 10.0, 10.0, -5.0, 10.0, 30.0, 10.0, 10.0, -3.0, -9.0, 37.0, 2.0, 10.0, 29.0, -12.0, -1.0, -5.0, -2.0, -5.0, 20.0, -2.0, -25.0, 6.0, 3.0, 10.0, 10.0, 20.0, 20.0, 10.0, 3.0, -7.0, 10.0, 0.0, 0.0, 19.0, 17.0, 6.0, -7.0, 4.0, 0.0, 10.0, -1.0, 0.0, 0.0, 7.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 10.0, 50.0, 5.0, -8.0, 10.0, 10.0, -2.0, -5.0, -1.0, -14.0, -1.0, 17.0, 10.0, -15.0, 9.0, -4.0, 0.0, -6.0, -11.0, 0.0, 0.0, 10.0, -4.0, 2.0, 7.0, 30.0, 10.0, 10.0, -18.0, -3.0, 0.0, -7.0, 10.0, 9.0, 10.0, 20.0, -4.0, -8.0, 6.0, -3.0, 0.0, 13.0, 20.0, 15.0, 0.0, 30.0, 0.0, -5.0, 0.0, 0.0, 0.0, 40.0, 40.0, -13.0, -2.0, -3.0, -5.0, 5.0, 8.0, -8.0, -1.0, -6.0, -2.0, 10.0, 0.0, -7.0, -3.0, 0.0, 29.0, 6.0, -3.0, 5.0, 20.0, 0.0, -27.0, 10.0, 2.0, -4.0, -6.0, 0.0, -4.0, -3.0, 5.0, -1.0, 0.0, 0.0, 5.0, 20.0, -5.0, -1.0, 0.0, 10.0, -1.0, 20.0, 0.0, 10.0, 0.0, -2.0, 7.0, 0.0, 0.0, -1.0, 19.0, -8.0, -9.0, 10.0, -25.0, -21.0, -16.0, 20.0, -10.0, -1.0, 1.0, -1.0, 0.0, 0.0, -3.0, 16.0, 6.0, -2.0, 0.0, 0.0, 7.0, -2.0, -2.0, 18.0, 32.0, 10.0, 10.0, 28.0, -2.0, -7.0, 7.0, -1.0, 8.0, -2.0, 0.0, -3.0, 17.0, 17.0, 20.0, -1.0, -29.0, -5.0, 10.0, -26.0, 0.0, -7.0, -16.0, 0.0, 10.0, 10.0, 0.0, -1.0, 10.0, 20.0, 40.0, -26.0, 0.0, -1.0, -1.0, -2.0, 0.0, -4.0, 20.0, 0.0, 0.0, 0.0, -6.0, 10.0, 3.0, -3.0, 5.0, 9.0, -1.0, 0.0, -16.0, 20.0, -6.0, 30.0, -3.0, 0.0, -1.0, 20.0, -13.0, -7.0, 10.0, 0.0, 4.0, 10.0, -7.0, 0.0, 15.0, 0.0, -7.0, -14.0, 10.0, 0.0, 4.0, -3.0, 20.0, 0.0, 0.0, 10.0, 0.0, 8.0, 10.0, 10.0, 19.0, 10.0, 10.0, 19.0, 0.0, -1.0, 0.0, -11.0, -3.0, 10.0, 10.0, 0.0, 0.0, -6.0, -10.0, -15.0, 6.0, -2.0, 26.0, -4.0, 18.0, -3.0, -13.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -8.0, 0.0, 20.0, 1.0, 10.0, 30.0, -3.0, -13.0, 6.0, -1.0, 19.0, 7.0, 0.0, 0.0, -3.0, -4.0, 20.0, 20.0, 20.0, 9.0, -10.0, 30.0, 10.0, 0.0, 0.0, 0.0, -15.0, 0.0, -17.0, -9.0, 1.0, 23.0, 7.0, -5.0, 5.0, 15.0, -11.0, -9.0, 29.0, 30.0, 0.0, -10.0, 10.0, -8.0, -8.0, 0.0, -1.0, 0.0, 30.0, 18.0, 9.0, 10.0, 9.0, 10.0, 60.0, 0.0, 30.0, -9.0, -7.0, 12.0, 0.0, 0.0, -6.0, 20.0, -1.0, -1.0, -2.0, 6.0, -1.0, -6.0, 0.0, 0.0, 6.0, -8.0, -10.0, -14.0, -6.0, -10.0, 20.0, -6.0, 14.0, 20.0, 10.0, 13.0, -8.0, -7.0, 0.0, -1.0, -1.0, 0.0, 8.0, 30.0, 10.0, 7.0, -6.0, 26.0, -4.0, -1.0, 0.0, 0.0, -1.0, 4.0, 10.0, 20.0, -2.0, 0.0, 18.0, 9.0, -3.0, -2.0, 30.0, 20.0, -1.0, 16.0, -4.0, 10.0, 16.0, 7.0, -11.0, -7.0, -4.0, 0.0, 10.0, 20.0, -5.0, 20.0, -7.0, 20.0, 4.0, -26.0, 0.0, 0.0, -1.0, 0.0, -4.0, 30.0, -10.0, -21.0, 0.0, -13.0, 10.0, 14.0, 0.0, 10.0, -2.0, 40.0, 0.0, 0.0, -7.0, -3.0, 10.0, 50.0, 10.0, 20.0, -12.0, -4.0, -2.0, -13.0, 35.0, -1.0, 7.0, 0.0, 3.0, -1.0, -5.0, 7.0, -11.0, 6.0, 20.0, 0.0, -9.0, 0.0, 10.0, -8.0, -3.0, 5.0, 5.0, -3.0, 10.0, -12.0, 0.0, 21.0, 28.0, 0.0, 0.0, 10.0, 0.0, 0.0, -2.0, 26.0, 0.0, 20.0, 10.0, 0.0, 19.0, -1.0, 10.0, -8.0, 10.0, -6.0, 30.0, 20.0, 0.0, 0.0, -3.0, -4.0, 9.0, -12.0, 0.0, -1.0, 28.0, 2.0, -7.0, 0.0, 20.0, -9.0, -8.0, 19.0, -5.0, -9.0, 0.0, -4.0, -2.0, -12.0, -7.0, -11.0, 30.0, 0.0, 9.0, 20.0, 20.0, 4.0, 0.0, -9.0, 0.0, 40.0, -8.0, 7.0, -2.0, -4.0, -14.0, -5.0, -3.0, 0.0, 12.0, 8.0, 10.0, 10.0, 20.0, 10.0, -6.0, 10.0, 0.0, 10.0, -5.0, 20.0, -8.0, -5.0, -15.0, 35.0, 15.0, -8.0, -7.0, -6.0, -3.0, -7.0, 6.0, 2.0, -6.0, 30.0, 0.0, 0.0, 0.0, -4.0, -10.0, 18.0, 0.0, -1.0, -6.0, 0.0, 19.0, -8.0, -2.0, 20.0, 30.0, 20.0, -6.0, -5.0, 0.0, -8.0, 2.0, 0.0, 10.0, 31.0, 0.0, -2.0, 40.0, 0.0, 10.0, 0.0, 10.0, 28.0, 0.0, 10.0, 0.0, -2.0, -5.0, 20.0, 0.0, 0.0, -6.0, 19.0, 4.0, 0.0, -2.0, -5.0, 0.0, -2.0, -6.0, -7.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 8.0, 20.0, 18.0, -1.0, 7.0, 0.0, 0.0, 30.0, 0.0, 10.0, -4.0, 30.0, -2.0, -1.0, -3.0, -2.0, 6.0, 0.0, 8.0, 2.0, 0.0, 0.0, 14.0, 10.0, -5.0, 0.0, 24.0, 0.0, 10.0, -14.0, 10.0, 2.0, 19.0, -25.0, 20.0, -10.0, 0.0, 16.0, 4.0, -9.0, 0.0, 32.0, -9.0, -5.0, 27.0, 3.0, 10.0, 20.0, 20.0, 0.0, -3.0, -3.0, 9.0, 29.0, -3.0, -5.0, -10.0, 10.0, 9.0, -17.0, 9.0, 28.0, 0.0, 9.0, -5.0, 10.0, 10.0, 7.0, -24.0, -10.0, 0.0, -4.0, 20.0, -15.0, 0.0, -16.0, 13.0, 20.0, 8.0, 8.0, -7.0, 10.0, 6.0, 7.0, 0.0, 8.0, 15.0, 3.0, 0.0, -5.0, 24.0, 0.0, 0.0, 4.0, 30.0, 0.0, 10.0, 7.0, 24.0, 20.0, -1.0, 16.0, -1.0, 20.0, 50.0, 0.0, 10.0, -1.0, 17.0, 0.0, -1.0, 19.0, 19.0, 0.0, -3.0, 0.0, 20.0, -1.0, 0.0, 40.0, 149.0, 10.0, 24.0, 10.0, 0.0, -24.0, 10.0, 0.0, 0.0, 18.0, 0.0, 10.0, -7.0, -3.0, 0.0, -8.0, 0.0, 30.0, -13.0, 13.0, 18.0, -14.0, 0.0, -1.0, 0.0, 0.0, 9.0, 10.0, 20.0, 10.0, 18.0, 30.0, -1.0, 19.0, 9.0, 9.0, 0.0, 20.0, 18.0, -3.0, -3.0, 10.0, 0.0, -2.0, -7.0, 20.0, 11.0, 20.0, 0.0, -2.0, -2.0, 3.0, 10.0, -8.0, 0.0, -1.0, 0.0, 15.0, 6.0, 10.0, 20.0, -15.0, 20.0, -13.0, -5.0, 46.0, 0.0, 10.0, -2.0, 0.0, 9.0, 8.0, 10.0, 10.0, 10.0, -12.0, -11.0, 10.0, -12.0, 9.0, 10.0, 0.0, 0.0, 30.0, -70.0, 2.0, 10.0, 10.0, 18.0, 5.0, 0.0, 10.0, 0.0, -1.0, 40.0, 20.0, 10.0, 0.0, 16.0, 40.0, -7.0, -4.0, 4.0, -9.0, 0.0, 0.0, -14.0, 0.0, -30.0, 270.0, -50.0, 5.0, 0.0, -3.0, 39.0, -15.0, 0.0, 44.0, -13.0, 10.0, 15.0, 0.0, 0.0, 6.0, 7.0, -10.0, 9.0, -3.0, 8.0, 30.0, 0.0, 13.0, 10.0, 0.0, 19.0, 10.0, 20.0, 8.0, 0.0, 0.0, 10.0, 16.0, -10.0, 30.0, -5.0, -5.0, 10.0, 19.0, 25.0, 0.0, 39.0, 9.0, -3.0, -6.0, 30.0, -6.0, 48.0, 10.0, 8.0, 10.0, 0.0, 0.0, 4.0, -1.0, 10.0, 13.0, 15.0, 5.0, -10.0, 30.0, 10.0, 3.0, -8.0, 16.0, -4.0, 50.0, 13.0, 10.0, 10.0, 20.0, -6.0, 30.0, 0.0, -5.0, 30.0, -2.0, 0.0, 0.0, -8.0, -13.0, 38.0, 10.0, -3.0, -5.0, 13.0, 2.0, 0.0, 30.0, 18.0, -2.0, -2.0, 10.0, 10.0, 0.0, 10.0, 10.0, -1.0, -15.0, -14.0, -5.0, -29.0, -4.0, 0.0, -9.0, -20.0, 20.0, -6.0, 0.0, 10.0, 30.0, 10.0, 20.0, 20.0, -1.0, 7.0, -3.0, 65.0, 16.0, 1.0, -1.0, -5.0, 0.0, 14.0, 0.0, 0.0, 20.0, -11.0, -1.0, -1.0, 10.0, -5.0, -7.0, -3.0, 0.0, -10.0, -7.0, -7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.321545194557925, "mean_inference_ms": 5.132809710300026, "mean_action_processing_ms": 1.4026571578712703, "mean_env_wait_ms": 3.398286232388896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06831049919128418, "StateBufferConnector_ms": 0.010100603103637695, "ViewRequirementAgentConnector_ms": 0.48870396614074707}, "num_episodes": 18, "episode_return_max": 218.0, "episode_return_min": -82.0, "episode_return_mean": 50.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.25513503713259, "num_env_steps_trained_throughput_per_sec": 32.25513503713259, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 306491.239, "restore_workers_time_ms": 0.018, "training_step_time_ms": 306491.17, "sample_time_ms": 6947.886, "learn_time_ms": 299515.449, "learn_throughput": 13.355, "synch_weights_time_ms": 17.164}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 12, "trial_id": "6085c_00000", "date": "2024-07-01_23-22-32", "timestamp": 1719890552, "time_this_iter_s": 124.02316474914551, "time_total_s": 3400.793747663498, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b91513a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3400.793747663498, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.73657142857143, "ram_util_percent": 80.95828571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.167298929709088, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4151084387010404, "policy_loss": -0.005393405226706423, "vf_loss": 3.419570299586295, "vf_explained_var": 0.022172130607822325, "kl": 0.009315440107230701, "entropy": 2.0838662911527837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 117375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 283.0, "episode_reward_min": -82.0, "episode_reward_mean": 53.68, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -70.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 5.368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 92.0, 26.0, -24.0, 39.0, 25.0, 32.0, 32.0, 10.0, 96.0, -11.0, 13.0, 73.0, 8.0, 99.0, 5.0, 23.0, 145.0, 38.0, -29.0, 40.0, 73.0, 26.0, 93.0, 46.0, 16.0, 28.0, 64.0, 30.0, 10.0, 59.0, 72.0, 49.0, 30.0, -39.0, 114.0, -9.0, 79.0, -9.0, 36.0, 72.0, 22.0, 96.0, 25.0, 65.0, 72.0, 64.0, 53.0, 12.0, 69.0, 54.0, 63.0, -29.0, 75.0, 66.0, 145.0, 70.0, 218.0, 10.0, 42.0, 124.0, 64.0, 20.0, 84.0, 32.0, -11.0, 112.0, 26.0, 216.0, 68.0, 107.0, 54.0, 155.0, 69.0, 105.0, 87.0, 34.0, 83.0, -82.0, 158.0, 34.0, -31.0, 65.0, -37.0, -13.0, 136.0, 283.0, 17.0, 63.0, 66.0, 9.0, 70.0, 54.0, 55.0, 11.0, 121.0, 105.0, 25.0, 72.0, -29.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-1.0, 0.0, 0.0, -3.0, 16.0, 6.0, -2.0, 0.0, 0.0, 7.0, -2.0, -2.0, 18.0, 32.0, 10.0, 10.0, 28.0, -2.0, -7.0, 7.0, -1.0, 8.0, -2.0, 0.0, -3.0, 17.0, 17.0, 20.0, -1.0, -29.0, -5.0, 10.0, -26.0, 0.0, -7.0, -16.0, 0.0, 10.0, 10.0, 0.0, -1.0, 10.0, 20.0, 40.0, -26.0, 0.0, -1.0, -1.0, -2.0, 0.0, -4.0, 20.0, 0.0, 0.0, 0.0, -6.0, 10.0, 3.0, -3.0, 5.0, 9.0, -1.0, 0.0, -16.0, 20.0, -6.0, 30.0, -3.0, 0.0, -1.0, 20.0, -13.0, -7.0, 10.0, 0.0, 4.0, 10.0, -7.0, 0.0, 15.0, 0.0, -7.0, -14.0, 10.0, 0.0, 4.0, -3.0, 20.0, 0.0, 0.0, 10.0, 0.0, 8.0, 10.0, 10.0, 19.0, 10.0, 10.0, 19.0, 0.0, -1.0, 0.0, -11.0, -3.0, 10.0, 10.0, 0.0, 0.0, -6.0, -10.0, -15.0, 6.0, -2.0, 26.0, -4.0, 18.0, -3.0, -13.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -8.0, 0.0, 20.0, 1.0, 10.0, 30.0, -3.0, -13.0, 6.0, -1.0, 19.0, 7.0, 0.0, 0.0, -3.0, -4.0, 20.0, 20.0, 20.0, 9.0, -10.0, 30.0, 10.0, 0.0, 0.0, 0.0, -15.0, 0.0, -17.0, -9.0, 1.0, 23.0, 7.0, -5.0, 5.0, 15.0, -11.0, -9.0, 29.0, 30.0, 0.0, -10.0, 10.0, -8.0, -8.0, 0.0, -1.0, 0.0, 30.0, 18.0, 9.0, 10.0, 9.0, 10.0, 60.0, 0.0, 30.0, -9.0, -7.0, 12.0, 0.0, 0.0, -6.0, 20.0, -1.0, -1.0, -2.0, 6.0, -1.0, -6.0, 0.0, 0.0, 6.0, -8.0, -10.0, -14.0, -6.0, -10.0, 20.0, -6.0, 14.0, 20.0, 10.0, 13.0, -8.0, -7.0, 0.0, -1.0, -1.0, 0.0, 8.0, 30.0, 10.0, 7.0, -6.0, 26.0, -4.0, -1.0, 0.0, 0.0, -1.0, 4.0, 10.0, 20.0, -2.0, 0.0, 18.0, 9.0, -3.0, -2.0, 30.0, 20.0, -1.0, 16.0, -4.0, 10.0, 16.0, 7.0, -11.0, -7.0, -4.0, 0.0, 10.0, 20.0, -5.0, 20.0, -7.0, 20.0, 4.0, -26.0, 0.0, 0.0, -1.0, 0.0, -4.0, 30.0, -10.0, -21.0, 0.0, -13.0, 10.0, 14.0, 0.0, 10.0, -2.0, 40.0, 0.0, 0.0, -7.0, -3.0, 10.0, 50.0, 10.0, 20.0, -12.0, -4.0, -2.0, -13.0, 35.0, -1.0, 7.0, 0.0, 3.0, -1.0, -5.0, 7.0, -11.0, 6.0, 20.0, 0.0, -9.0, 0.0, 10.0, -8.0, -3.0, 5.0, 5.0, -3.0, 10.0, -12.0, 0.0, 21.0, 28.0, 0.0, 0.0, 10.0, 0.0, 0.0, -2.0, 26.0, 0.0, 20.0, 10.0, 0.0, 19.0, -1.0, 10.0, -8.0, 10.0, -6.0, 30.0, 20.0, 0.0, 0.0, -3.0, -4.0, 9.0, -12.0, 0.0, -1.0, 28.0, 2.0, -7.0, 0.0, 20.0, -9.0, -8.0, 19.0, -5.0, -9.0, 0.0, -4.0, -2.0, -12.0, -7.0, -11.0, 30.0, 0.0, 9.0, 20.0, 20.0, 4.0, 0.0, -9.0, 0.0, 40.0, -8.0, 7.0, -2.0, -4.0, -14.0, -5.0, -3.0, 0.0, 12.0, 8.0, 10.0, 10.0, 20.0, 10.0, -6.0, 10.0, 0.0, 10.0, -5.0, 20.0, -8.0, -5.0, -15.0, 35.0, 15.0, -8.0, -7.0, -6.0, -3.0, -7.0, 6.0, 2.0, -6.0, 30.0, 0.0, 0.0, 0.0, -4.0, -10.0, 18.0, 0.0, -1.0, -6.0, 0.0, 19.0, -8.0, -2.0, 20.0, 30.0, 20.0, -6.0, -5.0, 0.0, -8.0, 2.0, 0.0, 10.0, 31.0, 0.0, -2.0, 40.0, 0.0, 10.0, 0.0, 10.0, 28.0, 0.0, 10.0, 0.0, -2.0, -5.0, 20.0, 0.0, 0.0, -6.0, 19.0, 4.0, 0.0, -2.0, -5.0, 0.0, -2.0, -6.0, -7.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 8.0, 20.0, 18.0, -1.0, 7.0, 0.0, 0.0, 30.0, 0.0, 10.0, -4.0, 30.0, -2.0, -1.0, -3.0, -2.0, 6.0, 0.0, 8.0, 2.0, 0.0, 0.0, 14.0, 10.0, -5.0, 0.0, 24.0, 0.0, 10.0, -14.0, 10.0, 2.0, 19.0, -25.0, 20.0, -10.0, 0.0, 16.0, 4.0, -9.0, 0.0, 32.0, -9.0, -5.0, 27.0, 3.0, 10.0, 20.0, 20.0, 0.0, -3.0, -3.0, 9.0, 29.0, -3.0, -5.0, -10.0, 10.0, 9.0, -17.0, 9.0, 28.0, 0.0, 9.0, -5.0, 10.0, 10.0, 7.0, -24.0, -10.0, 0.0, -4.0, 20.0, -15.0, 0.0, -16.0, 13.0, 20.0, 8.0, 8.0, -7.0, 10.0, 6.0, 7.0, 0.0, 8.0, 15.0, 3.0, 0.0, -5.0, 24.0, 0.0, 0.0, 4.0, 30.0, 0.0, 10.0, 7.0, 24.0, 20.0, -1.0, 16.0, -1.0, 20.0, 50.0, 0.0, 10.0, -1.0, 17.0, 0.0, -1.0, 19.0, 19.0, 0.0, -3.0, 0.0, 20.0, -1.0, 0.0, 40.0, 149.0, 10.0, 24.0, 10.0, 0.0, -24.0, 10.0, 0.0, 0.0, 18.0, 0.0, 10.0, -7.0, -3.0, 0.0, -8.0, 0.0, 30.0, -13.0, 13.0, 18.0, -14.0, 0.0, -1.0, 0.0, 0.0, 9.0, 10.0, 20.0, 10.0, 18.0, 30.0, -1.0, 19.0, 9.0, 9.0, 0.0, 20.0, 18.0, -3.0, -3.0, 10.0, 0.0, -2.0, -7.0, 20.0, 11.0, 20.0, 0.0, -2.0, -2.0, 3.0, 10.0, -8.0, 0.0, -1.0, 0.0, 15.0, 6.0, 10.0, 20.0, -15.0, 20.0, -13.0, -5.0, 46.0, 0.0, 10.0, -2.0, 0.0, 9.0, 8.0, 10.0, 10.0, 10.0, -12.0, -11.0, 10.0, -12.0, 9.0, 10.0, 0.0, 0.0, 30.0, -70.0, 2.0, 10.0, 10.0, 18.0, 5.0, 0.0, 10.0, 0.0, -1.0, 40.0, 20.0, 10.0, 0.0, 16.0, 40.0, -7.0, -4.0, 4.0, -9.0, 0.0, 0.0, -14.0, 0.0, -30.0, 270.0, -50.0, 5.0, 0.0, -3.0, 39.0, -15.0, 0.0, 44.0, -13.0, 10.0, 15.0, 0.0, 0.0, 6.0, 7.0, -10.0, 9.0, -3.0, 8.0, 30.0, 0.0, 13.0, 10.0, 0.0, 19.0, 10.0, 20.0, 8.0, 0.0, 0.0, 10.0, 16.0, -10.0, 30.0, -5.0, -5.0, 10.0, 19.0, 25.0, 0.0, 39.0, 9.0, -3.0, -6.0, 30.0, -6.0, 48.0, 10.0, 8.0, 10.0, 0.0, 0.0, 4.0, -1.0, 10.0, 13.0, 15.0, 5.0, -10.0, 30.0, 10.0, 3.0, -8.0, 16.0, -4.0, 50.0, 13.0, 10.0, 10.0, 20.0, -6.0, 30.0, 0.0, -5.0, 30.0, -2.0, 0.0, 0.0, -8.0, -13.0, 38.0, 10.0, -3.0, -5.0, 13.0, 2.0, 0.0, 30.0, 18.0, -2.0, -2.0, 10.0, 10.0, 0.0, 10.0, 10.0, -1.0, -15.0, -14.0, -5.0, -29.0, -4.0, 0.0, -9.0, -20.0, 20.0, -6.0, 0.0, 10.0, 30.0, 10.0, 20.0, 20.0, -1.0, 7.0, -3.0, 65.0, 16.0, 1.0, -1.0, -5.0, 0.0, 14.0, 0.0, 0.0, 20.0, -11.0, -1.0, -1.0, 10.0, -5.0, -7.0, -3.0, 0.0, -10.0, -7.0, -7.0, 20.0, 0.0, 0.0, 10.0, -1.0, 0.0, 10.0, 8.0, 0.0, 18.0, -5.0, -4.0, 0.0, 0.0, -1.0, -3.0, -12.0, -10.0, -12.0, 10.0, -2.0, 0.0, 10.0, -8.0, -10.0, 16.0, -4.0, -11.0, -14.0, 10.0, 16.0, -3.0, 10.0, 40.0, 16.0, 0.0, 7.0, 20.0, 30.0, 0.0, -13.0, -9.0, 280.0, -2.0, -19.0, -6.0, 30.0, 11.0, 7.0, 4.0, 10.0, 10.0, -5.0, -1.0, 1.0, 12.0, -15.0, -5.0, 10.0, 0.0, 6.0, 0.0, 35.0, 0.0, -7.0, 21.0, 10.0, -13.0, 3.0, 8.0, 7.0, 0.0, 16.0, 0.0, 10.0, 0.0, 20.0, -3.0, 0.0, 16.0, 0.0, 0.0, -2.0, -12.0, -8.0, 5.0, -3.0, 20.0, 2.0, 7.0, 37.0, 0.0, 7.0, -1.0, -1.0, -2.0, 20.0, 10.0, 0.0, 0.0, 10.0, 8.0, 10.0, 0.0, 10.0, 0.0, -3.0, 0.0, 20.0, -1.0, 16.0, 20.0, -2.0, -4.0, 0.0, -11.0, 10.0, 7.0, 9.0, 10.0, -15.0, 8.0, 30.0, -14.0, -15.0, 0.0, 0.0, 20.0, -3.0, 0.0, 70.0, 6.0, 10.0, 1.0, 30.0, -12.0, 10.0, 10.0, -1.0, -3.0, 0.0, 10.0, 0.0, 0.0, 20.0, 8.0, 18.0, 9.0, 20.0, 20.0, -13.0, 40.0, 25.0, -3.0, 15.0, -9.0, -5.0, -18.0, -7.0, 0.0, -5.0, 18.0, 10.0, -5.0, -5.0, 28.0, -7.0, 35.0, -3.0, 6.0, -13.0, -3.0, 20.0, 0.0, 0.0, -30.0, 40.0, 8.0, -51.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.083005412226539, "mean_inference_ms": 4.836558311620734, "mean_action_processing_ms": 1.3371167136846167, "mean_env_wait_ms": 3.220454112472124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06540966033935547, "StateBufferConnector_ms": 0.010024309158325195, "ViewRequirementAgentConnector_ms": 0.48570966720581055}, "num_episodes": 18, "episode_return_max": 283.0, "episode_return_min": -82.0, "episode_return_mean": 53.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.77128474523797, "num_env_steps_trained_throughput_per_sec": 32.77128474523797, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 298502.931, "restore_workers_time_ms": 0.016, "training_step_time_ms": 298502.866, "sample_time_ms": 5933.987, "learn_time_ms": 292541.873, "learn_throughput": 13.673, "synch_weights_time_ms": 16.858}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 13, "trial_id": "6085c_00000", "date": "2024-07-01_23-24-34", "timestamp": 1719890674, "time_this_iter_s": 122.07193613052368, "time_total_s": 3522.8656837940216, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3522.8656837940216, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 28.506358381502892, "ram_util_percent": 80.59421965317918}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4530112328239904, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6350128317031616, "policy_loss": -0.0033483940818623756, "vf_loss": 3.6375932926060166, "vf_explained_var": 0.007925544683925641, "kl": 0.007679323537531174, "entropy": 2.0784706000195015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 126765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 283.0, "episode_reward_min": -82.0, "episode_reward_mean": 65.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 6.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, -29.0, 40.0, 73.0, 26.0, 93.0, 46.0, 16.0, 28.0, 64.0, 30.0, 10.0, 59.0, 72.0, 49.0, 30.0, -39.0, 114.0, -9.0, 79.0, -9.0, 36.0, 72.0, 22.0, 96.0, 25.0, 65.0, 72.0, 64.0, 53.0, 12.0, 69.0, 54.0, 63.0, -29.0, 75.0, 66.0, 145.0, 70.0, 218.0, 10.0, 42.0, 124.0, 64.0, 20.0, 84.0, 32.0, -11.0, 112.0, 26.0, 216.0, 68.0, 107.0, 54.0, 155.0, 69.0, 105.0, 87.0, 34.0, 83.0, -82.0, 158.0, 34.0, -31.0, 65.0, -37.0, -13.0, 136.0, 283.0, 17.0, 63.0, 66.0, 9.0, 70.0, 54.0, 55.0, 11.0, 121.0, 105.0, 25.0, 72.0, -29.0, 67.0, 248.0, 176.0, 82.0, 71.0, 85.0, 224.0, 96.0, 71.0, 66.0, 58.0, 135.0, 32.0, 198.0, -31.0, 120.0, 107.0, 83.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, -9.0, -7.0, 12.0, 0.0, 0.0, -6.0, 20.0, -1.0, -1.0, -2.0, 6.0, -1.0, -6.0, 0.0, 0.0, 6.0, -8.0, -10.0, -14.0, -6.0, -10.0, 20.0, -6.0, 14.0, 20.0, 10.0, 13.0, -8.0, -7.0, 0.0, -1.0, -1.0, 0.0, 8.0, 30.0, 10.0, 7.0, -6.0, 26.0, -4.0, -1.0, 0.0, 0.0, -1.0, 4.0, 10.0, 20.0, -2.0, 0.0, 18.0, 9.0, -3.0, -2.0, 30.0, 20.0, -1.0, 16.0, -4.0, 10.0, 16.0, 7.0, -11.0, -7.0, -4.0, 0.0, 10.0, 20.0, -5.0, 20.0, -7.0, 20.0, 4.0, -26.0, 0.0, 0.0, -1.0, 0.0, -4.0, 30.0, -10.0, -21.0, 0.0, -13.0, 10.0, 14.0, 0.0, 10.0, -2.0, 40.0, 0.0, 0.0, -7.0, -3.0, 10.0, 50.0, 10.0, 20.0, -12.0, -4.0, -2.0, -13.0, 35.0, -1.0, 7.0, 0.0, 3.0, -1.0, -5.0, 7.0, -11.0, 6.0, 20.0, 0.0, -9.0, 0.0, 10.0, -8.0, -3.0, 5.0, 5.0, -3.0, 10.0, -12.0, 0.0, 21.0, 28.0, 0.0, 0.0, 10.0, 0.0, 0.0, -2.0, 26.0, 0.0, 20.0, 10.0, 0.0, 19.0, -1.0, 10.0, -8.0, 10.0, -6.0, 30.0, 20.0, 0.0, 0.0, -3.0, -4.0, 9.0, -12.0, 0.0, -1.0, 28.0, 2.0, -7.0, 0.0, 20.0, -9.0, -8.0, 19.0, -5.0, -9.0, 0.0, -4.0, -2.0, -12.0, -7.0, -11.0, 30.0, 0.0, 9.0, 20.0, 20.0, 4.0, 0.0, -9.0, 0.0, 40.0, -8.0, 7.0, -2.0, -4.0, -14.0, -5.0, -3.0, 0.0, 12.0, 8.0, 10.0, 10.0, 20.0, 10.0, -6.0, 10.0, 0.0, 10.0, -5.0, 20.0, -8.0, -5.0, -15.0, 35.0, 15.0, -8.0, -7.0, -6.0, -3.0, -7.0, 6.0, 2.0, -6.0, 30.0, 0.0, 0.0, 0.0, -4.0, -10.0, 18.0, 0.0, -1.0, -6.0, 0.0, 19.0, -8.0, -2.0, 20.0, 30.0, 20.0, -6.0, -5.0, 0.0, -8.0, 2.0, 0.0, 10.0, 31.0, 0.0, -2.0, 40.0, 0.0, 10.0, 0.0, 10.0, 28.0, 0.0, 10.0, 0.0, -2.0, -5.0, 20.0, 0.0, 0.0, -6.0, 19.0, 4.0, 0.0, -2.0, -5.0, 0.0, -2.0, -6.0, -7.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 8.0, 20.0, 18.0, -1.0, 7.0, 0.0, 0.0, 30.0, 0.0, 10.0, -4.0, 30.0, -2.0, -1.0, -3.0, -2.0, 6.0, 0.0, 8.0, 2.0, 0.0, 0.0, 14.0, 10.0, -5.0, 0.0, 24.0, 0.0, 10.0, -14.0, 10.0, 2.0, 19.0, -25.0, 20.0, -10.0, 0.0, 16.0, 4.0, -9.0, 0.0, 32.0, -9.0, -5.0, 27.0, 3.0, 10.0, 20.0, 20.0, 0.0, -3.0, -3.0, 9.0, 29.0, -3.0, -5.0, -10.0, 10.0, 9.0, -17.0, 9.0, 28.0, 0.0, 9.0, -5.0, 10.0, 10.0, 7.0, -24.0, -10.0, 0.0, -4.0, 20.0, -15.0, 0.0, -16.0, 13.0, 20.0, 8.0, 8.0, -7.0, 10.0, 6.0, 7.0, 0.0, 8.0, 15.0, 3.0, 0.0, -5.0, 24.0, 0.0, 0.0, 4.0, 30.0, 0.0, 10.0, 7.0, 24.0, 20.0, -1.0, 16.0, -1.0, 20.0, 50.0, 0.0, 10.0, -1.0, 17.0, 0.0, -1.0, 19.0, 19.0, 0.0, -3.0, 0.0, 20.0, -1.0, 0.0, 40.0, 149.0, 10.0, 24.0, 10.0, 0.0, -24.0, 10.0, 0.0, 0.0, 18.0, 0.0, 10.0, -7.0, -3.0, 0.0, -8.0, 0.0, 30.0, -13.0, 13.0, 18.0, -14.0, 0.0, -1.0, 0.0, 0.0, 9.0, 10.0, 20.0, 10.0, 18.0, 30.0, -1.0, 19.0, 9.0, 9.0, 0.0, 20.0, 18.0, -3.0, -3.0, 10.0, 0.0, -2.0, -7.0, 20.0, 11.0, 20.0, 0.0, -2.0, -2.0, 3.0, 10.0, -8.0, 0.0, -1.0, 0.0, 15.0, 6.0, 10.0, 20.0, -15.0, 20.0, -13.0, -5.0, 46.0, 0.0, 10.0, -2.0, 0.0, 9.0, 8.0, 10.0, 10.0, 10.0, -12.0, -11.0, 10.0, -12.0, 9.0, 10.0, 0.0, 0.0, 30.0, -70.0, 2.0, 10.0, 10.0, 18.0, 5.0, 0.0, 10.0, 0.0, -1.0, 40.0, 20.0, 10.0, 0.0, 16.0, 40.0, -7.0, -4.0, 4.0, -9.0, 0.0, 0.0, -14.0, 0.0, -30.0, 270.0, -50.0, 5.0, 0.0, -3.0, 39.0, -15.0, 0.0, 44.0, -13.0, 10.0, 15.0, 0.0, 0.0, 6.0, 7.0, -10.0, 9.0, -3.0, 8.0, 30.0, 0.0, 13.0, 10.0, 0.0, 19.0, 10.0, 20.0, 8.0, 0.0, 0.0, 10.0, 16.0, -10.0, 30.0, -5.0, -5.0, 10.0, 19.0, 25.0, 0.0, 39.0, 9.0, -3.0, -6.0, 30.0, -6.0, 48.0, 10.0, 8.0, 10.0, 0.0, 0.0, 4.0, -1.0, 10.0, 13.0, 15.0, 5.0, -10.0, 30.0, 10.0, 3.0, -8.0, 16.0, -4.0, 50.0, 13.0, 10.0, 10.0, 20.0, -6.0, 30.0, 0.0, -5.0, 30.0, -2.0, 0.0, 0.0, -8.0, -13.0, 38.0, 10.0, -3.0, -5.0, 13.0, 2.0, 0.0, 30.0, 18.0, -2.0, -2.0, 10.0, 10.0, 0.0, 10.0, 10.0, -1.0, -15.0, -14.0, -5.0, -29.0, -4.0, 0.0, -9.0, -20.0, 20.0, -6.0, 0.0, 10.0, 30.0, 10.0, 20.0, 20.0, -1.0, 7.0, -3.0, 65.0, 16.0, 1.0, -1.0, -5.0, 0.0, 14.0, 0.0, 0.0, 20.0, -11.0, -1.0, -1.0, 10.0, -5.0, -7.0, -3.0, 0.0, -10.0, -7.0, -7.0, 20.0, 0.0, 0.0, 10.0, -1.0, 0.0, 10.0, 8.0, 0.0, 18.0, -5.0, -4.0, 0.0, 0.0, -1.0, -3.0, -12.0, -10.0, -12.0, 10.0, -2.0, 0.0, 10.0, -8.0, -10.0, 16.0, -4.0, -11.0, -14.0, 10.0, 16.0, -3.0, 10.0, 40.0, 16.0, 0.0, 7.0, 20.0, 30.0, 0.0, -13.0, -9.0, 280.0, -2.0, -19.0, -6.0, 30.0, 11.0, 7.0, 4.0, 10.0, 10.0, -5.0, -1.0, 1.0, 12.0, -15.0, -5.0, 10.0, 0.0, 6.0, 0.0, 35.0, 0.0, -7.0, 21.0, 10.0, -13.0, 3.0, 8.0, 7.0, 0.0, 16.0, 0.0, 10.0, 0.0, 20.0, -3.0, 0.0, 16.0, 0.0, 0.0, -2.0, -12.0, -8.0, 5.0, -3.0, 20.0, 2.0, 7.0, 37.0, 0.0, 7.0, -1.0, -1.0, -2.0, 20.0, 10.0, 0.0, 0.0, 10.0, 8.0, 10.0, 0.0, 10.0, 0.0, -3.0, 0.0, 20.0, -1.0, 16.0, 20.0, -2.0, -4.0, 0.0, -11.0, 10.0, 7.0, 9.0, 10.0, -15.0, 8.0, 30.0, -14.0, -15.0, 0.0, 0.0, 20.0, -3.0, 0.0, 70.0, 6.0, 10.0, 1.0, 30.0, -12.0, 10.0, 10.0, -1.0, -3.0, 0.0, 10.0, 0.0, 0.0, 20.0, 8.0, 18.0, 9.0, 20.0, 20.0, -13.0, 40.0, 25.0, -3.0, 15.0, -9.0, -5.0, -18.0, -7.0, 0.0, -5.0, 18.0, 10.0, -5.0, -5.0, 28.0, -7.0, 35.0, -3.0, 6.0, -13.0, -3.0, 20.0, 0.0, 0.0, -30.0, 40.0, 8.0, -51.0, 0.0, 7.0, 20.0, -3.0, 18.0, -4.0, 10.0, -11.0, 0.0, 10.0, 20.0, 0.0, 13.0, 40.0, 260.0, 0.0, 20.0, -50.0, -30.0, -5.0, 0.0, 60.0, 20.0, 20.0, -1.0, 10.0, 20.0, 10.0, 10.0, 7.0, 20.0, 20.0, 0.0, -3.0, 0.0, 0.0, 29.0, 16.0, 0.0, -5.0, 25.0, 0.0, 10.0, -5.0, -1.0, 10.0, 7.0, 15.0, 30.0, 0.0, 5.0, 30.0, 0.0, 16.0, 0.0, 20.0, 0.0, 0.0, 30.0, -5.0, -6.0, 20.0, 0.0, 0.0, 10.0, 25.0, 40.0, 35.0, -3.0, 50.0, 47.0, 5.0, 70.0, 20.0, 0.0, 0.0, -6.0, 0.0, 15.0, -3.0, -5.0, 0.0, 6.0, 0.0, 8.0, -15.0, 22.0, -4.0, 10.0, -6.0, 50.0, 50.0, 0.0, -17.0, -6.0, 0.0, 10.0, 10.0, 15.0, 5.0, -1.0, 10.0, 0.0, 30.0, 9.0, -18.0, 0.0, -1.0, -3.0, 25.0, 6.0, 8.0, 5.0, 16.0, -8.0, 14.0, 3.0, 20.0, 37.0, 20.0, 20.0, 1.0, 0.0, 10.0, 10.0, 0.0, -8.0, -3.0, 4.0, 0.0, 18.0, 9.0, 36.0, 25.0, 20.0, 0.0, 0.0, 30.0, 18.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, -8.0, -1.0, -11.0, 0.0, -6.0, -35.0, -140.0, -5.0, 0.0, 9.0, -4.0, 260.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, -11.0, 40.0, 10.0, 2.0, 18.0, 19.0, -4.0, -15.0, 2.0, 20.0, 10.0, -1.0, 1.0, 10.0, 20.0, 27.0, 0.0, -6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8915222591307215, "mean_inference_ms": 4.603990691368187, "mean_action_processing_ms": 1.28520169323422, "mean_env_wait_ms": 3.0791295404511825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0648951530456543, "StateBufferConnector_ms": 0.009959697723388672, "ViewRequirementAgentConnector_ms": 0.4853813648223877}, "num_episodes": 18, "episode_return_max": 283.0, "episode_return_min": -82.0, "episode_return_mean": 65.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.23668849999603, "num_env_steps_trained_throughput_per_sec": 32.23668849999603, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 288109.588, "restore_workers_time_ms": 0.015, "training_step_time_ms": 288109.538, "sample_time_ms": 4839.857, "learn_time_ms": 283244.037, "learn_throughput": 14.122, "synch_weights_time_ms": 17.168}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 14, "trial_id": "6085c_00000", "date": "2024-07-01_23-26-38", "timestamp": 1719890798, "time_this_iter_s": 124.10684204101562, "time_total_s": 3646.9725258350372, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e5820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3646.9725258350372, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.525000000000002, "ram_util_percent": 79.85397727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.77631979780837, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.618384250614463, "policy_loss": -0.003183066617391004, "vf_loss": 3.6207598708308164, "vf_explained_var": 0.013766788230282557, "kl": 0.00807441738474934, "entropy": 2.041423252228096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 136155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 283.0, "episode_reward_min": -82.0, "episode_reward_mean": 80.08, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 8.008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.0, 64.0, 53.0, 12.0, 69.0, 54.0, 63.0, -29.0, 75.0, 66.0, 145.0, 70.0, 218.0, 10.0, 42.0, 124.0, 64.0, 20.0, 84.0, 32.0, -11.0, 112.0, 26.0, 216.0, 68.0, 107.0, 54.0, 155.0, 69.0, 105.0, 87.0, 34.0, 83.0, -82.0, 158.0, 34.0, -31.0, 65.0, -37.0, -13.0, 136.0, 283.0, 17.0, 63.0, 66.0, 9.0, 70.0, 54.0, 55.0, 11.0, 121.0, 105.0, 25.0, 72.0, -29.0, 67.0, 248.0, 176.0, 82.0, 71.0, 85.0, 224.0, 96.0, 71.0, 66.0, 58.0, 135.0, 32.0, 198.0, -31.0, 120.0, 107.0, 83.0, 40.0, 119.0, 53.0, 155.0, 81.0, 114.0, 138.0, 73.0, 150.0, 83.0, 167.0, 237.0, 122.0, 63.0, 15.0, 63.0, 106.0, 44.0, 49.0, 48.0, 186.0, -11.0, 20.0, 74.0, 184.0, 82.0, 100.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, 0.0, 8.0, 20.0, 18.0, -1.0, 7.0, 0.0, 0.0, 30.0, 0.0, 10.0, -4.0, 30.0, -2.0, -1.0, -3.0, -2.0, 6.0, 0.0, 8.0, 2.0, 0.0, 0.0, 14.0, 10.0, -5.0, 0.0, 24.0, 0.0, 10.0, -14.0, 10.0, 2.0, 19.0, -25.0, 20.0, -10.0, 0.0, 16.0, 4.0, -9.0, 0.0, 32.0, -9.0, -5.0, 27.0, 3.0, 10.0, 20.0, 20.0, 0.0, -3.0, -3.0, 9.0, 29.0, -3.0, -5.0, -10.0, 10.0, 9.0, -17.0, 9.0, 28.0, 0.0, 9.0, -5.0, 10.0, 10.0, 7.0, -24.0, -10.0, 0.0, -4.0, 20.0, -15.0, 0.0, -16.0, 13.0, 20.0, 8.0, 8.0, -7.0, 10.0, 6.0, 7.0, 0.0, 8.0, 15.0, 3.0, 0.0, -5.0, 24.0, 0.0, 0.0, 4.0, 30.0, 0.0, 10.0, 7.0, 24.0, 20.0, -1.0, 16.0, -1.0, 20.0, 50.0, 0.0, 10.0, -1.0, 17.0, 0.0, -1.0, 19.0, 19.0, 0.0, -3.0, 0.0, 20.0, -1.0, 0.0, 40.0, 149.0, 10.0, 24.0, 10.0, 0.0, -24.0, 10.0, 0.0, 0.0, 18.0, 0.0, 10.0, -7.0, -3.0, 0.0, -8.0, 0.0, 30.0, -13.0, 13.0, 18.0, -14.0, 0.0, -1.0, 0.0, 0.0, 9.0, 10.0, 20.0, 10.0, 18.0, 30.0, -1.0, 19.0, 9.0, 9.0, 0.0, 20.0, 18.0, -3.0, -3.0, 10.0, 0.0, -2.0, -7.0, 20.0, 11.0, 20.0, 0.0, -2.0, -2.0, 3.0, 10.0, -8.0, 0.0, -1.0, 0.0, 15.0, 6.0, 10.0, 20.0, -15.0, 20.0, -13.0, -5.0, 46.0, 0.0, 10.0, -2.0, 0.0, 9.0, 8.0, 10.0, 10.0, 10.0, -12.0, -11.0, 10.0, -12.0, 9.0, 10.0, 0.0, 0.0, 30.0, -70.0, 2.0, 10.0, 10.0, 18.0, 5.0, 0.0, 10.0, 0.0, -1.0, 40.0, 20.0, 10.0, 0.0, 16.0, 40.0, -7.0, -4.0, 4.0, -9.0, 0.0, 0.0, -14.0, 0.0, -30.0, 270.0, -50.0, 5.0, 0.0, -3.0, 39.0, -15.0, 0.0, 44.0, -13.0, 10.0, 15.0, 0.0, 0.0, 6.0, 7.0, -10.0, 9.0, -3.0, 8.0, 30.0, 0.0, 13.0, 10.0, 0.0, 19.0, 10.0, 20.0, 8.0, 0.0, 0.0, 10.0, 16.0, -10.0, 30.0, -5.0, -5.0, 10.0, 19.0, 25.0, 0.0, 39.0, 9.0, -3.0, -6.0, 30.0, -6.0, 48.0, 10.0, 8.0, 10.0, 0.0, 0.0, 4.0, -1.0, 10.0, 13.0, 15.0, 5.0, -10.0, 30.0, 10.0, 3.0, -8.0, 16.0, -4.0, 50.0, 13.0, 10.0, 10.0, 20.0, -6.0, 30.0, 0.0, -5.0, 30.0, -2.0, 0.0, 0.0, -8.0, -13.0, 38.0, 10.0, -3.0, -5.0, 13.0, 2.0, 0.0, 30.0, 18.0, -2.0, -2.0, 10.0, 10.0, 0.0, 10.0, 10.0, -1.0, -15.0, -14.0, -5.0, -29.0, -4.0, 0.0, -9.0, -20.0, 20.0, -6.0, 0.0, 10.0, 30.0, 10.0, 20.0, 20.0, -1.0, 7.0, -3.0, 65.0, 16.0, 1.0, -1.0, -5.0, 0.0, 14.0, 0.0, 0.0, 20.0, -11.0, -1.0, -1.0, 10.0, -5.0, -7.0, -3.0, 0.0, -10.0, -7.0, -7.0, 20.0, 0.0, 0.0, 10.0, -1.0, 0.0, 10.0, 8.0, 0.0, 18.0, -5.0, -4.0, 0.0, 0.0, -1.0, -3.0, -12.0, -10.0, -12.0, 10.0, -2.0, 0.0, 10.0, -8.0, -10.0, 16.0, -4.0, -11.0, -14.0, 10.0, 16.0, -3.0, 10.0, 40.0, 16.0, 0.0, 7.0, 20.0, 30.0, 0.0, -13.0, -9.0, 280.0, -2.0, -19.0, -6.0, 30.0, 11.0, 7.0, 4.0, 10.0, 10.0, -5.0, -1.0, 1.0, 12.0, -15.0, -5.0, 10.0, 0.0, 6.0, 0.0, 35.0, 0.0, -7.0, 21.0, 10.0, -13.0, 3.0, 8.0, 7.0, 0.0, 16.0, 0.0, 10.0, 0.0, 20.0, -3.0, 0.0, 16.0, 0.0, 0.0, -2.0, -12.0, -8.0, 5.0, -3.0, 20.0, 2.0, 7.0, 37.0, 0.0, 7.0, -1.0, -1.0, -2.0, 20.0, 10.0, 0.0, 0.0, 10.0, 8.0, 10.0, 0.0, 10.0, 0.0, -3.0, 0.0, 20.0, -1.0, 16.0, 20.0, -2.0, -4.0, 0.0, -11.0, 10.0, 7.0, 9.0, 10.0, -15.0, 8.0, 30.0, -14.0, -15.0, 0.0, 0.0, 20.0, -3.0, 0.0, 70.0, 6.0, 10.0, 1.0, 30.0, -12.0, 10.0, 10.0, -1.0, -3.0, 0.0, 10.0, 0.0, 0.0, 20.0, 8.0, 18.0, 9.0, 20.0, 20.0, -13.0, 40.0, 25.0, -3.0, 15.0, -9.0, -5.0, -18.0, -7.0, 0.0, -5.0, 18.0, 10.0, -5.0, -5.0, 28.0, -7.0, 35.0, -3.0, 6.0, -13.0, -3.0, 20.0, 0.0, 0.0, -30.0, 40.0, 8.0, -51.0, 0.0, 7.0, 20.0, -3.0, 18.0, -4.0, 10.0, -11.0, 0.0, 10.0, 20.0, 0.0, 13.0, 40.0, 260.0, 0.0, 20.0, -50.0, -30.0, -5.0, 0.0, 60.0, 20.0, 20.0, -1.0, 10.0, 20.0, 10.0, 10.0, 7.0, 20.0, 20.0, 0.0, -3.0, 0.0, 0.0, 29.0, 16.0, 0.0, -5.0, 25.0, 0.0, 10.0, -5.0, -1.0, 10.0, 7.0, 15.0, 30.0, 0.0, 5.0, 30.0, 0.0, 16.0, 0.0, 20.0, 0.0, 0.0, 30.0, -5.0, -6.0, 20.0, 0.0, 0.0, 10.0, 25.0, 40.0, 35.0, -3.0, 50.0, 47.0, 5.0, 70.0, 20.0, 0.0, 0.0, -6.0, 0.0, 15.0, -3.0, -5.0, 0.0, 6.0, 0.0, 8.0, -15.0, 22.0, -4.0, 10.0, -6.0, 50.0, 50.0, 0.0, -17.0, -6.0, 0.0, 10.0, 10.0, 15.0, 5.0, -1.0, 10.0, 0.0, 30.0, 9.0, -18.0, 0.0, -1.0, -3.0, 25.0, 6.0, 8.0, 5.0, 16.0, -8.0, 14.0, 3.0, 20.0, 37.0, 20.0, 20.0, 1.0, 0.0, 10.0, 10.0, 0.0, -8.0, -3.0, 4.0, 0.0, 18.0, 9.0, 36.0, 25.0, 20.0, 0.0, 0.0, 30.0, 18.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, -8.0, -1.0, -11.0, 0.0, -6.0, -35.0, -140.0, -5.0, 0.0, 9.0, -4.0, 260.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, -11.0, 40.0, 10.0, 2.0, 18.0, 19.0, -4.0, -15.0, 2.0, 20.0, 10.0, -1.0, 1.0, 10.0, 20.0, 27.0, 0.0, -6.0, 5.0, 15.0, -12.0, -1.0, 0.0, -4.0, 10.0, -8.0, 9.0, 26.0, 10.0, 30.0, -6.0, 20.0, 10.0, 30.0, 10.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 17.0, -4.0, 10.0, 0.0, 0.0, 19.0, -1.0, -21.0, 30.0, 160.0, 10.0, -15.0, 19.0, -46.0, 5.0, 30.0, 5.0, 20.0, 9.0, 0.0, 0.0, 17.0, -4.0, -1.0, 10.0, 6.0, 30.0, 10.0, 10.0, 0.0, 10.0, 13.0, 17.0, 8.0, 0.0, 30.0, -1.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 29.0, 4.0, 14.0, 19.0, 19.0, 10.0, -5.0, 20.0, -10.0, 3.0, -1.0, 40.0, 20.0, 30.0, 3.0, 25.0, -5.0, 13.0, 0.0, 25.0, -1.0, 12.0, -1.0, 0.0, 10.0, 10.0, 30.0, 3.0, 9.0, 0.0, 10.0, -1.0, 20.0, 30.0, 60.0, 0.0, -26.0, 34.0, 14.0, -4.0, 40.0, -5.0, 20.0, -12.0, 4.0, -40.0, -4.0, -3.0, -20.0, 270.0, 27.0, 0.0, 0.0, 0.0, 7.0, 20.0, 20.0, 50.0, 0.0, 10.0, 15.0, 0.0, 17.0, -8.0, 0.0, 40.0, 6.0, 8.0, -6.0, -2.0, 8.0, 8.0, -18.0, 0.0, 0.0, -10.0, 14.0, -2.0, 20.0, -1.0, 4.0, -5.0, 0.0, -3.0, 0.0, -8.0, 12.0, 10.0, 17.0, 30.0, 10.0, 10.0, 0.0, 30.0, 2.0, 20.0, 30.0, 0.0, -6.0, 20.0, 0.0, 20.0, 10.0, 7.0, 10.0, 10.0, -3.0, -9.0, 0.0, 10.0, -11.0, 9.0, 12.0, 20.0, 20.0, 6.0, 26.0, 10.0, -3.0, 20.0, -71.0, -4.0, -1.0, -1.0, 0.0, 9.0, 20.0, 0.0, 20.0, 5.0, 0.0, 10.0, 40.0, 30.0, 20.0, 19.0, 10.0, 9.0, 10.0, 29.0, 9.0, -2.0, -15.0, -3.0, 5.0, 8.0, -1.0, 0.0, 0.0, 0.0, -3.0, 20.0, -36.0, 6.0, 10.0, 10.0, 10.0, -3.0, -5.0, 10.0, -2.0, 10.0, -6.0, 7.0, 20.0, 0.0, 20.0, 0.0, 20.0, 3.0, 0.0, 15.0, 20.0, 49.0, 2.0, 26.0, 20.0, 3.0, 0.0, 29.0, 20.0, 10.0, 10.0, 0.0, 18.0, 0.0, 0.0, 9.0, -5.0, 30.0, 10.0, 0.0, 0.0, 35.0, 17.0, 20.0, 10.0, 0.0, 10.0, 10.0, -2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6553679769695817, "mean_inference_ms": 4.321297031505621, "mean_action_processing_ms": 1.2204144577427634, "mean_env_wait_ms": 2.904255592387049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06945633888244629, "StateBufferConnector_ms": 0.010768651962280273, "ViewRequirementAgentConnector_ms": 0.46764302253723145}, "num_episodes": 27, "episode_return_max": 283.0, "episode_return_min": -82.0, "episode_return_mean": 80.08, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.213885000292095, "num_env_steps_trained_throughput_per_sec": 32.213885000292095, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 281462.028, "restore_workers_time_ms": 0.014, "training_step_time_ms": 281461.976, "sample_time_ms": 3963.574, "learn_time_ms": 277475.813, "learn_throughput": 14.416, "synch_weights_time_ms": 14.669}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 15, "trial_id": "6085c_00000", "date": "2024-07-01_23-28-43", "timestamp": 1719890923, "time_this_iter_s": 124.18405985832214, "time_total_s": 3771.1565856933594, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3771.1565856933594, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.791999999999994, "ram_util_percent": 79.50685714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.17827216035134, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6054748750215393, "policy_loss": -0.0031544328499605225, "vf_loss": 3.607695050488392, "vf_explained_var": 0.016629447171482414, "kl": 0.009342588221877519, "entropy": 2.0368007215575035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 145545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -82.0, "episode_reward_mean": 85.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 8.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.0, 32.0, -11.0, 112.0, 26.0, 216.0, 68.0, 107.0, 54.0, 155.0, 69.0, 105.0, 87.0, 34.0, 83.0, -82.0, 158.0, 34.0, -31.0, 65.0, -37.0, -13.0, 136.0, 283.0, 17.0, 63.0, 66.0, 9.0, 70.0, 54.0, 55.0, 11.0, 121.0, 105.0, 25.0, 72.0, -29.0, 67.0, 248.0, 176.0, 82.0, 71.0, 85.0, 224.0, 96.0, 71.0, 66.0, 58.0, 135.0, 32.0, 198.0, -31.0, 120.0, 107.0, 83.0, 40.0, 119.0, 53.0, 155.0, 81.0, 114.0, 138.0, 73.0, 150.0, 83.0, 167.0, 237.0, 122.0, 63.0, 15.0, 63.0, 106.0, 44.0, 49.0, 48.0, 186.0, -11.0, 20.0, 74.0, 184.0, 82.0, 100.0, 110.0, 96.0, 81.0, 51.0, 367.0, 144.0, 61.0, 101.0, 154.0, 80.0, 8.0, 80.0, 54.0, 38.0, 133.0, 28.0, 64.0, 129.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [15.0, 6.0, 10.0, 20.0, -15.0, 20.0, -13.0, -5.0, 46.0, 0.0, 10.0, -2.0, 0.0, 9.0, 8.0, 10.0, 10.0, 10.0, -12.0, -11.0, 10.0, -12.0, 9.0, 10.0, 0.0, 0.0, 30.0, -70.0, 2.0, 10.0, 10.0, 18.0, 5.0, 0.0, 10.0, 0.0, -1.0, 40.0, 20.0, 10.0, 0.0, 16.0, 40.0, -7.0, -4.0, 4.0, -9.0, 0.0, 0.0, -14.0, 0.0, -30.0, 270.0, -50.0, 5.0, 0.0, -3.0, 39.0, -15.0, 0.0, 44.0, -13.0, 10.0, 15.0, 0.0, 0.0, 6.0, 7.0, -10.0, 9.0, -3.0, 8.0, 30.0, 0.0, 13.0, 10.0, 0.0, 19.0, 10.0, 20.0, 8.0, 0.0, 0.0, 10.0, 16.0, -10.0, 30.0, -5.0, -5.0, 10.0, 19.0, 25.0, 0.0, 39.0, 9.0, -3.0, -6.0, 30.0, -6.0, 48.0, 10.0, 8.0, 10.0, 0.0, 0.0, 4.0, -1.0, 10.0, 13.0, 15.0, 5.0, -10.0, 30.0, 10.0, 3.0, -8.0, 16.0, -4.0, 50.0, 13.0, 10.0, 10.0, 20.0, -6.0, 30.0, 0.0, -5.0, 30.0, -2.0, 0.0, 0.0, -8.0, -13.0, 38.0, 10.0, -3.0, -5.0, 13.0, 2.0, 0.0, 30.0, 18.0, -2.0, -2.0, 10.0, 10.0, 0.0, 10.0, 10.0, -1.0, -15.0, -14.0, -5.0, -29.0, -4.0, 0.0, -9.0, -20.0, 20.0, -6.0, 0.0, 10.0, 30.0, 10.0, 20.0, 20.0, -1.0, 7.0, -3.0, 65.0, 16.0, 1.0, -1.0, -5.0, 0.0, 14.0, 0.0, 0.0, 20.0, -11.0, -1.0, -1.0, 10.0, -5.0, -7.0, -3.0, 0.0, -10.0, -7.0, -7.0, 20.0, 0.0, 0.0, 10.0, -1.0, 0.0, 10.0, 8.0, 0.0, 18.0, -5.0, -4.0, 0.0, 0.0, -1.0, -3.0, -12.0, -10.0, -12.0, 10.0, -2.0, 0.0, 10.0, -8.0, -10.0, 16.0, -4.0, -11.0, -14.0, 10.0, 16.0, -3.0, 10.0, 40.0, 16.0, 0.0, 7.0, 20.0, 30.0, 0.0, -13.0, -9.0, 280.0, -2.0, -19.0, -6.0, 30.0, 11.0, 7.0, 4.0, 10.0, 10.0, -5.0, -1.0, 1.0, 12.0, -15.0, -5.0, 10.0, 0.0, 6.0, 0.0, 35.0, 0.0, -7.0, 21.0, 10.0, -13.0, 3.0, 8.0, 7.0, 0.0, 16.0, 0.0, 10.0, 0.0, 20.0, -3.0, 0.0, 16.0, 0.0, 0.0, -2.0, -12.0, -8.0, 5.0, -3.0, 20.0, 2.0, 7.0, 37.0, 0.0, 7.0, -1.0, -1.0, -2.0, 20.0, 10.0, 0.0, 0.0, 10.0, 8.0, 10.0, 0.0, 10.0, 0.0, -3.0, 0.0, 20.0, -1.0, 16.0, 20.0, -2.0, -4.0, 0.0, -11.0, 10.0, 7.0, 9.0, 10.0, -15.0, 8.0, 30.0, -14.0, -15.0, 0.0, 0.0, 20.0, -3.0, 0.0, 70.0, 6.0, 10.0, 1.0, 30.0, -12.0, 10.0, 10.0, -1.0, -3.0, 0.0, 10.0, 0.0, 0.0, 20.0, 8.0, 18.0, 9.0, 20.0, 20.0, -13.0, 40.0, 25.0, -3.0, 15.0, -9.0, -5.0, -18.0, -7.0, 0.0, -5.0, 18.0, 10.0, -5.0, -5.0, 28.0, -7.0, 35.0, -3.0, 6.0, -13.0, -3.0, 20.0, 0.0, 0.0, -30.0, 40.0, 8.0, -51.0, 0.0, 7.0, 20.0, -3.0, 18.0, -4.0, 10.0, -11.0, 0.0, 10.0, 20.0, 0.0, 13.0, 40.0, 260.0, 0.0, 20.0, -50.0, -30.0, -5.0, 0.0, 60.0, 20.0, 20.0, -1.0, 10.0, 20.0, 10.0, 10.0, 7.0, 20.0, 20.0, 0.0, -3.0, 0.0, 0.0, 29.0, 16.0, 0.0, -5.0, 25.0, 0.0, 10.0, -5.0, -1.0, 10.0, 7.0, 15.0, 30.0, 0.0, 5.0, 30.0, 0.0, 16.0, 0.0, 20.0, 0.0, 0.0, 30.0, -5.0, -6.0, 20.0, 0.0, 0.0, 10.0, 25.0, 40.0, 35.0, -3.0, 50.0, 47.0, 5.0, 70.0, 20.0, 0.0, 0.0, -6.0, 0.0, 15.0, -3.0, -5.0, 0.0, 6.0, 0.0, 8.0, -15.0, 22.0, -4.0, 10.0, -6.0, 50.0, 50.0, 0.0, -17.0, -6.0, 0.0, 10.0, 10.0, 15.0, 5.0, -1.0, 10.0, 0.0, 30.0, 9.0, -18.0, 0.0, -1.0, -3.0, 25.0, 6.0, 8.0, 5.0, 16.0, -8.0, 14.0, 3.0, 20.0, 37.0, 20.0, 20.0, 1.0, 0.0, 10.0, 10.0, 0.0, -8.0, -3.0, 4.0, 0.0, 18.0, 9.0, 36.0, 25.0, 20.0, 0.0, 0.0, 30.0, 18.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, -8.0, -1.0, -11.0, 0.0, -6.0, -35.0, -140.0, -5.0, 0.0, 9.0, -4.0, 260.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, -11.0, 40.0, 10.0, 2.0, 18.0, 19.0, -4.0, -15.0, 2.0, 20.0, 10.0, -1.0, 1.0, 10.0, 20.0, 27.0, 0.0, -6.0, 5.0, 15.0, -12.0, -1.0, 0.0, -4.0, 10.0, -8.0, 9.0, 26.0, 10.0, 30.0, -6.0, 20.0, 10.0, 30.0, 10.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 17.0, -4.0, 10.0, 0.0, 0.0, 19.0, -1.0, -21.0, 30.0, 160.0, 10.0, -15.0, 19.0, -46.0, 5.0, 30.0, 5.0, 20.0, 9.0, 0.0, 0.0, 17.0, -4.0, -1.0, 10.0, 6.0, 30.0, 10.0, 10.0, 0.0, 10.0, 13.0, 17.0, 8.0, 0.0, 30.0, -1.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 29.0, 4.0, 14.0, 19.0, 19.0, 10.0, -5.0, 20.0, -10.0, 3.0, -1.0, 40.0, 20.0, 30.0, 3.0, 25.0, -5.0, 13.0, 0.0, 25.0, -1.0, 12.0, -1.0, 0.0, 10.0, 10.0, 30.0, 3.0, 9.0, 0.0, 10.0, -1.0, 20.0, 30.0, 60.0, 0.0, -26.0, 34.0, 14.0, -4.0, 40.0, -5.0, 20.0, -12.0, 4.0, -40.0, -4.0, -3.0, -20.0, 270.0, 27.0, 0.0, 0.0, 0.0, 7.0, 20.0, 20.0, 50.0, 0.0, 10.0, 15.0, 0.0, 17.0, -8.0, 0.0, 40.0, 6.0, 8.0, -6.0, -2.0, 8.0, 8.0, -18.0, 0.0, 0.0, -10.0, 14.0, -2.0, 20.0, -1.0, 4.0, -5.0, 0.0, -3.0, 0.0, -8.0, 12.0, 10.0, 17.0, 30.0, 10.0, 10.0, 0.0, 30.0, 2.0, 20.0, 30.0, 0.0, -6.0, 20.0, 0.0, 20.0, 10.0, 7.0, 10.0, 10.0, -3.0, -9.0, 0.0, 10.0, -11.0, 9.0, 12.0, 20.0, 20.0, 6.0, 26.0, 10.0, -3.0, 20.0, -71.0, -4.0, -1.0, -1.0, 0.0, 9.0, 20.0, 0.0, 20.0, 5.0, 0.0, 10.0, 40.0, 30.0, 20.0, 19.0, 10.0, 9.0, 10.0, 29.0, 9.0, -2.0, -15.0, -3.0, 5.0, 8.0, -1.0, 0.0, 0.0, 0.0, -3.0, 20.0, -36.0, 6.0, 10.0, 10.0, 10.0, -3.0, -5.0, 10.0, -2.0, 10.0, -6.0, 7.0, 20.0, 0.0, 20.0, 0.0, 20.0, 3.0, 0.0, 15.0, 20.0, 49.0, 2.0, 26.0, 20.0, 3.0, 0.0, 29.0, 20.0, 10.0, 10.0, 0.0, 18.0, 0.0, 0.0, 9.0, -5.0, 30.0, 10.0, 0.0, 0.0, 35.0, 17.0, 20.0, 10.0, 0.0, 10.0, 10.0, -2.0, 0.0, 0.0, 28.0, -1.0, -3.0, 8.0, 28.0, 30.0, 0.0, 20.0, 0.0, 10.0, -8.0, 50.0, -1.0, -2.0, 0.0, 30.0, 0.0, 17.0, -5.0, 0.0, -1.0, 20.0, 0.0, 30.0, 0.0, 17.0, 0.0, 20.0, 29.0, -1.0, 40.0, 0.0, -2.0, 0.0, -8.0, 0.0, -2.0, -5.0, 10.0, 10.0, -2.0, 20.0, 30.0, 270.0, 20.0, 10.0, -31.0, 30.0, 17.0, 9.0, 10.0, 40.0, -7.0, 21.0, -5.0, 15.0, 17.0, 27.0, -2.0, 10.0, -3.0, 0.0, 10.0, 36.0, 0.0, 0.0, 0.0, 10.0, 19.0, 24.0, 10.0, 20.0, 0.0, 10.0, 8.0, -10.0, 10.0, 10.0, 7.0, -2.0, 4.0, 40.0, 10.0, -5.0, 10.0, 30.0, 30.0, 30.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, -50.0, 0.0, 60.0, 0.0, -3.0, 19.0, 9.0, 0.0, -1.0, 20.0, -10.0, -3.0, -11.0, -12.0, 20.0, -7.0, -2.0, 37.0, 7.0, 0.0, 19.0, 0.0, 10.0, -4.0, -4.0, 20.0, -8.0, 10.0, 20.0, -4.0, 20.0, 0.0, 10.0, -10.0, -5.0, 0.0, 10.0, -4.0, -11.0, 5.0, -6.0, 20.0, -1.0, 30.0, 30.0, 6.0, 10.0, 8.0, -5.0, 35.0, 16.0, 18.0, 5.0, 10.0, 5.0, 8.0, -1.0, 8.0, 0.0, 15.0, -4.0, -23.0, 20.0, 0.0, -7.0, 16.0, 30.0, 12.0, 0.0, 10.0, -8.0, 7.0, -14.0, 18.0, 8.0, 8.0, 9.0, 10.0, -3.0, 30.0, 17.0, 20.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.522667538416944, "mean_inference_ms": 4.166348959840981, "mean_action_processing_ms": 1.184182999878045, "mean_env_wait_ms": 2.8054387255003053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06749272346496582, "StateBufferConnector_ms": 0.010884761810302734, "ViewRequirementAgentConnector_ms": 0.47035837173461914}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -82.0, "episode_return_mean": 85.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.885861965832554, "num_env_steps_trained_throughput_per_sec": 32.885861965832554, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 276453.445, "restore_workers_time_ms": 0.013, "training_step_time_ms": 276453.395, "sample_time_ms": 3255.004, "learn_time_ms": 273176.546, "learn_throughput": 14.643, "synch_weights_time_ms": 13.721}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 16, "trial_id": "6085c_00000", "date": "2024-07-01_23-30-44", "timestamp": 1719891044, "time_this_iter_s": 121.6484842300415, "time_total_s": 3892.805069923401, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9151c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3892.805069923401, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.66627906976744, "ram_util_percent": 79.6703488372093}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.509630147235208, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5009620082518036, "policy_loss": -0.0037601907703583154, "vf_loss": 3.5039591523151175, "vf_explained_var": 0.010234019417351426, "kl": 0.007630452953578797, "entropy": 2.032583485903958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 154935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -37.0, "episode_reward_mean": 90.89, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 9.089}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.0, 65.0, -37.0, -13.0, 136.0, 283.0, 17.0, 63.0, 66.0, 9.0, 70.0, 54.0, 55.0, 11.0, 121.0, 105.0, 25.0, 72.0, -29.0, 67.0, 248.0, 176.0, 82.0, 71.0, 85.0, 224.0, 96.0, 71.0, 66.0, 58.0, 135.0, 32.0, 198.0, -31.0, 120.0, 107.0, 83.0, 40.0, 119.0, 53.0, 155.0, 81.0, 114.0, 138.0, 73.0, 150.0, 83.0, 167.0, 237.0, 122.0, 63.0, 15.0, 63.0, 106.0, 44.0, 49.0, 48.0, 186.0, -11.0, 20.0, 74.0, 184.0, 82.0, 100.0, 110.0, 96.0, 81.0, 51.0, 367.0, 144.0, 61.0, 101.0, 154.0, 80.0, 8.0, 80.0, 54.0, 38.0, 133.0, 28.0, 64.0, 129.0, 49.0, 305.0, 70.0, 140.0, 12.0, 94.0, 83.0, 85.0, 31.0, 172.0, 80.0, 60.0, 116.0, 63.0, 218.0, 76.0, 62.0, 109.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-1.0, -1.0, 10.0, -5.0, -7.0, -3.0, 0.0, -10.0, -7.0, -7.0, 20.0, 0.0, 0.0, 10.0, -1.0, 0.0, 10.0, 8.0, 0.0, 18.0, -5.0, -4.0, 0.0, 0.0, -1.0, -3.0, -12.0, -10.0, -12.0, 10.0, -2.0, 0.0, 10.0, -8.0, -10.0, 16.0, -4.0, -11.0, -14.0, 10.0, 16.0, -3.0, 10.0, 40.0, 16.0, 0.0, 7.0, 20.0, 30.0, 0.0, -13.0, -9.0, 280.0, -2.0, -19.0, -6.0, 30.0, 11.0, 7.0, 4.0, 10.0, 10.0, -5.0, -1.0, 1.0, 12.0, -15.0, -5.0, 10.0, 0.0, 6.0, 0.0, 35.0, 0.0, -7.0, 21.0, 10.0, -13.0, 3.0, 8.0, 7.0, 0.0, 16.0, 0.0, 10.0, 0.0, 20.0, -3.0, 0.0, 16.0, 0.0, 0.0, -2.0, -12.0, -8.0, 5.0, -3.0, 20.0, 2.0, 7.0, 37.0, 0.0, 7.0, -1.0, -1.0, -2.0, 20.0, 10.0, 0.0, 0.0, 10.0, 8.0, 10.0, 0.0, 10.0, 0.0, -3.0, 0.0, 20.0, -1.0, 16.0, 20.0, -2.0, -4.0, 0.0, -11.0, 10.0, 7.0, 9.0, 10.0, -15.0, 8.0, 30.0, -14.0, -15.0, 0.0, 0.0, 20.0, -3.0, 0.0, 70.0, 6.0, 10.0, 1.0, 30.0, -12.0, 10.0, 10.0, -1.0, -3.0, 0.0, 10.0, 0.0, 0.0, 20.0, 8.0, 18.0, 9.0, 20.0, 20.0, -13.0, 40.0, 25.0, -3.0, 15.0, -9.0, -5.0, -18.0, -7.0, 0.0, -5.0, 18.0, 10.0, -5.0, -5.0, 28.0, -7.0, 35.0, -3.0, 6.0, -13.0, -3.0, 20.0, 0.0, 0.0, -30.0, 40.0, 8.0, -51.0, 0.0, 7.0, 20.0, -3.0, 18.0, -4.0, 10.0, -11.0, 0.0, 10.0, 20.0, 0.0, 13.0, 40.0, 260.0, 0.0, 20.0, -50.0, -30.0, -5.0, 0.0, 60.0, 20.0, 20.0, -1.0, 10.0, 20.0, 10.0, 10.0, 7.0, 20.0, 20.0, 0.0, -3.0, 0.0, 0.0, 29.0, 16.0, 0.0, -5.0, 25.0, 0.0, 10.0, -5.0, -1.0, 10.0, 7.0, 15.0, 30.0, 0.0, 5.0, 30.0, 0.0, 16.0, 0.0, 20.0, 0.0, 0.0, 30.0, -5.0, -6.0, 20.0, 0.0, 0.0, 10.0, 25.0, 40.0, 35.0, -3.0, 50.0, 47.0, 5.0, 70.0, 20.0, 0.0, 0.0, -6.0, 0.0, 15.0, -3.0, -5.0, 0.0, 6.0, 0.0, 8.0, -15.0, 22.0, -4.0, 10.0, -6.0, 50.0, 50.0, 0.0, -17.0, -6.0, 0.0, 10.0, 10.0, 15.0, 5.0, -1.0, 10.0, 0.0, 30.0, 9.0, -18.0, 0.0, -1.0, -3.0, 25.0, 6.0, 8.0, 5.0, 16.0, -8.0, 14.0, 3.0, 20.0, 37.0, 20.0, 20.0, 1.0, 0.0, 10.0, 10.0, 0.0, -8.0, -3.0, 4.0, 0.0, 18.0, 9.0, 36.0, 25.0, 20.0, 0.0, 0.0, 30.0, 18.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, -8.0, -1.0, -11.0, 0.0, -6.0, -35.0, -140.0, -5.0, 0.0, 9.0, -4.0, 260.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, -11.0, 40.0, 10.0, 2.0, 18.0, 19.0, -4.0, -15.0, 2.0, 20.0, 10.0, -1.0, 1.0, 10.0, 20.0, 27.0, 0.0, -6.0, 5.0, 15.0, -12.0, -1.0, 0.0, -4.0, 10.0, -8.0, 9.0, 26.0, 10.0, 30.0, -6.0, 20.0, 10.0, 30.0, 10.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 17.0, -4.0, 10.0, 0.0, 0.0, 19.0, -1.0, -21.0, 30.0, 160.0, 10.0, -15.0, 19.0, -46.0, 5.0, 30.0, 5.0, 20.0, 9.0, 0.0, 0.0, 17.0, -4.0, -1.0, 10.0, 6.0, 30.0, 10.0, 10.0, 0.0, 10.0, 13.0, 17.0, 8.0, 0.0, 30.0, -1.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 29.0, 4.0, 14.0, 19.0, 19.0, 10.0, -5.0, 20.0, -10.0, 3.0, -1.0, 40.0, 20.0, 30.0, 3.0, 25.0, -5.0, 13.0, 0.0, 25.0, -1.0, 12.0, -1.0, 0.0, 10.0, 10.0, 30.0, 3.0, 9.0, 0.0, 10.0, -1.0, 20.0, 30.0, 60.0, 0.0, -26.0, 34.0, 14.0, -4.0, 40.0, -5.0, 20.0, -12.0, 4.0, -40.0, -4.0, -3.0, -20.0, 270.0, 27.0, 0.0, 0.0, 0.0, 7.0, 20.0, 20.0, 50.0, 0.0, 10.0, 15.0, 0.0, 17.0, -8.0, 0.0, 40.0, 6.0, 8.0, -6.0, -2.0, 8.0, 8.0, -18.0, 0.0, 0.0, -10.0, 14.0, -2.0, 20.0, -1.0, 4.0, -5.0, 0.0, -3.0, 0.0, -8.0, 12.0, 10.0, 17.0, 30.0, 10.0, 10.0, 0.0, 30.0, 2.0, 20.0, 30.0, 0.0, -6.0, 20.0, 0.0, 20.0, 10.0, 7.0, 10.0, 10.0, -3.0, -9.0, 0.0, 10.0, -11.0, 9.0, 12.0, 20.0, 20.0, 6.0, 26.0, 10.0, -3.0, 20.0, -71.0, -4.0, -1.0, -1.0, 0.0, 9.0, 20.0, 0.0, 20.0, 5.0, 0.0, 10.0, 40.0, 30.0, 20.0, 19.0, 10.0, 9.0, 10.0, 29.0, 9.0, -2.0, -15.0, -3.0, 5.0, 8.0, -1.0, 0.0, 0.0, 0.0, -3.0, 20.0, -36.0, 6.0, 10.0, 10.0, 10.0, -3.0, -5.0, 10.0, -2.0, 10.0, -6.0, 7.0, 20.0, 0.0, 20.0, 0.0, 20.0, 3.0, 0.0, 15.0, 20.0, 49.0, 2.0, 26.0, 20.0, 3.0, 0.0, 29.0, 20.0, 10.0, 10.0, 0.0, 18.0, 0.0, 0.0, 9.0, -5.0, 30.0, 10.0, 0.0, 0.0, 35.0, 17.0, 20.0, 10.0, 0.0, 10.0, 10.0, -2.0, 0.0, 0.0, 28.0, -1.0, -3.0, 8.0, 28.0, 30.0, 0.0, 20.0, 0.0, 10.0, -8.0, 50.0, -1.0, -2.0, 0.0, 30.0, 0.0, 17.0, -5.0, 0.0, -1.0, 20.0, 0.0, 30.0, 0.0, 17.0, 0.0, 20.0, 29.0, -1.0, 40.0, 0.0, -2.0, 0.0, -8.0, 0.0, -2.0, -5.0, 10.0, 10.0, -2.0, 20.0, 30.0, 270.0, 20.0, 10.0, -31.0, 30.0, 17.0, 9.0, 10.0, 40.0, -7.0, 21.0, -5.0, 15.0, 17.0, 27.0, -2.0, 10.0, -3.0, 0.0, 10.0, 36.0, 0.0, 0.0, 0.0, 10.0, 19.0, 24.0, 10.0, 20.0, 0.0, 10.0, 8.0, -10.0, 10.0, 10.0, 7.0, -2.0, 4.0, 40.0, 10.0, -5.0, 10.0, 30.0, 30.0, 30.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, -50.0, 0.0, 60.0, 0.0, -3.0, 19.0, 9.0, 0.0, -1.0, 20.0, -10.0, -3.0, -11.0, -12.0, 20.0, -7.0, -2.0, 37.0, 7.0, 0.0, 19.0, 0.0, 10.0, -4.0, -4.0, 20.0, -8.0, 10.0, 20.0, -4.0, 20.0, 0.0, 10.0, -10.0, -5.0, 0.0, 10.0, -4.0, -11.0, 5.0, -6.0, 20.0, -1.0, 30.0, 30.0, 6.0, 10.0, 8.0, -5.0, 35.0, 16.0, 18.0, 5.0, 10.0, 5.0, 8.0, -1.0, 8.0, 0.0, 15.0, -4.0, -23.0, 20.0, 0.0, -7.0, 16.0, 30.0, 12.0, 0.0, 10.0, -8.0, 7.0, -14.0, 18.0, 8.0, 8.0, 9.0, 10.0, -3.0, 30.0, 17.0, 20.0, 0.0, 30.0, 0.0, 18.0, -1.0, -3.0, 17.0, 10.0, 0.0, -3.0, 5.0, 6.0, 15.0, 10.0, -50.0, 0.0, 10.0, 160.0, 10.0, 0.0, 150.0, 0.0, 30.0, 10.0, -8.0, 10.0, -2.0, 10.0, 0.0, 10.0, 10.0, 0.0, 18.0, 29.0, 15.0, 8.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 3.0, 10.0, -3.0, -3.0, -3.0, 15.0, 9.0, -3.0, -13.0, 0.0, 30.0, 20.0, 0.0, -6.0, 19.0, 5.0, -1.0, 40.0, -13.0, 0.0, 20.0, -4.0, 8.0, 0.0, 5.0, 3.0, 10.0, 10.0, 11.0, 20.0, 20.0, 10.0, 28.0, 13.0, 11.0, 6.0, 0.0, 8.0, -8.0, -3.0, 0.0, 0.0, 0.0, -2.0, -15.0, 20.0, -9.0, -12.0, 20.0, 29.0, 0.0, -5.0, 17.0, 20.0, 30.0, 40.0, 0.0, 50.0, 20.0, 0.0, 14.0, 0.0, 0.0, 10.0, 0.0, 17.0, 7.0, 2.0, 30.0, 0.0, 20.0, 0.0, 0.0, -10.0, 10.0, 0.0, 20.0, 10.0, -15.0, 25.0, 0.0, 20.0, 8.0, 0.0, 20.0, -3.0, 40.0, 29.0, 6.0, -4.0, 18.0, 0.0, 10.0, 10.0, 10.0, -8.0, -2.0, 30.0, 0.0, -5.0, 9.0, 39.0, 20.0, 26.0, 0.0, 9.0, 40.0, 40.0, 26.0, 9.0, 26.0, 8.0, -2.0, 5.0, 10.0, 9.0, 20.0, -20.0, 10.0, 10.0, 39.0, -22.0, 8.0, 20.0, -4.0, 10.0, -3.0, -3.0, -1.0, 18.0, -5.0, 8.0, 10.0, 0.0, 15.0, 0.0, 20.0, 10.0, -9.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.410106805457776, "mean_inference_ms": 4.035119876579741, "mean_action_processing_ms": 1.1532819098355258, "mean_env_wait_ms": 2.7210470620020466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06873750686645508, "StateBufferConnector_ms": 0.010907173156738281, "ViewRequirementAgentConnector_ms": 0.5401923656463623}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -37.0, "episode_return_mean": 90.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.32574529131977, "num_env_steps_trained_throughput_per_sec": 32.32574529131977, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 122437.068, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122437.017, "sample_time_ms": 3218.31, "learn_time_ms": 119197.409, "learn_throughput": 33.558, "synch_weights_time_ms": 13.306}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 17, "trial_id": "6085c_00000", "date": "2024-07-01_23-32-48", "timestamp": 1719891168, "time_this_iter_s": 123.75164699554443, "time_total_s": 4016.5567169189453, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x1380094c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4016.5567169189453, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 34.412, "ram_util_percent": 81.59714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5103872510317924, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6581322999554065, "policy_loss": -0.004645458036447014, "vf_loss": 3.662016086608838, "vf_explained_var": 0.027988458035218194, "kl": 0.007616687626945131, "entropy": 2.0320937472410474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 164325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -31.0, "episode_reward_mean": 96.13, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 270.0}, "policy_reward_mean": {"policy_0": 9.613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.0, 67.0, 248.0, 176.0, 82.0, 71.0, 85.0, 224.0, 96.0, 71.0, 66.0, 58.0, 135.0, 32.0, 198.0, -31.0, 120.0, 107.0, 83.0, 40.0, 119.0, 53.0, 155.0, 81.0, 114.0, 138.0, 73.0, 150.0, 83.0, 167.0, 237.0, 122.0, 63.0, 15.0, 63.0, 106.0, 44.0, 49.0, 48.0, 186.0, -11.0, 20.0, 74.0, 184.0, 82.0, 100.0, 110.0, 96.0, 81.0, 51.0, 367.0, 144.0, 61.0, 101.0, 154.0, 80.0, 8.0, 80.0, 54.0, 38.0, 133.0, 28.0, 64.0, 129.0, 49.0, 305.0, 70.0, 140.0, 12.0, 94.0, 83.0, 85.0, 31.0, 172.0, 80.0, 60.0, 116.0, 63.0, 218.0, 76.0, 62.0, 109.0, 152.0, -21.0, 46.0, 71.0, 2.0, 168.0, 60.0, 103.0, 134.0, 167.0, 82.0, 79.0, 35.0, 157.0, 155.0, 16.0, 85.0, 104.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-13.0, -3.0, 20.0, 0.0, 0.0, -30.0, 40.0, 8.0, -51.0, 0.0, 7.0, 20.0, -3.0, 18.0, -4.0, 10.0, -11.0, 0.0, 10.0, 20.0, 0.0, 13.0, 40.0, 260.0, 0.0, 20.0, -50.0, -30.0, -5.0, 0.0, 60.0, 20.0, 20.0, -1.0, 10.0, 20.0, 10.0, 10.0, 7.0, 20.0, 20.0, 0.0, -3.0, 0.0, 0.0, 29.0, 16.0, 0.0, -5.0, 25.0, 0.0, 10.0, -5.0, -1.0, 10.0, 7.0, 15.0, 30.0, 0.0, 5.0, 30.0, 0.0, 16.0, 0.0, 20.0, 0.0, 0.0, 30.0, -5.0, -6.0, 20.0, 0.0, 0.0, 10.0, 25.0, 40.0, 35.0, -3.0, 50.0, 47.0, 5.0, 70.0, 20.0, 0.0, 0.0, -6.0, 0.0, 15.0, -3.0, -5.0, 0.0, 6.0, 0.0, 8.0, -15.0, 22.0, -4.0, 10.0, -6.0, 50.0, 50.0, 0.0, -17.0, -6.0, 0.0, 10.0, 10.0, 15.0, 5.0, -1.0, 10.0, 0.0, 30.0, 9.0, -18.0, 0.0, -1.0, -3.0, 25.0, 6.0, 8.0, 5.0, 16.0, -8.0, 14.0, 3.0, 20.0, 37.0, 20.0, 20.0, 1.0, 0.0, 10.0, 10.0, 0.0, -8.0, -3.0, 4.0, 0.0, 18.0, 9.0, 36.0, 25.0, 20.0, 0.0, 0.0, 30.0, 18.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, -8.0, -1.0, -11.0, 0.0, -6.0, -35.0, -140.0, -5.0, 0.0, 9.0, -4.0, 260.0, 0.0, 0.0, 0.0, 0.0, 48.0, 0.0, -11.0, 40.0, 10.0, 2.0, 18.0, 19.0, -4.0, -15.0, 2.0, 20.0, 10.0, -1.0, 1.0, 10.0, 20.0, 27.0, 0.0, -6.0, 5.0, 15.0, -12.0, -1.0, 0.0, -4.0, 10.0, -8.0, 9.0, 26.0, 10.0, 30.0, -6.0, 20.0, 10.0, 30.0, 10.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 17.0, -4.0, 10.0, 0.0, 0.0, 19.0, -1.0, -21.0, 30.0, 160.0, 10.0, -15.0, 19.0, -46.0, 5.0, 30.0, 5.0, 20.0, 9.0, 0.0, 0.0, 17.0, -4.0, -1.0, 10.0, 6.0, 30.0, 10.0, 10.0, 0.0, 10.0, 13.0, 17.0, 8.0, 0.0, 30.0, -1.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 29.0, 4.0, 14.0, 19.0, 19.0, 10.0, -5.0, 20.0, -10.0, 3.0, -1.0, 40.0, 20.0, 30.0, 3.0, 25.0, -5.0, 13.0, 0.0, 25.0, -1.0, 12.0, -1.0, 0.0, 10.0, 10.0, 30.0, 3.0, 9.0, 0.0, 10.0, -1.0, 20.0, 30.0, 60.0, 0.0, -26.0, 34.0, 14.0, -4.0, 40.0, -5.0, 20.0, -12.0, 4.0, -40.0, -4.0, -3.0, -20.0, 270.0, 27.0, 0.0, 0.0, 0.0, 7.0, 20.0, 20.0, 50.0, 0.0, 10.0, 15.0, 0.0, 17.0, -8.0, 0.0, 40.0, 6.0, 8.0, -6.0, -2.0, 8.0, 8.0, -18.0, 0.0, 0.0, -10.0, 14.0, -2.0, 20.0, -1.0, 4.0, -5.0, 0.0, -3.0, 0.0, -8.0, 12.0, 10.0, 17.0, 30.0, 10.0, 10.0, 0.0, 30.0, 2.0, 20.0, 30.0, 0.0, -6.0, 20.0, 0.0, 20.0, 10.0, 7.0, 10.0, 10.0, -3.0, -9.0, 0.0, 10.0, -11.0, 9.0, 12.0, 20.0, 20.0, 6.0, 26.0, 10.0, -3.0, 20.0, -71.0, -4.0, -1.0, -1.0, 0.0, 9.0, 20.0, 0.0, 20.0, 5.0, 0.0, 10.0, 40.0, 30.0, 20.0, 19.0, 10.0, 9.0, 10.0, 29.0, 9.0, -2.0, -15.0, -3.0, 5.0, 8.0, -1.0, 0.0, 0.0, 0.0, -3.0, 20.0, -36.0, 6.0, 10.0, 10.0, 10.0, -3.0, -5.0, 10.0, -2.0, 10.0, -6.0, 7.0, 20.0, 0.0, 20.0, 0.0, 20.0, 3.0, 0.0, 15.0, 20.0, 49.0, 2.0, 26.0, 20.0, 3.0, 0.0, 29.0, 20.0, 10.0, 10.0, 0.0, 18.0, 0.0, 0.0, 9.0, -5.0, 30.0, 10.0, 0.0, 0.0, 35.0, 17.0, 20.0, 10.0, 0.0, 10.0, 10.0, -2.0, 0.0, 0.0, 28.0, -1.0, -3.0, 8.0, 28.0, 30.0, 0.0, 20.0, 0.0, 10.0, -8.0, 50.0, -1.0, -2.0, 0.0, 30.0, 0.0, 17.0, -5.0, 0.0, -1.0, 20.0, 0.0, 30.0, 0.0, 17.0, 0.0, 20.0, 29.0, -1.0, 40.0, 0.0, -2.0, 0.0, -8.0, 0.0, -2.0, -5.0, 10.0, 10.0, -2.0, 20.0, 30.0, 270.0, 20.0, 10.0, -31.0, 30.0, 17.0, 9.0, 10.0, 40.0, -7.0, 21.0, -5.0, 15.0, 17.0, 27.0, -2.0, 10.0, -3.0, 0.0, 10.0, 36.0, 0.0, 0.0, 0.0, 10.0, 19.0, 24.0, 10.0, 20.0, 0.0, 10.0, 8.0, -10.0, 10.0, 10.0, 7.0, -2.0, 4.0, 40.0, 10.0, -5.0, 10.0, 30.0, 30.0, 30.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, -50.0, 0.0, 60.0, 0.0, -3.0, 19.0, 9.0, 0.0, -1.0, 20.0, -10.0, -3.0, -11.0, -12.0, 20.0, -7.0, -2.0, 37.0, 7.0, 0.0, 19.0, 0.0, 10.0, -4.0, -4.0, 20.0, -8.0, 10.0, 20.0, -4.0, 20.0, 0.0, 10.0, -10.0, -5.0, 0.0, 10.0, -4.0, -11.0, 5.0, -6.0, 20.0, -1.0, 30.0, 30.0, 6.0, 10.0, 8.0, -5.0, 35.0, 16.0, 18.0, 5.0, 10.0, 5.0, 8.0, -1.0, 8.0, 0.0, 15.0, -4.0, -23.0, 20.0, 0.0, -7.0, 16.0, 30.0, 12.0, 0.0, 10.0, -8.0, 7.0, -14.0, 18.0, 8.0, 8.0, 9.0, 10.0, -3.0, 30.0, 17.0, 20.0, 0.0, 30.0, 0.0, 18.0, -1.0, -3.0, 17.0, 10.0, 0.0, -3.0, 5.0, 6.0, 15.0, 10.0, -50.0, 0.0, 10.0, 160.0, 10.0, 0.0, 150.0, 0.0, 30.0, 10.0, -8.0, 10.0, -2.0, 10.0, 0.0, 10.0, 10.0, 0.0, 18.0, 29.0, 15.0, 8.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 3.0, 10.0, -3.0, -3.0, -3.0, 15.0, 9.0, -3.0, -13.0, 0.0, 30.0, 20.0, 0.0, -6.0, 19.0, 5.0, -1.0, 40.0, -13.0, 0.0, 20.0, -4.0, 8.0, 0.0, 5.0, 3.0, 10.0, 10.0, 11.0, 20.0, 20.0, 10.0, 28.0, 13.0, 11.0, 6.0, 0.0, 8.0, -8.0, -3.0, 0.0, 0.0, 0.0, -2.0, -15.0, 20.0, -9.0, -12.0, 20.0, 29.0, 0.0, -5.0, 17.0, 20.0, 30.0, 40.0, 0.0, 50.0, 20.0, 0.0, 14.0, 0.0, 0.0, 10.0, 0.0, 17.0, 7.0, 2.0, 30.0, 0.0, 20.0, 0.0, 0.0, -10.0, 10.0, 0.0, 20.0, 10.0, -15.0, 25.0, 0.0, 20.0, 8.0, 0.0, 20.0, -3.0, 40.0, 29.0, 6.0, -4.0, 18.0, 0.0, 10.0, 10.0, 10.0, -8.0, -2.0, 30.0, 0.0, -5.0, 9.0, 39.0, 20.0, 26.0, 0.0, 9.0, 40.0, 40.0, 26.0, 9.0, 26.0, 8.0, -2.0, 5.0, 10.0, 9.0, 20.0, -20.0, 10.0, 10.0, 39.0, -22.0, 8.0, 20.0, -4.0, 10.0, -3.0, -3.0, -1.0, 18.0, -5.0, 8.0, 10.0, 0.0, 15.0, 0.0, 20.0, 10.0, -9.0, 60.0, 27.0, 27.0, 27.0, 10.0, 10.0, 15.0, -4.0, 20.0, 20.0, 0.0, -10.0, 12.0, 5.0, -12.0, -7.0, 7.0, -25.0, 4.0, 0.0, 5.0, -14.0, 30.0, 1.0, -1.0, -8.0, -11.0, 20.0, 10.0, -1.0, 20.0, 10.0, 0.0, 20.0, -5.0, 3.0, 33.0, 10.0, 0.0, 0.0, 0.0, -5.0, -9.0, 0.0, -2.0, 0.0, 10.0, -3.0, -8.0, -1.0, 20.0, 10.0, 20.0, 20.0, 0.0, 21.0, 10.0, 30.0, 26.0, -9.0, 40.0, 10.0, -1.0, 4.0, -3.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, -2.0, 9.0, 43.0, -4.0, 0.0, 30.0, 0.0, 20.0, 10.0, -3.0, 0.0, 19.0, -7.0, 0.0, 10.0, 3.0, 9.0, 90.0, 0.0, 10.0, 30.0, 14.0, 0.0, 0.0, 29.0, 10.0, 0.0, 24.0, 20.0, 40.0, 20.0, 4.0, 0.0, -19.0, 29.0, 17.0, 0.0, 7.0, 18.0, 6.0, -10.0, 10.0, 19.0, 10.0, 0.0, 10.0, 27.0, 10.0, 0.0, 3.0, -7.0, 28.0, -3.0, 6.0, 4.0, -5.0, -3.0, 19.0, 0.0, -4.0, 20.0, 20.0, 30.0, 25.0, 30.0, 37.0, -5.0, -5.0, 0.0, 5.0, 20.0, 29.0, 0.0, 10.0, 20.0, 10.0, 40.0, -1.0, -2.0, 29.0, -3.0, 0.0, -5.0, 10.0, -4.0, 0.0, 0.0, 6.0, 12.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 40.0, -2.0, 7.0, 10.0, 10.0, 0.0, 30.0, 10.0, 17.0, -1.0, 0.0, 10.0, 30.0, 10.0, -2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.315075714509961, "mean_inference_ms": 3.9253434191224947, "mean_action_processing_ms": 1.1275080050945732, "mean_env_wait_ms": 2.6499116021637317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0706179141998291, "StateBufferConnector_ms": 0.01164865493774414, "ViewRequirementAgentConnector_ms": 0.538935661315918}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -31.0, "episode_return_mean": 96.13, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.825606824263645, "num_env_steps_trained_throughput_per_sec": 32.825606824263645, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 122514.612, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122514.561, "sample_time_ms": 3280.58, "learn_time_ms": 119212.699, "learn_throughput": 33.553, "synch_weights_time_ms": 13.271}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 18, "trial_id": "6085c_00000", "date": "2024-07-01_23-34-50", "timestamp": 1719891290, "time_this_iter_s": 121.86423230171204, "time_total_s": 4138.420949220657, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4138.420949220657, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 32.30867052023121, "ram_util_percent": 79.91560693641618}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8609063456868467, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.158070469029541, "policy_loss": -0.0032890058925952583, "vf_loss": 4.160546768067109, "vf_explained_var": 0.006398693637979932, "kl": 0.008127012415070954, "entropy": 1.9861897143819969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 173715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 606.0, "episode_reward_min": -21.0, "episode_reward_mean": 116.78, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -77.0}, "policy_reward_max": {"policy_0": 470.0}, "policy_reward_mean": {"policy_0": 11.678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0, 81.0, 114.0, 138.0, 73.0, 150.0, 83.0, 167.0, 237.0, 122.0, 63.0, 15.0, 63.0, 106.0, 44.0, 49.0, 48.0, 186.0, -11.0, 20.0, 74.0, 184.0, 82.0, 100.0, 110.0, 96.0, 81.0, 51.0, 367.0, 144.0, 61.0, 101.0, 154.0, 80.0, 8.0, 80.0, 54.0, 38.0, 133.0, 28.0, 64.0, 129.0, 49.0, 305.0, 70.0, 140.0, 12.0, 94.0, 83.0, 85.0, 31.0, 172.0, 80.0, 60.0, 116.0, 63.0, 218.0, 76.0, 62.0, 109.0, 152.0, -21.0, 46.0, 71.0, 2.0, 168.0, 60.0, 103.0, 134.0, 167.0, 82.0, 79.0, 35.0, 157.0, 155.0, 16.0, 85.0, 104.0, 72.0, 384.0, 159.0, 136.0, 94.0, 340.0, 73.0, 50.0, 96.0, 160.0, 206.0, 90.0, 60.0, 174.0, 327.0, 606.0, 82.0, 324.0, 152.0, 176.0, 304.0, 71.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 19.0, -1.0, -21.0, 30.0, 160.0, 10.0, -15.0, 19.0, -46.0, 5.0, 30.0, 5.0, 20.0, 9.0, 0.0, 0.0, 17.0, -4.0, -1.0, 10.0, 6.0, 30.0, 10.0, 10.0, 0.0, 10.0, 13.0, 17.0, 8.0, 0.0, 30.0, -1.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 29.0, 4.0, 14.0, 19.0, 19.0, 10.0, -5.0, 20.0, -10.0, 3.0, -1.0, 40.0, 20.0, 30.0, 3.0, 25.0, -5.0, 13.0, 0.0, 25.0, -1.0, 12.0, -1.0, 0.0, 10.0, 10.0, 30.0, 3.0, 9.0, 0.0, 10.0, -1.0, 20.0, 30.0, 60.0, 0.0, -26.0, 34.0, 14.0, -4.0, 40.0, -5.0, 20.0, -12.0, 4.0, -40.0, -4.0, -3.0, -20.0, 270.0, 27.0, 0.0, 0.0, 0.0, 7.0, 20.0, 20.0, 50.0, 0.0, 10.0, 15.0, 0.0, 17.0, -8.0, 0.0, 40.0, 6.0, 8.0, -6.0, -2.0, 8.0, 8.0, -18.0, 0.0, 0.0, -10.0, 14.0, -2.0, 20.0, -1.0, 4.0, -5.0, 0.0, -3.0, 0.0, -8.0, 12.0, 10.0, 17.0, 30.0, 10.0, 10.0, 0.0, 30.0, 2.0, 20.0, 30.0, 0.0, -6.0, 20.0, 0.0, 20.0, 10.0, 7.0, 10.0, 10.0, -3.0, -9.0, 0.0, 10.0, -11.0, 9.0, 12.0, 20.0, 20.0, 6.0, 26.0, 10.0, -3.0, 20.0, -71.0, -4.0, -1.0, -1.0, 0.0, 9.0, 20.0, 0.0, 20.0, 5.0, 0.0, 10.0, 40.0, 30.0, 20.0, 19.0, 10.0, 9.0, 10.0, 29.0, 9.0, -2.0, -15.0, -3.0, 5.0, 8.0, -1.0, 0.0, 0.0, 0.0, -3.0, 20.0, -36.0, 6.0, 10.0, 10.0, 10.0, -3.0, -5.0, 10.0, -2.0, 10.0, -6.0, 7.0, 20.0, 0.0, 20.0, 0.0, 20.0, 3.0, 0.0, 15.0, 20.0, 49.0, 2.0, 26.0, 20.0, 3.0, 0.0, 29.0, 20.0, 10.0, 10.0, 0.0, 18.0, 0.0, 0.0, 9.0, -5.0, 30.0, 10.0, 0.0, 0.0, 35.0, 17.0, 20.0, 10.0, 0.0, 10.0, 10.0, -2.0, 0.0, 0.0, 28.0, -1.0, -3.0, 8.0, 28.0, 30.0, 0.0, 20.0, 0.0, 10.0, -8.0, 50.0, -1.0, -2.0, 0.0, 30.0, 0.0, 17.0, -5.0, 0.0, -1.0, 20.0, 0.0, 30.0, 0.0, 17.0, 0.0, 20.0, 29.0, -1.0, 40.0, 0.0, -2.0, 0.0, -8.0, 0.0, -2.0, -5.0, 10.0, 10.0, -2.0, 20.0, 30.0, 270.0, 20.0, 10.0, -31.0, 30.0, 17.0, 9.0, 10.0, 40.0, -7.0, 21.0, -5.0, 15.0, 17.0, 27.0, -2.0, 10.0, -3.0, 0.0, 10.0, 36.0, 0.0, 0.0, 0.0, 10.0, 19.0, 24.0, 10.0, 20.0, 0.0, 10.0, 8.0, -10.0, 10.0, 10.0, 7.0, -2.0, 4.0, 40.0, 10.0, -5.0, 10.0, 30.0, 30.0, 30.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, -50.0, 0.0, 60.0, 0.0, -3.0, 19.0, 9.0, 0.0, -1.0, 20.0, -10.0, -3.0, -11.0, -12.0, 20.0, -7.0, -2.0, 37.0, 7.0, 0.0, 19.0, 0.0, 10.0, -4.0, -4.0, 20.0, -8.0, 10.0, 20.0, -4.0, 20.0, 0.0, 10.0, -10.0, -5.0, 0.0, 10.0, -4.0, -11.0, 5.0, -6.0, 20.0, -1.0, 30.0, 30.0, 6.0, 10.0, 8.0, -5.0, 35.0, 16.0, 18.0, 5.0, 10.0, 5.0, 8.0, -1.0, 8.0, 0.0, 15.0, -4.0, -23.0, 20.0, 0.0, -7.0, 16.0, 30.0, 12.0, 0.0, 10.0, -8.0, 7.0, -14.0, 18.0, 8.0, 8.0, 9.0, 10.0, -3.0, 30.0, 17.0, 20.0, 0.0, 30.0, 0.0, 18.0, -1.0, -3.0, 17.0, 10.0, 0.0, -3.0, 5.0, 6.0, 15.0, 10.0, -50.0, 0.0, 10.0, 160.0, 10.0, 0.0, 150.0, 0.0, 30.0, 10.0, -8.0, 10.0, -2.0, 10.0, 0.0, 10.0, 10.0, 0.0, 18.0, 29.0, 15.0, 8.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 3.0, 10.0, -3.0, -3.0, -3.0, 15.0, 9.0, -3.0, -13.0, 0.0, 30.0, 20.0, 0.0, -6.0, 19.0, 5.0, -1.0, 40.0, -13.0, 0.0, 20.0, -4.0, 8.0, 0.0, 5.0, 3.0, 10.0, 10.0, 11.0, 20.0, 20.0, 10.0, 28.0, 13.0, 11.0, 6.0, 0.0, 8.0, -8.0, -3.0, 0.0, 0.0, 0.0, -2.0, -15.0, 20.0, -9.0, -12.0, 20.0, 29.0, 0.0, -5.0, 17.0, 20.0, 30.0, 40.0, 0.0, 50.0, 20.0, 0.0, 14.0, 0.0, 0.0, 10.0, 0.0, 17.0, 7.0, 2.0, 30.0, 0.0, 20.0, 0.0, 0.0, -10.0, 10.0, 0.0, 20.0, 10.0, -15.0, 25.0, 0.0, 20.0, 8.0, 0.0, 20.0, -3.0, 40.0, 29.0, 6.0, -4.0, 18.0, 0.0, 10.0, 10.0, 10.0, -8.0, -2.0, 30.0, 0.0, -5.0, 9.0, 39.0, 20.0, 26.0, 0.0, 9.0, 40.0, 40.0, 26.0, 9.0, 26.0, 8.0, -2.0, 5.0, 10.0, 9.0, 20.0, -20.0, 10.0, 10.0, 39.0, -22.0, 8.0, 20.0, -4.0, 10.0, -3.0, -3.0, -1.0, 18.0, -5.0, 8.0, 10.0, 0.0, 15.0, 0.0, 20.0, 10.0, -9.0, 60.0, 27.0, 27.0, 27.0, 10.0, 10.0, 15.0, -4.0, 20.0, 20.0, 0.0, -10.0, 12.0, 5.0, -12.0, -7.0, 7.0, -25.0, 4.0, 0.0, 5.0, -14.0, 30.0, 1.0, -1.0, -8.0, -11.0, 20.0, 10.0, -1.0, 20.0, 10.0, 0.0, 20.0, -5.0, 3.0, 33.0, 10.0, 0.0, 0.0, 0.0, -5.0, -9.0, 0.0, -2.0, 0.0, 10.0, -3.0, -8.0, -1.0, 20.0, 10.0, 20.0, 20.0, 0.0, 21.0, 10.0, 30.0, 26.0, -9.0, 40.0, 10.0, -1.0, 4.0, -3.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, -2.0, 9.0, 43.0, -4.0, 0.0, 30.0, 0.0, 20.0, 10.0, -3.0, 0.0, 19.0, -7.0, 0.0, 10.0, 3.0, 9.0, 90.0, 0.0, 10.0, 30.0, 14.0, 0.0, 0.0, 29.0, 10.0, 0.0, 24.0, 20.0, 40.0, 20.0, 4.0, 0.0, -19.0, 29.0, 17.0, 0.0, 7.0, 18.0, 6.0, -10.0, 10.0, 19.0, 10.0, 0.0, 10.0, 27.0, 10.0, 0.0, 3.0, -7.0, 28.0, -3.0, 6.0, 4.0, -5.0, -3.0, 19.0, 0.0, -4.0, 20.0, 20.0, 30.0, 25.0, 30.0, 37.0, -5.0, -5.0, 0.0, 5.0, 20.0, 29.0, 0.0, 10.0, 20.0, 10.0, 40.0, -1.0, -2.0, 29.0, -3.0, 0.0, -5.0, 10.0, -4.0, 0.0, 0.0, 6.0, 12.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 40.0, -2.0, 7.0, 10.0, 10.0, 0.0, 30.0, 10.0, 17.0, -1.0, 0.0, 10.0, 30.0, 10.0, -2.0, 20.0, 10.0, 0.0, 10.0, 0.0, -5.0, 9.0, -2.0, 30.0, 0.0, 25.0, 260.0, 33.0, 10.0, 10.0, 10.0, 1.0, 8.0, -3.0, 30.0, 17.0, 0.0, 0.0, 20.0, 38.0, 20.0, 38.0, 19.0, 9.0, -2.0, 10.0, 30.0, 37.0, 17.0, -8.0, 8.0, 10.0, 24.0, 0.0, 8.0, 0.0, -5.0, 10.0, 20.0, 9.0, 20.0, 6.0, 8.0, 18.0, 8.0, 260.0, -8.0, -2.0, 10.0, -1.0, -3.0, 44.0, 10.0, 0.0, 30.0, -7.0, 0.0, 30.0, 8.0, -1.0, 30.0, -4.0, -3.0, 20.0, 0.0, 18.0, 0.0, -1.0, -2.0, 30.0, 19.0, -4.0, -18.0, 30.0, -22.0, 10.0, -14.0, 1.0, 10.0, 7.0, 26.0, -2.0, 13.0, 26.0, 19.0, 22.0, -3.0, 40.0, 0.0, 8.0, 10.0, 50.0, 30.0, -7.0, 10.0, 40.0, 30.0, 30.0, 20.0, 0.0, -3.0, 19.0, 40.0, 10.0, 20.0, 3.0, 7.0, -2.0, 3.0, 0.0, 20.0, 0.0, 19.0, 10.0, 30.0, 4.0, 15.0, 20.0, -2.0, 0.0, 6.0, 10.0, -3.0, 0.0, 10.0, 30.0, 50.0, 27.0, 0.0, 20.0, -5.0, 10.0, -2.0, 15.0, 29.0, 70.0, 10.0, 270.0, 7.0, 20.0, 1.0, -12.0, -23.0, -22.0, 6.0, 20.0, 66.0, 19.0, -1.0, 470.0, -64.0, 20.0, 48.0, 13.0, 15.0, 20.0, -22.0, 15.0, 0.0, 20.0, -22.0, 18.0, 30.0, 6.0, 17.0, 260.0, 0.0, -7.0, 16.0, 40.0, 0.0, 0.0, 30.0, -45.0, 30.0, 20.0, 0.0, 18.0, 0.0, 20.0, 20.0, 29.0, 5.0, 0.0, 40.0, 40.0, 50.0, 5.0, 24.0, 18.0, 20.0, 10.0, -1.0, 0.0, 10.0, 10.0, 15.0, 10.0, -6.0, 150.0, 15.0, -13.0, 4.0, -26.0, 145.0, 30.0, 50.0, 10.0, 20.0, 9.0, -77.0, 0.0, 10.0, 21.0, -2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2164274875626506, "mean_inference_ms": 3.796760524344053, "mean_action_processing_ms": 1.0920216434359857, "mean_env_wait_ms": 2.5721189262725033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07258844375610352, "StateBufferConnector_ms": 0.012074708938598633, "ViewRequirementAgentConnector_ms": 0.6009411811828613}, "num_episodes": 22, "episode_return_max": 606.0, "episode_return_min": -21.0, "episode_return_mean": 116.78, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.60767189848669, "num_env_steps_trained_throughput_per_sec": 32.60767189848669, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 122620.682, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122620.631, "sample_time_ms": 3316.572, "learn_time_ms": 119282.397, "learn_throughput": 33.534, "synch_weights_time_ms": 13.552}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 19, "trial_id": "6085c_00000", "date": "2024-07-01_23-36-53", "timestamp": 1719891413, "time_this_iter_s": 122.68037128448486, "time_total_s": 4261.101320505142, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4261.101320505142, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.605780346820804, "ram_util_percent": 79.85606936416184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2460472836281165, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.327073130770105, "policy_loss": -0.003588482229950559, "vf_loss": 4.329742159782507, "vf_explained_var": 0.01460580452562521, "kl": 0.00919460106598252, "entropy": 1.996888173388216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 183105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 606.0, "episode_reward_min": -21.0, "episode_reward_mean": 128.56, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -92.0}, "policy_reward_max": {"policy_0": 565.0}, "policy_reward_mean": {"policy_0": 12.856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.0, 110.0, 96.0, 81.0, 51.0, 367.0, 144.0, 61.0, 101.0, 154.0, 80.0, 8.0, 80.0, 54.0, 38.0, 133.0, 28.0, 64.0, 129.0, 49.0, 305.0, 70.0, 140.0, 12.0, 94.0, 83.0, 85.0, 31.0, 172.0, 80.0, 60.0, 116.0, 63.0, 218.0, 76.0, 62.0, 109.0, 152.0, -21.0, 46.0, 71.0, 2.0, 168.0, 60.0, 103.0, 134.0, 167.0, 82.0, 79.0, 35.0, 157.0, 155.0, 16.0, 85.0, 104.0, 72.0, 384.0, 159.0, 136.0, 94.0, 340.0, 73.0, 50.0, 96.0, 160.0, 206.0, 90.0, 60.0, 174.0, 327.0, 606.0, 82.0, 324.0, 152.0, 176.0, 304.0, 71.0, 170.0, 182.0, 31.0, 0.0, 139.0, 533.0, 66.0, 160.0, 59.0, 75.0, 60.0, 221.0, 47.0, 67.0, 138.0, 294.0, 136.0, 71.0, 77.0, 197.0, 407.0, 156.0, 135.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 35.0, 17.0, 20.0, 10.0, 0.0, 10.0, 10.0, -2.0, 0.0, 0.0, 28.0, -1.0, -3.0, 8.0, 28.0, 30.0, 0.0, 20.0, 0.0, 10.0, -8.0, 50.0, -1.0, -2.0, 0.0, 30.0, 0.0, 17.0, -5.0, 0.0, -1.0, 20.0, 0.0, 30.0, 0.0, 17.0, 0.0, 20.0, 29.0, -1.0, 40.0, 0.0, -2.0, 0.0, -8.0, 0.0, -2.0, -5.0, 10.0, 10.0, -2.0, 20.0, 30.0, 270.0, 20.0, 10.0, -31.0, 30.0, 17.0, 9.0, 10.0, 40.0, -7.0, 21.0, -5.0, 15.0, 17.0, 27.0, -2.0, 10.0, -3.0, 0.0, 10.0, 36.0, 0.0, 0.0, 0.0, 10.0, 19.0, 24.0, 10.0, 20.0, 0.0, 10.0, 8.0, -10.0, 10.0, 10.0, 7.0, -2.0, 4.0, 40.0, 10.0, -5.0, 10.0, 30.0, 30.0, 30.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, -50.0, 0.0, 60.0, 0.0, -3.0, 19.0, 9.0, 0.0, -1.0, 20.0, -10.0, -3.0, -11.0, -12.0, 20.0, -7.0, -2.0, 37.0, 7.0, 0.0, 19.0, 0.0, 10.0, -4.0, -4.0, 20.0, -8.0, 10.0, 20.0, -4.0, 20.0, 0.0, 10.0, -10.0, -5.0, 0.0, 10.0, -4.0, -11.0, 5.0, -6.0, 20.0, -1.0, 30.0, 30.0, 6.0, 10.0, 8.0, -5.0, 35.0, 16.0, 18.0, 5.0, 10.0, 5.0, 8.0, -1.0, 8.0, 0.0, 15.0, -4.0, -23.0, 20.0, 0.0, -7.0, 16.0, 30.0, 12.0, 0.0, 10.0, -8.0, 7.0, -14.0, 18.0, 8.0, 8.0, 9.0, 10.0, -3.0, 30.0, 17.0, 20.0, 0.0, 30.0, 0.0, 18.0, -1.0, -3.0, 17.0, 10.0, 0.0, -3.0, 5.0, 6.0, 15.0, 10.0, -50.0, 0.0, 10.0, 160.0, 10.0, 0.0, 150.0, 0.0, 30.0, 10.0, -8.0, 10.0, -2.0, 10.0, 0.0, 10.0, 10.0, 0.0, 18.0, 29.0, 15.0, 8.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 3.0, 10.0, -3.0, -3.0, -3.0, 15.0, 9.0, -3.0, -13.0, 0.0, 30.0, 20.0, 0.0, -6.0, 19.0, 5.0, -1.0, 40.0, -13.0, 0.0, 20.0, -4.0, 8.0, 0.0, 5.0, 3.0, 10.0, 10.0, 11.0, 20.0, 20.0, 10.0, 28.0, 13.0, 11.0, 6.0, 0.0, 8.0, -8.0, -3.0, 0.0, 0.0, 0.0, -2.0, -15.0, 20.0, -9.0, -12.0, 20.0, 29.0, 0.0, -5.0, 17.0, 20.0, 30.0, 40.0, 0.0, 50.0, 20.0, 0.0, 14.0, 0.0, 0.0, 10.0, 0.0, 17.0, 7.0, 2.0, 30.0, 0.0, 20.0, 0.0, 0.0, -10.0, 10.0, 0.0, 20.0, 10.0, -15.0, 25.0, 0.0, 20.0, 8.0, 0.0, 20.0, -3.0, 40.0, 29.0, 6.0, -4.0, 18.0, 0.0, 10.0, 10.0, 10.0, -8.0, -2.0, 30.0, 0.0, -5.0, 9.0, 39.0, 20.0, 26.0, 0.0, 9.0, 40.0, 40.0, 26.0, 9.0, 26.0, 8.0, -2.0, 5.0, 10.0, 9.0, 20.0, -20.0, 10.0, 10.0, 39.0, -22.0, 8.0, 20.0, -4.0, 10.0, -3.0, -3.0, -1.0, 18.0, -5.0, 8.0, 10.0, 0.0, 15.0, 0.0, 20.0, 10.0, -9.0, 60.0, 27.0, 27.0, 27.0, 10.0, 10.0, 15.0, -4.0, 20.0, 20.0, 0.0, -10.0, 12.0, 5.0, -12.0, -7.0, 7.0, -25.0, 4.0, 0.0, 5.0, -14.0, 30.0, 1.0, -1.0, -8.0, -11.0, 20.0, 10.0, -1.0, 20.0, 10.0, 0.0, 20.0, -5.0, 3.0, 33.0, 10.0, 0.0, 0.0, 0.0, -5.0, -9.0, 0.0, -2.0, 0.0, 10.0, -3.0, -8.0, -1.0, 20.0, 10.0, 20.0, 20.0, 0.0, 21.0, 10.0, 30.0, 26.0, -9.0, 40.0, 10.0, -1.0, 4.0, -3.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, -2.0, 9.0, 43.0, -4.0, 0.0, 30.0, 0.0, 20.0, 10.0, -3.0, 0.0, 19.0, -7.0, 0.0, 10.0, 3.0, 9.0, 90.0, 0.0, 10.0, 30.0, 14.0, 0.0, 0.0, 29.0, 10.0, 0.0, 24.0, 20.0, 40.0, 20.0, 4.0, 0.0, -19.0, 29.0, 17.0, 0.0, 7.0, 18.0, 6.0, -10.0, 10.0, 19.0, 10.0, 0.0, 10.0, 27.0, 10.0, 0.0, 3.0, -7.0, 28.0, -3.0, 6.0, 4.0, -5.0, -3.0, 19.0, 0.0, -4.0, 20.0, 20.0, 30.0, 25.0, 30.0, 37.0, -5.0, -5.0, 0.0, 5.0, 20.0, 29.0, 0.0, 10.0, 20.0, 10.0, 40.0, -1.0, -2.0, 29.0, -3.0, 0.0, -5.0, 10.0, -4.0, 0.0, 0.0, 6.0, 12.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 40.0, -2.0, 7.0, 10.0, 10.0, 0.0, 30.0, 10.0, 17.0, -1.0, 0.0, 10.0, 30.0, 10.0, -2.0, 20.0, 10.0, 0.0, 10.0, 0.0, -5.0, 9.0, -2.0, 30.0, 0.0, 25.0, 260.0, 33.0, 10.0, 10.0, 10.0, 1.0, 8.0, -3.0, 30.0, 17.0, 0.0, 0.0, 20.0, 38.0, 20.0, 38.0, 19.0, 9.0, -2.0, 10.0, 30.0, 37.0, 17.0, -8.0, 8.0, 10.0, 24.0, 0.0, 8.0, 0.0, -5.0, 10.0, 20.0, 9.0, 20.0, 6.0, 8.0, 18.0, 8.0, 260.0, -8.0, -2.0, 10.0, -1.0, -3.0, 44.0, 10.0, 0.0, 30.0, -7.0, 0.0, 30.0, 8.0, -1.0, 30.0, -4.0, -3.0, 20.0, 0.0, 18.0, 0.0, -1.0, -2.0, 30.0, 19.0, -4.0, -18.0, 30.0, -22.0, 10.0, -14.0, 1.0, 10.0, 7.0, 26.0, -2.0, 13.0, 26.0, 19.0, 22.0, -3.0, 40.0, 0.0, 8.0, 10.0, 50.0, 30.0, -7.0, 10.0, 40.0, 30.0, 30.0, 20.0, 0.0, -3.0, 19.0, 40.0, 10.0, 20.0, 3.0, 7.0, -2.0, 3.0, 0.0, 20.0, 0.0, 19.0, 10.0, 30.0, 4.0, 15.0, 20.0, -2.0, 0.0, 6.0, 10.0, -3.0, 0.0, 10.0, 30.0, 50.0, 27.0, 0.0, 20.0, -5.0, 10.0, -2.0, 15.0, 29.0, 70.0, 10.0, 270.0, 7.0, 20.0, 1.0, -12.0, -23.0, -22.0, 6.0, 20.0, 66.0, 19.0, -1.0, 470.0, -64.0, 20.0, 48.0, 13.0, 15.0, 20.0, -22.0, 15.0, 0.0, 20.0, -22.0, 18.0, 30.0, 6.0, 17.0, 260.0, 0.0, -7.0, 16.0, 40.0, 0.0, 0.0, 30.0, -45.0, 30.0, 20.0, 0.0, 18.0, 0.0, 20.0, 20.0, 29.0, 5.0, 0.0, 40.0, 40.0, 50.0, 5.0, 24.0, 18.0, 20.0, 10.0, -1.0, 0.0, 10.0, 10.0, 15.0, 10.0, -6.0, 150.0, 15.0, -13.0, 4.0, -26.0, 145.0, 30.0, 50.0, 10.0, 20.0, 9.0, -77.0, 0.0, 10.0, 21.0, -2.0, -6.0, 17.0, 20.0, 20.0, 19.0, 26.0, 19.0, 20.0, 28.0, 7.0, 30.0, 20.0, -18.0, 9.0, 8.0, 10.0, 100.0, -3.0, 16.0, 10.0, -20.0, 20.0, 18.0, 10.0, 19.0, -9.0, -14.0, -25.0, 12.0, 20.0, 10.0, 6.0, -5.0, 4.0, -75.0, 17.0, 8.0, 27.0, 0.0, 8.0, 0.0, 16.0, 10.0, 0.0, 40.0, 27.0, -4.0, 20.0, 10.0, 20.0, -10.0, 0.0, 0.0, 13.0, -31.0, -57.0, 20.0, 565.0, 27.0, 6.0, 10.0, 10.0, 0.0, -4.0, 20.0, -7.0, 40.0, -2.0, -1.0, 0.0, 20.0, 10.0, 0.0, 6.0, 0.0, -5.0, 29.0, 30.0, 20.0, 50.0, 20.0, 17.0, 16.0, 7.0, -6.0, -9.0, 10.0, 10.0, -3.0, -3.0, 25.0, 14.0, 6.0, 11.0, -6.0, -7.0, 30.0, 12.0, -9.0, -1.0, 30.0, 10.0, 6.0, 0.0, -17.0, 17.0, 0.0, 10.0, -6.0, 10.0, -14.0, -80.0, 10.0, 18.0, -3.0, -10.0, 30.0, 20.0, 0.0, 250.0, 0.0, 2.0, 20.0, 40.0, 19.0, 0.0, -36.0, 0.0, 50.0, -48.0, 0.0, 3.0, 40.0, 24.0, -4.0, 0.0, 16.0, -2.0, 1.0, -11.0, -2.0, 0.0, 2.0, 34.0, 20.0, 37.0, 9.0, 9.0, 20.0, 9.0, 40.0, 0.0, 30.0, 150.0, 10.0, -1.0, -10.0, 26.0, 29.0, 20.0, 30.0, 28.0, 14.0, -2.0, -4.0, 6.0, 23.0, 1.0, 50.0, -10.0, 14.0, 10.0, 10.0, -5.0, 10.0, 13.0, -33.0, 35.0, 7.0, 10.0, 10.0, 20.0, 10.0, 0.0, 3.0, 9.0, 14.0, -5.0, 0.0, 16.0, 29.0, 9.0, 29.0, 17.0, 15.0, 40.0, 0.0, 50.0, 0.0, 8.0, 38.0, -2.0, 0.0, 460.0, 26.0, 17.0, -92.0, 10.0, -80.0, 30.0, 20.0, 9.0, 29.0, 19.0, 16.0, 6.0, 7.0, 10.0, 30.0, 10.0, -6.0, 10.0, -11.0, 10.0, 26.0, 20.0, 50.0, 19.0, 20.0, -3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1150316754739524, "mean_inference_ms": 3.694805177129059, "mean_action_processing_ms": 1.0736220554108147, "mean_env_wait_ms": 2.498735814270155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07154583930969238, "StateBufferConnector_ms": 0.011470317840576172, "ViewRequirementAgentConnector_ms": 0.6058444976806641}, "num_episodes": 23, "episode_return_max": 606.0, "episode_return_min": -21.0, "episode_return_mean": 128.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.271569658494265, "num_env_steps_trained_throughput_per_sec": 32.271569658494265, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 122969.906, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122969.855, "sample_time_ms": 3334.683, "learn_time_ms": 119613.165, "learn_throughput": 33.441, "synch_weights_time_ms": 13.765}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 20, "trial_id": "6085c_00000", "date": "2024-07-01_23-38-57", "timestamp": 1719891537, "time_this_iter_s": 123.96030521392822, "time_total_s": 4385.06162571907, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e5700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4385.06162571907, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 31.91885714285714, "ram_util_percent": 80.04971428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3919929973741434, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.5061053460906235, "policy_loss": -0.005582702017629259, "vf_loss": 4.5108446600845955, "vf_explained_var": 0.012145439828165804, "kl": 0.008433941614962215, "entropy": 1.9871880359923877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 192495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 606.0, "episode_reward_min": -21.0, "episode_reward_mean": 138.54, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -92.0}, "policy_reward_max": {"policy_0": 565.0}, "policy_reward_mean": {"policy_0": 13.854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.0, 49.0, 305.0, 70.0, 140.0, 12.0, 94.0, 83.0, 85.0, 31.0, 172.0, 80.0, 60.0, 116.0, 63.0, 218.0, 76.0, 62.0, 109.0, 152.0, -21.0, 46.0, 71.0, 2.0, 168.0, 60.0, 103.0, 134.0, 167.0, 82.0, 79.0, 35.0, 157.0, 155.0, 16.0, 85.0, 104.0, 72.0, 384.0, 159.0, 136.0, 94.0, 340.0, 73.0, 50.0, 96.0, 160.0, 206.0, 90.0, 60.0, 174.0, 327.0, 606.0, 82.0, 324.0, 152.0, 176.0, 304.0, 71.0, 170.0, 182.0, 31.0, 0.0, 139.0, 533.0, 66.0, 160.0, 59.0, 75.0, 60.0, 221.0, 47.0, 67.0, 138.0, 294.0, 136.0, 71.0, 77.0, 197.0, 407.0, 156.0, 135.0, 130.0, 67.0, 50.0, 96.0, 161.0, 94.0, 347.0, 73.0, 147.0, 111.0, 133.0, 119.0, 149.0, 49.0, 71.0, 328.0, 157.0, 466.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [8.0, 8.0, 9.0, 10.0, -3.0, 30.0, 17.0, 20.0, 0.0, 30.0, 0.0, 18.0, -1.0, -3.0, 17.0, 10.0, 0.0, -3.0, 5.0, 6.0, 15.0, 10.0, -50.0, 0.0, 10.0, 160.0, 10.0, 0.0, 150.0, 0.0, 30.0, 10.0, -8.0, 10.0, -2.0, 10.0, 0.0, 10.0, 10.0, 0.0, 18.0, 29.0, 15.0, 8.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 3.0, 10.0, -3.0, -3.0, -3.0, 15.0, 9.0, -3.0, -13.0, 0.0, 30.0, 20.0, 0.0, -6.0, 19.0, 5.0, -1.0, 40.0, -13.0, 0.0, 20.0, -4.0, 8.0, 0.0, 5.0, 3.0, 10.0, 10.0, 11.0, 20.0, 20.0, 10.0, 28.0, 13.0, 11.0, 6.0, 0.0, 8.0, -8.0, -3.0, 0.0, 0.0, 0.0, -2.0, -15.0, 20.0, -9.0, -12.0, 20.0, 29.0, 0.0, -5.0, 17.0, 20.0, 30.0, 40.0, 0.0, 50.0, 20.0, 0.0, 14.0, 0.0, 0.0, 10.0, 0.0, 17.0, 7.0, 2.0, 30.0, 0.0, 20.0, 0.0, 0.0, -10.0, 10.0, 0.0, 20.0, 10.0, -15.0, 25.0, 0.0, 20.0, 8.0, 0.0, 20.0, -3.0, 40.0, 29.0, 6.0, -4.0, 18.0, 0.0, 10.0, 10.0, 10.0, -8.0, -2.0, 30.0, 0.0, -5.0, 9.0, 39.0, 20.0, 26.0, 0.0, 9.0, 40.0, 40.0, 26.0, 9.0, 26.0, 8.0, -2.0, 5.0, 10.0, 9.0, 20.0, -20.0, 10.0, 10.0, 39.0, -22.0, 8.0, 20.0, -4.0, 10.0, -3.0, -3.0, -1.0, 18.0, -5.0, 8.0, 10.0, 0.0, 15.0, 0.0, 20.0, 10.0, -9.0, 60.0, 27.0, 27.0, 27.0, 10.0, 10.0, 15.0, -4.0, 20.0, 20.0, 0.0, -10.0, 12.0, 5.0, -12.0, -7.0, 7.0, -25.0, 4.0, 0.0, 5.0, -14.0, 30.0, 1.0, -1.0, -8.0, -11.0, 20.0, 10.0, -1.0, 20.0, 10.0, 0.0, 20.0, -5.0, 3.0, 33.0, 10.0, 0.0, 0.0, 0.0, -5.0, -9.0, 0.0, -2.0, 0.0, 10.0, -3.0, -8.0, -1.0, 20.0, 10.0, 20.0, 20.0, 0.0, 21.0, 10.0, 30.0, 26.0, -9.0, 40.0, 10.0, -1.0, 4.0, -3.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, -2.0, 9.0, 43.0, -4.0, 0.0, 30.0, 0.0, 20.0, 10.0, -3.0, 0.0, 19.0, -7.0, 0.0, 10.0, 3.0, 9.0, 90.0, 0.0, 10.0, 30.0, 14.0, 0.0, 0.0, 29.0, 10.0, 0.0, 24.0, 20.0, 40.0, 20.0, 4.0, 0.0, -19.0, 29.0, 17.0, 0.0, 7.0, 18.0, 6.0, -10.0, 10.0, 19.0, 10.0, 0.0, 10.0, 27.0, 10.0, 0.0, 3.0, -7.0, 28.0, -3.0, 6.0, 4.0, -5.0, -3.0, 19.0, 0.0, -4.0, 20.0, 20.0, 30.0, 25.0, 30.0, 37.0, -5.0, -5.0, 0.0, 5.0, 20.0, 29.0, 0.0, 10.0, 20.0, 10.0, 40.0, -1.0, -2.0, 29.0, -3.0, 0.0, -5.0, 10.0, -4.0, 0.0, 0.0, 6.0, 12.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 40.0, -2.0, 7.0, 10.0, 10.0, 0.0, 30.0, 10.0, 17.0, -1.0, 0.0, 10.0, 30.0, 10.0, -2.0, 20.0, 10.0, 0.0, 10.0, 0.0, -5.0, 9.0, -2.0, 30.0, 0.0, 25.0, 260.0, 33.0, 10.0, 10.0, 10.0, 1.0, 8.0, -3.0, 30.0, 17.0, 0.0, 0.0, 20.0, 38.0, 20.0, 38.0, 19.0, 9.0, -2.0, 10.0, 30.0, 37.0, 17.0, -8.0, 8.0, 10.0, 24.0, 0.0, 8.0, 0.0, -5.0, 10.0, 20.0, 9.0, 20.0, 6.0, 8.0, 18.0, 8.0, 260.0, -8.0, -2.0, 10.0, -1.0, -3.0, 44.0, 10.0, 0.0, 30.0, -7.0, 0.0, 30.0, 8.0, -1.0, 30.0, -4.0, -3.0, 20.0, 0.0, 18.0, 0.0, -1.0, -2.0, 30.0, 19.0, -4.0, -18.0, 30.0, -22.0, 10.0, -14.0, 1.0, 10.0, 7.0, 26.0, -2.0, 13.0, 26.0, 19.0, 22.0, -3.0, 40.0, 0.0, 8.0, 10.0, 50.0, 30.0, -7.0, 10.0, 40.0, 30.0, 30.0, 20.0, 0.0, -3.0, 19.0, 40.0, 10.0, 20.0, 3.0, 7.0, -2.0, 3.0, 0.0, 20.0, 0.0, 19.0, 10.0, 30.0, 4.0, 15.0, 20.0, -2.0, 0.0, 6.0, 10.0, -3.0, 0.0, 10.0, 30.0, 50.0, 27.0, 0.0, 20.0, -5.0, 10.0, -2.0, 15.0, 29.0, 70.0, 10.0, 270.0, 7.0, 20.0, 1.0, -12.0, -23.0, -22.0, 6.0, 20.0, 66.0, 19.0, -1.0, 470.0, -64.0, 20.0, 48.0, 13.0, 15.0, 20.0, -22.0, 15.0, 0.0, 20.0, -22.0, 18.0, 30.0, 6.0, 17.0, 260.0, 0.0, -7.0, 16.0, 40.0, 0.0, 0.0, 30.0, -45.0, 30.0, 20.0, 0.0, 18.0, 0.0, 20.0, 20.0, 29.0, 5.0, 0.0, 40.0, 40.0, 50.0, 5.0, 24.0, 18.0, 20.0, 10.0, -1.0, 0.0, 10.0, 10.0, 15.0, 10.0, -6.0, 150.0, 15.0, -13.0, 4.0, -26.0, 145.0, 30.0, 50.0, 10.0, 20.0, 9.0, -77.0, 0.0, 10.0, 21.0, -2.0, -6.0, 17.0, 20.0, 20.0, 19.0, 26.0, 19.0, 20.0, 28.0, 7.0, 30.0, 20.0, -18.0, 9.0, 8.0, 10.0, 100.0, -3.0, 16.0, 10.0, -20.0, 20.0, 18.0, 10.0, 19.0, -9.0, -14.0, -25.0, 12.0, 20.0, 10.0, 6.0, -5.0, 4.0, -75.0, 17.0, 8.0, 27.0, 0.0, 8.0, 0.0, 16.0, 10.0, 0.0, 40.0, 27.0, -4.0, 20.0, 10.0, 20.0, -10.0, 0.0, 0.0, 13.0, -31.0, -57.0, 20.0, 565.0, 27.0, 6.0, 10.0, 10.0, 0.0, -4.0, 20.0, -7.0, 40.0, -2.0, -1.0, 0.0, 20.0, 10.0, 0.0, 6.0, 0.0, -5.0, 29.0, 30.0, 20.0, 50.0, 20.0, 17.0, 16.0, 7.0, -6.0, -9.0, 10.0, 10.0, -3.0, -3.0, 25.0, 14.0, 6.0, 11.0, -6.0, -7.0, 30.0, 12.0, -9.0, -1.0, 30.0, 10.0, 6.0, 0.0, -17.0, 17.0, 0.0, 10.0, -6.0, 10.0, -14.0, -80.0, 10.0, 18.0, -3.0, -10.0, 30.0, 20.0, 0.0, 250.0, 0.0, 2.0, 20.0, 40.0, 19.0, 0.0, -36.0, 0.0, 50.0, -48.0, 0.0, 3.0, 40.0, 24.0, -4.0, 0.0, 16.0, -2.0, 1.0, -11.0, -2.0, 0.0, 2.0, 34.0, 20.0, 37.0, 9.0, 9.0, 20.0, 9.0, 40.0, 0.0, 30.0, 150.0, 10.0, -1.0, -10.0, 26.0, 29.0, 20.0, 30.0, 28.0, 14.0, -2.0, -4.0, 6.0, 23.0, 1.0, 50.0, -10.0, 14.0, 10.0, 10.0, -5.0, 10.0, 13.0, -33.0, 35.0, 7.0, 10.0, 10.0, 20.0, 10.0, 0.0, 3.0, 9.0, 14.0, -5.0, 0.0, 16.0, 29.0, 9.0, 29.0, 17.0, 15.0, 40.0, 0.0, 50.0, 0.0, 8.0, 38.0, -2.0, 0.0, 460.0, 26.0, 17.0, -92.0, 10.0, -80.0, 30.0, 20.0, 9.0, 29.0, 19.0, 16.0, 6.0, 7.0, 10.0, 30.0, 10.0, -6.0, 10.0, -11.0, 10.0, 26.0, 20.0, 50.0, 19.0, 20.0, -3.0, 20.0, 8.0, 40.0, 0.0, 39.0, 3.0, 0.0, 0.0, 0.0, 20.0, -9.0, 20.0, 0.0, 40.0, 5.0, -6.0, 4.0, 15.0, -10.0, 8.0, -1.0, -6.0, -2.0, 10.0, 10.0, 19.0, 30.0, -10.0, 0.0, 0.0, -2.0, 5.0, 10.0, 6.0, 20.0, 20.0, -3.0, 0.0, 30.0, 10.0, 20.0, 8.0, 0.0, 58.0, 20.0, 10.0, 37.0, -5.0, 3.0, 10.0, 30.0, 0.0, 17.0, -6.0, 10.0, -13.0, 0.0, 16.0, 40.0, 0.0, 18.0, 50.0, 70.0, 18.0, 40.0, 70.0, -5.0, 60.0, 26.0, 0.0, -11.0, -1.0, 5.0, 10.0, 30.0, -8.0, -6.0, 10.0, 40.0, 4.0, 30.0, 30.0, 50.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, -13.0, 1.0, 0.0, 25.0, 16.0, 3.0, 11.0, 5.0, 23.0, 10.0, 17.0, 39.0, -4.0, 20.0, 10.0, 20.0, -2.0, 0.0, -6.0, 50.0, 6.0, 9.0, 56.0, -16.0, 20.0, 15.0, -9.0, 20.0, -3.0, 7.0, 20.0, 0.0, 9.0, 18.0, 6.0, 10.0, -4.0, 21.0, 40.0, 3.0, 46.0, 20.0, 13.0, 0.0, 1.0, -2.0, 8.0, -6.0, 40.0, -34.0, 9.0, 10.0, 0.0, -3.0, -5.0, 17.0, 25.0, 17.0, -13.0, 26.0, -3.0, 30.0, 40.0, 28.0, 50.0, 166.0, 40.0, -51.0, -32.0, 27.0, 30.0, 17.0, 24.0, -5.0, 0.0, -6.0, 30.0, 60.0, 0.0, 18.0, 19.0, 40.0, 40.0, 20.0, 20.0, 20.0, 250.0, 9.0, 30.0, 27.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0435440997312226, "mean_inference_ms": 3.6130497302118045, "mean_action_processing_ms": 1.0544990816071858, "mean_env_wait_ms": 2.445591022072934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07168054580688477, "StateBufferConnector_ms": 0.011977672576904297, "ViewRequirementAgentConnector_ms": 0.6090147495269775}, "num_episodes": 18, "episode_return_max": 606.0, "episode_return_min": -21.0, "episode_return_mean": 138.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.54878217205965, "num_env_steps_trained_throughput_per_sec": 32.54878217205965, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 123106.212, "restore_workers_time_ms": 0.012, "training_step_time_ms": 123106.161, "sample_time_ms": 3325.768, "learn_time_ms": 119758.377, "learn_throughput": 33.401, "synch_weights_time_ms": 13.804}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 21, "trial_id": "6085c_00000", "date": "2024-07-01_23-41-00", "timestamp": 1719891660, "time_this_iter_s": 122.90442490577698, "time_total_s": 4507.966050624847, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9151310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4507.966050624847, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 31.79310344827586, "ram_util_percent": 79.93103448275862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.080951405739505, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.5612868963339075, "policy_loss": -0.00379440895665072, "vf_loss": 4.564050475146951, "vf_explained_var": 0.012337593789806508, "kl": 0.010308255632899506, "entropy": 1.9621764398992252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 201885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 606.0, "episode_reward_min": -21.0, "episode_reward_mean": 152.61, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -92.0}, "policy_reward_max": {"policy_0": 565.0}, "policy_reward_mean": {"policy_0": 15.261}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.0, 152.0, -21.0, 46.0, 71.0, 2.0, 168.0, 60.0, 103.0, 134.0, 167.0, 82.0, 79.0, 35.0, 157.0, 155.0, 16.0, 85.0, 104.0, 72.0, 384.0, 159.0, 136.0, 94.0, 340.0, 73.0, 50.0, 96.0, 160.0, 206.0, 90.0, 60.0, 174.0, 327.0, 606.0, 82.0, 324.0, 152.0, 176.0, 304.0, 71.0, 170.0, 182.0, 31.0, 0.0, 139.0, 533.0, 66.0, 160.0, 59.0, 75.0, 60.0, 221.0, 47.0, 67.0, 138.0, 294.0, 136.0, 71.0, 77.0, 197.0, 407.0, 156.0, 135.0, 130.0, 67.0, 50.0, 96.0, 161.0, 94.0, 347.0, 73.0, 147.0, 111.0, 133.0, 119.0, 149.0, 49.0, 71.0, 328.0, 157.0, 466.0, 115.0, 218.0, 135.0, 187.0, 163.0, 54.0, 287.0, 168.0, 71.0, 55.0, 58.0, 377.0, 260.0, 431.0, 223.0, 225.0, 158.0, 67.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-5.0, 8.0, 10.0, 0.0, 15.0, 0.0, 20.0, 10.0, -9.0, 60.0, 27.0, 27.0, 27.0, 10.0, 10.0, 15.0, -4.0, 20.0, 20.0, 0.0, -10.0, 12.0, 5.0, -12.0, -7.0, 7.0, -25.0, 4.0, 0.0, 5.0, -14.0, 30.0, 1.0, -1.0, -8.0, -11.0, 20.0, 10.0, -1.0, 20.0, 10.0, 0.0, 20.0, -5.0, 3.0, 33.0, 10.0, 0.0, 0.0, 0.0, -5.0, -9.0, 0.0, -2.0, 0.0, 10.0, -3.0, -8.0, -1.0, 20.0, 10.0, 20.0, 20.0, 0.0, 21.0, 10.0, 30.0, 26.0, -9.0, 40.0, 10.0, -1.0, 4.0, -3.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, -2.0, 9.0, 43.0, -4.0, 0.0, 30.0, 0.0, 20.0, 10.0, -3.0, 0.0, 19.0, -7.0, 0.0, 10.0, 3.0, 9.0, 90.0, 0.0, 10.0, 30.0, 14.0, 0.0, 0.0, 29.0, 10.0, 0.0, 24.0, 20.0, 40.0, 20.0, 4.0, 0.0, -19.0, 29.0, 17.0, 0.0, 7.0, 18.0, 6.0, -10.0, 10.0, 19.0, 10.0, 0.0, 10.0, 27.0, 10.0, 0.0, 3.0, -7.0, 28.0, -3.0, 6.0, 4.0, -5.0, -3.0, 19.0, 0.0, -4.0, 20.0, 20.0, 30.0, 25.0, 30.0, 37.0, -5.0, -5.0, 0.0, 5.0, 20.0, 29.0, 0.0, 10.0, 20.0, 10.0, 40.0, -1.0, -2.0, 29.0, -3.0, 0.0, -5.0, 10.0, -4.0, 0.0, 0.0, 6.0, 12.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 40.0, -2.0, 7.0, 10.0, 10.0, 0.0, 30.0, 10.0, 17.0, -1.0, 0.0, 10.0, 30.0, 10.0, -2.0, 20.0, 10.0, 0.0, 10.0, 0.0, -5.0, 9.0, -2.0, 30.0, 0.0, 25.0, 260.0, 33.0, 10.0, 10.0, 10.0, 1.0, 8.0, -3.0, 30.0, 17.0, 0.0, 0.0, 20.0, 38.0, 20.0, 38.0, 19.0, 9.0, -2.0, 10.0, 30.0, 37.0, 17.0, -8.0, 8.0, 10.0, 24.0, 0.0, 8.0, 0.0, -5.0, 10.0, 20.0, 9.0, 20.0, 6.0, 8.0, 18.0, 8.0, 260.0, -8.0, -2.0, 10.0, -1.0, -3.0, 44.0, 10.0, 0.0, 30.0, -7.0, 0.0, 30.0, 8.0, -1.0, 30.0, -4.0, -3.0, 20.0, 0.0, 18.0, 0.0, -1.0, -2.0, 30.0, 19.0, -4.0, -18.0, 30.0, -22.0, 10.0, -14.0, 1.0, 10.0, 7.0, 26.0, -2.0, 13.0, 26.0, 19.0, 22.0, -3.0, 40.0, 0.0, 8.0, 10.0, 50.0, 30.0, -7.0, 10.0, 40.0, 30.0, 30.0, 20.0, 0.0, -3.0, 19.0, 40.0, 10.0, 20.0, 3.0, 7.0, -2.0, 3.0, 0.0, 20.0, 0.0, 19.0, 10.0, 30.0, 4.0, 15.0, 20.0, -2.0, 0.0, 6.0, 10.0, -3.0, 0.0, 10.0, 30.0, 50.0, 27.0, 0.0, 20.0, -5.0, 10.0, -2.0, 15.0, 29.0, 70.0, 10.0, 270.0, 7.0, 20.0, 1.0, -12.0, -23.0, -22.0, 6.0, 20.0, 66.0, 19.0, -1.0, 470.0, -64.0, 20.0, 48.0, 13.0, 15.0, 20.0, -22.0, 15.0, 0.0, 20.0, -22.0, 18.0, 30.0, 6.0, 17.0, 260.0, 0.0, -7.0, 16.0, 40.0, 0.0, 0.0, 30.0, -45.0, 30.0, 20.0, 0.0, 18.0, 0.0, 20.0, 20.0, 29.0, 5.0, 0.0, 40.0, 40.0, 50.0, 5.0, 24.0, 18.0, 20.0, 10.0, -1.0, 0.0, 10.0, 10.0, 15.0, 10.0, -6.0, 150.0, 15.0, -13.0, 4.0, -26.0, 145.0, 30.0, 50.0, 10.0, 20.0, 9.0, -77.0, 0.0, 10.0, 21.0, -2.0, -6.0, 17.0, 20.0, 20.0, 19.0, 26.0, 19.0, 20.0, 28.0, 7.0, 30.0, 20.0, -18.0, 9.0, 8.0, 10.0, 100.0, -3.0, 16.0, 10.0, -20.0, 20.0, 18.0, 10.0, 19.0, -9.0, -14.0, -25.0, 12.0, 20.0, 10.0, 6.0, -5.0, 4.0, -75.0, 17.0, 8.0, 27.0, 0.0, 8.0, 0.0, 16.0, 10.0, 0.0, 40.0, 27.0, -4.0, 20.0, 10.0, 20.0, -10.0, 0.0, 0.0, 13.0, -31.0, -57.0, 20.0, 565.0, 27.0, 6.0, 10.0, 10.0, 0.0, -4.0, 20.0, -7.0, 40.0, -2.0, -1.0, 0.0, 20.0, 10.0, 0.0, 6.0, 0.0, -5.0, 29.0, 30.0, 20.0, 50.0, 20.0, 17.0, 16.0, 7.0, -6.0, -9.0, 10.0, 10.0, -3.0, -3.0, 25.0, 14.0, 6.0, 11.0, -6.0, -7.0, 30.0, 12.0, -9.0, -1.0, 30.0, 10.0, 6.0, 0.0, -17.0, 17.0, 0.0, 10.0, -6.0, 10.0, -14.0, -80.0, 10.0, 18.0, -3.0, -10.0, 30.0, 20.0, 0.0, 250.0, 0.0, 2.0, 20.0, 40.0, 19.0, 0.0, -36.0, 0.0, 50.0, -48.0, 0.0, 3.0, 40.0, 24.0, -4.0, 0.0, 16.0, -2.0, 1.0, -11.0, -2.0, 0.0, 2.0, 34.0, 20.0, 37.0, 9.0, 9.0, 20.0, 9.0, 40.0, 0.0, 30.0, 150.0, 10.0, -1.0, -10.0, 26.0, 29.0, 20.0, 30.0, 28.0, 14.0, -2.0, -4.0, 6.0, 23.0, 1.0, 50.0, -10.0, 14.0, 10.0, 10.0, -5.0, 10.0, 13.0, -33.0, 35.0, 7.0, 10.0, 10.0, 20.0, 10.0, 0.0, 3.0, 9.0, 14.0, -5.0, 0.0, 16.0, 29.0, 9.0, 29.0, 17.0, 15.0, 40.0, 0.0, 50.0, 0.0, 8.0, 38.0, -2.0, 0.0, 460.0, 26.0, 17.0, -92.0, 10.0, -80.0, 30.0, 20.0, 9.0, 29.0, 19.0, 16.0, 6.0, 7.0, 10.0, 30.0, 10.0, -6.0, 10.0, -11.0, 10.0, 26.0, 20.0, 50.0, 19.0, 20.0, -3.0, 20.0, 8.0, 40.0, 0.0, 39.0, 3.0, 0.0, 0.0, 0.0, 20.0, -9.0, 20.0, 0.0, 40.0, 5.0, -6.0, 4.0, 15.0, -10.0, 8.0, -1.0, -6.0, -2.0, 10.0, 10.0, 19.0, 30.0, -10.0, 0.0, 0.0, -2.0, 5.0, 10.0, 6.0, 20.0, 20.0, -3.0, 0.0, 30.0, 10.0, 20.0, 8.0, 0.0, 58.0, 20.0, 10.0, 37.0, -5.0, 3.0, 10.0, 30.0, 0.0, 17.0, -6.0, 10.0, -13.0, 0.0, 16.0, 40.0, 0.0, 18.0, 50.0, 70.0, 18.0, 40.0, 70.0, -5.0, 60.0, 26.0, 0.0, -11.0, -1.0, 5.0, 10.0, 30.0, -8.0, -6.0, 10.0, 40.0, 4.0, 30.0, 30.0, 50.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, -13.0, 1.0, 0.0, 25.0, 16.0, 3.0, 11.0, 5.0, 23.0, 10.0, 17.0, 39.0, -4.0, 20.0, 10.0, 20.0, -2.0, 0.0, -6.0, 50.0, 6.0, 9.0, 56.0, -16.0, 20.0, 15.0, -9.0, 20.0, -3.0, 7.0, 20.0, 0.0, 9.0, 18.0, 6.0, 10.0, -4.0, 21.0, 40.0, 3.0, 46.0, 20.0, 13.0, 0.0, 1.0, -2.0, 8.0, -6.0, 40.0, -34.0, 9.0, 10.0, 0.0, -3.0, -5.0, 17.0, 25.0, 17.0, -13.0, 26.0, -3.0, 30.0, 40.0, 28.0, 50.0, 166.0, 40.0, -51.0, -32.0, 27.0, 30.0, 17.0, 24.0, -5.0, 0.0, -6.0, 30.0, 60.0, 0.0, 18.0, 19.0, 40.0, 40.0, 20.0, 20.0, 20.0, 250.0, 9.0, 30.0, 27.0, 10.0, 20.0, -3.0, 10.0, 7.0, 10.0, -35.0, 7.0, 20.0, 34.0, 45.0, 30.0, 30.0, 1.0, -4.0, 7.0, 17.0, 39.0, 40.0, 10.0, 48.0, 8.0, 14.0, 30.0, 7.0, 35.0, 10.0, 18.0, 7.0, 20.0, -14.0, 24.0, -5.0, 0.0, 40.0, 29.0, 20.0, 25.0, 9.0, 29.0, 16.0, 48.0, -1.0, 20.0, 10.0, 18.0, 10.0, 39.0, 20.0, 0.0, -1.0, 30.0, -1.0, 15.0, 0.0, -15.0, 5.0, 0.0, -4.0, 15.0, 9.0, 9.0, 30.0, 0.0, 10.0, 170.0, 5.0, 27.0, 0.0, 16.0, 20.0, 29.0, 50.0, 20.0, 3.0, 30.0, 6.0, 10.0, 8.0, 15.0, -3.0, -3.0, -20.0, 50.0, 10.0, 10.0, 1.0, 27.0, -9.0, -43.0, 48.0, 17.0, 0.0, -8.0, 16.0, 5.0, 4.0, 10.0, 14.0, 0.0, -3.0, -10.0, 20.0, -13.0, 15.0, 30.0, 14.0, -17.0, 19.0, 19.0, -19.0, -1.0, 5.0, 30.0, 53.0, -1.0, 17.0, -6.0, 0.0, 20.0, 260.0, 0.0, 27.0, 70.0, 10.0, 70.0, -1.0, 28.0, 0.0, 39.0, 17.0, 9.0, 25.0, 30.0, 160.0, 13.0, 170.0, 28.0, -11.0, -3.0, 10.0, 0.0, 5.0, -81.0, 4.0, 253.0, -1.0, -1.0, 20.0, 27.0, -3.0, 10.0, 145.0, 0.0, -4.0, 18.0, 20.0, 20.0, 15.0, -9.0, 10.0, 3.0, 160.0, 16.0, 10.0, -2.0, 39.0, -12.0, 4.0, 1.0, -61.0, 0.0, 18.0, 15.0, -4.0, 18.0, -4.0, 8.0, 1.0, 1.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9893586341125116, "mean_inference_ms": 3.540654956286646, "mean_action_processing_ms": 1.050651322915106, "mean_env_wait_ms": 2.3987028637451036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07646036148071289, "StateBufferConnector_ms": 0.012089014053344727, "ViewRequirementAgentConnector_ms": 0.5678789615631104}, "num_episodes": 18, "episode_return_max": 606.0, "episode_return_min": -21.0, "episode_return_mean": 152.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.12115872326752, "num_env_steps_trained_throughput_per_sec": 32.12115872326752, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 123157.936, "restore_workers_time_ms": 0.012, "training_step_time_ms": 123157.886, "sample_time_ms": 3456.746, "learn_time_ms": 119678.613, "learn_throughput": 33.423, "synch_weights_time_ms": 13.715}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 22, "trial_id": "6085c_00000", "date": "2024-07-01_23-43-04", "timestamp": 1719891784, "time_this_iter_s": 124.54363107681274, "time_total_s": 4632.50968170166, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138009f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4632.50968170166, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.961363636363636, "ram_util_percent": 81.11988636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.406319211364681, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.380114300487141, "policy_loss": -0.0032775824020703, "vf_loss": 4.382531489833348, "vf_explained_var": 0.00803894799865219, "kl": 0.008604001250876807, "entropy": 1.9647696849637137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 211275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 606.0, "episode_reward_min": -29.0, "episode_reward_mean": 171.58, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -92.0}, "policy_reward_max": {"policy_0": 565.0}, "policy_reward_mean": {"policy_0": 17.158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.0, 72.0, 384.0, 159.0, 136.0, 94.0, 340.0, 73.0, 50.0, 96.0, 160.0, 206.0, 90.0, 60.0, 174.0, 327.0, 606.0, 82.0, 324.0, 152.0, 176.0, 304.0, 71.0, 170.0, 182.0, 31.0, 0.0, 139.0, 533.0, 66.0, 160.0, 59.0, 75.0, 60.0, 221.0, 47.0, 67.0, 138.0, 294.0, 136.0, 71.0, 77.0, 197.0, 407.0, 156.0, 135.0, 130.0, 67.0, 50.0, 96.0, 161.0, 94.0, 347.0, 73.0, 147.0, 111.0, 133.0, 119.0, 149.0, 49.0, 71.0, 328.0, 157.0, 466.0, 115.0, 218.0, 135.0, 187.0, 163.0, 54.0, 287.0, 168.0, 71.0, 55.0, 58.0, 377.0, 260.0, 431.0, 223.0, 225.0, 158.0, 67.0, 268.0, 84.0, -29.0, 472.0, 68.0, 66.0, 420.0, 395.0, 131.0, 79.0, 162.0, 314.0, 66.0, 162.0, 136.0, 244.0, 304.0, 155.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 30.0, 10.0, 17.0, -1.0, 0.0, 10.0, 30.0, 10.0, -2.0, 20.0, 10.0, 0.0, 10.0, 0.0, -5.0, 9.0, -2.0, 30.0, 0.0, 25.0, 260.0, 33.0, 10.0, 10.0, 10.0, 1.0, 8.0, -3.0, 30.0, 17.0, 0.0, 0.0, 20.0, 38.0, 20.0, 38.0, 19.0, 9.0, -2.0, 10.0, 30.0, 37.0, 17.0, -8.0, 8.0, 10.0, 24.0, 0.0, 8.0, 0.0, -5.0, 10.0, 20.0, 9.0, 20.0, 6.0, 8.0, 18.0, 8.0, 260.0, -8.0, -2.0, 10.0, -1.0, -3.0, 44.0, 10.0, 0.0, 30.0, -7.0, 0.0, 30.0, 8.0, -1.0, 30.0, -4.0, -3.0, 20.0, 0.0, 18.0, 0.0, -1.0, -2.0, 30.0, 19.0, -4.0, -18.0, 30.0, -22.0, 10.0, -14.0, 1.0, 10.0, 7.0, 26.0, -2.0, 13.0, 26.0, 19.0, 22.0, -3.0, 40.0, 0.0, 8.0, 10.0, 50.0, 30.0, -7.0, 10.0, 40.0, 30.0, 30.0, 20.0, 0.0, -3.0, 19.0, 40.0, 10.0, 20.0, 3.0, 7.0, -2.0, 3.0, 0.0, 20.0, 0.0, 19.0, 10.0, 30.0, 4.0, 15.0, 20.0, -2.0, 0.0, 6.0, 10.0, -3.0, 0.0, 10.0, 30.0, 50.0, 27.0, 0.0, 20.0, -5.0, 10.0, -2.0, 15.0, 29.0, 70.0, 10.0, 270.0, 7.0, 20.0, 1.0, -12.0, -23.0, -22.0, 6.0, 20.0, 66.0, 19.0, -1.0, 470.0, -64.0, 20.0, 48.0, 13.0, 15.0, 20.0, -22.0, 15.0, 0.0, 20.0, -22.0, 18.0, 30.0, 6.0, 17.0, 260.0, 0.0, -7.0, 16.0, 40.0, 0.0, 0.0, 30.0, -45.0, 30.0, 20.0, 0.0, 18.0, 0.0, 20.0, 20.0, 29.0, 5.0, 0.0, 40.0, 40.0, 50.0, 5.0, 24.0, 18.0, 20.0, 10.0, -1.0, 0.0, 10.0, 10.0, 15.0, 10.0, -6.0, 150.0, 15.0, -13.0, 4.0, -26.0, 145.0, 30.0, 50.0, 10.0, 20.0, 9.0, -77.0, 0.0, 10.0, 21.0, -2.0, -6.0, 17.0, 20.0, 20.0, 19.0, 26.0, 19.0, 20.0, 28.0, 7.0, 30.0, 20.0, -18.0, 9.0, 8.0, 10.0, 100.0, -3.0, 16.0, 10.0, -20.0, 20.0, 18.0, 10.0, 19.0, -9.0, -14.0, -25.0, 12.0, 20.0, 10.0, 6.0, -5.0, 4.0, -75.0, 17.0, 8.0, 27.0, 0.0, 8.0, 0.0, 16.0, 10.0, 0.0, 40.0, 27.0, -4.0, 20.0, 10.0, 20.0, -10.0, 0.0, 0.0, 13.0, -31.0, -57.0, 20.0, 565.0, 27.0, 6.0, 10.0, 10.0, 0.0, -4.0, 20.0, -7.0, 40.0, -2.0, -1.0, 0.0, 20.0, 10.0, 0.0, 6.0, 0.0, -5.0, 29.0, 30.0, 20.0, 50.0, 20.0, 17.0, 16.0, 7.0, -6.0, -9.0, 10.0, 10.0, -3.0, -3.0, 25.0, 14.0, 6.0, 11.0, -6.0, -7.0, 30.0, 12.0, -9.0, -1.0, 30.0, 10.0, 6.0, 0.0, -17.0, 17.0, 0.0, 10.0, -6.0, 10.0, -14.0, -80.0, 10.0, 18.0, -3.0, -10.0, 30.0, 20.0, 0.0, 250.0, 0.0, 2.0, 20.0, 40.0, 19.0, 0.0, -36.0, 0.0, 50.0, -48.0, 0.0, 3.0, 40.0, 24.0, -4.0, 0.0, 16.0, -2.0, 1.0, -11.0, -2.0, 0.0, 2.0, 34.0, 20.0, 37.0, 9.0, 9.0, 20.0, 9.0, 40.0, 0.0, 30.0, 150.0, 10.0, -1.0, -10.0, 26.0, 29.0, 20.0, 30.0, 28.0, 14.0, -2.0, -4.0, 6.0, 23.0, 1.0, 50.0, -10.0, 14.0, 10.0, 10.0, -5.0, 10.0, 13.0, -33.0, 35.0, 7.0, 10.0, 10.0, 20.0, 10.0, 0.0, 3.0, 9.0, 14.0, -5.0, 0.0, 16.0, 29.0, 9.0, 29.0, 17.0, 15.0, 40.0, 0.0, 50.0, 0.0, 8.0, 38.0, -2.0, 0.0, 460.0, 26.0, 17.0, -92.0, 10.0, -80.0, 30.0, 20.0, 9.0, 29.0, 19.0, 16.0, 6.0, 7.0, 10.0, 30.0, 10.0, -6.0, 10.0, -11.0, 10.0, 26.0, 20.0, 50.0, 19.0, 20.0, -3.0, 20.0, 8.0, 40.0, 0.0, 39.0, 3.0, 0.0, 0.0, 0.0, 20.0, -9.0, 20.0, 0.0, 40.0, 5.0, -6.0, 4.0, 15.0, -10.0, 8.0, -1.0, -6.0, -2.0, 10.0, 10.0, 19.0, 30.0, -10.0, 0.0, 0.0, -2.0, 5.0, 10.0, 6.0, 20.0, 20.0, -3.0, 0.0, 30.0, 10.0, 20.0, 8.0, 0.0, 58.0, 20.0, 10.0, 37.0, -5.0, 3.0, 10.0, 30.0, 0.0, 17.0, -6.0, 10.0, -13.0, 0.0, 16.0, 40.0, 0.0, 18.0, 50.0, 70.0, 18.0, 40.0, 70.0, -5.0, 60.0, 26.0, 0.0, -11.0, -1.0, 5.0, 10.0, 30.0, -8.0, -6.0, 10.0, 40.0, 4.0, 30.0, 30.0, 50.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, -13.0, 1.0, 0.0, 25.0, 16.0, 3.0, 11.0, 5.0, 23.0, 10.0, 17.0, 39.0, -4.0, 20.0, 10.0, 20.0, -2.0, 0.0, -6.0, 50.0, 6.0, 9.0, 56.0, -16.0, 20.0, 15.0, -9.0, 20.0, -3.0, 7.0, 20.0, 0.0, 9.0, 18.0, 6.0, 10.0, -4.0, 21.0, 40.0, 3.0, 46.0, 20.0, 13.0, 0.0, 1.0, -2.0, 8.0, -6.0, 40.0, -34.0, 9.0, 10.0, 0.0, -3.0, -5.0, 17.0, 25.0, 17.0, -13.0, 26.0, -3.0, 30.0, 40.0, 28.0, 50.0, 166.0, 40.0, -51.0, -32.0, 27.0, 30.0, 17.0, 24.0, -5.0, 0.0, -6.0, 30.0, 60.0, 0.0, 18.0, 19.0, 40.0, 40.0, 20.0, 20.0, 20.0, 250.0, 9.0, 30.0, 27.0, 10.0, 20.0, -3.0, 10.0, 7.0, 10.0, -35.0, 7.0, 20.0, 34.0, 45.0, 30.0, 30.0, 1.0, -4.0, 7.0, 17.0, 39.0, 40.0, 10.0, 48.0, 8.0, 14.0, 30.0, 7.0, 35.0, 10.0, 18.0, 7.0, 20.0, -14.0, 24.0, -5.0, 0.0, 40.0, 29.0, 20.0, 25.0, 9.0, 29.0, 16.0, 48.0, -1.0, 20.0, 10.0, 18.0, 10.0, 39.0, 20.0, 0.0, -1.0, 30.0, -1.0, 15.0, 0.0, -15.0, 5.0, 0.0, -4.0, 15.0, 9.0, 9.0, 30.0, 0.0, 10.0, 170.0, 5.0, 27.0, 0.0, 16.0, 20.0, 29.0, 50.0, 20.0, 3.0, 30.0, 6.0, 10.0, 8.0, 15.0, -3.0, -3.0, -20.0, 50.0, 10.0, 10.0, 1.0, 27.0, -9.0, -43.0, 48.0, 17.0, 0.0, -8.0, 16.0, 5.0, 4.0, 10.0, 14.0, 0.0, -3.0, -10.0, 20.0, -13.0, 15.0, 30.0, 14.0, -17.0, 19.0, 19.0, -19.0, -1.0, 5.0, 30.0, 53.0, -1.0, 17.0, -6.0, 0.0, 20.0, 260.0, 0.0, 27.0, 70.0, 10.0, 70.0, -1.0, 28.0, 0.0, 39.0, 17.0, 9.0, 25.0, 30.0, 160.0, 13.0, 170.0, 28.0, -11.0, -3.0, 10.0, 0.0, 5.0, -81.0, 4.0, 253.0, -1.0, -1.0, 20.0, 27.0, -3.0, 10.0, 145.0, 0.0, -4.0, 18.0, 20.0, 20.0, 15.0, -9.0, 10.0, 3.0, 160.0, 16.0, 10.0, -2.0, 39.0, -12.0, 4.0, 1.0, -61.0, 0.0, 18.0, 15.0, -4.0, 18.0, -4.0, 8.0, 1.0, 1.0, 14.0, 40.0, 47.0, 70.0, 16.0, 2.0, -3.0, -2.0, 62.0, 37.0, -1.0, 0.0, -5.0, 10.0, 8.0, 10.0, 4.0, 20.0, 7.0, 30.0, 0.0, 21.0, -1.0, -12.0, 0.0, -13.0, 10.0, 0.0, -13.0, -11.0, -10.0, -12.0, -38.0, 19.0, 36.0, 480.0, -2.0, 25.0, -14.0, 10.0, -32.0, 40.0, -12.0, 0.0, -3.0, -5.0, 22.0, 30.0, 10.0, -9.0, -5.0, -7.0, 50.0, 9.0, -2.0, 10.0, -5.0, -13.0, 10.0, 18.0, -4.0, 40.0, -2.0, 8.0, 50.0, -10.0, 10.0, 300.0, 0.0, 20.0, 4.0, 28.0, 8.0, 20.0, -12.0, 1.0, 5.0, 20.0, 16.0, 50.0, 259.0, -3.0, 30.0, 20.0, 10.0, -2.0, 70.0, -2.0, 0.0, 10.0, -2.0, 10.0, 19.0, -7.0, 11.0, -57.0, -12.0, -2.0, 37.0, 50.0, 30.0, 40.0, 39.0, 8.0, 10.0, 10.0, -4.0, 20.0, 10.0, 20.0, 9.0, 4.0, 31.0, 20.0, 20.0, 30.0, 18.0, -7.0, 8.0, 160.0, 30.0, 7.0, 21.0, 30.0, -1.0, -7.0, 10.0, 20.0, -10.0, -24.0, 20.0, 0.0, 3.0, 36.0, 14.0, 30.0, 10.0, 21.0, -9.0, 60.0, -3.0, 10.0, 20.0, 6.0, 16.0, 0.0, 30.0, 18.0, 0.0, 26.0, 10.0, 50.0, 50.0, 18.0, 50.0, 20.0, 0.0, 20.0, 20.0, 16.0, 0.0, 20.0, 20.0, 26.0, 8.0, 16.0, 160.0, 40.0, -46.0, 50.0, 10.0, 7.0, -9.0, 19.0, 7.0, 29.0, 20.0, 16.0, 19.0, 20.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9389579688710428, "mean_inference_ms": 3.4722661812869817, "mean_action_processing_ms": 1.0470136596981938, "mean_env_wait_ms": 2.3548108030113037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07576227188110352, "StateBufferConnector_ms": 0.01146554946899414, "ViewRequirementAgentConnector_ms": 0.5699095726013184}, "num_episodes": 18, "episode_return_max": 606.0, "episode_return_min": -29.0, "episode_return_mean": 171.58, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.60527946820057, "num_env_steps_trained_throughput_per_sec": 32.60527946820057, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 123220.08, "restore_workers_time_ms": 0.012, "training_step_time_ms": 123220.03, "sample_time_ms": 3353.419, "learn_time_ms": 119843.856, "learn_throughput": 33.377, "synch_weights_time_ms": 13.828}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 23, "trial_id": "6085c_00000", "date": "2024-07-01_23-45-07", "timestamp": 1719891907, "time_this_iter_s": 122.69183397293091, "time_total_s": 4755.201515674591, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2338700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4755.201515674591, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.329885057471262, "ram_util_percent": 79.74195402298852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9660704992957516, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.369811164482206, "policy_loss": -0.004930671916890759, "vf_loss": 4.373684972619858, "vf_explained_var": 0.0036340144432136933, "kl": 0.010568597121916802, "entropy": 1.9158557989345952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 220665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 739.0, "episode_reward_min": -29.0, "episode_reward_mean": 181.09, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 565.0}, "policy_reward_mean": {"policy_0": 18.109}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.0, 533.0, 66.0, 160.0, 59.0, 75.0, 60.0, 221.0, 47.0, 67.0, 138.0, 294.0, 136.0, 71.0, 77.0, 197.0, 407.0, 156.0, 135.0, 130.0, 67.0, 50.0, 96.0, 161.0, 94.0, 347.0, 73.0, 147.0, 111.0, 133.0, 119.0, 149.0, 49.0, 71.0, 328.0, 157.0, 466.0, 115.0, 218.0, 135.0, 187.0, 163.0, 54.0, 287.0, 168.0, 71.0, 55.0, 58.0, 377.0, 260.0, 431.0, 223.0, 225.0, 158.0, 67.0, 268.0, 84.0, -29.0, 472.0, 68.0, 66.0, 420.0, 395.0, 131.0, 79.0, 162.0, 314.0, 66.0, 162.0, 136.0, 244.0, 304.0, 155.0, 127.0, 248.0, 41.0, 11.0, 186.0, 369.0, 376.0, 156.0, 739.0, 15.0, 127.0, 174.0, 318.0, 269.0, 207.0, 198.0, 115.0, 190.0, 376.0, 402.0, 105.0, 91.0, 58.0, 198.0, 249.0, 71.0, 158.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 16.0, 10.0, 0.0, 40.0, 27.0, -4.0, 20.0, 10.0, 20.0, -10.0, 0.0, 0.0, 13.0, -31.0, -57.0, 20.0, 565.0, 27.0, 6.0, 10.0, 10.0, 0.0, -4.0, 20.0, -7.0, 40.0, -2.0, -1.0, 0.0, 20.0, 10.0, 0.0, 6.0, 0.0, -5.0, 29.0, 30.0, 20.0, 50.0, 20.0, 17.0, 16.0, 7.0, -6.0, -9.0, 10.0, 10.0, -3.0, -3.0, 25.0, 14.0, 6.0, 11.0, -6.0, -7.0, 30.0, 12.0, -9.0, -1.0, 30.0, 10.0, 6.0, 0.0, -17.0, 17.0, 0.0, 10.0, -6.0, 10.0, -14.0, -80.0, 10.0, 18.0, -3.0, -10.0, 30.0, 20.0, 0.0, 250.0, 0.0, 2.0, 20.0, 40.0, 19.0, 0.0, -36.0, 0.0, 50.0, -48.0, 0.0, 3.0, 40.0, 24.0, -4.0, 0.0, 16.0, -2.0, 1.0, -11.0, -2.0, 0.0, 2.0, 34.0, 20.0, 37.0, 9.0, 9.0, 20.0, 9.0, 40.0, 0.0, 30.0, 150.0, 10.0, -1.0, -10.0, 26.0, 29.0, 20.0, 30.0, 28.0, 14.0, -2.0, -4.0, 6.0, 23.0, 1.0, 50.0, -10.0, 14.0, 10.0, 10.0, -5.0, 10.0, 13.0, -33.0, 35.0, 7.0, 10.0, 10.0, 20.0, 10.0, 0.0, 3.0, 9.0, 14.0, -5.0, 0.0, 16.0, 29.0, 9.0, 29.0, 17.0, 15.0, 40.0, 0.0, 50.0, 0.0, 8.0, 38.0, -2.0, 0.0, 460.0, 26.0, 17.0, -92.0, 10.0, -80.0, 30.0, 20.0, 9.0, 29.0, 19.0, 16.0, 6.0, 7.0, 10.0, 30.0, 10.0, -6.0, 10.0, -11.0, 10.0, 26.0, 20.0, 50.0, 19.0, 20.0, -3.0, 20.0, 8.0, 40.0, 0.0, 39.0, 3.0, 0.0, 0.0, 0.0, 20.0, -9.0, 20.0, 0.0, 40.0, 5.0, -6.0, 4.0, 15.0, -10.0, 8.0, -1.0, -6.0, -2.0, 10.0, 10.0, 19.0, 30.0, -10.0, 0.0, 0.0, -2.0, 5.0, 10.0, 6.0, 20.0, 20.0, -3.0, 0.0, 30.0, 10.0, 20.0, 8.0, 0.0, 58.0, 20.0, 10.0, 37.0, -5.0, 3.0, 10.0, 30.0, 0.0, 17.0, -6.0, 10.0, -13.0, 0.0, 16.0, 40.0, 0.0, 18.0, 50.0, 70.0, 18.0, 40.0, 70.0, -5.0, 60.0, 26.0, 0.0, -11.0, -1.0, 5.0, 10.0, 30.0, -8.0, -6.0, 10.0, 40.0, 4.0, 30.0, 30.0, 50.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, -13.0, 1.0, 0.0, 25.0, 16.0, 3.0, 11.0, 5.0, 23.0, 10.0, 17.0, 39.0, -4.0, 20.0, 10.0, 20.0, -2.0, 0.0, -6.0, 50.0, 6.0, 9.0, 56.0, -16.0, 20.0, 15.0, -9.0, 20.0, -3.0, 7.0, 20.0, 0.0, 9.0, 18.0, 6.0, 10.0, -4.0, 21.0, 40.0, 3.0, 46.0, 20.0, 13.0, 0.0, 1.0, -2.0, 8.0, -6.0, 40.0, -34.0, 9.0, 10.0, 0.0, -3.0, -5.0, 17.0, 25.0, 17.0, -13.0, 26.0, -3.0, 30.0, 40.0, 28.0, 50.0, 166.0, 40.0, -51.0, -32.0, 27.0, 30.0, 17.0, 24.0, -5.0, 0.0, -6.0, 30.0, 60.0, 0.0, 18.0, 19.0, 40.0, 40.0, 20.0, 20.0, 20.0, 250.0, 9.0, 30.0, 27.0, 10.0, 20.0, -3.0, 10.0, 7.0, 10.0, -35.0, 7.0, 20.0, 34.0, 45.0, 30.0, 30.0, 1.0, -4.0, 7.0, 17.0, 39.0, 40.0, 10.0, 48.0, 8.0, 14.0, 30.0, 7.0, 35.0, 10.0, 18.0, 7.0, 20.0, -14.0, 24.0, -5.0, 0.0, 40.0, 29.0, 20.0, 25.0, 9.0, 29.0, 16.0, 48.0, -1.0, 20.0, 10.0, 18.0, 10.0, 39.0, 20.0, 0.0, -1.0, 30.0, -1.0, 15.0, 0.0, -15.0, 5.0, 0.0, -4.0, 15.0, 9.0, 9.0, 30.0, 0.0, 10.0, 170.0, 5.0, 27.0, 0.0, 16.0, 20.0, 29.0, 50.0, 20.0, 3.0, 30.0, 6.0, 10.0, 8.0, 15.0, -3.0, -3.0, -20.0, 50.0, 10.0, 10.0, 1.0, 27.0, -9.0, -43.0, 48.0, 17.0, 0.0, -8.0, 16.0, 5.0, 4.0, 10.0, 14.0, 0.0, -3.0, -10.0, 20.0, -13.0, 15.0, 30.0, 14.0, -17.0, 19.0, 19.0, -19.0, -1.0, 5.0, 30.0, 53.0, -1.0, 17.0, -6.0, 0.0, 20.0, 260.0, 0.0, 27.0, 70.0, 10.0, 70.0, -1.0, 28.0, 0.0, 39.0, 17.0, 9.0, 25.0, 30.0, 160.0, 13.0, 170.0, 28.0, -11.0, -3.0, 10.0, 0.0, 5.0, -81.0, 4.0, 253.0, -1.0, -1.0, 20.0, 27.0, -3.0, 10.0, 145.0, 0.0, -4.0, 18.0, 20.0, 20.0, 15.0, -9.0, 10.0, 3.0, 160.0, 16.0, 10.0, -2.0, 39.0, -12.0, 4.0, 1.0, -61.0, 0.0, 18.0, 15.0, -4.0, 18.0, -4.0, 8.0, 1.0, 1.0, 14.0, 40.0, 47.0, 70.0, 16.0, 2.0, -3.0, -2.0, 62.0, 37.0, -1.0, 0.0, -5.0, 10.0, 8.0, 10.0, 4.0, 20.0, 7.0, 30.0, 0.0, 21.0, -1.0, -12.0, 0.0, -13.0, 10.0, 0.0, -13.0, -11.0, -10.0, -12.0, -38.0, 19.0, 36.0, 480.0, -2.0, 25.0, -14.0, 10.0, -32.0, 40.0, -12.0, 0.0, -3.0, -5.0, 22.0, 30.0, 10.0, -9.0, -5.0, -7.0, 50.0, 9.0, -2.0, 10.0, -5.0, -13.0, 10.0, 18.0, -4.0, 40.0, -2.0, 8.0, 50.0, -10.0, 10.0, 300.0, 0.0, 20.0, 4.0, 28.0, 8.0, 20.0, -12.0, 1.0, 5.0, 20.0, 16.0, 50.0, 259.0, -3.0, 30.0, 20.0, 10.0, -2.0, 70.0, -2.0, 0.0, 10.0, -2.0, 10.0, 19.0, -7.0, 11.0, -57.0, -12.0, -2.0, 37.0, 50.0, 30.0, 40.0, 39.0, 8.0, 10.0, 10.0, -4.0, 20.0, 10.0, 20.0, 9.0, 4.0, 31.0, 20.0, 20.0, 30.0, 18.0, -7.0, 8.0, 160.0, 30.0, 7.0, 21.0, 30.0, -1.0, -7.0, 10.0, 20.0, -10.0, -24.0, 20.0, 0.0, 3.0, 36.0, 14.0, 30.0, 10.0, 21.0, -9.0, 60.0, -3.0, 10.0, 20.0, 6.0, 16.0, 0.0, 30.0, 18.0, 0.0, 26.0, 10.0, 50.0, 50.0, 18.0, 50.0, 20.0, 0.0, 20.0, 20.0, 16.0, 0.0, 20.0, 20.0, 26.0, 8.0, 16.0, 160.0, 40.0, -46.0, 50.0, 10.0, 7.0, -9.0, 19.0, 7.0, 29.0, 20.0, 16.0, 19.0, 20.0, 27.0, 31.0, -1.0, -14.0, 30.0, 30.0, 25.0, -5.0, -5.0, -4.0, 40.0, 30.0, -1.0, 9.0, -6.0, 0.0, 26.0, 0.0, 10.0, 30.0, 150.0, -11.0, -4.0, 3.0, 20.0, 42.0, 47.0, 0.0, -7.0, -24.0, -25.0, 20.0, -3.0, 0.0, -10.0, -14.0, 0.0, 3.0, 0.0, 5.0, 10.0, -1.0, -2.0, 110.0, -30.0, 28.0, 8.0, 31.0, -9.0, 25.0, 26.0, -10.0, 30.0, 9.0, 9.0, 50.0, 29.0, 16.0, 49.0, 17.0, 170.0, 0.0, 5.0, 68.0, 150.0, 7.0, 20.0, 10.0, 29.0, 70.0, 17.0, 26.0, 38.0, 0.0, 10.0, 20.0, 19.0, 27.0, 19.0, -1.0, -2.0, 30.0, 6.0, 456.0, -10.0, 10.0, 0.0, 28.0, 170.0, 29.0, 20.0, -5.0, -9.0, 30.0, 0.0, -5.0, 0.0, -4.0, 8.0, 7.0, -7.0, 10.0, 30.0, -5.0, -4.0, 0.0, 36.0, 20.0, 15.0, -5.0, 30.0, 10.0, 10.0, -1.0, 7.0, 9.0, 10.0, -40.0, -1.0, 160.0, 10.0, 24.0, 19.0, -3.0, -40.0, 4.0, 20.0, 8.0, -12.0, 270.0, 28.0, 18.0, 35.0, 19.0, 10.0, 150.0, -1.0, 7.0, 24.0, 0.0, 7.0, 40.0, 9.0, 40.0, 10.0, 20.0, 65.0, 24.0, 3.0, 7.0, -11.0, 30.0, 10.0, 60.0, 30.0, 0.0, -1.0, 20.0, 30.0, 10.0, 9.0, 50.0, -1.0, -18.0, 20.0, 16.0, 10.0, 40.0, 10.0, -21.0, 9.0, 10.0, 10.0, 12.0, 40.0, 29.0, 20.0, -2.0, 5.0, 16.0, 50.0, -15.0, -25.0, -25.0, 20.0, 19.0, -9.0, -9.0, 160.0, 360.0, -100.0, 180.0, 50.0, 250.0, -30.0, -14.0, 20.0, -30.0, 38.0, -20.0, -42.0, 16.0, -3.0, -13.0, -3.0, 0.0, 30.0, 20.0, 30.0, 8.0, 20.0, 9.0, 20.0, -1.0, -4.0, 0.0, -2.0, 19.0, 20.0, 30.0, 0.0, 20.0, -11.0, 10.0, 20.0, -1.0, 9.0, -7.0, 9.0, -1.0, 10.0, 10.0, 50.0, 30.0, 10.0, 14.0, 30.0, 10.0, 0.0, 20.0, 24.0, -6.0, 1.0, 30.0, 18.0, 11.0, 18.0, 47.0, 90.0, 30.0, 10.0, -5.0, 1.0, -5.0, 20.0, 20.0, -3.0, -14.0, 50.0, -12.0, 19.0, 19.0, 30.0, 40.0, 0.0, 10.0, 19.0, 0.0, 10.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.887150402706524, "mean_inference_ms": 3.3863561721780133, "mean_action_processing_ms": 1.0430944169690133, "mean_env_wait_ms": 2.298736407930276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07280492782592773, "StateBufferConnector_ms": 0.010909318923950195, "ViewRequirementAgentConnector_ms": 0.4928584098815918}, "num_episodes": 27, "episode_return_max": 739.0, "episode_return_min": -29.0, "episode_return_mean": 181.09, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.84455141181085, "num_env_steps_trained_throughput_per_sec": 32.84455141181085, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 122990.439, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122990.385, "sample_time_ms": 3285.667, "learn_time_ms": 119681.297, "learn_throughput": 33.422, "synch_weights_time_ms": 13.524}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 24, "trial_id": "6085c_00000", "date": "2024-07-01_23-47-09", "timestamp": 1719892029, "time_this_iter_s": 121.79699492454529, "time_total_s": 4876.998510599136, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x1380099d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4876.998510599136, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 21.973837209302324, "ram_util_percent": 80.12558139534885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.741310543424913, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.627452190590108, "policy_loss": -0.005662928551189498, "vf_loss": 4.6319588261036575, "vf_explained_var": 0.007591343814699541, "kl": 0.011562886652987917, "entropy": 1.8849271078587087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 230055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 739.0, "episode_reward_min": -29.0, "episode_reward_mean": 187.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -113.0}, "policy_reward_max": {"policy_0": 480.0}, "policy_reward_mean": {"policy_0": 18.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.0, 130.0, 67.0, 50.0, 96.0, 161.0, 94.0, 347.0, 73.0, 147.0, 111.0, 133.0, 119.0, 149.0, 49.0, 71.0, 328.0, 157.0, 466.0, 115.0, 218.0, 135.0, 187.0, 163.0, 54.0, 287.0, 168.0, 71.0, 55.0, 58.0, 377.0, 260.0, 431.0, 223.0, 225.0, 158.0, 67.0, 268.0, 84.0, -29.0, 472.0, 68.0, 66.0, 420.0, 395.0, 131.0, 79.0, 162.0, 314.0, 66.0, 162.0, 136.0, 244.0, 304.0, 155.0, 127.0, 248.0, 41.0, 11.0, 186.0, 369.0, 376.0, 156.0, 739.0, 15.0, 127.0, 174.0, 318.0, 269.0, 207.0, 198.0, 115.0, 190.0, 376.0, 402.0, 105.0, 91.0, 58.0, 198.0, 249.0, 71.0, 158.0, 197.0, 135.0, 111.0, 358.0, 109.0, 318.0, 173.0, 176.0, 93.0, 185.0, 194.0, 152.0, 65.0, 171.0, 260.0, 352.0, 198.0, 262.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-6.0, 10.0, -11.0, 10.0, 26.0, 20.0, 50.0, 19.0, 20.0, -3.0, 20.0, 8.0, 40.0, 0.0, 39.0, 3.0, 0.0, 0.0, 0.0, 20.0, -9.0, 20.0, 0.0, 40.0, 5.0, -6.0, 4.0, 15.0, -10.0, 8.0, -1.0, -6.0, -2.0, 10.0, 10.0, 19.0, 30.0, -10.0, 0.0, 0.0, -2.0, 5.0, 10.0, 6.0, 20.0, 20.0, -3.0, 0.0, 30.0, 10.0, 20.0, 8.0, 0.0, 58.0, 20.0, 10.0, 37.0, -5.0, 3.0, 10.0, 30.0, 0.0, 17.0, -6.0, 10.0, -13.0, 0.0, 16.0, 40.0, 0.0, 18.0, 50.0, 70.0, 18.0, 40.0, 70.0, -5.0, 60.0, 26.0, 0.0, -11.0, -1.0, 5.0, 10.0, 30.0, -8.0, -6.0, 10.0, 40.0, 4.0, 30.0, 30.0, 50.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, -13.0, 1.0, 0.0, 25.0, 16.0, 3.0, 11.0, 5.0, 23.0, 10.0, 17.0, 39.0, -4.0, 20.0, 10.0, 20.0, -2.0, 0.0, -6.0, 50.0, 6.0, 9.0, 56.0, -16.0, 20.0, 15.0, -9.0, 20.0, -3.0, 7.0, 20.0, 0.0, 9.0, 18.0, 6.0, 10.0, -4.0, 21.0, 40.0, 3.0, 46.0, 20.0, 13.0, 0.0, 1.0, -2.0, 8.0, -6.0, 40.0, -34.0, 9.0, 10.0, 0.0, -3.0, -5.0, 17.0, 25.0, 17.0, -13.0, 26.0, -3.0, 30.0, 40.0, 28.0, 50.0, 166.0, 40.0, -51.0, -32.0, 27.0, 30.0, 17.0, 24.0, -5.0, 0.0, -6.0, 30.0, 60.0, 0.0, 18.0, 19.0, 40.0, 40.0, 20.0, 20.0, 20.0, 250.0, 9.0, 30.0, 27.0, 10.0, 20.0, -3.0, 10.0, 7.0, 10.0, -35.0, 7.0, 20.0, 34.0, 45.0, 30.0, 30.0, 1.0, -4.0, 7.0, 17.0, 39.0, 40.0, 10.0, 48.0, 8.0, 14.0, 30.0, 7.0, 35.0, 10.0, 18.0, 7.0, 20.0, -14.0, 24.0, -5.0, 0.0, 40.0, 29.0, 20.0, 25.0, 9.0, 29.0, 16.0, 48.0, -1.0, 20.0, 10.0, 18.0, 10.0, 39.0, 20.0, 0.0, -1.0, 30.0, -1.0, 15.0, 0.0, -15.0, 5.0, 0.0, -4.0, 15.0, 9.0, 9.0, 30.0, 0.0, 10.0, 170.0, 5.0, 27.0, 0.0, 16.0, 20.0, 29.0, 50.0, 20.0, 3.0, 30.0, 6.0, 10.0, 8.0, 15.0, -3.0, -3.0, -20.0, 50.0, 10.0, 10.0, 1.0, 27.0, -9.0, -43.0, 48.0, 17.0, 0.0, -8.0, 16.0, 5.0, 4.0, 10.0, 14.0, 0.0, -3.0, -10.0, 20.0, -13.0, 15.0, 30.0, 14.0, -17.0, 19.0, 19.0, -19.0, -1.0, 5.0, 30.0, 53.0, -1.0, 17.0, -6.0, 0.0, 20.0, 260.0, 0.0, 27.0, 70.0, 10.0, 70.0, -1.0, 28.0, 0.0, 39.0, 17.0, 9.0, 25.0, 30.0, 160.0, 13.0, 170.0, 28.0, -11.0, -3.0, 10.0, 0.0, 5.0, -81.0, 4.0, 253.0, -1.0, -1.0, 20.0, 27.0, -3.0, 10.0, 145.0, 0.0, -4.0, 18.0, 20.0, 20.0, 15.0, -9.0, 10.0, 3.0, 160.0, 16.0, 10.0, -2.0, 39.0, -12.0, 4.0, 1.0, -61.0, 0.0, 18.0, 15.0, -4.0, 18.0, -4.0, 8.0, 1.0, 1.0, 14.0, 40.0, 47.0, 70.0, 16.0, 2.0, -3.0, -2.0, 62.0, 37.0, -1.0, 0.0, -5.0, 10.0, 8.0, 10.0, 4.0, 20.0, 7.0, 30.0, 0.0, 21.0, -1.0, -12.0, 0.0, -13.0, 10.0, 0.0, -13.0, -11.0, -10.0, -12.0, -38.0, 19.0, 36.0, 480.0, -2.0, 25.0, -14.0, 10.0, -32.0, 40.0, -12.0, 0.0, -3.0, -5.0, 22.0, 30.0, 10.0, -9.0, -5.0, -7.0, 50.0, 9.0, -2.0, 10.0, -5.0, -13.0, 10.0, 18.0, -4.0, 40.0, -2.0, 8.0, 50.0, -10.0, 10.0, 300.0, 0.0, 20.0, 4.0, 28.0, 8.0, 20.0, -12.0, 1.0, 5.0, 20.0, 16.0, 50.0, 259.0, -3.0, 30.0, 20.0, 10.0, -2.0, 70.0, -2.0, 0.0, 10.0, -2.0, 10.0, 19.0, -7.0, 11.0, -57.0, -12.0, -2.0, 37.0, 50.0, 30.0, 40.0, 39.0, 8.0, 10.0, 10.0, -4.0, 20.0, 10.0, 20.0, 9.0, 4.0, 31.0, 20.0, 20.0, 30.0, 18.0, -7.0, 8.0, 160.0, 30.0, 7.0, 21.0, 30.0, -1.0, -7.0, 10.0, 20.0, -10.0, -24.0, 20.0, 0.0, 3.0, 36.0, 14.0, 30.0, 10.0, 21.0, -9.0, 60.0, -3.0, 10.0, 20.0, 6.0, 16.0, 0.0, 30.0, 18.0, 0.0, 26.0, 10.0, 50.0, 50.0, 18.0, 50.0, 20.0, 0.0, 20.0, 20.0, 16.0, 0.0, 20.0, 20.0, 26.0, 8.0, 16.0, 160.0, 40.0, -46.0, 50.0, 10.0, 7.0, -9.0, 19.0, 7.0, 29.0, 20.0, 16.0, 19.0, 20.0, 27.0, 31.0, -1.0, -14.0, 30.0, 30.0, 25.0, -5.0, -5.0, -4.0, 40.0, 30.0, -1.0, 9.0, -6.0, 0.0, 26.0, 0.0, 10.0, 30.0, 150.0, -11.0, -4.0, 3.0, 20.0, 42.0, 47.0, 0.0, -7.0, -24.0, -25.0, 20.0, -3.0, 0.0, -10.0, -14.0, 0.0, 3.0, 0.0, 5.0, 10.0, -1.0, -2.0, 110.0, -30.0, 28.0, 8.0, 31.0, -9.0, 25.0, 26.0, -10.0, 30.0, 9.0, 9.0, 50.0, 29.0, 16.0, 49.0, 17.0, 170.0, 0.0, 5.0, 68.0, 150.0, 7.0, 20.0, 10.0, 29.0, 70.0, 17.0, 26.0, 38.0, 0.0, 10.0, 20.0, 19.0, 27.0, 19.0, -1.0, -2.0, 30.0, 6.0, 456.0, -10.0, 10.0, 0.0, 28.0, 170.0, 29.0, 20.0, -5.0, -9.0, 30.0, 0.0, -5.0, 0.0, -4.0, 8.0, 7.0, -7.0, 10.0, 30.0, -5.0, -4.0, 0.0, 36.0, 20.0, 15.0, -5.0, 30.0, 10.0, 10.0, -1.0, 7.0, 9.0, 10.0, -40.0, -1.0, 160.0, 10.0, 24.0, 19.0, -3.0, -40.0, 4.0, 20.0, 8.0, -12.0, 270.0, 28.0, 18.0, 35.0, 19.0, 10.0, 150.0, -1.0, 7.0, 24.0, 0.0, 7.0, 40.0, 9.0, 40.0, 10.0, 20.0, 65.0, 24.0, 3.0, 7.0, -11.0, 30.0, 10.0, 60.0, 30.0, 0.0, -1.0, 20.0, 30.0, 10.0, 9.0, 50.0, -1.0, -18.0, 20.0, 16.0, 10.0, 40.0, 10.0, -21.0, 9.0, 10.0, 10.0, 12.0, 40.0, 29.0, 20.0, -2.0, 5.0, 16.0, 50.0, -15.0, -25.0, -25.0, 20.0, 19.0, -9.0, -9.0, 160.0, 360.0, -100.0, 180.0, 50.0, 250.0, -30.0, -14.0, 20.0, -30.0, 38.0, -20.0, -42.0, 16.0, -3.0, -13.0, -3.0, 0.0, 30.0, 20.0, 30.0, 8.0, 20.0, 9.0, 20.0, -1.0, -4.0, 0.0, -2.0, 19.0, 20.0, 30.0, 0.0, 20.0, -11.0, 10.0, 20.0, -1.0, 9.0, -7.0, 9.0, -1.0, 10.0, 10.0, 50.0, 30.0, 10.0, 14.0, 30.0, 10.0, 0.0, 20.0, 24.0, -6.0, 1.0, 30.0, 18.0, 11.0, 18.0, 47.0, 90.0, 30.0, 10.0, -5.0, 1.0, -5.0, 20.0, 20.0, -3.0, -14.0, 50.0, -12.0, 19.0, 19.0, 30.0, 40.0, 0.0, 10.0, 19.0, 0.0, 10.0, 0.0, 30.0, 20.0, 19.0, 40.0, 24.0, 7.0, -5.0, 20.0, 20.0, 40.0, 12.0, 10.0, 50.0, 14.0, 10.0, 24.0, 5.0, 0.0, 0.0, 0.0, 22.0, -4.0, 10.0, 10.0, 24.0, -3.0, 0.0, 17.0, 3.0, 24.0, 30.0, 23.0, -8.0, 0.0, 19.0, 20.0, 200.0, 8.0, 7.0, 60.0, 29.0, -1.0, 10.0, -6.0, 33.0, 9.0, 12.0, 22.0, 32.0, 14.0, -16.0, 7.0, 10.0, 40.0, 141.0, 8.0, 40.0, -1.0, 25.0, -2.0, 50.0, 13.0, 10.0, 20.0, 16.0, 17.0, 18.0, -10.0, 60.0, 34.0, -5.0, 21.0, -41.0, -13.0, 250.0, 6.0, -113.0, 9.0, 18.0, 19.0, 20.0, 5.0, 0.0, 20.0, -5.0, 18.0, 20.0, 10.0, -5.0, 10.0, 20.0, -5.0, 10.0, 13.0, 50.0, 46.0, 19.0, 50.0, -1.0, -5.0, 8.0, 8.0, 8.0, 20.0, 39.0, 28.0, -3.0, 39.0, 15.0, 20.0, 20.0, 45.0, 0.0, 40.0, 10.0, 20.0, 20.0, 0.0, 10.0, 7.0, 0.0, 13.0, 30.0, -6.0, -2.0, 29.0, -14.0, 20.0, 14.0, -15.0, -4.0, 50.0, 10.0, 10.0, 50.0, 20.0, 18.0, 0.0, 8.0, -3.0, 8.0, -107.0, 10.0, 150.0, 10.0, -5.0, 34.0, 15.0, -50.0, 13.0, 190.0, 24.0, 30.0, 30.0, 30.0, 2.0, -5.0, 17.0, 24.0, 170.0, 30.0, -46.0, 28.0, 5.0, -16.0, 90.0, 17.0, 150.0, -10.0, -11.0, -9.0, 23.0, 17.0, 30.0, -5.0, -34.0, 17.0, -6.0, 20.0, 40.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.834383736659263, "mean_inference_ms": 3.3221372252973866, "mean_action_processing_ms": 1.0408662835423024, "mean_env_wait_ms": 2.2587043092021313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06522512435913086, "StateBufferConnector_ms": 0.01044154167175293, "ViewRequirementAgentConnector_ms": 0.47354936599731445}, "num_episodes": 18, "episode_return_max": 739.0, "episode_return_min": -29.0, "episode_return_mean": 187.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.67256846877791, "num_env_steps_trained_throughput_per_sec": 32.67256846877791, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 122816.119, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122816.067, "sample_time_ms": 3199.928, "learn_time_ms": 119590.785, "learn_throughput": 33.447, "synch_weights_time_ms": 14.735}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 25, "trial_id": "6085c_00000", "date": "2024-07-01_23-49-11", "timestamp": 1719892151, "time_this_iter_s": 122.44419574737549, "time_total_s": 4999.442706346512, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e5700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4999.442706346512, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 27.743930635838154, "ram_util_percent": 80.278612716763}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6298368457407237, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3240292784504994, "policy_loss": -0.004616164461537477, "vf_loss": 5.327681421725767, "vf_explained_var": 0.01229968086853068, "kl": 0.009640145093664638, "entropy": 1.8877886838171556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 239445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 739.0, "episode_reward_min": -29.0, "episode_reward_mean": 205.48, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -194.0}, "policy_reward_max": {"policy_0": 480.0}, "policy_reward_mean": {"policy_0": 20.548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [466.0, 115.0, 218.0, 135.0, 187.0, 163.0, 54.0, 287.0, 168.0, 71.0, 55.0, 58.0, 377.0, 260.0, 431.0, 223.0, 225.0, 158.0, 67.0, 268.0, 84.0, -29.0, 472.0, 68.0, 66.0, 420.0, 395.0, 131.0, 79.0, 162.0, 314.0, 66.0, 162.0, 136.0, 244.0, 304.0, 155.0, 127.0, 248.0, 41.0, 11.0, 186.0, 369.0, 376.0, 156.0, 739.0, 15.0, 127.0, 174.0, 318.0, 269.0, 207.0, 198.0, 115.0, 190.0, 376.0, 402.0, 105.0, 91.0, 58.0, 198.0, 249.0, 71.0, 158.0, 197.0, 135.0, 111.0, 358.0, 109.0, 318.0, 173.0, 176.0, 93.0, 185.0, 194.0, 152.0, 65.0, 171.0, 260.0, 352.0, 198.0, 262.0, 154.0, 107.0, 318.0, 260.0, 124.0, 399.0, 43.0, 168.0, 198.0, 274.0, 86.0, 491.0, 271.0, 556.0, 11.0, 206.0, 366.0, 218.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 40.0, 20.0, 20.0, 20.0, 250.0, 9.0, 30.0, 27.0, 10.0, 20.0, -3.0, 10.0, 7.0, 10.0, -35.0, 7.0, 20.0, 34.0, 45.0, 30.0, 30.0, 1.0, -4.0, 7.0, 17.0, 39.0, 40.0, 10.0, 48.0, 8.0, 14.0, 30.0, 7.0, 35.0, 10.0, 18.0, 7.0, 20.0, -14.0, 24.0, -5.0, 0.0, 40.0, 29.0, 20.0, 25.0, 9.0, 29.0, 16.0, 48.0, -1.0, 20.0, 10.0, 18.0, 10.0, 39.0, 20.0, 0.0, -1.0, 30.0, -1.0, 15.0, 0.0, -15.0, 5.0, 0.0, -4.0, 15.0, 9.0, 9.0, 30.0, 0.0, 10.0, 170.0, 5.0, 27.0, 0.0, 16.0, 20.0, 29.0, 50.0, 20.0, 3.0, 30.0, 6.0, 10.0, 8.0, 15.0, -3.0, -3.0, -20.0, 50.0, 10.0, 10.0, 1.0, 27.0, -9.0, -43.0, 48.0, 17.0, 0.0, -8.0, 16.0, 5.0, 4.0, 10.0, 14.0, 0.0, -3.0, -10.0, 20.0, -13.0, 15.0, 30.0, 14.0, -17.0, 19.0, 19.0, -19.0, -1.0, 5.0, 30.0, 53.0, -1.0, 17.0, -6.0, 0.0, 20.0, 260.0, 0.0, 27.0, 70.0, 10.0, 70.0, -1.0, 28.0, 0.0, 39.0, 17.0, 9.0, 25.0, 30.0, 160.0, 13.0, 170.0, 28.0, -11.0, -3.0, 10.0, 0.0, 5.0, -81.0, 4.0, 253.0, -1.0, -1.0, 20.0, 27.0, -3.0, 10.0, 145.0, 0.0, -4.0, 18.0, 20.0, 20.0, 15.0, -9.0, 10.0, 3.0, 160.0, 16.0, 10.0, -2.0, 39.0, -12.0, 4.0, 1.0, -61.0, 0.0, 18.0, 15.0, -4.0, 18.0, -4.0, 8.0, 1.0, 1.0, 14.0, 40.0, 47.0, 70.0, 16.0, 2.0, -3.0, -2.0, 62.0, 37.0, -1.0, 0.0, -5.0, 10.0, 8.0, 10.0, 4.0, 20.0, 7.0, 30.0, 0.0, 21.0, -1.0, -12.0, 0.0, -13.0, 10.0, 0.0, -13.0, -11.0, -10.0, -12.0, -38.0, 19.0, 36.0, 480.0, -2.0, 25.0, -14.0, 10.0, -32.0, 40.0, -12.0, 0.0, -3.0, -5.0, 22.0, 30.0, 10.0, -9.0, -5.0, -7.0, 50.0, 9.0, -2.0, 10.0, -5.0, -13.0, 10.0, 18.0, -4.0, 40.0, -2.0, 8.0, 50.0, -10.0, 10.0, 300.0, 0.0, 20.0, 4.0, 28.0, 8.0, 20.0, -12.0, 1.0, 5.0, 20.0, 16.0, 50.0, 259.0, -3.0, 30.0, 20.0, 10.0, -2.0, 70.0, -2.0, 0.0, 10.0, -2.0, 10.0, 19.0, -7.0, 11.0, -57.0, -12.0, -2.0, 37.0, 50.0, 30.0, 40.0, 39.0, 8.0, 10.0, 10.0, -4.0, 20.0, 10.0, 20.0, 9.0, 4.0, 31.0, 20.0, 20.0, 30.0, 18.0, -7.0, 8.0, 160.0, 30.0, 7.0, 21.0, 30.0, -1.0, -7.0, 10.0, 20.0, -10.0, -24.0, 20.0, 0.0, 3.0, 36.0, 14.0, 30.0, 10.0, 21.0, -9.0, 60.0, -3.0, 10.0, 20.0, 6.0, 16.0, 0.0, 30.0, 18.0, 0.0, 26.0, 10.0, 50.0, 50.0, 18.0, 50.0, 20.0, 0.0, 20.0, 20.0, 16.0, 0.0, 20.0, 20.0, 26.0, 8.0, 16.0, 160.0, 40.0, -46.0, 50.0, 10.0, 7.0, -9.0, 19.0, 7.0, 29.0, 20.0, 16.0, 19.0, 20.0, 27.0, 31.0, -1.0, -14.0, 30.0, 30.0, 25.0, -5.0, -5.0, -4.0, 40.0, 30.0, -1.0, 9.0, -6.0, 0.0, 26.0, 0.0, 10.0, 30.0, 150.0, -11.0, -4.0, 3.0, 20.0, 42.0, 47.0, 0.0, -7.0, -24.0, -25.0, 20.0, -3.0, 0.0, -10.0, -14.0, 0.0, 3.0, 0.0, 5.0, 10.0, -1.0, -2.0, 110.0, -30.0, 28.0, 8.0, 31.0, -9.0, 25.0, 26.0, -10.0, 30.0, 9.0, 9.0, 50.0, 29.0, 16.0, 49.0, 17.0, 170.0, 0.0, 5.0, 68.0, 150.0, 7.0, 20.0, 10.0, 29.0, 70.0, 17.0, 26.0, 38.0, 0.0, 10.0, 20.0, 19.0, 27.0, 19.0, -1.0, -2.0, 30.0, 6.0, 456.0, -10.0, 10.0, 0.0, 28.0, 170.0, 29.0, 20.0, -5.0, -9.0, 30.0, 0.0, -5.0, 0.0, -4.0, 8.0, 7.0, -7.0, 10.0, 30.0, -5.0, -4.0, 0.0, 36.0, 20.0, 15.0, -5.0, 30.0, 10.0, 10.0, -1.0, 7.0, 9.0, 10.0, -40.0, -1.0, 160.0, 10.0, 24.0, 19.0, -3.0, -40.0, 4.0, 20.0, 8.0, -12.0, 270.0, 28.0, 18.0, 35.0, 19.0, 10.0, 150.0, -1.0, 7.0, 24.0, 0.0, 7.0, 40.0, 9.0, 40.0, 10.0, 20.0, 65.0, 24.0, 3.0, 7.0, -11.0, 30.0, 10.0, 60.0, 30.0, 0.0, -1.0, 20.0, 30.0, 10.0, 9.0, 50.0, -1.0, -18.0, 20.0, 16.0, 10.0, 40.0, 10.0, -21.0, 9.0, 10.0, 10.0, 12.0, 40.0, 29.0, 20.0, -2.0, 5.0, 16.0, 50.0, -15.0, -25.0, -25.0, 20.0, 19.0, -9.0, -9.0, 160.0, 360.0, -100.0, 180.0, 50.0, 250.0, -30.0, -14.0, 20.0, -30.0, 38.0, -20.0, -42.0, 16.0, -3.0, -13.0, -3.0, 0.0, 30.0, 20.0, 30.0, 8.0, 20.0, 9.0, 20.0, -1.0, -4.0, 0.0, -2.0, 19.0, 20.0, 30.0, 0.0, 20.0, -11.0, 10.0, 20.0, -1.0, 9.0, -7.0, 9.0, -1.0, 10.0, 10.0, 50.0, 30.0, 10.0, 14.0, 30.0, 10.0, 0.0, 20.0, 24.0, -6.0, 1.0, 30.0, 18.0, 11.0, 18.0, 47.0, 90.0, 30.0, 10.0, -5.0, 1.0, -5.0, 20.0, 20.0, -3.0, -14.0, 50.0, -12.0, 19.0, 19.0, 30.0, 40.0, 0.0, 10.0, 19.0, 0.0, 10.0, 0.0, 30.0, 20.0, 19.0, 40.0, 24.0, 7.0, -5.0, 20.0, 20.0, 40.0, 12.0, 10.0, 50.0, 14.0, 10.0, 24.0, 5.0, 0.0, 0.0, 0.0, 22.0, -4.0, 10.0, 10.0, 24.0, -3.0, 0.0, 17.0, 3.0, 24.0, 30.0, 23.0, -8.0, 0.0, 19.0, 20.0, 200.0, 8.0, 7.0, 60.0, 29.0, -1.0, 10.0, -6.0, 33.0, 9.0, 12.0, 22.0, 32.0, 14.0, -16.0, 7.0, 10.0, 40.0, 141.0, 8.0, 40.0, -1.0, 25.0, -2.0, 50.0, 13.0, 10.0, 20.0, 16.0, 17.0, 18.0, -10.0, 60.0, 34.0, -5.0, 21.0, -41.0, -13.0, 250.0, 6.0, -113.0, 9.0, 18.0, 19.0, 20.0, 5.0, 0.0, 20.0, -5.0, 18.0, 20.0, 10.0, -5.0, 10.0, 20.0, -5.0, 10.0, 13.0, 50.0, 46.0, 19.0, 50.0, -1.0, -5.0, 8.0, 8.0, 8.0, 20.0, 39.0, 28.0, -3.0, 39.0, 15.0, 20.0, 20.0, 45.0, 0.0, 40.0, 10.0, 20.0, 20.0, 0.0, 10.0, 7.0, 0.0, 13.0, 30.0, -6.0, -2.0, 29.0, -14.0, 20.0, 14.0, -15.0, -4.0, 50.0, 10.0, 10.0, 50.0, 20.0, 18.0, 0.0, 8.0, -3.0, 8.0, -107.0, 10.0, 150.0, 10.0, -5.0, 34.0, 15.0, -50.0, 13.0, 190.0, 24.0, 30.0, 30.0, 30.0, 2.0, -5.0, 17.0, 24.0, 170.0, 30.0, -46.0, 28.0, 5.0, -16.0, 90.0, 17.0, 150.0, -10.0, -11.0, -9.0, 23.0, 17.0, 30.0, -5.0, -34.0, 17.0, -6.0, 20.0, 40.0, 160.0, 8.0, 17.0, 13.0, 11.0, 35.0, 17.0, 7.0, 70.0, -7.0, -17.0, -10.0, 50.0, -13.0, 11.0, 7.0, 10.0, 0.0, 30.0, -18.0, 40.0, 40.0, 30.0, 8.0, 7.0, -7.0, -34.0, 260.0, -2.0, 10.0, 6.0, 30.0, -3.0, 40.0, 60.0, 40.0, 0.0, 10.0, 40.0, 15.0, 28.0, 10.0, 5.0, 1.0, -5.0, 8.0, 27.0, 28.0, 50.0, -10.0, 10.0, 30.0, 50.0, 19.0, -80.0, 149.0, 68.0, 49.0, 50.0, 34.0, 30.0, 0.0, 14.0, 40.0, 17.0, 17.0, 0.0, -8.0, -17.0, -6.0, -14.0, 20.0, -100.0, 60.0, -9.0, 10.0, 20.0, 20.0, -5.0, -18.0, 170.0, 40.0, -7.0, 90.0, 30.0, 9.0, 0.0, 3.0, 28.0, -5.0, 10.0, 10.0, 25.0, 20.0, 6.0, 60.0, 5.0, 18.0, 10.0, 60.0, 60.0, 3.0, 36.0, 17.0, 0.0, 20.0, 11.0, -3.0, -1.0, 10.0, -7.0, 40.0, 50.0, 35.0, 40.0, 40.0, 60.0, 60.0, 120.0, -4.0, 50.0, 11.0, 18.0, 180.0, -4.0, -12.0, -9.0, 20.0, 17.0, -3.0, 53.0, 70.0, 50.0, 30.0, 10.0, 28.0, 255.0, 5.0, 51.0, 30.0, 27.0, 40.0, 30.0, 18.0, 20.0, -7.0, -23.0, -27.0, -3.0, -20.0, -17.0, 4.0, -21.0, -3.0, 1.0, -27.0, 20.0, 5.0, -2.0, -41.0, 270.0, 33.0, -13.0, 60.0, 199.0, 8.0, -80.0, 300.0, 9.0, -194.0, 44.0, -7.0, 10.0, 47.0, 30.0, 60.0, 14.0, 10.0, 20.0, 38.0, -4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.798644654076808, "mean_inference_ms": 3.267645366870107, "mean_action_processing_ms": 1.038993517826165, "mean_env_wait_ms": 2.224296772516327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06754684448242188, "StateBufferConnector_ms": 0.009833812713623047, "ViewRequirementAgentConnector_ms": 0.4833812713623047}, "num_episodes": 18, "episode_return_max": 739.0, "episode_return_min": -29.0, "episode_return_mean": 205.48, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.72006491318306, "num_env_steps_trained_throughput_per_sec": 32.72006491318306, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 122877.752, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122877.7, "sample_time_ms": 3189.891, "learn_time_ms": 119662.376, "learn_throughput": 33.427, "synch_weights_time_ms": 14.876}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 26, "trial_id": "6085c_00000", "date": "2024-07-01_23-51-13", "timestamp": 1719892273, "time_this_iter_s": 122.26166892051697, "time_total_s": 5121.704375267029, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138009a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5121.704375267029, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 28.516763005780344, "ram_util_percent": 79.5543352601156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8954239155918646, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.2264312664667765, "policy_loss": -0.004111196504855237, "vf_loss": 5.22939117378828, "vf_explained_var": 0.008544591358040596, "kl": 0.011512890027821493, "entropy": 1.8421824394450528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 248835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 739.0, "episode_reward_min": -29.0, "episode_reward_mean": 217.44, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -194.0}, "policy_reward_max": {"policy_0": 480.0}, "policy_reward_mean": {"policy_0": 21.744}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.0, 268.0, 84.0, -29.0, 472.0, 68.0, 66.0, 420.0, 395.0, 131.0, 79.0, 162.0, 314.0, 66.0, 162.0, 136.0, 244.0, 304.0, 155.0, 127.0, 248.0, 41.0, 11.0, 186.0, 369.0, 376.0, 156.0, 739.0, 15.0, 127.0, 174.0, 318.0, 269.0, 207.0, 198.0, 115.0, 190.0, 376.0, 402.0, 105.0, 91.0, 58.0, 198.0, 249.0, 71.0, 158.0, 197.0, 135.0, 111.0, 358.0, 109.0, 318.0, 173.0, 176.0, 93.0, 185.0, 194.0, 152.0, 65.0, 171.0, 260.0, 352.0, 198.0, 262.0, 154.0, 107.0, 318.0, 260.0, 124.0, 399.0, 43.0, 168.0, 198.0, 274.0, 86.0, 491.0, 271.0, 556.0, 11.0, 206.0, 366.0, 218.0, 352.0, 125.0, 225.0, 169.0, 685.0, 599.0, 168.0, 292.0, 294.0, 199.0, 47.0, 165.0, 125.0, 288.0, 154.0, 299.0, 193.0, 468.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 18.0, 15.0, -4.0, 18.0, -4.0, 8.0, 1.0, 1.0, 14.0, 40.0, 47.0, 70.0, 16.0, 2.0, -3.0, -2.0, 62.0, 37.0, -1.0, 0.0, -5.0, 10.0, 8.0, 10.0, 4.0, 20.0, 7.0, 30.0, 0.0, 21.0, -1.0, -12.0, 0.0, -13.0, 10.0, 0.0, -13.0, -11.0, -10.0, -12.0, -38.0, 19.0, 36.0, 480.0, -2.0, 25.0, -14.0, 10.0, -32.0, 40.0, -12.0, 0.0, -3.0, -5.0, 22.0, 30.0, 10.0, -9.0, -5.0, -7.0, 50.0, 9.0, -2.0, 10.0, -5.0, -13.0, 10.0, 18.0, -4.0, 40.0, -2.0, 8.0, 50.0, -10.0, 10.0, 300.0, 0.0, 20.0, 4.0, 28.0, 8.0, 20.0, -12.0, 1.0, 5.0, 20.0, 16.0, 50.0, 259.0, -3.0, 30.0, 20.0, 10.0, -2.0, 70.0, -2.0, 0.0, 10.0, -2.0, 10.0, 19.0, -7.0, 11.0, -57.0, -12.0, -2.0, 37.0, 50.0, 30.0, 40.0, 39.0, 8.0, 10.0, 10.0, -4.0, 20.0, 10.0, 20.0, 9.0, 4.0, 31.0, 20.0, 20.0, 30.0, 18.0, -7.0, 8.0, 160.0, 30.0, 7.0, 21.0, 30.0, -1.0, -7.0, 10.0, 20.0, -10.0, -24.0, 20.0, 0.0, 3.0, 36.0, 14.0, 30.0, 10.0, 21.0, -9.0, 60.0, -3.0, 10.0, 20.0, 6.0, 16.0, 0.0, 30.0, 18.0, 0.0, 26.0, 10.0, 50.0, 50.0, 18.0, 50.0, 20.0, 0.0, 20.0, 20.0, 16.0, 0.0, 20.0, 20.0, 26.0, 8.0, 16.0, 160.0, 40.0, -46.0, 50.0, 10.0, 7.0, -9.0, 19.0, 7.0, 29.0, 20.0, 16.0, 19.0, 20.0, 27.0, 31.0, -1.0, -14.0, 30.0, 30.0, 25.0, -5.0, -5.0, -4.0, 40.0, 30.0, -1.0, 9.0, -6.0, 0.0, 26.0, 0.0, 10.0, 30.0, 150.0, -11.0, -4.0, 3.0, 20.0, 42.0, 47.0, 0.0, -7.0, -24.0, -25.0, 20.0, -3.0, 0.0, -10.0, -14.0, 0.0, 3.0, 0.0, 5.0, 10.0, -1.0, -2.0, 110.0, -30.0, 28.0, 8.0, 31.0, -9.0, 25.0, 26.0, -10.0, 30.0, 9.0, 9.0, 50.0, 29.0, 16.0, 49.0, 17.0, 170.0, 0.0, 5.0, 68.0, 150.0, 7.0, 20.0, 10.0, 29.0, 70.0, 17.0, 26.0, 38.0, 0.0, 10.0, 20.0, 19.0, 27.0, 19.0, -1.0, -2.0, 30.0, 6.0, 456.0, -10.0, 10.0, 0.0, 28.0, 170.0, 29.0, 20.0, -5.0, -9.0, 30.0, 0.0, -5.0, 0.0, -4.0, 8.0, 7.0, -7.0, 10.0, 30.0, -5.0, -4.0, 0.0, 36.0, 20.0, 15.0, -5.0, 30.0, 10.0, 10.0, -1.0, 7.0, 9.0, 10.0, -40.0, -1.0, 160.0, 10.0, 24.0, 19.0, -3.0, -40.0, 4.0, 20.0, 8.0, -12.0, 270.0, 28.0, 18.0, 35.0, 19.0, 10.0, 150.0, -1.0, 7.0, 24.0, 0.0, 7.0, 40.0, 9.0, 40.0, 10.0, 20.0, 65.0, 24.0, 3.0, 7.0, -11.0, 30.0, 10.0, 60.0, 30.0, 0.0, -1.0, 20.0, 30.0, 10.0, 9.0, 50.0, -1.0, -18.0, 20.0, 16.0, 10.0, 40.0, 10.0, -21.0, 9.0, 10.0, 10.0, 12.0, 40.0, 29.0, 20.0, -2.0, 5.0, 16.0, 50.0, -15.0, -25.0, -25.0, 20.0, 19.0, -9.0, -9.0, 160.0, 360.0, -100.0, 180.0, 50.0, 250.0, -30.0, -14.0, 20.0, -30.0, 38.0, -20.0, -42.0, 16.0, -3.0, -13.0, -3.0, 0.0, 30.0, 20.0, 30.0, 8.0, 20.0, 9.0, 20.0, -1.0, -4.0, 0.0, -2.0, 19.0, 20.0, 30.0, 0.0, 20.0, -11.0, 10.0, 20.0, -1.0, 9.0, -7.0, 9.0, -1.0, 10.0, 10.0, 50.0, 30.0, 10.0, 14.0, 30.0, 10.0, 0.0, 20.0, 24.0, -6.0, 1.0, 30.0, 18.0, 11.0, 18.0, 47.0, 90.0, 30.0, 10.0, -5.0, 1.0, -5.0, 20.0, 20.0, -3.0, -14.0, 50.0, -12.0, 19.0, 19.0, 30.0, 40.0, 0.0, 10.0, 19.0, 0.0, 10.0, 0.0, 30.0, 20.0, 19.0, 40.0, 24.0, 7.0, -5.0, 20.0, 20.0, 40.0, 12.0, 10.0, 50.0, 14.0, 10.0, 24.0, 5.0, 0.0, 0.0, 0.0, 22.0, -4.0, 10.0, 10.0, 24.0, -3.0, 0.0, 17.0, 3.0, 24.0, 30.0, 23.0, -8.0, 0.0, 19.0, 20.0, 200.0, 8.0, 7.0, 60.0, 29.0, -1.0, 10.0, -6.0, 33.0, 9.0, 12.0, 22.0, 32.0, 14.0, -16.0, 7.0, 10.0, 40.0, 141.0, 8.0, 40.0, -1.0, 25.0, -2.0, 50.0, 13.0, 10.0, 20.0, 16.0, 17.0, 18.0, -10.0, 60.0, 34.0, -5.0, 21.0, -41.0, -13.0, 250.0, 6.0, -113.0, 9.0, 18.0, 19.0, 20.0, 5.0, 0.0, 20.0, -5.0, 18.0, 20.0, 10.0, -5.0, 10.0, 20.0, -5.0, 10.0, 13.0, 50.0, 46.0, 19.0, 50.0, -1.0, -5.0, 8.0, 8.0, 8.0, 20.0, 39.0, 28.0, -3.0, 39.0, 15.0, 20.0, 20.0, 45.0, 0.0, 40.0, 10.0, 20.0, 20.0, 0.0, 10.0, 7.0, 0.0, 13.0, 30.0, -6.0, -2.0, 29.0, -14.0, 20.0, 14.0, -15.0, -4.0, 50.0, 10.0, 10.0, 50.0, 20.0, 18.0, 0.0, 8.0, -3.0, 8.0, -107.0, 10.0, 150.0, 10.0, -5.0, 34.0, 15.0, -50.0, 13.0, 190.0, 24.0, 30.0, 30.0, 30.0, 2.0, -5.0, 17.0, 24.0, 170.0, 30.0, -46.0, 28.0, 5.0, -16.0, 90.0, 17.0, 150.0, -10.0, -11.0, -9.0, 23.0, 17.0, 30.0, -5.0, -34.0, 17.0, -6.0, 20.0, 40.0, 160.0, 8.0, 17.0, 13.0, 11.0, 35.0, 17.0, 7.0, 70.0, -7.0, -17.0, -10.0, 50.0, -13.0, 11.0, 7.0, 10.0, 0.0, 30.0, -18.0, 40.0, 40.0, 30.0, 8.0, 7.0, -7.0, -34.0, 260.0, -2.0, 10.0, 6.0, 30.0, -3.0, 40.0, 60.0, 40.0, 0.0, 10.0, 40.0, 15.0, 28.0, 10.0, 5.0, 1.0, -5.0, 8.0, 27.0, 28.0, 50.0, -10.0, 10.0, 30.0, 50.0, 19.0, -80.0, 149.0, 68.0, 49.0, 50.0, 34.0, 30.0, 0.0, 14.0, 40.0, 17.0, 17.0, 0.0, -8.0, -17.0, -6.0, -14.0, 20.0, -100.0, 60.0, -9.0, 10.0, 20.0, 20.0, -5.0, -18.0, 170.0, 40.0, -7.0, 90.0, 30.0, 9.0, 0.0, 3.0, 28.0, -5.0, 10.0, 10.0, 25.0, 20.0, 6.0, 60.0, 5.0, 18.0, 10.0, 60.0, 60.0, 3.0, 36.0, 17.0, 0.0, 20.0, 11.0, -3.0, -1.0, 10.0, -7.0, 40.0, 50.0, 35.0, 40.0, 40.0, 60.0, 60.0, 120.0, -4.0, 50.0, 11.0, 18.0, 180.0, -4.0, -12.0, -9.0, 20.0, 17.0, -3.0, 53.0, 70.0, 50.0, 30.0, 10.0, 28.0, 255.0, 5.0, 51.0, 30.0, 27.0, 40.0, 30.0, 18.0, 20.0, -7.0, -23.0, -27.0, -3.0, -20.0, -17.0, 4.0, -21.0, -3.0, 1.0, -27.0, 20.0, 5.0, -2.0, -41.0, 270.0, 33.0, -13.0, 60.0, 199.0, 8.0, -80.0, 300.0, 9.0, -194.0, 44.0, -7.0, 10.0, 47.0, 30.0, 60.0, 14.0, 10.0, 20.0, 38.0, -4.0, 16.0, 16.0, 34.0, 7.0, 36.0, -12.0, 148.0, 16.0, 49.0, 42.0, -12.0, 15.0, 19.0, 30.0, 23.0, 29.0, 31.0, 12.0, -12.0, -10.0, 20.0, 50.0, 0.0, 14.0, 20.0, 23.0, 29.0, 10.0, 49.0, 10.0, 9.0, 9.0, 39.0, 20.0, -19.0, 5.0, 10.0, 57.0, 0.0, 39.0, -30.0, 20.0, 40.0, 30.0, 28.0, 360.0, 29.0, -2.0, 60.0, 150.0, -12.0, 27.0, 189.0, 157.0, 68.0, 250.0, 10.0, -63.0, -25.0, -2.0, -35.0, 18.0, 0.0, 28.0, 30.0, 7.0, 0.0, 40.0, 66.0, 14.0, 10.0, -10.0, -2.0, 60.0, 17.0, -3.0, 20.0, 50.0, 60.0, 90.0, 50.0, 30.0, 9.0, 60.0, -3.0, 3.0, 30.0, 20.0, 45.0, 50.0, 40.0, 30.0, 0.0, 30.0, 20.0, 10.0, 9.0, 10.0, 30.0, 20.0, 17.0, 18.0, -6.0, 60.0, 10.0, 20.0, -6.0, -6.0, -33.0, -27.0, 9.0, 19.0, 10.0, 20.0, 20.0, 47.0, -3.0, 20.0, 25.0, -2.0, -65.0, 5.0, -5.0, 6.0, 145.0, 10.0, 29.0, 10.0, -19.0, 9.0, 30.0, 10.0, 40.0, -8.0, 17.0, 70.0, 160.0, -9.0, -1.0, -21.0, 26.0, 30.0, 50.0, 2.0, 0.0, -1.0, 24.0, 40.0, -17.0, 0.0, -1.0, 110.0, 38.0, 160.0, 10.0, 23.0, 4.0, 9.0, 11.0, -65.0, 34.0, 40.0, 10.0, 2.0, 40.0, 3.0, 19.0, 10.0, 37.0, -2.0, 40.0, 30.0, 25.0, 80.0, 20.0, 19.0, 0.0, 250.0, 8.0, -4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.757291869801417, "mean_inference_ms": 3.216827256117946, "mean_action_processing_ms": 1.0253113627407837, "mean_env_wait_ms": 2.191841690569363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06209588050842285, "StateBufferConnector_ms": 0.009770631790161133, "ViewRequirementAgentConnector_ms": 0.5491383075714111}, "num_episodes": 18, "episode_return_max": 739.0, "episode_return_min": -29.0, "episode_return_mean": 217.44, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.177966764153766, "num_env_steps_trained_throughput_per_sec": 32.177966764153766, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 122934.58, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122934.529, "sample_time_ms": 3205.467, "learn_time_ms": 119704.391, "learn_throughput": 33.416, "synch_weights_time_ms": 13.983}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 27, "trial_id": "6085c_00000", "date": "2024-07-01_23-53-18", "timestamp": 1719892398, "time_this_iter_s": 124.34774994850159, "time_total_s": 5246.05212521553, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5246.05212521553, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 28.994886363636365, "ram_util_percent": 79.97329545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.28130043859299, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.153925927251546, "policy_loss": -0.001970672509776819, "vf_loss": 5.154678153839355, "vf_explained_var": 0.008235653216084732, "kl": 0.012184511270696084, "entropy": 1.8427748587438728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 258225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 739.0, "episode_reward_min": 11.0, "episode_reward_mean": 243.12, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -194.0}, "policy_reward_max": {"policy_0": 649.0}, "policy_reward_mean": {"policy_0": 24.312}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0, 127.0, 248.0, 41.0, 11.0, 186.0, 369.0, 376.0, 156.0, 739.0, 15.0, 127.0, 174.0, 318.0, 269.0, 207.0, 198.0, 115.0, 190.0, 376.0, 402.0, 105.0, 91.0, 58.0, 198.0, 249.0, 71.0, 158.0, 197.0, 135.0, 111.0, 358.0, 109.0, 318.0, 173.0, 176.0, 93.0, 185.0, 194.0, 152.0, 65.0, 171.0, 260.0, 352.0, 198.0, 262.0, 154.0, 107.0, 318.0, 260.0, 124.0, 399.0, 43.0, 168.0, 198.0, 274.0, 86.0, 491.0, 271.0, 556.0, 11.0, 206.0, 366.0, 218.0, 352.0, 125.0, 225.0, 169.0, 685.0, 599.0, 168.0, 292.0, 294.0, 199.0, 47.0, 165.0, 125.0, 288.0, 154.0, 299.0, 193.0, 468.0, 577.0, 453.0, 420.0, 151.0, 441.0, 496.0, 232.0, 142.0, 318.0, 317.0, 296.0, 127.0, 75.0, 525.0, 374.0, 190.0, 649.0, 194.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [7.0, -9.0, 19.0, 7.0, 29.0, 20.0, 16.0, 19.0, 20.0, 27.0, 31.0, -1.0, -14.0, 30.0, 30.0, 25.0, -5.0, -5.0, -4.0, 40.0, 30.0, -1.0, 9.0, -6.0, 0.0, 26.0, 0.0, 10.0, 30.0, 150.0, -11.0, -4.0, 3.0, 20.0, 42.0, 47.0, 0.0, -7.0, -24.0, -25.0, 20.0, -3.0, 0.0, -10.0, -14.0, 0.0, 3.0, 0.0, 5.0, 10.0, -1.0, -2.0, 110.0, -30.0, 28.0, 8.0, 31.0, -9.0, 25.0, 26.0, -10.0, 30.0, 9.0, 9.0, 50.0, 29.0, 16.0, 49.0, 17.0, 170.0, 0.0, 5.0, 68.0, 150.0, 7.0, 20.0, 10.0, 29.0, 70.0, 17.0, 26.0, 38.0, 0.0, 10.0, 20.0, 19.0, 27.0, 19.0, -1.0, -2.0, 30.0, 6.0, 456.0, -10.0, 10.0, 0.0, 28.0, 170.0, 29.0, 20.0, -5.0, -9.0, 30.0, 0.0, -5.0, 0.0, -4.0, 8.0, 7.0, -7.0, 10.0, 30.0, -5.0, -4.0, 0.0, 36.0, 20.0, 15.0, -5.0, 30.0, 10.0, 10.0, -1.0, 7.0, 9.0, 10.0, -40.0, -1.0, 160.0, 10.0, 24.0, 19.0, -3.0, -40.0, 4.0, 20.0, 8.0, -12.0, 270.0, 28.0, 18.0, 35.0, 19.0, 10.0, 150.0, -1.0, 7.0, 24.0, 0.0, 7.0, 40.0, 9.0, 40.0, 10.0, 20.0, 65.0, 24.0, 3.0, 7.0, -11.0, 30.0, 10.0, 60.0, 30.0, 0.0, -1.0, 20.0, 30.0, 10.0, 9.0, 50.0, -1.0, -18.0, 20.0, 16.0, 10.0, 40.0, 10.0, -21.0, 9.0, 10.0, 10.0, 12.0, 40.0, 29.0, 20.0, -2.0, 5.0, 16.0, 50.0, -15.0, -25.0, -25.0, 20.0, 19.0, -9.0, -9.0, 160.0, 360.0, -100.0, 180.0, 50.0, 250.0, -30.0, -14.0, 20.0, -30.0, 38.0, -20.0, -42.0, 16.0, -3.0, -13.0, -3.0, 0.0, 30.0, 20.0, 30.0, 8.0, 20.0, 9.0, 20.0, -1.0, -4.0, 0.0, -2.0, 19.0, 20.0, 30.0, 0.0, 20.0, -11.0, 10.0, 20.0, -1.0, 9.0, -7.0, 9.0, -1.0, 10.0, 10.0, 50.0, 30.0, 10.0, 14.0, 30.0, 10.0, 0.0, 20.0, 24.0, -6.0, 1.0, 30.0, 18.0, 11.0, 18.0, 47.0, 90.0, 30.0, 10.0, -5.0, 1.0, -5.0, 20.0, 20.0, -3.0, -14.0, 50.0, -12.0, 19.0, 19.0, 30.0, 40.0, 0.0, 10.0, 19.0, 0.0, 10.0, 0.0, 30.0, 20.0, 19.0, 40.0, 24.0, 7.0, -5.0, 20.0, 20.0, 40.0, 12.0, 10.0, 50.0, 14.0, 10.0, 24.0, 5.0, 0.0, 0.0, 0.0, 22.0, -4.0, 10.0, 10.0, 24.0, -3.0, 0.0, 17.0, 3.0, 24.0, 30.0, 23.0, -8.0, 0.0, 19.0, 20.0, 200.0, 8.0, 7.0, 60.0, 29.0, -1.0, 10.0, -6.0, 33.0, 9.0, 12.0, 22.0, 32.0, 14.0, -16.0, 7.0, 10.0, 40.0, 141.0, 8.0, 40.0, -1.0, 25.0, -2.0, 50.0, 13.0, 10.0, 20.0, 16.0, 17.0, 18.0, -10.0, 60.0, 34.0, -5.0, 21.0, -41.0, -13.0, 250.0, 6.0, -113.0, 9.0, 18.0, 19.0, 20.0, 5.0, 0.0, 20.0, -5.0, 18.0, 20.0, 10.0, -5.0, 10.0, 20.0, -5.0, 10.0, 13.0, 50.0, 46.0, 19.0, 50.0, -1.0, -5.0, 8.0, 8.0, 8.0, 20.0, 39.0, 28.0, -3.0, 39.0, 15.0, 20.0, 20.0, 45.0, 0.0, 40.0, 10.0, 20.0, 20.0, 0.0, 10.0, 7.0, 0.0, 13.0, 30.0, -6.0, -2.0, 29.0, -14.0, 20.0, 14.0, -15.0, -4.0, 50.0, 10.0, 10.0, 50.0, 20.0, 18.0, 0.0, 8.0, -3.0, 8.0, -107.0, 10.0, 150.0, 10.0, -5.0, 34.0, 15.0, -50.0, 13.0, 190.0, 24.0, 30.0, 30.0, 30.0, 2.0, -5.0, 17.0, 24.0, 170.0, 30.0, -46.0, 28.0, 5.0, -16.0, 90.0, 17.0, 150.0, -10.0, -11.0, -9.0, 23.0, 17.0, 30.0, -5.0, -34.0, 17.0, -6.0, 20.0, 40.0, 160.0, 8.0, 17.0, 13.0, 11.0, 35.0, 17.0, 7.0, 70.0, -7.0, -17.0, -10.0, 50.0, -13.0, 11.0, 7.0, 10.0, 0.0, 30.0, -18.0, 40.0, 40.0, 30.0, 8.0, 7.0, -7.0, -34.0, 260.0, -2.0, 10.0, 6.0, 30.0, -3.0, 40.0, 60.0, 40.0, 0.0, 10.0, 40.0, 15.0, 28.0, 10.0, 5.0, 1.0, -5.0, 8.0, 27.0, 28.0, 50.0, -10.0, 10.0, 30.0, 50.0, 19.0, -80.0, 149.0, 68.0, 49.0, 50.0, 34.0, 30.0, 0.0, 14.0, 40.0, 17.0, 17.0, 0.0, -8.0, -17.0, -6.0, -14.0, 20.0, -100.0, 60.0, -9.0, 10.0, 20.0, 20.0, -5.0, -18.0, 170.0, 40.0, -7.0, 90.0, 30.0, 9.0, 0.0, 3.0, 28.0, -5.0, 10.0, 10.0, 25.0, 20.0, 6.0, 60.0, 5.0, 18.0, 10.0, 60.0, 60.0, 3.0, 36.0, 17.0, 0.0, 20.0, 11.0, -3.0, -1.0, 10.0, -7.0, 40.0, 50.0, 35.0, 40.0, 40.0, 60.0, 60.0, 120.0, -4.0, 50.0, 11.0, 18.0, 180.0, -4.0, -12.0, -9.0, 20.0, 17.0, -3.0, 53.0, 70.0, 50.0, 30.0, 10.0, 28.0, 255.0, 5.0, 51.0, 30.0, 27.0, 40.0, 30.0, 18.0, 20.0, -7.0, -23.0, -27.0, -3.0, -20.0, -17.0, 4.0, -21.0, -3.0, 1.0, -27.0, 20.0, 5.0, -2.0, -41.0, 270.0, 33.0, -13.0, 60.0, 199.0, 8.0, -80.0, 300.0, 9.0, -194.0, 44.0, -7.0, 10.0, 47.0, 30.0, 60.0, 14.0, 10.0, 20.0, 38.0, -4.0, 16.0, 16.0, 34.0, 7.0, 36.0, -12.0, 148.0, 16.0, 49.0, 42.0, -12.0, 15.0, 19.0, 30.0, 23.0, 29.0, 31.0, 12.0, -12.0, -10.0, 20.0, 50.0, 0.0, 14.0, 20.0, 23.0, 29.0, 10.0, 49.0, 10.0, 9.0, 9.0, 39.0, 20.0, -19.0, 5.0, 10.0, 57.0, 0.0, 39.0, -30.0, 20.0, 40.0, 30.0, 28.0, 360.0, 29.0, -2.0, 60.0, 150.0, -12.0, 27.0, 189.0, 157.0, 68.0, 250.0, 10.0, -63.0, -25.0, -2.0, -35.0, 18.0, 0.0, 28.0, 30.0, 7.0, 0.0, 40.0, 66.0, 14.0, 10.0, -10.0, -2.0, 60.0, 17.0, -3.0, 20.0, 50.0, 60.0, 90.0, 50.0, 30.0, 9.0, 60.0, -3.0, 3.0, 30.0, 20.0, 45.0, 50.0, 40.0, 30.0, 0.0, 30.0, 20.0, 10.0, 9.0, 10.0, 30.0, 20.0, 17.0, 18.0, -6.0, 60.0, 10.0, 20.0, -6.0, -6.0, -33.0, -27.0, 9.0, 19.0, 10.0, 20.0, 20.0, 47.0, -3.0, 20.0, 25.0, -2.0, -65.0, 5.0, -5.0, 6.0, 145.0, 10.0, 29.0, 10.0, -19.0, 9.0, 30.0, 10.0, 40.0, -8.0, 17.0, 70.0, 160.0, -9.0, -1.0, -21.0, 26.0, 30.0, 50.0, 2.0, 0.0, -1.0, 24.0, 40.0, -17.0, 0.0, -1.0, 110.0, 38.0, 160.0, 10.0, 23.0, 4.0, 9.0, 11.0, -65.0, 34.0, 40.0, 10.0, 2.0, 40.0, 3.0, 19.0, 10.0, 37.0, -2.0, 40.0, 30.0, 25.0, 80.0, 20.0, 19.0, 0.0, 250.0, 8.0, -4.0, 245.0, 20.0, 27.0, 19.0, 267.0, 10.0, 27.0, -36.0, 6.0, -8.0, 37.0, -10.0, 150.0, 29.0, 40.0, 40.0, 237.0, -8.0, -12.0, -50.0, 70.0, 17.0, 60.0, 35.0, 60.0, -14.0, -6.0, 30.0, 25.0, 143.0, 7.0, 32.0, -1.0, -1.0, 48.0, 28.0, -14.0, 6.0, 9.0, 37.0, 8.0, 0.0, 187.0, 2.0, -14.0, 180.0, 20.0, 10.0, 0.0, 48.0, -40.0, -130.0, 0.0, -46.0, 580.0, 2.0, -19.0, 19.0, 100.0, 30.0, 28.0, 40.0, 90.0, 40.0, -18.0, 25.0, -17.0, 0.0, 7.0, 37.0, 19.0, 6.0, 39.0, -12.0, 20.0, -7.0, 20.0, 20.0, 29.0, 8.0, 23.0, 18.0, -73.0, 1.0, 60.0, -3.0, 10.0, 250.0, 5.0, 27.0, 649.0, -17.0, -40.0, -151.0, -18.0, 6.0, 20.0, -40.0, 13.0, -105.0, 29.0, 8.0, 29.0, -2.0, 160.0, 60.0, 0.0, 1.0, 11.0, 0.0, 20.0, 6.0, 17.0, 30.0, 6.0, 3.0, 16.0, 9.0, 20.0, 0.0, 17.0, 18.0, 40.0, 6.0, -2.0, 10.0, -6.0, -7.0, 20.0, -21.0, 60.0, -21.0, 160.0, 20.0, 70.0, -41.0, 30.0, 20.0, 17.0, 210.0, 7.0, 50.0, 7.0, 60.0, 170.0, 25.0, 7.0, 8.0, 0.0, 40.0, 30.0, -7.0, -8.0, 9.0, 0.0, 80.0, 30.0, -1.0, 8.0, 49.0, 70.0, -6.0, 20.0, -4.0, 30.0, 29.0, 49.0, 360.0, -40.0, 141.0, 17.0, -7.0, -56.0, 10.0, 170.0, -1.0, 40.0, 5.0, 16.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7197787806747784, "mean_inference_ms": 3.1705787728711177, "mean_action_processing_ms": 1.0119237559775722, "mean_env_wait_ms": 2.161797253049387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06421399116516113, "StateBufferConnector_ms": 0.009732723236083984, "ViewRequirementAgentConnector_ms": 0.551018238067627}, "num_episodes": 18, "episode_return_max": 739.0, "episode_return_min": 11.0, "episode_return_mean": 243.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.73655602642793, "num_env_steps_trained_throughput_per_sec": 32.73655602642793, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 122967.728, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122967.677, "sample_time_ms": 3127.964, "learn_time_ms": 119815.008, "learn_throughput": 33.385, "synch_weights_time_ms": 14.122}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 28, "trial_id": "6085c_00000", "date": "2024-07-01_23-55-20", "timestamp": 1719892520, "time_this_iter_s": 122.19700503349304, "time_total_s": 5368.249130249023, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x1380094c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5368.249130249023, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 29.04335260115607, "ram_util_percent": 80.24104046242775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.366523256672584, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.18364644116614, "policy_loss": -0.0027129790865066355, "vf_loss": 5.185127608057536, "vf_explained_var": 0.009356453116582479, "kl": 0.012318104411838136, "entropy": 1.8125205836864833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 267615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 977.0, "episode_reward_min": 4.0, "episode_reward_mean": 266.74, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -194.0}, "policy_reward_max": {"policy_0": 649.0}, "policy_reward_mean": {"policy_0": 26.674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [158.0, 197.0, 135.0, 111.0, 358.0, 109.0, 318.0, 173.0, 176.0, 93.0, 185.0, 194.0, 152.0, 65.0, 171.0, 260.0, 352.0, 198.0, 262.0, 154.0, 107.0, 318.0, 260.0, 124.0, 399.0, 43.0, 168.0, 198.0, 274.0, 86.0, 491.0, 271.0, 556.0, 11.0, 206.0, 366.0, 218.0, 352.0, 125.0, 225.0, 169.0, 685.0, 599.0, 168.0, 292.0, 294.0, 199.0, 47.0, 165.0, 125.0, 288.0, 154.0, 299.0, 193.0, 468.0, 577.0, 453.0, 420.0, 151.0, 441.0, 496.0, 232.0, 142.0, 318.0, 317.0, 296.0, 127.0, 75.0, 525.0, 374.0, 190.0, 649.0, 194.0, 142.0, 449.0, 609.0, 166.0, 341.0, 733.0, 463.0, 296.0, 617.0, 258.0, 464.0, 159.0, 26.0, 977.0, 122.0, 148.0, 77.0, 192.0, 107.0, 360.0, 347.0, 334.0, 13.0, 129.0, 4.0, 160.0, 240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [19.0, 30.0, 40.0, 0.0, 10.0, 19.0, 0.0, 10.0, 0.0, 30.0, 20.0, 19.0, 40.0, 24.0, 7.0, -5.0, 20.0, 20.0, 40.0, 12.0, 10.0, 50.0, 14.0, 10.0, 24.0, 5.0, 0.0, 0.0, 0.0, 22.0, -4.0, 10.0, 10.0, 24.0, -3.0, 0.0, 17.0, 3.0, 24.0, 30.0, 23.0, -8.0, 0.0, 19.0, 20.0, 200.0, 8.0, 7.0, 60.0, 29.0, -1.0, 10.0, -6.0, 33.0, 9.0, 12.0, 22.0, 32.0, 14.0, -16.0, 7.0, 10.0, 40.0, 141.0, 8.0, 40.0, -1.0, 25.0, -2.0, 50.0, 13.0, 10.0, 20.0, 16.0, 17.0, 18.0, -10.0, 60.0, 34.0, -5.0, 21.0, -41.0, -13.0, 250.0, 6.0, -113.0, 9.0, 18.0, 19.0, 20.0, 5.0, 0.0, 20.0, -5.0, 18.0, 20.0, 10.0, -5.0, 10.0, 20.0, -5.0, 10.0, 13.0, 50.0, 46.0, 19.0, 50.0, -1.0, -5.0, 8.0, 8.0, 8.0, 20.0, 39.0, 28.0, -3.0, 39.0, 15.0, 20.0, 20.0, 45.0, 0.0, 40.0, 10.0, 20.0, 20.0, 0.0, 10.0, 7.0, 0.0, 13.0, 30.0, -6.0, -2.0, 29.0, -14.0, 20.0, 14.0, -15.0, -4.0, 50.0, 10.0, 10.0, 50.0, 20.0, 18.0, 0.0, 8.0, -3.0, 8.0, -107.0, 10.0, 150.0, 10.0, -5.0, 34.0, 15.0, -50.0, 13.0, 190.0, 24.0, 30.0, 30.0, 30.0, 2.0, -5.0, 17.0, 24.0, 170.0, 30.0, -46.0, 28.0, 5.0, -16.0, 90.0, 17.0, 150.0, -10.0, -11.0, -9.0, 23.0, 17.0, 30.0, -5.0, -34.0, 17.0, -6.0, 20.0, 40.0, 160.0, 8.0, 17.0, 13.0, 11.0, 35.0, 17.0, 7.0, 70.0, -7.0, -17.0, -10.0, 50.0, -13.0, 11.0, 7.0, 10.0, 0.0, 30.0, -18.0, 40.0, 40.0, 30.0, 8.0, 7.0, -7.0, -34.0, 260.0, -2.0, 10.0, 6.0, 30.0, -3.0, 40.0, 60.0, 40.0, 0.0, 10.0, 40.0, 15.0, 28.0, 10.0, 5.0, 1.0, -5.0, 8.0, 27.0, 28.0, 50.0, -10.0, 10.0, 30.0, 50.0, 19.0, -80.0, 149.0, 68.0, 49.0, 50.0, 34.0, 30.0, 0.0, 14.0, 40.0, 17.0, 17.0, 0.0, -8.0, -17.0, -6.0, -14.0, 20.0, -100.0, 60.0, -9.0, 10.0, 20.0, 20.0, -5.0, -18.0, 170.0, 40.0, -7.0, 90.0, 30.0, 9.0, 0.0, 3.0, 28.0, -5.0, 10.0, 10.0, 25.0, 20.0, 6.0, 60.0, 5.0, 18.0, 10.0, 60.0, 60.0, 3.0, 36.0, 17.0, 0.0, 20.0, 11.0, -3.0, -1.0, 10.0, -7.0, 40.0, 50.0, 35.0, 40.0, 40.0, 60.0, 60.0, 120.0, -4.0, 50.0, 11.0, 18.0, 180.0, -4.0, -12.0, -9.0, 20.0, 17.0, -3.0, 53.0, 70.0, 50.0, 30.0, 10.0, 28.0, 255.0, 5.0, 51.0, 30.0, 27.0, 40.0, 30.0, 18.0, 20.0, -7.0, -23.0, -27.0, -3.0, -20.0, -17.0, 4.0, -21.0, -3.0, 1.0, -27.0, 20.0, 5.0, -2.0, -41.0, 270.0, 33.0, -13.0, 60.0, 199.0, 8.0, -80.0, 300.0, 9.0, -194.0, 44.0, -7.0, 10.0, 47.0, 30.0, 60.0, 14.0, 10.0, 20.0, 38.0, -4.0, 16.0, 16.0, 34.0, 7.0, 36.0, -12.0, 148.0, 16.0, 49.0, 42.0, -12.0, 15.0, 19.0, 30.0, 23.0, 29.0, 31.0, 12.0, -12.0, -10.0, 20.0, 50.0, 0.0, 14.0, 20.0, 23.0, 29.0, 10.0, 49.0, 10.0, 9.0, 9.0, 39.0, 20.0, -19.0, 5.0, 10.0, 57.0, 0.0, 39.0, -30.0, 20.0, 40.0, 30.0, 28.0, 360.0, 29.0, -2.0, 60.0, 150.0, -12.0, 27.0, 189.0, 157.0, 68.0, 250.0, 10.0, -63.0, -25.0, -2.0, -35.0, 18.0, 0.0, 28.0, 30.0, 7.0, 0.0, 40.0, 66.0, 14.0, 10.0, -10.0, -2.0, 60.0, 17.0, -3.0, 20.0, 50.0, 60.0, 90.0, 50.0, 30.0, 9.0, 60.0, -3.0, 3.0, 30.0, 20.0, 45.0, 50.0, 40.0, 30.0, 0.0, 30.0, 20.0, 10.0, 9.0, 10.0, 30.0, 20.0, 17.0, 18.0, -6.0, 60.0, 10.0, 20.0, -6.0, -6.0, -33.0, -27.0, 9.0, 19.0, 10.0, 20.0, 20.0, 47.0, -3.0, 20.0, 25.0, -2.0, -65.0, 5.0, -5.0, 6.0, 145.0, 10.0, 29.0, 10.0, -19.0, 9.0, 30.0, 10.0, 40.0, -8.0, 17.0, 70.0, 160.0, -9.0, -1.0, -21.0, 26.0, 30.0, 50.0, 2.0, 0.0, -1.0, 24.0, 40.0, -17.0, 0.0, -1.0, 110.0, 38.0, 160.0, 10.0, 23.0, 4.0, 9.0, 11.0, -65.0, 34.0, 40.0, 10.0, 2.0, 40.0, 3.0, 19.0, 10.0, 37.0, -2.0, 40.0, 30.0, 25.0, 80.0, 20.0, 19.0, 0.0, 250.0, 8.0, -4.0, 245.0, 20.0, 27.0, 19.0, 267.0, 10.0, 27.0, -36.0, 6.0, -8.0, 37.0, -10.0, 150.0, 29.0, 40.0, 40.0, 237.0, -8.0, -12.0, -50.0, 70.0, 17.0, 60.0, 35.0, 60.0, -14.0, -6.0, 30.0, 25.0, 143.0, 7.0, 32.0, -1.0, -1.0, 48.0, 28.0, -14.0, 6.0, 9.0, 37.0, 8.0, 0.0, 187.0, 2.0, -14.0, 180.0, 20.0, 10.0, 0.0, 48.0, -40.0, -130.0, 0.0, -46.0, 580.0, 2.0, -19.0, 19.0, 100.0, 30.0, 28.0, 40.0, 90.0, 40.0, -18.0, 25.0, -17.0, 0.0, 7.0, 37.0, 19.0, 6.0, 39.0, -12.0, 20.0, -7.0, 20.0, 20.0, 29.0, 8.0, 23.0, 18.0, -73.0, 1.0, 60.0, -3.0, 10.0, 250.0, 5.0, 27.0, 649.0, -17.0, -40.0, -151.0, -18.0, 6.0, 20.0, -40.0, 13.0, -105.0, 29.0, 8.0, 29.0, -2.0, 160.0, 60.0, 0.0, 1.0, 11.0, 0.0, 20.0, 6.0, 17.0, 30.0, 6.0, 3.0, 16.0, 9.0, 20.0, 0.0, 17.0, 18.0, 40.0, 6.0, -2.0, 10.0, -6.0, -7.0, 20.0, -21.0, 60.0, -21.0, 160.0, 20.0, 70.0, -41.0, 30.0, 20.0, 17.0, 210.0, 7.0, 50.0, 7.0, 60.0, 170.0, 25.0, 7.0, 8.0, 0.0, 40.0, 30.0, -7.0, -8.0, 9.0, 0.0, 80.0, 30.0, -1.0, 8.0, 49.0, 70.0, -6.0, 20.0, -4.0, 30.0, 29.0, 49.0, 360.0, -40.0, 141.0, 17.0, -7.0, -56.0, 10.0, 170.0, -1.0, 40.0, 5.0, 16.0, 0.0, -7.0, 4.0, 11.0, 50.0, -2.0, -8.0, -2.0, -2.0, 49.0, 49.0, 150.0, 158.0, 30.0, 0.0, 26.0, 0.0, 30.0, 40.0, 15.0, 0.0, 39.0, 21.0, 16.0, 40.0, 350.0, 10.0, 4.0, 134.0, 13.0, -18.0, 16.0, 0.0, 28.0, 40.0, -1.0, 26.0, 14.0, 0.0, 40.0, 3.0, 180.0, -7.0, 38.0, -4.0, -1.0, 90.0, 10.0, 10.0, 20.0, 5.0, 1.0, 170.0, 379.0, 17.0, 150.0, 16.0, 9.0, -33.0, -36.0, 60.0, 5.0, 17.0, 20.0, 30.0, 160.0, 58.0, 4.0, 10.0, 150.0, 9.0, 70.0, -7.0, 70.0, -6.0, 45.0, 20.0, 30.0, 40.0, 20.0, 14.0, 50.0, 180.0, 6.0, 0.0, 180.0, -20.0, -10.0, 60.0, -9.0, 180.0, 60.0, 20.0, 50.0, 18.0, 6.0, 36.0, 10.0, 40.0, -2.0, 20.0, 30.0, 60.0, 40.0, 22.0, 44.0, 190.0, 10.0, 0.0, 50.0, 18.0, 50.0, -22.0, 17.0, 60.0, 10.0, 30.0, 27.0, -14.0, -24.0, 25.0, 37.0, -8.0, 5.0, -31.0, 4.0, -11.0, 18.0, -5.0, -3.0, 20.0, -40.0, 50.0, 100.0, 410.0, 162.0, 30.0, 10.0, 70.0, 116.0, 69.0, -2.0, 7.0, 30.0, -1.0, -3.0, 15.0, 48.0, 7.0, 27.0, -6.0, -2.0, 18.0, 23.0, 40.0, 4.0, 9.0, 19.0, 21.0, -4.0, 20.0, 10.0, -29.0, -17.0, 40.0, -1.0, 40.0, -1.0, -17.0, 26.0, 26.0, 0.0, -3.0, 80.0, -6.0, 20.0, 36.0, 30.0, 24.0, 19.0, -8.0, 10.0, -13.0, -17.0, 10.0, 0.0, 19.0, 28.0, 0.0, 40.0, 30.0, 68.0, 10.0, 6.0, -4.0, 40.0, 70.0, 70.0, 40.0, 30.0, 30.0, 50.0, 20.0, 18.0, -105.0, 250.0, 7.0, 37.0, 40.0, 10.0, 20.0, 14.0, 16.0, 70.0, 30.0, 6.0, -16.0, 60.0, -131.0, 280.0, 5.0, 18.0, -4.0, -28.0, 6.0, 20.0, -21.0, -15.0, 20.0, 7.0, 10.0, -4.0, 0.0, -13.0, 6.0, 62.0, -4.0, -21.0, 52.0, 0.0, 51.0, -5.0, -4.0, 8.0, -15.0, 3.0, 30.0, -2.0, -18.0, 40.0, -33.0, 10.0, 60.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, -23.0, 50.0, 20.0, 39.0, -29.0, 30.0, 160.0, 11.0, -6.0, -12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6686383095145105, "mean_inference_ms": 3.107769461174002, "mean_action_processing_ms": 0.9937885572936683, "mean_env_wait_ms": 2.121045952210943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09189105033874512, "StateBufferConnector_ms": 0.018053770065307617, "ViewRequirementAgentConnector_ms": 0.6150534152984619}, "num_episodes": 27, "episode_return_max": 977.0, "episode_return_min": 4.0, "episode_return_mean": 266.74, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.00262916249252, "num_env_steps_trained_throughput_per_sec": 33.00262916249252, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 122820.922, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122820.872, "sample_time_ms": 3127.266, "learn_time_ms": 119669.348, "learn_throughput": 33.425, "synch_weights_time_ms": 13.869}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 29, "trial_id": "6085c_00000", "date": "2024-07-01_23-57-21", "timestamp": 1719892641, "time_this_iter_s": 121.21140384674072, "time_total_s": 5489.460534095764, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b22b9040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5489.460534095764, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 28.119883040935672, "ram_util_percent": 80.57660818713451}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.073045526500454, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.40172235018656, "policy_loss": -0.0034407141044412574, "vf_loss": 5.403998096403096, "vf_explained_var": 0.014871981521003162, "kl": 0.01164965491899556, "entropy": 1.7966197522303549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 277005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 977.0, "episode_reward_min": 4.0, "episode_reward_mean": 267.77, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -194.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 26.777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [262.0, 154.0, 107.0, 318.0, 260.0, 124.0, 399.0, 43.0, 168.0, 198.0, 274.0, 86.0, 491.0, 271.0, 556.0, 11.0, 206.0, 366.0, 218.0, 352.0, 125.0, 225.0, 169.0, 685.0, 599.0, 168.0, 292.0, 294.0, 199.0, 47.0, 165.0, 125.0, 288.0, 154.0, 299.0, 193.0, 468.0, 577.0, 453.0, 420.0, 151.0, 441.0, 496.0, 232.0, 142.0, 318.0, 317.0, 296.0, 127.0, 75.0, 525.0, 374.0, 190.0, 649.0, 194.0, 142.0, 449.0, 609.0, 166.0, 341.0, 733.0, 463.0, 296.0, 617.0, 258.0, 464.0, 159.0, 26.0, 977.0, 122.0, 148.0, 77.0, 192.0, 107.0, 360.0, 347.0, 334.0, 13.0, 129.0, 4.0, 160.0, 240.0, 179.0, 25.0, 59.0, 96.0, 342.0, 368.0, 223.0, 124.0, 132.0, 294.0, 654.0, 302.0, 94.0, 14.0, 104.0, 28.0, 252.0, 218.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [23.0, 17.0, 30.0, -5.0, -34.0, 17.0, -6.0, 20.0, 40.0, 160.0, 8.0, 17.0, 13.0, 11.0, 35.0, 17.0, 7.0, 70.0, -7.0, -17.0, -10.0, 50.0, -13.0, 11.0, 7.0, 10.0, 0.0, 30.0, -18.0, 40.0, 40.0, 30.0, 8.0, 7.0, -7.0, -34.0, 260.0, -2.0, 10.0, 6.0, 30.0, -3.0, 40.0, 60.0, 40.0, 0.0, 10.0, 40.0, 15.0, 28.0, 10.0, 5.0, 1.0, -5.0, 8.0, 27.0, 28.0, 50.0, -10.0, 10.0, 30.0, 50.0, 19.0, -80.0, 149.0, 68.0, 49.0, 50.0, 34.0, 30.0, 0.0, 14.0, 40.0, 17.0, 17.0, 0.0, -8.0, -17.0, -6.0, -14.0, 20.0, -100.0, 60.0, -9.0, 10.0, 20.0, 20.0, -5.0, -18.0, 170.0, 40.0, -7.0, 90.0, 30.0, 9.0, 0.0, 3.0, 28.0, -5.0, 10.0, 10.0, 25.0, 20.0, 6.0, 60.0, 5.0, 18.0, 10.0, 60.0, 60.0, 3.0, 36.0, 17.0, 0.0, 20.0, 11.0, -3.0, -1.0, 10.0, -7.0, 40.0, 50.0, 35.0, 40.0, 40.0, 60.0, 60.0, 120.0, -4.0, 50.0, 11.0, 18.0, 180.0, -4.0, -12.0, -9.0, 20.0, 17.0, -3.0, 53.0, 70.0, 50.0, 30.0, 10.0, 28.0, 255.0, 5.0, 51.0, 30.0, 27.0, 40.0, 30.0, 18.0, 20.0, -7.0, -23.0, -27.0, -3.0, -20.0, -17.0, 4.0, -21.0, -3.0, 1.0, -27.0, 20.0, 5.0, -2.0, -41.0, 270.0, 33.0, -13.0, 60.0, 199.0, 8.0, -80.0, 300.0, 9.0, -194.0, 44.0, -7.0, 10.0, 47.0, 30.0, 60.0, 14.0, 10.0, 20.0, 38.0, -4.0, 16.0, 16.0, 34.0, 7.0, 36.0, -12.0, 148.0, 16.0, 49.0, 42.0, -12.0, 15.0, 19.0, 30.0, 23.0, 29.0, 31.0, 12.0, -12.0, -10.0, 20.0, 50.0, 0.0, 14.0, 20.0, 23.0, 29.0, 10.0, 49.0, 10.0, 9.0, 9.0, 39.0, 20.0, -19.0, 5.0, 10.0, 57.0, 0.0, 39.0, -30.0, 20.0, 40.0, 30.0, 28.0, 360.0, 29.0, -2.0, 60.0, 150.0, -12.0, 27.0, 189.0, 157.0, 68.0, 250.0, 10.0, -63.0, -25.0, -2.0, -35.0, 18.0, 0.0, 28.0, 30.0, 7.0, 0.0, 40.0, 66.0, 14.0, 10.0, -10.0, -2.0, 60.0, 17.0, -3.0, 20.0, 50.0, 60.0, 90.0, 50.0, 30.0, 9.0, 60.0, -3.0, 3.0, 30.0, 20.0, 45.0, 50.0, 40.0, 30.0, 0.0, 30.0, 20.0, 10.0, 9.0, 10.0, 30.0, 20.0, 17.0, 18.0, -6.0, 60.0, 10.0, 20.0, -6.0, -6.0, -33.0, -27.0, 9.0, 19.0, 10.0, 20.0, 20.0, 47.0, -3.0, 20.0, 25.0, -2.0, -65.0, 5.0, -5.0, 6.0, 145.0, 10.0, 29.0, 10.0, -19.0, 9.0, 30.0, 10.0, 40.0, -8.0, 17.0, 70.0, 160.0, -9.0, -1.0, -21.0, 26.0, 30.0, 50.0, 2.0, 0.0, -1.0, 24.0, 40.0, -17.0, 0.0, -1.0, 110.0, 38.0, 160.0, 10.0, 23.0, 4.0, 9.0, 11.0, -65.0, 34.0, 40.0, 10.0, 2.0, 40.0, 3.0, 19.0, 10.0, 37.0, -2.0, 40.0, 30.0, 25.0, 80.0, 20.0, 19.0, 0.0, 250.0, 8.0, -4.0, 245.0, 20.0, 27.0, 19.0, 267.0, 10.0, 27.0, -36.0, 6.0, -8.0, 37.0, -10.0, 150.0, 29.0, 40.0, 40.0, 237.0, -8.0, -12.0, -50.0, 70.0, 17.0, 60.0, 35.0, 60.0, -14.0, -6.0, 30.0, 25.0, 143.0, 7.0, 32.0, -1.0, -1.0, 48.0, 28.0, -14.0, 6.0, 9.0, 37.0, 8.0, 0.0, 187.0, 2.0, -14.0, 180.0, 20.0, 10.0, 0.0, 48.0, -40.0, -130.0, 0.0, -46.0, 580.0, 2.0, -19.0, 19.0, 100.0, 30.0, 28.0, 40.0, 90.0, 40.0, -18.0, 25.0, -17.0, 0.0, 7.0, 37.0, 19.0, 6.0, 39.0, -12.0, 20.0, -7.0, 20.0, 20.0, 29.0, 8.0, 23.0, 18.0, -73.0, 1.0, 60.0, -3.0, 10.0, 250.0, 5.0, 27.0, 649.0, -17.0, -40.0, -151.0, -18.0, 6.0, 20.0, -40.0, 13.0, -105.0, 29.0, 8.0, 29.0, -2.0, 160.0, 60.0, 0.0, 1.0, 11.0, 0.0, 20.0, 6.0, 17.0, 30.0, 6.0, 3.0, 16.0, 9.0, 20.0, 0.0, 17.0, 18.0, 40.0, 6.0, -2.0, 10.0, -6.0, -7.0, 20.0, -21.0, 60.0, -21.0, 160.0, 20.0, 70.0, -41.0, 30.0, 20.0, 17.0, 210.0, 7.0, 50.0, 7.0, 60.0, 170.0, 25.0, 7.0, 8.0, 0.0, 40.0, 30.0, -7.0, -8.0, 9.0, 0.0, 80.0, 30.0, -1.0, 8.0, 49.0, 70.0, -6.0, 20.0, -4.0, 30.0, 29.0, 49.0, 360.0, -40.0, 141.0, 17.0, -7.0, -56.0, 10.0, 170.0, -1.0, 40.0, 5.0, 16.0, 0.0, -7.0, 4.0, 11.0, 50.0, -2.0, -8.0, -2.0, -2.0, 49.0, 49.0, 150.0, 158.0, 30.0, 0.0, 26.0, 0.0, 30.0, 40.0, 15.0, 0.0, 39.0, 21.0, 16.0, 40.0, 350.0, 10.0, 4.0, 134.0, 13.0, -18.0, 16.0, 0.0, 28.0, 40.0, -1.0, 26.0, 14.0, 0.0, 40.0, 3.0, 180.0, -7.0, 38.0, -4.0, -1.0, 90.0, 10.0, 10.0, 20.0, 5.0, 1.0, 170.0, 379.0, 17.0, 150.0, 16.0, 9.0, -33.0, -36.0, 60.0, 5.0, 17.0, 20.0, 30.0, 160.0, 58.0, 4.0, 10.0, 150.0, 9.0, 70.0, -7.0, 70.0, -6.0, 45.0, 20.0, 30.0, 40.0, 20.0, 14.0, 50.0, 180.0, 6.0, 0.0, 180.0, -20.0, -10.0, 60.0, -9.0, 180.0, 60.0, 20.0, 50.0, 18.0, 6.0, 36.0, 10.0, 40.0, -2.0, 20.0, 30.0, 60.0, 40.0, 22.0, 44.0, 190.0, 10.0, 0.0, 50.0, 18.0, 50.0, -22.0, 17.0, 60.0, 10.0, 30.0, 27.0, -14.0, -24.0, 25.0, 37.0, -8.0, 5.0, -31.0, 4.0, -11.0, 18.0, -5.0, -3.0, 20.0, -40.0, 50.0, 100.0, 410.0, 162.0, 30.0, 10.0, 70.0, 116.0, 69.0, -2.0, 7.0, 30.0, -1.0, -3.0, 15.0, 48.0, 7.0, 27.0, -6.0, -2.0, 18.0, 23.0, 40.0, 4.0, 9.0, 19.0, 21.0, -4.0, 20.0, 10.0, -29.0, -17.0, 40.0, -1.0, 40.0, -1.0, -17.0, 26.0, 26.0, 0.0, -3.0, 80.0, -6.0, 20.0, 36.0, 30.0, 24.0, 19.0, -8.0, 10.0, -13.0, -17.0, 10.0, 0.0, 19.0, 28.0, 0.0, 40.0, 30.0, 68.0, 10.0, 6.0, -4.0, 40.0, 70.0, 70.0, 40.0, 30.0, 30.0, 50.0, 20.0, 18.0, -105.0, 250.0, 7.0, 37.0, 40.0, 10.0, 20.0, 14.0, 16.0, 70.0, 30.0, 6.0, -16.0, 60.0, -131.0, 280.0, 5.0, 18.0, -4.0, -28.0, 6.0, 20.0, -21.0, -15.0, 20.0, 7.0, 10.0, -4.0, 0.0, -13.0, 6.0, 62.0, -4.0, -21.0, 52.0, 0.0, 51.0, -5.0, -4.0, 8.0, -15.0, 3.0, 30.0, -2.0, -18.0, 40.0, -33.0, 10.0, 60.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, -23.0, 50.0, 20.0, 39.0, -29.0, 30.0, 160.0, 11.0, -6.0, -12.0, 32.0, 60.0, 23.0, 1.0, 80.0, -33.0, -3.0, 0.0, -11.0, 30.0, -6.0, 9.0, 0.0, 18.0, 0.0, 4.0, -9.0, -10.0, 21.0, -2.0, -5.0, 7.0, -23.0, 10.0, -3.0, 38.0, 7.0, 13.0, 3.0, 12.0, -7.0, 36.0, 4.0, 20.0, 9.0, -7.0, 30.0, 8.0, 20.0, -17.0, 50.0, 6.0, 30.0, -31.0, -3.0, 10.0, 50.0, 20.0, 50.0, 160.0, 244.0, -6.0, 27.0, 36.0, 10.0, 40.0, -9.0, -54.0, 47.0, 33.0, 14.0, 30.0, 20.0, 17.0, 20.0, 1.0, 60.0, 60.0, 7.0, -6.0, 30.0, 0.0, 60.0, 0.0, 15.0, -14.0, 16.0, 3.0, -6.0, 20.0, 5.0, 32.0, 20.0, 23.0, -16.0, -25.0, 49.0, 13.0, -3.0, 34.0, 20.0, -14.0, -9.0, 3.0, -57.0, 7.0, 67.0, -3.0, 30.0, 250.0, 90.0, 4.0, -30.0, 10.0, 390.0, 10.0, 50.0, 40.0, 40.0, 50.0, -16.0, 660.0, -41.0, -42.0, 10.0, -94.0, -68.0, -132.0, 10.0, 15.0, -5.0, 15.0, 25.0, 25.0, 5.0, 0.0, -1.0, 6.0, -6.0, 30.0, 0.0, 35.0, -27.0, -15.0, 5.0, -2.0, 11.0, -21.0, -2.0, 30.0, 0.0, -9.0, -7.0, 28.0, 50.0, -3.0, 30.0, 3.0, -8.0, 20.0, 11.0, 10.0, -3.0, -10.0, -15.0, -12.0, 10.0, -7.0, 12.0, 32.0, -5.0, 60.0, 30.0, -12.0, 10.0, 30.0, 20.0, 19.0, 50.0, 50.0, 158.0, 32.0, 3.0, -34.0, 10.0, 6.0, -45.0, 49.0, -39.0, 78.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6396594349027196, "mean_inference_ms": 3.07015682973657, "mean_action_processing_ms": 0.9827602326895538, "mean_env_wait_ms": 2.0965053441344703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09413981437683105, "StateBufferConnector_ms": 0.018558979034423828, "ViewRequirementAgentConnector_ms": 0.6155962944030762}, "num_episodes": 18, "episode_return_max": 977.0, "episode_return_min": 4.0, "episode_return_mean": 267.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.18524219831468, "num_env_steps_trained_throughput_per_sec": 33.18524219831468, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 122479.663, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122479.61, "sample_time_ms": 3147.629, "learn_time_ms": 119307.93, "learn_throughput": 33.527, "synch_weights_time_ms": 13.492}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 30, "trial_id": "6085c_00000", "date": "2024-07-01_23-59-22", "timestamp": 1719892762, "time_this_iter_s": 120.54664492607117, "time_total_s": 5610.007179021835, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b91795e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5610.007179021835, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 28.381286549707607, "ram_util_percent": 78.58304093567251}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.984239303215117, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6191157107155165, "policy_loss": -0.005362514913810122, "vf_loss": 5.623439052056708, "vf_explained_var": 0.014532747677466866, "kl": 0.010391795608811817, "entropy": 1.7786094112264208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 286395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 977.0, "episode_reward_min": -76.0, "episode_reward_mean": 274.37, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -151.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 27.437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [218.0, 352.0, 125.0, 225.0, 169.0, 685.0, 599.0, 168.0, 292.0, 294.0, 199.0, 47.0, 165.0, 125.0, 288.0, 154.0, 299.0, 193.0, 468.0, 577.0, 453.0, 420.0, 151.0, 441.0, 496.0, 232.0, 142.0, 318.0, 317.0, 296.0, 127.0, 75.0, 525.0, 374.0, 190.0, 649.0, 194.0, 142.0, 449.0, 609.0, 166.0, 341.0, 733.0, 463.0, 296.0, 617.0, 258.0, 464.0, 159.0, 26.0, 977.0, 122.0, 148.0, 77.0, 192.0, 107.0, 360.0, 347.0, 334.0, 13.0, 129.0, 4.0, 160.0, 240.0, 179.0, 25.0, 59.0, 96.0, 342.0, 368.0, 223.0, 124.0, 132.0, 294.0, 654.0, 302.0, 94.0, 14.0, 104.0, 28.0, 252.0, 218.0, 454.0, 305.0, 399.0, 246.0, 177.0, 197.0, 184.0, -4.0, 138.0, 489.0, 158.0, 252.0, -76.0, 370.0, 634.0, 168.0, 387.0, 476.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-7.0, 10.0, 47.0, 30.0, 60.0, 14.0, 10.0, 20.0, 38.0, -4.0, 16.0, 16.0, 34.0, 7.0, 36.0, -12.0, 148.0, 16.0, 49.0, 42.0, -12.0, 15.0, 19.0, 30.0, 23.0, 29.0, 31.0, 12.0, -12.0, -10.0, 20.0, 50.0, 0.0, 14.0, 20.0, 23.0, 29.0, 10.0, 49.0, 10.0, 9.0, 9.0, 39.0, 20.0, -19.0, 5.0, 10.0, 57.0, 0.0, 39.0, -30.0, 20.0, 40.0, 30.0, 28.0, 360.0, 29.0, -2.0, 60.0, 150.0, -12.0, 27.0, 189.0, 157.0, 68.0, 250.0, 10.0, -63.0, -25.0, -2.0, -35.0, 18.0, 0.0, 28.0, 30.0, 7.0, 0.0, 40.0, 66.0, 14.0, 10.0, -10.0, -2.0, 60.0, 17.0, -3.0, 20.0, 50.0, 60.0, 90.0, 50.0, 30.0, 9.0, 60.0, -3.0, 3.0, 30.0, 20.0, 45.0, 50.0, 40.0, 30.0, 0.0, 30.0, 20.0, 10.0, 9.0, 10.0, 30.0, 20.0, 17.0, 18.0, -6.0, 60.0, 10.0, 20.0, -6.0, -6.0, -33.0, -27.0, 9.0, 19.0, 10.0, 20.0, 20.0, 47.0, -3.0, 20.0, 25.0, -2.0, -65.0, 5.0, -5.0, 6.0, 145.0, 10.0, 29.0, 10.0, -19.0, 9.0, 30.0, 10.0, 40.0, -8.0, 17.0, 70.0, 160.0, -9.0, -1.0, -21.0, 26.0, 30.0, 50.0, 2.0, 0.0, -1.0, 24.0, 40.0, -17.0, 0.0, -1.0, 110.0, 38.0, 160.0, 10.0, 23.0, 4.0, 9.0, 11.0, -65.0, 34.0, 40.0, 10.0, 2.0, 40.0, 3.0, 19.0, 10.0, 37.0, -2.0, 40.0, 30.0, 25.0, 80.0, 20.0, 19.0, 0.0, 250.0, 8.0, -4.0, 245.0, 20.0, 27.0, 19.0, 267.0, 10.0, 27.0, -36.0, 6.0, -8.0, 37.0, -10.0, 150.0, 29.0, 40.0, 40.0, 237.0, -8.0, -12.0, -50.0, 70.0, 17.0, 60.0, 35.0, 60.0, -14.0, -6.0, 30.0, 25.0, 143.0, 7.0, 32.0, -1.0, -1.0, 48.0, 28.0, -14.0, 6.0, 9.0, 37.0, 8.0, 0.0, 187.0, 2.0, -14.0, 180.0, 20.0, 10.0, 0.0, 48.0, -40.0, -130.0, 0.0, -46.0, 580.0, 2.0, -19.0, 19.0, 100.0, 30.0, 28.0, 40.0, 90.0, 40.0, -18.0, 25.0, -17.0, 0.0, 7.0, 37.0, 19.0, 6.0, 39.0, -12.0, 20.0, -7.0, 20.0, 20.0, 29.0, 8.0, 23.0, 18.0, -73.0, 1.0, 60.0, -3.0, 10.0, 250.0, 5.0, 27.0, 649.0, -17.0, -40.0, -151.0, -18.0, 6.0, 20.0, -40.0, 13.0, -105.0, 29.0, 8.0, 29.0, -2.0, 160.0, 60.0, 0.0, 1.0, 11.0, 0.0, 20.0, 6.0, 17.0, 30.0, 6.0, 3.0, 16.0, 9.0, 20.0, 0.0, 17.0, 18.0, 40.0, 6.0, -2.0, 10.0, -6.0, -7.0, 20.0, -21.0, 60.0, -21.0, 160.0, 20.0, 70.0, -41.0, 30.0, 20.0, 17.0, 210.0, 7.0, 50.0, 7.0, 60.0, 170.0, 25.0, 7.0, 8.0, 0.0, 40.0, 30.0, -7.0, -8.0, 9.0, 0.0, 80.0, 30.0, -1.0, 8.0, 49.0, 70.0, -6.0, 20.0, -4.0, 30.0, 29.0, 49.0, 360.0, -40.0, 141.0, 17.0, -7.0, -56.0, 10.0, 170.0, -1.0, 40.0, 5.0, 16.0, 0.0, -7.0, 4.0, 11.0, 50.0, -2.0, -8.0, -2.0, -2.0, 49.0, 49.0, 150.0, 158.0, 30.0, 0.0, 26.0, 0.0, 30.0, 40.0, 15.0, 0.0, 39.0, 21.0, 16.0, 40.0, 350.0, 10.0, 4.0, 134.0, 13.0, -18.0, 16.0, 0.0, 28.0, 40.0, -1.0, 26.0, 14.0, 0.0, 40.0, 3.0, 180.0, -7.0, 38.0, -4.0, -1.0, 90.0, 10.0, 10.0, 20.0, 5.0, 1.0, 170.0, 379.0, 17.0, 150.0, 16.0, 9.0, -33.0, -36.0, 60.0, 5.0, 17.0, 20.0, 30.0, 160.0, 58.0, 4.0, 10.0, 150.0, 9.0, 70.0, -7.0, 70.0, -6.0, 45.0, 20.0, 30.0, 40.0, 20.0, 14.0, 50.0, 180.0, 6.0, 0.0, 180.0, -20.0, -10.0, 60.0, -9.0, 180.0, 60.0, 20.0, 50.0, 18.0, 6.0, 36.0, 10.0, 40.0, -2.0, 20.0, 30.0, 60.0, 40.0, 22.0, 44.0, 190.0, 10.0, 0.0, 50.0, 18.0, 50.0, -22.0, 17.0, 60.0, 10.0, 30.0, 27.0, -14.0, -24.0, 25.0, 37.0, -8.0, 5.0, -31.0, 4.0, -11.0, 18.0, -5.0, -3.0, 20.0, -40.0, 50.0, 100.0, 410.0, 162.0, 30.0, 10.0, 70.0, 116.0, 69.0, -2.0, 7.0, 30.0, -1.0, -3.0, 15.0, 48.0, 7.0, 27.0, -6.0, -2.0, 18.0, 23.0, 40.0, 4.0, 9.0, 19.0, 21.0, -4.0, 20.0, 10.0, -29.0, -17.0, 40.0, -1.0, 40.0, -1.0, -17.0, 26.0, 26.0, 0.0, -3.0, 80.0, -6.0, 20.0, 36.0, 30.0, 24.0, 19.0, -8.0, 10.0, -13.0, -17.0, 10.0, 0.0, 19.0, 28.0, 0.0, 40.0, 30.0, 68.0, 10.0, 6.0, -4.0, 40.0, 70.0, 70.0, 40.0, 30.0, 30.0, 50.0, 20.0, 18.0, -105.0, 250.0, 7.0, 37.0, 40.0, 10.0, 20.0, 14.0, 16.0, 70.0, 30.0, 6.0, -16.0, 60.0, -131.0, 280.0, 5.0, 18.0, -4.0, -28.0, 6.0, 20.0, -21.0, -15.0, 20.0, 7.0, 10.0, -4.0, 0.0, -13.0, 6.0, 62.0, -4.0, -21.0, 52.0, 0.0, 51.0, -5.0, -4.0, 8.0, -15.0, 3.0, 30.0, -2.0, -18.0, 40.0, -33.0, 10.0, 60.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, -23.0, 50.0, 20.0, 39.0, -29.0, 30.0, 160.0, 11.0, -6.0, -12.0, 32.0, 60.0, 23.0, 1.0, 80.0, -33.0, -3.0, 0.0, -11.0, 30.0, -6.0, 9.0, 0.0, 18.0, 0.0, 4.0, -9.0, -10.0, 21.0, -2.0, -5.0, 7.0, -23.0, 10.0, -3.0, 38.0, 7.0, 13.0, 3.0, 12.0, -7.0, 36.0, 4.0, 20.0, 9.0, -7.0, 30.0, 8.0, 20.0, -17.0, 50.0, 6.0, 30.0, -31.0, -3.0, 10.0, 50.0, 20.0, 50.0, 160.0, 244.0, -6.0, 27.0, 36.0, 10.0, 40.0, -9.0, -54.0, 47.0, 33.0, 14.0, 30.0, 20.0, 17.0, 20.0, 1.0, 60.0, 60.0, 7.0, -6.0, 30.0, 0.0, 60.0, 0.0, 15.0, -14.0, 16.0, 3.0, -6.0, 20.0, 5.0, 32.0, 20.0, 23.0, -16.0, -25.0, 49.0, 13.0, -3.0, 34.0, 20.0, -14.0, -9.0, 3.0, -57.0, 7.0, 67.0, -3.0, 30.0, 250.0, 90.0, 4.0, -30.0, 10.0, 390.0, 10.0, 50.0, 40.0, 40.0, 50.0, -16.0, 660.0, -41.0, -42.0, 10.0, -94.0, -68.0, -132.0, 10.0, 15.0, -5.0, 15.0, 25.0, 25.0, 5.0, 0.0, -1.0, 6.0, -6.0, 30.0, 0.0, 35.0, -27.0, -15.0, 5.0, -2.0, 11.0, -21.0, -2.0, 30.0, 0.0, -9.0, -7.0, 28.0, 50.0, -3.0, 30.0, 3.0, -8.0, 20.0, 11.0, 10.0, -3.0, -10.0, -15.0, -12.0, 10.0, -7.0, 12.0, 32.0, -5.0, 60.0, 30.0, -12.0, 10.0, 30.0, 20.0, 19.0, 50.0, 50.0, 158.0, 32.0, 3.0, -34.0, 10.0, 6.0, -45.0, 49.0, -39.0, 78.0, 15.0, 50.0, 16.0, 37.0, 150.0, 40.0, -1.0, 52.0, 30.0, 65.0, -2.0, 60.0, -12.0, 20.0, 28.0, 0.0, 50.0, 50.0, -16.0, 127.0, -6.0, 0.0, -46.0, -6.0, 30.0, 50.0, 4.0, 90.0, 33.0, 250.0, 34.0, 49.0, 19.0, 0.0, 9.0, 8.0, 20.0, 70.0, 25.0, 12.0, -6.0, 30.0, -10.0, 27.0, 20.0, 27.0, 34.0, 1.0, -1.0, 55.0, 0.0, -3.0, 15.0, 0.0, 50.0, 60.0, 10.0, 5.0, 70.0, -10.0, 63.0, 20.0, 30.0, -7.0, 44.0, 15.0, 2.0, 1.0, 10.0, 6.0, -10.0, -24.0, 25.0, -1.0, 9.0, 50.0, -6.0, -20.0, -11.0, -16.0, 23.0, 60.0, -25.0, -137.0, 18.0, 20.0, 151.0, 30.0, 20.0, -22.0, 13.0, 35.0, 200.0, 30.0, 6.0, 80.0, 36.0, 50.0, 27.0, 12.0, 20.0, 24.0, 10.0, -18.0, 10.0, 60.0, -2.0, 24.0, 10.0, 20.0, 40.0, 39.0, 30.0, 0.0, 34.0, 25.0, 26.0, 30.0, 0.0, 28.0, -12.0, 60.0, -1.0, -38.0, 0.0, -14.0, -18.0, -41.0, -14.0, 2.0, 40.0, 50.0, 150.0, 20.0, -3.0, 9.0, 18.0, 6.0, 60.0, 20.0, 14.0, 490.0, -26.0, 29.0, -11.0, 32.0, 153.0, 2.0, 41.0, -90.0, 10.0, 14.0, 29.0, 160.0, 15.0, -11.0, -9.0, -62.0, 35.0, -13.0, 60.0, -7.0, 49.0, -30.0, 35.0, 40.0, 15.0, 160.0, 79.0, -14.0, 22.0, 26.0, 28.0, 76.0, 5.0, 5.0, 260.0, 12.0, 20.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.611938479236908, "mean_inference_ms": 3.034008613510155, "mean_action_processing_ms": 0.9723168074718512, "mean_env_wait_ms": 2.073268214633815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0903787612915039, "StateBufferConnector_ms": 0.018466711044311523, "ViewRequirementAgentConnector_ms": 0.5973482131958008}, "num_episodes": 18, "episode_return_max": 977.0, "episode_return_min": -76.0, "episode_return_mean": 274.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.065937399845865, "num_env_steps_trained_throughput_per_sec": 33.065937399845865, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 122287.458, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122287.405, "sample_time_ms": 3147.278, "learn_time_ms": 119115.971, "learn_throughput": 33.581, "synch_weights_time_ms": 13.42}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 31, "trial_id": "6085c_00000", "date": "2024-07-02_00-01-23", "timestamp": 1719892883, "time_this_iter_s": 120.98023986816406, "time_total_s": 5730.987418889999, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x322cb2af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5730.987418889999, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 29.20175438596491, "ram_util_percent": 78.87426900584795}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.070092788836954, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.421909694067333, "policy_loss": -0.0029898066720573176, "vf_loss": 5.4237768056928415, "vf_explained_var": 0.01498040735277251, "kl": 0.01122693827352264, "entropy": 1.7704412448139617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 977.0, "episode_reward_min": -76.0, "episode_reward_mean": 273.61, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -151.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 27.361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [468.0, 577.0, 453.0, 420.0, 151.0, 441.0, 496.0, 232.0, 142.0, 318.0, 317.0, 296.0, 127.0, 75.0, 525.0, 374.0, 190.0, 649.0, 194.0, 142.0, 449.0, 609.0, 166.0, 341.0, 733.0, 463.0, 296.0, 617.0, 258.0, 464.0, 159.0, 26.0, 977.0, 122.0, 148.0, 77.0, 192.0, 107.0, 360.0, 347.0, 334.0, 13.0, 129.0, 4.0, 160.0, 240.0, 179.0, 25.0, 59.0, 96.0, 342.0, 368.0, 223.0, 124.0, 132.0, 294.0, 654.0, 302.0, 94.0, 14.0, 104.0, 28.0, 252.0, 218.0, 454.0, 305.0, 399.0, 246.0, 177.0, 197.0, 184.0, -4.0, 138.0, 489.0, 158.0, 252.0, -76.0, 370.0, 634.0, 168.0, 387.0, 476.0, 202.0, 457.0, 520.0, 45.0, 191.0, 559.0, 163.0, 115.0, 48.0, 198.0, 454.0, 214.0, 216.0, 129.0, 135.0, 317.0, 426.0, 132.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 30.0, 25.0, 80.0, 20.0, 19.0, 0.0, 250.0, 8.0, -4.0, 245.0, 20.0, 27.0, 19.0, 267.0, 10.0, 27.0, -36.0, 6.0, -8.0, 37.0, -10.0, 150.0, 29.0, 40.0, 40.0, 237.0, -8.0, -12.0, -50.0, 70.0, 17.0, 60.0, 35.0, 60.0, -14.0, -6.0, 30.0, 25.0, 143.0, 7.0, 32.0, -1.0, -1.0, 48.0, 28.0, -14.0, 6.0, 9.0, 37.0, 8.0, 0.0, 187.0, 2.0, -14.0, 180.0, 20.0, 10.0, 0.0, 48.0, -40.0, -130.0, 0.0, -46.0, 580.0, 2.0, -19.0, 19.0, 100.0, 30.0, 28.0, 40.0, 90.0, 40.0, -18.0, 25.0, -17.0, 0.0, 7.0, 37.0, 19.0, 6.0, 39.0, -12.0, 20.0, -7.0, 20.0, 20.0, 29.0, 8.0, 23.0, 18.0, -73.0, 1.0, 60.0, -3.0, 10.0, 250.0, 5.0, 27.0, 649.0, -17.0, -40.0, -151.0, -18.0, 6.0, 20.0, -40.0, 13.0, -105.0, 29.0, 8.0, 29.0, -2.0, 160.0, 60.0, 0.0, 1.0, 11.0, 0.0, 20.0, 6.0, 17.0, 30.0, 6.0, 3.0, 16.0, 9.0, 20.0, 0.0, 17.0, 18.0, 40.0, 6.0, -2.0, 10.0, -6.0, -7.0, 20.0, -21.0, 60.0, -21.0, 160.0, 20.0, 70.0, -41.0, 30.0, 20.0, 17.0, 210.0, 7.0, 50.0, 7.0, 60.0, 170.0, 25.0, 7.0, 8.0, 0.0, 40.0, 30.0, -7.0, -8.0, 9.0, 0.0, 80.0, 30.0, -1.0, 8.0, 49.0, 70.0, -6.0, 20.0, -4.0, 30.0, 29.0, 49.0, 360.0, -40.0, 141.0, 17.0, -7.0, -56.0, 10.0, 170.0, -1.0, 40.0, 5.0, 16.0, 0.0, -7.0, 4.0, 11.0, 50.0, -2.0, -8.0, -2.0, -2.0, 49.0, 49.0, 150.0, 158.0, 30.0, 0.0, 26.0, 0.0, 30.0, 40.0, 15.0, 0.0, 39.0, 21.0, 16.0, 40.0, 350.0, 10.0, 4.0, 134.0, 13.0, -18.0, 16.0, 0.0, 28.0, 40.0, -1.0, 26.0, 14.0, 0.0, 40.0, 3.0, 180.0, -7.0, 38.0, -4.0, -1.0, 90.0, 10.0, 10.0, 20.0, 5.0, 1.0, 170.0, 379.0, 17.0, 150.0, 16.0, 9.0, -33.0, -36.0, 60.0, 5.0, 17.0, 20.0, 30.0, 160.0, 58.0, 4.0, 10.0, 150.0, 9.0, 70.0, -7.0, 70.0, -6.0, 45.0, 20.0, 30.0, 40.0, 20.0, 14.0, 50.0, 180.0, 6.0, 0.0, 180.0, -20.0, -10.0, 60.0, -9.0, 180.0, 60.0, 20.0, 50.0, 18.0, 6.0, 36.0, 10.0, 40.0, -2.0, 20.0, 30.0, 60.0, 40.0, 22.0, 44.0, 190.0, 10.0, 0.0, 50.0, 18.0, 50.0, -22.0, 17.0, 60.0, 10.0, 30.0, 27.0, -14.0, -24.0, 25.0, 37.0, -8.0, 5.0, -31.0, 4.0, -11.0, 18.0, -5.0, -3.0, 20.0, -40.0, 50.0, 100.0, 410.0, 162.0, 30.0, 10.0, 70.0, 116.0, 69.0, -2.0, 7.0, 30.0, -1.0, -3.0, 15.0, 48.0, 7.0, 27.0, -6.0, -2.0, 18.0, 23.0, 40.0, 4.0, 9.0, 19.0, 21.0, -4.0, 20.0, 10.0, -29.0, -17.0, 40.0, -1.0, 40.0, -1.0, -17.0, 26.0, 26.0, 0.0, -3.0, 80.0, -6.0, 20.0, 36.0, 30.0, 24.0, 19.0, -8.0, 10.0, -13.0, -17.0, 10.0, 0.0, 19.0, 28.0, 0.0, 40.0, 30.0, 68.0, 10.0, 6.0, -4.0, 40.0, 70.0, 70.0, 40.0, 30.0, 30.0, 50.0, 20.0, 18.0, -105.0, 250.0, 7.0, 37.0, 40.0, 10.0, 20.0, 14.0, 16.0, 70.0, 30.0, 6.0, -16.0, 60.0, -131.0, 280.0, 5.0, 18.0, -4.0, -28.0, 6.0, 20.0, -21.0, -15.0, 20.0, 7.0, 10.0, -4.0, 0.0, -13.0, 6.0, 62.0, -4.0, -21.0, 52.0, 0.0, 51.0, -5.0, -4.0, 8.0, -15.0, 3.0, 30.0, -2.0, -18.0, 40.0, -33.0, 10.0, 60.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, -23.0, 50.0, 20.0, 39.0, -29.0, 30.0, 160.0, 11.0, -6.0, -12.0, 32.0, 60.0, 23.0, 1.0, 80.0, -33.0, -3.0, 0.0, -11.0, 30.0, -6.0, 9.0, 0.0, 18.0, 0.0, 4.0, -9.0, -10.0, 21.0, -2.0, -5.0, 7.0, -23.0, 10.0, -3.0, 38.0, 7.0, 13.0, 3.0, 12.0, -7.0, 36.0, 4.0, 20.0, 9.0, -7.0, 30.0, 8.0, 20.0, -17.0, 50.0, 6.0, 30.0, -31.0, -3.0, 10.0, 50.0, 20.0, 50.0, 160.0, 244.0, -6.0, 27.0, 36.0, 10.0, 40.0, -9.0, -54.0, 47.0, 33.0, 14.0, 30.0, 20.0, 17.0, 20.0, 1.0, 60.0, 60.0, 7.0, -6.0, 30.0, 0.0, 60.0, 0.0, 15.0, -14.0, 16.0, 3.0, -6.0, 20.0, 5.0, 32.0, 20.0, 23.0, -16.0, -25.0, 49.0, 13.0, -3.0, 34.0, 20.0, -14.0, -9.0, 3.0, -57.0, 7.0, 67.0, -3.0, 30.0, 250.0, 90.0, 4.0, -30.0, 10.0, 390.0, 10.0, 50.0, 40.0, 40.0, 50.0, -16.0, 660.0, -41.0, -42.0, 10.0, -94.0, -68.0, -132.0, 10.0, 15.0, -5.0, 15.0, 25.0, 25.0, 5.0, 0.0, -1.0, 6.0, -6.0, 30.0, 0.0, 35.0, -27.0, -15.0, 5.0, -2.0, 11.0, -21.0, -2.0, 30.0, 0.0, -9.0, -7.0, 28.0, 50.0, -3.0, 30.0, 3.0, -8.0, 20.0, 11.0, 10.0, -3.0, -10.0, -15.0, -12.0, 10.0, -7.0, 12.0, 32.0, -5.0, 60.0, 30.0, -12.0, 10.0, 30.0, 20.0, 19.0, 50.0, 50.0, 158.0, 32.0, 3.0, -34.0, 10.0, 6.0, -45.0, 49.0, -39.0, 78.0, 15.0, 50.0, 16.0, 37.0, 150.0, 40.0, -1.0, 52.0, 30.0, 65.0, -2.0, 60.0, -12.0, 20.0, 28.0, 0.0, 50.0, 50.0, -16.0, 127.0, -6.0, 0.0, -46.0, -6.0, 30.0, 50.0, 4.0, 90.0, 33.0, 250.0, 34.0, 49.0, 19.0, 0.0, 9.0, 8.0, 20.0, 70.0, 25.0, 12.0, -6.0, 30.0, -10.0, 27.0, 20.0, 27.0, 34.0, 1.0, -1.0, 55.0, 0.0, -3.0, 15.0, 0.0, 50.0, 60.0, 10.0, 5.0, 70.0, -10.0, 63.0, 20.0, 30.0, -7.0, 44.0, 15.0, 2.0, 1.0, 10.0, 6.0, -10.0, -24.0, 25.0, -1.0, 9.0, 50.0, -6.0, -20.0, -11.0, -16.0, 23.0, 60.0, -25.0, -137.0, 18.0, 20.0, 151.0, 30.0, 20.0, -22.0, 13.0, 35.0, 200.0, 30.0, 6.0, 80.0, 36.0, 50.0, 27.0, 12.0, 20.0, 24.0, 10.0, -18.0, 10.0, 60.0, -2.0, 24.0, 10.0, 20.0, 40.0, 39.0, 30.0, 0.0, 34.0, 25.0, 26.0, 30.0, 0.0, 28.0, -12.0, 60.0, -1.0, -38.0, 0.0, -14.0, -18.0, -41.0, -14.0, 2.0, 40.0, 50.0, 150.0, 20.0, -3.0, 9.0, 18.0, 6.0, 60.0, 20.0, 14.0, 490.0, -26.0, 29.0, -11.0, 32.0, 153.0, 2.0, 41.0, -90.0, 10.0, 14.0, 29.0, 160.0, 15.0, -11.0, -9.0, -62.0, 35.0, -13.0, 60.0, -7.0, 49.0, -30.0, 35.0, 40.0, 15.0, 160.0, 79.0, -14.0, 22.0, 26.0, 28.0, 76.0, 5.0, 5.0, 260.0, 12.0, 20.0, 22.0, 0.0, -12.0, 40.0, 1.0, -21.0, 150.0, -10.0, 4.0, 34.0, 16.0, 20.0, 39.0, 29.0, 27.0, 30.0, 47.0, 150.0, 35.0, 50.0, 30.0, 2.0, 10.0, 50.0, 50.0, 180.0, -22.0, -32.0, 70.0, 200.0, 12.0, 40.0, -13.0, 1.0, -17.0, -3.0, 0.0, 32.0, 25.0, -6.0, -14.0, 14.0, 3.0, 50.0, 6.0, 25.0, 39.0, -7.0, 34.0, 10.0, 17.0, 18.0, 40.0, 150.0, 170.0, 85.0, -4.0, 20.0, 50.0, 30.0, 0.0, -6.0, -13.0, 5.0, 3.0, -1.0, 90.0, 30.0, 26.0, 50.0, -21.0, -2.0, 1.0, -9.0, -29.0, 150.0, 50.0, -28.0, -33.0, -4.0, 19.0, 6.0, 60.0, -130.0, 10.0, 12.0, 50.0, 14.0, 14.0, 8.0, 4.0, 0.0, -9.0, 38.0, -13.0, 57.0, 26.0, -7.0, 59.0, -3.0, 50.0, 40.0, 50.0, 30.0, -44.0, 17.0, 350.0, 9.0, -33.0, 20.0, 15.0, 28.0, 9.0, 50.0, 20.0, 5.0, 6.0, 31.0, 51.0, 10.0, 4.0, -1.0, 25.0, 30.0, 4.0, 15.0, 28.0, 30.0, 50.0, 48.0, -13.0, 40.0, 0.0, 22.0, 29.0, -15.0, -15.0, 14.0, 30.0, 3.0, 21.0, 14.0, 37.0, 10.0, -14.0, 30.0, -1.0, 20.0, 33.0, 6.0, 0.0, 13.0, -10.0, -3.0, 17.0, 5.0, 10.0, 80.0, 22.0, 170.0, 13.0, 70.0, 40.0, -3.0, -34.0, 27.0, 30.0, 260.0, -12.0, 38.0, 10.0, -1.0, 60.0, -10.0, 19.0, -4.0, 5.0, 25.0, 20.0, 0.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5856851283256517, "mean_inference_ms": 3.000400894396032, "mean_action_processing_ms": 0.9625926700086889, "mean_env_wait_ms": 2.0521175156799996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09189009666442871, "StateBufferConnector_ms": 0.018627405166625977, "ViewRequirementAgentConnector_ms": 0.5288846492767334}, "num_episodes": 18, "episode_return_max": 977.0, "episode_return_min": -76.0, "episode_return_mean": 273.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.89093487984177, "num_env_steps_trained_throughput_per_sec": 32.89093487984177, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 121996.012, "restore_workers_time_ms": 0.015, "training_step_time_ms": 121995.959, "sample_time_ms": 3023.262, "learn_time_ms": 118949.026, "learn_throughput": 33.628, "synch_weights_time_ms": 13.151}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 32, "trial_id": "6085c_00000", "date": "2024-07-02_00-03-25", "timestamp": 1719893005, "time_this_iter_s": 121.62504696846008, "time_total_s": 5852.6124658584595, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e5040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5852.6124658584595, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 28.758139534883718, "ram_util_percent": 80.36627906976744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.222368587053622, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.287986095314716, "policy_loss": -0.004216073509241247, "vf_loss": 5.290984783157373, "vf_explained_var": 0.014618785427020381, "kl": 0.012173815230062278, "entropy": 1.758921965953514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 305175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 977.0, "episode_reward_min": -76.0, "episode_reward_mean": 260.73, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -141.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 26.073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [166.0, 341.0, 733.0, 463.0, 296.0, 617.0, 258.0, 464.0, 159.0, 26.0, 977.0, 122.0, 148.0, 77.0, 192.0, 107.0, 360.0, 347.0, 334.0, 13.0, 129.0, 4.0, 160.0, 240.0, 179.0, 25.0, 59.0, 96.0, 342.0, 368.0, 223.0, 124.0, 132.0, 294.0, 654.0, 302.0, 94.0, 14.0, 104.0, 28.0, 252.0, 218.0, 454.0, 305.0, 399.0, 246.0, 177.0, 197.0, 184.0, -4.0, 138.0, 489.0, 158.0, 252.0, -76.0, 370.0, 634.0, 168.0, 387.0, 476.0, 202.0, 457.0, 520.0, 45.0, 191.0, 559.0, 163.0, 115.0, 48.0, 198.0, 454.0, 214.0, 216.0, 129.0, 135.0, 317.0, 426.0, 132.0, 361.0, 256.0, 168.0, 499.0, 297.0, 192.0, 326.0, 295.0, 299.0, 259.0, 251.0, 354.0, 512.0, 594.0, 189.0, 177.0, 126.0, 174.0, 584.0, 154.0, 131.0, 159.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [16.0, 0.0, 28.0, 40.0, -1.0, 26.0, 14.0, 0.0, 40.0, 3.0, 180.0, -7.0, 38.0, -4.0, -1.0, 90.0, 10.0, 10.0, 20.0, 5.0, 1.0, 170.0, 379.0, 17.0, 150.0, 16.0, 9.0, -33.0, -36.0, 60.0, 5.0, 17.0, 20.0, 30.0, 160.0, 58.0, 4.0, 10.0, 150.0, 9.0, 70.0, -7.0, 70.0, -6.0, 45.0, 20.0, 30.0, 40.0, 20.0, 14.0, 50.0, 180.0, 6.0, 0.0, 180.0, -20.0, -10.0, 60.0, -9.0, 180.0, 60.0, 20.0, 50.0, 18.0, 6.0, 36.0, 10.0, 40.0, -2.0, 20.0, 30.0, 60.0, 40.0, 22.0, 44.0, 190.0, 10.0, 0.0, 50.0, 18.0, 50.0, -22.0, 17.0, 60.0, 10.0, 30.0, 27.0, -14.0, -24.0, 25.0, 37.0, -8.0, 5.0, -31.0, 4.0, -11.0, 18.0, -5.0, -3.0, 20.0, -40.0, 50.0, 100.0, 410.0, 162.0, 30.0, 10.0, 70.0, 116.0, 69.0, -2.0, 7.0, 30.0, -1.0, -3.0, 15.0, 48.0, 7.0, 27.0, -6.0, -2.0, 18.0, 23.0, 40.0, 4.0, 9.0, 19.0, 21.0, -4.0, 20.0, 10.0, -29.0, -17.0, 40.0, -1.0, 40.0, -1.0, -17.0, 26.0, 26.0, 0.0, -3.0, 80.0, -6.0, 20.0, 36.0, 30.0, 24.0, 19.0, -8.0, 10.0, -13.0, -17.0, 10.0, 0.0, 19.0, 28.0, 0.0, 40.0, 30.0, 68.0, 10.0, 6.0, -4.0, 40.0, 70.0, 70.0, 40.0, 30.0, 30.0, 50.0, 20.0, 18.0, -105.0, 250.0, 7.0, 37.0, 40.0, 10.0, 20.0, 14.0, 16.0, 70.0, 30.0, 6.0, -16.0, 60.0, -131.0, 280.0, 5.0, 18.0, -4.0, -28.0, 6.0, 20.0, -21.0, -15.0, 20.0, 7.0, 10.0, -4.0, 0.0, -13.0, 6.0, 62.0, -4.0, -21.0, 52.0, 0.0, 51.0, -5.0, -4.0, 8.0, -15.0, 3.0, 30.0, -2.0, -18.0, 40.0, -33.0, 10.0, 60.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, -23.0, 50.0, 20.0, 39.0, -29.0, 30.0, 160.0, 11.0, -6.0, -12.0, 32.0, 60.0, 23.0, 1.0, 80.0, -33.0, -3.0, 0.0, -11.0, 30.0, -6.0, 9.0, 0.0, 18.0, 0.0, 4.0, -9.0, -10.0, 21.0, -2.0, -5.0, 7.0, -23.0, 10.0, -3.0, 38.0, 7.0, 13.0, 3.0, 12.0, -7.0, 36.0, 4.0, 20.0, 9.0, -7.0, 30.0, 8.0, 20.0, -17.0, 50.0, 6.0, 30.0, -31.0, -3.0, 10.0, 50.0, 20.0, 50.0, 160.0, 244.0, -6.0, 27.0, 36.0, 10.0, 40.0, -9.0, -54.0, 47.0, 33.0, 14.0, 30.0, 20.0, 17.0, 20.0, 1.0, 60.0, 60.0, 7.0, -6.0, 30.0, 0.0, 60.0, 0.0, 15.0, -14.0, 16.0, 3.0, -6.0, 20.0, 5.0, 32.0, 20.0, 23.0, -16.0, -25.0, 49.0, 13.0, -3.0, 34.0, 20.0, -14.0, -9.0, 3.0, -57.0, 7.0, 67.0, -3.0, 30.0, 250.0, 90.0, 4.0, -30.0, 10.0, 390.0, 10.0, 50.0, 40.0, 40.0, 50.0, -16.0, 660.0, -41.0, -42.0, 10.0, -94.0, -68.0, -132.0, 10.0, 15.0, -5.0, 15.0, 25.0, 25.0, 5.0, 0.0, -1.0, 6.0, -6.0, 30.0, 0.0, 35.0, -27.0, -15.0, 5.0, -2.0, 11.0, -21.0, -2.0, 30.0, 0.0, -9.0, -7.0, 28.0, 50.0, -3.0, 30.0, 3.0, -8.0, 20.0, 11.0, 10.0, -3.0, -10.0, -15.0, -12.0, 10.0, -7.0, 12.0, 32.0, -5.0, 60.0, 30.0, -12.0, 10.0, 30.0, 20.0, 19.0, 50.0, 50.0, 158.0, 32.0, 3.0, -34.0, 10.0, 6.0, -45.0, 49.0, -39.0, 78.0, 15.0, 50.0, 16.0, 37.0, 150.0, 40.0, -1.0, 52.0, 30.0, 65.0, -2.0, 60.0, -12.0, 20.0, 28.0, 0.0, 50.0, 50.0, -16.0, 127.0, -6.0, 0.0, -46.0, -6.0, 30.0, 50.0, 4.0, 90.0, 33.0, 250.0, 34.0, 49.0, 19.0, 0.0, 9.0, 8.0, 20.0, 70.0, 25.0, 12.0, -6.0, 30.0, -10.0, 27.0, 20.0, 27.0, 34.0, 1.0, -1.0, 55.0, 0.0, -3.0, 15.0, 0.0, 50.0, 60.0, 10.0, 5.0, 70.0, -10.0, 63.0, 20.0, 30.0, -7.0, 44.0, 15.0, 2.0, 1.0, 10.0, 6.0, -10.0, -24.0, 25.0, -1.0, 9.0, 50.0, -6.0, -20.0, -11.0, -16.0, 23.0, 60.0, -25.0, -137.0, 18.0, 20.0, 151.0, 30.0, 20.0, -22.0, 13.0, 35.0, 200.0, 30.0, 6.0, 80.0, 36.0, 50.0, 27.0, 12.0, 20.0, 24.0, 10.0, -18.0, 10.0, 60.0, -2.0, 24.0, 10.0, 20.0, 40.0, 39.0, 30.0, 0.0, 34.0, 25.0, 26.0, 30.0, 0.0, 28.0, -12.0, 60.0, -1.0, -38.0, 0.0, -14.0, -18.0, -41.0, -14.0, 2.0, 40.0, 50.0, 150.0, 20.0, -3.0, 9.0, 18.0, 6.0, 60.0, 20.0, 14.0, 490.0, -26.0, 29.0, -11.0, 32.0, 153.0, 2.0, 41.0, -90.0, 10.0, 14.0, 29.0, 160.0, 15.0, -11.0, -9.0, -62.0, 35.0, -13.0, 60.0, -7.0, 49.0, -30.0, 35.0, 40.0, 15.0, 160.0, 79.0, -14.0, 22.0, 26.0, 28.0, 76.0, 5.0, 5.0, 260.0, 12.0, 20.0, 22.0, 0.0, -12.0, 40.0, 1.0, -21.0, 150.0, -10.0, 4.0, 34.0, 16.0, 20.0, 39.0, 29.0, 27.0, 30.0, 47.0, 150.0, 35.0, 50.0, 30.0, 2.0, 10.0, 50.0, 50.0, 180.0, -22.0, -32.0, 70.0, 200.0, 12.0, 40.0, -13.0, 1.0, -17.0, -3.0, 0.0, 32.0, 25.0, -6.0, -14.0, 14.0, 3.0, 50.0, 6.0, 25.0, 39.0, -7.0, 34.0, 10.0, 17.0, 18.0, 40.0, 150.0, 170.0, 85.0, -4.0, 20.0, 50.0, 30.0, 0.0, -6.0, -13.0, 5.0, 3.0, -1.0, 90.0, 30.0, 26.0, 50.0, -21.0, -2.0, 1.0, -9.0, -29.0, 150.0, 50.0, -28.0, -33.0, -4.0, 19.0, 6.0, 60.0, -130.0, 10.0, 12.0, 50.0, 14.0, 14.0, 8.0, 4.0, 0.0, -9.0, 38.0, -13.0, 57.0, 26.0, -7.0, 59.0, -3.0, 50.0, 40.0, 50.0, 30.0, -44.0, 17.0, 350.0, 9.0, -33.0, 20.0, 15.0, 28.0, 9.0, 50.0, 20.0, 5.0, 6.0, 31.0, 51.0, 10.0, 4.0, -1.0, 25.0, 30.0, 4.0, 15.0, 28.0, 30.0, 50.0, 48.0, -13.0, 40.0, 0.0, 22.0, 29.0, -15.0, -15.0, 14.0, 30.0, 3.0, 21.0, 14.0, 37.0, 10.0, -14.0, 30.0, -1.0, 20.0, 33.0, 6.0, 0.0, 13.0, -10.0, -3.0, 17.0, 5.0, 10.0, 80.0, 22.0, 170.0, 13.0, 70.0, 40.0, -3.0, -34.0, 27.0, 30.0, 260.0, -12.0, 38.0, 10.0, -1.0, 60.0, -10.0, 19.0, -4.0, 5.0, 25.0, 20.0, 0.0, 18.0, 46.0, 38.0, 20.0, 40.0, -31.0, -4.0, 200.0, 0.0, 17.0, 35.0, 5.0, 1.0, -6.0, 30.0, 22.0, 10.0, 8.0, 30.0, 6.0, 150.0, 46.0, 60.0, 18.0, -4.0, -6.0, 15.0, 40.0, 9.0, -4.0, -6.0, 58.0, 0.0, 50.0, -10.0, 20.0, 287.0, -37.0, 48.0, 43.0, 40.0, 48.0, 46.0, 0.0, 9.0, 12.0, 60.0, 51.0, 43.0, 169.0, -141.0, 0.0, -38.0, 30.0, -7.0, 16.0, 26.0, -2.0, 50.0, 47.0, 70.0, 39.0, 14.0, 40.0, 28.0, 16.0, 21.0, 120.0, 20.0, 36.0, -8.0, 20.0, 38.0, 24.0, 57.0, -25.0, 23.0, 49.0, 20.0, 50.0, 39.0, 39.0, 34.0, 5.0, 6.0, 40.0, 2.0, 30.0, 0.0, 5.0, 138.0, 29.0, 170.0, 10.0, 33.0, 20.0, 15.0, 19.0, 21.0, -70.0, 12.0, 20.0, 50.0, 50.0, 6.0, 25.0, 34.0, 26.0, -4.0, 4.0, 40.0, 30.0, 0.0, 50.0, 49.0, -30.0, 60.0, 28.0, 160.0, 9.0, -2.0, 40.0, 290.0, -15.0, 30.0, 20.0, 10.0, -3.0, 120.0, 40.0, -20.0, 249.0, 16.0, 34.0, 30.0, -5.0, 60.0, 60.0, 30.0, 50.0, 70.0, 20.0, -1.0, 20.0, 48.0, 2.0, 39.0, 4.0, 10.0, 27.0, 20.0, 26.0, 12.0, 40.0, -2.0, -2.0, 70.0, 19.0, -4.0, 22.0, -4.0, 0.0, 5.0, -15.0, 20.0, -6.0, 40.0, 60.0, 17.0, 10.0, -5.0, 7.0, 42.0, 20.0, 19.0, 28.0, 20.0, 10.0, -17.0, 30.0, 15.0, 20.0, 23.0, -8.0, 43.0, 150.0, -31.0, 60.0, 17.0, 260.0, 50.0, 15.0, 6.0, -5.0, 0.0, 12.0, 4.0, 7.0, 37.0, 8.0, 70.0, 30.0, -4.0, 7.0, 32.0, 10.0, 67.0, -6.0, 10.0, 2.0, -17.0, 60.0, 14.0, 5.0, -7.0, -29.0, -17.0, 26.0, 11.0, 26.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5597701844550045, "mean_inference_ms": 2.9571302478008135, "mean_action_processing_ms": 0.9448362136602833, "mean_env_wait_ms": 2.0281192647517345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0827484130859375, "StateBufferConnector_ms": 0.018652915954589844, "ViewRequirementAgentConnector_ms": 0.532541036605835}, "num_episodes": 22, "episode_return_max": 977.0, "episode_return_min": -76.0, "episode_return_mean": 260.73, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.20809948360576, "num_env_steps_trained_throughput_per_sec": 33.20809948360576, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 121773.315, "restore_workers_time_ms": 0.015, "training_step_time_ms": 121773.259, "sample_time_ms": 3017.001, "learn_time_ms": 118732.392, "learn_throughput": 33.689, "synch_weights_time_ms": 13.302}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 33, "trial_id": "6085c_00000", "date": "2024-07-02_00-05-25", "timestamp": 1719893125, "time_this_iter_s": 120.46307182312012, "time_total_s": 5973.07553768158, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x322cb29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5973.07553768158, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 28.455882352941178, "ram_util_percent": 79.23058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.325996764158162, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.749870292167948, "policy_loss": -0.005361869042249311, "vf_loss": 5.754053370818036, "vf_explained_var": 0.008686165376720083, "kl": 0.011787865170896224, "entropy": 1.760725712217589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 314565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 654.0, "episode_reward_min": -76.0, "episode_reward_mean": 263.34, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -141.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 26.334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [240.0, 179.0, 25.0, 59.0, 96.0, 342.0, 368.0, 223.0, 124.0, 132.0, 294.0, 654.0, 302.0, 94.0, 14.0, 104.0, 28.0, 252.0, 218.0, 454.0, 305.0, 399.0, 246.0, 177.0, 197.0, 184.0, -4.0, 138.0, 489.0, 158.0, 252.0, -76.0, 370.0, 634.0, 168.0, 387.0, 476.0, 202.0, 457.0, 520.0, 45.0, 191.0, 559.0, 163.0, 115.0, 48.0, 198.0, 454.0, 214.0, 216.0, 129.0, 135.0, 317.0, 426.0, 132.0, 361.0, 256.0, 168.0, 499.0, 297.0, 192.0, 326.0, 295.0, 299.0, 259.0, 251.0, 354.0, 512.0, 594.0, 189.0, 177.0, 126.0, 174.0, 584.0, 154.0, 131.0, 159.0, 573.0, 90.0, 175.0, 113.0, 544.0, 340.0, 244.0, 402.0, 303.0, 490.0, 308.0, 405.0, 431.0, -13.0, 121.0, 82.0, 436.0, 517.0, 74.0, 216.0, 481.0, 338.0, 84.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-23.0, 50.0, 20.0, 39.0, -29.0, 30.0, 160.0, 11.0, -6.0, -12.0, 32.0, 60.0, 23.0, 1.0, 80.0, -33.0, -3.0, 0.0, -11.0, 30.0, -6.0, 9.0, 0.0, 18.0, 0.0, 4.0, -9.0, -10.0, 21.0, -2.0, -5.0, 7.0, -23.0, 10.0, -3.0, 38.0, 7.0, 13.0, 3.0, 12.0, -7.0, 36.0, 4.0, 20.0, 9.0, -7.0, 30.0, 8.0, 20.0, -17.0, 50.0, 6.0, 30.0, -31.0, -3.0, 10.0, 50.0, 20.0, 50.0, 160.0, 244.0, -6.0, 27.0, 36.0, 10.0, 40.0, -9.0, -54.0, 47.0, 33.0, 14.0, 30.0, 20.0, 17.0, 20.0, 1.0, 60.0, 60.0, 7.0, -6.0, 30.0, 0.0, 60.0, 0.0, 15.0, -14.0, 16.0, 3.0, -6.0, 20.0, 5.0, 32.0, 20.0, 23.0, -16.0, -25.0, 49.0, 13.0, -3.0, 34.0, 20.0, -14.0, -9.0, 3.0, -57.0, 7.0, 67.0, -3.0, 30.0, 250.0, 90.0, 4.0, -30.0, 10.0, 390.0, 10.0, 50.0, 40.0, 40.0, 50.0, -16.0, 660.0, -41.0, -42.0, 10.0, -94.0, -68.0, -132.0, 10.0, 15.0, -5.0, 15.0, 25.0, 25.0, 5.0, 0.0, -1.0, 6.0, -6.0, 30.0, 0.0, 35.0, -27.0, -15.0, 5.0, -2.0, 11.0, -21.0, -2.0, 30.0, 0.0, -9.0, -7.0, 28.0, 50.0, -3.0, 30.0, 3.0, -8.0, 20.0, 11.0, 10.0, -3.0, -10.0, -15.0, -12.0, 10.0, -7.0, 12.0, 32.0, -5.0, 60.0, 30.0, -12.0, 10.0, 30.0, 20.0, 19.0, 50.0, 50.0, 158.0, 32.0, 3.0, -34.0, 10.0, 6.0, -45.0, 49.0, -39.0, 78.0, 15.0, 50.0, 16.0, 37.0, 150.0, 40.0, -1.0, 52.0, 30.0, 65.0, -2.0, 60.0, -12.0, 20.0, 28.0, 0.0, 50.0, 50.0, -16.0, 127.0, -6.0, 0.0, -46.0, -6.0, 30.0, 50.0, 4.0, 90.0, 33.0, 250.0, 34.0, 49.0, 19.0, 0.0, 9.0, 8.0, 20.0, 70.0, 25.0, 12.0, -6.0, 30.0, -10.0, 27.0, 20.0, 27.0, 34.0, 1.0, -1.0, 55.0, 0.0, -3.0, 15.0, 0.0, 50.0, 60.0, 10.0, 5.0, 70.0, -10.0, 63.0, 20.0, 30.0, -7.0, 44.0, 15.0, 2.0, 1.0, 10.0, 6.0, -10.0, -24.0, 25.0, -1.0, 9.0, 50.0, -6.0, -20.0, -11.0, -16.0, 23.0, 60.0, -25.0, -137.0, 18.0, 20.0, 151.0, 30.0, 20.0, -22.0, 13.0, 35.0, 200.0, 30.0, 6.0, 80.0, 36.0, 50.0, 27.0, 12.0, 20.0, 24.0, 10.0, -18.0, 10.0, 60.0, -2.0, 24.0, 10.0, 20.0, 40.0, 39.0, 30.0, 0.0, 34.0, 25.0, 26.0, 30.0, 0.0, 28.0, -12.0, 60.0, -1.0, -38.0, 0.0, -14.0, -18.0, -41.0, -14.0, 2.0, 40.0, 50.0, 150.0, 20.0, -3.0, 9.0, 18.0, 6.0, 60.0, 20.0, 14.0, 490.0, -26.0, 29.0, -11.0, 32.0, 153.0, 2.0, 41.0, -90.0, 10.0, 14.0, 29.0, 160.0, 15.0, -11.0, -9.0, -62.0, 35.0, -13.0, 60.0, -7.0, 49.0, -30.0, 35.0, 40.0, 15.0, 160.0, 79.0, -14.0, 22.0, 26.0, 28.0, 76.0, 5.0, 5.0, 260.0, 12.0, 20.0, 22.0, 0.0, -12.0, 40.0, 1.0, -21.0, 150.0, -10.0, 4.0, 34.0, 16.0, 20.0, 39.0, 29.0, 27.0, 30.0, 47.0, 150.0, 35.0, 50.0, 30.0, 2.0, 10.0, 50.0, 50.0, 180.0, -22.0, -32.0, 70.0, 200.0, 12.0, 40.0, -13.0, 1.0, -17.0, -3.0, 0.0, 32.0, 25.0, -6.0, -14.0, 14.0, 3.0, 50.0, 6.0, 25.0, 39.0, -7.0, 34.0, 10.0, 17.0, 18.0, 40.0, 150.0, 170.0, 85.0, -4.0, 20.0, 50.0, 30.0, 0.0, -6.0, -13.0, 5.0, 3.0, -1.0, 90.0, 30.0, 26.0, 50.0, -21.0, -2.0, 1.0, -9.0, -29.0, 150.0, 50.0, -28.0, -33.0, -4.0, 19.0, 6.0, 60.0, -130.0, 10.0, 12.0, 50.0, 14.0, 14.0, 8.0, 4.0, 0.0, -9.0, 38.0, -13.0, 57.0, 26.0, -7.0, 59.0, -3.0, 50.0, 40.0, 50.0, 30.0, -44.0, 17.0, 350.0, 9.0, -33.0, 20.0, 15.0, 28.0, 9.0, 50.0, 20.0, 5.0, 6.0, 31.0, 51.0, 10.0, 4.0, -1.0, 25.0, 30.0, 4.0, 15.0, 28.0, 30.0, 50.0, 48.0, -13.0, 40.0, 0.0, 22.0, 29.0, -15.0, -15.0, 14.0, 30.0, 3.0, 21.0, 14.0, 37.0, 10.0, -14.0, 30.0, -1.0, 20.0, 33.0, 6.0, 0.0, 13.0, -10.0, -3.0, 17.0, 5.0, 10.0, 80.0, 22.0, 170.0, 13.0, 70.0, 40.0, -3.0, -34.0, 27.0, 30.0, 260.0, -12.0, 38.0, 10.0, -1.0, 60.0, -10.0, 19.0, -4.0, 5.0, 25.0, 20.0, 0.0, 18.0, 46.0, 38.0, 20.0, 40.0, -31.0, -4.0, 200.0, 0.0, 17.0, 35.0, 5.0, 1.0, -6.0, 30.0, 22.0, 10.0, 8.0, 30.0, 6.0, 150.0, 46.0, 60.0, 18.0, -4.0, -6.0, 15.0, 40.0, 9.0, -4.0, -6.0, 58.0, 0.0, 50.0, -10.0, 20.0, 287.0, -37.0, 48.0, 43.0, 40.0, 48.0, 46.0, 0.0, 9.0, 12.0, 60.0, 51.0, 43.0, 169.0, -141.0, 0.0, -38.0, 30.0, -7.0, 16.0, 26.0, -2.0, 50.0, 47.0, 70.0, 39.0, 14.0, 40.0, 28.0, 16.0, 21.0, 120.0, 20.0, 36.0, -8.0, 20.0, 38.0, 24.0, 57.0, -25.0, 23.0, 49.0, 20.0, 50.0, 39.0, 39.0, 34.0, 5.0, 6.0, 40.0, 2.0, 30.0, 0.0, 5.0, 138.0, 29.0, 170.0, 10.0, 33.0, 20.0, 15.0, 19.0, 21.0, -70.0, 12.0, 20.0, 50.0, 50.0, 6.0, 25.0, 34.0, 26.0, -4.0, 4.0, 40.0, 30.0, 0.0, 50.0, 49.0, -30.0, 60.0, 28.0, 160.0, 9.0, -2.0, 40.0, 290.0, -15.0, 30.0, 20.0, 10.0, -3.0, 120.0, 40.0, -20.0, 249.0, 16.0, 34.0, 30.0, -5.0, 60.0, 60.0, 30.0, 50.0, 70.0, 20.0, -1.0, 20.0, 48.0, 2.0, 39.0, 4.0, 10.0, 27.0, 20.0, 26.0, 12.0, 40.0, -2.0, -2.0, 70.0, 19.0, -4.0, 22.0, -4.0, 0.0, 5.0, -15.0, 20.0, -6.0, 40.0, 60.0, 17.0, 10.0, -5.0, 7.0, 42.0, 20.0, 19.0, 28.0, 20.0, 10.0, -17.0, 30.0, 15.0, 20.0, 23.0, -8.0, 43.0, 150.0, -31.0, 60.0, 17.0, 260.0, 50.0, 15.0, 6.0, -5.0, 0.0, 12.0, 4.0, 7.0, 37.0, 8.0, 70.0, 30.0, -4.0, 7.0, 32.0, 10.0, 67.0, -6.0, 10.0, 2.0, -17.0, 60.0, 14.0, 5.0, -7.0, -29.0, -17.0, 26.0, 11.0, 26.0, 70.0, 40.0, 160.0, 53.0, 27.0, 200.0, 7.0, -1.0, 51.0, 30.0, 6.0, -18.0, -31.0, 14.0, 40.0, -9.0, 20.0, 5.0, 49.0, 10.0, 10.0, 3.0, 20.0, -10.0, 20.0, 60.0, -5.0, -18.0, 50.0, 5.0, 50.0, 26.0, 18.0, -5.0, 1.0, 60.0, -15.0, 35.0, -4.0, 11.0, -14.0, -4.0, 30.0, 60.0, 50.0, 30.0, 154.0, 270.0, -7.0, -3.0, -36.0, 30.0, -10.0, -2.0, 30.0, 0.0, 150.0, 25.0, 70.0, 19.0, 28.0, 5.0, 40.0, 28.0, 4.0, -10.0, 40.0, 39.0, 50.0, 10.0, 38.0, 33.0, 29.0, 50.0, 20.0, -56.0, 27.0, 30.0, -21.0, 250.0, 40.0, 14.0, 60.0, -3.0, 100.0, 20.0, 50.0, 0.0, 24.0, 27.0, 11.0, 23.0, 30.0, 40.0, 257.0, -40.0, 30.0, -2.0, 8.0, -26.0, 170.0, 6.0, 15.0, 9.0, 30.0, 60.0, 20.0, 30.0, 13.0, 25.0, 100.0, 70.0, 170.0, -33.0, 40.0, 19.0, 50.0, 50.0, -9.0, 28.0, 20.0, 10.0, 28.0, 259.0, 76.0, 36.0, -3.0, 19.0, 40.0, -43.0, 9.0, 14.0, -34.0, -7.0, -5.0, 5.0, -11.0, 18.0, -10.0, 0.0, 17.0, 16.0, -4.0, 10.0, 18.0, 17.0, 3.0, -6.0, -2.0, 38.0, 31.0, -10.0, 14.0, 18.0, 0.0, 48.0, -17.0, 11.0, 8.0, 10.0, 0.0, -11.0, 40.0, 80.0, 40.0, 90.0, 38.0, -2.0, 160.0, -9.0, 10.0, -60.0, 280.0, 350.0, 40.0, -45.0, -70.0, 2.0, 39.0, 20.0, -39.0, 70.0, -8.0, 50.0, 19.0, 10.0, -39.0, 10.0, -37.0, -31.0, 30.0, 6.0, 19.0, 41.0, 5.0, 30.0, -1.0, 30.0, 38.0, 39.0, 9.0, -12.0, 150.0, 42.0, 100.0, -16.0, 50.0, 37.0, 60.0, 0.0, 70.0, 50.0, 70.0, 6.0, 50.0, 20.0, -15.0, 13.0, 30.0, 25.0, 89.0, 16.0, 30.0, -47.0, 18.0, -7.0, 60.0, 14.0, 18.0, -41.0, 23.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5257342342442697, "mean_inference_ms": 2.924078970726397, "mean_action_processing_ms": 0.9406368782124024, "mean_env_wait_ms": 2.0052340903188237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06744933128356934, "StateBufferConnector_ms": 0.010319232940673828, "ViewRequirementAgentConnector_ms": 0.497941255569458}, "num_episodes": 23, "episode_return_max": 654.0, "episode_return_min": -76.0, "episode_return_mean": 263.34, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.13385836923114, "num_env_steps_trained_throughput_per_sec": 33.13385836923114, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 121666.977, "restore_workers_time_ms": 0.014, "training_step_time_ms": 121666.925, "sample_time_ms": 3030.558, "learn_time_ms": 118613.608, "learn_throughput": 33.723, "synch_weights_time_ms": 13.258}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 34, "trial_id": "6085c_00000", "date": "2024-07-02_00-07-26", "timestamp": 1719893246, "time_this_iter_s": 120.73552203178406, "time_total_s": 6093.811059713364, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b91794c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6093.811059713364, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 28.283040935672513, "ram_util_percent": 79.91754385964911}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.964366432030996, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.448914144849117, "policy_loss": -0.0058544446209508084, "vf_loss": 5.453621111586452, "vf_explained_var": 0.011291013808803945, "kl": 0.011474834443225985, "entropy": 1.7246260361549572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 323955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 1032.0, "episode_reward_min": -76.0, "episode_reward_mean": 282.48, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -141.0}, "policy_reward_max": {"policy_0": 490.0}, "policy_reward_mean": {"policy_0": 28.248}, "custom_metrics": {}, "hist_stats": {"episode_reward": [218.0, 454.0, 305.0, 399.0, 246.0, 177.0, 197.0, 184.0, -4.0, 138.0, 489.0, 158.0, 252.0, -76.0, 370.0, 634.0, 168.0, 387.0, 476.0, 202.0, 457.0, 520.0, 45.0, 191.0, 559.0, 163.0, 115.0, 48.0, 198.0, 454.0, 214.0, 216.0, 129.0, 135.0, 317.0, 426.0, 132.0, 361.0, 256.0, 168.0, 499.0, 297.0, 192.0, 326.0, 295.0, 299.0, 259.0, 251.0, 354.0, 512.0, 594.0, 189.0, 177.0, 126.0, 174.0, 584.0, 154.0, 131.0, 159.0, 573.0, 90.0, 175.0, 113.0, 544.0, 340.0, 244.0, 402.0, 303.0, 490.0, 308.0, 405.0, 431.0, -13.0, 121.0, 82.0, 436.0, 517.0, 74.0, 216.0, 481.0, 338.0, 84.0, 403.0, 234.0, 255.0, 182.0, 253.0, 178.0, 300.0, 502.0, 179.0, 106.0, 9.0, 1032.0, 618.0, 218.0, 170.0, 399.0, 189.0, 217.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [158.0, 32.0, 3.0, -34.0, 10.0, 6.0, -45.0, 49.0, -39.0, 78.0, 15.0, 50.0, 16.0, 37.0, 150.0, 40.0, -1.0, 52.0, 30.0, 65.0, -2.0, 60.0, -12.0, 20.0, 28.0, 0.0, 50.0, 50.0, -16.0, 127.0, -6.0, 0.0, -46.0, -6.0, 30.0, 50.0, 4.0, 90.0, 33.0, 250.0, 34.0, 49.0, 19.0, 0.0, 9.0, 8.0, 20.0, 70.0, 25.0, 12.0, -6.0, 30.0, -10.0, 27.0, 20.0, 27.0, 34.0, 1.0, -1.0, 55.0, 0.0, -3.0, 15.0, 0.0, 50.0, 60.0, 10.0, 5.0, 70.0, -10.0, 63.0, 20.0, 30.0, -7.0, 44.0, 15.0, 2.0, 1.0, 10.0, 6.0, -10.0, -24.0, 25.0, -1.0, 9.0, 50.0, -6.0, -20.0, -11.0, -16.0, 23.0, 60.0, -25.0, -137.0, 18.0, 20.0, 151.0, 30.0, 20.0, -22.0, 13.0, 35.0, 200.0, 30.0, 6.0, 80.0, 36.0, 50.0, 27.0, 12.0, 20.0, 24.0, 10.0, -18.0, 10.0, 60.0, -2.0, 24.0, 10.0, 20.0, 40.0, 39.0, 30.0, 0.0, 34.0, 25.0, 26.0, 30.0, 0.0, 28.0, -12.0, 60.0, -1.0, -38.0, 0.0, -14.0, -18.0, -41.0, -14.0, 2.0, 40.0, 50.0, 150.0, 20.0, -3.0, 9.0, 18.0, 6.0, 60.0, 20.0, 14.0, 490.0, -26.0, 29.0, -11.0, 32.0, 153.0, 2.0, 41.0, -90.0, 10.0, 14.0, 29.0, 160.0, 15.0, -11.0, -9.0, -62.0, 35.0, -13.0, 60.0, -7.0, 49.0, -30.0, 35.0, 40.0, 15.0, 160.0, 79.0, -14.0, 22.0, 26.0, 28.0, 76.0, 5.0, 5.0, 260.0, 12.0, 20.0, 22.0, 0.0, -12.0, 40.0, 1.0, -21.0, 150.0, -10.0, 4.0, 34.0, 16.0, 20.0, 39.0, 29.0, 27.0, 30.0, 47.0, 150.0, 35.0, 50.0, 30.0, 2.0, 10.0, 50.0, 50.0, 180.0, -22.0, -32.0, 70.0, 200.0, 12.0, 40.0, -13.0, 1.0, -17.0, -3.0, 0.0, 32.0, 25.0, -6.0, -14.0, 14.0, 3.0, 50.0, 6.0, 25.0, 39.0, -7.0, 34.0, 10.0, 17.0, 18.0, 40.0, 150.0, 170.0, 85.0, -4.0, 20.0, 50.0, 30.0, 0.0, -6.0, -13.0, 5.0, 3.0, -1.0, 90.0, 30.0, 26.0, 50.0, -21.0, -2.0, 1.0, -9.0, -29.0, 150.0, 50.0, -28.0, -33.0, -4.0, 19.0, 6.0, 60.0, -130.0, 10.0, 12.0, 50.0, 14.0, 14.0, 8.0, 4.0, 0.0, -9.0, 38.0, -13.0, 57.0, 26.0, -7.0, 59.0, -3.0, 50.0, 40.0, 50.0, 30.0, -44.0, 17.0, 350.0, 9.0, -33.0, 20.0, 15.0, 28.0, 9.0, 50.0, 20.0, 5.0, 6.0, 31.0, 51.0, 10.0, 4.0, -1.0, 25.0, 30.0, 4.0, 15.0, 28.0, 30.0, 50.0, 48.0, -13.0, 40.0, 0.0, 22.0, 29.0, -15.0, -15.0, 14.0, 30.0, 3.0, 21.0, 14.0, 37.0, 10.0, -14.0, 30.0, -1.0, 20.0, 33.0, 6.0, 0.0, 13.0, -10.0, -3.0, 17.0, 5.0, 10.0, 80.0, 22.0, 170.0, 13.0, 70.0, 40.0, -3.0, -34.0, 27.0, 30.0, 260.0, -12.0, 38.0, 10.0, -1.0, 60.0, -10.0, 19.0, -4.0, 5.0, 25.0, 20.0, 0.0, 18.0, 46.0, 38.0, 20.0, 40.0, -31.0, -4.0, 200.0, 0.0, 17.0, 35.0, 5.0, 1.0, -6.0, 30.0, 22.0, 10.0, 8.0, 30.0, 6.0, 150.0, 46.0, 60.0, 18.0, -4.0, -6.0, 15.0, 40.0, 9.0, -4.0, -6.0, 58.0, 0.0, 50.0, -10.0, 20.0, 287.0, -37.0, 48.0, 43.0, 40.0, 48.0, 46.0, 0.0, 9.0, 12.0, 60.0, 51.0, 43.0, 169.0, -141.0, 0.0, -38.0, 30.0, -7.0, 16.0, 26.0, -2.0, 50.0, 47.0, 70.0, 39.0, 14.0, 40.0, 28.0, 16.0, 21.0, 120.0, 20.0, 36.0, -8.0, 20.0, 38.0, 24.0, 57.0, -25.0, 23.0, 49.0, 20.0, 50.0, 39.0, 39.0, 34.0, 5.0, 6.0, 40.0, 2.0, 30.0, 0.0, 5.0, 138.0, 29.0, 170.0, 10.0, 33.0, 20.0, 15.0, 19.0, 21.0, -70.0, 12.0, 20.0, 50.0, 50.0, 6.0, 25.0, 34.0, 26.0, -4.0, 4.0, 40.0, 30.0, 0.0, 50.0, 49.0, -30.0, 60.0, 28.0, 160.0, 9.0, -2.0, 40.0, 290.0, -15.0, 30.0, 20.0, 10.0, -3.0, 120.0, 40.0, -20.0, 249.0, 16.0, 34.0, 30.0, -5.0, 60.0, 60.0, 30.0, 50.0, 70.0, 20.0, -1.0, 20.0, 48.0, 2.0, 39.0, 4.0, 10.0, 27.0, 20.0, 26.0, 12.0, 40.0, -2.0, -2.0, 70.0, 19.0, -4.0, 22.0, -4.0, 0.0, 5.0, -15.0, 20.0, -6.0, 40.0, 60.0, 17.0, 10.0, -5.0, 7.0, 42.0, 20.0, 19.0, 28.0, 20.0, 10.0, -17.0, 30.0, 15.0, 20.0, 23.0, -8.0, 43.0, 150.0, -31.0, 60.0, 17.0, 260.0, 50.0, 15.0, 6.0, -5.0, 0.0, 12.0, 4.0, 7.0, 37.0, 8.0, 70.0, 30.0, -4.0, 7.0, 32.0, 10.0, 67.0, -6.0, 10.0, 2.0, -17.0, 60.0, 14.0, 5.0, -7.0, -29.0, -17.0, 26.0, 11.0, 26.0, 70.0, 40.0, 160.0, 53.0, 27.0, 200.0, 7.0, -1.0, 51.0, 30.0, 6.0, -18.0, -31.0, 14.0, 40.0, -9.0, 20.0, 5.0, 49.0, 10.0, 10.0, 3.0, 20.0, -10.0, 20.0, 60.0, -5.0, -18.0, 50.0, 5.0, 50.0, 26.0, 18.0, -5.0, 1.0, 60.0, -15.0, 35.0, -4.0, 11.0, -14.0, -4.0, 30.0, 60.0, 50.0, 30.0, 154.0, 270.0, -7.0, -3.0, -36.0, 30.0, -10.0, -2.0, 30.0, 0.0, 150.0, 25.0, 70.0, 19.0, 28.0, 5.0, 40.0, 28.0, 4.0, -10.0, 40.0, 39.0, 50.0, 10.0, 38.0, 33.0, 29.0, 50.0, 20.0, -56.0, 27.0, 30.0, -21.0, 250.0, 40.0, 14.0, 60.0, -3.0, 100.0, 20.0, 50.0, 0.0, 24.0, 27.0, 11.0, 23.0, 30.0, 40.0, 257.0, -40.0, 30.0, -2.0, 8.0, -26.0, 170.0, 6.0, 15.0, 9.0, 30.0, 60.0, 20.0, 30.0, 13.0, 25.0, 100.0, 70.0, 170.0, -33.0, 40.0, 19.0, 50.0, 50.0, -9.0, 28.0, 20.0, 10.0, 28.0, 259.0, 76.0, 36.0, -3.0, 19.0, 40.0, -43.0, 9.0, 14.0, -34.0, -7.0, -5.0, 5.0, -11.0, 18.0, -10.0, 0.0, 17.0, 16.0, -4.0, 10.0, 18.0, 17.0, 3.0, -6.0, -2.0, 38.0, 31.0, -10.0, 14.0, 18.0, 0.0, 48.0, -17.0, 11.0, 8.0, 10.0, 0.0, -11.0, 40.0, 80.0, 40.0, 90.0, 38.0, -2.0, 160.0, -9.0, 10.0, -60.0, 280.0, 350.0, 40.0, -45.0, -70.0, 2.0, 39.0, 20.0, -39.0, 70.0, -8.0, 50.0, 19.0, 10.0, -39.0, 10.0, -37.0, -31.0, 30.0, 6.0, 19.0, 41.0, 5.0, 30.0, -1.0, 30.0, 38.0, 39.0, 9.0, -12.0, 150.0, 42.0, 100.0, -16.0, 50.0, 37.0, 60.0, 0.0, 70.0, 50.0, 70.0, 6.0, 50.0, 20.0, -15.0, 13.0, 30.0, 25.0, 89.0, 16.0, 30.0, -47.0, 18.0, -7.0, 60.0, 14.0, 18.0, -41.0, 23.0, 70.0, 40.0, 30.0, 19.0, 60.0, 17.0, 60.0, 8.0, 29.0, 70.0, 13.0, 50.0, 25.0, 37.0, 20.0, 15.0, 10.0, 20.0, 25.0, 19.0, 21.0, 170.0, 18.0, -8.0, 30.0, -40.0, 5.0, -44.0, 110.0, -7.0, 40.0, 22.0, 40.0, 40.0, 19.0, 0.0, 2.0, -7.0, 6.0, 20.0, 19.0, 23.0, -5.0, 49.0, 39.0, 9.0, 60.0, 10.0, 0.0, 49.0, 20.0, 35.0, 8.0, 16.0, 10.0, 10.0, 31.0, 28.0, 10.0, 10.0, 29.0, 10.0, 11.0, 30.0, 70.0, 70.0, 20.0, 12.0, 28.0, 20.0, 180.0, 55.0, 50.0, 50.0, 20.0, 30.0, 25.0, 7.0, 35.0, 50.0, 22.0, -5.0, 6.0, 2.0, 20.0, 46.0, -14.0, 29.0, 23.0, 50.0, 50.0, -10.0, -12.0, 10.0, 10.0, 25.0, 20.0, 4.0, -9.0, 18.0, 7.0, 0.0, 10.0, 28.0, -20.0, 11.0, 19.0, -13.0, -14.0, -19.0, 20.0, 50.0, 20.0, 170.0, 230.0, 35.0, 300.0, 23.0, 14.0, 170.0, 60.0, 20.0, 131.0, 160.0, 100.0, 50.0, 9.0, 30.0, 28.0, 30.0, -3.0, 30.0, 20.0, 8.0, -17.0, -35.0, 0.0, 5.0, 150.0, 60.0, -6.0, 40.0, 30.0, 39.0, 6.0, -6.0, 36.0, 2.0, 30.0, -1.0, 70.0, 16.0, -82.0, 0.0, 40.0, 250.0, 25.0, 40.0, 20.0, 20.0, -1.0, 60.0, 10.0, 9.0, 30.0, 18.0, -9.0, 50.0, 6.0, 16.0, 7.0, 80.0, 50.0, 20.0, 24.0, 3.0, 5.0, -21.0, 29.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.500972394127561, "mean_inference_ms": 2.894735920324519, "mean_action_processing_ms": 0.9322811542075223, "mean_env_wait_ms": 1.9871780184826506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0668497085571289, "StateBufferConnector_ms": 0.010010242462158203, "ViewRequirementAgentConnector_ms": 0.5051653385162354}, "num_episodes": 18, "episode_return_max": 1032.0, "episode_return_min": -76.0, "episode_return_mean": 282.48, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.17045814040834, "num_env_steps_trained_throughput_per_sec": 33.17045814040834, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 121483.214, "restore_workers_time_ms": 0.014, "training_step_time_ms": 121483.161, "sample_time_ms": 3017.013, "learn_time_ms": 118445.278, "learn_throughput": 33.771, "synch_weights_time_ms": 11.929}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 35, "trial_id": "6085c_00000", "date": "2024-07-02_00-09-26", "timestamp": 1719893366, "time_this_iter_s": 120.60377812385559, "time_total_s": 6214.414837837219, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138009ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6214.414837837219, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 28.555294117647062, "ram_util_percent": 79.63058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.503573121163792, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.2944165212531695, "policy_loss": -0.004157094270361863, "vf_loss": 5.297537009251385, "vf_explained_var": 0.011714403285259129, "kl": 0.010366125705445482, "entropy": 1.682426257978994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 333345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 1032.0, "episode_reward_min": -13.0, "episode_reward_mean": 296.79, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -141.0}, "policy_reward_max": {"policy_0": 650.0}, "policy_reward_mean": {"policy_0": 29.679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [476.0, 202.0, 457.0, 520.0, 45.0, 191.0, 559.0, 163.0, 115.0, 48.0, 198.0, 454.0, 214.0, 216.0, 129.0, 135.0, 317.0, 426.0, 132.0, 361.0, 256.0, 168.0, 499.0, 297.0, 192.0, 326.0, 295.0, 299.0, 259.0, 251.0, 354.0, 512.0, 594.0, 189.0, 177.0, 126.0, 174.0, 584.0, 154.0, 131.0, 159.0, 573.0, 90.0, 175.0, 113.0, 544.0, 340.0, 244.0, 402.0, 303.0, 490.0, 308.0, 405.0, 431.0, -13.0, 121.0, 82.0, 436.0, 517.0, 74.0, 216.0, 481.0, 338.0, 84.0, 403.0, 234.0, 255.0, 182.0, 253.0, 178.0, 300.0, 502.0, 179.0, 106.0, 9.0, 1032.0, 618.0, 218.0, 170.0, 399.0, 189.0, 217.0, 114.0, 526.0, 218.0, 246.0, 192.0, 702.0, 260.0, 211.0, 351.0, 263.0, 383.0, 212.0, 692.0, 268.0, 435.0, 418.0, 258.0, 378.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [22.0, 26.0, 28.0, 76.0, 5.0, 5.0, 260.0, 12.0, 20.0, 22.0, 0.0, -12.0, 40.0, 1.0, -21.0, 150.0, -10.0, 4.0, 34.0, 16.0, 20.0, 39.0, 29.0, 27.0, 30.0, 47.0, 150.0, 35.0, 50.0, 30.0, 2.0, 10.0, 50.0, 50.0, 180.0, -22.0, -32.0, 70.0, 200.0, 12.0, 40.0, -13.0, 1.0, -17.0, -3.0, 0.0, 32.0, 25.0, -6.0, -14.0, 14.0, 3.0, 50.0, 6.0, 25.0, 39.0, -7.0, 34.0, 10.0, 17.0, 18.0, 40.0, 150.0, 170.0, 85.0, -4.0, 20.0, 50.0, 30.0, 0.0, -6.0, -13.0, 5.0, 3.0, -1.0, 90.0, 30.0, 26.0, 50.0, -21.0, -2.0, 1.0, -9.0, -29.0, 150.0, 50.0, -28.0, -33.0, -4.0, 19.0, 6.0, 60.0, -130.0, 10.0, 12.0, 50.0, 14.0, 14.0, 8.0, 4.0, 0.0, -9.0, 38.0, -13.0, 57.0, 26.0, -7.0, 59.0, -3.0, 50.0, 40.0, 50.0, 30.0, -44.0, 17.0, 350.0, 9.0, -33.0, 20.0, 15.0, 28.0, 9.0, 50.0, 20.0, 5.0, 6.0, 31.0, 51.0, 10.0, 4.0, -1.0, 25.0, 30.0, 4.0, 15.0, 28.0, 30.0, 50.0, 48.0, -13.0, 40.0, 0.0, 22.0, 29.0, -15.0, -15.0, 14.0, 30.0, 3.0, 21.0, 14.0, 37.0, 10.0, -14.0, 30.0, -1.0, 20.0, 33.0, 6.0, 0.0, 13.0, -10.0, -3.0, 17.0, 5.0, 10.0, 80.0, 22.0, 170.0, 13.0, 70.0, 40.0, -3.0, -34.0, 27.0, 30.0, 260.0, -12.0, 38.0, 10.0, -1.0, 60.0, -10.0, 19.0, -4.0, 5.0, 25.0, 20.0, 0.0, 18.0, 46.0, 38.0, 20.0, 40.0, -31.0, -4.0, 200.0, 0.0, 17.0, 35.0, 5.0, 1.0, -6.0, 30.0, 22.0, 10.0, 8.0, 30.0, 6.0, 150.0, 46.0, 60.0, 18.0, -4.0, -6.0, 15.0, 40.0, 9.0, -4.0, -6.0, 58.0, 0.0, 50.0, -10.0, 20.0, 287.0, -37.0, 48.0, 43.0, 40.0, 48.0, 46.0, 0.0, 9.0, 12.0, 60.0, 51.0, 43.0, 169.0, -141.0, 0.0, -38.0, 30.0, -7.0, 16.0, 26.0, -2.0, 50.0, 47.0, 70.0, 39.0, 14.0, 40.0, 28.0, 16.0, 21.0, 120.0, 20.0, 36.0, -8.0, 20.0, 38.0, 24.0, 57.0, -25.0, 23.0, 49.0, 20.0, 50.0, 39.0, 39.0, 34.0, 5.0, 6.0, 40.0, 2.0, 30.0, 0.0, 5.0, 138.0, 29.0, 170.0, 10.0, 33.0, 20.0, 15.0, 19.0, 21.0, -70.0, 12.0, 20.0, 50.0, 50.0, 6.0, 25.0, 34.0, 26.0, -4.0, 4.0, 40.0, 30.0, 0.0, 50.0, 49.0, -30.0, 60.0, 28.0, 160.0, 9.0, -2.0, 40.0, 290.0, -15.0, 30.0, 20.0, 10.0, -3.0, 120.0, 40.0, -20.0, 249.0, 16.0, 34.0, 30.0, -5.0, 60.0, 60.0, 30.0, 50.0, 70.0, 20.0, -1.0, 20.0, 48.0, 2.0, 39.0, 4.0, 10.0, 27.0, 20.0, 26.0, 12.0, 40.0, -2.0, -2.0, 70.0, 19.0, -4.0, 22.0, -4.0, 0.0, 5.0, -15.0, 20.0, -6.0, 40.0, 60.0, 17.0, 10.0, -5.0, 7.0, 42.0, 20.0, 19.0, 28.0, 20.0, 10.0, -17.0, 30.0, 15.0, 20.0, 23.0, -8.0, 43.0, 150.0, -31.0, 60.0, 17.0, 260.0, 50.0, 15.0, 6.0, -5.0, 0.0, 12.0, 4.0, 7.0, 37.0, 8.0, 70.0, 30.0, -4.0, 7.0, 32.0, 10.0, 67.0, -6.0, 10.0, 2.0, -17.0, 60.0, 14.0, 5.0, -7.0, -29.0, -17.0, 26.0, 11.0, 26.0, 70.0, 40.0, 160.0, 53.0, 27.0, 200.0, 7.0, -1.0, 51.0, 30.0, 6.0, -18.0, -31.0, 14.0, 40.0, -9.0, 20.0, 5.0, 49.0, 10.0, 10.0, 3.0, 20.0, -10.0, 20.0, 60.0, -5.0, -18.0, 50.0, 5.0, 50.0, 26.0, 18.0, -5.0, 1.0, 60.0, -15.0, 35.0, -4.0, 11.0, -14.0, -4.0, 30.0, 60.0, 50.0, 30.0, 154.0, 270.0, -7.0, -3.0, -36.0, 30.0, -10.0, -2.0, 30.0, 0.0, 150.0, 25.0, 70.0, 19.0, 28.0, 5.0, 40.0, 28.0, 4.0, -10.0, 40.0, 39.0, 50.0, 10.0, 38.0, 33.0, 29.0, 50.0, 20.0, -56.0, 27.0, 30.0, -21.0, 250.0, 40.0, 14.0, 60.0, -3.0, 100.0, 20.0, 50.0, 0.0, 24.0, 27.0, 11.0, 23.0, 30.0, 40.0, 257.0, -40.0, 30.0, -2.0, 8.0, -26.0, 170.0, 6.0, 15.0, 9.0, 30.0, 60.0, 20.0, 30.0, 13.0, 25.0, 100.0, 70.0, 170.0, -33.0, 40.0, 19.0, 50.0, 50.0, -9.0, 28.0, 20.0, 10.0, 28.0, 259.0, 76.0, 36.0, -3.0, 19.0, 40.0, -43.0, 9.0, 14.0, -34.0, -7.0, -5.0, 5.0, -11.0, 18.0, -10.0, 0.0, 17.0, 16.0, -4.0, 10.0, 18.0, 17.0, 3.0, -6.0, -2.0, 38.0, 31.0, -10.0, 14.0, 18.0, 0.0, 48.0, -17.0, 11.0, 8.0, 10.0, 0.0, -11.0, 40.0, 80.0, 40.0, 90.0, 38.0, -2.0, 160.0, -9.0, 10.0, -60.0, 280.0, 350.0, 40.0, -45.0, -70.0, 2.0, 39.0, 20.0, -39.0, 70.0, -8.0, 50.0, 19.0, 10.0, -39.0, 10.0, -37.0, -31.0, 30.0, 6.0, 19.0, 41.0, 5.0, 30.0, -1.0, 30.0, 38.0, 39.0, 9.0, -12.0, 150.0, 42.0, 100.0, -16.0, 50.0, 37.0, 60.0, 0.0, 70.0, 50.0, 70.0, 6.0, 50.0, 20.0, -15.0, 13.0, 30.0, 25.0, 89.0, 16.0, 30.0, -47.0, 18.0, -7.0, 60.0, 14.0, 18.0, -41.0, 23.0, 70.0, 40.0, 30.0, 19.0, 60.0, 17.0, 60.0, 8.0, 29.0, 70.0, 13.0, 50.0, 25.0, 37.0, 20.0, 15.0, 10.0, 20.0, 25.0, 19.0, 21.0, 170.0, 18.0, -8.0, 30.0, -40.0, 5.0, -44.0, 110.0, -7.0, 40.0, 22.0, 40.0, 40.0, 19.0, 0.0, 2.0, -7.0, 6.0, 20.0, 19.0, 23.0, -5.0, 49.0, 39.0, 9.0, 60.0, 10.0, 0.0, 49.0, 20.0, 35.0, 8.0, 16.0, 10.0, 10.0, 31.0, 28.0, 10.0, 10.0, 29.0, 10.0, 11.0, 30.0, 70.0, 70.0, 20.0, 12.0, 28.0, 20.0, 180.0, 55.0, 50.0, 50.0, 20.0, 30.0, 25.0, 7.0, 35.0, 50.0, 22.0, -5.0, 6.0, 2.0, 20.0, 46.0, -14.0, 29.0, 23.0, 50.0, 50.0, -10.0, -12.0, 10.0, 10.0, 25.0, 20.0, 4.0, -9.0, 18.0, 7.0, 0.0, 10.0, 28.0, -20.0, 11.0, 19.0, -13.0, -14.0, -19.0, 20.0, 50.0, 20.0, 170.0, 230.0, 35.0, 300.0, 23.0, 14.0, 170.0, 60.0, 20.0, 131.0, 160.0, 100.0, 50.0, 9.0, 30.0, 28.0, 30.0, -3.0, 30.0, 20.0, 8.0, -17.0, -35.0, 0.0, 5.0, 150.0, 60.0, -6.0, 40.0, 30.0, 39.0, 6.0, -6.0, 36.0, 2.0, 30.0, -1.0, 70.0, 16.0, -82.0, 0.0, 40.0, 250.0, 25.0, 40.0, 20.0, 20.0, -1.0, 60.0, 10.0, 9.0, 30.0, 18.0, -9.0, 50.0, 6.0, 16.0, 7.0, 80.0, 50.0, 20.0, 24.0, 3.0, 5.0, -21.0, 29.0, 20.0, -4.0, 30.0, -2.0, 20.0, 47.0, 9.0, 9.0, 5.0, 18.0, -18.0, 10.0, 25.0, 56.0, 257.0, 34.0, 28.0, 10.0, 27.0, -11.0, 90.0, 30.0, 10.0, 0.0, 60.0, 40.0, 0.0, 33.0, 20.0, 5.0, 20.0, 20.0, 15.0, 80.0, 18.0, 17.0, 60.0, 30.0, 6.0, 4.0, -4.0, 26.0, 34.0, 16.0, 26.0, 20.0, 13.0, 10.0, 5.0, 2.0, 40.0, 77.0, 355.0, 10.0, 30.0, 5.0, 195.0, -100.0, 50.0, 20.0, 60.0, 30.0, 24.0, -8.0, 160.0, 10.0, 35.0, 20.0, 17.0, 3.0, -31.0, 50.0, 0.0, 19.0, 60.0, 50.0, 20.0, 33.0, -20.0, -7.0, 6.0, -14.0, 10.0, 50.0, 4.0, 28.0, 27.0, 160.0, 39.0, 16.0, 31.0, 26.0, 50.0, 68.0, 29.0, 6.0, 25.0, 47.0, 13.0, 0.0, -1.0, 16.0, -11.0, 20.0, 60.0, 10.0, 30.0, 157.0, 51.0, 28.0, 22.0, 10.0, 20.0, 55.0, 20.0, 53.0, -1.0, 27.0, 13.0, -9.0, 24.0, -10.0, -15.0, -47.0, 60.0, -37.0, 40.0, -3.0, 650.0, 24.0, 30.0, 60.0, 19.0, 40.0, 10.0, 40.0, 5.0, 2.0, 50.0, 10.0, 32.0, 40.0, 169.0, 40.0, 10.0, 7.0, 4.0, 0.0, 110.0, 17.0, 38.0, 90.0, 50.0, 30.0, 40.0, 30.0, 62.0, -33.0, 70.0, 40.0, 39.0, 0.0, -7.0, 190.0, 17.0, 15.0, 10.0, -11.0, 10.0, -6.0, 40.0, 29.0, 100.0, 24.0, 59.0, 35.0, 10.0, 20.0, 38.0, 33.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4773666831650223, "mean_inference_ms": 2.866707499735058, "mean_action_processing_ms": 0.9241909994358051, "mean_env_wait_ms": 1.9695463995895341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0676114559173584, "StateBufferConnector_ms": 0.010089397430419922, "ViewRequirementAgentConnector_ms": 0.5095374584197998}, "num_episodes": 18, "episode_return_max": 1032.0, "episode_return_min": -13.0, "episode_return_mean": 296.79, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.18514898945134, "num_env_steps_trained_throughput_per_sec": 33.18514898945134, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 121311.884, "restore_workers_time_ms": 0.014, "training_step_time_ms": 121311.831, "sample_time_ms": 2975.579, "learn_time_ms": 118315.113, "learn_throughput": 33.808, "synch_weights_time_ms": 12.304}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 36, "trial_id": "6085c_00000", "date": "2024-07-02_00-11-27", "timestamp": 1719893487, "time_this_iter_s": 120.54721117019653, "time_total_s": 6334.962049007416, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b91793a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6334.962049007416, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 28.638011695906435, "ram_util_percent": 79.40175438596492}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.6155672840924815, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.209729103310801, "policy_loss": -0.0066288500229671355, "vf_loss": 5.215075768754124, "vf_explained_var": 0.011621201984163798, "kl": 0.012821830140113951, "entropy": 1.7004957084838574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 342735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 1032.0, "episode_reward_min": -13.0, "episode_reward_mean": 299.81, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -141.0}, "policy_reward_max": {"policy_0": 650.0}, "policy_reward_mean": {"policy_0": 29.981}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.0, 361.0, 256.0, 168.0, 499.0, 297.0, 192.0, 326.0, 295.0, 299.0, 259.0, 251.0, 354.0, 512.0, 594.0, 189.0, 177.0, 126.0, 174.0, 584.0, 154.0, 131.0, 159.0, 573.0, 90.0, 175.0, 113.0, 544.0, 340.0, 244.0, 402.0, 303.0, 490.0, 308.0, 405.0, 431.0, -13.0, 121.0, 82.0, 436.0, 517.0, 74.0, 216.0, 481.0, 338.0, 84.0, 403.0, 234.0, 255.0, 182.0, 253.0, 178.0, 300.0, 502.0, 179.0, 106.0, 9.0, 1032.0, 618.0, 218.0, 170.0, 399.0, 189.0, 217.0, 114.0, 526.0, 218.0, 246.0, 192.0, 702.0, 260.0, 211.0, 351.0, 263.0, 383.0, 212.0, 692.0, 268.0, 435.0, 418.0, 258.0, 378.0, 137.0, 420.0, 64.0, 411.0, 345.0, 255.0, 302.0, 640.0, 566.0, 228.0, 191.0, 73.0, 128.0, 130.0, 317.0, 175.0, 254.0, 531.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-1.0, 60.0, -10.0, 19.0, -4.0, 5.0, 25.0, 20.0, 0.0, 18.0, 46.0, 38.0, 20.0, 40.0, -31.0, -4.0, 200.0, 0.0, 17.0, 35.0, 5.0, 1.0, -6.0, 30.0, 22.0, 10.0, 8.0, 30.0, 6.0, 150.0, 46.0, 60.0, 18.0, -4.0, -6.0, 15.0, 40.0, 9.0, -4.0, -6.0, 58.0, 0.0, 50.0, -10.0, 20.0, 287.0, -37.0, 48.0, 43.0, 40.0, 48.0, 46.0, 0.0, 9.0, 12.0, 60.0, 51.0, 43.0, 169.0, -141.0, 0.0, -38.0, 30.0, -7.0, 16.0, 26.0, -2.0, 50.0, 47.0, 70.0, 39.0, 14.0, 40.0, 28.0, 16.0, 21.0, 120.0, 20.0, 36.0, -8.0, 20.0, 38.0, 24.0, 57.0, -25.0, 23.0, 49.0, 20.0, 50.0, 39.0, 39.0, 34.0, 5.0, 6.0, 40.0, 2.0, 30.0, 0.0, 5.0, 138.0, 29.0, 170.0, 10.0, 33.0, 20.0, 15.0, 19.0, 21.0, -70.0, 12.0, 20.0, 50.0, 50.0, 6.0, 25.0, 34.0, 26.0, -4.0, 4.0, 40.0, 30.0, 0.0, 50.0, 49.0, -30.0, 60.0, 28.0, 160.0, 9.0, -2.0, 40.0, 290.0, -15.0, 30.0, 20.0, 10.0, -3.0, 120.0, 40.0, -20.0, 249.0, 16.0, 34.0, 30.0, -5.0, 60.0, 60.0, 30.0, 50.0, 70.0, 20.0, -1.0, 20.0, 48.0, 2.0, 39.0, 4.0, 10.0, 27.0, 20.0, 26.0, 12.0, 40.0, -2.0, -2.0, 70.0, 19.0, -4.0, 22.0, -4.0, 0.0, 5.0, -15.0, 20.0, -6.0, 40.0, 60.0, 17.0, 10.0, -5.0, 7.0, 42.0, 20.0, 19.0, 28.0, 20.0, 10.0, -17.0, 30.0, 15.0, 20.0, 23.0, -8.0, 43.0, 150.0, -31.0, 60.0, 17.0, 260.0, 50.0, 15.0, 6.0, -5.0, 0.0, 12.0, 4.0, 7.0, 37.0, 8.0, 70.0, 30.0, -4.0, 7.0, 32.0, 10.0, 67.0, -6.0, 10.0, 2.0, -17.0, 60.0, 14.0, 5.0, -7.0, -29.0, -17.0, 26.0, 11.0, 26.0, 70.0, 40.0, 160.0, 53.0, 27.0, 200.0, 7.0, -1.0, 51.0, 30.0, 6.0, -18.0, -31.0, 14.0, 40.0, -9.0, 20.0, 5.0, 49.0, 10.0, 10.0, 3.0, 20.0, -10.0, 20.0, 60.0, -5.0, -18.0, 50.0, 5.0, 50.0, 26.0, 18.0, -5.0, 1.0, 60.0, -15.0, 35.0, -4.0, 11.0, -14.0, -4.0, 30.0, 60.0, 50.0, 30.0, 154.0, 270.0, -7.0, -3.0, -36.0, 30.0, -10.0, -2.0, 30.0, 0.0, 150.0, 25.0, 70.0, 19.0, 28.0, 5.0, 40.0, 28.0, 4.0, -10.0, 40.0, 39.0, 50.0, 10.0, 38.0, 33.0, 29.0, 50.0, 20.0, -56.0, 27.0, 30.0, -21.0, 250.0, 40.0, 14.0, 60.0, -3.0, 100.0, 20.0, 50.0, 0.0, 24.0, 27.0, 11.0, 23.0, 30.0, 40.0, 257.0, -40.0, 30.0, -2.0, 8.0, -26.0, 170.0, 6.0, 15.0, 9.0, 30.0, 60.0, 20.0, 30.0, 13.0, 25.0, 100.0, 70.0, 170.0, -33.0, 40.0, 19.0, 50.0, 50.0, -9.0, 28.0, 20.0, 10.0, 28.0, 259.0, 76.0, 36.0, -3.0, 19.0, 40.0, -43.0, 9.0, 14.0, -34.0, -7.0, -5.0, 5.0, -11.0, 18.0, -10.0, 0.0, 17.0, 16.0, -4.0, 10.0, 18.0, 17.0, 3.0, -6.0, -2.0, 38.0, 31.0, -10.0, 14.0, 18.0, 0.0, 48.0, -17.0, 11.0, 8.0, 10.0, 0.0, -11.0, 40.0, 80.0, 40.0, 90.0, 38.0, -2.0, 160.0, -9.0, 10.0, -60.0, 280.0, 350.0, 40.0, -45.0, -70.0, 2.0, 39.0, 20.0, -39.0, 70.0, -8.0, 50.0, 19.0, 10.0, -39.0, 10.0, -37.0, -31.0, 30.0, 6.0, 19.0, 41.0, 5.0, 30.0, -1.0, 30.0, 38.0, 39.0, 9.0, -12.0, 150.0, 42.0, 100.0, -16.0, 50.0, 37.0, 60.0, 0.0, 70.0, 50.0, 70.0, 6.0, 50.0, 20.0, -15.0, 13.0, 30.0, 25.0, 89.0, 16.0, 30.0, -47.0, 18.0, -7.0, 60.0, 14.0, 18.0, -41.0, 23.0, 70.0, 40.0, 30.0, 19.0, 60.0, 17.0, 60.0, 8.0, 29.0, 70.0, 13.0, 50.0, 25.0, 37.0, 20.0, 15.0, 10.0, 20.0, 25.0, 19.0, 21.0, 170.0, 18.0, -8.0, 30.0, -40.0, 5.0, -44.0, 110.0, -7.0, 40.0, 22.0, 40.0, 40.0, 19.0, 0.0, 2.0, -7.0, 6.0, 20.0, 19.0, 23.0, -5.0, 49.0, 39.0, 9.0, 60.0, 10.0, 0.0, 49.0, 20.0, 35.0, 8.0, 16.0, 10.0, 10.0, 31.0, 28.0, 10.0, 10.0, 29.0, 10.0, 11.0, 30.0, 70.0, 70.0, 20.0, 12.0, 28.0, 20.0, 180.0, 55.0, 50.0, 50.0, 20.0, 30.0, 25.0, 7.0, 35.0, 50.0, 22.0, -5.0, 6.0, 2.0, 20.0, 46.0, -14.0, 29.0, 23.0, 50.0, 50.0, -10.0, -12.0, 10.0, 10.0, 25.0, 20.0, 4.0, -9.0, 18.0, 7.0, 0.0, 10.0, 28.0, -20.0, 11.0, 19.0, -13.0, -14.0, -19.0, 20.0, 50.0, 20.0, 170.0, 230.0, 35.0, 300.0, 23.0, 14.0, 170.0, 60.0, 20.0, 131.0, 160.0, 100.0, 50.0, 9.0, 30.0, 28.0, 30.0, -3.0, 30.0, 20.0, 8.0, -17.0, -35.0, 0.0, 5.0, 150.0, 60.0, -6.0, 40.0, 30.0, 39.0, 6.0, -6.0, 36.0, 2.0, 30.0, -1.0, 70.0, 16.0, -82.0, 0.0, 40.0, 250.0, 25.0, 40.0, 20.0, 20.0, -1.0, 60.0, 10.0, 9.0, 30.0, 18.0, -9.0, 50.0, 6.0, 16.0, 7.0, 80.0, 50.0, 20.0, 24.0, 3.0, 5.0, -21.0, 29.0, 20.0, -4.0, 30.0, -2.0, 20.0, 47.0, 9.0, 9.0, 5.0, 18.0, -18.0, 10.0, 25.0, 56.0, 257.0, 34.0, 28.0, 10.0, 27.0, -11.0, 90.0, 30.0, 10.0, 0.0, 60.0, 40.0, 0.0, 33.0, 20.0, 5.0, 20.0, 20.0, 15.0, 80.0, 18.0, 17.0, 60.0, 30.0, 6.0, 4.0, -4.0, 26.0, 34.0, 16.0, 26.0, 20.0, 13.0, 10.0, 5.0, 2.0, 40.0, 77.0, 355.0, 10.0, 30.0, 5.0, 195.0, -100.0, 50.0, 20.0, 60.0, 30.0, 24.0, -8.0, 160.0, 10.0, 35.0, 20.0, 17.0, 3.0, -31.0, 50.0, 0.0, 19.0, 60.0, 50.0, 20.0, 33.0, -20.0, -7.0, 6.0, -14.0, 10.0, 50.0, 4.0, 28.0, 27.0, 160.0, 39.0, 16.0, 31.0, 26.0, 50.0, 68.0, 29.0, 6.0, 25.0, 47.0, 13.0, 0.0, -1.0, 16.0, -11.0, 20.0, 60.0, 10.0, 30.0, 157.0, 51.0, 28.0, 22.0, 10.0, 20.0, 55.0, 20.0, 53.0, -1.0, 27.0, 13.0, -9.0, 24.0, -10.0, -15.0, -47.0, 60.0, -37.0, 40.0, -3.0, 650.0, 24.0, 30.0, 60.0, 19.0, 40.0, 10.0, 40.0, 5.0, 2.0, 50.0, 10.0, 32.0, 40.0, 169.0, 40.0, 10.0, 7.0, 4.0, 0.0, 110.0, 17.0, 38.0, 90.0, 50.0, 30.0, 40.0, 30.0, 62.0, -33.0, 70.0, 40.0, 39.0, 0.0, -7.0, 190.0, 17.0, 15.0, 10.0, -11.0, 10.0, -6.0, 40.0, 29.0, 100.0, 24.0, 59.0, 35.0, 10.0, 20.0, 38.0, 33.0, 30.0, 14.0, 4.0, 0.0, 40.0, -8.0, 34.0, 10.0, 10.0, 3.0, 30.0, 40.0, 9.0, 20.0, 250.0, -27.0, 17.0, 10.0, 25.0, 27.0, 49.0, -35.0, 17.0, -44.0, -30.0, -14.0, 50.0, 10.0, 30.0, 60.0, 20.0, 10.0, 23.0, 70.0, 0.0, 50.0, 10.0, 28.0, -10.0, 50.0, 180.0, 20.0, 39.0, 142.0, 49.0, 20.0, 37.0, -2.0, -27.0, 30.0, 37.0, 38.0, 70.0, 50.0, 7.0, 30.0, 28.0, 29.0, -30.0, 15.0, 18.0, 30.0, 10.0, 20.0, 30.0, 70.0, 17.0, 50.0, 15.0, 40.0, 20.0, -10.0, 30.0, 30.0, 50.0, 30.0, 10.0, 20.0, 410.0, 40.0, 30.0, 18.0, 60.0, 17.0, 100.0, 90.0, 145.0, 39.0, 57.0, 0.0, 40.0, 0.0, 21.0, 60.0, 50.0, 60.0, -15.0, 10.0, 9.0, 23.0, 10.0, 28.0, 30.0, -13.0, 28.0, -2.0, 0.0, 15.0, 26.0, 29.0, 50.0, 20.0, 0.0, 10.0, 15.0, -1.0, -14.0, 40.0, -13.0, -14.0, 30.0, -2.0, 19.0, 46.0, 10.0, 50.0, 9.0, 18.0, -10.0, -7.0, -5.0, 31.0, 18.0, 50.0, -13.0, -6.0, 14.0, 2.0, -9.0, 27.0, 16.0, 50.0, 10.0, 40.0, 7.0, 60.0, 40.0, 50.0, 32.0, 34.0, -6.0, 50.0, 14.0, 3.0, 3.0, 22.0, 19.0, 10.0, -1.0, 25.0, 30.0, 62.0, 13.0, 59.0, 8.0, 21.0, 3.0, -1.0, 41.0, 30.0, 18.0, 20.0, 19.0, 135.0, 138.0, 40.0, 30.0, 0.0, 40.0, 70.0, 39.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.454317269731965, "mean_inference_ms": 2.8396967022964867, "mean_action_processing_ms": 0.9162644269231367, "mean_env_wait_ms": 1.9524507183882673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06562495231628418, "StateBufferConnector_ms": 0.009945154190063477, "ViewRequirementAgentConnector_ms": 0.49196434020996094}, "num_episodes": 18, "episode_return_max": 1032.0, "episode_return_min": -13.0, "episode_return_mean": 299.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.99390903741426, "num_env_steps_trained_throughput_per_sec": 32.99390903741426, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 121004.467, "restore_workers_time_ms": 0.014, "training_step_time_ms": 121004.414, "sample_time_ms": 2965.81, "learn_time_ms": 118017.771, "learn_throughput": 33.893, "synch_weights_time_ms": 12.138}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 37, "trial_id": "6085c_00000", "date": "2024-07-02_00-13-28", "timestamp": 1719893608, "time_this_iter_s": 121.24652624130249, "time_total_s": 6456.208575248718, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13800f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6456.208575248718, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 28.82046783625731, "ram_util_percent": 80.20701754385964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.872192149700575, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.0110328740586105, "policy_loss": -0.004784115200455145, "vf_loss": 5.014755412310965, "vf_explained_var": 0.009272613826270301, "kl": 0.010615733148148891, "entropy": 1.6725101898780392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 352125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 1032.0, "episode_reward_min": -13.0, "episode_reward_mean": 308.41, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 650.0}, "policy_reward_mean": {"policy_0": 30.841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.0, 573.0, 90.0, 175.0, 113.0, 544.0, 340.0, 244.0, 402.0, 303.0, 490.0, 308.0, 405.0, 431.0, -13.0, 121.0, 82.0, 436.0, 517.0, 74.0, 216.0, 481.0, 338.0, 84.0, 403.0, 234.0, 255.0, 182.0, 253.0, 178.0, 300.0, 502.0, 179.0, 106.0, 9.0, 1032.0, 618.0, 218.0, 170.0, 399.0, 189.0, 217.0, 114.0, 526.0, 218.0, 246.0, 192.0, 702.0, 260.0, 211.0, 351.0, 263.0, 383.0, 212.0, 692.0, 268.0, 435.0, 418.0, 258.0, 378.0, 137.0, 420.0, 64.0, 411.0, 345.0, 255.0, 302.0, 640.0, 566.0, 228.0, 191.0, 73.0, 128.0, 130.0, 317.0, 175.0, 254.0, 531.0, 289.0, 255.0, 172.0, 162.0, 262.0, 341.0, 269.0, 354.0, 503.0, 580.0, 204.0, 102.0, 310.0, 313.0, 232.0, 349.0, 318.0, 203.0, 368.0, 415.0, 663.0, 526.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 14.0, 5.0, -7.0, -29.0, -17.0, 26.0, 11.0, 26.0, 70.0, 40.0, 160.0, 53.0, 27.0, 200.0, 7.0, -1.0, 51.0, 30.0, 6.0, -18.0, -31.0, 14.0, 40.0, -9.0, 20.0, 5.0, 49.0, 10.0, 10.0, 3.0, 20.0, -10.0, 20.0, 60.0, -5.0, -18.0, 50.0, 5.0, 50.0, 26.0, 18.0, -5.0, 1.0, 60.0, -15.0, 35.0, -4.0, 11.0, -14.0, -4.0, 30.0, 60.0, 50.0, 30.0, 154.0, 270.0, -7.0, -3.0, -36.0, 30.0, -10.0, -2.0, 30.0, 0.0, 150.0, 25.0, 70.0, 19.0, 28.0, 5.0, 40.0, 28.0, 4.0, -10.0, 40.0, 39.0, 50.0, 10.0, 38.0, 33.0, 29.0, 50.0, 20.0, -56.0, 27.0, 30.0, -21.0, 250.0, 40.0, 14.0, 60.0, -3.0, 100.0, 20.0, 50.0, 0.0, 24.0, 27.0, 11.0, 23.0, 30.0, 40.0, 257.0, -40.0, 30.0, -2.0, 8.0, -26.0, 170.0, 6.0, 15.0, 9.0, 30.0, 60.0, 20.0, 30.0, 13.0, 25.0, 100.0, 70.0, 170.0, -33.0, 40.0, 19.0, 50.0, 50.0, -9.0, 28.0, 20.0, 10.0, 28.0, 259.0, 76.0, 36.0, -3.0, 19.0, 40.0, -43.0, 9.0, 14.0, -34.0, -7.0, -5.0, 5.0, -11.0, 18.0, -10.0, 0.0, 17.0, 16.0, -4.0, 10.0, 18.0, 17.0, 3.0, -6.0, -2.0, 38.0, 31.0, -10.0, 14.0, 18.0, 0.0, 48.0, -17.0, 11.0, 8.0, 10.0, 0.0, -11.0, 40.0, 80.0, 40.0, 90.0, 38.0, -2.0, 160.0, -9.0, 10.0, -60.0, 280.0, 350.0, 40.0, -45.0, -70.0, 2.0, 39.0, 20.0, -39.0, 70.0, -8.0, 50.0, 19.0, 10.0, -39.0, 10.0, -37.0, -31.0, 30.0, 6.0, 19.0, 41.0, 5.0, 30.0, -1.0, 30.0, 38.0, 39.0, 9.0, -12.0, 150.0, 42.0, 100.0, -16.0, 50.0, 37.0, 60.0, 0.0, 70.0, 50.0, 70.0, 6.0, 50.0, 20.0, -15.0, 13.0, 30.0, 25.0, 89.0, 16.0, 30.0, -47.0, 18.0, -7.0, 60.0, 14.0, 18.0, -41.0, 23.0, 70.0, 40.0, 30.0, 19.0, 60.0, 17.0, 60.0, 8.0, 29.0, 70.0, 13.0, 50.0, 25.0, 37.0, 20.0, 15.0, 10.0, 20.0, 25.0, 19.0, 21.0, 170.0, 18.0, -8.0, 30.0, -40.0, 5.0, -44.0, 110.0, -7.0, 40.0, 22.0, 40.0, 40.0, 19.0, 0.0, 2.0, -7.0, 6.0, 20.0, 19.0, 23.0, -5.0, 49.0, 39.0, 9.0, 60.0, 10.0, 0.0, 49.0, 20.0, 35.0, 8.0, 16.0, 10.0, 10.0, 31.0, 28.0, 10.0, 10.0, 29.0, 10.0, 11.0, 30.0, 70.0, 70.0, 20.0, 12.0, 28.0, 20.0, 180.0, 55.0, 50.0, 50.0, 20.0, 30.0, 25.0, 7.0, 35.0, 50.0, 22.0, -5.0, 6.0, 2.0, 20.0, 46.0, -14.0, 29.0, 23.0, 50.0, 50.0, -10.0, -12.0, 10.0, 10.0, 25.0, 20.0, 4.0, -9.0, 18.0, 7.0, 0.0, 10.0, 28.0, -20.0, 11.0, 19.0, -13.0, -14.0, -19.0, 20.0, 50.0, 20.0, 170.0, 230.0, 35.0, 300.0, 23.0, 14.0, 170.0, 60.0, 20.0, 131.0, 160.0, 100.0, 50.0, 9.0, 30.0, 28.0, 30.0, -3.0, 30.0, 20.0, 8.0, -17.0, -35.0, 0.0, 5.0, 150.0, 60.0, -6.0, 40.0, 30.0, 39.0, 6.0, -6.0, 36.0, 2.0, 30.0, -1.0, 70.0, 16.0, -82.0, 0.0, 40.0, 250.0, 25.0, 40.0, 20.0, 20.0, -1.0, 60.0, 10.0, 9.0, 30.0, 18.0, -9.0, 50.0, 6.0, 16.0, 7.0, 80.0, 50.0, 20.0, 24.0, 3.0, 5.0, -21.0, 29.0, 20.0, -4.0, 30.0, -2.0, 20.0, 47.0, 9.0, 9.0, 5.0, 18.0, -18.0, 10.0, 25.0, 56.0, 257.0, 34.0, 28.0, 10.0, 27.0, -11.0, 90.0, 30.0, 10.0, 0.0, 60.0, 40.0, 0.0, 33.0, 20.0, 5.0, 20.0, 20.0, 15.0, 80.0, 18.0, 17.0, 60.0, 30.0, 6.0, 4.0, -4.0, 26.0, 34.0, 16.0, 26.0, 20.0, 13.0, 10.0, 5.0, 2.0, 40.0, 77.0, 355.0, 10.0, 30.0, 5.0, 195.0, -100.0, 50.0, 20.0, 60.0, 30.0, 24.0, -8.0, 160.0, 10.0, 35.0, 20.0, 17.0, 3.0, -31.0, 50.0, 0.0, 19.0, 60.0, 50.0, 20.0, 33.0, -20.0, -7.0, 6.0, -14.0, 10.0, 50.0, 4.0, 28.0, 27.0, 160.0, 39.0, 16.0, 31.0, 26.0, 50.0, 68.0, 29.0, 6.0, 25.0, 47.0, 13.0, 0.0, -1.0, 16.0, -11.0, 20.0, 60.0, 10.0, 30.0, 157.0, 51.0, 28.0, 22.0, 10.0, 20.0, 55.0, 20.0, 53.0, -1.0, 27.0, 13.0, -9.0, 24.0, -10.0, -15.0, -47.0, 60.0, -37.0, 40.0, -3.0, 650.0, 24.0, 30.0, 60.0, 19.0, 40.0, 10.0, 40.0, 5.0, 2.0, 50.0, 10.0, 32.0, 40.0, 169.0, 40.0, 10.0, 7.0, 4.0, 0.0, 110.0, 17.0, 38.0, 90.0, 50.0, 30.0, 40.0, 30.0, 62.0, -33.0, 70.0, 40.0, 39.0, 0.0, -7.0, 190.0, 17.0, 15.0, 10.0, -11.0, 10.0, -6.0, 40.0, 29.0, 100.0, 24.0, 59.0, 35.0, 10.0, 20.0, 38.0, 33.0, 30.0, 14.0, 4.0, 0.0, 40.0, -8.0, 34.0, 10.0, 10.0, 3.0, 30.0, 40.0, 9.0, 20.0, 250.0, -27.0, 17.0, 10.0, 25.0, 27.0, 49.0, -35.0, 17.0, -44.0, -30.0, -14.0, 50.0, 10.0, 30.0, 60.0, 20.0, 10.0, 23.0, 70.0, 0.0, 50.0, 10.0, 28.0, -10.0, 50.0, 180.0, 20.0, 39.0, 142.0, 49.0, 20.0, 37.0, -2.0, -27.0, 30.0, 37.0, 38.0, 70.0, 50.0, 7.0, 30.0, 28.0, 29.0, -30.0, 15.0, 18.0, 30.0, 10.0, 20.0, 30.0, 70.0, 17.0, 50.0, 15.0, 40.0, 20.0, -10.0, 30.0, 30.0, 50.0, 30.0, 10.0, 20.0, 410.0, 40.0, 30.0, 18.0, 60.0, 17.0, 100.0, 90.0, 145.0, 39.0, 57.0, 0.0, 40.0, 0.0, 21.0, 60.0, 50.0, 60.0, -15.0, 10.0, 9.0, 23.0, 10.0, 28.0, 30.0, -13.0, 28.0, -2.0, 0.0, 15.0, 26.0, 29.0, 50.0, 20.0, 0.0, 10.0, 15.0, -1.0, -14.0, 40.0, -13.0, -14.0, 30.0, -2.0, 19.0, 46.0, 10.0, 50.0, 9.0, 18.0, -10.0, -7.0, -5.0, 31.0, 18.0, 50.0, -13.0, -6.0, 14.0, 2.0, -9.0, 27.0, 16.0, 50.0, 10.0, 40.0, 7.0, 60.0, 40.0, 50.0, 32.0, 34.0, -6.0, 50.0, 14.0, 3.0, 3.0, 22.0, 19.0, 10.0, -1.0, 25.0, 30.0, 62.0, 13.0, 59.0, 8.0, 21.0, 3.0, -1.0, 41.0, 30.0, 18.0, 20.0, 19.0, 135.0, 138.0, 40.0, 30.0, 0.0, 40.0, 70.0, 39.0, 0.0, 10.0, 37.0, 147.0, 0.0, -24.0, 22.0, 40.0, 68.0, -11.0, 20.0, 40.0, 20.0, 40.0, 30.0, 80.0, 0.0, -5.0, 10.0, 20.0, 70.0, -7.0, 9.0, 10.0, 15.0, -1.0, 39.0, 20.0, 19.0, -2.0, 110.0, 11.0, 50.0, 7.0, -23.0, -16.0, 0.0, 47.0, -11.0, -13.0, 0.0, -17.0, -41.0, 30.0, 60.0, 30.0, 50.0, 70.0, 40.0, 40.0, 45.0, -17.0, 22.0, 10.0, 20.0, 170.0, 50.0, -8.0, 50.0, -1.0, 5.0, 50.0, 9.0, 34.0, 28.0, -11.0, 7.0, 17.0, 80.0, 50.0, 30.0, 11.0, -4.0, 39.0, 25.0, 40.0, 25.0, 60.0, 38.0, 90.0, 50.0, 32.0, 26.0, 24.0, 70.0, 55.0, -5.0, 50.0, 37.0, 164.0, -17.0, -100.0, 160.0, 45.0, -3.0, 50.0, 142.0, 269.0, 14.0, 20.0, 13.0, 5.0, -6.0, 0.0, 4.0, 20.0, 90.0, 14.0, 30.0, 34.0, 20.0, -14.0, 40.0, 5.0, 40.0, 10.0, -12.0, -7.0, 0.0, 20.0, 20.0, 40.0, 39.0, 8.0, 50.0, 100.0, 20.0, -2.0, 20.0, 15.0, -4.0, 105.0, 20.0, 9.0, 40.0, 48.0, 10.0, -29.0, 110.0, 4.0, -60.0, 50.0, 45.0, -25.0, 160.0, -7.0, 57.0, -25.0, 57.0, -20.0, 50.0, 18.0, 24.0, 30.0, 40.0, 14.0, 14.0, -2.0, -9.0, 170.0, 17.0, 20.0, 80.0, 20.0, 50.0, 80.0, 4.0, 10.0, 17.0, 20.0, 50.0, 40.0, 20.0, -11.0, 20.0, 10.0, 20.0, 20.0, 4.0, 30.0, 20.0, 50.0, 40.0, 90.0, -1.0, -5.0, 49.0, 15.0, 30.0, 80.0, 60.0, 19.0, 56.0, 31.0, 20.0, 40.0, 29.0, 55.0, 35.0, 70.0, 390.0, 5.0, 4.0, -18.0, 70.0, -41.0, 15.0, 8.0, 40.0, 190.0, -36.0, 480.0, -50.0, 32.0, 13.0, 40.0, -29.0, 19.0, 30.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4277579688533577, "mean_inference_ms": 2.8097272745153004, "mean_action_processing_ms": 0.9074086226520787, "mean_env_wait_ms": 1.9328133527931977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06425619125366211, "StateBufferConnector_ms": 0.009873151779174805, "ViewRequirementAgentConnector_ms": 0.48932886123657227}, "num_episodes": 22, "episode_return_max": 1032.0, "episode_return_min": -13.0, "episode_return_mean": 308.41, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.38404484272944, "num_env_steps_trained_throughput_per_sec": 33.38404484272944, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 120767.482, "restore_workers_time_ms": 0.014, "training_step_time_ms": 120767.43, "sample_time_ms": 2950.476, "learn_time_ms": 117795.973, "learn_throughput": 33.957, "synch_weights_time_ms": 12.078}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 38, "trial_id": "6085c_00000", "date": "2024-07-02_00-15-28", "timestamp": 1719893728, "time_this_iter_s": 119.83113718032837, "time_total_s": 6576.039712429047, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6576.039712429047, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 28.688235294117646, "ram_util_percent": 79.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.248956673531232, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.677732754058351, "policy_loss": -0.006059774019283315, "vf_loss": 4.682624416026318, "vf_explained_var": 0.022259237889410716, "kl": 0.011681139900486495, "entropy": 1.6383970086186077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 361515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 1032.0, "episode_reward_min": 9.0, "episode_reward_mean": 309.27, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 650.0}, "policy_reward_mean": {"policy_0": 30.927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.0, 403.0, 234.0, 255.0, 182.0, 253.0, 178.0, 300.0, 502.0, 179.0, 106.0, 9.0, 1032.0, 618.0, 218.0, 170.0, 399.0, 189.0, 217.0, 114.0, 526.0, 218.0, 246.0, 192.0, 702.0, 260.0, 211.0, 351.0, 263.0, 383.0, 212.0, 692.0, 268.0, 435.0, 418.0, 258.0, 378.0, 137.0, 420.0, 64.0, 411.0, 345.0, 255.0, 302.0, 640.0, 566.0, 228.0, 191.0, 73.0, 128.0, 130.0, 317.0, 175.0, 254.0, 531.0, 289.0, 255.0, 172.0, 162.0, 262.0, 341.0, 269.0, 354.0, 503.0, 580.0, 204.0, 102.0, 310.0, 313.0, 232.0, 349.0, 318.0, 203.0, 368.0, 415.0, 663.0, 526.0, 532.0, 104.0, 210.0, 164.0, 211.0, 286.0, 184.0, 291.0, 205.0, 339.0, 320.0, 448.0, 170.0, 263.0, 240.0, 563.0, 172.0, 546.0, 301.0, 374.0, 346.0, 342.0, 304.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [16.0, 30.0, -47.0, 18.0, -7.0, 60.0, 14.0, 18.0, -41.0, 23.0, 70.0, 40.0, 30.0, 19.0, 60.0, 17.0, 60.0, 8.0, 29.0, 70.0, 13.0, 50.0, 25.0, 37.0, 20.0, 15.0, 10.0, 20.0, 25.0, 19.0, 21.0, 170.0, 18.0, -8.0, 30.0, -40.0, 5.0, -44.0, 110.0, -7.0, 40.0, 22.0, 40.0, 40.0, 19.0, 0.0, 2.0, -7.0, 6.0, 20.0, 19.0, 23.0, -5.0, 49.0, 39.0, 9.0, 60.0, 10.0, 0.0, 49.0, 20.0, 35.0, 8.0, 16.0, 10.0, 10.0, 31.0, 28.0, 10.0, 10.0, 29.0, 10.0, 11.0, 30.0, 70.0, 70.0, 20.0, 12.0, 28.0, 20.0, 180.0, 55.0, 50.0, 50.0, 20.0, 30.0, 25.0, 7.0, 35.0, 50.0, 22.0, -5.0, 6.0, 2.0, 20.0, 46.0, -14.0, 29.0, 23.0, 50.0, 50.0, -10.0, -12.0, 10.0, 10.0, 25.0, 20.0, 4.0, -9.0, 18.0, 7.0, 0.0, 10.0, 28.0, -20.0, 11.0, 19.0, -13.0, -14.0, -19.0, 20.0, 50.0, 20.0, 170.0, 230.0, 35.0, 300.0, 23.0, 14.0, 170.0, 60.0, 20.0, 131.0, 160.0, 100.0, 50.0, 9.0, 30.0, 28.0, 30.0, -3.0, 30.0, 20.0, 8.0, -17.0, -35.0, 0.0, 5.0, 150.0, 60.0, -6.0, 40.0, 30.0, 39.0, 6.0, -6.0, 36.0, 2.0, 30.0, -1.0, 70.0, 16.0, -82.0, 0.0, 40.0, 250.0, 25.0, 40.0, 20.0, 20.0, -1.0, 60.0, 10.0, 9.0, 30.0, 18.0, -9.0, 50.0, 6.0, 16.0, 7.0, 80.0, 50.0, 20.0, 24.0, 3.0, 5.0, -21.0, 29.0, 20.0, -4.0, 30.0, -2.0, 20.0, 47.0, 9.0, 9.0, 5.0, 18.0, -18.0, 10.0, 25.0, 56.0, 257.0, 34.0, 28.0, 10.0, 27.0, -11.0, 90.0, 30.0, 10.0, 0.0, 60.0, 40.0, 0.0, 33.0, 20.0, 5.0, 20.0, 20.0, 15.0, 80.0, 18.0, 17.0, 60.0, 30.0, 6.0, 4.0, -4.0, 26.0, 34.0, 16.0, 26.0, 20.0, 13.0, 10.0, 5.0, 2.0, 40.0, 77.0, 355.0, 10.0, 30.0, 5.0, 195.0, -100.0, 50.0, 20.0, 60.0, 30.0, 24.0, -8.0, 160.0, 10.0, 35.0, 20.0, 17.0, 3.0, -31.0, 50.0, 0.0, 19.0, 60.0, 50.0, 20.0, 33.0, -20.0, -7.0, 6.0, -14.0, 10.0, 50.0, 4.0, 28.0, 27.0, 160.0, 39.0, 16.0, 31.0, 26.0, 50.0, 68.0, 29.0, 6.0, 25.0, 47.0, 13.0, 0.0, -1.0, 16.0, -11.0, 20.0, 60.0, 10.0, 30.0, 157.0, 51.0, 28.0, 22.0, 10.0, 20.0, 55.0, 20.0, 53.0, -1.0, 27.0, 13.0, -9.0, 24.0, -10.0, -15.0, -47.0, 60.0, -37.0, 40.0, -3.0, 650.0, 24.0, 30.0, 60.0, 19.0, 40.0, 10.0, 40.0, 5.0, 2.0, 50.0, 10.0, 32.0, 40.0, 169.0, 40.0, 10.0, 7.0, 4.0, 0.0, 110.0, 17.0, 38.0, 90.0, 50.0, 30.0, 40.0, 30.0, 62.0, -33.0, 70.0, 40.0, 39.0, 0.0, -7.0, 190.0, 17.0, 15.0, 10.0, -11.0, 10.0, -6.0, 40.0, 29.0, 100.0, 24.0, 59.0, 35.0, 10.0, 20.0, 38.0, 33.0, 30.0, 14.0, 4.0, 0.0, 40.0, -8.0, 34.0, 10.0, 10.0, 3.0, 30.0, 40.0, 9.0, 20.0, 250.0, -27.0, 17.0, 10.0, 25.0, 27.0, 49.0, -35.0, 17.0, -44.0, -30.0, -14.0, 50.0, 10.0, 30.0, 60.0, 20.0, 10.0, 23.0, 70.0, 0.0, 50.0, 10.0, 28.0, -10.0, 50.0, 180.0, 20.0, 39.0, 142.0, 49.0, 20.0, 37.0, -2.0, -27.0, 30.0, 37.0, 38.0, 70.0, 50.0, 7.0, 30.0, 28.0, 29.0, -30.0, 15.0, 18.0, 30.0, 10.0, 20.0, 30.0, 70.0, 17.0, 50.0, 15.0, 40.0, 20.0, -10.0, 30.0, 30.0, 50.0, 30.0, 10.0, 20.0, 410.0, 40.0, 30.0, 18.0, 60.0, 17.0, 100.0, 90.0, 145.0, 39.0, 57.0, 0.0, 40.0, 0.0, 21.0, 60.0, 50.0, 60.0, -15.0, 10.0, 9.0, 23.0, 10.0, 28.0, 30.0, -13.0, 28.0, -2.0, 0.0, 15.0, 26.0, 29.0, 50.0, 20.0, 0.0, 10.0, 15.0, -1.0, -14.0, 40.0, -13.0, -14.0, 30.0, -2.0, 19.0, 46.0, 10.0, 50.0, 9.0, 18.0, -10.0, -7.0, -5.0, 31.0, 18.0, 50.0, -13.0, -6.0, 14.0, 2.0, -9.0, 27.0, 16.0, 50.0, 10.0, 40.0, 7.0, 60.0, 40.0, 50.0, 32.0, 34.0, -6.0, 50.0, 14.0, 3.0, 3.0, 22.0, 19.0, 10.0, -1.0, 25.0, 30.0, 62.0, 13.0, 59.0, 8.0, 21.0, 3.0, -1.0, 41.0, 30.0, 18.0, 20.0, 19.0, 135.0, 138.0, 40.0, 30.0, 0.0, 40.0, 70.0, 39.0, 0.0, 10.0, 37.0, 147.0, 0.0, -24.0, 22.0, 40.0, 68.0, -11.0, 20.0, 40.0, 20.0, 40.0, 30.0, 80.0, 0.0, -5.0, 10.0, 20.0, 70.0, -7.0, 9.0, 10.0, 15.0, -1.0, 39.0, 20.0, 19.0, -2.0, 110.0, 11.0, 50.0, 7.0, -23.0, -16.0, 0.0, 47.0, -11.0, -13.0, 0.0, -17.0, -41.0, 30.0, 60.0, 30.0, 50.0, 70.0, 40.0, 40.0, 45.0, -17.0, 22.0, 10.0, 20.0, 170.0, 50.0, -8.0, 50.0, -1.0, 5.0, 50.0, 9.0, 34.0, 28.0, -11.0, 7.0, 17.0, 80.0, 50.0, 30.0, 11.0, -4.0, 39.0, 25.0, 40.0, 25.0, 60.0, 38.0, 90.0, 50.0, 32.0, 26.0, 24.0, 70.0, 55.0, -5.0, 50.0, 37.0, 164.0, -17.0, -100.0, 160.0, 45.0, -3.0, 50.0, 142.0, 269.0, 14.0, 20.0, 13.0, 5.0, -6.0, 0.0, 4.0, 20.0, 90.0, 14.0, 30.0, 34.0, 20.0, -14.0, 40.0, 5.0, 40.0, 10.0, -12.0, -7.0, 0.0, 20.0, 20.0, 40.0, 39.0, 8.0, 50.0, 100.0, 20.0, -2.0, 20.0, 15.0, -4.0, 105.0, 20.0, 9.0, 40.0, 48.0, 10.0, -29.0, 110.0, 4.0, -60.0, 50.0, 45.0, -25.0, 160.0, -7.0, 57.0, -25.0, 57.0, -20.0, 50.0, 18.0, 24.0, 30.0, 40.0, 14.0, 14.0, -2.0, -9.0, 170.0, 17.0, 20.0, 80.0, 20.0, 50.0, 80.0, 4.0, 10.0, 17.0, 20.0, 50.0, 40.0, 20.0, -11.0, 20.0, 10.0, 20.0, 20.0, 4.0, 30.0, 20.0, 50.0, 40.0, 90.0, -1.0, -5.0, 49.0, 15.0, 30.0, 80.0, 60.0, 19.0, 56.0, 31.0, 20.0, 40.0, 29.0, 55.0, 35.0, 70.0, 390.0, 5.0, 4.0, -18.0, 70.0, -41.0, 15.0, 8.0, 40.0, 190.0, -36.0, 480.0, -50.0, 32.0, 13.0, 40.0, -29.0, 19.0, 30.0, 27.0, 28.0, 21.0, 40.0, 40.0, -36.0, 60.0, 149.0, 50.0, 150.0, 30.0, 20.0, 40.0, -6.0, 10.0, 0.0, 2.0, 7.0, 19.0, 11.0, 1.0, 10.0, 7.0, 20.0, 0.0, 40.0, 28.0, 8.0, 8.0, 60.0, 29.0, 19.0, 0.0, -5.0, 24.0, 10.0, 20.0, -10.0, 59.0, 36.0, 11.0, 20.0, 50.0, 27.0, 30.0, 8.0, 10.0, 20.0, 40.0, 3.0, 3.0, 50.0, -4.0, 57.0, 14.0, 20.0, -11.0, 10.0, 50.0, 40.0, 60.0, 36.0, 10.0, 30.0, 10.0, 0.0, 10.0, 29.0, 10.0, 30.0, 19.0, 50.0, 0.0, 16.0, -10.0, 10.0, 50.0, 45.0, -15.0, -5.0, 150.0, 26.0, -31.0, 100.0, 30.0, -5.0, 15.0, 27.0, 0.0, 15.0, 28.0, 40.0, 39.0, 13.0, 31.0, 22.0, 66.0, 0.0, 53.0, 35.0, 40.0, 39.0, 20.0, 50.0, 19.0, 34.0, 40.0, 30.0, 40.0, 18.0, 30.0, 50.0, 15.0, 100.0, -67.0, 20.0, 4.0, 28.0, 30.0, 248.0, 20.0, -7.0, 1.0, 10.0, 30.0, 10.0, -7.0, 40.0, 23.0, 50.0, 20.0, 29.0, 8.0, -1.0, 44.0, 38.0, 10.0, 20.0, 10.0, 70.0, 35.0, 60.0, 17.0, 19.0, 40.0, 32.0, 10.0, -5.0, 10.0, 30.0, 27.0, 60.0, -2.0, 19.0, 20.0, 170.0, 50.0, 40.0, 159.0, 7.0, 40.0, 40.0, 30.0, 10.0, 15.0, 14.0, -8.0, 20.0, 10.0, 25.0, 16.0, 20.0, 56.0, 172.0, 87.0, -10.0, 14.0, 50.0, 162.0, 0.0, -5.0, 25.0, 80.0, 10.0, 43.0, 59.0, 20.0, 40.0, -10.0, 0.0, 34.0, 28.0, 20.0, 70.0, 60.0, 39.0, 30.0, 27.0, 70.0, -4.0, 34.0, 40.0, 30.0, 40.0, 9.0, 40.0, 15.0, 35.0, 48.0, 30.0, 59.0, 10.0, 10.0, 167.0, 4.0, 20.0, 68.0, 10.0, 60.0, 22.0, -29.0, -6.0, 28.0, 60.0, 80.0, 40.0, 5.0, 39.0, 47.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.400392440059844, "mean_inference_ms": 2.7770401285889363, "mean_action_processing_ms": 0.8979381248909584, "mean_env_wait_ms": 1.9126909507068008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06027483940124512, "StateBufferConnector_ms": 0.009979248046875, "ViewRequirementAgentConnector_ms": 0.4956984519958496}, "num_episodes": 23, "episode_return_max": 1032.0, "episode_return_min": 9.0, "episode_return_mean": 309.27, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.2320569213892, "num_env_steps_trained_throughput_per_sec": 33.2320569213892, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 120683.806, "restore_workers_time_ms": 0.014, "training_step_time_ms": 120683.753, "sample_time_ms": 2926.877, "learn_time_ms": 117735.833, "learn_throughput": 33.974, "synch_weights_time_ms": 12.024}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 39, "trial_id": "6085c_00000", "date": "2024-07-02_00-17-28", "timestamp": 1719893848, "time_this_iter_s": 120.37812304496765, "time_total_s": 6696.417835474014, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6696.417835474014, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 28.668823529411757, "ram_util_percent": 80.06058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6654737148675927, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.847029092339789, "policy_loss": -0.0052396096827222296, "vf_loss": 5.851160454064512, "vf_explained_var": 0.005440691681588674, "kl": 0.011082504242301306, "entropy": 1.5679119712882403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 370905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 702.0, "episode_reward_min": 64.0, "episode_reward_mean": 319.42, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 650.0}, "policy_reward_mean": {"policy_0": 31.942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.0, 114.0, 526.0, 218.0, 246.0, 192.0, 702.0, 260.0, 211.0, 351.0, 263.0, 383.0, 212.0, 692.0, 268.0, 435.0, 418.0, 258.0, 378.0, 137.0, 420.0, 64.0, 411.0, 345.0, 255.0, 302.0, 640.0, 566.0, 228.0, 191.0, 73.0, 128.0, 130.0, 317.0, 175.0, 254.0, 531.0, 289.0, 255.0, 172.0, 162.0, 262.0, 341.0, 269.0, 354.0, 503.0, 580.0, 204.0, 102.0, 310.0, 313.0, 232.0, 349.0, 318.0, 203.0, 368.0, 415.0, 663.0, 526.0, 532.0, 104.0, 210.0, 164.0, 211.0, 286.0, 184.0, 291.0, 205.0, 339.0, 320.0, 448.0, 170.0, 263.0, 240.0, 563.0, 172.0, 546.0, 301.0, 374.0, 346.0, 342.0, 304.0, 293.0, 640.0, 303.0, 355.0, 443.0, 76.0, 253.0, 371.0, 457.0, 429.0, 266.0, 373.0, 534.0, 137.0, 279.0, 483.0, 435.0, 199.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [7.0, 80.0, 50.0, 20.0, 24.0, 3.0, 5.0, -21.0, 29.0, 20.0, -4.0, 30.0, -2.0, 20.0, 47.0, 9.0, 9.0, 5.0, 18.0, -18.0, 10.0, 25.0, 56.0, 257.0, 34.0, 28.0, 10.0, 27.0, -11.0, 90.0, 30.0, 10.0, 0.0, 60.0, 40.0, 0.0, 33.0, 20.0, 5.0, 20.0, 20.0, 15.0, 80.0, 18.0, 17.0, 60.0, 30.0, 6.0, 4.0, -4.0, 26.0, 34.0, 16.0, 26.0, 20.0, 13.0, 10.0, 5.0, 2.0, 40.0, 77.0, 355.0, 10.0, 30.0, 5.0, 195.0, -100.0, 50.0, 20.0, 60.0, 30.0, 24.0, -8.0, 160.0, 10.0, 35.0, 20.0, 17.0, 3.0, -31.0, 50.0, 0.0, 19.0, 60.0, 50.0, 20.0, 33.0, -20.0, -7.0, 6.0, -14.0, 10.0, 50.0, 4.0, 28.0, 27.0, 160.0, 39.0, 16.0, 31.0, 26.0, 50.0, 68.0, 29.0, 6.0, 25.0, 47.0, 13.0, 0.0, -1.0, 16.0, -11.0, 20.0, 60.0, 10.0, 30.0, 157.0, 51.0, 28.0, 22.0, 10.0, 20.0, 55.0, 20.0, 53.0, -1.0, 27.0, 13.0, -9.0, 24.0, -10.0, -15.0, -47.0, 60.0, -37.0, 40.0, -3.0, 650.0, 24.0, 30.0, 60.0, 19.0, 40.0, 10.0, 40.0, 5.0, 2.0, 50.0, 10.0, 32.0, 40.0, 169.0, 40.0, 10.0, 7.0, 4.0, 0.0, 110.0, 17.0, 38.0, 90.0, 50.0, 30.0, 40.0, 30.0, 62.0, -33.0, 70.0, 40.0, 39.0, 0.0, -7.0, 190.0, 17.0, 15.0, 10.0, -11.0, 10.0, -6.0, 40.0, 29.0, 100.0, 24.0, 59.0, 35.0, 10.0, 20.0, 38.0, 33.0, 30.0, 14.0, 4.0, 0.0, 40.0, -8.0, 34.0, 10.0, 10.0, 3.0, 30.0, 40.0, 9.0, 20.0, 250.0, -27.0, 17.0, 10.0, 25.0, 27.0, 49.0, -35.0, 17.0, -44.0, -30.0, -14.0, 50.0, 10.0, 30.0, 60.0, 20.0, 10.0, 23.0, 70.0, 0.0, 50.0, 10.0, 28.0, -10.0, 50.0, 180.0, 20.0, 39.0, 142.0, 49.0, 20.0, 37.0, -2.0, -27.0, 30.0, 37.0, 38.0, 70.0, 50.0, 7.0, 30.0, 28.0, 29.0, -30.0, 15.0, 18.0, 30.0, 10.0, 20.0, 30.0, 70.0, 17.0, 50.0, 15.0, 40.0, 20.0, -10.0, 30.0, 30.0, 50.0, 30.0, 10.0, 20.0, 410.0, 40.0, 30.0, 18.0, 60.0, 17.0, 100.0, 90.0, 145.0, 39.0, 57.0, 0.0, 40.0, 0.0, 21.0, 60.0, 50.0, 60.0, -15.0, 10.0, 9.0, 23.0, 10.0, 28.0, 30.0, -13.0, 28.0, -2.0, 0.0, 15.0, 26.0, 29.0, 50.0, 20.0, 0.0, 10.0, 15.0, -1.0, -14.0, 40.0, -13.0, -14.0, 30.0, -2.0, 19.0, 46.0, 10.0, 50.0, 9.0, 18.0, -10.0, -7.0, -5.0, 31.0, 18.0, 50.0, -13.0, -6.0, 14.0, 2.0, -9.0, 27.0, 16.0, 50.0, 10.0, 40.0, 7.0, 60.0, 40.0, 50.0, 32.0, 34.0, -6.0, 50.0, 14.0, 3.0, 3.0, 22.0, 19.0, 10.0, -1.0, 25.0, 30.0, 62.0, 13.0, 59.0, 8.0, 21.0, 3.0, -1.0, 41.0, 30.0, 18.0, 20.0, 19.0, 135.0, 138.0, 40.0, 30.0, 0.0, 40.0, 70.0, 39.0, 0.0, 10.0, 37.0, 147.0, 0.0, -24.0, 22.0, 40.0, 68.0, -11.0, 20.0, 40.0, 20.0, 40.0, 30.0, 80.0, 0.0, -5.0, 10.0, 20.0, 70.0, -7.0, 9.0, 10.0, 15.0, -1.0, 39.0, 20.0, 19.0, -2.0, 110.0, 11.0, 50.0, 7.0, -23.0, -16.0, 0.0, 47.0, -11.0, -13.0, 0.0, -17.0, -41.0, 30.0, 60.0, 30.0, 50.0, 70.0, 40.0, 40.0, 45.0, -17.0, 22.0, 10.0, 20.0, 170.0, 50.0, -8.0, 50.0, -1.0, 5.0, 50.0, 9.0, 34.0, 28.0, -11.0, 7.0, 17.0, 80.0, 50.0, 30.0, 11.0, -4.0, 39.0, 25.0, 40.0, 25.0, 60.0, 38.0, 90.0, 50.0, 32.0, 26.0, 24.0, 70.0, 55.0, -5.0, 50.0, 37.0, 164.0, -17.0, -100.0, 160.0, 45.0, -3.0, 50.0, 142.0, 269.0, 14.0, 20.0, 13.0, 5.0, -6.0, 0.0, 4.0, 20.0, 90.0, 14.0, 30.0, 34.0, 20.0, -14.0, 40.0, 5.0, 40.0, 10.0, -12.0, -7.0, 0.0, 20.0, 20.0, 40.0, 39.0, 8.0, 50.0, 100.0, 20.0, -2.0, 20.0, 15.0, -4.0, 105.0, 20.0, 9.0, 40.0, 48.0, 10.0, -29.0, 110.0, 4.0, -60.0, 50.0, 45.0, -25.0, 160.0, -7.0, 57.0, -25.0, 57.0, -20.0, 50.0, 18.0, 24.0, 30.0, 40.0, 14.0, 14.0, -2.0, -9.0, 170.0, 17.0, 20.0, 80.0, 20.0, 50.0, 80.0, 4.0, 10.0, 17.0, 20.0, 50.0, 40.0, 20.0, -11.0, 20.0, 10.0, 20.0, 20.0, 4.0, 30.0, 20.0, 50.0, 40.0, 90.0, -1.0, -5.0, 49.0, 15.0, 30.0, 80.0, 60.0, 19.0, 56.0, 31.0, 20.0, 40.0, 29.0, 55.0, 35.0, 70.0, 390.0, 5.0, 4.0, -18.0, 70.0, -41.0, 15.0, 8.0, 40.0, 190.0, -36.0, 480.0, -50.0, 32.0, 13.0, 40.0, -29.0, 19.0, 30.0, 27.0, 28.0, 21.0, 40.0, 40.0, -36.0, 60.0, 149.0, 50.0, 150.0, 30.0, 20.0, 40.0, -6.0, 10.0, 0.0, 2.0, 7.0, 19.0, 11.0, 1.0, 10.0, 7.0, 20.0, 0.0, 40.0, 28.0, 8.0, 8.0, 60.0, 29.0, 19.0, 0.0, -5.0, 24.0, 10.0, 20.0, -10.0, 59.0, 36.0, 11.0, 20.0, 50.0, 27.0, 30.0, 8.0, 10.0, 20.0, 40.0, 3.0, 3.0, 50.0, -4.0, 57.0, 14.0, 20.0, -11.0, 10.0, 50.0, 40.0, 60.0, 36.0, 10.0, 30.0, 10.0, 0.0, 10.0, 29.0, 10.0, 30.0, 19.0, 50.0, 0.0, 16.0, -10.0, 10.0, 50.0, 45.0, -15.0, -5.0, 150.0, 26.0, -31.0, 100.0, 30.0, -5.0, 15.0, 27.0, 0.0, 15.0, 28.0, 40.0, 39.0, 13.0, 31.0, 22.0, 66.0, 0.0, 53.0, 35.0, 40.0, 39.0, 20.0, 50.0, 19.0, 34.0, 40.0, 30.0, 40.0, 18.0, 30.0, 50.0, 15.0, 100.0, -67.0, 20.0, 4.0, 28.0, 30.0, 248.0, 20.0, -7.0, 1.0, 10.0, 30.0, 10.0, -7.0, 40.0, 23.0, 50.0, 20.0, 29.0, 8.0, -1.0, 44.0, 38.0, 10.0, 20.0, 10.0, 70.0, 35.0, 60.0, 17.0, 19.0, 40.0, 32.0, 10.0, -5.0, 10.0, 30.0, 27.0, 60.0, -2.0, 19.0, 20.0, 170.0, 50.0, 40.0, 159.0, 7.0, 40.0, 40.0, 30.0, 10.0, 15.0, 14.0, -8.0, 20.0, 10.0, 25.0, 16.0, 20.0, 56.0, 172.0, 87.0, -10.0, 14.0, 50.0, 162.0, 0.0, -5.0, 25.0, 80.0, 10.0, 43.0, 59.0, 20.0, 40.0, -10.0, 0.0, 34.0, 28.0, 20.0, 70.0, 60.0, 39.0, 30.0, 27.0, 70.0, -4.0, 34.0, 40.0, 30.0, 40.0, 9.0, 40.0, 15.0, 35.0, 48.0, 30.0, 59.0, 10.0, 10.0, 167.0, 4.0, 20.0, 68.0, 10.0, 60.0, 22.0, -29.0, -6.0, 28.0, 60.0, 80.0, 40.0, 5.0, 39.0, 47.0, 11.0, 0.0, 132.0, 30.0, 36.0, 6.0, 50.0, -17.0, 31.0, -19.0, 19.0, 25.0, 70.0, -50.0, 49.0, 30.0, 400.0, 70.0, -3.0, 30.0, 65.0, -21.0, 59.0, 80.0, 37.0, 58.0, 20.0, 40.0, -10.0, 10.0, 10.0, -1.0, 8.0, 10.0, 64.0, 30.0, 50.0, 40.0, 57.0, 40.0, 29.0, 27.0, 30.0, 8.0, 30.0, 58.0, 60.0, 180.0, -56.0, -7.0, 60.0, 80.0, -15.0, -24.0, -18.0, 20.0, 70.0, 10.0, 25.0, 3.0, 25.0, -20.0, 14.0, 6.0, 50.0, 39.0, 34.0, 3.0, 9.0, 18.0, 20.0, 60.0, 47.0, 21.0, 6.0, 59.0, 33.0, 70.0, 37.0, 30.0, 38.0, 30.0, 40.0, 26.0, 0.0, 173.0, 90.0, 43.0, -6.0, 60.0, 70.0, -39.0, 50.0, 250.0, 28.0, -34.0, -10.0, 10.0, 25.0, 30.0, 50.0, 30.0, 10.0, 20.0, 50.0, 10.0, -130.0, 20.0, 170.0, 38.0, 18.0, 60.0, 40.0, 20.0, 50.0, 50.0, 60.0, -5.0, 20.0, 41.0, 70.0, 27.0, -31.0, 40.0, 160.0, 60.0, 20.0, 28.0, 20.0, 20.0, 180.0, 37.0, 10.0, 9.0, 19.0, -6.0, 27.0, 22.0, 3.0, 70.0, -3.0, -14.0, 9.0, 160.0, 37.0, 57.0, -73.0, 18.0, 9.0, 20.0, 22.0, 20.0, 29.0, 47.0, 15.0, 50.0, 30.0, 36.0, 130.0, 26.0, 30.0, 90.0, 11.0, 160.0, 110.0, -2.0, 10.0, 87.0, 8.0, -30.0, 1.0, 80.0, -28.0, 4.0, 30.0, 60.0, 30.0, 0.0, 40.0, 25.0, 30.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3799290400765094, "mean_inference_ms": 2.752795540859696, "mean_action_processing_ms": 0.8911215136769638, "mean_env_wait_ms": 1.8976771771350676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06509876251220703, "StateBufferConnector_ms": 0.010167121887207031, "ViewRequirementAgentConnector_ms": 0.48444128036499023}, "num_episodes": 18, "episode_return_max": 702.0, "episode_return_min": 64.0, "episode_return_mean": 319.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.402803381137275, "num_env_steps_trained_throughput_per_sec": 33.402803381137275, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 120605.298, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120605.247, "sample_time_ms": 2870.996, "learn_time_ms": 117713.254, "learn_throughput": 33.981, "synch_weights_time_ms": 12.256}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 40, "trial_id": "6085c_00000", "date": "2024-07-02_00-19-28", "timestamp": 1719893968, "time_this_iter_s": 119.75958681106567, "time_total_s": 6816.17742228508, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6816.17742228508, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 28.48224852071006, "ram_util_percent": 79.29408284023668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.676518732937761, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4751429621784835, "policy_loss": -0.004759053673488073, "vf_loss": 5.478867353367222, "vf_explained_var": 0.027330316782505495, "kl": 0.010346625822917439, "entropy": 1.5407335824605883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 380295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "env_runners": {"episode_reward_max": 727.0, "episode_reward_min": 64.0, "episode_reward_mean": 317.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 480.0}, "policy_reward_mean": {"policy_0": 31.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [378.0, 137.0, 420.0, 64.0, 411.0, 345.0, 255.0, 302.0, 640.0, 566.0, 228.0, 191.0, 73.0, 128.0, 130.0, 317.0, 175.0, 254.0, 531.0, 289.0, 255.0, 172.0, 162.0, 262.0, 341.0, 269.0, 354.0, 503.0, 580.0, 204.0, 102.0, 310.0, 313.0, 232.0, 349.0, 318.0, 203.0, 368.0, 415.0, 663.0, 526.0, 532.0, 104.0, 210.0, 164.0, 211.0, 286.0, 184.0, 291.0, 205.0, 339.0, 320.0, 448.0, 170.0, 263.0, 240.0, 563.0, 172.0, 546.0, 301.0, 374.0, 346.0, 342.0, 304.0, 293.0, 640.0, 303.0, 355.0, 443.0, 76.0, 253.0, 371.0, 457.0, 429.0, 266.0, 373.0, 534.0, 137.0, 279.0, 483.0, 435.0, 199.0, 349.0, 727.0, 211.0, 125.0, 334.0, 320.0, 341.0, 277.0, 230.0, 257.0, 350.0, 311.0, 341.0, 289.0, 385.0, 363.0, 184.0, 380.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [29.0, 100.0, 24.0, 59.0, 35.0, 10.0, 20.0, 38.0, 33.0, 30.0, 14.0, 4.0, 0.0, 40.0, -8.0, 34.0, 10.0, 10.0, 3.0, 30.0, 40.0, 9.0, 20.0, 250.0, -27.0, 17.0, 10.0, 25.0, 27.0, 49.0, -35.0, 17.0, -44.0, -30.0, -14.0, 50.0, 10.0, 30.0, 60.0, 20.0, 10.0, 23.0, 70.0, 0.0, 50.0, 10.0, 28.0, -10.0, 50.0, 180.0, 20.0, 39.0, 142.0, 49.0, 20.0, 37.0, -2.0, -27.0, 30.0, 37.0, 38.0, 70.0, 50.0, 7.0, 30.0, 28.0, 29.0, -30.0, 15.0, 18.0, 30.0, 10.0, 20.0, 30.0, 70.0, 17.0, 50.0, 15.0, 40.0, 20.0, -10.0, 30.0, 30.0, 50.0, 30.0, 10.0, 20.0, 410.0, 40.0, 30.0, 18.0, 60.0, 17.0, 100.0, 90.0, 145.0, 39.0, 57.0, 0.0, 40.0, 0.0, 21.0, 60.0, 50.0, 60.0, -15.0, 10.0, 9.0, 23.0, 10.0, 28.0, 30.0, -13.0, 28.0, -2.0, 0.0, 15.0, 26.0, 29.0, 50.0, 20.0, 0.0, 10.0, 15.0, -1.0, -14.0, 40.0, -13.0, -14.0, 30.0, -2.0, 19.0, 46.0, 10.0, 50.0, 9.0, 18.0, -10.0, -7.0, -5.0, 31.0, 18.0, 50.0, -13.0, -6.0, 14.0, 2.0, -9.0, 27.0, 16.0, 50.0, 10.0, 40.0, 7.0, 60.0, 40.0, 50.0, 32.0, 34.0, -6.0, 50.0, 14.0, 3.0, 3.0, 22.0, 19.0, 10.0, -1.0, 25.0, 30.0, 62.0, 13.0, 59.0, 8.0, 21.0, 3.0, -1.0, 41.0, 30.0, 18.0, 20.0, 19.0, 135.0, 138.0, 40.0, 30.0, 0.0, 40.0, 70.0, 39.0, 0.0, 10.0, 37.0, 147.0, 0.0, -24.0, 22.0, 40.0, 68.0, -11.0, 20.0, 40.0, 20.0, 40.0, 30.0, 80.0, 0.0, -5.0, 10.0, 20.0, 70.0, -7.0, 9.0, 10.0, 15.0, -1.0, 39.0, 20.0, 19.0, -2.0, 110.0, 11.0, 50.0, 7.0, -23.0, -16.0, 0.0, 47.0, -11.0, -13.0, 0.0, -17.0, -41.0, 30.0, 60.0, 30.0, 50.0, 70.0, 40.0, 40.0, 45.0, -17.0, 22.0, 10.0, 20.0, 170.0, 50.0, -8.0, 50.0, -1.0, 5.0, 50.0, 9.0, 34.0, 28.0, -11.0, 7.0, 17.0, 80.0, 50.0, 30.0, 11.0, -4.0, 39.0, 25.0, 40.0, 25.0, 60.0, 38.0, 90.0, 50.0, 32.0, 26.0, 24.0, 70.0, 55.0, -5.0, 50.0, 37.0, 164.0, -17.0, -100.0, 160.0, 45.0, -3.0, 50.0, 142.0, 269.0, 14.0, 20.0, 13.0, 5.0, -6.0, 0.0, 4.0, 20.0, 90.0, 14.0, 30.0, 34.0, 20.0, -14.0, 40.0, 5.0, 40.0, 10.0, -12.0, -7.0, 0.0, 20.0, 20.0, 40.0, 39.0, 8.0, 50.0, 100.0, 20.0, -2.0, 20.0, 15.0, -4.0, 105.0, 20.0, 9.0, 40.0, 48.0, 10.0, -29.0, 110.0, 4.0, -60.0, 50.0, 45.0, -25.0, 160.0, -7.0, 57.0, -25.0, 57.0, -20.0, 50.0, 18.0, 24.0, 30.0, 40.0, 14.0, 14.0, -2.0, -9.0, 170.0, 17.0, 20.0, 80.0, 20.0, 50.0, 80.0, 4.0, 10.0, 17.0, 20.0, 50.0, 40.0, 20.0, -11.0, 20.0, 10.0, 20.0, 20.0, 4.0, 30.0, 20.0, 50.0, 40.0, 90.0, -1.0, -5.0, 49.0, 15.0, 30.0, 80.0, 60.0, 19.0, 56.0, 31.0, 20.0, 40.0, 29.0, 55.0, 35.0, 70.0, 390.0, 5.0, 4.0, -18.0, 70.0, -41.0, 15.0, 8.0, 40.0, 190.0, -36.0, 480.0, -50.0, 32.0, 13.0, 40.0, -29.0, 19.0, 30.0, 27.0, 28.0, 21.0, 40.0, 40.0, -36.0, 60.0, 149.0, 50.0, 150.0, 30.0, 20.0, 40.0, -6.0, 10.0, 0.0, 2.0, 7.0, 19.0, 11.0, 1.0, 10.0, 7.0, 20.0, 0.0, 40.0, 28.0, 8.0, 8.0, 60.0, 29.0, 19.0, 0.0, -5.0, 24.0, 10.0, 20.0, -10.0, 59.0, 36.0, 11.0, 20.0, 50.0, 27.0, 30.0, 8.0, 10.0, 20.0, 40.0, 3.0, 3.0, 50.0, -4.0, 57.0, 14.0, 20.0, -11.0, 10.0, 50.0, 40.0, 60.0, 36.0, 10.0, 30.0, 10.0, 0.0, 10.0, 29.0, 10.0, 30.0, 19.0, 50.0, 0.0, 16.0, -10.0, 10.0, 50.0, 45.0, -15.0, -5.0, 150.0, 26.0, -31.0, 100.0, 30.0, -5.0, 15.0, 27.0, 0.0, 15.0, 28.0, 40.0, 39.0, 13.0, 31.0, 22.0, 66.0, 0.0, 53.0, 35.0, 40.0, 39.0, 20.0, 50.0, 19.0, 34.0, 40.0, 30.0, 40.0, 18.0, 30.0, 50.0, 15.0, 100.0, -67.0, 20.0, 4.0, 28.0, 30.0, 248.0, 20.0, -7.0, 1.0, 10.0, 30.0, 10.0, -7.0, 40.0, 23.0, 50.0, 20.0, 29.0, 8.0, -1.0, 44.0, 38.0, 10.0, 20.0, 10.0, 70.0, 35.0, 60.0, 17.0, 19.0, 40.0, 32.0, 10.0, -5.0, 10.0, 30.0, 27.0, 60.0, -2.0, 19.0, 20.0, 170.0, 50.0, 40.0, 159.0, 7.0, 40.0, 40.0, 30.0, 10.0, 15.0, 14.0, -8.0, 20.0, 10.0, 25.0, 16.0, 20.0, 56.0, 172.0, 87.0, -10.0, 14.0, 50.0, 162.0, 0.0, -5.0, 25.0, 80.0, 10.0, 43.0, 59.0, 20.0, 40.0, -10.0, 0.0, 34.0, 28.0, 20.0, 70.0, 60.0, 39.0, 30.0, 27.0, 70.0, -4.0, 34.0, 40.0, 30.0, 40.0, 9.0, 40.0, 15.0, 35.0, 48.0, 30.0, 59.0, 10.0, 10.0, 167.0, 4.0, 20.0, 68.0, 10.0, 60.0, 22.0, -29.0, -6.0, 28.0, 60.0, 80.0, 40.0, 5.0, 39.0, 47.0, 11.0, 0.0, 132.0, 30.0, 36.0, 6.0, 50.0, -17.0, 31.0, -19.0, 19.0, 25.0, 70.0, -50.0, 49.0, 30.0, 400.0, 70.0, -3.0, 30.0, 65.0, -21.0, 59.0, 80.0, 37.0, 58.0, 20.0, 40.0, -10.0, 10.0, 10.0, -1.0, 8.0, 10.0, 64.0, 30.0, 50.0, 40.0, 57.0, 40.0, 29.0, 27.0, 30.0, 8.0, 30.0, 58.0, 60.0, 180.0, -56.0, -7.0, 60.0, 80.0, -15.0, -24.0, -18.0, 20.0, 70.0, 10.0, 25.0, 3.0, 25.0, -20.0, 14.0, 6.0, 50.0, 39.0, 34.0, 3.0, 9.0, 18.0, 20.0, 60.0, 47.0, 21.0, 6.0, 59.0, 33.0, 70.0, 37.0, 30.0, 38.0, 30.0, 40.0, 26.0, 0.0, 173.0, 90.0, 43.0, -6.0, 60.0, 70.0, -39.0, 50.0, 250.0, 28.0, -34.0, -10.0, 10.0, 25.0, 30.0, 50.0, 30.0, 10.0, 20.0, 50.0, 10.0, -130.0, 20.0, 170.0, 38.0, 18.0, 60.0, 40.0, 20.0, 50.0, 50.0, 60.0, -5.0, 20.0, 41.0, 70.0, 27.0, -31.0, 40.0, 160.0, 60.0, 20.0, 28.0, 20.0, 20.0, 180.0, 37.0, 10.0, 9.0, 19.0, -6.0, 27.0, 22.0, 3.0, 70.0, -3.0, -14.0, 9.0, 160.0, 37.0, 57.0, -73.0, 18.0, 9.0, 20.0, 22.0, 20.0, 29.0, 47.0, 15.0, 50.0, 30.0, 36.0, 130.0, 26.0, 30.0, 90.0, 11.0, 160.0, 110.0, -2.0, 10.0, 87.0, 8.0, -30.0, 1.0, 80.0, -28.0, 4.0, 30.0, 60.0, 30.0, 0.0, 40.0, 25.0, 30.0, 8.0, 37.0, 31.0, 10.0, 14.0, -4.0, 23.0, 40.0, 59.0, 60.0, 79.0, 14.0, 23.0, 50.0, 360.0, 27.0, 60.0, 30.0, 15.0, 39.0, 109.0, 40.0, 60.0, 10.0, 30.0, 80.0, -8.0, 50.0, -23.0, -36.0, 8.0, 4.0, -10.0, 26.0, -7.0, -20.0, 13.0, 90.0, 5.0, 0.0, 24.0, -22.0, 30.0, -21.0, -27.0, 60.0, 170.0, 14.0, 30.0, 20.0, 80.0, 4.0, 26.0, 9.0, 25.0, -2.0, 17.0, 11.0, 30.0, 160.0, 40.0, 30.0, 30.0, 40.0, 88.0, 17.0, 6.0, 13.0, 57.0, 40.0, 20.0, 10.0, 60.0, 10.0, -1.0, -1.0, 39.0, 40.0, -60.0, 160.0, 20.0, 33.0, -10.0, 50.0, 40.0, 10.0, 18.0, 30.0, 30.0, 9.0, 20.0, 30.0, 12.0, 10.0, 28.0, 22.0, 50.0, 40.0, 15.0, 0.0, 50.0, 11.0, -16.0, 40.0, 50.0, 10.0, 150.0, 50.0, 20.0, 17.0, 18.0, 60.0, 14.0, 26.0, 60.0, 28.0, 36.0, -11.0, 50.0, 30.0, 18.0, 26.0, -36.0, 30.0, 160.0, 15.0, 39.0, 17.0, 40.0, 40.0, 10.0, 17.0, 30.0, -22.0, 0.0, -5.0, 40.0, 9.0, 160.0, 60.0, 0.0, 9.0, 40.0, 60.0, 30.0, 50.0, 46.0, 14.0, 10.0, 99.0, 27.0, 30.0, 120.0, 4.0, 80.0, -2.0, 70.0, 30.0, -14.0, 17.0, 28.0, 40.0, 16.0, 3.0, -7.0, 50.0, 50.0, 12.0, 9.0, 16.0, -5.0, 39.0, -13.0, 37.0, 60.0, 80.0, 6.0, 150.0, -85.0, 70.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.360420867039204, "mean_inference_ms": 2.729385464993427, "mean_action_processing_ms": 0.8846655681589533, "mean_env_wait_ms": 1.8834438460564338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06457972526550293, "StateBufferConnector_ms": 0.01015782356262207, "ViewRequirementAgentConnector_ms": 0.4735572338104248}, "num_episodes": 18, "episode_return_max": 727.0, "episode_return_min": 64.0, "episode_return_mean": 317.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.026128673987216, "num_env_steps_trained_throughput_per_sec": 33.026128673987216, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 1640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1640000, "timers": {"training_iteration_time_ms": 120619.879, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120619.829, "sample_time_ms": 2847.868, "learn_time_ms": 117751.159, "learn_throughput": 33.97, "synch_weights_time_ms": 12.126}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "done": false, "training_iteration": 41, "trial_id": "6085c_00000", "date": "2024-07-02_00-21-29", "timestamp": 1719894089, "time_this_iter_s": 121.12703919410706, "time_total_s": 6937.304461479187, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9128ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6937.304461479187, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 29.511046511627907, "ram_util_percent": 79.00116279069768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.162631597737281, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.079830655757104, "policy_loss": -0.005831724579031436, "vf_loss": 5.084483680709863, "vf_explained_var": 0.013794022696975447, "kl": 0.011787073865903507, "entropy": 1.5676500556694941, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 389685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 778.0, "episode_reward_min": 76.0, "episode_reward_mean": 332.43, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 480.0}, "policy_reward_mean": {"policy_0": 33.243}, "custom_metrics": {}, "hist_stats": {"episode_reward": [531.0, 289.0, 255.0, 172.0, 162.0, 262.0, 341.0, 269.0, 354.0, 503.0, 580.0, 204.0, 102.0, 310.0, 313.0, 232.0, 349.0, 318.0, 203.0, 368.0, 415.0, 663.0, 526.0, 532.0, 104.0, 210.0, 164.0, 211.0, 286.0, 184.0, 291.0, 205.0, 339.0, 320.0, 448.0, 170.0, 263.0, 240.0, 563.0, 172.0, 546.0, 301.0, 374.0, 346.0, 342.0, 304.0, 293.0, 640.0, 303.0, 355.0, 443.0, 76.0, 253.0, 371.0, 457.0, 429.0, 266.0, 373.0, 534.0, 137.0, 279.0, 483.0, 435.0, 199.0, 349.0, 727.0, 211.0, 125.0, 334.0, 320.0, 341.0, 277.0, 230.0, 257.0, 350.0, 311.0, 341.0, 289.0, 385.0, 363.0, 184.0, 380.0, 473.0, 257.0, 415.0, 288.0, 255.0, 338.0, 405.0, 236.0, 305.0, 397.0, 271.0, 280.0, 480.0, 212.0, 778.0, 387.0, 296.0, 434.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 19.0, 135.0, 138.0, 40.0, 30.0, 0.0, 40.0, 70.0, 39.0, 0.0, 10.0, 37.0, 147.0, 0.0, -24.0, 22.0, 40.0, 68.0, -11.0, 20.0, 40.0, 20.0, 40.0, 30.0, 80.0, 0.0, -5.0, 10.0, 20.0, 70.0, -7.0, 9.0, 10.0, 15.0, -1.0, 39.0, 20.0, 19.0, -2.0, 110.0, 11.0, 50.0, 7.0, -23.0, -16.0, 0.0, 47.0, -11.0, -13.0, 0.0, -17.0, -41.0, 30.0, 60.0, 30.0, 50.0, 70.0, 40.0, 40.0, 45.0, -17.0, 22.0, 10.0, 20.0, 170.0, 50.0, -8.0, 50.0, -1.0, 5.0, 50.0, 9.0, 34.0, 28.0, -11.0, 7.0, 17.0, 80.0, 50.0, 30.0, 11.0, -4.0, 39.0, 25.0, 40.0, 25.0, 60.0, 38.0, 90.0, 50.0, 32.0, 26.0, 24.0, 70.0, 55.0, -5.0, 50.0, 37.0, 164.0, -17.0, -100.0, 160.0, 45.0, -3.0, 50.0, 142.0, 269.0, 14.0, 20.0, 13.0, 5.0, -6.0, 0.0, 4.0, 20.0, 90.0, 14.0, 30.0, 34.0, 20.0, -14.0, 40.0, 5.0, 40.0, 10.0, -12.0, -7.0, 0.0, 20.0, 20.0, 40.0, 39.0, 8.0, 50.0, 100.0, 20.0, -2.0, 20.0, 15.0, -4.0, 105.0, 20.0, 9.0, 40.0, 48.0, 10.0, -29.0, 110.0, 4.0, -60.0, 50.0, 45.0, -25.0, 160.0, -7.0, 57.0, -25.0, 57.0, -20.0, 50.0, 18.0, 24.0, 30.0, 40.0, 14.0, 14.0, -2.0, -9.0, 170.0, 17.0, 20.0, 80.0, 20.0, 50.0, 80.0, 4.0, 10.0, 17.0, 20.0, 50.0, 40.0, 20.0, -11.0, 20.0, 10.0, 20.0, 20.0, 4.0, 30.0, 20.0, 50.0, 40.0, 90.0, -1.0, -5.0, 49.0, 15.0, 30.0, 80.0, 60.0, 19.0, 56.0, 31.0, 20.0, 40.0, 29.0, 55.0, 35.0, 70.0, 390.0, 5.0, 4.0, -18.0, 70.0, -41.0, 15.0, 8.0, 40.0, 190.0, -36.0, 480.0, -50.0, 32.0, 13.0, 40.0, -29.0, 19.0, 30.0, 27.0, 28.0, 21.0, 40.0, 40.0, -36.0, 60.0, 149.0, 50.0, 150.0, 30.0, 20.0, 40.0, -6.0, 10.0, 0.0, 2.0, 7.0, 19.0, 11.0, 1.0, 10.0, 7.0, 20.0, 0.0, 40.0, 28.0, 8.0, 8.0, 60.0, 29.0, 19.0, 0.0, -5.0, 24.0, 10.0, 20.0, -10.0, 59.0, 36.0, 11.0, 20.0, 50.0, 27.0, 30.0, 8.0, 10.0, 20.0, 40.0, 3.0, 3.0, 50.0, -4.0, 57.0, 14.0, 20.0, -11.0, 10.0, 50.0, 40.0, 60.0, 36.0, 10.0, 30.0, 10.0, 0.0, 10.0, 29.0, 10.0, 30.0, 19.0, 50.0, 0.0, 16.0, -10.0, 10.0, 50.0, 45.0, -15.0, -5.0, 150.0, 26.0, -31.0, 100.0, 30.0, -5.0, 15.0, 27.0, 0.0, 15.0, 28.0, 40.0, 39.0, 13.0, 31.0, 22.0, 66.0, 0.0, 53.0, 35.0, 40.0, 39.0, 20.0, 50.0, 19.0, 34.0, 40.0, 30.0, 40.0, 18.0, 30.0, 50.0, 15.0, 100.0, -67.0, 20.0, 4.0, 28.0, 30.0, 248.0, 20.0, -7.0, 1.0, 10.0, 30.0, 10.0, -7.0, 40.0, 23.0, 50.0, 20.0, 29.0, 8.0, -1.0, 44.0, 38.0, 10.0, 20.0, 10.0, 70.0, 35.0, 60.0, 17.0, 19.0, 40.0, 32.0, 10.0, -5.0, 10.0, 30.0, 27.0, 60.0, -2.0, 19.0, 20.0, 170.0, 50.0, 40.0, 159.0, 7.0, 40.0, 40.0, 30.0, 10.0, 15.0, 14.0, -8.0, 20.0, 10.0, 25.0, 16.0, 20.0, 56.0, 172.0, 87.0, -10.0, 14.0, 50.0, 162.0, 0.0, -5.0, 25.0, 80.0, 10.0, 43.0, 59.0, 20.0, 40.0, -10.0, 0.0, 34.0, 28.0, 20.0, 70.0, 60.0, 39.0, 30.0, 27.0, 70.0, -4.0, 34.0, 40.0, 30.0, 40.0, 9.0, 40.0, 15.0, 35.0, 48.0, 30.0, 59.0, 10.0, 10.0, 167.0, 4.0, 20.0, 68.0, 10.0, 60.0, 22.0, -29.0, -6.0, 28.0, 60.0, 80.0, 40.0, 5.0, 39.0, 47.0, 11.0, 0.0, 132.0, 30.0, 36.0, 6.0, 50.0, -17.0, 31.0, -19.0, 19.0, 25.0, 70.0, -50.0, 49.0, 30.0, 400.0, 70.0, -3.0, 30.0, 65.0, -21.0, 59.0, 80.0, 37.0, 58.0, 20.0, 40.0, -10.0, 10.0, 10.0, -1.0, 8.0, 10.0, 64.0, 30.0, 50.0, 40.0, 57.0, 40.0, 29.0, 27.0, 30.0, 8.0, 30.0, 58.0, 60.0, 180.0, -56.0, -7.0, 60.0, 80.0, -15.0, -24.0, -18.0, 20.0, 70.0, 10.0, 25.0, 3.0, 25.0, -20.0, 14.0, 6.0, 50.0, 39.0, 34.0, 3.0, 9.0, 18.0, 20.0, 60.0, 47.0, 21.0, 6.0, 59.0, 33.0, 70.0, 37.0, 30.0, 38.0, 30.0, 40.0, 26.0, 0.0, 173.0, 90.0, 43.0, -6.0, 60.0, 70.0, -39.0, 50.0, 250.0, 28.0, -34.0, -10.0, 10.0, 25.0, 30.0, 50.0, 30.0, 10.0, 20.0, 50.0, 10.0, -130.0, 20.0, 170.0, 38.0, 18.0, 60.0, 40.0, 20.0, 50.0, 50.0, 60.0, -5.0, 20.0, 41.0, 70.0, 27.0, -31.0, 40.0, 160.0, 60.0, 20.0, 28.0, 20.0, 20.0, 180.0, 37.0, 10.0, 9.0, 19.0, -6.0, 27.0, 22.0, 3.0, 70.0, -3.0, -14.0, 9.0, 160.0, 37.0, 57.0, -73.0, 18.0, 9.0, 20.0, 22.0, 20.0, 29.0, 47.0, 15.0, 50.0, 30.0, 36.0, 130.0, 26.0, 30.0, 90.0, 11.0, 160.0, 110.0, -2.0, 10.0, 87.0, 8.0, -30.0, 1.0, 80.0, -28.0, 4.0, 30.0, 60.0, 30.0, 0.0, 40.0, 25.0, 30.0, 8.0, 37.0, 31.0, 10.0, 14.0, -4.0, 23.0, 40.0, 59.0, 60.0, 79.0, 14.0, 23.0, 50.0, 360.0, 27.0, 60.0, 30.0, 15.0, 39.0, 109.0, 40.0, 60.0, 10.0, 30.0, 80.0, -8.0, 50.0, -23.0, -36.0, 8.0, 4.0, -10.0, 26.0, -7.0, -20.0, 13.0, 90.0, 5.0, 0.0, 24.0, -22.0, 30.0, -21.0, -27.0, 60.0, 170.0, 14.0, 30.0, 20.0, 80.0, 4.0, 26.0, 9.0, 25.0, -2.0, 17.0, 11.0, 30.0, 160.0, 40.0, 30.0, 30.0, 40.0, 88.0, 17.0, 6.0, 13.0, 57.0, 40.0, 20.0, 10.0, 60.0, 10.0, -1.0, -1.0, 39.0, 40.0, -60.0, 160.0, 20.0, 33.0, -10.0, 50.0, 40.0, 10.0, 18.0, 30.0, 30.0, 9.0, 20.0, 30.0, 12.0, 10.0, 28.0, 22.0, 50.0, 40.0, 15.0, 0.0, 50.0, 11.0, -16.0, 40.0, 50.0, 10.0, 150.0, 50.0, 20.0, 17.0, 18.0, 60.0, 14.0, 26.0, 60.0, 28.0, 36.0, -11.0, 50.0, 30.0, 18.0, 26.0, -36.0, 30.0, 160.0, 15.0, 39.0, 17.0, 40.0, 40.0, 10.0, 17.0, 30.0, -22.0, 0.0, -5.0, 40.0, 9.0, 160.0, 60.0, 0.0, 9.0, 40.0, 60.0, 30.0, 50.0, 46.0, 14.0, 10.0, 99.0, 27.0, 30.0, 120.0, 4.0, 80.0, -2.0, 70.0, 30.0, -14.0, 17.0, 28.0, 40.0, 16.0, 3.0, -7.0, 50.0, 50.0, 12.0, 9.0, 16.0, -5.0, 39.0, -13.0, 37.0, 60.0, 80.0, 6.0, 150.0, -85.0, 70.0, 36.0, 49.0, 20.0, -20.0, 70.0, 36.0, 20.0, 28.0, 10.0, 170.0, 90.0, 20.0, 10.0, 8.0, 50.0, 60.0, -1.0, 0.0, 40.0, 30.0, 40.0, 30.0, 47.0, 31.0, 71.0, 60.0, 84.0, 19.0, 14.0, 5.0, 54.0, 14.0, -2.0, 80.0, 20.0, 70.0, 30.0, 25.0, 30.0, 30.0, -9.0, -9.0, 30.0, 40.0, -9.0, 24.0, 10.0, 80.0, 30.0, 60.0, -1.0, 0.0, 60.0, 149.0, 10.0, 5.0, 47.0, 30.0, 0.0, -21.0, 58.0, 40.0, 17.0, -6.0, 20.0, -25.0, 50.0, 19.0, 100.0, 10.0, 180.0, 156.0, -24.0, 16.0, 20.0, 1.0, 30.0, 6.0, 40.0, 0.0, -9.0, 40.0, 37.0, 10.0, 50.0, 50.0, 20.0, 18.0, 10.0, 50.0, 20.0, 30.0, 28.0, 16.0, 60.0, 32.0, 150.0, 28.0, 6.0, 9.0, 38.0, 26.0, -9.0, 25.0, 9.0, 41.0, 70.0, 80.0, 28.0, -66.0, 67.0, 40.0, 21.0, 50.0, 20.0, 68.0, 11.0, 27.0, -1.0, 30.0, 14.0, -5.0, 32.0, 79.0, 53.0, 137.0, -8.0, 30.0, 44.0, 58.0, 60.0, 10.0, 60.0, -42.0, 34.0, 2.0, 29.0, 20.0, 1.0, 18.0, 80.0, 38.0, 400.0, 30.0, 10.0, 180.0, 60.0, 20.0, 0.0, 40.0, 0.0, 8.0, 2.0, -7.0, 60.0, 182.0, 20.0, 45.0, 30.0, 39.0, 8.0, 0.0, 70.0, 30.0, 2.0, 50.0, 60.0, 6.0, 45.0, 10.0, 23.0, -2.0, 50.0, 40.0, 118.0, -9.0, -31.0, 97.0, -18.0, 169.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3415464045966576, "mean_inference_ms": 2.7064237767060173, "mean_action_processing_ms": 0.8785221230553663, "mean_env_wait_ms": 1.8695372042705025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0742948055267334, "StateBufferConnector_ms": 0.010268926620483398, "ViewRequirementAgentConnector_ms": 0.47620511054992676}, "num_episodes": 18, "episode_return_max": 778.0, "episode_return_min": 76.0, "episode_return_mean": 332.43, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.215497147676444, "num_env_steps_trained_throughput_per_sec": 33.215497147676444, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 120501.045, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120500.995, "sample_time_ms": 2814.215, "learn_time_ms": 117666.135, "learn_throughput": 33.994, "synch_weights_time_ms": 12.308}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 42, "trial_id": "6085c_00000", "date": "2024-07-02_00-23-30", "timestamp": 1719894210, "time_this_iter_s": 120.43924903869629, "time_total_s": 7057.743710517883, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7057.743710517883, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 28.26411764705883, "ram_util_percent": 79.37176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7398357130214177, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.225428595634314, "policy_loss": -0.005723928626531515, "vf_loss": 5.229903099635919, "vf_explained_var": 0.012857687035307716, "kl": 0.012494295718643047, "entropy": 1.5122251251508125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 399075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "env_runners": {"episode_reward_max": 778.0, "episode_reward_min": 76.0, "episode_reward_mean": 345.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 480.0}, "policy_reward_mean": {"policy_0": 34.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [526.0, 532.0, 104.0, 210.0, 164.0, 211.0, 286.0, 184.0, 291.0, 205.0, 339.0, 320.0, 448.0, 170.0, 263.0, 240.0, 563.0, 172.0, 546.0, 301.0, 374.0, 346.0, 342.0, 304.0, 293.0, 640.0, 303.0, 355.0, 443.0, 76.0, 253.0, 371.0, 457.0, 429.0, 266.0, 373.0, 534.0, 137.0, 279.0, 483.0, 435.0, 199.0, 349.0, 727.0, 211.0, 125.0, 334.0, 320.0, 341.0, 277.0, 230.0, 257.0, 350.0, 311.0, 341.0, 289.0, 385.0, 363.0, 184.0, 380.0, 473.0, 257.0, 415.0, 288.0, 255.0, 338.0, 405.0, 236.0, 305.0, 397.0, 271.0, 280.0, 480.0, 212.0, 778.0, 387.0, 296.0, 434.0, 317.0, 687.0, 174.0, 597.0, 648.0, 449.0, 330.0, 557.0, 310.0, 449.0, 222.0, 311.0, 132.0, 229.0, 353.0, 497.0, 171.0, 540.0, 473.0, 258.0, 275.0, 513.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-36.0, 480.0, -50.0, 32.0, 13.0, 40.0, -29.0, 19.0, 30.0, 27.0, 28.0, 21.0, 40.0, 40.0, -36.0, 60.0, 149.0, 50.0, 150.0, 30.0, 20.0, 40.0, -6.0, 10.0, 0.0, 2.0, 7.0, 19.0, 11.0, 1.0, 10.0, 7.0, 20.0, 0.0, 40.0, 28.0, 8.0, 8.0, 60.0, 29.0, 19.0, 0.0, -5.0, 24.0, 10.0, 20.0, -10.0, 59.0, 36.0, 11.0, 20.0, 50.0, 27.0, 30.0, 8.0, 10.0, 20.0, 40.0, 3.0, 3.0, 50.0, -4.0, 57.0, 14.0, 20.0, -11.0, 10.0, 50.0, 40.0, 60.0, 36.0, 10.0, 30.0, 10.0, 0.0, 10.0, 29.0, 10.0, 30.0, 19.0, 50.0, 0.0, 16.0, -10.0, 10.0, 50.0, 45.0, -15.0, -5.0, 150.0, 26.0, -31.0, 100.0, 30.0, -5.0, 15.0, 27.0, 0.0, 15.0, 28.0, 40.0, 39.0, 13.0, 31.0, 22.0, 66.0, 0.0, 53.0, 35.0, 40.0, 39.0, 20.0, 50.0, 19.0, 34.0, 40.0, 30.0, 40.0, 18.0, 30.0, 50.0, 15.0, 100.0, -67.0, 20.0, 4.0, 28.0, 30.0, 248.0, 20.0, -7.0, 1.0, 10.0, 30.0, 10.0, -7.0, 40.0, 23.0, 50.0, 20.0, 29.0, 8.0, -1.0, 44.0, 38.0, 10.0, 20.0, 10.0, 70.0, 35.0, 60.0, 17.0, 19.0, 40.0, 32.0, 10.0, -5.0, 10.0, 30.0, 27.0, 60.0, -2.0, 19.0, 20.0, 170.0, 50.0, 40.0, 159.0, 7.0, 40.0, 40.0, 30.0, 10.0, 15.0, 14.0, -8.0, 20.0, 10.0, 25.0, 16.0, 20.0, 56.0, 172.0, 87.0, -10.0, 14.0, 50.0, 162.0, 0.0, -5.0, 25.0, 80.0, 10.0, 43.0, 59.0, 20.0, 40.0, -10.0, 0.0, 34.0, 28.0, 20.0, 70.0, 60.0, 39.0, 30.0, 27.0, 70.0, -4.0, 34.0, 40.0, 30.0, 40.0, 9.0, 40.0, 15.0, 35.0, 48.0, 30.0, 59.0, 10.0, 10.0, 167.0, 4.0, 20.0, 68.0, 10.0, 60.0, 22.0, -29.0, -6.0, 28.0, 60.0, 80.0, 40.0, 5.0, 39.0, 47.0, 11.0, 0.0, 132.0, 30.0, 36.0, 6.0, 50.0, -17.0, 31.0, -19.0, 19.0, 25.0, 70.0, -50.0, 49.0, 30.0, 400.0, 70.0, -3.0, 30.0, 65.0, -21.0, 59.0, 80.0, 37.0, 58.0, 20.0, 40.0, -10.0, 10.0, 10.0, -1.0, 8.0, 10.0, 64.0, 30.0, 50.0, 40.0, 57.0, 40.0, 29.0, 27.0, 30.0, 8.0, 30.0, 58.0, 60.0, 180.0, -56.0, -7.0, 60.0, 80.0, -15.0, -24.0, -18.0, 20.0, 70.0, 10.0, 25.0, 3.0, 25.0, -20.0, 14.0, 6.0, 50.0, 39.0, 34.0, 3.0, 9.0, 18.0, 20.0, 60.0, 47.0, 21.0, 6.0, 59.0, 33.0, 70.0, 37.0, 30.0, 38.0, 30.0, 40.0, 26.0, 0.0, 173.0, 90.0, 43.0, -6.0, 60.0, 70.0, -39.0, 50.0, 250.0, 28.0, -34.0, -10.0, 10.0, 25.0, 30.0, 50.0, 30.0, 10.0, 20.0, 50.0, 10.0, -130.0, 20.0, 170.0, 38.0, 18.0, 60.0, 40.0, 20.0, 50.0, 50.0, 60.0, -5.0, 20.0, 41.0, 70.0, 27.0, -31.0, 40.0, 160.0, 60.0, 20.0, 28.0, 20.0, 20.0, 180.0, 37.0, 10.0, 9.0, 19.0, -6.0, 27.0, 22.0, 3.0, 70.0, -3.0, -14.0, 9.0, 160.0, 37.0, 57.0, -73.0, 18.0, 9.0, 20.0, 22.0, 20.0, 29.0, 47.0, 15.0, 50.0, 30.0, 36.0, 130.0, 26.0, 30.0, 90.0, 11.0, 160.0, 110.0, -2.0, 10.0, 87.0, 8.0, -30.0, 1.0, 80.0, -28.0, 4.0, 30.0, 60.0, 30.0, 0.0, 40.0, 25.0, 30.0, 8.0, 37.0, 31.0, 10.0, 14.0, -4.0, 23.0, 40.0, 59.0, 60.0, 79.0, 14.0, 23.0, 50.0, 360.0, 27.0, 60.0, 30.0, 15.0, 39.0, 109.0, 40.0, 60.0, 10.0, 30.0, 80.0, -8.0, 50.0, -23.0, -36.0, 8.0, 4.0, -10.0, 26.0, -7.0, -20.0, 13.0, 90.0, 5.0, 0.0, 24.0, -22.0, 30.0, -21.0, -27.0, 60.0, 170.0, 14.0, 30.0, 20.0, 80.0, 4.0, 26.0, 9.0, 25.0, -2.0, 17.0, 11.0, 30.0, 160.0, 40.0, 30.0, 30.0, 40.0, 88.0, 17.0, 6.0, 13.0, 57.0, 40.0, 20.0, 10.0, 60.0, 10.0, -1.0, -1.0, 39.0, 40.0, -60.0, 160.0, 20.0, 33.0, -10.0, 50.0, 40.0, 10.0, 18.0, 30.0, 30.0, 9.0, 20.0, 30.0, 12.0, 10.0, 28.0, 22.0, 50.0, 40.0, 15.0, 0.0, 50.0, 11.0, -16.0, 40.0, 50.0, 10.0, 150.0, 50.0, 20.0, 17.0, 18.0, 60.0, 14.0, 26.0, 60.0, 28.0, 36.0, -11.0, 50.0, 30.0, 18.0, 26.0, -36.0, 30.0, 160.0, 15.0, 39.0, 17.0, 40.0, 40.0, 10.0, 17.0, 30.0, -22.0, 0.0, -5.0, 40.0, 9.0, 160.0, 60.0, 0.0, 9.0, 40.0, 60.0, 30.0, 50.0, 46.0, 14.0, 10.0, 99.0, 27.0, 30.0, 120.0, 4.0, 80.0, -2.0, 70.0, 30.0, -14.0, 17.0, 28.0, 40.0, 16.0, 3.0, -7.0, 50.0, 50.0, 12.0, 9.0, 16.0, -5.0, 39.0, -13.0, 37.0, 60.0, 80.0, 6.0, 150.0, -85.0, 70.0, 36.0, 49.0, 20.0, -20.0, 70.0, 36.0, 20.0, 28.0, 10.0, 170.0, 90.0, 20.0, 10.0, 8.0, 50.0, 60.0, -1.0, 0.0, 40.0, 30.0, 40.0, 30.0, 47.0, 31.0, 71.0, 60.0, 84.0, 19.0, 14.0, 5.0, 54.0, 14.0, -2.0, 80.0, 20.0, 70.0, 30.0, 25.0, 30.0, 30.0, -9.0, -9.0, 30.0, 40.0, -9.0, 24.0, 10.0, 80.0, 30.0, 60.0, -1.0, 0.0, 60.0, 149.0, 10.0, 5.0, 47.0, 30.0, 0.0, -21.0, 58.0, 40.0, 17.0, -6.0, 20.0, -25.0, 50.0, 19.0, 100.0, 10.0, 180.0, 156.0, -24.0, 16.0, 20.0, 1.0, 30.0, 6.0, 40.0, 0.0, -9.0, 40.0, 37.0, 10.0, 50.0, 50.0, 20.0, 18.0, 10.0, 50.0, 20.0, 30.0, 28.0, 16.0, 60.0, 32.0, 150.0, 28.0, 6.0, 9.0, 38.0, 26.0, -9.0, 25.0, 9.0, 41.0, 70.0, 80.0, 28.0, -66.0, 67.0, 40.0, 21.0, 50.0, 20.0, 68.0, 11.0, 27.0, -1.0, 30.0, 14.0, -5.0, 32.0, 79.0, 53.0, 137.0, -8.0, 30.0, 44.0, 58.0, 60.0, 10.0, 60.0, -42.0, 34.0, 2.0, 29.0, 20.0, 1.0, 18.0, 80.0, 38.0, 400.0, 30.0, 10.0, 180.0, 60.0, 20.0, 0.0, 40.0, 0.0, 8.0, 2.0, -7.0, 60.0, 182.0, 20.0, 45.0, 30.0, 39.0, 8.0, 0.0, 70.0, 30.0, 2.0, 50.0, 60.0, 6.0, 45.0, 10.0, 23.0, -2.0, 50.0, 40.0, 118.0, -9.0, -31.0, 97.0, -18.0, 169.0, 20.0, 20.0, 42.0, 45.0, 27.0, 16.0, 23.0, 22.0, 45.0, 17.0, 60.0, 20.0, 70.0, -9.0, 30.0, 67.0, 30.0, 279.0, 100.0, 49.0, 51.0, -4.0, 5.0, 20.0, 29.0, 30.0, 14.0, 40.0, 0.0, 10.0, 30.0, 40.0, 36.0, 30.0, 210.0, -8.0, 50.0, 90.0, 70.0, 40.0, 39.0, 0.0, 80.0, 210.0, 47.0, 55.0, 180.0, 10.0, 39.0, 10.0, 17.0, 51.0, 20.0, 42.0, 25.0, -1.0, 29.0, 80.0, 50.0, 80.0, 73.0, 42.0, 0.0, 30.0, 40.0, 29.0, 40.0, 4.0, 35.0, 60.0, 50.0, 39.0, 158.0, 9.0, 49.0, 60.0, 10.0, 70.0, 20.0, 130.0, 12.0, 90.0, 60.0, 30.0, 60.0, -10.0, -3.0, 15.0, -1.0, 12.0, 57.0, 15.0, 27.0, 20.0, -10.0, 150.0, 17.0, 50.0, 80.0, 50.0, 50.0, -90.0, -8.0, 50.0, 170.0, -9.0, 20.0, -1.0, 70.0, 0.0, 20.0, 88.0, 47.0, 60.0, 79.0, 9.0, 27.0, -7.0, 10.0, 0.0, -2.0, 10.0, 20.0, 10.0, 30.0, 0.0, 30.0, 29.0, 39.0, -79.0, 43.0, 6.0, 30.0, 10.0, 28.0, 90.0, 18.0, 30.0, 0.0, -2.0, 19.0, 60.0, 39.0, 9.0, 22.0, 10.0, 30.0, 40.0, 20.0, 100.0, 23.0, 22.0, 70.0, 180.0, 60.0, 6.0, 60.0, 10.0, 40.0, 25.0, 24.0, 16.0, -21.0, 7.0, 60.0, 8.0, 27.0, -3.0, 10.0, 50.0, 17.0, 40.0, 0.0, 40.0, 160.0, 60.0, 30.0, 60.0, 90.0, 10.0, 50.0, 18.0, 20.0, 30.0, 50.0, 160.0, 157.0, 20.0, -7.0, -2.0, 27.0, 30.0, 19.0, -12.0, 4.0, 40.0, 40.0, -1.0, 15.0, 36.0, 87.0, 74.0, -5.0, 7.0, 90.0, 28.0, 50.0, 6.0, 20.0, 14.0, -9.0, 70.0, 30.0, 70.0, 40.0, 15.0, 22.0, 100.0, 100.0, 16.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.320498240863422, "mean_inference_ms": 2.6798472874404977, "mean_action_processing_ms": 0.8717081835774245, "mean_env_wait_ms": 1.853378114513062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07450652122497559, "StateBufferConnector_ms": 0.010213136672973633, "ViewRequirementAgentConnector_ms": 0.4641730785369873}, "num_episodes": 22, "episode_return_max": 778.0, "episode_return_min": 76.0, "episode_return_mean": 345.4, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.20425810103653, "num_env_steps_trained_throughput_per_sec": 33.20425810103653, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 1720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1720000, "timers": {"training_iteration_time_ms": 120502.438, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120502.392, "sample_time_ms": 2823.173, "learn_time_ms": 117658.915, "learn_throughput": 33.997, "synch_weights_time_ms": 12.018}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "done": false, "training_iteration": 43, "trial_id": "6085c_00000", "date": "2024-07-02_00-25-30", "timestamp": 1719894330, "time_this_iter_s": 120.48329901695251, "time_total_s": 7178.227009534836, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138009c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7178.227009534836, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 28.54705882352941, "ram_util_percent": 79.28235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.590433183252113, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.810950063567319, "policy_loss": -0.006832471057148779, "vf_loss": 5.816622538485339, "vf_explained_var": 0.008512789861589702, "kl": 0.011599931877597764, "entropy": 1.4856439121107197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 408465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 778.0, "episode_reward_min": 76.0, "episode_reward_mean": 368.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 400.0}, "policy_reward_mean": {"policy_0": 36.885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.0, 293.0, 640.0, 303.0, 355.0, 443.0, 76.0, 253.0, 371.0, 457.0, 429.0, 266.0, 373.0, 534.0, 137.0, 279.0, 483.0, 435.0, 199.0, 349.0, 727.0, 211.0, 125.0, 334.0, 320.0, 341.0, 277.0, 230.0, 257.0, 350.0, 311.0, 341.0, 289.0, 385.0, 363.0, 184.0, 380.0, 473.0, 257.0, 415.0, 288.0, 255.0, 338.0, 405.0, 236.0, 305.0, 397.0, 271.0, 280.0, 480.0, 212.0, 778.0, 387.0, 296.0, 434.0, 317.0, 687.0, 174.0, 597.0, 648.0, 449.0, 330.0, 557.0, 310.0, 449.0, 222.0, 311.0, 132.0, 229.0, 353.0, 497.0, 171.0, 540.0, 473.0, 258.0, 275.0, 513.0, 556.0, 599.0, 354.0, 610.0, 207.0, 515.0, 403.0, 298.0, 485.0, 369.0, 690.0, 317.0, 707.0, 348.0, 275.0, 231.0, 536.0, 142.0, 498.0, 474.0, 341.0, 242.0, 285.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-6.0, 28.0, 60.0, 80.0, 40.0, 5.0, 39.0, 47.0, 11.0, 0.0, 132.0, 30.0, 36.0, 6.0, 50.0, -17.0, 31.0, -19.0, 19.0, 25.0, 70.0, -50.0, 49.0, 30.0, 400.0, 70.0, -3.0, 30.0, 65.0, -21.0, 59.0, 80.0, 37.0, 58.0, 20.0, 40.0, -10.0, 10.0, 10.0, -1.0, 8.0, 10.0, 64.0, 30.0, 50.0, 40.0, 57.0, 40.0, 29.0, 27.0, 30.0, 8.0, 30.0, 58.0, 60.0, 180.0, -56.0, -7.0, 60.0, 80.0, -15.0, -24.0, -18.0, 20.0, 70.0, 10.0, 25.0, 3.0, 25.0, -20.0, 14.0, 6.0, 50.0, 39.0, 34.0, 3.0, 9.0, 18.0, 20.0, 60.0, 47.0, 21.0, 6.0, 59.0, 33.0, 70.0, 37.0, 30.0, 38.0, 30.0, 40.0, 26.0, 0.0, 173.0, 90.0, 43.0, -6.0, 60.0, 70.0, -39.0, 50.0, 250.0, 28.0, -34.0, -10.0, 10.0, 25.0, 30.0, 50.0, 30.0, 10.0, 20.0, 50.0, 10.0, -130.0, 20.0, 170.0, 38.0, 18.0, 60.0, 40.0, 20.0, 50.0, 50.0, 60.0, -5.0, 20.0, 41.0, 70.0, 27.0, -31.0, 40.0, 160.0, 60.0, 20.0, 28.0, 20.0, 20.0, 180.0, 37.0, 10.0, 9.0, 19.0, -6.0, 27.0, 22.0, 3.0, 70.0, -3.0, -14.0, 9.0, 160.0, 37.0, 57.0, -73.0, 18.0, 9.0, 20.0, 22.0, 20.0, 29.0, 47.0, 15.0, 50.0, 30.0, 36.0, 130.0, 26.0, 30.0, 90.0, 11.0, 160.0, 110.0, -2.0, 10.0, 87.0, 8.0, -30.0, 1.0, 80.0, -28.0, 4.0, 30.0, 60.0, 30.0, 0.0, 40.0, 25.0, 30.0, 8.0, 37.0, 31.0, 10.0, 14.0, -4.0, 23.0, 40.0, 59.0, 60.0, 79.0, 14.0, 23.0, 50.0, 360.0, 27.0, 60.0, 30.0, 15.0, 39.0, 109.0, 40.0, 60.0, 10.0, 30.0, 80.0, -8.0, 50.0, -23.0, -36.0, 8.0, 4.0, -10.0, 26.0, -7.0, -20.0, 13.0, 90.0, 5.0, 0.0, 24.0, -22.0, 30.0, -21.0, -27.0, 60.0, 170.0, 14.0, 30.0, 20.0, 80.0, 4.0, 26.0, 9.0, 25.0, -2.0, 17.0, 11.0, 30.0, 160.0, 40.0, 30.0, 30.0, 40.0, 88.0, 17.0, 6.0, 13.0, 57.0, 40.0, 20.0, 10.0, 60.0, 10.0, -1.0, -1.0, 39.0, 40.0, -60.0, 160.0, 20.0, 33.0, -10.0, 50.0, 40.0, 10.0, 18.0, 30.0, 30.0, 9.0, 20.0, 30.0, 12.0, 10.0, 28.0, 22.0, 50.0, 40.0, 15.0, 0.0, 50.0, 11.0, -16.0, 40.0, 50.0, 10.0, 150.0, 50.0, 20.0, 17.0, 18.0, 60.0, 14.0, 26.0, 60.0, 28.0, 36.0, -11.0, 50.0, 30.0, 18.0, 26.0, -36.0, 30.0, 160.0, 15.0, 39.0, 17.0, 40.0, 40.0, 10.0, 17.0, 30.0, -22.0, 0.0, -5.0, 40.0, 9.0, 160.0, 60.0, 0.0, 9.0, 40.0, 60.0, 30.0, 50.0, 46.0, 14.0, 10.0, 99.0, 27.0, 30.0, 120.0, 4.0, 80.0, -2.0, 70.0, 30.0, -14.0, 17.0, 28.0, 40.0, 16.0, 3.0, -7.0, 50.0, 50.0, 12.0, 9.0, 16.0, -5.0, 39.0, -13.0, 37.0, 60.0, 80.0, 6.0, 150.0, -85.0, 70.0, 36.0, 49.0, 20.0, -20.0, 70.0, 36.0, 20.0, 28.0, 10.0, 170.0, 90.0, 20.0, 10.0, 8.0, 50.0, 60.0, -1.0, 0.0, 40.0, 30.0, 40.0, 30.0, 47.0, 31.0, 71.0, 60.0, 84.0, 19.0, 14.0, 5.0, 54.0, 14.0, -2.0, 80.0, 20.0, 70.0, 30.0, 25.0, 30.0, 30.0, -9.0, -9.0, 30.0, 40.0, -9.0, 24.0, 10.0, 80.0, 30.0, 60.0, -1.0, 0.0, 60.0, 149.0, 10.0, 5.0, 47.0, 30.0, 0.0, -21.0, 58.0, 40.0, 17.0, -6.0, 20.0, -25.0, 50.0, 19.0, 100.0, 10.0, 180.0, 156.0, -24.0, 16.0, 20.0, 1.0, 30.0, 6.0, 40.0, 0.0, -9.0, 40.0, 37.0, 10.0, 50.0, 50.0, 20.0, 18.0, 10.0, 50.0, 20.0, 30.0, 28.0, 16.0, 60.0, 32.0, 150.0, 28.0, 6.0, 9.0, 38.0, 26.0, -9.0, 25.0, 9.0, 41.0, 70.0, 80.0, 28.0, -66.0, 67.0, 40.0, 21.0, 50.0, 20.0, 68.0, 11.0, 27.0, -1.0, 30.0, 14.0, -5.0, 32.0, 79.0, 53.0, 137.0, -8.0, 30.0, 44.0, 58.0, 60.0, 10.0, 60.0, -42.0, 34.0, 2.0, 29.0, 20.0, 1.0, 18.0, 80.0, 38.0, 400.0, 30.0, 10.0, 180.0, 60.0, 20.0, 0.0, 40.0, 0.0, 8.0, 2.0, -7.0, 60.0, 182.0, 20.0, 45.0, 30.0, 39.0, 8.0, 0.0, 70.0, 30.0, 2.0, 50.0, 60.0, 6.0, 45.0, 10.0, 23.0, -2.0, 50.0, 40.0, 118.0, -9.0, -31.0, 97.0, -18.0, 169.0, 20.0, 20.0, 42.0, 45.0, 27.0, 16.0, 23.0, 22.0, 45.0, 17.0, 60.0, 20.0, 70.0, -9.0, 30.0, 67.0, 30.0, 279.0, 100.0, 49.0, 51.0, -4.0, 5.0, 20.0, 29.0, 30.0, 14.0, 40.0, 0.0, 10.0, 30.0, 40.0, 36.0, 30.0, 210.0, -8.0, 50.0, 90.0, 70.0, 40.0, 39.0, 0.0, 80.0, 210.0, 47.0, 55.0, 180.0, 10.0, 39.0, 10.0, 17.0, 51.0, 20.0, 42.0, 25.0, -1.0, 29.0, 80.0, 50.0, 80.0, 73.0, 42.0, 0.0, 30.0, 40.0, 29.0, 40.0, 4.0, 35.0, 60.0, 50.0, 39.0, 158.0, 9.0, 49.0, 60.0, 10.0, 70.0, 20.0, 130.0, 12.0, 90.0, 60.0, 30.0, 60.0, -10.0, -3.0, 15.0, -1.0, 12.0, 57.0, 15.0, 27.0, 20.0, -10.0, 150.0, 17.0, 50.0, 80.0, 50.0, 50.0, -90.0, -8.0, 50.0, 170.0, -9.0, 20.0, -1.0, 70.0, 0.0, 20.0, 88.0, 47.0, 60.0, 79.0, 9.0, 27.0, -7.0, 10.0, 0.0, -2.0, 10.0, 20.0, 10.0, 30.0, 0.0, 30.0, 29.0, 39.0, -79.0, 43.0, 6.0, 30.0, 10.0, 28.0, 90.0, 18.0, 30.0, 0.0, -2.0, 19.0, 60.0, 39.0, 9.0, 22.0, 10.0, 30.0, 40.0, 20.0, 100.0, 23.0, 22.0, 70.0, 180.0, 60.0, 6.0, 60.0, 10.0, 40.0, 25.0, 24.0, 16.0, -21.0, 7.0, 60.0, 8.0, 27.0, -3.0, 10.0, 50.0, 17.0, 40.0, 0.0, 40.0, 160.0, 60.0, 30.0, 60.0, 90.0, 10.0, 50.0, 18.0, 20.0, 30.0, 50.0, 160.0, 157.0, 20.0, -7.0, -2.0, 27.0, 30.0, 19.0, -12.0, 4.0, 40.0, 40.0, -1.0, 15.0, 36.0, 87.0, 74.0, -5.0, 7.0, 90.0, 28.0, 50.0, 6.0, 20.0, 14.0, -9.0, 70.0, 30.0, 70.0, 40.0, 15.0, 22.0, 100.0, 100.0, 16.0, 50.0, -33.0, 100.0, 20.0, 9.0, 50.0, 50.0, 50.0, 60.0, 220.0, 30.0, 49.0, 80.0, 10.0, 360.0, 19.0, 26.0, 40.0, 6.0, -10.0, 19.0, 40.0, 20.0, 13.0, 87.0, 38.0, 20.0, 28.0, 63.0, 30.0, 15.0, 40.0, 160.0, 40.0, 17.0, 50.0, 0.0, 20.0, 90.0, 170.0, 23.0, 10.0, -3.0, -10.0, 50.0, 0.0, 8.0, 39.0, 17.0, 26.0, 70.0, 40.0, 70.0, 40.0, 46.0, 24.0, 18.0, 47.0, 180.0, -10.0, 60.0, 0.0, 150.0, -30.0, 70.0, 40.0, 20.0, 29.0, 48.0, 38.0, 38.0, 100.0, 24.0, 60.0, 8.0, -33.0, 58.0, 28.0, 16.0, 7.0, 30.0, 160.0, 30.0, 75.0, 30.0, 50.0, 10.0, 20.0, 30.0, 50.0, 30.0, 10.0, 0.0, 15.0, 20.0, 0.0, -43.0, 50.0, 40.0, 17.0, 260.0, -3.0, 31.0, 2.0, 0.0, 20.0, 70.0, 30.0, 7.0, 290.0, 243.0, 18.0, -6.0, 80.0, 30.0, 120.0, 2.0, -128.0, 1.0, 40.0, 160.0, 39.0, 37.0, 40.0, 30.0, 40.0, 30.0, 49.0, 164.0, 178.0, 100.0, 10.0, -16.0, 160.0, -2.0, -10.0, 50.0, 39.0, 17.0, 30.0, 70.0, 10.0, -25.0, 40.0, 10.0, 20.0, 80.0, 30.0, 60.0, 30.0, 20.0, 100.0, 20.0, 10.0, -11.0, 45.0, 10.0, 36.0, 10.0, 3.0, 8.0, 178.0, 18.0, 20.0, 3.0, 37.0, 10.0, 39.0, 62.0, 39.0, 130.0, 30.0, 50.0, 30.0, -64.0, 60.0, 60.0, -46.0, 20.0, -8.0, 10.0, -121.0, 60.0, 40.0, 50.0, 180.0, 15.0, 39.0, 20.0, 165.0, 50.0, 80.0, 49.0, 60.0, 50.0, 40.0, 80.0, -50.0, 105.0, 20.0, 40.0, 29.0, 0.0, 50.0, 200.0, 1.0, 35.0, 18.0, 19.0, -50.0, 39.0, 1.0, 15.0, 29.0, 20.0, 20.0, 10.0, 17.0, 0.0, 40.0, 90.0, 13.0, 20.0, 80.0, 50.0, 0.0, 0.0, 50.0, 22.0, 10.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.29838060240654, "mean_inference_ms": 2.652332806360044, "mean_action_processing_ms": 0.8646101450656539, "mean_env_wait_ms": 1.8369571397120077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07611417770385742, "StateBufferConnector_ms": 0.010281562805175781, "ViewRequirementAgentConnector_ms": 0.4481635093688965}, "num_episodes": 23, "episode_return_max": 778.0, "episode_return_min": 76.0, "episode_return_mean": 368.85, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.895732845650095, "num_env_steps_trained_throughput_per_sec": 32.895732845650095, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 120589.827, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120589.78, "sample_time_ms": 2800.036, "learn_time_ms": 117769.659, "learn_throughput": 33.965, "synch_weights_time_ms": 11.779}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 44, "trial_id": "6085c_00000", "date": "2024-07-02_00-27-32", "timestamp": 1719894452, "time_this_iter_s": 121.60718202590942, "time_total_s": 7299.834191560745, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7299.834191560745, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 28.759883720930233, "ram_util_percent": 79.60988372093023}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.599294028520838, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.305020850128767, "policy_loss": -0.00419657316622478, "vf_loss": 5.308013771314083, "vf_explained_var": 0.012377675571126805, "kl": 0.012036503603364399, "entropy": 1.485841157146917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 417855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 788.0, "episode_reward_min": 125.0, "episode_reward_mean": 377.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -128.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 37.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.0, 349.0, 727.0, 211.0, 125.0, 334.0, 320.0, 341.0, 277.0, 230.0, 257.0, 350.0, 311.0, 341.0, 289.0, 385.0, 363.0, 184.0, 380.0, 473.0, 257.0, 415.0, 288.0, 255.0, 338.0, 405.0, 236.0, 305.0, 397.0, 271.0, 280.0, 480.0, 212.0, 778.0, 387.0, 296.0, 434.0, 317.0, 687.0, 174.0, 597.0, 648.0, 449.0, 330.0, 557.0, 310.0, 449.0, 222.0, 311.0, 132.0, 229.0, 353.0, 497.0, 171.0, 540.0, 473.0, 258.0, 275.0, 513.0, 556.0, 599.0, 354.0, 610.0, 207.0, 515.0, 403.0, 298.0, 485.0, 369.0, 690.0, 317.0, 707.0, 348.0, 275.0, 231.0, 536.0, 142.0, 498.0, 474.0, 341.0, 242.0, 285.0, 549.0, 788.0, 318.0, 410.0, 157.0, 231.0, 350.0, 249.0, 507.0, 352.0, 296.0, 373.0, 285.0, 640.0, 345.0, 339.0, 517.0, 565.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-28.0, 4.0, 30.0, 60.0, 30.0, 0.0, 40.0, 25.0, 30.0, 8.0, 37.0, 31.0, 10.0, 14.0, -4.0, 23.0, 40.0, 59.0, 60.0, 79.0, 14.0, 23.0, 50.0, 360.0, 27.0, 60.0, 30.0, 15.0, 39.0, 109.0, 40.0, 60.0, 10.0, 30.0, 80.0, -8.0, 50.0, -23.0, -36.0, 8.0, 4.0, -10.0, 26.0, -7.0, -20.0, 13.0, 90.0, 5.0, 0.0, 24.0, -22.0, 30.0, -21.0, -27.0, 60.0, 170.0, 14.0, 30.0, 20.0, 80.0, 4.0, 26.0, 9.0, 25.0, -2.0, 17.0, 11.0, 30.0, 160.0, 40.0, 30.0, 30.0, 40.0, 88.0, 17.0, 6.0, 13.0, 57.0, 40.0, 20.0, 10.0, 60.0, 10.0, -1.0, -1.0, 39.0, 40.0, -60.0, 160.0, 20.0, 33.0, -10.0, 50.0, 40.0, 10.0, 18.0, 30.0, 30.0, 9.0, 20.0, 30.0, 12.0, 10.0, 28.0, 22.0, 50.0, 40.0, 15.0, 0.0, 50.0, 11.0, -16.0, 40.0, 50.0, 10.0, 150.0, 50.0, 20.0, 17.0, 18.0, 60.0, 14.0, 26.0, 60.0, 28.0, 36.0, -11.0, 50.0, 30.0, 18.0, 26.0, -36.0, 30.0, 160.0, 15.0, 39.0, 17.0, 40.0, 40.0, 10.0, 17.0, 30.0, -22.0, 0.0, -5.0, 40.0, 9.0, 160.0, 60.0, 0.0, 9.0, 40.0, 60.0, 30.0, 50.0, 46.0, 14.0, 10.0, 99.0, 27.0, 30.0, 120.0, 4.0, 80.0, -2.0, 70.0, 30.0, -14.0, 17.0, 28.0, 40.0, 16.0, 3.0, -7.0, 50.0, 50.0, 12.0, 9.0, 16.0, -5.0, 39.0, -13.0, 37.0, 60.0, 80.0, 6.0, 150.0, -85.0, 70.0, 36.0, 49.0, 20.0, -20.0, 70.0, 36.0, 20.0, 28.0, 10.0, 170.0, 90.0, 20.0, 10.0, 8.0, 50.0, 60.0, -1.0, 0.0, 40.0, 30.0, 40.0, 30.0, 47.0, 31.0, 71.0, 60.0, 84.0, 19.0, 14.0, 5.0, 54.0, 14.0, -2.0, 80.0, 20.0, 70.0, 30.0, 25.0, 30.0, 30.0, -9.0, -9.0, 30.0, 40.0, -9.0, 24.0, 10.0, 80.0, 30.0, 60.0, -1.0, 0.0, 60.0, 149.0, 10.0, 5.0, 47.0, 30.0, 0.0, -21.0, 58.0, 40.0, 17.0, -6.0, 20.0, -25.0, 50.0, 19.0, 100.0, 10.0, 180.0, 156.0, -24.0, 16.0, 20.0, 1.0, 30.0, 6.0, 40.0, 0.0, -9.0, 40.0, 37.0, 10.0, 50.0, 50.0, 20.0, 18.0, 10.0, 50.0, 20.0, 30.0, 28.0, 16.0, 60.0, 32.0, 150.0, 28.0, 6.0, 9.0, 38.0, 26.0, -9.0, 25.0, 9.0, 41.0, 70.0, 80.0, 28.0, -66.0, 67.0, 40.0, 21.0, 50.0, 20.0, 68.0, 11.0, 27.0, -1.0, 30.0, 14.0, -5.0, 32.0, 79.0, 53.0, 137.0, -8.0, 30.0, 44.0, 58.0, 60.0, 10.0, 60.0, -42.0, 34.0, 2.0, 29.0, 20.0, 1.0, 18.0, 80.0, 38.0, 400.0, 30.0, 10.0, 180.0, 60.0, 20.0, 0.0, 40.0, 0.0, 8.0, 2.0, -7.0, 60.0, 182.0, 20.0, 45.0, 30.0, 39.0, 8.0, 0.0, 70.0, 30.0, 2.0, 50.0, 60.0, 6.0, 45.0, 10.0, 23.0, -2.0, 50.0, 40.0, 118.0, -9.0, -31.0, 97.0, -18.0, 169.0, 20.0, 20.0, 42.0, 45.0, 27.0, 16.0, 23.0, 22.0, 45.0, 17.0, 60.0, 20.0, 70.0, -9.0, 30.0, 67.0, 30.0, 279.0, 100.0, 49.0, 51.0, -4.0, 5.0, 20.0, 29.0, 30.0, 14.0, 40.0, 0.0, 10.0, 30.0, 40.0, 36.0, 30.0, 210.0, -8.0, 50.0, 90.0, 70.0, 40.0, 39.0, 0.0, 80.0, 210.0, 47.0, 55.0, 180.0, 10.0, 39.0, 10.0, 17.0, 51.0, 20.0, 42.0, 25.0, -1.0, 29.0, 80.0, 50.0, 80.0, 73.0, 42.0, 0.0, 30.0, 40.0, 29.0, 40.0, 4.0, 35.0, 60.0, 50.0, 39.0, 158.0, 9.0, 49.0, 60.0, 10.0, 70.0, 20.0, 130.0, 12.0, 90.0, 60.0, 30.0, 60.0, -10.0, -3.0, 15.0, -1.0, 12.0, 57.0, 15.0, 27.0, 20.0, -10.0, 150.0, 17.0, 50.0, 80.0, 50.0, 50.0, -90.0, -8.0, 50.0, 170.0, -9.0, 20.0, -1.0, 70.0, 0.0, 20.0, 88.0, 47.0, 60.0, 79.0, 9.0, 27.0, -7.0, 10.0, 0.0, -2.0, 10.0, 20.0, 10.0, 30.0, 0.0, 30.0, 29.0, 39.0, -79.0, 43.0, 6.0, 30.0, 10.0, 28.0, 90.0, 18.0, 30.0, 0.0, -2.0, 19.0, 60.0, 39.0, 9.0, 22.0, 10.0, 30.0, 40.0, 20.0, 100.0, 23.0, 22.0, 70.0, 180.0, 60.0, 6.0, 60.0, 10.0, 40.0, 25.0, 24.0, 16.0, -21.0, 7.0, 60.0, 8.0, 27.0, -3.0, 10.0, 50.0, 17.0, 40.0, 0.0, 40.0, 160.0, 60.0, 30.0, 60.0, 90.0, 10.0, 50.0, 18.0, 20.0, 30.0, 50.0, 160.0, 157.0, 20.0, -7.0, -2.0, 27.0, 30.0, 19.0, -12.0, 4.0, 40.0, 40.0, -1.0, 15.0, 36.0, 87.0, 74.0, -5.0, 7.0, 90.0, 28.0, 50.0, 6.0, 20.0, 14.0, -9.0, 70.0, 30.0, 70.0, 40.0, 15.0, 22.0, 100.0, 100.0, 16.0, 50.0, -33.0, 100.0, 20.0, 9.0, 50.0, 50.0, 50.0, 60.0, 220.0, 30.0, 49.0, 80.0, 10.0, 360.0, 19.0, 26.0, 40.0, 6.0, -10.0, 19.0, 40.0, 20.0, 13.0, 87.0, 38.0, 20.0, 28.0, 63.0, 30.0, 15.0, 40.0, 160.0, 40.0, 17.0, 50.0, 0.0, 20.0, 90.0, 170.0, 23.0, 10.0, -3.0, -10.0, 50.0, 0.0, 8.0, 39.0, 17.0, 26.0, 70.0, 40.0, 70.0, 40.0, 46.0, 24.0, 18.0, 47.0, 180.0, -10.0, 60.0, 0.0, 150.0, -30.0, 70.0, 40.0, 20.0, 29.0, 48.0, 38.0, 38.0, 100.0, 24.0, 60.0, 8.0, -33.0, 58.0, 28.0, 16.0, 7.0, 30.0, 160.0, 30.0, 75.0, 30.0, 50.0, 10.0, 20.0, 30.0, 50.0, 30.0, 10.0, 0.0, 15.0, 20.0, 0.0, -43.0, 50.0, 40.0, 17.0, 260.0, -3.0, 31.0, 2.0, 0.0, 20.0, 70.0, 30.0, 7.0, 290.0, 243.0, 18.0, -6.0, 80.0, 30.0, 120.0, 2.0, -128.0, 1.0, 40.0, 160.0, 39.0, 37.0, 40.0, 30.0, 40.0, 30.0, 49.0, 164.0, 178.0, 100.0, 10.0, -16.0, 160.0, -2.0, -10.0, 50.0, 39.0, 17.0, 30.0, 70.0, 10.0, -25.0, 40.0, 10.0, 20.0, 80.0, 30.0, 60.0, 30.0, 20.0, 100.0, 20.0, 10.0, -11.0, 45.0, 10.0, 36.0, 10.0, 3.0, 8.0, 178.0, 18.0, 20.0, 3.0, 37.0, 10.0, 39.0, 62.0, 39.0, 130.0, 30.0, 50.0, 30.0, -64.0, 60.0, 60.0, -46.0, 20.0, -8.0, 10.0, -121.0, 60.0, 40.0, 50.0, 180.0, 15.0, 39.0, 20.0, 165.0, 50.0, 80.0, 49.0, 60.0, 50.0, 40.0, 80.0, -50.0, 105.0, 20.0, 40.0, 29.0, 0.0, 50.0, 200.0, 1.0, 35.0, 18.0, 19.0, -50.0, 39.0, 1.0, 15.0, 29.0, 20.0, 20.0, 10.0, 17.0, 0.0, 40.0, 90.0, 13.0, 20.0, 80.0, 50.0, 0.0, 0.0, 50.0, 22.0, 10.0, 40.0, 0.0, 50.0, 50.0, 33.0, 10.0, 270.0, 110.0, 38.0, 36.0, -48.0, 46.0, 12.0, 5.0, 35.0, 600.0, 10.0, 0.0, 10.0, 70.0, 0.0, 30.0, 120.0, 20.0, 20.0, 20.0, 20.0, 2.0, -9.0, 65.0, 30.0, 48.0, 70.0, 60.0, 5.0, 30.0, 37.0, 17.0, 68.0, 45.0, 30.0, -22.0, 14.0, 19.0, 0.0, 70.0, -6.0, 20.0, 16.0, 30.0, 16.0, -16.0, 70.0, 40.0, 7.0, 6.0, 8.0, 60.0, 30.0, 16.0, 10.0, -50.0, 58.0, -35.0, 80.0, 159.0, -70.0, 80.0, 50.0, 30.0, 48.0, 10.0, -1.0, 24.0, 17.0, 60.0, 39.0, 14.0, 31.0, 47.0, 8.0, 58.0, 30.0, 50.0, 50.0, 30.0, 10.0, 130.0, 89.0, 20.0, 40.0, 14.0, 50.0, -6.0, 10.0, 70.0, 37.0, 90.0, 17.0, 30.0, 40.0, 16.0, 25.0, 30.0, 16.0, 30.0, 40.0, 50.0, 29.0, 30.0, 30.0, 30.0, 62.0, 10.0, -20.0, -1.0, 14.0, 160.0, 20.0, 58.0, 40.0, 60.0, 29.0, -11.0, -5.0, 42.0, 13.0, -1.0, 67.0, -9.0, 100.0, 80.0, 80.0, 22.0, 250.0, 3.0, 25.0, -3.0, 60.0, 63.0, 60.0, -3.0, 10.0, 100.0, 150.0, 60.0, 5.0, 38.0, -44.0, 39.0, -10.0, 60.0, 60.0, 50.0, -7.0, -6.0, 60.0, 80.0, 4.0, 13.0, 25.0, 210.0, 60.0, 40.0, 59.0, 50.0, 26.0, 80.0, 7.0, 20.0, -35.0, 17.0, 109.0, 80.0, 33.0, 48.0, 13.0, 27.0, 30.0, 178.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.281726303573624, "mean_inference_ms": 2.632104243155072, "mean_action_processing_ms": 0.8592975177556166, "mean_env_wait_ms": 1.8246449750284586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0704946517944336, "StateBufferConnector_ms": 0.010014057159423828, "ViewRequirementAgentConnector_ms": 0.4428999423980713}, "num_episodes": 18, "episode_return_max": 788.0, "episode_return_min": 125.0, "episode_return_mean": 377.25, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.380601383355724, "num_env_steps_trained_throughput_per_sec": 33.380601383355724, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 120513.911, "restore_workers_time_ms": 0.012, "training_step_time_ms": 120513.866, "sample_time_ms": 2781.016, "learn_time_ms": 117713.031, "learn_throughput": 33.981, "synch_weights_time_ms": 11.664}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 45, "trial_id": "6085c_00000", "date": "2024-07-02_00-29-32", "timestamp": 1719894572, "time_this_iter_s": 119.84257411956787, "time_total_s": 7419.676765680313, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7419.676765680313, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 28.45117647058823, "ram_util_percent": 79.22411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8584614955452174, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.086078320930814, "policy_loss": -0.005376762527644166, "vf_loss": 6.090327677000572, "vf_explained_var": 0.015609376664105822, "kl": 0.011274022244097185, "entropy": 1.4507126411436972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 427245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 805.0, "episode_reward_min": 132.0, "episode_reward_mean": 396.61, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -128.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 39.661}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 473.0, 257.0, 415.0, 288.0, 255.0, 338.0, 405.0, 236.0, 305.0, 397.0, 271.0, 280.0, 480.0, 212.0, 778.0, 387.0, 296.0, 434.0, 317.0, 687.0, 174.0, 597.0, 648.0, 449.0, 330.0, 557.0, 310.0, 449.0, 222.0, 311.0, 132.0, 229.0, 353.0, 497.0, 171.0, 540.0, 473.0, 258.0, 275.0, 513.0, 556.0, 599.0, 354.0, 610.0, 207.0, 515.0, 403.0, 298.0, 485.0, 369.0, 690.0, 317.0, 707.0, 348.0, 275.0, 231.0, 536.0, 142.0, 498.0, 474.0, 341.0, 242.0, 285.0, 549.0, 788.0, 318.0, 410.0, 157.0, 231.0, 350.0, 249.0, 507.0, 352.0, 296.0, 373.0, 285.0, 640.0, 345.0, 339.0, 517.0, 565.0, 306.0, 311.0, 518.0, 805.0, 415.0, 292.0, 500.0, 460.0, 234.0, 451.0, 658.0, 329.0, 276.0, 609.0, 305.0, 260.0, 467.0, 333.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [39.0, -13.0, 37.0, 60.0, 80.0, 6.0, 150.0, -85.0, 70.0, 36.0, 49.0, 20.0, -20.0, 70.0, 36.0, 20.0, 28.0, 10.0, 170.0, 90.0, 20.0, 10.0, 8.0, 50.0, 60.0, -1.0, 0.0, 40.0, 30.0, 40.0, 30.0, 47.0, 31.0, 71.0, 60.0, 84.0, 19.0, 14.0, 5.0, 54.0, 14.0, -2.0, 80.0, 20.0, 70.0, 30.0, 25.0, 30.0, 30.0, -9.0, -9.0, 30.0, 40.0, -9.0, 24.0, 10.0, 80.0, 30.0, 60.0, -1.0, 0.0, 60.0, 149.0, 10.0, 5.0, 47.0, 30.0, 0.0, -21.0, 58.0, 40.0, 17.0, -6.0, 20.0, -25.0, 50.0, 19.0, 100.0, 10.0, 180.0, 156.0, -24.0, 16.0, 20.0, 1.0, 30.0, 6.0, 40.0, 0.0, -9.0, 40.0, 37.0, 10.0, 50.0, 50.0, 20.0, 18.0, 10.0, 50.0, 20.0, 30.0, 28.0, 16.0, 60.0, 32.0, 150.0, 28.0, 6.0, 9.0, 38.0, 26.0, -9.0, 25.0, 9.0, 41.0, 70.0, 80.0, 28.0, -66.0, 67.0, 40.0, 21.0, 50.0, 20.0, 68.0, 11.0, 27.0, -1.0, 30.0, 14.0, -5.0, 32.0, 79.0, 53.0, 137.0, -8.0, 30.0, 44.0, 58.0, 60.0, 10.0, 60.0, -42.0, 34.0, 2.0, 29.0, 20.0, 1.0, 18.0, 80.0, 38.0, 400.0, 30.0, 10.0, 180.0, 60.0, 20.0, 0.0, 40.0, 0.0, 8.0, 2.0, -7.0, 60.0, 182.0, 20.0, 45.0, 30.0, 39.0, 8.0, 0.0, 70.0, 30.0, 2.0, 50.0, 60.0, 6.0, 45.0, 10.0, 23.0, -2.0, 50.0, 40.0, 118.0, -9.0, -31.0, 97.0, -18.0, 169.0, 20.0, 20.0, 42.0, 45.0, 27.0, 16.0, 23.0, 22.0, 45.0, 17.0, 60.0, 20.0, 70.0, -9.0, 30.0, 67.0, 30.0, 279.0, 100.0, 49.0, 51.0, -4.0, 5.0, 20.0, 29.0, 30.0, 14.0, 40.0, 0.0, 10.0, 30.0, 40.0, 36.0, 30.0, 210.0, -8.0, 50.0, 90.0, 70.0, 40.0, 39.0, 0.0, 80.0, 210.0, 47.0, 55.0, 180.0, 10.0, 39.0, 10.0, 17.0, 51.0, 20.0, 42.0, 25.0, -1.0, 29.0, 80.0, 50.0, 80.0, 73.0, 42.0, 0.0, 30.0, 40.0, 29.0, 40.0, 4.0, 35.0, 60.0, 50.0, 39.0, 158.0, 9.0, 49.0, 60.0, 10.0, 70.0, 20.0, 130.0, 12.0, 90.0, 60.0, 30.0, 60.0, -10.0, -3.0, 15.0, -1.0, 12.0, 57.0, 15.0, 27.0, 20.0, -10.0, 150.0, 17.0, 50.0, 80.0, 50.0, 50.0, -90.0, -8.0, 50.0, 170.0, -9.0, 20.0, -1.0, 70.0, 0.0, 20.0, 88.0, 47.0, 60.0, 79.0, 9.0, 27.0, -7.0, 10.0, 0.0, -2.0, 10.0, 20.0, 10.0, 30.0, 0.0, 30.0, 29.0, 39.0, -79.0, 43.0, 6.0, 30.0, 10.0, 28.0, 90.0, 18.0, 30.0, 0.0, -2.0, 19.0, 60.0, 39.0, 9.0, 22.0, 10.0, 30.0, 40.0, 20.0, 100.0, 23.0, 22.0, 70.0, 180.0, 60.0, 6.0, 60.0, 10.0, 40.0, 25.0, 24.0, 16.0, -21.0, 7.0, 60.0, 8.0, 27.0, -3.0, 10.0, 50.0, 17.0, 40.0, 0.0, 40.0, 160.0, 60.0, 30.0, 60.0, 90.0, 10.0, 50.0, 18.0, 20.0, 30.0, 50.0, 160.0, 157.0, 20.0, -7.0, -2.0, 27.0, 30.0, 19.0, -12.0, 4.0, 40.0, 40.0, -1.0, 15.0, 36.0, 87.0, 74.0, -5.0, 7.0, 90.0, 28.0, 50.0, 6.0, 20.0, 14.0, -9.0, 70.0, 30.0, 70.0, 40.0, 15.0, 22.0, 100.0, 100.0, 16.0, 50.0, -33.0, 100.0, 20.0, 9.0, 50.0, 50.0, 50.0, 60.0, 220.0, 30.0, 49.0, 80.0, 10.0, 360.0, 19.0, 26.0, 40.0, 6.0, -10.0, 19.0, 40.0, 20.0, 13.0, 87.0, 38.0, 20.0, 28.0, 63.0, 30.0, 15.0, 40.0, 160.0, 40.0, 17.0, 50.0, 0.0, 20.0, 90.0, 170.0, 23.0, 10.0, -3.0, -10.0, 50.0, 0.0, 8.0, 39.0, 17.0, 26.0, 70.0, 40.0, 70.0, 40.0, 46.0, 24.0, 18.0, 47.0, 180.0, -10.0, 60.0, 0.0, 150.0, -30.0, 70.0, 40.0, 20.0, 29.0, 48.0, 38.0, 38.0, 100.0, 24.0, 60.0, 8.0, -33.0, 58.0, 28.0, 16.0, 7.0, 30.0, 160.0, 30.0, 75.0, 30.0, 50.0, 10.0, 20.0, 30.0, 50.0, 30.0, 10.0, 0.0, 15.0, 20.0, 0.0, -43.0, 50.0, 40.0, 17.0, 260.0, -3.0, 31.0, 2.0, 0.0, 20.0, 70.0, 30.0, 7.0, 290.0, 243.0, 18.0, -6.0, 80.0, 30.0, 120.0, 2.0, -128.0, 1.0, 40.0, 160.0, 39.0, 37.0, 40.0, 30.0, 40.0, 30.0, 49.0, 164.0, 178.0, 100.0, 10.0, -16.0, 160.0, -2.0, -10.0, 50.0, 39.0, 17.0, 30.0, 70.0, 10.0, -25.0, 40.0, 10.0, 20.0, 80.0, 30.0, 60.0, 30.0, 20.0, 100.0, 20.0, 10.0, -11.0, 45.0, 10.0, 36.0, 10.0, 3.0, 8.0, 178.0, 18.0, 20.0, 3.0, 37.0, 10.0, 39.0, 62.0, 39.0, 130.0, 30.0, 50.0, 30.0, -64.0, 60.0, 60.0, -46.0, 20.0, -8.0, 10.0, -121.0, 60.0, 40.0, 50.0, 180.0, 15.0, 39.0, 20.0, 165.0, 50.0, 80.0, 49.0, 60.0, 50.0, 40.0, 80.0, -50.0, 105.0, 20.0, 40.0, 29.0, 0.0, 50.0, 200.0, 1.0, 35.0, 18.0, 19.0, -50.0, 39.0, 1.0, 15.0, 29.0, 20.0, 20.0, 10.0, 17.0, 0.0, 40.0, 90.0, 13.0, 20.0, 80.0, 50.0, 0.0, 0.0, 50.0, 22.0, 10.0, 40.0, 0.0, 50.0, 50.0, 33.0, 10.0, 270.0, 110.0, 38.0, 36.0, -48.0, 46.0, 12.0, 5.0, 35.0, 600.0, 10.0, 0.0, 10.0, 70.0, 0.0, 30.0, 120.0, 20.0, 20.0, 20.0, 20.0, 2.0, -9.0, 65.0, 30.0, 48.0, 70.0, 60.0, 5.0, 30.0, 37.0, 17.0, 68.0, 45.0, 30.0, -22.0, 14.0, 19.0, 0.0, 70.0, -6.0, 20.0, 16.0, 30.0, 16.0, -16.0, 70.0, 40.0, 7.0, 6.0, 8.0, 60.0, 30.0, 16.0, 10.0, -50.0, 58.0, -35.0, 80.0, 159.0, -70.0, 80.0, 50.0, 30.0, 48.0, 10.0, -1.0, 24.0, 17.0, 60.0, 39.0, 14.0, 31.0, 47.0, 8.0, 58.0, 30.0, 50.0, 50.0, 30.0, 10.0, 130.0, 89.0, 20.0, 40.0, 14.0, 50.0, -6.0, 10.0, 70.0, 37.0, 90.0, 17.0, 30.0, 40.0, 16.0, 25.0, 30.0, 16.0, 30.0, 40.0, 50.0, 29.0, 30.0, 30.0, 30.0, 62.0, 10.0, -20.0, -1.0, 14.0, 160.0, 20.0, 58.0, 40.0, 60.0, 29.0, -11.0, -5.0, 42.0, 13.0, -1.0, 67.0, -9.0, 100.0, 80.0, 80.0, 22.0, 250.0, 3.0, 25.0, -3.0, 60.0, 63.0, 60.0, -3.0, 10.0, 100.0, 150.0, 60.0, 5.0, 38.0, -44.0, 39.0, -10.0, 60.0, 60.0, 50.0, -7.0, -6.0, 60.0, 80.0, 4.0, 13.0, 25.0, 210.0, 60.0, 40.0, 59.0, 50.0, 26.0, 80.0, 7.0, 20.0, -35.0, 17.0, 109.0, 80.0, 33.0, 48.0, 13.0, 27.0, 30.0, 178.0, 30.0, 160.0, 10.0, 19.0, 4.0, 60.0, -5.0, 40.0, -2.0, 20.0, 0.0, 6.0, 69.0, 16.0, 44.0, 3.0, 29.0, -21.0, 156.0, 8.0, 1.0, -27.0, 160.0, 180.0, 0.0, 40.0, 90.0, 30.0, 50.0, 10.0, -15.0, 167.0, 40.0, 50.0, 170.0, 190.0, 56.0, 0.0, 82.0, 60.0, -10.0, 64.0, 40.0, 58.0, 15.0, 40.0, 83.0, 40.0, 30.0, 25.0, 20.0, -9.0, 14.0, 37.0, 20.0, 18.0, 25.0, 70.0, 50.0, 60.0, 7.0, 25.0, 40.0, 20.0, 27.0, 190.0, 100.0, 30.0, 11.0, 34.0, 23.0, 160.0, 200.0, 60.0, -10.0, 30.0, 10.0, 18.0, -16.0, 20.0, -12.0, 15.0, 20.0, 12.0, 30.0, 60.0, -11.0, 60.0, 0.0, 38.0, 10.0, 40.0, 37.0, 13.0, 18.0, 40.0, 150.0, 70.0, 38.0, 17.0, 28.0, 80.0, 10.0, 17.0, 80.0, 60.0, -20.0, 60.0, 70.0, 180.0, 121.0, -13.0, 170.0, 40.0, 60.0, -34.0, 40.0, 60.0, 4.0, 7.0, -5.0, 60.0, 47.0, 30.0, 0.0, 20.0, 50.0, 9.0, 40.0, 10.0, 10.0, 33.0, 9.0, 25.0, 80.0, 30.0, 48.0, 24.0, 100.0, 260.0, 0.0, -5.0, 30.0, 50.0, 61.0, 29.0, 7.0, -1.0, 30.0, 50.0, 54.0, 72.0, -1.0, 10.0, 10.0, 30.0, 30.0, 49.0, -9.0, 31.0, 38.0, 120.0, 50.0, 30.0, 65.0, 20.0, 60.0, 60.0, 20.0, 2.0, 40.0, 180.0, 10.0, 40.0, 3.0, 63.0, -4.0, 26.0, 3.0, 17.0, -5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2657669664390703, "mean_inference_ms": 2.6125631438001435, "mean_action_processing_ms": 0.8541792591289149, "mean_env_wait_ms": 1.8128980780227113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06969285011291504, "StateBufferConnector_ms": 0.009850025177001953, "ViewRequirementAgentConnector_ms": 0.44205546379089355}, "num_episodes": 18, "episode_return_max": 805.0, "episode_return_min": 132.0, "episode_return_mean": 396.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.91152064923964, "num_env_steps_trained_throughput_per_sec": 32.91152064923964, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 120614.125, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120614.079, "sample_time_ms": 2777.615, "learn_time_ms": 117816.28, "learn_throughput": 33.951, "synch_weights_time_ms": 11.154}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 46, "trial_id": "6085c_00000", "date": "2024-07-02_00-31-33", "timestamp": 1719894693, "time_this_iter_s": 121.55248498916626, "time_total_s": 7541.229250669479, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7541.229250669479, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 28.997093023255815, "ram_util_percent": 79.02674418604651}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.669699669062012, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.830008777033407, "policy_loss": -0.005014302634388105, "vf_loss": 5.8339634053369425, "vf_explained_var": 0.024014431453995302, "kl": 0.01059677192812185, "entropy": 1.4502603520600559, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 436635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "env_runners": {"episode_reward_max": 820.0, "episode_reward_min": -28.0, "episode_reward_mean": 413.07, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -128.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 41.307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [597.0, 648.0, 449.0, 330.0, 557.0, 310.0, 449.0, 222.0, 311.0, 132.0, 229.0, 353.0, 497.0, 171.0, 540.0, 473.0, 258.0, 275.0, 513.0, 556.0, 599.0, 354.0, 610.0, 207.0, 515.0, 403.0, 298.0, 485.0, 369.0, 690.0, 317.0, 707.0, 348.0, 275.0, 231.0, 536.0, 142.0, 498.0, 474.0, 341.0, 242.0, 285.0, 549.0, 788.0, 318.0, 410.0, 157.0, 231.0, 350.0, 249.0, 507.0, 352.0, 296.0, 373.0, 285.0, 640.0, 345.0, 339.0, 517.0, 565.0, 306.0, 311.0, 518.0, 805.0, 415.0, 292.0, 500.0, 460.0, 234.0, 451.0, 658.0, 329.0, 276.0, 609.0, 305.0, 260.0, 467.0, 333.0, 598.0, 405.0, 489.0, 693.0, 420.0, 335.0, 239.0, 458.0, 275.0, 571.0, 457.0, 304.0, 403.0, 523.0, -28.0, 652.0, 431.0, 437.0, 355.0, 267.0, 820.0, 607.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 36.0, 30.0, 210.0, -8.0, 50.0, 90.0, 70.0, 40.0, 39.0, 0.0, 80.0, 210.0, 47.0, 55.0, 180.0, 10.0, 39.0, 10.0, 17.0, 51.0, 20.0, 42.0, 25.0, -1.0, 29.0, 80.0, 50.0, 80.0, 73.0, 42.0, 0.0, 30.0, 40.0, 29.0, 40.0, 4.0, 35.0, 60.0, 50.0, 39.0, 158.0, 9.0, 49.0, 60.0, 10.0, 70.0, 20.0, 130.0, 12.0, 90.0, 60.0, 30.0, 60.0, -10.0, -3.0, 15.0, -1.0, 12.0, 57.0, 15.0, 27.0, 20.0, -10.0, 150.0, 17.0, 50.0, 80.0, 50.0, 50.0, -90.0, -8.0, 50.0, 170.0, -9.0, 20.0, -1.0, 70.0, 0.0, 20.0, 88.0, 47.0, 60.0, 79.0, 9.0, 27.0, -7.0, 10.0, 0.0, -2.0, 10.0, 20.0, 10.0, 30.0, 0.0, 30.0, 29.0, 39.0, -79.0, 43.0, 6.0, 30.0, 10.0, 28.0, 90.0, 18.0, 30.0, 0.0, -2.0, 19.0, 60.0, 39.0, 9.0, 22.0, 10.0, 30.0, 40.0, 20.0, 100.0, 23.0, 22.0, 70.0, 180.0, 60.0, 6.0, 60.0, 10.0, 40.0, 25.0, 24.0, 16.0, -21.0, 7.0, 60.0, 8.0, 27.0, -3.0, 10.0, 50.0, 17.0, 40.0, 0.0, 40.0, 160.0, 60.0, 30.0, 60.0, 90.0, 10.0, 50.0, 18.0, 20.0, 30.0, 50.0, 160.0, 157.0, 20.0, -7.0, -2.0, 27.0, 30.0, 19.0, -12.0, 4.0, 40.0, 40.0, -1.0, 15.0, 36.0, 87.0, 74.0, -5.0, 7.0, 90.0, 28.0, 50.0, 6.0, 20.0, 14.0, -9.0, 70.0, 30.0, 70.0, 40.0, 15.0, 22.0, 100.0, 100.0, 16.0, 50.0, -33.0, 100.0, 20.0, 9.0, 50.0, 50.0, 50.0, 60.0, 220.0, 30.0, 49.0, 80.0, 10.0, 360.0, 19.0, 26.0, 40.0, 6.0, -10.0, 19.0, 40.0, 20.0, 13.0, 87.0, 38.0, 20.0, 28.0, 63.0, 30.0, 15.0, 40.0, 160.0, 40.0, 17.0, 50.0, 0.0, 20.0, 90.0, 170.0, 23.0, 10.0, -3.0, -10.0, 50.0, 0.0, 8.0, 39.0, 17.0, 26.0, 70.0, 40.0, 70.0, 40.0, 46.0, 24.0, 18.0, 47.0, 180.0, -10.0, 60.0, 0.0, 150.0, -30.0, 70.0, 40.0, 20.0, 29.0, 48.0, 38.0, 38.0, 100.0, 24.0, 60.0, 8.0, -33.0, 58.0, 28.0, 16.0, 7.0, 30.0, 160.0, 30.0, 75.0, 30.0, 50.0, 10.0, 20.0, 30.0, 50.0, 30.0, 10.0, 0.0, 15.0, 20.0, 0.0, -43.0, 50.0, 40.0, 17.0, 260.0, -3.0, 31.0, 2.0, 0.0, 20.0, 70.0, 30.0, 7.0, 290.0, 243.0, 18.0, -6.0, 80.0, 30.0, 120.0, 2.0, -128.0, 1.0, 40.0, 160.0, 39.0, 37.0, 40.0, 30.0, 40.0, 30.0, 49.0, 164.0, 178.0, 100.0, 10.0, -16.0, 160.0, -2.0, -10.0, 50.0, 39.0, 17.0, 30.0, 70.0, 10.0, -25.0, 40.0, 10.0, 20.0, 80.0, 30.0, 60.0, 30.0, 20.0, 100.0, 20.0, 10.0, -11.0, 45.0, 10.0, 36.0, 10.0, 3.0, 8.0, 178.0, 18.0, 20.0, 3.0, 37.0, 10.0, 39.0, 62.0, 39.0, 130.0, 30.0, 50.0, 30.0, -64.0, 60.0, 60.0, -46.0, 20.0, -8.0, 10.0, -121.0, 60.0, 40.0, 50.0, 180.0, 15.0, 39.0, 20.0, 165.0, 50.0, 80.0, 49.0, 60.0, 50.0, 40.0, 80.0, -50.0, 105.0, 20.0, 40.0, 29.0, 0.0, 50.0, 200.0, 1.0, 35.0, 18.0, 19.0, -50.0, 39.0, 1.0, 15.0, 29.0, 20.0, 20.0, 10.0, 17.0, 0.0, 40.0, 90.0, 13.0, 20.0, 80.0, 50.0, 0.0, 0.0, 50.0, 22.0, 10.0, 40.0, 0.0, 50.0, 50.0, 33.0, 10.0, 270.0, 110.0, 38.0, 36.0, -48.0, 46.0, 12.0, 5.0, 35.0, 600.0, 10.0, 0.0, 10.0, 70.0, 0.0, 30.0, 120.0, 20.0, 20.0, 20.0, 20.0, 2.0, -9.0, 65.0, 30.0, 48.0, 70.0, 60.0, 5.0, 30.0, 37.0, 17.0, 68.0, 45.0, 30.0, -22.0, 14.0, 19.0, 0.0, 70.0, -6.0, 20.0, 16.0, 30.0, 16.0, -16.0, 70.0, 40.0, 7.0, 6.0, 8.0, 60.0, 30.0, 16.0, 10.0, -50.0, 58.0, -35.0, 80.0, 159.0, -70.0, 80.0, 50.0, 30.0, 48.0, 10.0, -1.0, 24.0, 17.0, 60.0, 39.0, 14.0, 31.0, 47.0, 8.0, 58.0, 30.0, 50.0, 50.0, 30.0, 10.0, 130.0, 89.0, 20.0, 40.0, 14.0, 50.0, -6.0, 10.0, 70.0, 37.0, 90.0, 17.0, 30.0, 40.0, 16.0, 25.0, 30.0, 16.0, 30.0, 40.0, 50.0, 29.0, 30.0, 30.0, 30.0, 62.0, 10.0, -20.0, -1.0, 14.0, 160.0, 20.0, 58.0, 40.0, 60.0, 29.0, -11.0, -5.0, 42.0, 13.0, -1.0, 67.0, -9.0, 100.0, 80.0, 80.0, 22.0, 250.0, 3.0, 25.0, -3.0, 60.0, 63.0, 60.0, -3.0, 10.0, 100.0, 150.0, 60.0, 5.0, 38.0, -44.0, 39.0, -10.0, 60.0, 60.0, 50.0, -7.0, -6.0, 60.0, 80.0, 4.0, 13.0, 25.0, 210.0, 60.0, 40.0, 59.0, 50.0, 26.0, 80.0, 7.0, 20.0, -35.0, 17.0, 109.0, 80.0, 33.0, 48.0, 13.0, 27.0, 30.0, 178.0, 30.0, 160.0, 10.0, 19.0, 4.0, 60.0, -5.0, 40.0, -2.0, 20.0, 0.0, 6.0, 69.0, 16.0, 44.0, 3.0, 29.0, -21.0, 156.0, 8.0, 1.0, -27.0, 160.0, 180.0, 0.0, 40.0, 90.0, 30.0, 50.0, 10.0, -15.0, 167.0, 40.0, 50.0, 170.0, 190.0, 56.0, 0.0, 82.0, 60.0, -10.0, 64.0, 40.0, 58.0, 15.0, 40.0, 83.0, 40.0, 30.0, 25.0, 20.0, -9.0, 14.0, 37.0, 20.0, 18.0, 25.0, 70.0, 50.0, 60.0, 7.0, 25.0, 40.0, 20.0, 27.0, 190.0, 100.0, 30.0, 11.0, 34.0, 23.0, 160.0, 200.0, 60.0, -10.0, 30.0, 10.0, 18.0, -16.0, 20.0, -12.0, 15.0, 20.0, 12.0, 30.0, 60.0, -11.0, 60.0, 0.0, 38.0, 10.0, 40.0, 37.0, 13.0, 18.0, 40.0, 150.0, 70.0, 38.0, 17.0, 28.0, 80.0, 10.0, 17.0, 80.0, 60.0, -20.0, 60.0, 70.0, 180.0, 121.0, -13.0, 170.0, 40.0, 60.0, -34.0, 40.0, 60.0, 4.0, 7.0, -5.0, 60.0, 47.0, 30.0, 0.0, 20.0, 50.0, 9.0, 40.0, 10.0, 10.0, 33.0, 9.0, 25.0, 80.0, 30.0, 48.0, 24.0, 100.0, 260.0, 0.0, -5.0, 30.0, 50.0, 61.0, 29.0, 7.0, -1.0, 30.0, 50.0, 54.0, 72.0, -1.0, 10.0, 10.0, 30.0, 30.0, 49.0, -9.0, 31.0, 38.0, 120.0, 50.0, 30.0, 65.0, 20.0, 60.0, 60.0, 20.0, 2.0, 40.0, 180.0, 10.0, 40.0, 3.0, 63.0, -4.0, 26.0, 3.0, 17.0, -5.0, 30.0, 40.0, 10.0, 39.0, 50.0, 29.0, 20.0, 260.0, 100.0, 20.0, 60.0, 6.0, 70.0, 19.0, 60.0, 50.0, 60.0, -16.0, 53.0, 43.0, 20.0, 40.0, 3.0, 40.0, 30.0, 80.0, 160.0, 70.0, 36.0, 10.0, 35.0, 148.0, 90.0, 60.0, 49.0, 70.0, 55.0, 110.0, 48.0, 28.0, 170.0, 38.0, 20.0, 100.0, -11.0, 20.0, 37.0, 5.0, 22.0, 19.0, 90.0, 16.0, -30.0, -16.0, 40.0, 40.0, 30.0, 180.0, -10.0, -5.0, 40.0, -36.0, -77.0, 40.0, 250.0, 30.0, 16.0, -16.0, -16.0, 8.0, 150.0, 40.0, 50.0, 40.0, 37.0, 11.0, 20.0, 60.0, 70.0, -20.0, 14.0, 45.0, -54.0, 60.0, -14.0, 16.0, 60.0, 28.0, 80.0, 40.0, 125.0, 32.0, 200.0, 0.0, 20.0, 50.0, 168.0, -29.0, -45.0, 50.0, 100.0, 28.0, 27.0, 40.0, 32.0, 30.0, 10.0, 40.0, 70.0, 80.0, 33.0, 13.0, 2.0, 50.0, 35.0, 43.0, -12.0, -22.0, 160.0, 2.0, -10.0, 10.0, 160.0, 16.0, 41.0, 30.0, 90.0, 20.0, -6.0, 52.0, 19.0, 50.0, 30.0, 48.0, 90.0, 59.0, 97.0, 60.0, 10.0, 60.0, 40.0, -94.0, -125.0, 5.0, 29.0, 15.0, 21.0, 5.0, 16.0, 60.0, 17.0, 60.0, 49.0, 282.0, -11.0, 150.0, 14.0, 40.0, 22.0, 29.0, 70.0, 50.0, 20.0, 140.0, -2.0, 26.0, 20.0, 28.0, 19.0, 60.0, 30.0, 80.0, 50.0, 50.0, 29.0, 28.0, 30.0, 60.0, 50.0, 30.0, 170.0, 50.0, -11.0, -15.0, 30.0, 39.0, 10.0, 44.0, 30.0, 8.0, 90.0, -5.0, 9.0, 38.0, 40.0, -1.0, 21.0, 20.0, 30.0, 25.0, 30.0, 40.0, 30.0, 270.0, 60.0, 110.0, 30.0, 0.0, 80.0, 170.0, 90.0, 30.0, 100.0, 150.0, 10.0, 60.0, 30.0, 20.0, 57.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.252120435254597, "mean_inference_ms": 2.5888134608580917, "mean_action_processing_ms": 0.843880890557895, "mean_env_wait_ms": 1.79960336622285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.062058210372924805, "StateBufferConnector_ms": 0.009741544723510742, "ViewRequirementAgentConnector_ms": 0.43561553955078125}, "num_episodes": 22, "episode_return_max": 820.0, "episode_return_min": -28.0, "episode_return_mean": 413.07, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.676178597905995, "num_env_steps_trained_throughput_per_sec": 32.676178597905995, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 1880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1880000, "timers": {"training_iteration_time_ms": 120732.009, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120731.963, "sample_time_ms": 2799.473, "learn_time_ms": 117911.741, "learn_throughput": 33.924, "synch_weights_time_ms": 11.633}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "done": false, "training_iteration": 47, "trial_id": "6085c_00000", "date": "2024-07-02_00-33-36", "timestamp": 1719894816, "time_this_iter_s": 122.4576051235199, "time_total_s": 7663.686855792999, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7663.686855792999, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 29.69942196531792, "ram_util_percent": 81.19075144508672}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5404299457994894, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.1143559006964185, "policy_loss": -0.005193700741964597, "vf_loss": 6.1181900823712985, "vf_explained_var": 0.014204407811037902, "kl": 0.013595142975058717, "entropy": 1.3891354537873477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 446025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 1087.0, "episode_reward_min": -28.0, "episode_reward_mean": 439.29, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -128.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 43.929}, "custom_metrics": {}, "hist_stats": {"episode_reward": [207.0, 515.0, 403.0, 298.0, 485.0, 369.0, 690.0, 317.0, 707.0, 348.0, 275.0, 231.0, 536.0, 142.0, 498.0, 474.0, 341.0, 242.0, 285.0, 549.0, 788.0, 318.0, 410.0, 157.0, 231.0, 350.0, 249.0, 507.0, 352.0, 296.0, 373.0, 285.0, 640.0, 345.0, 339.0, 517.0, 565.0, 306.0, 311.0, 518.0, 805.0, 415.0, 292.0, 500.0, 460.0, 234.0, 451.0, 658.0, 329.0, 276.0, 609.0, 305.0, 260.0, 467.0, 333.0, 598.0, 405.0, 489.0, 693.0, 420.0, 335.0, 239.0, 458.0, 275.0, 571.0, 457.0, 304.0, 403.0, 523.0, -28.0, 652.0, 431.0, 437.0, 355.0, 267.0, 820.0, 607.0, 1087.0, 578.0, 364.0, 802.0, 345.0, 467.0, 839.0, 430.0, 260.0, 454.0, 536.0, 487.0, 564.0, 243.0, 539.0, 738.0, 363.0, 444.0, 473.0, 408.0, 479.0, 764.0, 391.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, -3.0, -10.0, 50.0, 0.0, 8.0, 39.0, 17.0, 26.0, 70.0, 40.0, 70.0, 40.0, 46.0, 24.0, 18.0, 47.0, 180.0, -10.0, 60.0, 0.0, 150.0, -30.0, 70.0, 40.0, 20.0, 29.0, 48.0, 38.0, 38.0, 100.0, 24.0, 60.0, 8.0, -33.0, 58.0, 28.0, 16.0, 7.0, 30.0, 160.0, 30.0, 75.0, 30.0, 50.0, 10.0, 20.0, 30.0, 50.0, 30.0, 10.0, 0.0, 15.0, 20.0, 0.0, -43.0, 50.0, 40.0, 17.0, 260.0, -3.0, 31.0, 2.0, 0.0, 20.0, 70.0, 30.0, 7.0, 290.0, 243.0, 18.0, -6.0, 80.0, 30.0, 120.0, 2.0, -128.0, 1.0, 40.0, 160.0, 39.0, 37.0, 40.0, 30.0, 40.0, 30.0, 49.0, 164.0, 178.0, 100.0, 10.0, -16.0, 160.0, -2.0, -10.0, 50.0, 39.0, 17.0, 30.0, 70.0, 10.0, -25.0, 40.0, 10.0, 20.0, 80.0, 30.0, 60.0, 30.0, 20.0, 100.0, 20.0, 10.0, -11.0, 45.0, 10.0, 36.0, 10.0, 3.0, 8.0, 178.0, 18.0, 20.0, 3.0, 37.0, 10.0, 39.0, 62.0, 39.0, 130.0, 30.0, 50.0, 30.0, -64.0, 60.0, 60.0, -46.0, 20.0, -8.0, 10.0, -121.0, 60.0, 40.0, 50.0, 180.0, 15.0, 39.0, 20.0, 165.0, 50.0, 80.0, 49.0, 60.0, 50.0, 40.0, 80.0, -50.0, 105.0, 20.0, 40.0, 29.0, 0.0, 50.0, 200.0, 1.0, 35.0, 18.0, 19.0, -50.0, 39.0, 1.0, 15.0, 29.0, 20.0, 20.0, 10.0, 17.0, 0.0, 40.0, 90.0, 13.0, 20.0, 80.0, 50.0, 0.0, 0.0, 50.0, 22.0, 10.0, 40.0, 0.0, 50.0, 50.0, 33.0, 10.0, 270.0, 110.0, 38.0, 36.0, -48.0, 46.0, 12.0, 5.0, 35.0, 600.0, 10.0, 0.0, 10.0, 70.0, 0.0, 30.0, 120.0, 20.0, 20.0, 20.0, 20.0, 2.0, -9.0, 65.0, 30.0, 48.0, 70.0, 60.0, 5.0, 30.0, 37.0, 17.0, 68.0, 45.0, 30.0, -22.0, 14.0, 19.0, 0.0, 70.0, -6.0, 20.0, 16.0, 30.0, 16.0, -16.0, 70.0, 40.0, 7.0, 6.0, 8.0, 60.0, 30.0, 16.0, 10.0, -50.0, 58.0, -35.0, 80.0, 159.0, -70.0, 80.0, 50.0, 30.0, 48.0, 10.0, -1.0, 24.0, 17.0, 60.0, 39.0, 14.0, 31.0, 47.0, 8.0, 58.0, 30.0, 50.0, 50.0, 30.0, 10.0, 130.0, 89.0, 20.0, 40.0, 14.0, 50.0, -6.0, 10.0, 70.0, 37.0, 90.0, 17.0, 30.0, 40.0, 16.0, 25.0, 30.0, 16.0, 30.0, 40.0, 50.0, 29.0, 30.0, 30.0, 30.0, 62.0, 10.0, -20.0, -1.0, 14.0, 160.0, 20.0, 58.0, 40.0, 60.0, 29.0, -11.0, -5.0, 42.0, 13.0, -1.0, 67.0, -9.0, 100.0, 80.0, 80.0, 22.0, 250.0, 3.0, 25.0, -3.0, 60.0, 63.0, 60.0, -3.0, 10.0, 100.0, 150.0, 60.0, 5.0, 38.0, -44.0, 39.0, -10.0, 60.0, 60.0, 50.0, -7.0, -6.0, 60.0, 80.0, 4.0, 13.0, 25.0, 210.0, 60.0, 40.0, 59.0, 50.0, 26.0, 80.0, 7.0, 20.0, -35.0, 17.0, 109.0, 80.0, 33.0, 48.0, 13.0, 27.0, 30.0, 178.0, 30.0, 160.0, 10.0, 19.0, 4.0, 60.0, -5.0, 40.0, -2.0, 20.0, 0.0, 6.0, 69.0, 16.0, 44.0, 3.0, 29.0, -21.0, 156.0, 8.0, 1.0, -27.0, 160.0, 180.0, 0.0, 40.0, 90.0, 30.0, 50.0, 10.0, -15.0, 167.0, 40.0, 50.0, 170.0, 190.0, 56.0, 0.0, 82.0, 60.0, -10.0, 64.0, 40.0, 58.0, 15.0, 40.0, 83.0, 40.0, 30.0, 25.0, 20.0, -9.0, 14.0, 37.0, 20.0, 18.0, 25.0, 70.0, 50.0, 60.0, 7.0, 25.0, 40.0, 20.0, 27.0, 190.0, 100.0, 30.0, 11.0, 34.0, 23.0, 160.0, 200.0, 60.0, -10.0, 30.0, 10.0, 18.0, -16.0, 20.0, -12.0, 15.0, 20.0, 12.0, 30.0, 60.0, -11.0, 60.0, 0.0, 38.0, 10.0, 40.0, 37.0, 13.0, 18.0, 40.0, 150.0, 70.0, 38.0, 17.0, 28.0, 80.0, 10.0, 17.0, 80.0, 60.0, -20.0, 60.0, 70.0, 180.0, 121.0, -13.0, 170.0, 40.0, 60.0, -34.0, 40.0, 60.0, 4.0, 7.0, -5.0, 60.0, 47.0, 30.0, 0.0, 20.0, 50.0, 9.0, 40.0, 10.0, 10.0, 33.0, 9.0, 25.0, 80.0, 30.0, 48.0, 24.0, 100.0, 260.0, 0.0, -5.0, 30.0, 50.0, 61.0, 29.0, 7.0, -1.0, 30.0, 50.0, 54.0, 72.0, -1.0, 10.0, 10.0, 30.0, 30.0, 49.0, -9.0, 31.0, 38.0, 120.0, 50.0, 30.0, 65.0, 20.0, 60.0, 60.0, 20.0, 2.0, 40.0, 180.0, 10.0, 40.0, 3.0, 63.0, -4.0, 26.0, 3.0, 17.0, -5.0, 30.0, 40.0, 10.0, 39.0, 50.0, 29.0, 20.0, 260.0, 100.0, 20.0, 60.0, 6.0, 70.0, 19.0, 60.0, 50.0, 60.0, -16.0, 53.0, 43.0, 20.0, 40.0, 3.0, 40.0, 30.0, 80.0, 160.0, 70.0, 36.0, 10.0, 35.0, 148.0, 90.0, 60.0, 49.0, 70.0, 55.0, 110.0, 48.0, 28.0, 170.0, 38.0, 20.0, 100.0, -11.0, 20.0, 37.0, 5.0, 22.0, 19.0, 90.0, 16.0, -30.0, -16.0, 40.0, 40.0, 30.0, 180.0, -10.0, -5.0, 40.0, -36.0, -77.0, 40.0, 250.0, 30.0, 16.0, -16.0, -16.0, 8.0, 150.0, 40.0, 50.0, 40.0, 37.0, 11.0, 20.0, 60.0, 70.0, -20.0, 14.0, 45.0, -54.0, 60.0, -14.0, 16.0, 60.0, 28.0, 80.0, 40.0, 125.0, 32.0, 200.0, 0.0, 20.0, 50.0, 168.0, -29.0, -45.0, 50.0, 100.0, 28.0, 27.0, 40.0, 32.0, 30.0, 10.0, 40.0, 70.0, 80.0, 33.0, 13.0, 2.0, 50.0, 35.0, 43.0, -12.0, -22.0, 160.0, 2.0, -10.0, 10.0, 160.0, 16.0, 41.0, 30.0, 90.0, 20.0, -6.0, 52.0, 19.0, 50.0, 30.0, 48.0, 90.0, 59.0, 97.0, 60.0, 10.0, 60.0, 40.0, -94.0, -125.0, 5.0, 29.0, 15.0, 21.0, 5.0, 16.0, 60.0, 17.0, 60.0, 49.0, 282.0, -11.0, 150.0, 14.0, 40.0, 22.0, 29.0, 70.0, 50.0, 20.0, 140.0, -2.0, 26.0, 20.0, 28.0, 19.0, 60.0, 30.0, 80.0, 50.0, 50.0, 29.0, 28.0, 30.0, 60.0, 50.0, 30.0, 170.0, 50.0, -11.0, -15.0, 30.0, 39.0, 10.0, 44.0, 30.0, 8.0, 90.0, -5.0, 9.0, 38.0, 40.0, -1.0, 21.0, 20.0, 30.0, 25.0, 30.0, 40.0, 30.0, 270.0, 60.0, 110.0, 30.0, 0.0, 80.0, 170.0, 90.0, 30.0, 100.0, 150.0, 10.0, 60.0, 30.0, 20.0, 57.0, 60.0, 20.0, -5.0, 190.0, 130.0, 550.0, -10.0, 98.0, -1.0, 70.0, 45.0, 10.0, 114.0, 50.0, 190.0, 140.0, -23.0, 20.0, 50.0, 100.0, -73.0, 80.0, 18.0, 20.0, 149.0, -2.0, -2.0, -4.0, 30.0, 55.0, 20.0, 157.0, 38.0, 110.0, 60.0, 35.0, 47.0, 80.0, 155.0, 40.0, 80.0, 40.0, 38.0, 50.0, 26.0, 10.0, 50.0, 46.0, 70.0, 15.0, 0.0, 20.0, 180.0, 16.0, -8.0, 50.0, 20.0, -60.0, 109.0, 60.0, 80.0, 40.0, 37.0, 30.0, 80.0, 110.0, 40.0, 43.0, 189.0, 40.0, 230.0, 12.0, 190.0, 14.0, 30.0, 20.0, 15.0, 30.0, 10.0, 79.0, 30.0, 50.0, 26.0, -12.0, 46.0, 20.0, 24.0, 30.0, 27.0, 48.0, 1.0, 46.0, 90.0, 28.0, 49.0, 30.0, 5.0, 100.0, 48.0, 30.0, 28.0, -15.0, 30.0, -42.0, 160.0, 70.0, 18.0, 53.0, 30.0, 180.0, 52.0, 69.0, 110.0, 15.0, 50.0, 70.0, -6.0, 0.0, 89.0, 60.0, 30.0, 67.0, 40.0, 170.0, 37.0, 50.0, 80.0, 25.0, 70.0, 0.0, 25.0, 20.0, 55.0, 27.0, -10.0, 110.0, -1.0, 11.0, 10.0, 40.0, -19.0, 31.0, 12.0, 13.0, 70.0, 10.0, 23.0, 60.0, 110.0, 180.0, 30.0, 79.0, 70.0, -9.0, 0.0, 45.0, 230.0, 70.0, 7.0, 176.0, 70.0, 23.0, 8.0, 90.0, 100.0, 20.0, 19.0, 34.0, 22.0, 50.0, -3.0, 70.0, 57.0, 60.0, 68.0, 24.0, 50.0, 35.0, 30.0, 50.0, 0.0, 20.0, 60.0, 60.0, 70.0, 58.0, 10.0, 7.0, 90.0, 30.0, 68.0, 50.0, -8.0, 70.0, 50.0, 38.0, 39.0, 59.0, 21.0, 19.0, 70.0, 69.0, 20.0, 43.0, 10.0, 18.0, 49.0, 80.0, 60.0, 80.0, 50.0, 87.0, 10.0, 69.0, 60.0, 70.0, 126.0, 8.0, 146.0, 68.0, 120.0, 40.0, 100.0, 80.0, -13.0, 57.0, 46.0, 10.0, 50.0, 5.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2390234476155566, "mean_inference_ms": 2.5761782904280075, "mean_action_processing_ms": 0.8436997223976112, "mean_env_wait_ms": 1.7897047045060313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07105708122253418, "StateBufferConnector_ms": 0.010294198989868164, "ViewRequirementAgentConnector_ms": 0.43848276138305664}, "num_episodes": 23, "episode_return_max": 1087.0, "episode_return_min": -28.0, "episode_return_mean": 439.29, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.245682471976906, "num_env_steps_trained_throughput_per_sec": 33.245682471976906, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 120781.875, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120781.828, "sample_time_ms": 2827.939, "learn_time_ms": 117931.882, "learn_throughput": 33.918, "synch_weights_time_ms": 11.73}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 48, "trial_id": "6085c_00000", "date": "2024-07-02_00-35-36", "timestamp": 1719894936, "time_this_iter_s": 120.35791897773743, "time_total_s": 7784.044774770737, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b91798b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7784.044774770737, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 28.14882352941177, "ram_util_percent": 79.71411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5636195180388177, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.257648685158759, "policy_loss": -0.006115888838687985, "vf_loss": 6.262739404956626, "vf_explained_var": 0.018243467928375553, "kl": 0.010251705020564241, "entropy": 1.3902912925099666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 455415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "env_runners": {"episode_reward_max": 1087.0, "episode_reward_min": -28.0, "episode_reward_mean": 458.06, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 45.806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.0, 549.0, 788.0, 318.0, 410.0, 157.0, 231.0, 350.0, 249.0, 507.0, 352.0, 296.0, 373.0, 285.0, 640.0, 345.0, 339.0, 517.0, 565.0, 306.0, 311.0, 518.0, 805.0, 415.0, 292.0, 500.0, 460.0, 234.0, 451.0, 658.0, 329.0, 276.0, 609.0, 305.0, 260.0, 467.0, 333.0, 598.0, 405.0, 489.0, 693.0, 420.0, 335.0, 239.0, 458.0, 275.0, 571.0, 457.0, 304.0, 403.0, 523.0, -28.0, 652.0, 431.0, 437.0, 355.0, 267.0, 820.0, 607.0, 1087.0, 578.0, 364.0, 802.0, 345.0, 467.0, 839.0, 430.0, 260.0, 454.0, 536.0, 487.0, 564.0, 243.0, 539.0, 738.0, 363.0, 444.0, 473.0, 408.0, 479.0, 764.0, 391.0, 619.0, 596.0, 618.0, 334.0, 583.0, 489.0, 454.0, 572.0, 463.0, 291.0, 381.0, 587.0, 446.0, 563.0, 248.0, 460.0, 632.0, 619.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [13.0, 20.0, 80.0, 50.0, 0.0, 0.0, 50.0, 22.0, 10.0, 40.0, 0.0, 50.0, 50.0, 33.0, 10.0, 270.0, 110.0, 38.0, 36.0, -48.0, 46.0, 12.0, 5.0, 35.0, 600.0, 10.0, 0.0, 10.0, 70.0, 0.0, 30.0, 120.0, 20.0, 20.0, 20.0, 20.0, 2.0, -9.0, 65.0, 30.0, 48.0, 70.0, 60.0, 5.0, 30.0, 37.0, 17.0, 68.0, 45.0, 30.0, -22.0, 14.0, 19.0, 0.0, 70.0, -6.0, 20.0, 16.0, 30.0, 16.0, -16.0, 70.0, 40.0, 7.0, 6.0, 8.0, 60.0, 30.0, 16.0, 10.0, -50.0, 58.0, -35.0, 80.0, 159.0, -70.0, 80.0, 50.0, 30.0, 48.0, 10.0, -1.0, 24.0, 17.0, 60.0, 39.0, 14.0, 31.0, 47.0, 8.0, 58.0, 30.0, 50.0, 50.0, 30.0, 10.0, 130.0, 89.0, 20.0, 40.0, 14.0, 50.0, -6.0, 10.0, 70.0, 37.0, 90.0, 17.0, 30.0, 40.0, 16.0, 25.0, 30.0, 16.0, 30.0, 40.0, 50.0, 29.0, 30.0, 30.0, 30.0, 62.0, 10.0, -20.0, -1.0, 14.0, 160.0, 20.0, 58.0, 40.0, 60.0, 29.0, -11.0, -5.0, 42.0, 13.0, -1.0, 67.0, -9.0, 100.0, 80.0, 80.0, 22.0, 250.0, 3.0, 25.0, -3.0, 60.0, 63.0, 60.0, -3.0, 10.0, 100.0, 150.0, 60.0, 5.0, 38.0, -44.0, 39.0, -10.0, 60.0, 60.0, 50.0, -7.0, -6.0, 60.0, 80.0, 4.0, 13.0, 25.0, 210.0, 60.0, 40.0, 59.0, 50.0, 26.0, 80.0, 7.0, 20.0, -35.0, 17.0, 109.0, 80.0, 33.0, 48.0, 13.0, 27.0, 30.0, 178.0, 30.0, 160.0, 10.0, 19.0, 4.0, 60.0, -5.0, 40.0, -2.0, 20.0, 0.0, 6.0, 69.0, 16.0, 44.0, 3.0, 29.0, -21.0, 156.0, 8.0, 1.0, -27.0, 160.0, 180.0, 0.0, 40.0, 90.0, 30.0, 50.0, 10.0, -15.0, 167.0, 40.0, 50.0, 170.0, 190.0, 56.0, 0.0, 82.0, 60.0, -10.0, 64.0, 40.0, 58.0, 15.0, 40.0, 83.0, 40.0, 30.0, 25.0, 20.0, -9.0, 14.0, 37.0, 20.0, 18.0, 25.0, 70.0, 50.0, 60.0, 7.0, 25.0, 40.0, 20.0, 27.0, 190.0, 100.0, 30.0, 11.0, 34.0, 23.0, 160.0, 200.0, 60.0, -10.0, 30.0, 10.0, 18.0, -16.0, 20.0, -12.0, 15.0, 20.0, 12.0, 30.0, 60.0, -11.0, 60.0, 0.0, 38.0, 10.0, 40.0, 37.0, 13.0, 18.0, 40.0, 150.0, 70.0, 38.0, 17.0, 28.0, 80.0, 10.0, 17.0, 80.0, 60.0, -20.0, 60.0, 70.0, 180.0, 121.0, -13.0, 170.0, 40.0, 60.0, -34.0, 40.0, 60.0, 4.0, 7.0, -5.0, 60.0, 47.0, 30.0, 0.0, 20.0, 50.0, 9.0, 40.0, 10.0, 10.0, 33.0, 9.0, 25.0, 80.0, 30.0, 48.0, 24.0, 100.0, 260.0, 0.0, -5.0, 30.0, 50.0, 61.0, 29.0, 7.0, -1.0, 30.0, 50.0, 54.0, 72.0, -1.0, 10.0, 10.0, 30.0, 30.0, 49.0, -9.0, 31.0, 38.0, 120.0, 50.0, 30.0, 65.0, 20.0, 60.0, 60.0, 20.0, 2.0, 40.0, 180.0, 10.0, 40.0, 3.0, 63.0, -4.0, 26.0, 3.0, 17.0, -5.0, 30.0, 40.0, 10.0, 39.0, 50.0, 29.0, 20.0, 260.0, 100.0, 20.0, 60.0, 6.0, 70.0, 19.0, 60.0, 50.0, 60.0, -16.0, 53.0, 43.0, 20.0, 40.0, 3.0, 40.0, 30.0, 80.0, 160.0, 70.0, 36.0, 10.0, 35.0, 148.0, 90.0, 60.0, 49.0, 70.0, 55.0, 110.0, 48.0, 28.0, 170.0, 38.0, 20.0, 100.0, -11.0, 20.0, 37.0, 5.0, 22.0, 19.0, 90.0, 16.0, -30.0, -16.0, 40.0, 40.0, 30.0, 180.0, -10.0, -5.0, 40.0, -36.0, -77.0, 40.0, 250.0, 30.0, 16.0, -16.0, -16.0, 8.0, 150.0, 40.0, 50.0, 40.0, 37.0, 11.0, 20.0, 60.0, 70.0, -20.0, 14.0, 45.0, -54.0, 60.0, -14.0, 16.0, 60.0, 28.0, 80.0, 40.0, 125.0, 32.0, 200.0, 0.0, 20.0, 50.0, 168.0, -29.0, -45.0, 50.0, 100.0, 28.0, 27.0, 40.0, 32.0, 30.0, 10.0, 40.0, 70.0, 80.0, 33.0, 13.0, 2.0, 50.0, 35.0, 43.0, -12.0, -22.0, 160.0, 2.0, -10.0, 10.0, 160.0, 16.0, 41.0, 30.0, 90.0, 20.0, -6.0, 52.0, 19.0, 50.0, 30.0, 48.0, 90.0, 59.0, 97.0, 60.0, 10.0, 60.0, 40.0, -94.0, -125.0, 5.0, 29.0, 15.0, 21.0, 5.0, 16.0, 60.0, 17.0, 60.0, 49.0, 282.0, -11.0, 150.0, 14.0, 40.0, 22.0, 29.0, 70.0, 50.0, 20.0, 140.0, -2.0, 26.0, 20.0, 28.0, 19.0, 60.0, 30.0, 80.0, 50.0, 50.0, 29.0, 28.0, 30.0, 60.0, 50.0, 30.0, 170.0, 50.0, -11.0, -15.0, 30.0, 39.0, 10.0, 44.0, 30.0, 8.0, 90.0, -5.0, 9.0, 38.0, 40.0, -1.0, 21.0, 20.0, 30.0, 25.0, 30.0, 40.0, 30.0, 270.0, 60.0, 110.0, 30.0, 0.0, 80.0, 170.0, 90.0, 30.0, 100.0, 150.0, 10.0, 60.0, 30.0, 20.0, 57.0, 60.0, 20.0, -5.0, 190.0, 130.0, 550.0, -10.0, 98.0, -1.0, 70.0, 45.0, 10.0, 114.0, 50.0, 190.0, 140.0, -23.0, 20.0, 50.0, 100.0, -73.0, 80.0, 18.0, 20.0, 149.0, -2.0, -2.0, -4.0, 30.0, 55.0, 20.0, 157.0, 38.0, 110.0, 60.0, 35.0, 47.0, 80.0, 155.0, 40.0, 80.0, 40.0, 38.0, 50.0, 26.0, 10.0, 50.0, 46.0, 70.0, 15.0, 0.0, 20.0, 180.0, 16.0, -8.0, 50.0, 20.0, -60.0, 109.0, 60.0, 80.0, 40.0, 37.0, 30.0, 80.0, 110.0, 40.0, 43.0, 189.0, 40.0, 230.0, 12.0, 190.0, 14.0, 30.0, 20.0, 15.0, 30.0, 10.0, 79.0, 30.0, 50.0, 26.0, -12.0, 46.0, 20.0, 24.0, 30.0, 27.0, 48.0, 1.0, 46.0, 90.0, 28.0, 49.0, 30.0, 5.0, 100.0, 48.0, 30.0, 28.0, -15.0, 30.0, -42.0, 160.0, 70.0, 18.0, 53.0, 30.0, 180.0, 52.0, 69.0, 110.0, 15.0, 50.0, 70.0, -6.0, 0.0, 89.0, 60.0, 30.0, 67.0, 40.0, 170.0, 37.0, 50.0, 80.0, 25.0, 70.0, 0.0, 25.0, 20.0, 55.0, 27.0, -10.0, 110.0, -1.0, 11.0, 10.0, 40.0, -19.0, 31.0, 12.0, 13.0, 70.0, 10.0, 23.0, 60.0, 110.0, 180.0, 30.0, 79.0, 70.0, -9.0, 0.0, 45.0, 230.0, 70.0, 7.0, 176.0, 70.0, 23.0, 8.0, 90.0, 100.0, 20.0, 19.0, 34.0, 22.0, 50.0, -3.0, 70.0, 57.0, 60.0, 68.0, 24.0, 50.0, 35.0, 30.0, 50.0, 0.0, 20.0, 60.0, 60.0, 70.0, 58.0, 10.0, 7.0, 90.0, 30.0, 68.0, 50.0, -8.0, 70.0, 50.0, 38.0, 39.0, 59.0, 21.0, 19.0, 70.0, 69.0, 20.0, 43.0, 10.0, 18.0, 49.0, 80.0, 60.0, 80.0, 50.0, 87.0, 10.0, 69.0, 60.0, 70.0, 126.0, 8.0, 146.0, 68.0, 120.0, 40.0, 100.0, 80.0, -13.0, 57.0, 46.0, 10.0, 50.0, 5.0, 16.0, 20.0, 60.0, 70.0, 80.0, 80.0, 70.0, 164.0, 20.0, 70.0, -15.0, 19.0, 160.0, 60.0, 80.0, 30.0, 47.0, 30.0, 30.0, 60.0, 80.0, -66.0, 170.0, -17.0, 10.0, 180.0, 120.0, 53.0, 60.0, 28.0, 80.0, 20.0, 16.0, 33.0, 50.0, 20.0, 78.0, 28.0, 20.0, 60.0, 9.0, 80.0, 70.0, 50.0, 30.0, 200.0, 18.0, -21.0, 60.0, 60.0, 36.0, 80.0, -6.0, 38.0, 10.0, 30.0, 33.0, 170.0, 279.0, -160.0, 15.0, 23.0, 25.0, 58.0, 85.0, 33.0, 40.0, 0.0, 50.0, 50.0, 90.0, 60.0, 50.0, 80.0, -11.0, 58.0, 20.0, 64.0, 29.0, 66.0, 156.0, 7.0, 60.0, 13.0, 29.0, 50.0, 160.0, 29.0, 79.0, 15.0, 21.0, 5.0, -2.0, 15.0, 100.0, 10.0, 80.0, 30.0, 29.0, 18.0, 6.0, 25.0, 70.0, 119.0, 50.0, -66.0, 20.0, -2.0, 110.0, 5.0, 50.0, -30.0, 15.0, 49.0, 109.0, 120.0, -41.0, 70.0, 67.0, 130.0, 98.0, 31.0, 29.0, 36.0, 80.0, -3.0, 15.0, 49.0, 40.0, 18.0, 151.0, 39.0, 70.0, 29.0, 210.0, 20.0, -5.0, 20.0, 50.0, 70.0, 60.0, 50.0, -19.0, 13.0, 28.0, 90.0, 36.0, 1.0, -11.0, 30.0, 30.0, 100.0, 30.0, -20.0, 30.0, 60.0, 50.0, 60.0, 30.0, 70.0, 50.0, 80.0, 60.0, 50.0, 159.0, 48.0, 37.0, 50.0, 80.0, 28.0, 40.0, 20.0, 66.0, 60.0, 52.0, 15.0, 160.0, 80.0, 70.0, 50.0, 46.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2230910013972855, "mean_inference_ms": 2.560738484849608, "mean_action_processing_ms": 0.8393095192433612, "mean_env_wait_ms": 1.779640425629668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07230687141418457, "StateBufferConnector_ms": 0.010312557220458984, "ViewRequirementAgentConnector_ms": 0.4612267017364502}, "num_episodes": 18, "episode_return_max": 1087.0, "episode_return_min": -28.0, "episode_return_mean": 458.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.10452541086697, "num_env_steps_trained_throughput_per_sec": 33.10452541086697, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 1960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1960000, "timers": {"training_iteration_time_ms": 120828.244, "restore_workers_time_ms": 0.012, "training_step_time_ms": 120828.199, "sample_time_ms": 2891.801, "learn_time_ms": 117914.75, "learn_throughput": 33.923, "synch_weights_time_ms": 11.675}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "done": false, "training_iteration": 49, "trial_id": "6085c_00000", "date": "2024-07-02_00-37-37", "timestamp": 1719895057, "time_this_iter_s": 120.86912202835083, "time_total_s": 7904.9138967990875, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138009d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7904.9138967990875, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 29.608771929824563, "ram_util_percent": 79.94210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.638219651678246, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.256094520465254, "policy_loss": -0.005364003248440342, "vf_loss": 6.260377551851689, "vf_explained_var": 0.012309396013030357, "kl": 0.010809679787026488, "entropy": 1.3839850693211133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 464805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 1087.0, "episode_reward_min": -28.0, "episode_reward_mean": 494.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 550.0}, "policy_reward_mean": {"policy_0": 49.475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [565.0, 306.0, 311.0, 518.0, 805.0, 415.0, 292.0, 500.0, 460.0, 234.0, 451.0, 658.0, 329.0, 276.0, 609.0, 305.0, 260.0, 467.0, 333.0, 598.0, 405.0, 489.0, 693.0, 420.0, 335.0, 239.0, 458.0, 275.0, 571.0, 457.0, 304.0, 403.0, 523.0, -28.0, 652.0, 431.0, 437.0, 355.0, 267.0, 820.0, 607.0, 1087.0, 578.0, 364.0, 802.0, 345.0, 467.0, 839.0, 430.0, 260.0, 454.0, 536.0, 487.0, 564.0, 243.0, 539.0, 738.0, 363.0, 444.0, 473.0, 408.0, 479.0, 764.0, 391.0, 619.0, 596.0, 618.0, 334.0, 583.0, 489.0, 454.0, 572.0, 463.0, 291.0, 381.0, 587.0, 446.0, 563.0, 248.0, 460.0, 632.0, 619.0, 471.0, 568.0, 271.0, 570.0, 348.0, 967.0, 647.0, 524.0, 696.0, 367.0, 293.0, 788.0, 655.0, 664.0, 949.0, 507.0, 819.0, 556.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [17.0, 109.0, 80.0, 33.0, 48.0, 13.0, 27.0, 30.0, 178.0, 30.0, 160.0, 10.0, 19.0, 4.0, 60.0, -5.0, 40.0, -2.0, 20.0, 0.0, 6.0, 69.0, 16.0, 44.0, 3.0, 29.0, -21.0, 156.0, 8.0, 1.0, -27.0, 160.0, 180.0, 0.0, 40.0, 90.0, 30.0, 50.0, 10.0, -15.0, 167.0, 40.0, 50.0, 170.0, 190.0, 56.0, 0.0, 82.0, 60.0, -10.0, 64.0, 40.0, 58.0, 15.0, 40.0, 83.0, 40.0, 30.0, 25.0, 20.0, -9.0, 14.0, 37.0, 20.0, 18.0, 25.0, 70.0, 50.0, 60.0, 7.0, 25.0, 40.0, 20.0, 27.0, 190.0, 100.0, 30.0, 11.0, 34.0, 23.0, 160.0, 200.0, 60.0, -10.0, 30.0, 10.0, 18.0, -16.0, 20.0, -12.0, 15.0, 20.0, 12.0, 30.0, 60.0, -11.0, 60.0, 0.0, 38.0, 10.0, 40.0, 37.0, 13.0, 18.0, 40.0, 150.0, 70.0, 38.0, 17.0, 28.0, 80.0, 10.0, 17.0, 80.0, 60.0, -20.0, 60.0, 70.0, 180.0, 121.0, -13.0, 170.0, 40.0, 60.0, -34.0, 40.0, 60.0, 4.0, 7.0, -5.0, 60.0, 47.0, 30.0, 0.0, 20.0, 50.0, 9.0, 40.0, 10.0, 10.0, 33.0, 9.0, 25.0, 80.0, 30.0, 48.0, 24.0, 100.0, 260.0, 0.0, -5.0, 30.0, 50.0, 61.0, 29.0, 7.0, -1.0, 30.0, 50.0, 54.0, 72.0, -1.0, 10.0, 10.0, 30.0, 30.0, 49.0, -9.0, 31.0, 38.0, 120.0, 50.0, 30.0, 65.0, 20.0, 60.0, 60.0, 20.0, 2.0, 40.0, 180.0, 10.0, 40.0, 3.0, 63.0, -4.0, 26.0, 3.0, 17.0, -5.0, 30.0, 40.0, 10.0, 39.0, 50.0, 29.0, 20.0, 260.0, 100.0, 20.0, 60.0, 6.0, 70.0, 19.0, 60.0, 50.0, 60.0, -16.0, 53.0, 43.0, 20.0, 40.0, 3.0, 40.0, 30.0, 80.0, 160.0, 70.0, 36.0, 10.0, 35.0, 148.0, 90.0, 60.0, 49.0, 70.0, 55.0, 110.0, 48.0, 28.0, 170.0, 38.0, 20.0, 100.0, -11.0, 20.0, 37.0, 5.0, 22.0, 19.0, 90.0, 16.0, -30.0, -16.0, 40.0, 40.0, 30.0, 180.0, -10.0, -5.0, 40.0, -36.0, -77.0, 40.0, 250.0, 30.0, 16.0, -16.0, -16.0, 8.0, 150.0, 40.0, 50.0, 40.0, 37.0, 11.0, 20.0, 60.0, 70.0, -20.0, 14.0, 45.0, -54.0, 60.0, -14.0, 16.0, 60.0, 28.0, 80.0, 40.0, 125.0, 32.0, 200.0, 0.0, 20.0, 50.0, 168.0, -29.0, -45.0, 50.0, 100.0, 28.0, 27.0, 40.0, 32.0, 30.0, 10.0, 40.0, 70.0, 80.0, 33.0, 13.0, 2.0, 50.0, 35.0, 43.0, -12.0, -22.0, 160.0, 2.0, -10.0, 10.0, 160.0, 16.0, 41.0, 30.0, 90.0, 20.0, -6.0, 52.0, 19.0, 50.0, 30.0, 48.0, 90.0, 59.0, 97.0, 60.0, 10.0, 60.0, 40.0, -94.0, -125.0, 5.0, 29.0, 15.0, 21.0, 5.0, 16.0, 60.0, 17.0, 60.0, 49.0, 282.0, -11.0, 150.0, 14.0, 40.0, 22.0, 29.0, 70.0, 50.0, 20.0, 140.0, -2.0, 26.0, 20.0, 28.0, 19.0, 60.0, 30.0, 80.0, 50.0, 50.0, 29.0, 28.0, 30.0, 60.0, 50.0, 30.0, 170.0, 50.0, -11.0, -15.0, 30.0, 39.0, 10.0, 44.0, 30.0, 8.0, 90.0, -5.0, 9.0, 38.0, 40.0, -1.0, 21.0, 20.0, 30.0, 25.0, 30.0, 40.0, 30.0, 270.0, 60.0, 110.0, 30.0, 0.0, 80.0, 170.0, 90.0, 30.0, 100.0, 150.0, 10.0, 60.0, 30.0, 20.0, 57.0, 60.0, 20.0, -5.0, 190.0, 130.0, 550.0, -10.0, 98.0, -1.0, 70.0, 45.0, 10.0, 114.0, 50.0, 190.0, 140.0, -23.0, 20.0, 50.0, 100.0, -73.0, 80.0, 18.0, 20.0, 149.0, -2.0, -2.0, -4.0, 30.0, 55.0, 20.0, 157.0, 38.0, 110.0, 60.0, 35.0, 47.0, 80.0, 155.0, 40.0, 80.0, 40.0, 38.0, 50.0, 26.0, 10.0, 50.0, 46.0, 70.0, 15.0, 0.0, 20.0, 180.0, 16.0, -8.0, 50.0, 20.0, -60.0, 109.0, 60.0, 80.0, 40.0, 37.0, 30.0, 80.0, 110.0, 40.0, 43.0, 189.0, 40.0, 230.0, 12.0, 190.0, 14.0, 30.0, 20.0, 15.0, 30.0, 10.0, 79.0, 30.0, 50.0, 26.0, -12.0, 46.0, 20.0, 24.0, 30.0, 27.0, 48.0, 1.0, 46.0, 90.0, 28.0, 49.0, 30.0, 5.0, 100.0, 48.0, 30.0, 28.0, -15.0, 30.0, -42.0, 160.0, 70.0, 18.0, 53.0, 30.0, 180.0, 52.0, 69.0, 110.0, 15.0, 50.0, 70.0, -6.0, 0.0, 89.0, 60.0, 30.0, 67.0, 40.0, 170.0, 37.0, 50.0, 80.0, 25.0, 70.0, 0.0, 25.0, 20.0, 55.0, 27.0, -10.0, 110.0, -1.0, 11.0, 10.0, 40.0, -19.0, 31.0, 12.0, 13.0, 70.0, 10.0, 23.0, 60.0, 110.0, 180.0, 30.0, 79.0, 70.0, -9.0, 0.0, 45.0, 230.0, 70.0, 7.0, 176.0, 70.0, 23.0, 8.0, 90.0, 100.0, 20.0, 19.0, 34.0, 22.0, 50.0, -3.0, 70.0, 57.0, 60.0, 68.0, 24.0, 50.0, 35.0, 30.0, 50.0, 0.0, 20.0, 60.0, 60.0, 70.0, 58.0, 10.0, 7.0, 90.0, 30.0, 68.0, 50.0, -8.0, 70.0, 50.0, 38.0, 39.0, 59.0, 21.0, 19.0, 70.0, 69.0, 20.0, 43.0, 10.0, 18.0, 49.0, 80.0, 60.0, 80.0, 50.0, 87.0, 10.0, 69.0, 60.0, 70.0, 126.0, 8.0, 146.0, 68.0, 120.0, 40.0, 100.0, 80.0, -13.0, 57.0, 46.0, 10.0, 50.0, 5.0, 16.0, 20.0, 60.0, 70.0, 80.0, 80.0, 70.0, 164.0, 20.0, 70.0, -15.0, 19.0, 160.0, 60.0, 80.0, 30.0, 47.0, 30.0, 30.0, 60.0, 80.0, -66.0, 170.0, -17.0, 10.0, 180.0, 120.0, 53.0, 60.0, 28.0, 80.0, 20.0, 16.0, 33.0, 50.0, 20.0, 78.0, 28.0, 20.0, 60.0, 9.0, 80.0, 70.0, 50.0, 30.0, 200.0, 18.0, -21.0, 60.0, 60.0, 36.0, 80.0, -6.0, 38.0, 10.0, 30.0, 33.0, 170.0, 279.0, -160.0, 15.0, 23.0, 25.0, 58.0, 85.0, 33.0, 40.0, 0.0, 50.0, 50.0, 90.0, 60.0, 50.0, 80.0, -11.0, 58.0, 20.0, 64.0, 29.0, 66.0, 156.0, 7.0, 60.0, 13.0, 29.0, 50.0, 160.0, 29.0, 79.0, 15.0, 21.0, 5.0, -2.0, 15.0, 100.0, 10.0, 80.0, 30.0, 29.0, 18.0, 6.0, 25.0, 70.0, 119.0, 50.0, -66.0, 20.0, -2.0, 110.0, 5.0, 50.0, -30.0, 15.0, 49.0, 109.0, 120.0, -41.0, 70.0, 67.0, 130.0, 98.0, 31.0, 29.0, 36.0, 80.0, -3.0, 15.0, 49.0, 40.0, 18.0, 151.0, 39.0, 70.0, 29.0, 210.0, 20.0, -5.0, 20.0, 50.0, 70.0, 60.0, 50.0, -19.0, 13.0, 28.0, 90.0, 36.0, 1.0, -11.0, 30.0, 30.0, 100.0, 30.0, -20.0, 30.0, 60.0, 50.0, 60.0, 30.0, 70.0, 50.0, 80.0, 60.0, 50.0, 159.0, 48.0, 37.0, 50.0, 80.0, 28.0, 40.0, 20.0, 66.0, 60.0, 52.0, 15.0, 160.0, 80.0, 70.0, 50.0, 46.0, 49.0, -31.0, 110.0, 1.0, 30.0, 25.0, 35.0, 80.0, 142.0, 30.0, -150.0, 40.0, 165.0, -50.0, 40.0, -9.0, 133.0, 320.0, 29.0, 50.0, 10.0, 28.0, -2.0, 6.0, 40.0, -1.0, 140.0, -10.0, 0.0, 60.0, 29.0, 40.0, 40.0, 60.0, 30.0, 19.0, 159.0, 50.0, 74.0, 69.0, 60.0, 20.0, 9.0, 19.0, 40.0, 60.0, 40.0, 15.0, 25.0, 60.0, 90.0, 40.0, 160.0, 50.0, -30.0, 288.0, 80.0, 19.0, 90.0, 180.0, 38.0, 10.0, 10.0, 40.0, 80.0, 80.0, 60.0, 89.0, 60.0, 180.0, 100.0, 10.0, 30.0, 20.0, 60.0, 20.0, 80.0, -16.0, 160.0, 60.0, 59.0, -11.0, 70.0, 80.0, 160.0, 90.0, 60.0, 60.0, 90.0, 38.0, 80.0, 30.0, 60.0, 29.0, 40.0, 20.0, 37.0, 20.0, 31.0, 20.0, -3.0, 48.0, 10.0, 30.0, 30.0, 20.0, 50.0, 28.0, 50.0, 30.0, 40.0, 100.0, 10.0, 110.0, 120.0, 68.0, 50.0, 60.0, 150.0, 80.0, 29.0, 80.0, 160.0, 20.0, 50.0, 36.0, 65.0, 80.0, 70.0, 65.0, 60.0, 70.0, 90.0, 15.0, 20.0, 90.0, 110.0, 150.0, 40.0, 19.0, 170.0, 149.0, 141.0, -50.0, 10.0, 10.0, 24.0, 60.0, 55.0, 380.0, 45.0, 50.0, 28.0, 40.0, 40.0, 16.0, 92.0, 149.0, 18.0, 29.0, 17.0, 13.0, 50.0, 20.0, 270.0, 70.0, 69.0, 140.0, 90.0, 80.0, 80.0, 20.0, 27.0, 30.0, 29.0, 50.0, 24.0, 26.0, 150.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2132379612436965, "mean_inference_ms": 2.5493112573614836, "mean_action_processing_ms": 0.8358537710999419, "mean_env_wait_ms": 1.771938749320447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07232165336608887, "StateBufferConnector_ms": 0.010259628295898438, "ViewRequirementAgentConnector_ms": 0.4696981906890869}, "num_episodes": 18, "episode_return_max": 1087.0, "episode_return_min": -28.0, "episode_return_mean": 494.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.28141767484124, "num_env_steps_trained_throughput_per_sec": 33.28141767484124, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 120871.92, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120871.875, "sample_time_ms": 2927.441, "learn_time_ms": 117922.685, "learn_throughput": 33.921, "synch_weights_time_ms": 11.585}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 50, "trial_id": "6085c_00000", "date": "2024-07-02_00-39-37", "timestamp": 1719895177, "time_this_iter_s": 120.24029183387756, "time_total_s": 8025.154188632965, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13800f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8025.154188632965, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 28.715294117647055, "ram_util_percent": 79.41411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.389271077777123, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.209207831454861, "policy_loss": -0.004955405056083831, "vf_loss": 6.2129426824652985, "vf_explained_var": 0.006527841021331609, "kl": 0.01220559952365065, "entropy": 1.3843357546768758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 474195.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 1087.0, "episode_reward_min": -28.0, "episode_reward_mean": 513.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 51.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0, 598.0, 405.0, 489.0, 693.0, 420.0, 335.0, 239.0, 458.0, 275.0, 571.0, 457.0, 304.0, 403.0, 523.0, -28.0, 652.0, 431.0, 437.0, 355.0, 267.0, 820.0, 607.0, 1087.0, 578.0, 364.0, 802.0, 345.0, 467.0, 839.0, 430.0, 260.0, 454.0, 536.0, 487.0, 564.0, 243.0, 539.0, 738.0, 363.0, 444.0, 473.0, 408.0, 479.0, 764.0, 391.0, 619.0, 596.0, 618.0, 334.0, 583.0, 489.0, 454.0, 572.0, 463.0, 291.0, 381.0, 587.0, 446.0, 563.0, 248.0, 460.0, 632.0, 619.0, 471.0, 568.0, 271.0, 570.0, 348.0, 967.0, 647.0, 524.0, 696.0, 367.0, 293.0, 788.0, 655.0, 664.0, 949.0, 507.0, 819.0, 556.0, 370.0, 242.0, 499.0, 622.0, 351.0, 579.0, 792.0, 727.0, 628.0, 715.0, 412.0, 858.0, 310.0, 505.0, 203.0, 456.0, 539.0, 778.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 10.0, 40.0, 3.0, 63.0, -4.0, 26.0, 3.0, 17.0, -5.0, 30.0, 40.0, 10.0, 39.0, 50.0, 29.0, 20.0, 260.0, 100.0, 20.0, 60.0, 6.0, 70.0, 19.0, 60.0, 50.0, 60.0, -16.0, 53.0, 43.0, 20.0, 40.0, 3.0, 40.0, 30.0, 80.0, 160.0, 70.0, 36.0, 10.0, 35.0, 148.0, 90.0, 60.0, 49.0, 70.0, 55.0, 110.0, 48.0, 28.0, 170.0, 38.0, 20.0, 100.0, -11.0, 20.0, 37.0, 5.0, 22.0, 19.0, 90.0, 16.0, -30.0, -16.0, 40.0, 40.0, 30.0, 180.0, -10.0, -5.0, 40.0, -36.0, -77.0, 40.0, 250.0, 30.0, 16.0, -16.0, -16.0, 8.0, 150.0, 40.0, 50.0, 40.0, 37.0, 11.0, 20.0, 60.0, 70.0, -20.0, 14.0, 45.0, -54.0, 60.0, -14.0, 16.0, 60.0, 28.0, 80.0, 40.0, 125.0, 32.0, 200.0, 0.0, 20.0, 50.0, 168.0, -29.0, -45.0, 50.0, 100.0, 28.0, 27.0, 40.0, 32.0, 30.0, 10.0, 40.0, 70.0, 80.0, 33.0, 13.0, 2.0, 50.0, 35.0, 43.0, -12.0, -22.0, 160.0, 2.0, -10.0, 10.0, 160.0, 16.0, 41.0, 30.0, 90.0, 20.0, -6.0, 52.0, 19.0, 50.0, 30.0, 48.0, 90.0, 59.0, 97.0, 60.0, 10.0, 60.0, 40.0, -94.0, -125.0, 5.0, 29.0, 15.0, 21.0, 5.0, 16.0, 60.0, 17.0, 60.0, 49.0, 282.0, -11.0, 150.0, 14.0, 40.0, 22.0, 29.0, 70.0, 50.0, 20.0, 140.0, -2.0, 26.0, 20.0, 28.0, 19.0, 60.0, 30.0, 80.0, 50.0, 50.0, 29.0, 28.0, 30.0, 60.0, 50.0, 30.0, 170.0, 50.0, -11.0, -15.0, 30.0, 39.0, 10.0, 44.0, 30.0, 8.0, 90.0, -5.0, 9.0, 38.0, 40.0, -1.0, 21.0, 20.0, 30.0, 25.0, 30.0, 40.0, 30.0, 270.0, 60.0, 110.0, 30.0, 0.0, 80.0, 170.0, 90.0, 30.0, 100.0, 150.0, 10.0, 60.0, 30.0, 20.0, 57.0, 60.0, 20.0, -5.0, 190.0, 130.0, 550.0, -10.0, 98.0, -1.0, 70.0, 45.0, 10.0, 114.0, 50.0, 190.0, 140.0, -23.0, 20.0, 50.0, 100.0, -73.0, 80.0, 18.0, 20.0, 149.0, -2.0, -2.0, -4.0, 30.0, 55.0, 20.0, 157.0, 38.0, 110.0, 60.0, 35.0, 47.0, 80.0, 155.0, 40.0, 80.0, 40.0, 38.0, 50.0, 26.0, 10.0, 50.0, 46.0, 70.0, 15.0, 0.0, 20.0, 180.0, 16.0, -8.0, 50.0, 20.0, -60.0, 109.0, 60.0, 80.0, 40.0, 37.0, 30.0, 80.0, 110.0, 40.0, 43.0, 189.0, 40.0, 230.0, 12.0, 190.0, 14.0, 30.0, 20.0, 15.0, 30.0, 10.0, 79.0, 30.0, 50.0, 26.0, -12.0, 46.0, 20.0, 24.0, 30.0, 27.0, 48.0, 1.0, 46.0, 90.0, 28.0, 49.0, 30.0, 5.0, 100.0, 48.0, 30.0, 28.0, -15.0, 30.0, -42.0, 160.0, 70.0, 18.0, 53.0, 30.0, 180.0, 52.0, 69.0, 110.0, 15.0, 50.0, 70.0, -6.0, 0.0, 89.0, 60.0, 30.0, 67.0, 40.0, 170.0, 37.0, 50.0, 80.0, 25.0, 70.0, 0.0, 25.0, 20.0, 55.0, 27.0, -10.0, 110.0, -1.0, 11.0, 10.0, 40.0, -19.0, 31.0, 12.0, 13.0, 70.0, 10.0, 23.0, 60.0, 110.0, 180.0, 30.0, 79.0, 70.0, -9.0, 0.0, 45.0, 230.0, 70.0, 7.0, 176.0, 70.0, 23.0, 8.0, 90.0, 100.0, 20.0, 19.0, 34.0, 22.0, 50.0, -3.0, 70.0, 57.0, 60.0, 68.0, 24.0, 50.0, 35.0, 30.0, 50.0, 0.0, 20.0, 60.0, 60.0, 70.0, 58.0, 10.0, 7.0, 90.0, 30.0, 68.0, 50.0, -8.0, 70.0, 50.0, 38.0, 39.0, 59.0, 21.0, 19.0, 70.0, 69.0, 20.0, 43.0, 10.0, 18.0, 49.0, 80.0, 60.0, 80.0, 50.0, 87.0, 10.0, 69.0, 60.0, 70.0, 126.0, 8.0, 146.0, 68.0, 120.0, 40.0, 100.0, 80.0, -13.0, 57.0, 46.0, 10.0, 50.0, 5.0, 16.0, 20.0, 60.0, 70.0, 80.0, 80.0, 70.0, 164.0, 20.0, 70.0, -15.0, 19.0, 160.0, 60.0, 80.0, 30.0, 47.0, 30.0, 30.0, 60.0, 80.0, -66.0, 170.0, -17.0, 10.0, 180.0, 120.0, 53.0, 60.0, 28.0, 80.0, 20.0, 16.0, 33.0, 50.0, 20.0, 78.0, 28.0, 20.0, 60.0, 9.0, 80.0, 70.0, 50.0, 30.0, 200.0, 18.0, -21.0, 60.0, 60.0, 36.0, 80.0, -6.0, 38.0, 10.0, 30.0, 33.0, 170.0, 279.0, -160.0, 15.0, 23.0, 25.0, 58.0, 85.0, 33.0, 40.0, 0.0, 50.0, 50.0, 90.0, 60.0, 50.0, 80.0, -11.0, 58.0, 20.0, 64.0, 29.0, 66.0, 156.0, 7.0, 60.0, 13.0, 29.0, 50.0, 160.0, 29.0, 79.0, 15.0, 21.0, 5.0, -2.0, 15.0, 100.0, 10.0, 80.0, 30.0, 29.0, 18.0, 6.0, 25.0, 70.0, 119.0, 50.0, -66.0, 20.0, -2.0, 110.0, 5.0, 50.0, -30.0, 15.0, 49.0, 109.0, 120.0, -41.0, 70.0, 67.0, 130.0, 98.0, 31.0, 29.0, 36.0, 80.0, -3.0, 15.0, 49.0, 40.0, 18.0, 151.0, 39.0, 70.0, 29.0, 210.0, 20.0, -5.0, 20.0, 50.0, 70.0, 60.0, 50.0, -19.0, 13.0, 28.0, 90.0, 36.0, 1.0, -11.0, 30.0, 30.0, 100.0, 30.0, -20.0, 30.0, 60.0, 50.0, 60.0, 30.0, 70.0, 50.0, 80.0, 60.0, 50.0, 159.0, 48.0, 37.0, 50.0, 80.0, 28.0, 40.0, 20.0, 66.0, 60.0, 52.0, 15.0, 160.0, 80.0, 70.0, 50.0, 46.0, 49.0, -31.0, 110.0, 1.0, 30.0, 25.0, 35.0, 80.0, 142.0, 30.0, -150.0, 40.0, 165.0, -50.0, 40.0, -9.0, 133.0, 320.0, 29.0, 50.0, 10.0, 28.0, -2.0, 6.0, 40.0, -1.0, 140.0, -10.0, 0.0, 60.0, 29.0, 40.0, 40.0, 60.0, 30.0, 19.0, 159.0, 50.0, 74.0, 69.0, 60.0, 20.0, 9.0, 19.0, 40.0, 60.0, 40.0, 15.0, 25.0, 60.0, 90.0, 40.0, 160.0, 50.0, -30.0, 288.0, 80.0, 19.0, 90.0, 180.0, 38.0, 10.0, 10.0, 40.0, 80.0, 80.0, 60.0, 89.0, 60.0, 180.0, 100.0, 10.0, 30.0, 20.0, 60.0, 20.0, 80.0, -16.0, 160.0, 60.0, 59.0, -11.0, 70.0, 80.0, 160.0, 90.0, 60.0, 60.0, 90.0, 38.0, 80.0, 30.0, 60.0, 29.0, 40.0, 20.0, 37.0, 20.0, 31.0, 20.0, -3.0, 48.0, 10.0, 30.0, 30.0, 20.0, 50.0, 28.0, 50.0, 30.0, 40.0, 100.0, 10.0, 110.0, 120.0, 68.0, 50.0, 60.0, 150.0, 80.0, 29.0, 80.0, 160.0, 20.0, 50.0, 36.0, 65.0, 80.0, 70.0, 65.0, 60.0, 70.0, 90.0, 15.0, 20.0, 90.0, 110.0, 150.0, 40.0, 19.0, 170.0, 149.0, 141.0, -50.0, 10.0, 10.0, 24.0, 60.0, 55.0, 380.0, 45.0, 50.0, 28.0, 40.0, 40.0, 16.0, 92.0, 149.0, 18.0, 29.0, 17.0, 13.0, 50.0, 20.0, 270.0, 70.0, 69.0, 140.0, 90.0, 80.0, 80.0, 20.0, 27.0, 30.0, 29.0, 50.0, 24.0, 26.0, 150.0, 120.0, 15.0, 160.0, -40.0, 37.0, 70.0, 9.0, 30.0, 13.0, 16.0, 60.0, -16.0, 100.0, 19.0, 1.0, 50.0, -2.0, 19.0, 7.0, 28.0, 36.0, 17.0, 110.0, 15.0, 70.0, 60.0, 44.0, 60.0, 117.0, 33.0, -27.0, 60.0, 60.0, 33.0, 45.0, 149.0, 35.0, 30.0, 90.0, 150.0, -30.0, 0.0, 19.0, -5.0, 46.0, 9.0, 28.0, 50.0, 129.0, 40.0, 35.0, 4.0, 4.0, 25.0, 60.0, 50.0, 160.0, 26.0, 170.0, 60.0, 20.0, 70.0, -17.0, 180.0, 25.0, 18.0, -2.0, 40.0, 28.0, 600.0, -150.0, 100.0, 66.0, 220.0, 28.0, 30.0, -80.0, 60.0, 289.0, 10.0, 4.0, -21.0, 9.0, 100.0, 160.0, 30.0, 50.0, 40.0, 80.0, 110.0, 70.0, 21.0, 46.0, 310.0, 66.0, 100.0, 36.0, 50.0, -30.0, 77.0, 39.0, -7.0, 10.0, 20.0, 60.0, 27.0, 100.0, 70.0, 80.0, 27.0, 25.0, 353.0, 53.0, 60.0, 21.0, 37.0, 6.0, -7.0, 66.0, 65.0, 204.0, 20.0, 37.0, 50.0, 46.0, 36.0, 5.0, -2.0, 9.0, 100.0, 9.0, 30.0, 30.0, 60.0, 70.0, 48.0, 80.0, 60.0, 50.0, 39.0, 38.0, 20.0, -10.0, -6.0, -12.0, 0.0, 9.0, 182.0, 10.0, 10.0, 0.0, 70.0, 24.0, 10.0, 80.0, 38.0, 49.0, 65.0, 70.0, 50.0, 0.0, 79.0, 30.0, 80.0, 74.0, 20.0, 30.0, 60.0, 50.0, 66.0, 50.0, 40.0, 90.0, 39.0, 50.0, 40.0, 340.0, 50.0, 50.0, 60.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2041599695514384, "mean_inference_ms": 2.5395937057812024, "mean_action_processing_ms": 0.8327598448281682, "mean_env_wait_ms": 1.765127505781686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0759894847869873, "StateBufferConnector_ms": 0.010577201843261719, "ViewRequirementAgentConnector_ms": 0.47893524169921875}, "num_episodes": 18, "episode_return_max": 1087.0, "episode_return_min": -28.0, "episode_return_mean": 513.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.788398930963815, "num_env_steps_trained_throughput_per_sec": 32.788398930963815, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 120959.735, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120959.682, "sample_time_ms": 2973.98, "learn_time_ms": 117963.344, "learn_throughput": 33.909, "synch_weights_time_ms": 11.783}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 51, "trial_id": "6085c_00000", "date": "2024-07-02_00-41-39", "timestamp": 1719895299, "time_this_iter_s": 122.02651691436768, "time_total_s": 8147.180705547333, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8147.180705547333, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 33.830232558139535, "ram_util_percent": 80.93372093023255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.644284629809082, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.917588183521843, "policy_loss": -0.00501705142471015, "vf_loss": 6.9215789658827775, "vf_explained_var": 0.001642400584916591, "kl": 0.010262683818471174, "entropy": 1.279543755026544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 483585.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 1145.0, "episode_reward_min": 203.0, "episode_reward_mean": 553.89, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 607.0}, "policy_reward_mean": {"policy_0": 55.389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [607.0, 1087.0, 578.0, 364.0, 802.0, 345.0, 467.0, 839.0, 430.0, 260.0, 454.0, 536.0, 487.0, 564.0, 243.0, 539.0, 738.0, 363.0, 444.0, 473.0, 408.0, 479.0, 764.0, 391.0, 619.0, 596.0, 618.0, 334.0, 583.0, 489.0, 454.0, 572.0, 463.0, 291.0, 381.0, 587.0, 446.0, 563.0, 248.0, 460.0, 632.0, 619.0, 471.0, 568.0, 271.0, 570.0, 348.0, 967.0, 647.0, 524.0, 696.0, 367.0, 293.0, 788.0, 655.0, 664.0, 949.0, 507.0, 819.0, 556.0, 370.0, 242.0, 499.0, 622.0, 351.0, 579.0, 792.0, 727.0, 628.0, 715.0, 412.0, 858.0, 310.0, 505.0, 203.0, 456.0, 539.0, 778.0, 766.0, 482.0, 482.0, 543.0, 892.0, 550.0, 336.0, 504.0, 1145.0, 344.0, 956.0, 656.0, 309.0, 659.0, 320.0, 644.0, 596.0, 663.0, 400.0, 804.0, 737.0, 738.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 30.0, 100.0, 150.0, 10.0, 60.0, 30.0, 20.0, 57.0, 60.0, 20.0, -5.0, 190.0, 130.0, 550.0, -10.0, 98.0, -1.0, 70.0, 45.0, 10.0, 114.0, 50.0, 190.0, 140.0, -23.0, 20.0, 50.0, 100.0, -73.0, 80.0, 18.0, 20.0, 149.0, -2.0, -2.0, -4.0, 30.0, 55.0, 20.0, 157.0, 38.0, 110.0, 60.0, 35.0, 47.0, 80.0, 155.0, 40.0, 80.0, 40.0, 38.0, 50.0, 26.0, 10.0, 50.0, 46.0, 70.0, 15.0, 0.0, 20.0, 180.0, 16.0, -8.0, 50.0, 20.0, -60.0, 109.0, 60.0, 80.0, 40.0, 37.0, 30.0, 80.0, 110.0, 40.0, 43.0, 189.0, 40.0, 230.0, 12.0, 190.0, 14.0, 30.0, 20.0, 15.0, 30.0, 10.0, 79.0, 30.0, 50.0, 26.0, -12.0, 46.0, 20.0, 24.0, 30.0, 27.0, 48.0, 1.0, 46.0, 90.0, 28.0, 49.0, 30.0, 5.0, 100.0, 48.0, 30.0, 28.0, -15.0, 30.0, -42.0, 160.0, 70.0, 18.0, 53.0, 30.0, 180.0, 52.0, 69.0, 110.0, 15.0, 50.0, 70.0, -6.0, 0.0, 89.0, 60.0, 30.0, 67.0, 40.0, 170.0, 37.0, 50.0, 80.0, 25.0, 70.0, 0.0, 25.0, 20.0, 55.0, 27.0, -10.0, 110.0, -1.0, 11.0, 10.0, 40.0, -19.0, 31.0, 12.0, 13.0, 70.0, 10.0, 23.0, 60.0, 110.0, 180.0, 30.0, 79.0, 70.0, -9.0, 0.0, 45.0, 230.0, 70.0, 7.0, 176.0, 70.0, 23.0, 8.0, 90.0, 100.0, 20.0, 19.0, 34.0, 22.0, 50.0, -3.0, 70.0, 57.0, 60.0, 68.0, 24.0, 50.0, 35.0, 30.0, 50.0, 0.0, 20.0, 60.0, 60.0, 70.0, 58.0, 10.0, 7.0, 90.0, 30.0, 68.0, 50.0, -8.0, 70.0, 50.0, 38.0, 39.0, 59.0, 21.0, 19.0, 70.0, 69.0, 20.0, 43.0, 10.0, 18.0, 49.0, 80.0, 60.0, 80.0, 50.0, 87.0, 10.0, 69.0, 60.0, 70.0, 126.0, 8.0, 146.0, 68.0, 120.0, 40.0, 100.0, 80.0, -13.0, 57.0, 46.0, 10.0, 50.0, 5.0, 16.0, 20.0, 60.0, 70.0, 80.0, 80.0, 70.0, 164.0, 20.0, 70.0, -15.0, 19.0, 160.0, 60.0, 80.0, 30.0, 47.0, 30.0, 30.0, 60.0, 80.0, -66.0, 170.0, -17.0, 10.0, 180.0, 120.0, 53.0, 60.0, 28.0, 80.0, 20.0, 16.0, 33.0, 50.0, 20.0, 78.0, 28.0, 20.0, 60.0, 9.0, 80.0, 70.0, 50.0, 30.0, 200.0, 18.0, -21.0, 60.0, 60.0, 36.0, 80.0, -6.0, 38.0, 10.0, 30.0, 33.0, 170.0, 279.0, -160.0, 15.0, 23.0, 25.0, 58.0, 85.0, 33.0, 40.0, 0.0, 50.0, 50.0, 90.0, 60.0, 50.0, 80.0, -11.0, 58.0, 20.0, 64.0, 29.0, 66.0, 156.0, 7.0, 60.0, 13.0, 29.0, 50.0, 160.0, 29.0, 79.0, 15.0, 21.0, 5.0, -2.0, 15.0, 100.0, 10.0, 80.0, 30.0, 29.0, 18.0, 6.0, 25.0, 70.0, 119.0, 50.0, -66.0, 20.0, -2.0, 110.0, 5.0, 50.0, -30.0, 15.0, 49.0, 109.0, 120.0, -41.0, 70.0, 67.0, 130.0, 98.0, 31.0, 29.0, 36.0, 80.0, -3.0, 15.0, 49.0, 40.0, 18.0, 151.0, 39.0, 70.0, 29.0, 210.0, 20.0, -5.0, 20.0, 50.0, 70.0, 60.0, 50.0, -19.0, 13.0, 28.0, 90.0, 36.0, 1.0, -11.0, 30.0, 30.0, 100.0, 30.0, -20.0, 30.0, 60.0, 50.0, 60.0, 30.0, 70.0, 50.0, 80.0, 60.0, 50.0, 159.0, 48.0, 37.0, 50.0, 80.0, 28.0, 40.0, 20.0, 66.0, 60.0, 52.0, 15.0, 160.0, 80.0, 70.0, 50.0, 46.0, 49.0, -31.0, 110.0, 1.0, 30.0, 25.0, 35.0, 80.0, 142.0, 30.0, -150.0, 40.0, 165.0, -50.0, 40.0, -9.0, 133.0, 320.0, 29.0, 50.0, 10.0, 28.0, -2.0, 6.0, 40.0, -1.0, 140.0, -10.0, 0.0, 60.0, 29.0, 40.0, 40.0, 60.0, 30.0, 19.0, 159.0, 50.0, 74.0, 69.0, 60.0, 20.0, 9.0, 19.0, 40.0, 60.0, 40.0, 15.0, 25.0, 60.0, 90.0, 40.0, 160.0, 50.0, -30.0, 288.0, 80.0, 19.0, 90.0, 180.0, 38.0, 10.0, 10.0, 40.0, 80.0, 80.0, 60.0, 89.0, 60.0, 180.0, 100.0, 10.0, 30.0, 20.0, 60.0, 20.0, 80.0, -16.0, 160.0, 60.0, 59.0, -11.0, 70.0, 80.0, 160.0, 90.0, 60.0, 60.0, 90.0, 38.0, 80.0, 30.0, 60.0, 29.0, 40.0, 20.0, 37.0, 20.0, 31.0, 20.0, -3.0, 48.0, 10.0, 30.0, 30.0, 20.0, 50.0, 28.0, 50.0, 30.0, 40.0, 100.0, 10.0, 110.0, 120.0, 68.0, 50.0, 60.0, 150.0, 80.0, 29.0, 80.0, 160.0, 20.0, 50.0, 36.0, 65.0, 80.0, 70.0, 65.0, 60.0, 70.0, 90.0, 15.0, 20.0, 90.0, 110.0, 150.0, 40.0, 19.0, 170.0, 149.0, 141.0, -50.0, 10.0, 10.0, 24.0, 60.0, 55.0, 380.0, 45.0, 50.0, 28.0, 40.0, 40.0, 16.0, 92.0, 149.0, 18.0, 29.0, 17.0, 13.0, 50.0, 20.0, 270.0, 70.0, 69.0, 140.0, 90.0, 80.0, 80.0, 20.0, 27.0, 30.0, 29.0, 50.0, 24.0, 26.0, 150.0, 120.0, 15.0, 160.0, -40.0, 37.0, 70.0, 9.0, 30.0, 13.0, 16.0, 60.0, -16.0, 100.0, 19.0, 1.0, 50.0, -2.0, 19.0, 7.0, 28.0, 36.0, 17.0, 110.0, 15.0, 70.0, 60.0, 44.0, 60.0, 117.0, 33.0, -27.0, 60.0, 60.0, 33.0, 45.0, 149.0, 35.0, 30.0, 90.0, 150.0, -30.0, 0.0, 19.0, -5.0, 46.0, 9.0, 28.0, 50.0, 129.0, 40.0, 35.0, 4.0, 4.0, 25.0, 60.0, 50.0, 160.0, 26.0, 170.0, 60.0, 20.0, 70.0, -17.0, 180.0, 25.0, 18.0, -2.0, 40.0, 28.0, 600.0, -150.0, 100.0, 66.0, 220.0, 28.0, 30.0, -80.0, 60.0, 289.0, 10.0, 4.0, -21.0, 9.0, 100.0, 160.0, 30.0, 50.0, 40.0, 80.0, 110.0, 70.0, 21.0, 46.0, 310.0, 66.0, 100.0, 36.0, 50.0, -30.0, 77.0, 39.0, -7.0, 10.0, 20.0, 60.0, 27.0, 100.0, 70.0, 80.0, 27.0, 25.0, 353.0, 53.0, 60.0, 21.0, 37.0, 6.0, -7.0, 66.0, 65.0, 204.0, 20.0, 37.0, 50.0, 46.0, 36.0, 5.0, -2.0, 9.0, 100.0, 9.0, 30.0, 30.0, 60.0, 70.0, 48.0, 80.0, 60.0, 50.0, 39.0, 38.0, 20.0, -10.0, -6.0, -12.0, 0.0, 9.0, 182.0, 10.0, 10.0, 0.0, 70.0, 24.0, 10.0, 80.0, 38.0, 49.0, 65.0, 70.0, 50.0, 0.0, 79.0, 30.0, 80.0, 74.0, 20.0, 30.0, 60.0, 50.0, 66.0, 50.0, 40.0, 90.0, 39.0, 50.0, 40.0, 340.0, 50.0, 50.0, 60.0, 19.0, 7.0, 80.0, 147.0, 62.0, 80.0, 50.0, 70.0, 170.0, 47.0, 53.0, 48.0, 80.0, 50.0, 48.0, 110.0, 50.0, -132.0, 80.0, 68.0, 80.0, 68.0, 70.0, -42.0, 2.0, 55.0, 120.0, 100.0, 40.0, 50.0, 19.0, 180.0, 19.0, 8.0, 38.0, 180.0, -5.0, 160.0, -86.0, 60.0, -11.0, 160.0, 95.0, 38.0, 65.0, 70.0, 157.0, 63.0, 76.0, 100.0, 68.0, 10.0, 30.0, 34.0, 100.0, 50.0, 90.0, 13.0, 41.0, 27.0, 155.0, 38.0, 29.0, 43.0, 86.0, 19.0, 32.0, 9.0, 50.0, -6.0, 36.0, 42.0, 60.0, -45.0, 38.0, 58.0, 6.0, 170.0, 60.0, 162.0, -47.0, -15.0, 45.0, 70.0, 53.0, 15.0, 48.0, 320.0, 76.0, 100.0, 433.0, -1.0, -13.0, 70.0, 27.0, 10.0, 60.0, -3.0, 27.0, 52.0, 115.0, 10.0, 19.0, 607.0, 120.0, 50.0, 70.0, 90.0, 10.0, -30.0, 10.0, 60.0, 120.0, 80.0, -16.0, 60.0, 153.0, 59.0, 60.0, 31.0, 49.0, 8.0, 41.0, 120.0, 40.0, 24.0, 38.0, 36.0, 22.0, -30.0, 10.0, 10.0, 50.0, 40.0, 60.0, 80.0, 40.0, 49.0, 80.0, 230.0, 20.0, 100.0, 0.0, 47.0, 14.0, 60.0, 10.0, 18.0, 58.0, 0.0, 13.0, -6.0, 160.0, 90.0, 50.0, 70.0, 50.0, 80.0, 60.0, 30.0, 60.0, 20.0, 360.0, 0.0, 50.0, 37.0, 30.0, 40.0, -31.0, 0.0, 90.0, 69.0, 54.0, 30.0, 153.0, 9.0, 90.0, 30.0, 161.0, 17.0, 50.0, -1.0, -5.0, 120.0, 110.0, 30.0, 0.0, 60.0, 10.0, 47.0, 29.0, 50.0, 50.0, 120.0, 60.0, 100.0, 60.0, 60.0, 159.0, 60.0, 85.0, 60.0, 70.0, 130.0, -4.0, 209.0, 60.0, 50.0, 48.0, 74.0, 40.0, 190.0, 58.0, 74.0, -12.0, 120.0, 97.0, 80.0, 50.0, 40.0, 41.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.193996118630061, "mean_inference_ms": 2.528743831675747, "mean_action_processing_ms": 0.8295688852353436, "mean_env_wait_ms": 1.7575260075789396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07543134689331055, "StateBufferConnector_ms": 0.011853933334350586, "ViewRequirementAgentConnector_ms": 0.49385881423950195}, "num_episodes": 22, "episode_return_max": 1145.0, "episode_return_min": 203.0, "episode_return_mean": 553.89, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.11950853485182, "num_env_steps_trained_throughput_per_sec": 33.11950853485182, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 120994.638, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120994.584, "sample_time_ms": 3076.425, "learn_time_ms": 117894.898, "learn_throughput": 33.929, "synch_weights_time_ms": 12.174}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 52, "trial_id": "6085c_00000", "date": "2024-07-02_00-43-40", "timestamp": 1719895420, "time_this_iter_s": 120.82347893714905, "time_total_s": 8268.004184484482, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a88c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8268.004184484482, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 28.766666666666662, "ram_util_percent": 79.48245614035088}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.0672396983328465, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.067077158205806, "policy_loss": -0.005917858523619188, "vf_loss": 7.071870368281112, "vf_explained_var": -0.015736747308534048, "kl": 0.01124650938958748, "entropy": 1.2881572655341622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 492975.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "env_runners": {"episode_reward_max": 1145.0, "episode_reward_min": 203.0, "episode_reward_mean": 575.44, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 607.0}, "policy_reward_mean": {"policy_0": 57.544}, "custom_metrics": {}, "hist_stats": {"episode_reward": [391.0, 619.0, 596.0, 618.0, 334.0, 583.0, 489.0, 454.0, 572.0, 463.0, 291.0, 381.0, 587.0, 446.0, 563.0, 248.0, 460.0, 632.0, 619.0, 471.0, 568.0, 271.0, 570.0, 348.0, 967.0, 647.0, 524.0, 696.0, 367.0, 293.0, 788.0, 655.0, 664.0, 949.0, 507.0, 819.0, 556.0, 370.0, 242.0, 499.0, 622.0, 351.0, 579.0, 792.0, 727.0, 628.0, 715.0, 412.0, 858.0, 310.0, 505.0, 203.0, 456.0, 539.0, 778.0, 766.0, 482.0, 482.0, 543.0, 892.0, 550.0, 336.0, 504.0, 1145.0, 344.0, 956.0, 656.0, 309.0, 659.0, 320.0, 644.0, 596.0, 663.0, 400.0, 804.0, 737.0, 738.0, 484.0, 1079.0, 671.0, 316.0, 791.0, 528.0, 782.0, 936.0, 586.0, 638.0, 542.0, 718.0, 415.0, 498.0, 710.0, 432.0, 454.0, 651.0, 464.0, 524.0, 946.0, 457.0, 804.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 100.0, 80.0, -13.0, 57.0, 46.0, 10.0, 50.0, 5.0, 16.0, 20.0, 60.0, 70.0, 80.0, 80.0, 70.0, 164.0, 20.0, 70.0, -15.0, 19.0, 160.0, 60.0, 80.0, 30.0, 47.0, 30.0, 30.0, 60.0, 80.0, -66.0, 170.0, -17.0, 10.0, 180.0, 120.0, 53.0, 60.0, 28.0, 80.0, 20.0, 16.0, 33.0, 50.0, 20.0, 78.0, 28.0, 20.0, 60.0, 9.0, 80.0, 70.0, 50.0, 30.0, 200.0, 18.0, -21.0, 60.0, 60.0, 36.0, 80.0, -6.0, 38.0, 10.0, 30.0, 33.0, 170.0, 279.0, -160.0, 15.0, 23.0, 25.0, 58.0, 85.0, 33.0, 40.0, 0.0, 50.0, 50.0, 90.0, 60.0, 50.0, 80.0, -11.0, 58.0, 20.0, 64.0, 29.0, 66.0, 156.0, 7.0, 60.0, 13.0, 29.0, 50.0, 160.0, 29.0, 79.0, 15.0, 21.0, 5.0, -2.0, 15.0, 100.0, 10.0, 80.0, 30.0, 29.0, 18.0, 6.0, 25.0, 70.0, 119.0, 50.0, -66.0, 20.0, -2.0, 110.0, 5.0, 50.0, -30.0, 15.0, 49.0, 109.0, 120.0, -41.0, 70.0, 67.0, 130.0, 98.0, 31.0, 29.0, 36.0, 80.0, -3.0, 15.0, 49.0, 40.0, 18.0, 151.0, 39.0, 70.0, 29.0, 210.0, 20.0, -5.0, 20.0, 50.0, 70.0, 60.0, 50.0, -19.0, 13.0, 28.0, 90.0, 36.0, 1.0, -11.0, 30.0, 30.0, 100.0, 30.0, -20.0, 30.0, 60.0, 50.0, 60.0, 30.0, 70.0, 50.0, 80.0, 60.0, 50.0, 159.0, 48.0, 37.0, 50.0, 80.0, 28.0, 40.0, 20.0, 66.0, 60.0, 52.0, 15.0, 160.0, 80.0, 70.0, 50.0, 46.0, 49.0, -31.0, 110.0, 1.0, 30.0, 25.0, 35.0, 80.0, 142.0, 30.0, -150.0, 40.0, 165.0, -50.0, 40.0, -9.0, 133.0, 320.0, 29.0, 50.0, 10.0, 28.0, -2.0, 6.0, 40.0, -1.0, 140.0, -10.0, 0.0, 60.0, 29.0, 40.0, 40.0, 60.0, 30.0, 19.0, 159.0, 50.0, 74.0, 69.0, 60.0, 20.0, 9.0, 19.0, 40.0, 60.0, 40.0, 15.0, 25.0, 60.0, 90.0, 40.0, 160.0, 50.0, -30.0, 288.0, 80.0, 19.0, 90.0, 180.0, 38.0, 10.0, 10.0, 40.0, 80.0, 80.0, 60.0, 89.0, 60.0, 180.0, 100.0, 10.0, 30.0, 20.0, 60.0, 20.0, 80.0, -16.0, 160.0, 60.0, 59.0, -11.0, 70.0, 80.0, 160.0, 90.0, 60.0, 60.0, 90.0, 38.0, 80.0, 30.0, 60.0, 29.0, 40.0, 20.0, 37.0, 20.0, 31.0, 20.0, -3.0, 48.0, 10.0, 30.0, 30.0, 20.0, 50.0, 28.0, 50.0, 30.0, 40.0, 100.0, 10.0, 110.0, 120.0, 68.0, 50.0, 60.0, 150.0, 80.0, 29.0, 80.0, 160.0, 20.0, 50.0, 36.0, 65.0, 80.0, 70.0, 65.0, 60.0, 70.0, 90.0, 15.0, 20.0, 90.0, 110.0, 150.0, 40.0, 19.0, 170.0, 149.0, 141.0, -50.0, 10.0, 10.0, 24.0, 60.0, 55.0, 380.0, 45.0, 50.0, 28.0, 40.0, 40.0, 16.0, 92.0, 149.0, 18.0, 29.0, 17.0, 13.0, 50.0, 20.0, 270.0, 70.0, 69.0, 140.0, 90.0, 80.0, 80.0, 20.0, 27.0, 30.0, 29.0, 50.0, 24.0, 26.0, 150.0, 120.0, 15.0, 160.0, -40.0, 37.0, 70.0, 9.0, 30.0, 13.0, 16.0, 60.0, -16.0, 100.0, 19.0, 1.0, 50.0, -2.0, 19.0, 7.0, 28.0, 36.0, 17.0, 110.0, 15.0, 70.0, 60.0, 44.0, 60.0, 117.0, 33.0, -27.0, 60.0, 60.0, 33.0, 45.0, 149.0, 35.0, 30.0, 90.0, 150.0, -30.0, 0.0, 19.0, -5.0, 46.0, 9.0, 28.0, 50.0, 129.0, 40.0, 35.0, 4.0, 4.0, 25.0, 60.0, 50.0, 160.0, 26.0, 170.0, 60.0, 20.0, 70.0, -17.0, 180.0, 25.0, 18.0, -2.0, 40.0, 28.0, 600.0, -150.0, 100.0, 66.0, 220.0, 28.0, 30.0, -80.0, 60.0, 289.0, 10.0, 4.0, -21.0, 9.0, 100.0, 160.0, 30.0, 50.0, 40.0, 80.0, 110.0, 70.0, 21.0, 46.0, 310.0, 66.0, 100.0, 36.0, 50.0, -30.0, 77.0, 39.0, -7.0, 10.0, 20.0, 60.0, 27.0, 100.0, 70.0, 80.0, 27.0, 25.0, 353.0, 53.0, 60.0, 21.0, 37.0, 6.0, -7.0, 66.0, 65.0, 204.0, 20.0, 37.0, 50.0, 46.0, 36.0, 5.0, -2.0, 9.0, 100.0, 9.0, 30.0, 30.0, 60.0, 70.0, 48.0, 80.0, 60.0, 50.0, 39.0, 38.0, 20.0, -10.0, -6.0, -12.0, 0.0, 9.0, 182.0, 10.0, 10.0, 0.0, 70.0, 24.0, 10.0, 80.0, 38.0, 49.0, 65.0, 70.0, 50.0, 0.0, 79.0, 30.0, 80.0, 74.0, 20.0, 30.0, 60.0, 50.0, 66.0, 50.0, 40.0, 90.0, 39.0, 50.0, 40.0, 340.0, 50.0, 50.0, 60.0, 19.0, 7.0, 80.0, 147.0, 62.0, 80.0, 50.0, 70.0, 170.0, 47.0, 53.0, 48.0, 80.0, 50.0, 48.0, 110.0, 50.0, -132.0, 80.0, 68.0, 80.0, 68.0, 70.0, -42.0, 2.0, 55.0, 120.0, 100.0, 40.0, 50.0, 19.0, 180.0, 19.0, 8.0, 38.0, 180.0, -5.0, 160.0, -86.0, 60.0, -11.0, 160.0, 95.0, 38.0, 65.0, 70.0, 157.0, 63.0, 76.0, 100.0, 68.0, 10.0, 30.0, 34.0, 100.0, 50.0, 90.0, 13.0, 41.0, 27.0, 155.0, 38.0, 29.0, 43.0, 86.0, 19.0, 32.0, 9.0, 50.0, -6.0, 36.0, 42.0, 60.0, -45.0, 38.0, 58.0, 6.0, 170.0, 60.0, 162.0, -47.0, -15.0, 45.0, 70.0, 53.0, 15.0, 48.0, 320.0, 76.0, 100.0, 433.0, -1.0, -13.0, 70.0, 27.0, 10.0, 60.0, -3.0, 27.0, 52.0, 115.0, 10.0, 19.0, 607.0, 120.0, 50.0, 70.0, 90.0, 10.0, -30.0, 10.0, 60.0, 120.0, 80.0, -16.0, 60.0, 153.0, 59.0, 60.0, 31.0, 49.0, 8.0, 41.0, 120.0, 40.0, 24.0, 38.0, 36.0, 22.0, -30.0, 10.0, 10.0, 50.0, 40.0, 60.0, 80.0, 40.0, 49.0, 80.0, 230.0, 20.0, 100.0, 0.0, 47.0, 14.0, 60.0, 10.0, 18.0, 58.0, 0.0, 13.0, -6.0, 160.0, 90.0, 50.0, 70.0, 50.0, 80.0, 60.0, 30.0, 60.0, 20.0, 360.0, 0.0, 50.0, 37.0, 30.0, 40.0, -31.0, 0.0, 90.0, 69.0, 54.0, 30.0, 153.0, 9.0, 90.0, 30.0, 161.0, 17.0, 50.0, -1.0, -5.0, 120.0, 110.0, 30.0, 0.0, 60.0, 10.0, 47.0, 29.0, 50.0, 50.0, 120.0, 60.0, 100.0, 60.0, 60.0, 159.0, 60.0, 85.0, 60.0, 70.0, 130.0, -4.0, 209.0, 60.0, 50.0, 48.0, 74.0, 40.0, 190.0, 58.0, 74.0, -12.0, 120.0, 97.0, 80.0, 50.0, 40.0, 41.0, 31.0, 120.0, 26.0, 170.0, -4.0, 9.0, 90.0, 30.0, -4.0, 16.0, 40.0, 76.0, 174.0, 165.0, 169.0, 70.0, 67.0, 69.0, 169.0, 80.0, 43.0, 70.0, 80.0, 170.0, 70.0, 50.0, 70.0, -34.0, 60.0, 92.0, 50.0, 80.0, 49.0, 37.0, 6.0, 30.0, 30.0, 30.0, 1.0, 3.0, 47.0, 40.0, 80.0, 178.0, 8.0, 202.0, 60.0, 59.0, 90.0, 27.0, 60.0, 160.0, -2.0, 20.0, 50.0, 60.0, 60.0, 50.0, 50.0, 20.0, 42.0, 120.0, 60.0, 100.0, 210.0, 63.0, 56.0, 40.0, 50.0, 41.0, 110.0, 44.0, 299.0, 180.0, 20.0, 158.0, 25.0, 20.0, 50.0, 30.0, 50.0, 59.0, 110.0, 31.0, 35.0, 100.0, 50.0, 80.0, 11.0, 60.0, 140.0, 149.0, -20.0, 80.0, 70.0, 26.0, 36.0, 70.0, 39.0, 48.0, 70.0, -43.0, 70.0, 30.0, 70.0, 34.0, 258.0, 35.0, -10.0, 28.0, 70.0, 45.0, 168.0, 60.0, 7.0, 30.0, 169.0, 90.0, 39.0, 40.0, 20.0, 50.0, 39.0, 70.0, -14.0, 55.0, -35.0, 80.0, 100.0, 50.0, -20.0, -23.0, 57.0, 95.0, 35.0, 58.0, 40.0, 110.0, 66.0, 80.0, 80.0, 110.0, 60.0, 90.0, 50.0, 40.0, 160.0, 50.0, 0.0, 70.0, 90.0, 20.0, 10.0, -53.0, 90.0, 15.0, 80.0, 60.0, 70.0, 50.0, -1.0, 33.0, 70.0, 110.0, 15.0, 57.0, 40.0, 70.0, 10.0, 50.0, 60.0, 10.0, 45.0, 50.0, 110.0, 66.0, 100.0, 20.0, 40.0, 150.0, 70.0, 70.0, 10.0, 30.0, 28.0, 33.0, 23.0, 30.0, 130.0, 40.0, -22.0, 46.0, 20.0, 50.0, 40.0, 50.0, 30.0, 60.0, 160.0, 90.0, 120.0, 40.0, 50.0, 65.0, 180.0, -10.0, 150.0, 60.0, 43.0, 248.0, 20.0, 88.0, 30.0, 50.0, 30.0, 59.0, 70.0, 10.0, 60.0, 40.0, -40.0, 210.0, 210.0, 50.0, 8.0, 50.0, 60.0, 170.0, 55.0, 31.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.183260393304116, "mean_inference_ms": 2.5169868888599196, "mean_action_processing_ms": 0.8263603429529328, "mean_env_wait_ms": 1.7501586075684759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07547688484191895, "StateBufferConnector_ms": 0.011636972427368164, "ViewRequirementAgentConnector_ms": 0.5417101383209229}, "num_episodes": 23, "episode_return_max": 1145.0, "episode_return_min": 203.0, "episode_return_mean": 575.44, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.10240959315013, "num_env_steps_trained_throughput_per_sec": 33.10240959315013, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 2120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2120000, "timers": {"training_iteration_time_ms": 121031.703, "restore_workers_time_ms": 0.013, "training_step_time_ms": 121031.649, "sample_time_ms": 3121.256, "learn_time_ms": 117887.23, "learn_throughput": 33.931, "synch_weights_time_ms": 12.323}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "done": false, "training_iteration": 53, "trial_id": "6085c_00000", "date": "2024-07-02_00-45-41", "timestamp": 1719895541, "time_this_iter_s": 120.85527420043945, "time_total_s": 8388.859458684921, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238edc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8388.859458684921, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 28.71988304093567, "ram_util_percent": 79.63333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.65099528277644, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.920684428209949, "policy_loss": -0.006097597549907482, "vf_loss": 6.925716746221589, "vf_explained_var": 0.0026415501603176293, "kl": 0.010652780709031097, "entropy": 1.2397372259499546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 502365.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 1445.0, "episode_reward_min": 203.0, "episode_reward_mean": 621.82, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 607.0}, "policy_reward_mean": {"policy_0": 62.182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [619.0, 471.0, 568.0, 271.0, 570.0, 348.0, 967.0, 647.0, 524.0, 696.0, 367.0, 293.0, 788.0, 655.0, 664.0, 949.0, 507.0, 819.0, 556.0, 370.0, 242.0, 499.0, 622.0, 351.0, 579.0, 792.0, 727.0, 628.0, 715.0, 412.0, 858.0, 310.0, 505.0, 203.0, 456.0, 539.0, 778.0, 766.0, 482.0, 482.0, 543.0, 892.0, 550.0, 336.0, 504.0, 1145.0, 344.0, 956.0, 656.0, 309.0, 659.0, 320.0, 644.0, 596.0, 663.0, 400.0, 804.0, 737.0, 738.0, 484.0, 1079.0, 671.0, 316.0, 791.0, 528.0, 782.0, 936.0, 586.0, 638.0, 542.0, 718.0, 415.0, 498.0, 710.0, 432.0, 454.0, 651.0, 464.0, 524.0, 946.0, 457.0, 804.0, 378.0, 1244.0, 524.0, 776.0, 817.0, 563.0, 402.0, 754.0, 1054.0, 1445.0, 782.0, 733.0, 990.0, 525.0, 957.0, 305.0, 551.0, 565.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 66.0, 60.0, 52.0, 15.0, 160.0, 80.0, 70.0, 50.0, 46.0, 49.0, -31.0, 110.0, 1.0, 30.0, 25.0, 35.0, 80.0, 142.0, 30.0, -150.0, 40.0, 165.0, -50.0, 40.0, -9.0, 133.0, 320.0, 29.0, 50.0, 10.0, 28.0, -2.0, 6.0, 40.0, -1.0, 140.0, -10.0, 0.0, 60.0, 29.0, 40.0, 40.0, 60.0, 30.0, 19.0, 159.0, 50.0, 74.0, 69.0, 60.0, 20.0, 9.0, 19.0, 40.0, 60.0, 40.0, 15.0, 25.0, 60.0, 90.0, 40.0, 160.0, 50.0, -30.0, 288.0, 80.0, 19.0, 90.0, 180.0, 38.0, 10.0, 10.0, 40.0, 80.0, 80.0, 60.0, 89.0, 60.0, 180.0, 100.0, 10.0, 30.0, 20.0, 60.0, 20.0, 80.0, -16.0, 160.0, 60.0, 59.0, -11.0, 70.0, 80.0, 160.0, 90.0, 60.0, 60.0, 90.0, 38.0, 80.0, 30.0, 60.0, 29.0, 40.0, 20.0, 37.0, 20.0, 31.0, 20.0, -3.0, 48.0, 10.0, 30.0, 30.0, 20.0, 50.0, 28.0, 50.0, 30.0, 40.0, 100.0, 10.0, 110.0, 120.0, 68.0, 50.0, 60.0, 150.0, 80.0, 29.0, 80.0, 160.0, 20.0, 50.0, 36.0, 65.0, 80.0, 70.0, 65.0, 60.0, 70.0, 90.0, 15.0, 20.0, 90.0, 110.0, 150.0, 40.0, 19.0, 170.0, 149.0, 141.0, -50.0, 10.0, 10.0, 24.0, 60.0, 55.0, 380.0, 45.0, 50.0, 28.0, 40.0, 40.0, 16.0, 92.0, 149.0, 18.0, 29.0, 17.0, 13.0, 50.0, 20.0, 270.0, 70.0, 69.0, 140.0, 90.0, 80.0, 80.0, 20.0, 27.0, 30.0, 29.0, 50.0, 24.0, 26.0, 150.0, 120.0, 15.0, 160.0, -40.0, 37.0, 70.0, 9.0, 30.0, 13.0, 16.0, 60.0, -16.0, 100.0, 19.0, 1.0, 50.0, -2.0, 19.0, 7.0, 28.0, 36.0, 17.0, 110.0, 15.0, 70.0, 60.0, 44.0, 60.0, 117.0, 33.0, -27.0, 60.0, 60.0, 33.0, 45.0, 149.0, 35.0, 30.0, 90.0, 150.0, -30.0, 0.0, 19.0, -5.0, 46.0, 9.0, 28.0, 50.0, 129.0, 40.0, 35.0, 4.0, 4.0, 25.0, 60.0, 50.0, 160.0, 26.0, 170.0, 60.0, 20.0, 70.0, -17.0, 180.0, 25.0, 18.0, -2.0, 40.0, 28.0, 600.0, -150.0, 100.0, 66.0, 220.0, 28.0, 30.0, -80.0, 60.0, 289.0, 10.0, 4.0, -21.0, 9.0, 100.0, 160.0, 30.0, 50.0, 40.0, 80.0, 110.0, 70.0, 21.0, 46.0, 310.0, 66.0, 100.0, 36.0, 50.0, -30.0, 77.0, 39.0, -7.0, 10.0, 20.0, 60.0, 27.0, 100.0, 70.0, 80.0, 27.0, 25.0, 353.0, 53.0, 60.0, 21.0, 37.0, 6.0, -7.0, 66.0, 65.0, 204.0, 20.0, 37.0, 50.0, 46.0, 36.0, 5.0, -2.0, 9.0, 100.0, 9.0, 30.0, 30.0, 60.0, 70.0, 48.0, 80.0, 60.0, 50.0, 39.0, 38.0, 20.0, -10.0, -6.0, -12.0, 0.0, 9.0, 182.0, 10.0, 10.0, 0.0, 70.0, 24.0, 10.0, 80.0, 38.0, 49.0, 65.0, 70.0, 50.0, 0.0, 79.0, 30.0, 80.0, 74.0, 20.0, 30.0, 60.0, 50.0, 66.0, 50.0, 40.0, 90.0, 39.0, 50.0, 40.0, 340.0, 50.0, 50.0, 60.0, 19.0, 7.0, 80.0, 147.0, 62.0, 80.0, 50.0, 70.0, 170.0, 47.0, 53.0, 48.0, 80.0, 50.0, 48.0, 110.0, 50.0, -132.0, 80.0, 68.0, 80.0, 68.0, 70.0, -42.0, 2.0, 55.0, 120.0, 100.0, 40.0, 50.0, 19.0, 180.0, 19.0, 8.0, 38.0, 180.0, -5.0, 160.0, -86.0, 60.0, -11.0, 160.0, 95.0, 38.0, 65.0, 70.0, 157.0, 63.0, 76.0, 100.0, 68.0, 10.0, 30.0, 34.0, 100.0, 50.0, 90.0, 13.0, 41.0, 27.0, 155.0, 38.0, 29.0, 43.0, 86.0, 19.0, 32.0, 9.0, 50.0, -6.0, 36.0, 42.0, 60.0, -45.0, 38.0, 58.0, 6.0, 170.0, 60.0, 162.0, -47.0, -15.0, 45.0, 70.0, 53.0, 15.0, 48.0, 320.0, 76.0, 100.0, 433.0, -1.0, -13.0, 70.0, 27.0, 10.0, 60.0, -3.0, 27.0, 52.0, 115.0, 10.0, 19.0, 607.0, 120.0, 50.0, 70.0, 90.0, 10.0, -30.0, 10.0, 60.0, 120.0, 80.0, -16.0, 60.0, 153.0, 59.0, 60.0, 31.0, 49.0, 8.0, 41.0, 120.0, 40.0, 24.0, 38.0, 36.0, 22.0, -30.0, 10.0, 10.0, 50.0, 40.0, 60.0, 80.0, 40.0, 49.0, 80.0, 230.0, 20.0, 100.0, 0.0, 47.0, 14.0, 60.0, 10.0, 18.0, 58.0, 0.0, 13.0, -6.0, 160.0, 90.0, 50.0, 70.0, 50.0, 80.0, 60.0, 30.0, 60.0, 20.0, 360.0, 0.0, 50.0, 37.0, 30.0, 40.0, -31.0, 0.0, 90.0, 69.0, 54.0, 30.0, 153.0, 9.0, 90.0, 30.0, 161.0, 17.0, 50.0, -1.0, -5.0, 120.0, 110.0, 30.0, 0.0, 60.0, 10.0, 47.0, 29.0, 50.0, 50.0, 120.0, 60.0, 100.0, 60.0, 60.0, 159.0, 60.0, 85.0, 60.0, 70.0, 130.0, -4.0, 209.0, 60.0, 50.0, 48.0, 74.0, 40.0, 190.0, 58.0, 74.0, -12.0, 120.0, 97.0, 80.0, 50.0, 40.0, 41.0, 31.0, 120.0, 26.0, 170.0, -4.0, 9.0, 90.0, 30.0, -4.0, 16.0, 40.0, 76.0, 174.0, 165.0, 169.0, 70.0, 67.0, 69.0, 169.0, 80.0, 43.0, 70.0, 80.0, 170.0, 70.0, 50.0, 70.0, -34.0, 60.0, 92.0, 50.0, 80.0, 49.0, 37.0, 6.0, 30.0, 30.0, 30.0, 1.0, 3.0, 47.0, 40.0, 80.0, 178.0, 8.0, 202.0, 60.0, 59.0, 90.0, 27.0, 60.0, 160.0, -2.0, 20.0, 50.0, 60.0, 60.0, 50.0, 50.0, 20.0, 42.0, 120.0, 60.0, 100.0, 210.0, 63.0, 56.0, 40.0, 50.0, 41.0, 110.0, 44.0, 299.0, 180.0, 20.0, 158.0, 25.0, 20.0, 50.0, 30.0, 50.0, 59.0, 110.0, 31.0, 35.0, 100.0, 50.0, 80.0, 11.0, 60.0, 140.0, 149.0, -20.0, 80.0, 70.0, 26.0, 36.0, 70.0, 39.0, 48.0, 70.0, -43.0, 70.0, 30.0, 70.0, 34.0, 258.0, 35.0, -10.0, 28.0, 70.0, 45.0, 168.0, 60.0, 7.0, 30.0, 169.0, 90.0, 39.0, 40.0, 20.0, 50.0, 39.0, 70.0, -14.0, 55.0, -35.0, 80.0, 100.0, 50.0, -20.0, -23.0, 57.0, 95.0, 35.0, 58.0, 40.0, 110.0, 66.0, 80.0, 80.0, 110.0, 60.0, 90.0, 50.0, 40.0, 160.0, 50.0, 0.0, 70.0, 90.0, 20.0, 10.0, -53.0, 90.0, 15.0, 80.0, 60.0, 70.0, 50.0, -1.0, 33.0, 70.0, 110.0, 15.0, 57.0, 40.0, 70.0, 10.0, 50.0, 60.0, 10.0, 45.0, 50.0, 110.0, 66.0, 100.0, 20.0, 40.0, 150.0, 70.0, 70.0, 10.0, 30.0, 28.0, 33.0, 23.0, 30.0, 130.0, 40.0, -22.0, 46.0, 20.0, 50.0, 40.0, 50.0, 30.0, 60.0, 160.0, 90.0, 120.0, 40.0, 50.0, 65.0, 180.0, -10.0, 150.0, 60.0, 43.0, 248.0, 20.0, 88.0, 30.0, 50.0, 30.0, 59.0, 70.0, 10.0, 60.0, 40.0, -40.0, 210.0, 210.0, 50.0, 8.0, 50.0, 60.0, 170.0, 55.0, 31.0, 20.0, 20.0, 60.0, 25.0, 50.0, 30.0, 30.0, 60.0, 13.0, 70.0, 47.0, 42.0, 130.0, 430.0, 26.0, 100.0, 80.0, 100.0, 50.0, 239.0, 43.0, 57.0, 43.0, 70.0, 49.0, 36.0, 90.0, 39.0, 80.0, 17.0, 17.0, 150.0, 90.0, -4.0, 280.0, 70.0, 25.0, 30.0, 100.0, 18.0, 20.0, 60.0, -30.0, 80.0, 46.0, 99.0, 180.0, 172.0, 60.0, 130.0, 50.0, -10.0, 80.0, 60.0, 60.0, 87.0, 70.0, 50.0, 43.0, 73.0, 30.0, 40.0, 28.0, 30.0, 20.0, 110.0, 50.0, 50.0, -11.0, 55.0, 60.0, 230.0, 70.0, 66.0, -40.0, 48.0, 60.0, 40.0, 110.0, 110.0, 130.0, 30.0, 70.0, 197.0, 112.0, 70.0, 20.0, 35.0, 91.0, 299.0, 20.0, 170.0, 110.0, 550.0, 80.0, 100.0, 55.0, 220.0, 120.0, 20.0, 100.0, 55.0, 90.0, 59.0, 108.0, 43.0, 90.0, 65.0, 130.0, 42.0, -46.0, 180.0, 130.0, 39.0, 60.0, 148.0, 70.0, 12.0, 110.0, 30.0, 60.0, 40.0, 50.0, 90.0, 270.0, 90.0, 60.0, -110.0, 310.0, 130.0, 30.0, 120.0, 80.0, 70.0, 60.0, 60.0, 70.0, 28.0, 10.0, -3.0, 130.0, 150.0, 100.0, 100.0, 100.0, 150.0, 77.0, 60.0, 30.0, 60.0, 34.0, 10.0, 100.0, -5.0, 40.0, 30.0, 70.0, 6.0, 0.0, 20.0, 0.0, 37.0, 170.0, 50.0, 100.0, 31.0, 50.0, 29.0, 50.0, 34.0, 0.0, 85.0, 60.0, 144.0, 30.0, 37.0, 89.0, 70.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1761143934091893, "mean_inference_ms": 2.508001925463972, "mean_action_processing_ms": 0.8240000901873656, "mean_env_wait_ms": 1.7445201662038172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07255125045776367, "StateBufferConnector_ms": 0.011606216430664062, "ViewRequirementAgentConnector_ms": 0.5506064891815186}, "num_episodes": 18, "episode_return_max": 1445.0, "episode_return_min": 203.0, "episode_return_mean": 621.82, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.91517919517186, "num_env_steps_trained_throughput_per_sec": 32.91517919517186, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 121024.519, "restore_workers_time_ms": 0.013, "training_step_time_ms": 121024.465, "sample_time_ms": 3162.017, "learn_time_ms": 117837.865, "learn_throughput": 33.945, "synch_weights_time_ms": 12.317}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 54, "trial_id": "6085c_00000", "date": "2024-07-02_00-47-43", "timestamp": 1719895663, "time_this_iter_s": 121.5627338886261, "time_total_s": 8510.422192573547, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a88700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8510.422192573547, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 26.995930232558145, "ram_util_percent": 80.61046511627907}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.005391253564304, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.065581800838629, "policy_loss": -0.005641088655458503, "vf_loss": 7.069848135865915, "vf_explained_var": -0.003064064406993163, "kl": 0.013747604991469358, "entropy": 1.27429952973121, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 511755.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "env_runners": {"episode_reward_max": 1445.0, "episode_reward_min": 203.0, "episode_reward_mean": 629.96, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -162.0}, "policy_reward_max": {"policy_0": 607.0}, "policy_reward_mean": {"policy_0": 62.996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [556.0, 370.0, 242.0, 499.0, 622.0, 351.0, 579.0, 792.0, 727.0, 628.0, 715.0, 412.0, 858.0, 310.0, 505.0, 203.0, 456.0, 539.0, 778.0, 766.0, 482.0, 482.0, 543.0, 892.0, 550.0, 336.0, 504.0, 1145.0, 344.0, 956.0, 656.0, 309.0, 659.0, 320.0, 644.0, 596.0, 663.0, 400.0, 804.0, 737.0, 738.0, 484.0, 1079.0, 671.0, 316.0, 791.0, 528.0, 782.0, 936.0, 586.0, 638.0, 542.0, 718.0, 415.0, 498.0, 710.0, 432.0, 454.0, 651.0, 464.0, 524.0, 946.0, 457.0, 804.0, 378.0, 1244.0, 524.0, 776.0, 817.0, 563.0, 402.0, 754.0, 1054.0, 1445.0, 782.0, 733.0, 990.0, 525.0, 957.0, 305.0, 551.0, 565.0, 999.0, 800.0, 346.0, 699.0, 545.0, 482.0, 718.0, 728.0, 866.0, 911.0, 838.0, 539.0, 692.0, 555.0, 308.0, 412.0, 816.0, 283.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 20.0, 27.0, 30.0, 29.0, 50.0, 24.0, 26.0, 150.0, 120.0, 15.0, 160.0, -40.0, 37.0, 70.0, 9.0, 30.0, 13.0, 16.0, 60.0, -16.0, 100.0, 19.0, 1.0, 50.0, -2.0, 19.0, 7.0, 28.0, 36.0, 17.0, 110.0, 15.0, 70.0, 60.0, 44.0, 60.0, 117.0, 33.0, -27.0, 60.0, 60.0, 33.0, 45.0, 149.0, 35.0, 30.0, 90.0, 150.0, -30.0, 0.0, 19.0, -5.0, 46.0, 9.0, 28.0, 50.0, 129.0, 40.0, 35.0, 4.0, 4.0, 25.0, 60.0, 50.0, 160.0, 26.0, 170.0, 60.0, 20.0, 70.0, -17.0, 180.0, 25.0, 18.0, -2.0, 40.0, 28.0, 600.0, -150.0, 100.0, 66.0, 220.0, 28.0, 30.0, -80.0, 60.0, 289.0, 10.0, 4.0, -21.0, 9.0, 100.0, 160.0, 30.0, 50.0, 40.0, 80.0, 110.0, 70.0, 21.0, 46.0, 310.0, 66.0, 100.0, 36.0, 50.0, -30.0, 77.0, 39.0, -7.0, 10.0, 20.0, 60.0, 27.0, 100.0, 70.0, 80.0, 27.0, 25.0, 353.0, 53.0, 60.0, 21.0, 37.0, 6.0, -7.0, 66.0, 65.0, 204.0, 20.0, 37.0, 50.0, 46.0, 36.0, 5.0, -2.0, 9.0, 100.0, 9.0, 30.0, 30.0, 60.0, 70.0, 48.0, 80.0, 60.0, 50.0, 39.0, 38.0, 20.0, -10.0, -6.0, -12.0, 0.0, 9.0, 182.0, 10.0, 10.0, 0.0, 70.0, 24.0, 10.0, 80.0, 38.0, 49.0, 65.0, 70.0, 50.0, 0.0, 79.0, 30.0, 80.0, 74.0, 20.0, 30.0, 60.0, 50.0, 66.0, 50.0, 40.0, 90.0, 39.0, 50.0, 40.0, 340.0, 50.0, 50.0, 60.0, 19.0, 7.0, 80.0, 147.0, 62.0, 80.0, 50.0, 70.0, 170.0, 47.0, 53.0, 48.0, 80.0, 50.0, 48.0, 110.0, 50.0, -132.0, 80.0, 68.0, 80.0, 68.0, 70.0, -42.0, 2.0, 55.0, 120.0, 100.0, 40.0, 50.0, 19.0, 180.0, 19.0, 8.0, 38.0, 180.0, -5.0, 160.0, -86.0, 60.0, -11.0, 160.0, 95.0, 38.0, 65.0, 70.0, 157.0, 63.0, 76.0, 100.0, 68.0, 10.0, 30.0, 34.0, 100.0, 50.0, 90.0, 13.0, 41.0, 27.0, 155.0, 38.0, 29.0, 43.0, 86.0, 19.0, 32.0, 9.0, 50.0, -6.0, 36.0, 42.0, 60.0, -45.0, 38.0, 58.0, 6.0, 170.0, 60.0, 162.0, -47.0, -15.0, 45.0, 70.0, 53.0, 15.0, 48.0, 320.0, 76.0, 100.0, 433.0, -1.0, -13.0, 70.0, 27.0, 10.0, 60.0, -3.0, 27.0, 52.0, 115.0, 10.0, 19.0, 607.0, 120.0, 50.0, 70.0, 90.0, 10.0, -30.0, 10.0, 60.0, 120.0, 80.0, -16.0, 60.0, 153.0, 59.0, 60.0, 31.0, 49.0, 8.0, 41.0, 120.0, 40.0, 24.0, 38.0, 36.0, 22.0, -30.0, 10.0, 10.0, 50.0, 40.0, 60.0, 80.0, 40.0, 49.0, 80.0, 230.0, 20.0, 100.0, 0.0, 47.0, 14.0, 60.0, 10.0, 18.0, 58.0, 0.0, 13.0, -6.0, 160.0, 90.0, 50.0, 70.0, 50.0, 80.0, 60.0, 30.0, 60.0, 20.0, 360.0, 0.0, 50.0, 37.0, 30.0, 40.0, -31.0, 0.0, 90.0, 69.0, 54.0, 30.0, 153.0, 9.0, 90.0, 30.0, 161.0, 17.0, 50.0, -1.0, -5.0, 120.0, 110.0, 30.0, 0.0, 60.0, 10.0, 47.0, 29.0, 50.0, 50.0, 120.0, 60.0, 100.0, 60.0, 60.0, 159.0, 60.0, 85.0, 60.0, 70.0, 130.0, -4.0, 209.0, 60.0, 50.0, 48.0, 74.0, 40.0, 190.0, 58.0, 74.0, -12.0, 120.0, 97.0, 80.0, 50.0, 40.0, 41.0, 31.0, 120.0, 26.0, 170.0, -4.0, 9.0, 90.0, 30.0, -4.0, 16.0, 40.0, 76.0, 174.0, 165.0, 169.0, 70.0, 67.0, 69.0, 169.0, 80.0, 43.0, 70.0, 80.0, 170.0, 70.0, 50.0, 70.0, -34.0, 60.0, 92.0, 50.0, 80.0, 49.0, 37.0, 6.0, 30.0, 30.0, 30.0, 1.0, 3.0, 47.0, 40.0, 80.0, 178.0, 8.0, 202.0, 60.0, 59.0, 90.0, 27.0, 60.0, 160.0, -2.0, 20.0, 50.0, 60.0, 60.0, 50.0, 50.0, 20.0, 42.0, 120.0, 60.0, 100.0, 210.0, 63.0, 56.0, 40.0, 50.0, 41.0, 110.0, 44.0, 299.0, 180.0, 20.0, 158.0, 25.0, 20.0, 50.0, 30.0, 50.0, 59.0, 110.0, 31.0, 35.0, 100.0, 50.0, 80.0, 11.0, 60.0, 140.0, 149.0, -20.0, 80.0, 70.0, 26.0, 36.0, 70.0, 39.0, 48.0, 70.0, -43.0, 70.0, 30.0, 70.0, 34.0, 258.0, 35.0, -10.0, 28.0, 70.0, 45.0, 168.0, 60.0, 7.0, 30.0, 169.0, 90.0, 39.0, 40.0, 20.0, 50.0, 39.0, 70.0, -14.0, 55.0, -35.0, 80.0, 100.0, 50.0, -20.0, -23.0, 57.0, 95.0, 35.0, 58.0, 40.0, 110.0, 66.0, 80.0, 80.0, 110.0, 60.0, 90.0, 50.0, 40.0, 160.0, 50.0, 0.0, 70.0, 90.0, 20.0, 10.0, -53.0, 90.0, 15.0, 80.0, 60.0, 70.0, 50.0, -1.0, 33.0, 70.0, 110.0, 15.0, 57.0, 40.0, 70.0, 10.0, 50.0, 60.0, 10.0, 45.0, 50.0, 110.0, 66.0, 100.0, 20.0, 40.0, 150.0, 70.0, 70.0, 10.0, 30.0, 28.0, 33.0, 23.0, 30.0, 130.0, 40.0, -22.0, 46.0, 20.0, 50.0, 40.0, 50.0, 30.0, 60.0, 160.0, 90.0, 120.0, 40.0, 50.0, 65.0, 180.0, -10.0, 150.0, 60.0, 43.0, 248.0, 20.0, 88.0, 30.0, 50.0, 30.0, 59.0, 70.0, 10.0, 60.0, 40.0, -40.0, 210.0, 210.0, 50.0, 8.0, 50.0, 60.0, 170.0, 55.0, 31.0, 20.0, 20.0, 60.0, 25.0, 50.0, 30.0, 30.0, 60.0, 13.0, 70.0, 47.0, 42.0, 130.0, 430.0, 26.0, 100.0, 80.0, 100.0, 50.0, 239.0, 43.0, 57.0, 43.0, 70.0, 49.0, 36.0, 90.0, 39.0, 80.0, 17.0, 17.0, 150.0, 90.0, -4.0, 280.0, 70.0, 25.0, 30.0, 100.0, 18.0, 20.0, 60.0, -30.0, 80.0, 46.0, 99.0, 180.0, 172.0, 60.0, 130.0, 50.0, -10.0, 80.0, 60.0, 60.0, 87.0, 70.0, 50.0, 43.0, 73.0, 30.0, 40.0, 28.0, 30.0, 20.0, 110.0, 50.0, 50.0, -11.0, 55.0, 60.0, 230.0, 70.0, 66.0, -40.0, 48.0, 60.0, 40.0, 110.0, 110.0, 130.0, 30.0, 70.0, 197.0, 112.0, 70.0, 20.0, 35.0, 91.0, 299.0, 20.0, 170.0, 110.0, 550.0, 80.0, 100.0, 55.0, 220.0, 120.0, 20.0, 100.0, 55.0, 90.0, 59.0, 108.0, 43.0, 90.0, 65.0, 130.0, 42.0, -46.0, 180.0, 130.0, 39.0, 60.0, 148.0, 70.0, 12.0, 110.0, 30.0, 60.0, 40.0, 50.0, 90.0, 270.0, 90.0, 60.0, -110.0, 310.0, 130.0, 30.0, 120.0, 80.0, 70.0, 60.0, 60.0, 70.0, 28.0, 10.0, -3.0, 130.0, 150.0, 100.0, 100.0, 100.0, 150.0, 77.0, 60.0, 30.0, 60.0, 34.0, 10.0, 100.0, -5.0, 40.0, 30.0, 70.0, 6.0, 0.0, 20.0, 0.0, 37.0, 170.0, 50.0, 100.0, 31.0, 50.0, 29.0, 50.0, 34.0, 0.0, 85.0, 60.0, 144.0, 30.0, 37.0, 89.0, 70.0, 30.0, 20.0, 30.0, -51.0, 91.0, 86.0, 310.0, 120.0, 31.0, 208.0, 180.0, -6.0, 40.0, 90.0, 245.0, 80.0, 54.0, 78.0, 90.0, 30.0, 73.0, 20.0, 27.0, 9.0, -1.0, 40.0, 80.0, 28.0, 60.0, 4.0, 29.0, 70.0, 50.0, 30.0, 43.0, 50.0, 70.0, 100.0, 86.0, 60.0, 150.0, 60.0, 40.0, 58.0, 40.0, 30.0, 56.0, 14.0, 28.0, -16.0, 45.0, 250.0, 50.0, 43.0, 100.0, 130.0, 45.0, -53.0, 10.0, 160.0, 159.0, -162.0, 39.0, 50.0, 60.0, 70.0, 3.0, 320.0, 26.0, 20.0, 80.0, 50.0, 100.0, 67.0, -20.0, 147.0, 10.0, 60.0, -65.0, 189.0, 170.0, 70.0, 106.0, 320.0, 40.0, 301.0, 60.0, 35.0, 6.0, -2.0, 40.0, -40.0, 50.0, 200.0, 150.0, 57.0, 230.0, 40.0, 17.0, 55.0, 47.0, 65.0, 49.0, -53.0, 78.0, 88.0, 27.0, 130.0, 61.0, 120.0, 130.0, 208.0, 120.0, -23.0, 50.0, 90.0, 250.0, -6.0, 25.0, 50.0, -24.0, 7.0, -13.0, 50.0, 110.0, -15.0, 70.0, 60.0, 50.0, 110.0, 200.0, 70.0, 166.0, 38.0, 38.0, 40.0, 28.0, 78.0, -3.0, 30.0, -114.0, 254.0, 10.0, 30.0, 70.0, 69.0, 0.0, 20.0, 20.0, 20.0, 39.0, 30.0, 40.0, 10.0, -25.0, 50.0, 5.0, 60.0, -14.0, 150.0, 48.0, 88.0, 40.0, 69.0, -38.0, 330.0, 50.0, 90.0, 160.0, -20.0, 80.0, 55.0, -9.0, -5.0, -13.0, 17.0, 98.0, 30.0, 119.0, 30.0, 10.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1696178008783136, "mean_inference_ms": 2.4996129778752003, "mean_action_processing_ms": 0.8216639324026533, "mean_env_wait_ms": 1.7391953224777108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07225990295410156, "StateBufferConnector_ms": 0.011661052703857422, "ViewRequirementAgentConnector_ms": 0.5443058013916016}, "num_episodes": 18, "episode_return_max": 1445.0, "episode_return_min": 203.0, "episode_return_mean": 629.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.508907184437994, "num_env_steps_trained_throughput_per_sec": 32.508907184437994, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 2200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2200000, "timers": {"training_iteration_time_ms": 121345.831, "restore_workers_time_ms": 0.013, "training_step_time_ms": 121345.777, "sample_time_ms": 3214.782, "learn_time_ms": 118106.273, "learn_throughput": 33.868, "synch_weights_time_ms": 12.53}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "done": false, "training_iteration": 55, "trial_id": "6085c_00000", "date": "2024-07-02_00-49-46", "timestamp": 1719895786, "time_this_iter_s": 123.05704712867737, "time_total_s": 8633.479239702225, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138ad0a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8633.479239702225, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 23.909770114942535, "ram_util_percent": 78.83448275862068}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.071991517152776, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.674117263107381, "policy_loss": -0.0053019254679391925, "vf_loss": 6.678291939419553, "vf_explained_var": 0.0014104575204392212, "kl": 0.011272529732913705, "entropy": 1.2810420557967643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 521145.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 1445.0, "episode_reward_min": 247.0, "episode_reward_mean": 637.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -162.0}, "policy_reward_max": {"policy_0": 607.0}, "policy_reward_mean": {"policy_0": 63.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [778.0, 766.0, 482.0, 482.0, 543.0, 892.0, 550.0, 336.0, 504.0, 1145.0, 344.0, 956.0, 656.0, 309.0, 659.0, 320.0, 644.0, 596.0, 663.0, 400.0, 804.0, 737.0, 738.0, 484.0, 1079.0, 671.0, 316.0, 791.0, 528.0, 782.0, 936.0, 586.0, 638.0, 542.0, 718.0, 415.0, 498.0, 710.0, 432.0, 454.0, 651.0, 464.0, 524.0, 946.0, 457.0, 804.0, 378.0, 1244.0, 524.0, 776.0, 817.0, 563.0, 402.0, 754.0, 1054.0, 1445.0, 782.0, 733.0, 990.0, 525.0, 957.0, 305.0, 551.0, 565.0, 999.0, 800.0, 346.0, 699.0, 545.0, 482.0, 718.0, 728.0, 866.0, 911.0, 838.0, 539.0, 692.0, 555.0, 308.0, 412.0, 816.0, 283.0, 247.0, 429.0, 596.0, 561.0, 539.0, 689.0, 360.0, 353.0, 325.0, 832.0, 731.0, 1006.0, 628.0, 505.0, 800.0, 570.0, 395.0, 582.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 90.0, 39.0, 50.0, 40.0, 340.0, 50.0, 50.0, 60.0, 19.0, 7.0, 80.0, 147.0, 62.0, 80.0, 50.0, 70.0, 170.0, 47.0, 53.0, 48.0, 80.0, 50.0, 48.0, 110.0, 50.0, -132.0, 80.0, 68.0, 80.0, 68.0, 70.0, -42.0, 2.0, 55.0, 120.0, 100.0, 40.0, 50.0, 19.0, 180.0, 19.0, 8.0, 38.0, 180.0, -5.0, 160.0, -86.0, 60.0, -11.0, 160.0, 95.0, 38.0, 65.0, 70.0, 157.0, 63.0, 76.0, 100.0, 68.0, 10.0, 30.0, 34.0, 100.0, 50.0, 90.0, 13.0, 41.0, 27.0, 155.0, 38.0, 29.0, 43.0, 86.0, 19.0, 32.0, 9.0, 50.0, -6.0, 36.0, 42.0, 60.0, -45.0, 38.0, 58.0, 6.0, 170.0, 60.0, 162.0, -47.0, -15.0, 45.0, 70.0, 53.0, 15.0, 48.0, 320.0, 76.0, 100.0, 433.0, -1.0, -13.0, 70.0, 27.0, 10.0, 60.0, -3.0, 27.0, 52.0, 115.0, 10.0, 19.0, 607.0, 120.0, 50.0, 70.0, 90.0, 10.0, -30.0, 10.0, 60.0, 120.0, 80.0, -16.0, 60.0, 153.0, 59.0, 60.0, 31.0, 49.0, 8.0, 41.0, 120.0, 40.0, 24.0, 38.0, 36.0, 22.0, -30.0, 10.0, 10.0, 50.0, 40.0, 60.0, 80.0, 40.0, 49.0, 80.0, 230.0, 20.0, 100.0, 0.0, 47.0, 14.0, 60.0, 10.0, 18.0, 58.0, 0.0, 13.0, -6.0, 160.0, 90.0, 50.0, 70.0, 50.0, 80.0, 60.0, 30.0, 60.0, 20.0, 360.0, 0.0, 50.0, 37.0, 30.0, 40.0, -31.0, 0.0, 90.0, 69.0, 54.0, 30.0, 153.0, 9.0, 90.0, 30.0, 161.0, 17.0, 50.0, -1.0, -5.0, 120.0, 110.0, 30.0, 0.0, 60.0, 10.0, 47.0, 29.0, 50.0, 50.0, 120.0, 60.0, 100.0, 60.0, 60.0, 159.0, 60.0, 85.0, 60.0, 70.0, 130.0, -4.0, 209.0, 60.0, 50.0, 48.0, 74.0, 40.0, 190.0, 58.0, 74.0, -12.0, 120.0, 97.0, 80.0, 50.0, 40.0, 41.0, 31.0, 120.0, 26.0, 170.0, -4.0, 9.0, 90.0, 30.0, -4.0, 16.0, 40.0, 76.0, 174.0, 165.0, 169.0, 70.0, 67.0, 69.0, 169.0, 80.0, 43.0, 70.0, 80.0, 170.0, 70.0, 50.0, 70.0, -34.0, 60.0, 92.0, 50.0, 80.0, 49.0, 37.0, 6.0, 30.0, 30.0, 30.0, 1.0, 3.0, 47.0, 40.0, 80.0, 178.0, 8.0, 202.0, 60.0, 59.0, 90.0, 27.0, 60.0, 160.0, -2.0, 20.0, 50.0, 60.0, 60.0, 50.0, 50.0, 20.0, 42.0, 120.0, 60.0, 100.0, 210.0, 63.0, 56.0, 40.0, 50.0, 41.0, 110.0, 44.0, 299.0, 180.0, 20.0, 158.0, 25.0, 20.0, 50.0, 30.0, 50.0, 59.0, 110.0, 31.0, 35.0, 100.0, 50.0, 80.0, 11.0, 60.0, 140.0, 149.0, -20.0, 80.0, 70.0, 26.0, 36.0, 70.0, 39.0, 48.0, 70.0, -43.0, 70.0, 30.0, 70.0, 34.0, 258.0, 35.0, -10.0, 28.0, 70.0, 45.0, 168.0, 60.0, 7.0, 30.0, 169.0, 90.0, 39.0, 40.0, 20.0, 50.0, 39.0, 70.0, -14.0, 55.0, -35.0, 80.0, 100.0, 50.0, -20.0, -23.0, 57.0, 95.0, 35.0, 58.0, 40.0, 110.0, 66.0, 80.0, 80.0, 110.0, 60.0, 90.0, 50.0, 40.0, 160.0, 50.0, 0.0, 70.0, 90.0, 20.0, 10.0, -53.0, 90.0, 15.0, 80.0, 60.0, 70.0, 50.0, -1.0, 33.0, 70.0, 110.0, 15.0, 57.0, 40.0, 70.0, 10.0, 50.0, 60.0, 10.0, 45.0, 50.0, 110.0, 66.0, 100.0, 20.0, 40.0, 150.0, 70.0, 70.0, 10.0, 30.0, 28.0, 33.0, 23.0, 30.0, 130.0, 40.0, -22.0, 46.0, 20.0, 50.0, 40.0, 50.0, 30.0, 60.0, 160.0, 90.0, 120.0, 40.0, 50.0, 65.0, 180.0, -10.0, 150.0, 60.0, 43.0, 248.0, 20.0, 88.0, 30.0, 50.0, 30.0, 59.0, 70.0, 10.0, 60.0, 40.0, -40.0, 210.0, 210.0, 50.0, 8.0, 50.0, 60.0, 170.0, 55.0, 31.0, 20.0, 20.0, 60.0, 25.0, 50.0, 30.0, 30.0, 60.0, 13.0, 70.0, 47.0, 42.0, 130.0, 430.0, 26.0, 100.0, 80.0, 100.0, 50.0, 239.0, 43.0, 57.0, 43.0, 70.0, 49.0, 36.0, 90.0, 39.0, 80.0, 17.0, 17.0, 150.0, 90.0, -4.0, 280.0, 70.0, 25.0, 30.0, 100.0, 18.0, 20.0, 60.0, -30.0, 80.0, 46.0, 99.0, 180.0, 172.0, 60.0, 130.0, 50.0, -10.0, 80.0, 60.0, 60.0, 87.0, 70.0, 50.0, 43.0, 73.0, 30.0, 40.0, 28.0, 30.0, 20.0, 110.0, 50.0, 50.0, -11.0, 55.0, 60.0, 230.0, 70.0, 66.0, -40.0, 48.0, 60.0, 40.0, 110.0, 110.0, 130.0, 30.0, 70.0, 197.0, 112.0, 70.0, 20.0, 35.0, 91.0, 299.0, 20.0, 170.0, 110.0, 550.0, 80.0, 100.0, 55.0, 220.0, 120.0, 20.0, 100.0, 55.0, 90.0, 59.0, 108.0, 43.0, 90.0, 65.0, 130.0, 42.0, -46.0, 180.0, 130.0, 39.0, 60.0, 148.0, 70.0, 12.0, 110.0, 30.0, 60.0, 40.0, 50.0, 90.0, 270.0, 90.0, 60.0, -110.0, 310.0, 130.0, 30.0, 120.0, 80.0, 70.0, 60.0, 60.0, 70.0, 28.0, 10.0, -3.0, 130.0, 150.0, 100.0, 100.0, 100.0, 150.0, 77.0, 60.0, 30.0, 60.0, 34.0, 10.0, 100.0, -5.0, 40.0, 30.0, 70.0, 6.0, 0.0, 20.0, 0.0, 37.0, 170.0, 50.0, 100.0, 31.0, 50.0, 29.0, 50.0, 34.0, 0.0, 85.0, 60.0, 144.0, 30.0, 37.0, 89.0, 70.0, 30.0, 20.0, 30.0, -51.0, 91.0, 86.0, 310.0, 120.0, 31.0, 208.0, 180.0, -6.0, 40.0, 90.0, 245.0, 80.0, 54.0, 78.0, 90.0, 30.0, 73.0, 20.0, 27.0, 9.0, -1.0, 40.0, 80.0, 28.0, 60.0, 4.0, 29.0, 70.0, 50.0, 30.0, 43.0, 50.0, 70.0, 100.0, 86.0, 60.0, 150.0, 60.0, 40.0, 58.0, 40.0, 30.0, 56.0, 14.0, 28.0, -16.0, 45.0, 250.0, 50.0, 43.0, 100.0, 130.0, 45.0, -53.0, 10.0, 160.0, 159.0, -162.0, 39.0, 50.0, 60.0, 70.0, 3.0, 320.0, 26.0, 20.0, 80.0, 50.0, 100.0, 67.0, -20.0, 147.0, 10.0, 60.0, -65.0, 189.0, 170.0, 70.0, 106.0, 320.0, 40.0, 301.0, 60.0, 35.0, 6.0, -2.0, 40.0, -40.0, 50.0, 200.0, 150.0, 57.0, 230.0, 40.0, 17.0, 55.0, 47.0, 65.0, 49.0, -53.0, 78.0, 88.0, 27.0, 130.0, 61.0, 120.0, 130.0, 208.0, 120.0, -23.0, 50.0, 90.0, 250.0, -6.0, 25.0, 50.0, -24.0, 7.0, -13.0, 50.0, 110.0, -15.0, 70.0, 60.0, 50.0, 110.0, 200.0, 70.0, 166.0, 38.0, 38.0, 40.0, 28.0, 78.0, -3.0, 30.0, -114.0, 254.0, 10.0, 30.0, 70.0, 69.0, 0.0, 20.0, 20.0, 20.0, 39.0, 30.0, 40.0, 10.0, -25.0, 50.0, 5.0, 60.0, -14.0, 150.0, 48.0, 88.0, 40.0, 69.0, -38.0, 330.0, 50.0, 90.0, 160.0, -20.0, 80.0, 55.0, -9.0, -5.0, -13.0, 17.0, 98.0, 30.0, 119.0, 30.0, 10.0, 6.0, 11.0, 40.0, 30.0, -27.0, 20.0, 170.0, 30.0, 18.0, 10.0, -55.0, 50.0, 0.0, -10.0, 110.0, 60.0, 20.0, 40.0, 60.0, 40.0, 59.0, -10.0, 10.0, -26.0, 50.0, 170.0, 83.0, 76.0, 60.0, 30.0, 153.0, 80.0, 19.0, 58.0, 60.0, 61.0, 57.0, 41.0, 50.0, 85.0, 50.0, 10.0, 67.0, 11.0, 3.0, -40.0, 50.0, 69.0, 20.0, 59.0, 290.0, 90.0, 90.0, -33.0, 60.0, 22.0, 4.0, 210.0, 35.0, 70.0, 141.0, 70.0, 36.0, 70.0, 70.0, -80.0, 0.0, 50.0, 18.0, 50.0, 76.0, 3.0, 115.0, 60.0, 130.0, -61.0, 68.0, 4.0, -18.0, 90.0, -38.0, 20.0, -6.0, 60.0, -52.0, 50.0, 70.0, 41.0, 30.0, 120.0, -8.0, 120.0, 306.0, 50.0, 90.0, 44.0, 36.0, 50.0, 40.0, 3.0, 93.0, -3.0, 310.0, 80.0, 89.0, 41.0, 14.0, 50.0, 20.0, 100.0, 30.0, 100.0, 160.0, 29.0, 168.0, 0.0, 120.0, 40.0, 99.0, 200.0, 90.0, 270.0, 25.0, -2.0, 50.0, 20.0, 130.0, -5.0, 50.0, 47.0, 43.0, 40.0, 30.0, 40.0, 40.0, 9.0, 169.0, 0.0, 30.0, -19.0, 166.0, 40.0, 120.0, 70.0, 229.0, 20.0, -53.0, 154.0, 80.0, 50.0, 90.0, 195.0, 0.0, 0.0, 20.0, 10.0, 80.0, 167.0, 29.0, 49.0, 20.0, 7.0, 50.0, -18.0, 31.0, 12.0, 190.0, 13.0, 16.0, 90.0, 4.0, 67.0, 70.0, 11.0, 40.0, 90.0, 1.0, 80.0, 57.0, 160.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.163643677160517, "mean_inference_ms": 2.4923532728451447, "mean_action_processing_ms": 0.8227816243195687, "mean_env_wait_ms": 1.7344879936830881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0693976879119873, "StateBufferConnector_ms": 0.011538982391357422, "ViewRequirementAgentConnector_ms": 0.5465047359466553}, "num_episodes": 18, "episode_return_max": 1445.0, "episode_return_min": 247.0, "episode_return_mean": 637.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.42366341758634, "num_env_steps_trained_throughput_per_sec": 32.42366341758634, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 121528.702, "restore_workers_time_ms": 0.013, "training_step_time_ms": 121528.648, "sample_time_ms": 3314.034, "learn_time_ms": 118189.927, "learn_throughput": 33.844, "synch_weights_time_ms": 13.347}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 56, "trial_id": "6085c_00000", "date": "2024-07-02_00-51-49", "timestamp": 1719895909, "time_this_iter_s": 123.37866401672363, "time_total_s": 8756.857903718948, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a88d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8756.857903718948, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 20.66264367816092, "ram_util_percent": 78.99885057471263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8123204975780713, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.295780502975432, "policy_loss": -0.005428518032872329, "vf_loss": 7.30008252157063, "vf_explained_var": 0.0020943699870754483, "kl": 0.011265051962358053, "entropy": 1.2660364778785786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 530535.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 1445.0, "episode_reward_min": 247.0, "episode_reward_mean": 648.77, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -162.0}, "policy_reward_max": {"policy_0": 688.0}, "policy_reward_mean": {"policy_0": 64.877}, "custom_metrics": {}, "hist_stats": {"episode_reward": [738.0, 484.0, 1079.0, 671.0, 316.0, 791.0, 528.0, 782.0, 936.0, 586.0, 638.0, 542.0, 718.0, 415.0, 498.0, 710.0, 432.0, 454.0, 651.0, 464.0, 524.0, 946.0, 457.0, 804.0, 378.0, 1244.0, 524.0, 776.0, 817.0, 563.0, 402.0, 754.0, 1054.0, 1445.0, 782.0, 733.0, 990.0, 525.0, 957.0, 305.0, 551.0, 565.0, 999.0, 800.0, 346.0, 699.0, 545.0, 482.0, 718.0, 728.0, 866.0, 911.0, 838.0, 539.0, 692.0, 555.0, 308.0, 412.0, 816.0, 283.0, 247.0, 429.0, 596.0, 561.0, 539.0, 689.0, 360.0, 353.0, 325.0, 832.0, 731.0, 1006.0, 628.0, 505.0, 800.0, 570.0, 395.0, 582.0, 791.0, 792.0, 750.0, 767.0, 912.0, 618.0, 410.0, 593.0, 518.0, 881.0, 590.0, 845.0, 533.0, 488.0, 403.0, 464.0, 909.0, 615.0, 694.0, 726.0, 735.0, 629.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 58.0, 74.0, -12.0, 120.0, 97.0, 80.0, 50.0, 40.0, 41.0, 31.0, 120.0, 26.0, 170.0, -4.0, 9.0, 90.0, 30.0, -4.0, 16.0, 40.0, 76.0, 174.0, 165.0, 169.0, 70.0, 67.0, 69.0, 169.0, 80.0, 43.0, 70.0, 80.0, 170.0, 70.0, 50.0, 70.0, -34.0, 60.0, 92.0, 50.0, 80.0, 49.0, 37.0, 6.0, 30.0, 30.0, 30.0, 1.0, 3.0, 47.0, 40.0, 80.0, 178.0, 8.0, 202.0, 60.0, 59.0, 90.0, 27.0, 60.0, 160.0, -2.0, 20.0, 50.0, 60.0, 60.0, 50.0, 50.0, 20.0, 42.0, 120.0, 60.0, 100.0, 210.0, 63.0, 56.0, 40.0, 50.0, 41.0, 110.0, 44.0, 299.0, 180.0, 20.0, 158.0, 25.0, 20.0, 50.0, 30.0, 50.0, 59.0, 110.0, 31.0, 35.0, 100.0, 50.0, 80.0, 11.0, 60.0, 140.0, 149.0, -20.0, 80.0, 70.0, 26.0, 36.0, 70.0, 39.0, 48.0, 70.0, -43.0, 70.0, 30.0, 70.0, 34.0, 258.0, 35.0, -10.0, 28.0, 70.0, 45.0, 168.0, 60.0, 7.0, 30.0, 169.0, 90.0, 39.0, 40.0, 20.0, 50.0, 39.0, 70.0, -14.0, 55.0, -35.0, 80.0, 100.0, 50.0, -20.0, -23.0, 57.0, 95.0, 35.0, 58.0, 40.0, 110.0, 66.0, 80.0, 80.0, 110.0, 60.0, 90.0, 50.0, 40.0, 160.0, 50.0, 0.0, 70.0, 90.0, 20.0, 10.0, -53.0, 90.0, 15.0, 80.0, 60.0, 70.0, 50.0, -1.0, 33.0, 70.0, 110.0, 15.0, 57.0, 40.0, 70.0, 10.0, 50.0, 60.0, 10.0, 45.0, 50.0, 110.0, 66.0, 100.0, 20.0, 40.0, 150.0, 70.0, 70.0, 10.0, 30.0, 28.0, 33.0, 23.0, 30.0, 130.0, 40.0, -22.0, 46.0, 20.0, 50.0, 40.0, 50.0, 30.0, 60.0, 160.0, 90.0, 120.0, 40.0, 50.0, 65.0, 180.0, -10.0, 150.0, 60.0, 43.0, 248.0, 20.0, 88.0, 30.0, 50.0, 30.0, 59.0, 70.0, 10.0, 60.0, 40.0, -40.0, 210.0, 210.0, 50.0, 8.0, 50.0, 60.0, 170.0, 55.0, 31.0, 20.0, 20.0, 60.0, 25.0, 50.0, 30.0, 30.0, 60.0, 13.0, 70.0, 47.0, 42.0, 130.0, 430.0, 26.0, 100.0, 80.0, 100.0, 50.0, 239.0, 43.0, 57.0, 43.0, 70.0, 49.0, 36.0, 90.0, 39.0, 80.0, 17.0, 17.0, 150.0, 90.0, -4.0, 280.0, 70.0, 25.0, 30.0, 100.0, 18.0, 20.0, 60.0, -30.0, 80.0, 46.0, 99.0, 180.0, 172.0, 60.0, 130.0, 50.0, -10.0, 80.0, 60.0, 60.0, 87.0, 70.0, 50.0, 43.0, 73.0, 30.0, 40.0, 28.0, 30.0, 20.0, 110.0, 50.0, 50.0, -11.0, 55.0, 60.0, 230.0, 70.0, 66.0, -40.0, 48.0, 60.0, 40.0, 110.0, 110.0, 130.0, 30.0, 70.0, 197.0, 112.0, 70.0, 20.0, 35.0, 91.0, 299.0, 20.0, 170.0, 110.0, 550.0, 80.0, 100.0, 55.0, 220.0, 120.0, 20.0, 100.0, 55.0, 90.0, 59.0, 108.0, 43.0, 90.0, 65.0, 130.0, 42.0, -46.0, 180.0, 130.0, 39.0, 60.0, 148.0, 70.0, 12.0, 110.0, 30.0, 60.0, 40.0, 50.0, 90.0, 270.0, 90.0, 60.0, -110.0, 310.0, 130.0, 30.0, 120.0, 80.0, 70.0, 60.0, 60.0, 70.0, 28.0, 10.0, -3.0, 130.0, 150.0, 100.0, 100.0, 100.0, 150.0, 77.0, 60.0, 30.0, 60.0, 34.0, 10.0, 100.0, -5.0, 40.0, 30.0, 70.0, 6.0, 0.0, 20.0, 0.0, 37.0, 170.0, 50.0, 100.0, 31.0, 50.0, 29.0, 50.0, 34.0, 0.0, 85.0, 60.0, 144.0, 30.0, 37.0, 89.0, 70.0, 30.0, 20.0, 30.0, -51.0, 91.0, 86.0, 310.0, 120.0, 31.0, 208.0, 180.0, -6.0, 40.0, 90.0, 245.0, 80.0, 54.0, 78.0, 90.0, 30.0, 73.0, 20.0, 27.0, 9.0, -1.0, 40.0, 80.0, 28.0, 60.0, 4.0, 29.0, 70.0, 50.0, 30.0, 43.0, 50.0, 70.0, 100.0, 86.0, 60.0, 150.0, 60.0, 40.0, 58.0, 40.0, 30.0, 56.0, 14.0, 28.0, -16.0, 45.0, 250.0, 50.0, 43.0, 100.0, 130.0, 45.0, -53.0, 10.0, 160.0, 159.0, -162.0, 39.0, 50.0, 60.0, 70.0, 3.0, 320.0, 26.0, 20.0, 80.0, 50.0, 100.0, 67.0, -20.0, 147.0, 10.0, 60.0, -65.0, 189.0, 170.0, 70.0, 106.0, 320.0, 40.0, 301.0, 60.0, 35.0, 6.0, -2.0, 40.0, -40.0, 50.0, 200.0, 150.0, 57.0, 230.0, 40.0, 17.0, 55.0, 47.0, 65.0, 49.0, -53.0, 78.0, 88.0, 27.0, 130.0, 61.0, 120.0, 130.0, 208.0, 120.0, -23.0, 50.0, 90.0, 250.0, -6.0, 25.0, 50.0, -24.0, 7.0, -13.0, 50.0, 110.0, -15.0, 70.0, 60.0, 50.0, 110.0, 200.0, 70.0, 166.0, 38.0, 38.0, 40.0, 28.0, 78.0, -3.0, 30.0, -114.0, 254.0, 10.0, 30.0, 70.0, 69.0, 0.0, 20.0, 20.0, 20.0, 39.0, 30.0, 40.0, 10.0, -25.0, 50.0, 5.0, 60.0, -14.0, 150.0, 48.0, 88.0, 40.0, 69.0, -38.0, 330.0, 50.0, 90.0, 160.0, -20.0, 80.0, 55.0, -9.0, -5.0, -13.0, 17.0, 98.0, 30.0, 119.0, 30.0, 10.0, 6.0, 11.0, 40.0, 30.0, -27.0, 20.0, 170.0, 30.0, 18.0, 10.0, -55.0, 50.0, 0.0, -10.0, 110.0, 60.0, 20.0, 40.0, 60.0, 40.0, 59.0, -10.0, 10.0, -26.0, 50.0, 170.0, 83.0, 76.0, 60.0, 30.0, 153.0, 80.0, 19.0, 58.0, 60.0, 61.0, 57.0, 41.0, 50.0, 85.0, 50.0, 10.0, 67.0, 11.0, 3.0, -40.0, 50.0, 69.0, 20.0, 59.0, 290.0, 90.0, 90.0, -33.0, 60.0, 22.0, 4.0, 210.0, 35.0, 70.0, 141.0, 70.0, 36.0, 70.0, 70.0, -80.0, 0.0, 50.0, 18.0, 50.0, 76.0, 3.0, 115.0, 60.0, 130.0, -61.0, 68.0, 4.0, -18.0, 90.0, -38.0, 20.0, -6.0, 60.0, -52.0, 50.0, 70.0, 41.0, 30.0, 120.0, -8.0, 120.0, 306.0, 50.0, 90.0, 44.0, 36.0, 50.0, 40.0, 3.0, 93.0, -3.0, 310.0, 80.0, 89.0, 41.0, 14.0, 50.0, 20.0, 100.0, 30.0, 100.0, 160.0, 29.0, 168.0, 0.0, 120.0, 40.0, 99.0, 200.0, 90.0, 270.0, 25.0, -2.0, 50.0, 20.0, 130.0, -5.0, 50.0, 47.0, 43.0, 40.0, 30.0, 40.0, 40.0, 9.0, 169.0, 0.0, 30.0, -19.0, 166.0, 40.0, 120.0, 70.0, 229.0, 20.0, -53.0, 154.0, 80.0, 50.0, 90.0, 195.0, 0.0, 0.0, 20.0, 10.0, 80.0, 167.0, 29.0, 49.0, 20.0, 7.0, 50.0, -18.0, 31.0, 12.0, 190.0, 13.0, 16.0, 90.0, 4.0, 67.0, 70.0, 11.0, 40.0, 90.0, 1.0, 80.0, 57.0, 160.0, 6.0, 30.0, 59.0, 43.0, 70.0, 60.0, 79.0, 90.0, 265.0, 35.0, 60.0, 260.0, 110.0, 80.0, 50.0, -74.0, 60.0, 100.0, 156.0, 70.0, -20.0, 3.0, 159.0, 14.0, 60.0, 19.0, -10.0, 115.0, 20.0, 100.0, 270.0, 78.0, 30.0, 80.0, 269.0, -20.0, 70.0, 70.0, 90.0, 80.0, 20.0, 58.0, 47.0, 40.0, 46.0, 120.0, 177.0, 180.0, 75.0, 29.0, 140.0, 56.0, 40.0, 105.0, -35.0, 100.0, 241.0, 29.0, 25.0, 20.0, 37.0, 190.0, 33.0, 45.0, 22.0, 50.0, 10.0, 90.0, 30.0, -160.0, 100.0, 10.0, 110.0, 28.0, 80.0, 40.0, 213.0, 0.0, 33.0, -1.0, 80.0, 20.0, -9.0, 50.0, 60.0, 180.0, 37.0, 40.0, 90.0, 20.0, 30.0, -22.0, 150.0, -125.0, 90.0, 688.0, -12.0, 0.0, -38.0, 30.0, 120.0, 60.0, 54.0, 27.0, 20.0, 159.0, -32.0, 160.0, 11.0, 40.0, 91.0, 40.0, 20.0, 480.0, 78.0, 70.0, 56.0, -55.0, 30.0, 21.0, 105.0, 15.0, 39.0, 80.0, 30.0, 48.0, 40.0, 230.0, -4.0, 30.0, 25.0, 90.0, 40.0, 30.0, 40.0, 80.0, 27.0, 68.0, 3.0, 60.0, 50.0, 168.0, 20.0, 137.0, 8.0, -5.0, -4.0, 20.0, 30.0, 10.0, 19.0, 0.0, 170.0, 60.0, 70.0, 80.0, 20.0, 19.0, 20.0, 30.0, -5.0, 40.0, 170.0, 160.0, 69.0, 110.0, 160.0, 80.0, 10.0, 33.0, 77.0, 19.0, 36.0, 9.0, 29.0, 30.0, 110.0, 42.0, 70.0, 60.0, 210.0, 245.0, 40.0, 20.0, 120.0, 10.0, 24.0, 30.0, 110.0, -5.0, 100.0, -137.0, 250.0, 70.0, 25.0, 180.0, 57.0, 205.0, -60.0, 70.0, 66.0, 100.0, 33.0, 145.0, 9.0, 50.0, 49.0, 26.0, 230.0, 64.0, 29.0, 90.0, 130.0, 40.0, 73.0, 28.0, 78.0, -27.0, 120.0, 30.0, 67.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1555185372643404, "mean_inference_ms": 2.483231975790478, "mean_action_processing_ms": 0.8241394151722494, "mean_env_wait_ms": 1.728283442194887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06894993782043457, "StateBufferConnector_ms": 0.010419368743896484, "ViewRequirementAgentConnector_ms": 0.5341296195983887}, "num_episodes": 22, "episode_return_max": 1445.0, "episode_return_min": 247.0, "episode_return_mean": 648.77, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.73457697395406, "num_env_steps_trained_throughput_per_sec": 32.73457697395406, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 121506.864, "restore_workers_time_ms": 0.013, "training_step_time_ms": 121506.81, "sample_time_ms": 3292.069, "learn_time_ms": 118190.515, "learn_throughput": 33.844, "synch_weights_time_ms": 12.895}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 57, "trial_id": "6085c_00000", "date": "2024-07-02_00-53-52", "timestamp": 1719896032, "time_this_iter_s": 122.20710182189941, "time_total_s": 8879.065005540848, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8879.065005540848, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 20.330057803468208, "ram_util_percent": 79.10289017341042}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.910561911582439, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.588316008128043, "policy_loss": -0.0066981243142457455, "vf_loss": 7.593805360083128, "vf_explained_var": -0.0017759123168433436, "kl": 0.012087678395319495, "entropy": 1.2149012211285715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 539925.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 1445.0, "episode_reward_min": -234.0, "episode_reward_mean": 680.46, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -741.0}, "policy_reward_max": {"policy_0": 688.0}, "policy_reward_mean": {"policy_0": 68.046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [804.0, 378.0, 1244.0, 524.0, 776.0, 817.0, 563.0, 402.0, 754.0, 1054.0, 1445.0, 782.0, 733.0, 990.0, 525.0, 957.0, 305.0, 551.0, 565.0, 999.0, 800.0, 346.0, 699.0, 545.0, 482.0, 718.0, 728.0, 866.0, 911.0, 838.0, 539.0, 692.0, 555.0, 308.0, 412.0, 816.0, 283.0, 247.0, 429.0, 596.0, 561.0, 539.0, 689.0, 360.0, 353.0, 325.0, 832.0, 731.0, 1006.0, 628.0, 505.0, 800.0, 570.0, 395.0, 582.0, 791.0, 792.0, 750.0, 767.0, 912.0, 618.0, 410.0, 593.0, 518.0, 881.0, 590.0, 845.0, 533.0, 488.0, 403.0, 464.0, 909.0, 615.0, 694.0, 726.0, 735.0, 629.0, 829.0, -234.0, 426.0, 805.0, 1221.0, 1352.0, 534.0, 847.0, 967.0, 697.0, 610.0, 973.0, 1041.0, 1105.0, 678.0, 595.0, 935.0, 776.0, 337.0, 1034.0, 723.0, 987.0, 291.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-40.0, 210.0, 210.0, 50.0, 8.0, 50.0, 60.0, 170.0, 55.0, 31.0, 20.0, 20.0, 60.0, 25.0, 50.0, 30.0, 30.0, 60.0, 13.0, 70.0, 47.0, 42.0, 130.0, 430.0, 26.0, 100.0, 80.0, 100.0, 50.0, 239.0, 43.0, 57.0, 43.0, 70.0, 49.0, 36.0, 90.0, 39.0, 80.0, 17.0, 17.0, 150.0, 90.0, -4.0, 280.0, 70.0, 25.0, 30.0, 100.0, 18.0, 20.0, 60.0, -30.0, 80.0, 46.0, 99.0, 180.0, 172.0, 60.0, 130.0, 50.0, -10.0, 80.0, 60.0, 60.0, 87.0, 70.0, 50.0, 43.0, 73.0, 30.0, 40.0, 28.0, 30.0, 20.0, 110.0, 50.0, 50.0, -11.0, 55.0, 60.0, 230.0, 70.0, 66.0, -40.0, 48.0, 60.0, 40.0, 110.0, 110.0, 130.0, 30.0, 70.0, 197.0, 112.0, 70.0, 20.0, 35.0, 91.0, 299.0, 20.0, 170.0, 110.0, 550.0, 80.0, 100.0, 55.0, 220.0, 120.0, 20.0, 100.0, 55.0, 90.0, 59.0, 108.0, 43.0, 90.0, 65.0, 130.0, 42.0, -46.0, 180.0, 130.0, 39.0, 60.0, 148.0, 70.0, 12.0, 110.0, 30.0, 60.0, 40.0, 50.0, 90.0, 270.0, 90.0, 60.0, -110.0, 310.0, 130.0, 30.0, 120.0, 80.0, 70.0, 60.0, 60.0, 70.0, 28.0, 10.0, -3.0, 130.0, 150.0, 100.0, 100.0, 100.0, 150.0, 77.0, 60.0, 30.0, 60.0, 34.0, 10.0, 100.0, -5.0, 40.0, 30.0, 70.0, 6.0, 0.0, 20.0, 0.0, 37.0, 170.0, 50.0, 100.0, 31.0, 50.0, 29.0, 50.0, 34.0, 0.0, 85.0, 60.0, 144.0, 30.0, 37.0, 89.0, 70.0, 30.0, 20.0, 30.0, -51.0, 91.0, 86.0, 310.0, 120.0, 31.0, 208.0, 180.0, -6.0, 40.0, 90.0, 245.0, 80.0, 54.0, 78.0, 90.0, 30.0, 73.0, 20.0, 27.0, 9.0, -1.0, 40.0, 80.0, 28.0, 60.0, 4.0, 29.0, 70.0, 50.0, 30.0, 43.0, 50.0, 70.0, 100.0, 86.0, 60.0, 150.0, 60.0, 40.0, 58.0, 40.0, 30.0, 56.0, 14.0, 28.0, -16.0, 45.0, 250.0, 50.0, 43.0, 100.0, 130.0, 45.0, -53.0, 10.0, 160.0, 159.0, -162.0, 39.0, 50.0, 60.0, 70.0, 3.0, 320.0, 26.0, 20.0, 80.0, 50.0, 100.0, 67.0, -20.0, 147.0, 10.0, 60.0, -65.0, 189.0, 170.0, 70.0, 106.0, 320.0, 40.0, 301.0, 60.0, 35.0, 6.0, -2.0, 40.0, -40.0, 50.0, 200.0, 150.0, 57.0, 230.0, 40.0, 17.0, 55.0, 47.0, 65.0, 49.0, -53.0, 78.0, 88.0, 27.0, 130.0, 61.0, 120.0, 130.0, 208.0, 120.0, -23.0, 50.0, 90.0, 250.0, -6.0, 25.0, 50.0, -24.0, 7.0, -13.0, 50.0, 110.0, -15.0, 70.0, 60.0, 50.0, 110.0, 200.0, 70.0, 166.0, 38.0, 38.0, 40.0, 28.0, 78.0, -3.0, 30.0, -114.0, 254.0, 10.0, 30.0, 70.0, 69.0, 0.0, 20.0, 20.0, 20.0, 39.0, 30.0, 40.0, 10.0, -25.0, 50.0, 5.0, 60.0, -14.0, 150.0, 48.0, 88.0, 40.0, 69.0, -38.0, 330.0, 50.0, 90.0, 160.0, -20.0, 80.0, 55.0, -9.0, -5.0, -13.0, 17.0, 98.0, 30.0, 119.0, 30.0, 10.0, 6.0, 11.0, 40.0, 30.0, -27.0, 20.0, 170.0, 30.0, 18.0, 10.0, -55.0, 50.0, 0.0, -10.0, 110.0, 60.0, 20.0, 40.0, 60.0, 40.0, 59.0, -10.0, 10.0, -26.0, 50.0, 170.0, 83.0, 76.0, 60.0, 30.0, 153.0, 80.0, 19.0, 58.0, 60.0, 61.0, 57.0, 41.0, 50.0, 85.0, 50.0, 10.0, 67.0, 11.0, 3.0, -40.0, 50.0, 69.0, 20.0, 59.0, 290.0, 90.0, 90.0, -33.0, 60.0, 22.0, 4.0, 210.0, 35.0, 70.0, 141.0, 70.0, 36.0, 70.0, 70.0, -80.0, 0.0, 50.0, 18.0, 50.0, 76.0, 3.0, 115.0, 60.0, 130.0, -61.0, 68.0, 4.0, -18.0, 90.0, -38.0, 20.0, -6.0, 60.0, -52.0, 50.0, 70.0, 41.0, 30.0, 120.0, -8.0, 120.0, 306.0, 50.0, 90.0, 44.0, 36.0, 50.0, 40.0, 3.0, 93.0, -3.0, 310.0, 80.0, 89.0, 41.0, 14.0, 50.0, 20.0, 100.0, 30.0, 100.0, 160.0, 29.0, 168.0, 0.0, 120.0, 40.0, 99.0, 200.0, 90.0, 270.0, 25.0, -2.0, 50.0, 20.0, 130.0, -5.0, 50.0, 47.0, 43.0, 40.0, 30.0, 40.0, 40.0, 9.0, 169.0, 0.0, 30.0, -19.0, 166.0, 40.0, 120.0, 70.0, 229.0, 20.0, -53.0, 154.0, 80.0, 50.0, 90.0, 195.0, 0.0, 0.0, 20.0, 10.0, 80.0, 167.0, 29.0, 49.0, 20.0, 7.0, 50.0, -18.0, 31.0, 12.0, 190.0, 13.0, 16.0, 90.0, 4.0, 67.0, 70.0, 11.0, 40.0, 90.0, 1.0, 80.0, 57.0, 160.0, 6.0, 30.0, 59.0, 43.0, 70.0, 60.0, 79.0, 90.0, 265.0, 35.0, 60.0, 260.0, 110.0, 80.0, 50.0, -74.0, 60.0, 100.0, 156.0, 70.0, -20.0, 3.0, 159.0, 14.0, 60.0, 19.0, -10.0, 115.0, 20.0, 100.0, 270.0, 78.0, 30.0, 80.0, 269.0, -20.0, 70.0, 70.0, 90.0, 80.0, 20.0, 58.0, 47.0, 40.0, 46.0, 120.0, 177.0, 180.0, 75.0, 29.0, 140.0, 56.0, 40.0, 105.0, -35.0, 100.0, 241.0, 29.0, 25.0, 20.0, 37.0, 190.0, 33.0, 45.0, 22.0, 50.0, 10.0, 90.0, 30.0, -160.0, 100.0, 10.0, 110.0, 28.0, 80.0, 40.0, 213.0, 0.0, 33.0, -1.0, 80.0, 20.0, -9.0, 50.0, 60.0, 180.0, 37.0, 40.0, 90.0, 20.0, 30.0, -22.0, 150.0, -125.0, 90.0, 688.0, -12.0, 0.0, -38.0, 30.0, 120.0, 60.0, 54.0, 27.0, 20.0, 159.0, -32.0, 160.0, 11.0, 40.0, 91.0, 40.0, 20.0, 480.0, 78.0, 70.0, 56.0, -55.0, 30.0, 21.0, 105.0, 15.0, 39.0, 80.0, 30.0, 48.0, 40.0, 230.0, -4.0, 30.0, 25.0, 90.0, 40.0, 30.0, 40.0, 80.0, 27.0, 68.0, 3.0, 60.0, 50.0, 168.0, 20.0, 137.0, 8.0, -5.0, -4.0, 20.0, 30.0, 10.0, 19.0, 0.0, 170.0, 60.0, 70.0, 80.0, 20.0, 19.0, 20.0, 30.0, -5.0, 40.0, 170.0, 160.0, 69.0, 110.0, 160.0, 80.0, 10.0, 33.0, 77.0, 19.0, 36.0, 9.0, 29.0, 30.0, 110.0, 42.0, 70.0, 60.0, 210.0, 245.0, 40.0, 20.0, 120.0, 10.0, 24.0, 30.0, 110.0, -5.0, 100.0, -137.0, 250.0, 70.0, 25.0, 180.0, 57.0, 205.0, -60.0, 70.0, 66.0, 100.0, 33.0, 145.0, 9.0, 50.0, 49.0, 26.0, 230.0, 64.0, 29.0, 90.0, 130.0, 40.0, 73.0, 28.0, 78.0, -27.0, 120.0, 30.0, 67.0, -17.0, 130.0, 88.0, 32.0, 180.0, 60.0, 56.0, 70.0, 150.0, 80.0, 90.0, -65.0, 25.0, 65.0, -741.0, 120.0, 50.0, 40.0, 12.0, 170.0, 30.0, -120.0, 90.0, 40.0, 18.0, 33.0, 57.0, 58.0, 120.0, 100.0, 59.0, 109.0, 42.0, 69.0, 170.0, 35.0, 120.0, 48.0, 90.0, 63.0, 0.0, 244.0, 48.0, -103.0, 37.0, 35.0, 140.0, 520.0, 120.0, 180.0, 18.0, 100.0, 80.0, 170.0, 40.0, 160.0, 450.0, 21.0, 133.0, 180.0, 110.0, 90.0, 10.0, 40.0, 59.0, 60.0, 40.0, 75.0, 30.0, 20.0, -1.0, -14.0, 50.0, 310.0, 88.0, 39.0, 40.0, 155.0, 100.0, 80.0, 45.0, 30.0, 80.0, 70.0, 58.0, -34.0, 21.0, 49.0, 28.0, 620.0, 58.0, 46.0, -4.0, 50.0, 40.0, 19.0, 110.0, 90.0, 89.0, 199.0, 0.0, 90.0, 158.0, 32.0, 20.0, 18.0, 100.0, 140.0, 38.0, 14.0, 110.0, 170.0, 67.0, 208.0, 88.0, 80.0, 50.0, 80.0, 80.0, 40.0, 244.0, 36.0, 44.0, 57.0, 20.0, 100.0, -120.0, 450.0, 150.0, 60.0, 57.0, 80.0, 120.0, 53.0, -16.0, 48.0, 10.0, 540.0, 60.0, 153.0, 13.0, 147.0, 60.0, 30.0, 170.0, -27.0, 60.0, 90.0, 90.0, 45.0, 100.0, 58.0, 90.0, 20.0, 40.0, 112.0, 38.0, 57.0, 70.0, 10.0, 26.0, -70.0, 386.0, 35.0, 16.0, 145.0, 27.0, 80.0, 40.0, 250.0, -193.0, 80.0, 9.0, 450.0, -22.0, 270.0, 20.0, 54.0, 70.0, 38.0, 20.0, 10.0, 9.0, -27.0, 60.0, 20.0, 100.0, 100.0, -5.0, 50.0, 100.0, 409.0, 40.0, 92.0, 50.0, 10.0, 77.0, 90.0, 66.0, 100.0, 210.0, 80.0, -4.0, 70.0, 55.0, 46.0, 20.0, 60.0, 19.0, 167.0, 100.0, 160.0, 100.0, 90.0, 80.0, 90.0, 170.0, -44.0, 200.0, 41.0, -40.0, 70.0, -34.0, 60.0, 40.0, 78.0, 60.0, 50.0, 20.0, -13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.147250155286115, "mean_inference_ms": 2.4738022208503896, "mean_action_processing_ms": 0.8247387232123919, "mean_env_wait_ms": 1.7217323574571914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06353998184204102, "StateBufferConnector_ms": 0.010436773300170898, "ViewRequirementAgentConnector_ms": 0.5122926235198975}, "num_episodes": 23, "episode_return_max": 1445.0, "episode_return_min": -234.0, "episode_return_mean": 680.46, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.685564070819744, "num_env_steps_trained_throughput_per_sec": 32.685564070819744, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 121713.045, "restore_workers_time_ms": 0.013, "training_step_time_ms": 121712.991, "sample_time_ms": 3304.503, "learn_time_ms": 118385.43, "learn_throughput": 33.788, "synch_weights_time_ms": 12.934}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 58, "trial_id": "6085c_00000", "date": "2024-07-02_00-55-54", "timestamp": 1719896154, "time_this_iter_s": 122.38734221458435, "time_total_s": 9001.452347755432, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9001.452347755432, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 22.467052023121386, "ram_util_percent": 79.42601156069364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7478293793270003, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.498907956782494, "policy_loss": -0.005605239385398773, "vf_loss": 7.503555624274274, "vf_explained_var": 0.0015068695377617979, "kl": 0.00957571796158203, "entropy": 1.1795955120691983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 549315.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": -234.0, "episode_reward_mean": 684.42, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -741.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 68.442}, "custom_metrics": {}, "hist_stats": {"episode_reward": [565.0, 999.0, 800.0, 346.0, 699.0, 545.0, 482.0, 718.0, 728.0, 866.0, 911.0, 838.0, 539.0, 692.0, 555.0, 308.0, 412.0, 816.0, 283.0, 247.0, 429.0, 596.0, 561.0, 539.0, 689.0, 360.0, 353.0, 325.0, 832.0, 731.0, 1006.0, 628.0, 505.0, 800.0, 570.0, 395.0, 582.0, 791.0, 792.0, 750.0, 767.0, 912.0, 618.0, 410.0, 593.0, 518.0, 881.0, 590.0, 845.0, 533.0, 488.0, 403.0, 464.0, 909.0, 615.0, 694.0, 726.0, 735.0, 629.0, 829.0, -234.0, 426.0, 805.0, 1221.0, 1352.0, 534.0, 847.0, 967.0, 697.0, 610.0, 973.0, 1041.0, 1105.0, 678.0, 595.0, 935.0, 776.0, 337.0, 1034.0, 723.0, 987.0, 291.0, 1156.0, 827.0, 482.0, 881.0, 1048.0, 518.0, 440.0, 600.0, 416.0, 626.0, 1515.0, 754.0, 628.0, 1127.0, 896.0, 740.0, 356.0, 990.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 85.0, 60.0, 144.0, 30.0, 37.0, 89.0, 70.0, 30.0, 20.0, 30.0, -51.0, 91.0, 86.0, 310.0, 120.0, 31.0, 208.0, 180.0, -6.0, 40.0, 90.0, 245.0, 80.0, 54.0, 78.0, 90.0, 30.0, 73.0, 20.0, 27.0, 9.0, -1.0, 40.0, 80.0, 28.0, 60.0, 4.0, 29.0, 70.0, 50.0, 30.0, 43.0, 50.0, 70.0, 100.0, 86.0, 60.0, 150.0, 60.0, 40.0, 58.0, 40.0, 30.0, 56.0, 14.0, 28.0, -16.0, 45.0, 250.0, 50.0, 43.0, 100.0, 130.0, 45.0, -53.0, 10.0, 160.0, 159.0, -162.0, 39.0, 50.0, 60.0, 70.0, 3.0, 320.0, 26.0, 20.0, 80.0, 50.0, 100.0, 67.0, -20.0, 147.0, 10.0, 60.0, -65.0, 189.0, 170.0, 70.0, 106.0, 320.0, 40.0, 301.0, 60.0, 35.0, 6.0, -2.0, 40.0, -40.0, 50.0, 200.0, 150.0, 57.0, 230.0, 40.0, 17.0, 55.0, 47.0, 65.0, 49.0, -53.0, 78.0, 88.0, 27.0, 130.0, 61.0, 120.0, 130.0, 208.0, 120.0, -23.0, 50.0, 90.0, 250.0, -6.0, 25.0, 50.0, -24.0, 7.0, -13.0, 50.0, 110.0, -15.0, 70.0, 60.0, 50.0, 110.0, 200.0, 70.0, 166.0, 38.0, 38.0, 40.0, 28.0, 78.0, -3.0, 30.0, -114.0, 254.0, 10.0, 30.0, 70.0, 69.0, 0.0, 20.0, 20.0, 20.0, 39.0, 30.0, 40.0, 10.0, -25.0, 50.0, 5.0, 60.0, -14.0, 150.0, 48.0, 88.0, 40.0, 69.0, -38.0, 330.0, 50.0, 90.0, 160.0, -20.0, 80.0, 55.0, -9.0, -5.0, -13.0, 17.0, 98.0, 30.0, 119.0, 30.0, 10.0, 6.0, 11.0, 40.0, 30.0, -27.0, 20.0, 170.0, 30.0, 18.0, 10.0, -55.0, 50.0, 0.0, -10.0, 110.0, 60.0, 20.0, 40.0, 60.0, 40.0, 59.0, -10.0, 10.0, -26.0, 50.0, 170.0, 83.0, 76.0, 60.0, 30.0, 153.0, 80.0, 19.0, 58.0, 60.0, 61.0, 57.0, 41.0, 50.0, 85.0, 50.0, 10.0, 67.0, 11.0, 3.0, -40.0, 50.0, 69.0, 20.0, 59.0, 290.0, 90.0, 90.0, -33.0, 60.0, 22.0, 4.0, 210.0, 35.0, 70.0, 141.0, 70.0, 36.0, 70.0, 70.0, -80.0, 0.0, 50.0, 18.0, 50.0, 76.0, 3.0, 115.0, 60.0, 130.0, -61.0, 68.0, 4.0, -18.0, 90.0, -38.0, 20.0, -6.0, 60.0, -52.0, 50.0, 70.0, 41.0, 30.0, 120.0, -8.0, 120.0, 306.0, 50.0, 90.0, 44.0, 36.0, 50.0, 40.0, 3.0, 93.0, -3.0, 310.0, 80.0, 89.0, 41.0, 14.0, 50.0, 20.0, 100.0, 30.0, 100.0, 160.0, 29.0, 168.0, 0.0, 120.0, 40.0, 99.0, 200.0, 90.0, 270.0, 25.0, -2.0, 50.0, 20.0, 130.0, -5.0, 50.0, 47.0, 43.0, 40.0, 30.0, 40.0, 40.0, 9.0, 169.0, 0.0, 30.0, -19.0, 166.0, 40.0, 120.0, 70.0, 229.0, 20.0, -53.0, 154.0, 80.0, 50.0, 90.0, 195.0, 0.0, 0.0, 20.0, 10.0, 80.0, 167.0, 29.0, 49.0, 20.0, 7.0, 50.0, -18.0, 31.0, 12.0, 190.0, 13.0, 16.0, 90.0, 4.0, 67.0, 70.0, 11.0, 40.0, 90.0, 1.0, 80.0, 57.0, 160.0, 6.0, 30.0, 59.0, 43.0, 70.0, 60.0, 79.0, 90.0, 265.0, 35.0, 60.0, 260.0, 110.0, 80.0, 50.0, -74.0, 60.0, 100.0, 156.0, 70.0, -20.0, 3.0, 159.0, 14.0, 60.0, 19.0, -10.0, 115.0, 20.0, 100.0, 270.0, 78.0, 30.0, 80.0, 269.0, -20.0, 70.0, 70.0, 90.0, 80.0, 20.0, 58.0, 47.0, 40.0, 46.0, 120.0, 177.0, 180.0, 75.0, 29.0, 140.0, 56.0, 40.0, 105.0, -35.0, 100.0, 241.0, 29.0, 25.0, 20.0, 37.0, 190.0, 33.0, 45.0, 22.0, 50.0, 10.0, 90.0, 30.0, -160.0, 100.0, 10.0, 110.0, 28.0, 80.0, 40.0, 213.0, 0.0, 33.0, -1.0, 80.0, 20.0, -9.0, 50.0, 60.0, 180.0, 37.0, 40.0, 90.0, 20.0, 30.0, -22.0, 150.0, -125.0, 90.0, 688.0, -12.0, 0.0, -38.0, 30.0, 120.0, 60.0, 54.0, 27.0, 20.0, 159.0, -32.0, 160.0, 11.0, 40.0, 91.0, 40.0, 20.0, 480.0, 78.0, 70.0, 56.0, -55.0, 30.0, 21.0, 105.0, 15.0, 39.0, 80.0, 30.0, 48.0, 40.0, 230.0, -4.0, 30.0, 25.0, 90.0, 40.0, 30.0, 40.0, 80.0, 27.0, 68.0, 3.0, 60.0, 50.0, 168.0, 20.0, 137.0, 8.0, -5.0, -4.0, 20.0, 30.0, 10.0, 19.0, 0.0, 170.0, 60.0, 70.0, 80.0, 20.0, 19.0, 20.0, 30.0, -5.0, 40.0, 170.0, 160.0, 69.0, 110.0, 160.0, 80.0, 10.0, 33.0, 77.0, 19.0, 36.0, 9.0, 29.0, 30.0, 110.0, 42.0, 70.0, 60.0, 210.0, 245.0, 40.0, 20.0, 120.0, 10.0, 24.0, 30.0, 110.0, -5.0, 100.0, -137.0, 250.0, 70.0, 25.0, 180.0, 57.0, 205.0, -60.0, 70.0, 66.0, 100.0, 33.0, 145.0, 9.0, 50.0, 49.0, 26.0, 230.0, 64.0, 29.0, 90.0, 130.0, 40.0, 73.0, 28.0, 78.0, -27.0, 120.0, 30.0, 67.0, -17.0, 130.0, 88.0, 32.0, 180.0, 60.0, 56.0, 70.0, 150.0, 80.0, 90.0, -65.0, 25.0, 65.0, -741.0, 120.0, 50.0, 40.0, 12.0, 170.0, 30.0, -120.0, 90.0, 40.0, 18.0, 33.0, 57.0, 58.0, 120.0, 100.0, 59.0, 109.0, 42.0, 69.0, 170.0, 35.0, 120.0, 48.0, 90.0, 63.0, 0.0, 244.0, 48.0, -103.0, 37.0, 35.0, 140.0, 520.0, 120.0, 180.0, 18.0, 100.0, 80.0, 170.0, 40.0, 160.0, 450.0, 21.0, 133.0, 180.0, 110.0, 90.0, 10.0, 40.0, 59.0, 60.0, 40.0, 75.0, 30.0, 20.0, -1.0, -14.0, 50.0, 310.0, 88.0, 39.0, 40.0, 155.0, 100.0, 80.0, 45.0, 30.0, 80.0, 70.0, 58.0, -34.0, 21.0, 49.0, 28.0, 620.0, 58.0, 46.0, -4.0, 50.0, 40.0, 19.0, 110.0, 90.0, 89.0, 199.0, 0.0, 90.0, 158.0, 32.0, 20.0, 18.0, 100.0, 140.0, 38.0, 14.0, 110.0, 170.0, 67.0, 208.0, 88.0, 80.0, 50.0, 80.0, 80.0, 40.0, 244.0, 36.0, 44.0, 57.0, 20.0, 100.0, -120.0, 450.0, 150.0, 60.0, 57.0, 80.0, 120.0, 53.0, -16.0, 48.0, 10.0, 540.0, 60.0, 153.0, 13.0, 147.0, 60.0, 30.0, 170.0, -27.0, 60.0, 90.0, 90.0, 45.0, 100.0, 58.0, 90.0, 20.0, 40.0, 112.0, 38.0, 57.0, 70.0, 10.0, 26.0, -70.0, 386.0, 35.0, 16.0, 145.0, 27.0, 80.0, 40.0, 250.0, -193.0, 80.0, 9.0, 450.0, -22.0, 270.0, 20.0, 54.0, 70.0, 38.0, 20.0, 10.0, 9.0, -27.0, 60.0, 20.0, 100.0, 100.0, -5.0, 50.0, 100.0, 409.0, 40.0, 92.0, 50.0, 10.0, 77.0, 90.0, 66.0, 100.0, 210.0, 80.0, -4.0, 70.0, 55.0, 46.0, 20.0, 60.0, 19.0, 167.0, 100.0, 160.0, 100.0, 90.0, 80.0, 90.0, 170.0, -44.0, 200.0, 41.0, -40.0, 70.0, -34.0, 60.0, 40.0, 78.0, 60.0, 50.0, 20.0, -13.0, 80.0, 100.0, 30.0, 260.0, 230.0, 2.0, 164.0, 110.0, 60.0, 120.0, 170.0, 110.0, 67.0, 41.0, 60.0, 232.0, -20.0, 110.0, 7.0, 50.0, -10.0, -43.0, 80.0, 50.0, 160.0, 10.0, 166.0, 24.0, 59.0, -14.0, 120.0, 84.0, 320.0, 80.0, 50.0, 50.0, 27.0, 0.0, 80.0, 70.0, 120.0, 400.0, 90.0, 9.0, 120.0, 79.0, 90.0, 60.0, 60.0, 20.0, 15.0, 130.0, -14.0, 120.0, 3.0, 15.0, 168.0, 30.0, 16.0, 35.0, 17.0, 60.0, 55.0, 120.0, 60.0, 26.0, 14.0, 40.0, 30.0, 18.0, 70.0, 170.0, 100.0, 39.0, 5.0, 40.0, 50.0, 59.0, 29.0, 38.0, -34.0, 20.0, 50.0, -11.0, 8.0, 70.0, 120.0, 144.0, 19.0, 30.0, -110.0, 340.0, 48.0, 70.0, 20.0, 40.0, 60.0, -95.0, 133.0, 120.0, 0.0, 110.0, 100.0, 100.0, 20.0, 20.0, 710.0, 49.0, 146.0, 260.0, 14.0, 69.0, 130.0, 77.0, 78.0, 90.0, 110.0, 48.0, 68.0, 70.0, 30.0, 30.0, 208.0, 50.0, 50.0, 60.0, 80.0, 50.0, -10.0, 80.0, 40.0, 90.0, -6.0, 120.0, 260.0, 210.0, 150.0, 31.0, 100.0, 132.0, 20.0, 30.0, 20.0, 140.0, 60.0, 300.0, 120.0, 105.0, 60.0, 41.0, 60.0, 60.0, -10.0, 190.0, 200.0, 90.0, 120.0, -120.0, 70.0, 80.0, 23.0, 40.0, -94.0, 70.0, -48.0, -61.0, 189.0, 70.0, 70.0, 97.0, 64.0, 150.0, 25.0, 84.0, 25.0, 17.0, 100.0, 55.0, 350.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.141838769706732, "mean_inference_ms": 2.4681979479337848, "mean_action_processing_ms": 0.8259499981358025, "mean_env_wait_ms": 1.7174216571563938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0700833797454834, "StateBufferConnector_ms": 0.010783195495605469, "ViewRequirementAgentConnector_ms": 0.4952700138092041}, "num_episodes": 18, "episode_return_max": 1515.0, "episode_return_min": -234.0, "episode_return_mean": 684.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.666062107943425, "num_env_steps_trained_throughput_per_sec": 32.666062107943425, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 2360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2360000, "timers": {"training_iteration_time_ms": 121875.232, "restore_workers_time_ms": 0.014, "training_step_time_ms": 121875.173, "sample_time_ms": 3368.322, "learn_time_ms": 118483.316, "learn_throughput": 33.76, "synch_weights_time_ms": 13.22}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "done": false, "training_iteration": 59, "trial_id": "6085c_00000", "date": "2024-07-02_00-57-56", "timestamp": 1719896276, "time_this_iter_s": 122.46383500099182, "time_total_s": 9123.916182756424, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138ad0280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9123.916182756424, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 20.26184971098266, "ram_util_percent": 79.82890173410405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8415659463634126, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.237249855136973, "policy_loss": -0.006783366497297086, "vf_loss": 7.24296013961077, "vf_explained_var": 0.006489924107369777, "kl": 0.010730781528134867, "entropy": 1.1847857351882007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 558705.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": -234.0, "episode_reward_mean": 698.14, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -741.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 69.814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [283.0, 247.0, 429.0, 596.0, 561.0, 539.0, 689.0, 360.0, 353.0, 325.0, 832.0, 731.0, 1006.0, 628.0, 505.0, 800.0, 570.0, 395.0, 582.0, 791.0, 792.0, 750.0, 767.0, 912.0, 618.0, 410.0, 593.0, 518.0, 881.0, 590.0, 845.0, 533.0, 488.0, 403.0, 464.0, 909.0, 615.0, 694.0, 726.0, 735.0, 629.0, 829.0, -234.0, 426.0, 805.0, 1221.0, 1352.0, 534.0, 847.0, 967.0, 697.0, 610.0, 973.0, 1041.0, 1105.0, 678.0, 595.0, 935.0, 776.0, 337.0, 1034.0, 723.0, 987.0, 291.0, 1156.0, 827.0, 482.0, 881.0, 1048.0, 518.0, 440.0, 600.0, 416.0, 626.0, 1515.0, 754.0, 628.0, 1127.0, 896.0, 740.0, 356.0, 990.0, 991.0, 572.0, 645.0, 682.0, 746.0, 929.0, 905.0, 691.0, 1092.0, 470.0, 480.0, 795.0, 810.0, 1005.0, 755.0, 397.0, 410.0, 816.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-9.0, -5.0, -13.0, 17.0, 98.0, 30.0, 119.0, 30.0, 10.0, 6.0, 11.0, 40.0, 30.0, -27.0, 20.0, 170.0, 30.0, 18.0, 10.0, -55.0, 50.0, 0.0, -10.0, 110.0, 60.0, 20.0, 40.0, 60.0, 40.0, 59.0, -10.0, 10.0, -26.0, 50.0, 170.0, 83.0, 76.0, 60.0, 30.0, 153.0, 80.0, 19.0, 58.0, 60.0, 61.0, 57.0, 41.0, 50.0, 85.0, 50.0, 10.0, 67.0, 11.0, 3.0, -40.0, 50.0, 69.0, 20.0, 59.0, 290.0, 90.0, 90.0, -33.0, 60.0, 22.0, 4.0, 210.0, 35.0, 70.0, 141.0, 70.0, 36.0, 70.0, 70.0, -80.0, 0.0, 50.0, 18.0, 50.0, 76.0, 3.0, 115.0, 60.0, 130.0, -61.0, 68.0, 4.0, -18.0, 90.0, -38.0, 20.0, -6.0, 60.0, -52.0, 50.0, 70.0, 41.0, 30.0, 120.0, -8.0, 120.0, 306.0, 50.0, 90.0, 44.0, 36.0, 50.0, 40.0, 3.0, 93.0, -3.0, 310.0, 80.0, 89.0, 41.0, 14.0, 50.0, 20.0, 100.0, 30.0, 100.0, 160.0, 29.0, 168.0, 0.0, 120.0, 40.0, 99.0, 200.0, 90.0, 270.0, 25.0, -2.0, 50.0, 20.0, 130.0, -5.0, 50.0, 47.0, 43.0, 40.0, 30.0, 40.0, 40.0, 9.0, 169.0, 0.0, 30.0, -19.0, 166.0, 40.0, 120.0, 70.0, 229.0, 20.0, -53.0, 154.0, 80.0, 50.0, 90.0, 195.0, 0.0, 0.0, 20.0, 10.0, 80.0, 167.0, 29.0, 49.0, 20.0, 7.0, 50.0, -18.0, 31.0, 12.0, 190.0, 13.0, 16.0, 90.0, 4.0, 67.0, 70.0, 11.0, 40.0, 90.0, 1.0, 80.0, 57.0, 160.0, 6.0, 30.0, 59.0, 43.0, 70.0, 60.0, 79.0, 90.0, 265.0, 35.0, 60.0, 260.0, 110.0, 80.0, 50.0, -74.0, 60.0, 100.0, 156.0, 70.0, -20.0, 3.0, 159.0, 14.0, 60.0, 19.0, -10.0, 115.0, 20.0, 100.0, 270.0, 78.0, 30.0, 80.0, 269.0, -20.0, 70.0, 70.0, 90.0, 80.0, 20.0, 58.0, 47.0, 40.0, 46.0, 120.0, 177.0, 180.0, 75.0, 29.0, 140.0, 56.0, 40.0, 105.0, -35.0, 100.0, 241.0, 29.0, 25.0, 20.0, 37.0, 190.0, 33.0, 45.0, 22.0, 50.0, 10.0, 90.0, 30.0, -160.0, 100.0, 10.0, 110.0, 28.0, 80.0, 40.0, 213.0, 0.0, 33.0, -1.0, 80.0, 20.0, -9.0, 50.0, 60.0, 180.0, 37.0, 40.0, 90.0, 20.0, 30.0, -22.0, 150.0, -125.0, 90.0, 688.0, -12.0, 0.0, -38.0, 30.0, 120.0, 60.0, 54.0, 27.0, 20.0, 159.0, -32.0, 160.0, 11.0, 40.0, 91.0, 40.0, 20.0, 480.0, 78.0, 70.0, 56.0, -55.0, 30.0, 21.0, 105.0, 15.0, 39.0, 80.0, 30.0, 48.0, 40.0, 230.0, -4.0, 30.0, 25.0, 90.0, 40.0, 30.0, 40.0, 80.0, 27.0, 68.0, 3.0, 60.0, 50.0, 168.0, 20.0, 137.0, 8.0, -5.0, -4.0, 20.0, 30.0, 10.0, 19.0, 0.0, 170.0, 60.0, 70.0, 80.0, 20.0, 19.0, 20.0, 30.0, -5.0, 40.0, 170.0, 160.0, 69.0, 110.0, 160.0, 80.0, 10.0, 33.0, 77.0, 19.0, 36.0, 9.0, 29.0, 30.0, 110.0, 42.0, 70.0, 60.0, 210.0, 245.0, 40.0, 20.0, 120.0, 10.0, 24.0, 30.0, 110.0, -5.0, 100.0, -137.0, 250.0, 70.0, 25.0, 180.0, 57.0, 205.0, -60.0, 70.0, 66.0, 100.0, 33.0, 145.0, 9.0, 50.0, 49.0, 26.0, 230.0, 64.0, 29.0, 90.0, 130.0, 40.0, 73.0, 28.0, 78.0, -27.0, 120.0, 30.0, 67.0, -17.0, 130.0, 88.0, 32.0, 180.0, 60.0, 56.0, 70.0, 150.0, 80.0, 90.0, -65.0, 25.0, 65.0, -741.0, 120.0, 50.0, 40.0, 12.0, 170.0, 30.0, -120.0, 90.0, 40.0, 18.0, 33.0, 57.0, 58.0, 120.0, 100.0, 59.0, 109.0, 42.0, 69.0, 170.0, 35.0, 120.0, 48.0, 90.0, 63.0, 0.0, 244.0, 48.0, -103.0, 37.0, 35.0, 140.0, 520.0, 120.0, 180.0, 18.0, 100.0, 80.0, 170.0, 40.0, 160.0, 450.0, 21.0, 133.0, 180.0, 110.0, 90.0, 10.0, 40.0, 59.0, 60.0, 40.0, 75.0, 30.0, 20.0, -1.0, -14.0, 50.0, 310.0, 88.0, 39.0, 40.0, 155.0, 100.0, 80.0, 45.0, 30.0, 80.0, 70.0, 58.0, -34.0, 21.0, 49.0, 28.0, 620.0, 58.0, 46.0, -4.0, 50.0, 40.0, 19.0, 110.0, 90.0, 89.0, 199.0, 0.0, 90.0, 158.0, 32.0, 20.0, 18.0, 100.0, 140.0, 38.0, 14.0, 110.0, 170.0, 67.0, 208.0, 88.0, 80.0, 50.0, 80.0, 80.0, 40.0, 244.0, 36.0, 44.0, 57.0, 20.0, 100.0, -120.0, 450.0, 150.0, 60.0, 57.0, 80.0, 120.0, 53.0, -16.0, 48.0, 10.0, 540.0, 60.0, 153.0, 13.0, 147.0, 60.0, 30.0, 170.0, -27.0, 60.0, 90.0, 90.0, 45.0, 100.0, 58.0, 90.0, 20.0, 40.0, 112.0, 38.0, 57.0, 70.0, 10.0, 26.0, -70.0, 386.0, 35.0, 16.0, 145.0, 27.0, 80.0, 40.0, 250.0, -193.0, 80.0, 9.0, 450.0, -22.0, 270.0, 20.0, 54.0, 70.0, 38.0, 20.0, 10.0, 9.0, -27.0, 60.0, 20.0, 100.0, 100.0, -5.0, 50.0, 100.0, 409.0, 40.0, 92.0, 50.0, 10.0, 77.0, 90.0, 66.0, 100.0, 210.0, 80.0, -4.0, 70.0, 55.0, 46.0, 20.0, 60.0, 19.0, 167.0, 100.0, 160.0, 100.0, 90.0, 80.0, 90.0, 170.0, -44.0, 200.0, 41.0, -40.0, 70.0, -34.0, 60.0, 40.0, 78.0, 60.0, 50.0, 20.0, -13.0, 80.0, 100.0, 30.0, 260.0, 230.0, 2.0, 164.0, 110.0, 60.0, 120.0, 170.0, 110.0, 67.0, 41.0, 60.0, 232.0, -20.0, 110.0, 7.0, 50.0, -10.0, -43.0, 80.0, 50.0, 160.0, 10.0, 166.0, 24.0, 59.0, -14.0, 120.0, 84.0, 320.0, 80.0, 50.0, 50.0, 27.0, 0.0, 80.0, 70.0, 120.0, 400.0, 90.0, 9.0, 120.0, 79.0, 90.0, 60.0, 60.0, 20.0, 15.0, 130.0, -14.0, 120.0, 3.0, 15.0, 168.0, 30.0, 16.0, 35.0, 17.0, 60.0, 55.0, 120.0, 60.0, 26.0, 14.0, 40.0, 30.0, 18.0, 70.0, 170.0, 100.0, 39.0, 5.0, 40.0, 50.0, 59.0, 29.0, 38.0, -34.0, 20.0, 50.0, -11.0, 8.0, 70.0, 120.0, 144.0, 19.0, 30.0, -110.0, 340.0, 48.0, 70.0, 20.0, 40.0, 60.0, -95.0, 133.0, 120.0, 0.0, 110.0, 100.0, 100.0, 20.0, 20.0, 710.0, 49.0, 146.0, 260.0, 14.0, 69.0, 130.0, 77.0, 78.0, 90.0, 110.0, 48.0, 68.0, 70.0, 30.0, 30.0, 208.0, 50.0, 50.0, 60.0, 80.0, 50.0, -10.0, 80.0, 40.0, 90.0, -6.0, 120.0, 260.0, 210.0, 150.0, 31.0, 100.0, 132.0, 20.0, 30.0, 20.0, 140.0, 60.0, 300.0, 120.0, 105.0, 60.0, 41.0, 60.0, 60.0, -10.0, 190.0, 200.0, 90.0, 120.0, -120.0, 70.0, 80.0, 23.0, 40.0, -94.0, 70.0, -48.0, -61.0, 189.0, 70.0, 70.0, 97.0, 64.0, 150.0, 25.0, 84.0, 25.0, 17.0, 100.0, 55.0, 350.0, 120.0, 120.0, 113.0, 77.0, 400.0, 100.0, 60.0, 70.0, 20.0, 165.0, -134.0, 50.0, -37.0, 75.0, 158.0, 40.0, 115.0, 36.0, 37.0, 30.0, 68.0, 30.0, -10.0, 80.0, 150.0, 60.0, 50.0, 15.0, 80.0, 80.0, 110.0, 70.0, 110.0, 70.0, 51.0, 120.0, 21.0, 80.0, 50.0, 20.0, 90.0, 43.0, 54.0, 128.0, -20.0, 74.0, 28.0, 220.0, 150.0, 19.0, 50.0, 207.0, 200.0, 40.0, 60.0, 58.0, 40.0, 67.0, 170.0, 60.0, 27.0, 120.0, 50.0, 70.0, 30.0, 78.0, 390.0, 89.0, 70.0, -22.0, 30.0, 70.0, 38.0, 39.0, 60.0, 269.0, 200.0, 29.0, 40.0, -70.0, 16.0, -120.0, 200.0, 36.0, 60.0, 297.0, 60.0, 60.0, 69.0, 330.0, 100.0, -12.0, 101.0, 8.0, 120.0, 54.0, 29.0, 90.0, 0.0, 10.0, 70.0, 37.0, 12.0, 50.0, 50.0, 135.0, 18.0, 30.0, 57.0, 5.0, 86.0, 37.0, 30.0, 140.0, 67.0, 90.0, 100.0, 60.0, 61.0, 130.0, 80.0, -64.0, 538.0, 27.0, -37.0, 90.0, 1.0, 55.0, 10.0, 70.0, 120.0, 100.0, 5.0, 350.0, 80.0, 110.0, 90.0, 80.0, 20.0, 190.0, -20.0, 30.0, -45.0, 120.0, 270.0, 100.0, 40.0, 60.0, 70.0, 40.0, 70.0, 180.0, 11.0, 22.0, 30.0, 20.0, 23.0, 3.0, 28.0, 60.0, 20.0, 23.0, 58.0, 80.0, 90.0, 42.0, -53.0, 20.0, 50.0, 30.0, 70.0, 86.0, 50.0, 109.0, 40.0, 120.0, 56.0, 160.0, 39.0, 60.0, 96.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1368062920095685, "mean_inference_ms": 2.4630149638475523, "mean_action_processing_ms": 0.8272488997611462, "mean_env_wait_ms": 1.7135218529351106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08039426803588867, "StateBufferConnector_ms": 0.01113128662109375, "ViewRequirementAgentConnector_ms": 0.5369317531585693}, "num_episodes": 18, "episode_return_max": 1515.0, "episode_return_min": -234.0, "episode_return_mean": 698.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.61111379135928, "num_env_steps_trained_throughput_per_sec": 32.61111379135928, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 122122.27, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122122.21, "sample_time_ms": 3407.407, "learn_time_ms": 118690.95, "learn_throughput": 33.701, "synch_weights_time_ms": 13.393}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 60, "trial_id": "6085c_00000", "date": "2024-07-02_00-59-59", "timestamp": 1719896399, "time_this_iter_s": 122.67489671707153, "time_total_s": 9246.591079473495, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b91799d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9246.591079473495, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 20.634482758620692, "ram_util_percent": 79.88218390804597}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.950068314749593, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.283349353335282, "policy_loss": -0.007244670303876654, "vf_loss": 7.289232147895236, "vf_explained_var": 0.004958122511641286, "kl": 0.013618795813490335, "entropy": 1.1875996655549486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 568095.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": -234.0, "episode_reward_mean": 727.64, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -741.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 72.764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [767.0, 912.0, 618.0, 410.0, 593.0, 518.0, 881.0, 590.0, 845.0, 533.0, 488.0, 403.0, 464.0, 909.0, 615.0, 694.0, 726.0, 735.0, 629.0, 829.0, -234.0, 426.0, 805.0, 1221.0, 1352.0, 534.0, 847.0, 967.0, 697.0, 610.0, 973.0, 1041.0, 1105.0, 678.0, 595.0, 935.0, 776.0, 337.0, 1034.0, 723.0, 987.0, 291.0, 1156.0, 827.0, 482.0, 881.0, 1048.0, 518.0, 440.0, 600.0, 416.0, 626.0, 1515.0, 754.0, 628.0, 1127.0, 896.0, 740.0, 356.0, 990.0, 991.0, 572.0, 645.0, 682.0, 746.0, 929.0, 905.0, 691.0, 1092.0, 470.0, 480.0, 795.0, 810.0, 1005.0, 755.0, 397.0, 410.0, 816.0, 1036.0, 727.0, 942.0, 879.0, 674.0, 631.0, 595.0, 477.0, 737.0, 517.0, 785.0, 583.0, 831.0, 723.0, 607.0, 717.0, 838.0, 623.0, 216.0, 856.0, 1224.0, 496.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [78.0, 30.0, 80.0, 269.0, -20.0, 70.0, 70.0, 90.0, 80.0, 20.0, 58.0, 47.0, 40.0, 46.0, 120.0, 177.0, 180.0, 75.0, 29.0, 140.0, 56.0, 40.0, 105.0, -35.0, 100.0, 241.0, 29.0, 25.0, 20.0, 37.0, 190.0, 33.0, 45.0, 22.0, 50.0, 10.0, 90.0, 30.0, -160.0, 100.0, 10.0, 110.0, 28.0, 80.0, 40.0, 213.0, 0.0, 33.0, -1.0, 80.0, 20.0, -9.0, 50.0, 60.0, 180.0, 37.0, 40.0, 90.0, 20.0, 30.0, -22.0, 150.0, -125.0, 90.0, 688.0, -12.0, 0.0, -38.0, 30.0, 120.0, 60.0, 54.0, 27.0, 20.0, 159.0, -32.0, 160.0, 11.0, 40.0, 91.0, 40.0, 20.0, 480.0, 78.0, 70.0, 56.0, -55.0, 30.0, 21.0, 105.0, 15.0, 39.0, 80.0, 30.0, 48.0, 40.0, 230.0, -4.0, 30.0, 25.0, 90.0, 40.0, 30.0, 40.0, 80.0, 27.0, 68.0, 3.0, 60.0, 50.0, 168.0, 20.0, 137.0, 8.0, -5.0, -4.0, 20.0, 30.0, 10.0, 19.0, 0.0, 170.0, 60.0, 70.0, 80.0, 20.0, 19.0, 20.0, 30.0, -5.0, 40.0, 170.0, 160.0, 69.0, 110.0, 160.0, 80.0, 10.0, 33.0, 77.0, 19.0, 36.0, 9.0, 29.0, 30.0, 110.0, 42.0, 70.0, 60.0, 210.0, 245.0, 40.0, 20.0, 120.0, 10.0, 24.0, 30.0, 110.0, -5.0, 100.0, -137.0, 250.0, 70.0, 25.0, 180.0, 57.0, 205.0, -60.0, 70.0, 66.0, 100.0, 33.0, 145.0, 9.0, 50.0, 49.0, 26.0, 230.0, 64.0, 29.0, 90.0, 130.0, 40.0, 73.0, 28.0, 78.0, -27.0, 120.0, 30.0, 67.0, -17.0, 130.0, 88.0, 32.0, 180.0, 60.0, 56.0, 70.0, 150.0, 80.0, 90.0, -65.0, 25.0, 65.0, -741.0, 120.0, 50.0, 40.0, 12.0, 170.0, 30.0, -120.0, 90.0, 40.0, 18.0, 33.0, 57.0, 58.0, 120.0, 100.0, 59.0, 109.0, 42.0, 69.0, 170.0, 35.0, 120.0, 48.0, 90.0, 63.0, 0.0, 244.0, 48.0, -103.0, 37.0, 35.0, 140.0, 520.0, 120.0, 180.0, 18.0, 100.0, 80.0, 170.0, 40.0, 160.0, 450.0, 21.0, 133.0, 180.0, 110.0, 90.0, 10.0, 40.0, 59.0, 60.0, 40.0, 75.0, 30.0, 20.0, -1.0, -14.0, 50.0, 310.0, 88.0, 39.0, 40.0, 155.0, 100.0, 80.0, 45.0, 30.0, 80.0, 70.0, 58.0, -34.0, 21.0, 49.0, 28.0, 620.0, 58.0, 46.0, -4.0, 50.0, 40.0, 19.0, 110.0, 90.0, 89.0, 199.0, 0.0, 90.0, 158.0, 32.0, 20.0, 18.0, 100.0, 140.0, 38.0, 14.0, 110.0, 170.0, 67.0, 208.0, 88.0, 80.0, 50.0, 80.0, 80.0, 40.0, 244.0, 36.0, 44.0, 57.0, 20.0, 100.0, -120.0, 450.0, 150.0, 60.0, 57.0, 80.0, 120.0, 53.0, -16.0, 48.0, 10.0, 540.0, 60.0, 153.0, 13.0, 147.0, 60.0, 30.0, 170.0, -27.0, 60.0, 90.0, 90.0, 45.0, 100.0, 58.0, 90.0, 20.0, 40.0, 112.0, 38.0, 57.0, 70.0, 10.0, 26.0, -70.0, 386.0, 35.0, 16.0, 145.0, 27.0, 80.0, 40.0, 250.0, -193.0, 80.0, 9.0, 450.0, -22.0, 270.0, 20.0, 54.0, 70.0, 38.0, 20.0, 10.0, 9.0, -27.0, 60.0, 20.0, 100.0, 100.0, -5.0, 50.0, 100.0, 409.0, 40.0, 92.0, 50.0, 10.0, 77.0, 90.0, 66.0, 100.0, 210.0, 80.0, -4.0, 70.0, 55.0, 46.0, 20.0, 60.0, 19.0, 167.0, 100.0, 160.0, 100.0, 90.0, 80.0, 90.0, 170.0, -44.0, 200.0, 41.0, -40.0, 70.0, -34.0, 60.0, 40.0, 78.0, 60.0, 50.0, 20.0, -13.0, 80.0, 100.0, 30.0, 260.0, 230.0, 2.0, 164.0, 110.0, 60.0, 120.0, 170.0, 110.0, 67.0, 41.0, 60.0, 232.0, -20.0, 110.0, 7.0, 50.0, -10.0, -43.0, 80.0, 50.0, 160.0, 10.0, 166.0, 24.0, 59.0, -14.0, 120.0, 84.0, 320.0, 80.0, 50.0, 50.0, 27.0, 0.0, 80.0, 70.0, 120.0, 400.0, 90.0, 9.0, 120.0, 79.0, 90.0, 60.0, 60.0, 20.0, 15.0, 130.0, -14.0, 120.0, 3.0, 15.0, 168.0, 30.0, 16.0, 35.0, 17.0, 60.0, 55.0, 120.0, 60.0, 26.0, 14.0, 40.0, 30.0, 18.0, 70.0, 170.0, 100.0, 39.0, 5.0, 40.0, 50.0, 59.0, 29.0, 38.0, -34.0, 20.0, 50.0, -11.0, 8.0, 70.0, 120.0, 144.0, 19.0, 30.0, -110.0, 340.0, 48.0, 70.0, 20.0, 40.0, 60.0, -95.0, 133.0, 120.0, 0.0, 110.0, 100.0, 100.0, 20.0, 20.0, 710.0, 49.0, 146.0, 260.0, 14.0, 69.0, 130.0, 77.0, 78.0, 90.0, 110.0, 48.0, 68.0, 70.0, 30.0, 30.0, 208.0, 50.0, 50.0, 60.0, 80.0, 50.0, -10.0, 80.0, 40.0, 90.0, -6.0, 120.0, 260.0, 210.0, 150.0, 31.0, 100.0, 132.0, 20.0, 30.0, 20.0, 140.0, 60.0, 300.0, 120.0, 105.0, 60.0, 41.0, 60.0, 60.0, -10.0, 190.0, 200.0, 90.0, 120.0, -120.0, 70.0, 80.0, 23.0, 40.0, -94.0, 70.0, -48.0, -61.0, 189.0, 70.0, 70.0, 97.0, 64.0, 150.0, 25.0, 84.0, 25.0, 17.0, 100.0, 55.0, 350.0, 120.0, 120.0, 113.0, 77.0, 400.0, 100.0, 60.0, 70.0, 20.0, 165.0, -134.0, 50.0, -37.0, 75.0, 158.0, 40.0, 115.0, 36.0, 37.0, 30.0, 68.0, 30.0, -10.0, 80.0, 150.0, 60.0, 50.0, 15.0, 80.0, 80.0, 110.0, 70.0, 110.0, 70.0, 51.0, 120.0, 21.0, 80.0, 50.0, 20.0, 90.0, 43.0, 54.0, 128.0, -20.0, 74.0, 28.0, 220.0, 150.0, 19.0, 50.0, 207.0, 200.0, 40.0, 60.0, 58.0, 40.0, 67.0, 170.0, 60.0, 27.0, 120.0, 50.0, 70.0, 30.0, 78.0, 390.0, 89.0, 70.0, -22.0, 30.0, 70.0, 38.0, 39.0, 60.0, 269.0, 200.0, 29.0, 40.0, -70.0, 16.0, -120.0, 200.0, 36.0, 60.0, 297.0, 60.0, 60.0, 69.0, 330.0, 100.0, -12.0, 101.0, 8.0, 120.0, 54.0, 29.0, 90.0, 0.0, 10.0, 70.0, 37.0, 12.0, 50.0, 50.0, 135.0, 18.0, 30.0, 57.0, 5.0, 86.0, 37.0, 30.0, 140.0, 67.0, 90.0, 100.0, 60.0, 61.0, 130.0, 80.0, -64.0, 538.0, 27.0, -37.0, 90.0, 1.0, 55.0, 10.0, 70.0, 120.0, 100.0, 5.0, 350.0, 80.0, 110.0, 90.0, 80.0, 20.0, 190.0, -20.0, 30.0, -45.0, 120.0, 270.0, 100.0, 40.0, 60.0, 70.0, 40.0, 70.0, 180.0, 11.0, 22.0, 30.0, 20.0, 23.0, 3.0, 28.0, 60.0, 20.0, 23.0, 58.0, 80.0, 90.0, 42.0, -53.0, 20.0, 50.0, 30.0, 70.0, 86.0, 50.0, 109.0, 40.0, 120.0, 56.0, 160.0, 39.0, 60.0, 96.0, 77.0, 50.0, 49.0, 130.0, 220.0, 70.0, 60.0, 140.0, 150.0, 90.0, 80.0, 9.0, 79.0, 110.0, 100.0, 60.0, 50.0, 49.0, 40.0, 150.0, 50.0, 69.0, 68.0, 130.0, 160.0, 210.0, 48.0, 85.0, 57.0, 65.0, 69.0, 110.0, 50.0, 0.0, 169.0, 46.0, 65.0, 50.0, 290.0, 30.0, 0.0, 70.0, 100.0, 20.0, 220.0, 30.0, 80.0, 50.0, 99.0, 5.0, 37.0, 70.0, 45.0, 50.0, 60.0, 3.0, 227.0, 19.0, -10.0, 130.0, 150.0, -20.0, 50.0, 76.0, 180.0, 67.0, 50.0, -35.0, -3.0, 80.0, 28.0, -50.0, 53.0, 50.0, -12.0, 19.0, 110.0, 39.0, 120.0, 120.0, 270.0, -5.0, 40.0, 50.0, 60.0, 156.0, 58.0, 60.0, 70.0, -22.0, 25.0, 30.0, 100.0, 50.0, -11.0, 50.0, 70.0, 120.0, 35.0, 48.0, 10.0, 27.0, 180.0, 170.0, -10.0, 170.0, 79.0, 1.0, 58.0, 100.0, 75.0, 60.0, 19.0, 70.0, 80.0, 70.0, 69.0, 10.0, 90.0, 40.0, 79.0, 70.0, 130.0, 98.0, 100.0, 85.0, 120.0, 70.0, 50.0, 29.0, 145.0, 50.0, 60.0, 100.0, 130.0, 40.0, 70.0, 30.0, 60.0, 38.0, 39.0, 70.0, 110.0, 50.0, 300.0, 80.0, 160.0, 109.0, -320.0, 9.0, -10.0, 96.0, -27.0, 26.0, 50.0, 7.0, 160.0, 48.0, 217.0, 150.0, 100.0, 50.0, 50.0, 40.0, 60.0, 170.0, 60.0, 188.0, 60.0, 60.0, 50.0, 80.0, 49.0, 249.0, 30.0, 20.0, 47.0, 90.0, -12.0, 20.0, -18.0, 18.0, 18.0, 300.0, -230.0, 50.0, -16.0, 80.0, 18.0, -4.0, 53.0, 30.0, 170.0, 130.0, 40.0, 90.0, 50.0, 80.0, 118.0, 95.0, 15.0, 30.0, 40.0, 160.0, 50.0, -28.0, 67.0, 220.0, 130.0, 540.0, 25.0, 39.0, 4.0, 190.0, -41.0, 179.0, 38.0, 70.0, -22.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.133740484119154, "mean_inference_ms": 2.4549362181886183, "mean_action_processing_ms": 0.8217369750213919, "mean_env_wait_ms": 1.7083824786160469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08513760566711426, "StateBufferConnector_ms": 0.011092424392700195, "ViewRequirementAgentConnector_ms": 0.5318338871002197}, "num_episodes": 22, "episode_return_max": 1515.0, "episode_return_min": -234.0, "episode_return_mean": 727.64, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.24997991057992, "num_env_steps_trained_throughput_per_sec": 32.24997991057992, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 2440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2440000, "timers": {"training_iteration_time_ms": 122325.942, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122325.889, "sample_time_ms": 3405.265, "learn_time_ms": 118897.246, "learn_throughput": 33.642, "synch_weights_time_ms": 13.36}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "done": false, "training_iteration": 61, "trial_id": "6085c_00000", "date": "2024-07-02_01-02-03", "timestamp": 1719896523, "time_this_iter_s": 124.04232597351074, "time_total_s": 9370.633405447006, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9370.633405447006, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 25.926285714285715, "ram_util_percent": 80.248}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6116506183553683, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.282718005703407, "policy_loss": -0.004879481417743868, "vf_loss": 7.286367359709816, "vf_explained_var": 0.0024908427422800764, "kl": 0.01230119369540806, "entropy": 1.1465354092204914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 577485.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": -234.0, "episode_reward_mean": 738.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -741.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 73.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [629.0, 829.0, -234.0, 426.0, 805.0, 1221.0, 1352.0, 534.0, 847.0, 967.0, 697.0, 610.0, 973.0, 1041.0, 1105.0, 678.0, 595.0, 935.0, 776.0, 337.0, 1034.0, 723.0, 987.0, 291.0, 1156.0, 827.0, 482.0, 881.0, 1048.0, 518.0, 440.0, 600.0, 416.0, 626.0, 1515.0, 754.0, 628.0, 1127.0, 896.0, 740.0, 356.0, 990.0, 991.0, 572.0, 645.0, 682.0, 746.0, 929.0, 905.0, 691.0, 1092.0, 470.0, 480.0, 795.0, 810.0, 1005.0, 755.0, 397.0, 410.0, 816.0, 1036.0, 727.0, 942.0, 879.0, 674.0, 631.0, 595.0, 477.0, 737.0, 517.0, 785.0, 583.0, 831.0, 723.0, 607.0, 717.0, 838.0, 623.0, 216.0, 856.0, 1224.0, 496.0, 838.0, 797.0, 944.0, 524.0, 739.0, 339.0, 530.0, 476.0, 456.0, 1250.0, 906.0, 649.0, 707.0, 904.0, 706.0, 746.0, 699.0, 537.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 130.0, 40.0, 73.0, 28.0, 78.0, -27.0, 120.0, 30.0, 67.0, -17.0, 130.0, 88.0, 32.0, 180.0, 60.0, 56.0, 70.0, 150.0, 80.0, 90.0, -65.0, 25.0, 65.0, -741.0, 120.0, 50.0, 40.0, 12.0, 170.0, 30.0, -120.0, 90.0, 40.0, 18.0, 33.0, 57.0, 58.0, 120.0, 100.0, 59.0, 109.0, 42.0, 69.0, 170.0, 35.0, 120.0, 48.0, 90.0, 63.0, 0.0, 244.0, 48.0, -103.0, 37.0, 35.0, 140.0, 520.0, 120.0, 180.0, 18.0, 100.0, 80.0, 170.0, 40.0, 160.0, 450.0, 21.0, 133.0, 180.0, 110.0, 90.0, 10.0, 40.0, 59.0, 60.0, 40.0, 75.0, 30.0, 20.0, -1.0, -14.0, 50.0, 310.0, 88.0, 39.0, 40.0, 155.0, 100.0, 80.0, 45.0, 30.0, 80.0, 70.0, 58.0, -34.0, 21.0, 49.0, 28.0, 620.0, 58.0, 46.0, -4.0, 50.0, 40.0, 19.0, 110.0, 90.0, 89.0, 199.0, 0.0, 90.0, 158.0, 32.0, 20.0, 18.0, 100.0, 140.0, 38.0, 14.0, 110.0, 170.0, 67.0, 208.0, 88.0, 80.0, 50.0, 80.0, 80.0, 40.0, 244.0, 36.0, 44.0, 57.0, 20.0, 100.0, -120.0, 450.0, 150.0, 60.0, 57.0, 80.0, 120.0, 53.0, -16.0, 48.0, 10.0, 540.0, 60.0, 153.0, 13.0, 147.0, 60.0, 30.0, 170.0, -27.0, 60.0, 90.0, 90.0, 45.0, 100.0, 58.0, 90.0, 20.0, 40.0, 112.0, 38.0, 57.0, 70.0, 10.0, 26.0, -70.0, 386.0, 35.0, 16.0, 145.0, 27.0, 80.0, 40.0, 250.0, -193.0, 80.0, 9.0, 450.0, -22.0, 270.0, 20.0, 54.0, 70.0, 38.0, 20.0, 10.0, 9.0, -27.0, 60.0, 20.0, 100.0, 100.0, -5.0, 50.0, 100.0, 409.0, 40.0, 92.0, 50.0, 10.0, 77.0, 90.0, 66.0, 100.0, 210.0, 80.0, -4.0, 70.0, 55.0, 46.0, 20.0, 60.0, 19.0, 167.0, 100.0, 160.0, 100.0, 90.0, 80.0, 90.0, 170.0, -44.0, 200.0, 41.0, -40.0, 70.0, -34.0, 60.0, 40.0, 78.0, 60.0, 50.0, 20.0, -13.0, 80.0, 100.0, 30.0, 260.0, 230.0, 2.0, 164.0, 110.0, 60.0, 120.0, 170.0, 110.0, 67.0, 41.0, 60.0, 232.0, -20.0, 110.0, 7.0, 50.0, -10.0, -43.0, 80.0, 50.0, 160.0, 10.0, 166.0, 24.0, 59.0, -14.0, 120.0, 84.0, 320.0, 80.0, 50.0, 50.0, 27.0, 0.0, 80.0, 70.0, 120.0, 400.0, 90.0, 9.0, 120.0, 79.0, 90.0, 60.0, 60.0, 20.0, 15.0, 130.0, -14.0, 120.0, 3.0, 15.0, 168.0, 30.0, 16.0, 35.0, 17.0, 60.0, 55.0, 120.0, 60.0, 26.0, 14.0, 40.0, 30.0, 18.0, 70.0, 170.0, 100.0, 39.0, 5.0, 40.0, 50.0, 59.0, 29.0, 38.0, -34.0, 20.0, 50.0, -11.0, 8.0, 70.0, 120.0, 144.0, 19.0, 30.0, -110.0, 340.0, 48.0, 70.0, 20.0, 40.0, 60.0, -95.0, 133.0, 120.0, 0.0, 110.0, 100.0, 100.0, 20.0, 20.0, 710.0, 49.0, 146.0, 260.0, 14.0, 69.0, 130.0, 77.0, 78.0, 90.0, 110.0, 48.0, 68.0, 70.0, 30.0, 30.0, 208.0, 50.0, 50.0, 60.0, 80.0, 50.0, -10.0, 80.0, 40.0, 90.0, -6.0, 120.0, 260.0, 210.0, 150.0, 31.0, 100.0, 132.0, 20.0, 30.0, 20.0, 140.0, 60.0, 300.0, 120.0, 105.0, 60.0, 41.0, 60.0, 60.0, -10.0, 190.0, 200.0, 90.0, 120.0, -120.0, 70.0, 80.0, 23.0, 40.0, -94.0, 70.0, -48.0, -61.0, 189.0, 70.0, 70.0, 97.0, 64.0, 150.0, 25.0, 84.0, 25.0, 17.0, 100.0, 55.0, 350.0, 120.0, 120.0, 113.0, 77.0, 400.0, 100.0, 60.0, 70.0, 20.0, 165.0, -134.0, 50.0, -37.0, 75.0, 158.0, 40.0, 115.0, 36.0, 37.0, 30.0, 68.0, 30.0, -10.0, 80.0, 150.0, 60.0, 50.0, 15.0, 80.0, 80.0, 110.0, 70.0, 110.0, 70.0, 51.0, 120.0, 21.0, 80.0, 50.0, 20.0, 90.0, 43.0, 54.0, 128.0, -20.0, 74.0, 28.0, 220.0, 150.0, 19.0, 50.0, 207.0, 200.0, 40.0, 60.0, 58.0, 40.0, 67.0, 170.0, 60.0, 27.0, 120.0, 50.0, 70.0, 30.0, 78.0, 390.0, 89.0, 70.0, -22.0, 30.0, 70.0, 38.0, 39.0, 60.0, 269.0, 200.0, 29.0, 40.0, -70.0, 16.0, -120.0, 200.0, 36.0, 60.0, 297.0, 60.0, 60.0, 69.0, 330.0, 100.0, -12.0, 101.0, 8.0, 120.0, 54.0, 29.0, 90.0, 0.0, 10.0, 70.0, 37.0, 12.0, 50.0, 50.0, 135.0, 18.0, 30.0, 57.0, 5.0, 86.0, 37.0, 30.0, 140.0, 67.0, 90.0, 100.0, 60.0, 61.0, 130.0, 80.0, -64.0, 538.0, 27.0, -37.0, 90.0, 1.0, 55.0, 10.0, 70.0, 120.0, 100.0, 5.0, 350.0, 80.0, 110.0, 90.0, 80.0, 20.0, 190.0, -20.0, 30.0, -45.0, 120.0, 270.0, 100.0, 40.0, 60.0, 70.0, 40.0, 70.0, 180.0, 11.0, 22.0, 30.0, 20.0, 23.0, 3.0, 28.0, 60.0, 20.0, 23.0, 58.0, 80.0, 90.0, 42.0, -53.0, 20.0, 50.0, 30.0, 70.0, 86.0, 50.0, 109.0, 40.0, 120.0, 56.0, 160.0, 39.0, 60.0, 96.0, 77.0, 50.0, 49.0, 130.0, 220.0, 70.0, 60.0, 140.0, 150.0, 90.0, 80.0, 9.0, 79.0, 110.0, 100.0, 60.0, 50.0, 49.0, 40.0, 150.0, 50.0, 69.0, 68.0, 130.0, 160.0, 210.0, 48.0, 85.0, 57.0, 65.0, 69.0, 110.0, 50.0, 0.0, 169.0, 46.0, 65.0, 50.0, 290.0, 30.0, 0.0, 70.0, 100.0, 20.0, 220.0, 30.0, 80.0, 50.0, 99.0, 5.0, 37.0, 70.0, 45.0, 50.0, 60.0, 3.0, 227.0, 19.0, -10.0, 130.0, 150.0, -20.0, 50.0, 76.0, 180.0, 67.0, 50.0, -35.0, -3.0, 80.0, 28.0, -50.0, 53.0, 50.0, -12.0, 19.0, 110.0, 39.0, 120.0, 120.0, 270.0, -5.0, 40.0, 50.0, 60.0, 156.0, 58.0, 60.0, 70.0, -22.0, 25.0, 30.0, 100.0, 50.0, -11.0, 50.0, 70.0, 120.0, 35.0, 48.0, 10.0, 27.0, 180.0, 170.0, -10.0, 170.0, 79.0, 1.0, 58.0, 100.0, 75.0, 60.0, 19.0, 70.0, 80.0, 70.0, 69.0, 10.0, 90.0, 40.0, 79.0, 70.0, 130.0, 98.0, 100.0, 85.0, 120.0, 70.0, 50.0, 29.0, 145.0, 50.0, 60.0, 100.0, 130.0, 40.0, 70.0, 30.0, 60.0, 38.0, 39.0, 70.0, 110.0, 50.0, 300.0, 80.0, 160.0, 109.0, -320.0, 9.0, -10.0, 96.0, -27.0, 26.0, 50.0, 7.0, 160.0, 48.0, 217.0, 150.0, 100.0, 50.0, 50.0, 40.0, 60.0, 170.0, 60.0, 188.0, 60.0, 60.0, 50.0, 80.0, 49.0, 249.0, 30.0, 20.0, 47.0, 90.0, -12.0, 20.0, -18.0, 18.0, 18.0, 300.0, -230.0, 50.0, -16.0, 80.0, 18.0, -4.0, 53.0, 30.0, 170.0, 130.0, 40.0, 90.0, 50.0, 80.0, 118.0, 95.0, 15.0, 30.0, 40.0, 160.0, 50.0, -28.0, 67.0, 220.0, 130.0, 540.0, 25.0, 39.0, 4.0, 190.0, -41.0, 179.0, 38.0, 70.0, -22.0, 14.0, 149.0, 40.0, 180.0, 4.0, 18.0, 150.0, 50.0, 0.0, 210.0, 37.0, 60.0, 40.0, 35.0, 30.0, 75.0, 190.0, 57.0, 240.0, 50.0, 20.0, 20.0, 47.0, 36.0, 210.0, 120.0, 170.0, 41.0, 110.0, 130.0, 60.0, 32.0, 70.0, 130.0, 26.0, 60.0, 28.0, -3.0, 32.0, 79.0, 70.0, 80.0, 110.0, 70.0, 50.0, 7.0, 57.0, 65.0, 60.0, 60.0, 180.0, 24.0, -25.0, 130.0, 20.0, 50.0, 50.0, 30.0, 10.0, 10.0, 40.0, 20.0, 46.0, 120.0, 24.0, 10.0, 80.0, 110.0, 50.0, 20.0, 50.0, 15.0, 160.0, 70.0, 80.0, 50.0, 60.0, -18.0, -20.0, -1.0, 80.0, 61.0, 68.0, 77.0, -6.0, 30.0, 24.0, -3.0, 169.0, 40.0, -4.0, 300.0, 20.0, 40.0, 250.0, 90.0, 110.0, -40.0, 50.0, 70.0, 360.0, 63.0, 61.0, 150.0, 120.0, 74.0, 100.0, 70.0, 90.0, 138.0, 40.0, 40.0, 60.0, 50.0, 49.0, 110.0, 160.0, 50.0, 70.0, 10.0, 50.0, 70.0, 190.0, 27.0, 80.0, 74.0, 78.0, 18.0, 100.0, 50.0, 20.0, 80.0, 70.0, 68.0, 170.0, 130.0, 39.0, 140.0, 31.0, 90.0, 86.0, 70.0, 30.0, -80.0, 30.0, 319.0, 10.0, 87.0, 70.0, 40.0, 130.0, 8.0, 11.0, 210.0, 50.0, 57.0, 245.0, -45.0, 81.0, 60.0, 69.0, 100.0, 50.0, 270.0, 36.0, 80.0, 60.0, -26.0, 60.0, 40.0, 29.0, 60.0, 39.0, 20.0, 30.0, 18.0, 70.0, 70.0, 150.0, 40.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1279718663800375, "mean_inference_ms": 2.4532077403757975, "mean_action_processing_ms": 0.8235782851055644, "mean_env_wait_ms": 1.7057468520487231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0843505859375, "StateBufferConnector_ms": 0.01241445541381836, "ViewRequirementAgentConnector_ms": 0.5344362258911133}, "num_episodes": 18, "episode_return_max": 1515.0, "episode_return_min": -234.0, "episode_return_mean": 738.1, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.10411023387478, "num_env_steps_trained_throughput_per_sec": 33.10411023387478, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 122331.56, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122331.507, "sample_time_ms": 3346.26, "learn_time_ms": 118962.73, "learn_throughput": 33.624, "synch_weights_time_ms": 12.997}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 62, "trial_id": "6085c_00000", "date": "2024-07-02_01-04-04", "timestamp": 1719896644, "time_this_iter_s": 120.84318590164185, "time_total_s": 9491.476591348648, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13800f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9491.476591348648, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 28.492397660818717, "ram_util_percent": 80.08713450292399}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.827500791595386, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.434801041051602, "policy_loss": -0.006628415328316605, "vf_loss": 7.440355939529955, "vf_explained_var": 0.0014045634526160325, "kl": 0.010735243366856401, "entropy": 1.0672005000904092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 586875.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": 216.0, "episode_reward_mean": 726.16, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 72.616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.0, 1156.0, 827.0, 482.0, 881.0, 1048.0, 518.0, 440.0, 600.0, 416.0, 626.0, 1515.0, 754.0, 628.0, 1127.0, 896.0, 740.0, 356.0, 990.0, 991.0, 572.0, 645.0, 682.0, 746.0, 929.0, 905.0, 691.0, 1092.0, 470.0, 480.0, 795.0, 810.0, 1005.0, 755.0, 397.0, 410.0, 816.0, 1036.0, 727.0, 942.0, 879.0, 674.0, 631.0, 595.0, 477.0, 737.0, 517.0, 785.0, 583.0, 831.0, 723.0, 607.0, 717.0, 838.0, 623.0, 216.0, 856.0, 1224.0, 496.0, 838.0, 797.0, 944.0, 524.0, 739.0, 339.0, 530.0, 476.0, 456.0, 1250.0, 906.0, 649.0, 707.0, 904.0, 706.0, 746.0, 699.0, 537.0, 737.0, 360.0, 733.0, 527.0, 792.0, 1115.0, 867.0, 1201.0, 554.0, 475.0, 663.0, 680.0, 766.0, 828.0, 318.0, 551.0, 532.0, 555.0, 942.0, 747.0, 1360.0, 530.0, 840.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-40.0, 70.0, -34.0, 60.0, 40.0, 78.0, 60.0, 50.0, 20.0, -13.0, 80.0, 100.0, 30.0, 260.0, 230.0, 2.0, 164.0, 110.0, 60.0, 120.0, 170.0, 110.0, 67.0, 41.0, 60.0, 232.0, -20.0, 110.0, 7.0, 50.0, -10.0, -43.0, 80.0, 50.0, 160.0, 10.0, 166.0, 24.0, 59.0, -14.0, 120.0, 84.0, 320.0, 80.0, 50.0, 50.0, 27.0, 0.0, 80.0, 70.0, 120.0, 400.0, 90.0, 9.0, 120.0, 79.0, 90.0, 60.0, 60.0, 20.0, 15.0, 130.0, -14.0, 120.0, 3.0, 15.0, 168.0, 30.0, 16.0, 35.0, 17.0, 60.0, 55.0, 120.0, 60.0, 26.0, 14.0, 40.0, 30.0, 18.0, 70.0, 170.0, 100.0, 39.0, 5.0, 40.0, 50.0, 59.0, 29.0, 38.0, -34.0, 20.0, 50.0, -11.0, 8.0, 70.0, 120.0, 144.0, 19.0, 30.0, -110.0, 340.0, 48.0, 70.0, 20.0, 40.0, 60.0, -95.0, 133.0, 120.0, 0.0, 110.0, 100.0, 100.0, 20.0, 20.0, 710.0, 49.0, 146.0, 260.0, 14.0, 69.0, 130.0, 77.0, 78.0, 90.0, 110.0, 48.0, 68.0, 70.0, 30.0, 30.0, 208.0, 50.0, 50.0, 60.0, 80.0, 50.0, -10.0, 80.0, 40.0, 90.0, -6.0, 120.0, 260.0, 210.0, 150.0, 31.0, 100.0, 132.0, 20.0, 30.0, 20.0, 140.0, 60.0, 300.0, 120.0, 105.0, 60.0, 41.0, 60.0, 60.0, -10.0, 190.0, 200.0, 90.0, 120.0, -120.0, 70.0, 80.0, 23.0, 40.0, -94.0, 70.0, -48.0, -61.0, 189.0, 70.0, 70.0, 97.0, 64.0, 150.0, 25.0, 84.0, 25.0, 17.0, 100.0, 55.0, 350.0, 120.0, 120.0, 113.0, 77.0, 400.0, 100.0, 60.0, 70.0, 20.0, 165.0, -134.0, 50.0, -37.0, 75.0, 158.0, 40.0, 115.0, 36.0, 37.0, 30.0, 68.0, 30.0, -10.0, 80.0, 150.0, 60.0, 50.0, 15.0, 80.0, 80.0, 110.0, 70.0, 110.0, 70.0, 51.0, 120.0, 21.0, 80.0, 50.0, 20.0, 90.0, 43.0, 54.0, 128.0, -20.0, 74.0, 28.0, 220.0, 150.0, 19.0, 50.0, 207.0, 200.0, 40.0, 60.0, 58.0, 40.0, 67.0, 170.0, 60.0, 27.0, 120.0, 50.0, 70.0, 30.0, 78.0, 390.0, 89.0, 70.0, -22.0, 30.0, 70.0, 38.0, 39.0, 60.0, 269.0, 200.0, 29.0, 40.0, -70.0, 16.0, -120.0, 200.0, 36.0, 60.0, 297.0, 60.0, 60.0, 69.0, 330.0, 100.0, -12.0, 101.0, 8.0, 120.0, 54.0, 29.0, 90.0, 0.0, 10.0, 70.0, 37.0, 12.0, 50.0, 50.0, 135.0, 18.0, 30.0, 57.0, 5.0, 86.0, 37.0, 30.0, 140.0, 67.0, 90.0, 100.0, 60.0, 61.0, 130.0, 80.0, -64.0, 538.0, 27.0, -37.0, 90.0, 1.0, 55.0, 10.0, 70.0, 120.0, 100.0, 5.0, 350.0, 80.0, 110.0, 90.0, 80.0, 20.0, 190.0, -20.0, 30.0, -45.0, 120.0, 270.0, 100.0, 40.0, 60.0, 70.0, 40.0, 70.0, 180.0, 11.0, 22.0, 30.0, 20.0, 23.0, 3.0, 28.0, 60.0, 20.0, 23.0, 58.0, 80.0, 90.0, 42.0, -53.0, 20.0, 50.0, 30.0, 70.0, 86.0, 50.0, 109.0, 40.0, 120.0, 56.0, 160.0, 39.0, 60.0, 96.0, 77.0, 50.0, 49.0, 130.0, 220.0, 70.0, 60.0, 140.0, 150.0, 90.0, 80.0, 9.0, 79.0, 110.0, 100.0, 60.0, 50.0, 49.0, 40.0, 150.0, 50.0, 69.0, 68.0, 130.0, 160.0, 210.0, 48.0, 85.0, 57.0, 65.0, 69.0, 110.0, 50.0, 0.0, 169.0, 46.0, 65.0, 50.0, 290.0, 30.0, 0.0, 70.0, 100.0, 20.0, 220.0, 30.0, 80.0, 50.0, 99.0, 5.0, 37.0, 70.0, 45.0, 50.0, 60.0, 3.0, 227.0, 19.0, -10.0, 130.0, 150.0, -20.0, 50.0, 76.0, 180.0, 67.0, 50.0, -35.0, -3.0, 80.0, 28.0, -50.0, 53.0, 50.0, -12.0, 19.0, 110.0, 39.0, 120.0, 120.0, 270.0, -5.0, 40.0, 50.0, 60.0, 156.0, 58.0, 60.0, 70.0, -22.0, 25.0, 30.0, 100.0, 50.0, -11.0, 50.0, 70.0, 120.0, 35.0, 48.0, 10.0, 27.0, 180.0, 170.0, -10.0, 170.0, 79.0, 1.0, 58.0, 100.0, 75.0, 60.0, 19.0, 70.0, 80.0, 70.0, 69.0, 10.0, 90.0, 40.0, 79.0, 70.0, 130.0, 98.0, 100.0, 85.0, 120.0, 70.0, 50.0, 29.0, 145.0, 50.0, 60.0, 100.0, 130.0, 40.0, 70.0, 30.0, 60.0, 38.0, 39.0, 70.0, 110.0, 50.0, 300.0, 80.0, 160.0, 109.0, -320.0, 9.0, -10.0, 96.0, -27.0, 26.0, 50.0, 7.0, 160.0, 48.0, 217.0, 150.0, 100.0, 50.0, 50.0, 40.0, 60.0, 170.0, 60.0, 188.0, 60.0, 60.0, 50.0, 80.0, 49.0, 249.0, 30.0, 20.0, 47.0, 90.0, -12.0, 20.0, -18.0, 18.0, 18.0, 300.0, -230.0, 50.0, -16.0, 80.0, 18.0, -4.0, 53.0, 30.0, 170.0, 130.0, 40.0, 90.0, 50.0, 80.0, 118.0, 95.0, 15.0, 30.0, 40.0, 160.0, 50.0, -28.0, 67.0, 220.0, 130.0, 540.0, 25.0, 39.0, 4.0, 190.0, -41.0, 179.0, 38.0, 70.0, -22.0, 14.0, 149.0, 40.0, 180.0, 4.0, 18.0, 150.0, 50.0, 0.0, 210.0, 37.0, 60.0, 40.0, 35.0, 30.0, 75.0, 190.0, 57.0, 240.0, 50.0, 20.0, 20.0, 47.0, 36.0, 210.0, 120.0, 170.0, 41.0, 110.0, 130.0, 60.0, 32.0, 70.0, 130.0, 26.0, 60.0, 28.0, -3.0, 32.0, 79.0, 70.0, 80.0, 110.0, 70.0, 50.0, 7.0, 57.0, 65.0, 60.0, 60.0, 180.0, 24.0, -25.0, 130.0, 20.0, 50.0, 50.0, 30.0, 10.0, 10.0, 40.0, 20.0, 46.0, 120.0, 24.0, 10.0, 80.0, 110.0, 50.0, 20.0, 50.0, 15.0, 160.0, 70.0, 80.0, 50.0, 60.0, -18.0, -20.0, -1.0, 80.0, 61.0, 68.0, 77.0, -6.0, 30.0, 24.0, -3.0, 169.0, 40.0, -4.0, 300.0, 20.0, 40.0, 250.0, 90.0, 110.0, -40.0, 50.0, 70.0, 360.0, 63.0, 61.0, 150.0, 120.0, 74.0, 100.0, 70.0, 90.0, 138.0, 40.0, 40.0, 60.0, 50.0, 49.0, 110.0, 160.0, 50.0, 70.0, 10.0, 50.0, 70.0, 190.0, 27.0, 80.0, 74.0, 78.0, 18.0, 100.0, 50.0, 20.0, 80.0, 70.0, 68.0, 170.0, 130.0, 39.0, 140.0, 31.0, 90.0, 86.0, 70.0, 30.0, -80.0, 30.0, 319.0, 10.0, 87.0, 70.0, 40.0, 130.0, 8.0, 11.0, 210.0, 50.0, 57.0, 245.0, -45.0, 81.0, 60.0, 69.0, 100.0, 50.0, 270.0, 36.0, 80.0, 60.0, -26.0, 60.0, 40.0, 29.0, 60.0, 39.0, 20.0, 30.0, 18.0, 70.0, 70.0, 150.0, 40.0, 40.0, 180.0, 50.0, 68.0, 79.0, 10.0, 80.0, 30.0, 40.0, 120.0, 80.0, 40.0, 30.0, 60.0, 100.0, 110.0, 20.0, -60.0, 0.0, 40.0, 20.0, 19.0, 110.0, 120.0, 65.0, 100.0, 79.0, 70.0, 100.0, -10.0, 80.0, 159.0, 70.0, 40.0, 50.0, 19.0, 43.0, 50.0, 16.0, 50.0, 30.0, 75.0, 74.0, 170.0, 100.0, 60.0, -25.0, 100.0, 59.0, 79.0, 100.0, 47.0, 460.0, 90.0, 20.0, 0.0, 70.0, 58.0, 90.0, 220.0, 60.0, 30.0, 200.0, 70.0, 40.0, -10.0, 5.0, 45.0, 57.0, 100.0, 330.0, 300.0, 90.0, 90.0, 77.0, 75.0, 50.0, 90.0, 250.0, 179.0, 0.0, 70.0, 6.0, 48.0, 60.0, 70.0, 80.0, 40.0, 55.0, 80.0, 45.0, 13.0, 110.0, 80.0, 30.0, 40.0, -5.0, 20.0, 60.0, 70.0, 57.0, 30.0, 50.0, 100.0, 62.0, 111.0, 50.0, 73.0, 49.0, 40.0, 98.0, 97.0, 79.0, 67.0, 9.0, 39.0, 60.0, 60.0, 59.0, 80.0, 130.0, 110.0, 50.0, 242.0, 12.0, 120.0, 50.0, 100.0, 10.0, 60.0, 12.0, 110.0, 56.0, 80.0, 74.0, 18.0, 110.0, 80.0, 0.0, 140.0, 160.0, -127.0, 60.0, -3.0, 190.0, -76.0, 34.0, 100.0, 40.0, 10.0, 90.0, 70.0, 20.0, 180.0, 100.0, 30.0, 200.0, -240.0, -22.0, 33.0, 180.0, 70.0, 15.0, 50.0, 40.0, 67.0, 50.0, 25.0, 70.0, 95.0, 50.0, 30.0, 70.0, 28.0, 37.0, 70.0, 50.0, 80.0, 80.0, 60.0, 50.0, 370.0, 125.0, 70.0, 55.0, 20.0, 60.0, 35.0, 20.0, 99.0, 88.0, 36.0, 210.0, -32.0, 309.0, 70.0, 50.0, -27.0, 60.0, 130.0, -59.0, 490.0, 392.0, 50.0, 90.0, -70.0, 200.0, 10.0, 90.0, 48.0, 60.0, 82.0, 60.0, 70.0, 37.0, 110.0, 30.0, -3.0, 30.0, 50.0, 64.0, 130.0, 70.0, 30.0, 60.0, 30.0, 190.0, 60.0, 80.0, 160.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1223560706041518, "mean_inference_ms": 2.446841493072496, "mean_action_processing_ms": 0.8213091783556331, "mean_env_wait_ms": 1.7010763553879216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08586788177490234, "StateBufferConnector_ms": 0.012677192687988281, "ViewRequirementAgentConnector_ms": 0.539362907409668}, "num_episodes": 23, "episode_return_max": 1515.0, "episode_return_min": 216.0, "episode_return_mean": 726.16, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.95548555960169, "num_env_steps_trained_throughput_per_sec": 32.95548555960169, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 2520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2520000, "timers": {"training_iteration_time_ms": 122385.432, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122385.379, "sample_time_ms": 3308.449, "learn_time_ms": 119054.229, "learn_throughput": 33.598, "synch_weights_time_ms": 12.917}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "done": false, "training_iteration": 63, "trial_id": "6085c_00000", "date": "2024-07-02_01-06-05", "timestamp": 1719896765, "time_this_iter_s": 121.38511514663696, "time_total_s": 9612.861706495285, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9612.861706495285, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 28.187209302325584, "ram_util_percent": 79.33313953488371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3361587626738545, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.317196519788716, "policy_loss": -0.007523633497449767, "vf_loss": 7.32318978588929, "vf_explained_var": 0.004746517586631897, "kl": 0.015303685530153686, "entropy": 1.1012106182539678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 596265.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 1676.0, "episode_reward_min": 216.0, "episode_reward_mean": 738.87, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 73.887}, "custom_metrics": {}, "hist_stats": {"episode_reward": [990.0, 991.0, 572.0, 645.0, 682.0, 746.0, 929.0, 905.0, 691.0, 1092.0, 470.0, 480.0, 795.0, 810.0, 1005.0, 755.0, 397.0, 410.0, 816.0, 1036.0, 727.0, 942.0, 879.0, 674.0, 631.0, 595.0, 477.0, 737.0, 517.0, 785.0, 583.0, 831.0, 723.0, 607.0, 717.0, 838.0, 623.0, 216.0, 856.0, 1224.0, 496.0, 838.0, 797.0, 944.0, 524.0, 739.0, 339.0, 530.0, 476.0, 456.0, 1250.0, 906.0, 649.0, 707.0, 904.0, 706.0, 746.0, 699.0, 537.0, 737.0, 360.0, 733.0, 527.0, 792.0, 1115.0, 867.0, 1201.0, 554.0, 475.0, 663.0, 680.0, 766.0, 828.0, 318.0, 551.0, 532.0, 555.0, 942.0, 747.0, 1360.0, 530.0, 840.0, 781.0, 352.0, 1007.0, 947.0, 1676.0, 820.0, 540.0, 848.0, 1141.0, 419.0, 696.0, 625.0, 1465.0, 730.0, 692.0, 688.0, 530.0, 615.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [64.0, 150.0, 25.0, 84.0, 25.0, 17.0, 100.0, 55.0, 350.0, 120.0, 120.0, 113.0, 77.0, 400.0, 100.0, 60.0, 70.0, 20.0, 165.0, -134.0, 50.0, -37.0, 75.0, 158.0, 40.0, 115.0, 36.0, 37.0, 30.0, 68.0, 30.0, -10.0, 80.0, 150.0, 60.0, 50.0, 15.0, 80.0, 80.0, 110.0, 70.0, 110.0, 70.0, 51.0, 120.0, 21.0, 80.0, 50.0, 20.0, 90.0, 43.0, 54.0, 128.0, -20.0, 74.0, 28.0, 220.0, 150.0, 19.0, 50.0, 207.0, 200.0, 40.0, 60.0, 58.0, 40.0, 67.0, 170.0, 60.0, 27.0, 120.0, 50.0, 70.0, 30.0, 78.0, 390.0, 89.0, 70.0, -22.0, 30.0, 70.0, 38.0, 39.0, 60.0, 269.0, 200.0, 29.0, 40.0, -70.0, 16.0, -120.0, 200.0, 36.0, 60.0, 297.0, 60.0, 60.0, 69.0, 330.0, 100.0, -12.0, 101.0, 8.0, 120.0, 54.0, 29.0, 90.0, 0.0, 10.0, 70.0, 37.0, 12.0, 50.0, 50.0, 135.0, 18.0, 30.0, 57.0, 5.0, 86.0, 37.0, 30.0, 140.0, 67.0, 90.0, 100.0, 60.0, 61.0, 130.0, 80.0, -64.0, 538.0, 27.0, -37.0, 90.0, 1.0, 55.0, 10.0, 70.0, 120.0, 100.0, 5.0, 350.0, 80.0, 110.0, 90.0, 80.0, 20.0, 190.0, -20.0, 30.0, -45.0, 120.0, 270.0, 100.0, 40.0, 60.0, 70.0, 40.0, 70.0, 180.0, 11.0, 22.0, 30.0, 20.0, 23.0, 3.0, 28.0, 60.0, 20.0, 23.0, 58.0, 80.0, 90.0, 42.0, -53.0, 20.0, 50.0, 30.0, 70.0, 86.0, 50.0, 109.0, 40.0, 120.0, 56.0, 160.0, 39.0, 60.0, 96.0, 77.0, 50.0, 49.0, 130.0, 220.0, 70.0, 60.0, 140.0, 150.0, 90.0, 80.0, 9.0, 79.0, 110.0, 100.0, 60.0, 50.0, 49.0, 40.0, 150.0, 50.0, 69.0, 68.0, 130.0, 160.0, 210.0, 48.0, 85.0, 57.0, 65.0, 69.0, 110.0, 50.0, 0.0, 169.0, 46.0, 65.0, 50.0, 290.0, 30.0, 0.0, 70.0, 100.0, 20.0, 220.0, 30.0, 80.0, 50.0, 99.0, 5.0, 37.0, 70.0, 45.0, 50.0, 60.0, 3.0, 227.0, 19.0, -10.0, 130.0, 150.0, -20.0, 50.0, 76.0, 180.0, 67.0, 50.0, -35.0, -3.0, 80.0, 28.0, -50.0, 53.0, 50.0, -12.0, 19.0, 110.0, 39.0, 120.0, 120.0, 270.0, -5.0, 40.0, 50.0, 60.0, 156.0, 58.0, 60.0, 70.0, -22.0, 25.0, 30.0, 100.0, 50.0, -11.0, 50.0, 70.0, 120.0, 35.0, 48.0, 10.0, 27.0, 180.0, 170.0, -10.0, 170.0, 79.0, 1.0, 58.0, 100.0, 75.0, 60.0, 19.0, 70.0, 80.0, 70.0, 69.0, 10.0, 90.0, 40.0, 79.0, 70.0, 130.0, 98.0, 100.0, 85.0, 120.0, 70.0, 50.0, 29.0, 145.0, 50.0, 60.0, 100.0, 130.0, 40.0, 70.0, 30.0, 60.0, 38.0, 39.0, 70.0, 110.0, 50.0, 300.0, 80.0, 160.0, 109.0, -320.0, 9.0, -10.0, 96.0, -27.0, 26.0, 50.0, 7.0, 160.0, 48.0, 217.0, 150.0, 100.0, 50.0, 50.0, 40.0, 60.0, 170.0, 60.0, 188.0, 60.0, 60.0, 50.0, 80.0, 49.0, 249.0, 30.0, 20.0, 47.0, 90.0, -12.0, 20.0, -18.0, 18.0, 18.0, 300.0, -230.0, 50.0, -16.0, 80.0, 18.0, -4.0, 53.0, 30.0, 170.0, 130.0, 40.0, 90.0, 50.0, 80.0, 118.0, 95.0, 15.0, 30.0, 40.0, 160.0, 50.0, -28.0, 67.0, 220.0, 130.0, 540.0, 25.0, 39.0, 4.0, 190.0, -41.0, 179.0, 38.0, 70.0, -22.0, 14.0, 149.0, 40.0, 180.0, 4.0, 18.0, 150.0, 50.0, 0.0, 210.0, 37.0, 60.0, 40.0, 35.0, 30.0, 75.0, 190.0, 57.0, 240.0, 50.0, 20.0, 20.0, 47.0, 36.0, 210.0, 120.0, 170.0, 41.0, 110.0, 130.0, 60.0, 32.0, 70.0, 130.0, 26.0, 60.0, 28.0, -3.0, 32.0, 79.0, 70.0, 80.0, 110.0, 70.0, 50.0, 7.0, 57.0, 65.0, 60.0, 60.0, 180.0, 24.0, -25.0, 130.0, 20.0, 50.0, 50.0, 30.0, 10.0, 10.0, 40.0, 20.0, 46.0, 120.0, 24.0, 10.0, 80.0, 110.0, 50.0, 20.0, 50.0, 15.0, 160.0, 70.0, 80.0, 50.0, 60.0, -18.0, -20.0, -1.0, 80.0, 61.0, 68.0, 77.0, -6.0, 30.0, 24.0, -3.0, 169.0, 40.0, -4.0, 300.0, 20.0, 40.0, 250.0, 90.0, 110.0, -40.0, 50.0, 70.0, 360.0, 63.0, 61.0, 150.0, 120.0, 74.0, 100.0, 70.0, 90.0, 138.0, 40.0, 40.0, 60.0, 50.0, 49.0, 110.0, 160.0, 50.0, 70.0, 10.0, 50.0, 70.0, 190.0, 27.0, 80.0, 74.0, 78.0, 18.0, 100.0, 50.0, 20.0, 80.0, 70.0, 68.0, 170.0, 130.0, 39.0, 140.0, 31.0, 90.0, 86.0, 70.0, 30.0, -80.0, 30.0, 319.0, 10.0, 87.0, 70.0, 40.0, 130.0, 8.0, 11.0, 210.0, 50.0, 57.0, 245.0, -45.0, 81.0, 60.0, 69.0, 100.0, 50.0, 270.0, 36.0, 80.0, 60.0, -26.0, 60.0, 40.0, 29.0, 60.0, 39.0, 20.0, 30.0, 18.0, 70.0, 70.0, 150.0, 40.0, 40.0, 180.0, 50.0, 68.0, 79.0, 10.0, 80.0, 30.0, 40.0, 120.0, 80.0, 40.0, 30.0, 60.0, 100.0, 110.0, 20.0, -60.0, 0.0, 40.0, 20.0, 19.0, 110.0, 120.0, 65.0, 100.0, 79.0, 70.0, 100.0, -10.0, 80.0, 159.0, 70.0, 40.0, 50.0, 19.0, 43.0, 50.0, 16.0, 50.0, 30.0, 75.0, 74.0, 170.0, 100.0, 60.0, -25.0, 100.0, 59.0, 79.0, 100.0, 47.0, 460.0, 90.0, 20.0, 0.0, 70.0, 58.0, 90.0, 220.0, 60.0, 30.0, 200.0, 70.0, 40.0, -10.0, 5.0, 45.0, 57.0, 100.0, 330.0, 300.0, 90.0, 90.0, 77.0, 75.0, 50.0, 90.0, 250.0, 179.0, 0.0, 70.0, 6.0, 48.0, 60.0, 70.0, 80.0, 40.0, 55.0, 80.0, 45.0, 13.0, 110.0, 80.0, 30.0, 40.0, -5.0, 20.0, 60.0, 70.0, 57.0, 30.0, 50.0, 100.0, 62.0, 111.0, 50.0, 73.0, 49.0, 40.0, 98.0, 97.0, 79.0, 67.0, 9.0, 39.0, 60.0, 60.0, 59.0, 80.0, 130.0, 110.0, 50.0, 242.0, 12.0, 120.0, 50.0, 100.0, 10.0, 60.0, 12.0, 110.0, 56.0, 80.0, 74.0, 18.0, 110.0, 80.0, 0.0, 140.0, 160.0, -127.0, 60.0, -3.0, 190.0, -76.0, 34.0, 100.0, 40.0, 10.0, 90.0, 70.0, 20.0, 180.0, 100.0, 30.0, 200.0, -240.0, -22.0, 33.0, 180.0, 70.0, 15.0, 50.0, 40.0, 67.0, 50.0, 25.0, 70.0, 95.0, 50.0, 30.0, 70.0, 28.0, 37.0, 70.0, 50.0, 80.0, 80.0, 60.0, 50.0, 370.0, 125.0, 70.0, 55.0, 20.0, 60.0, 35.0, 20.0, 99.0, 88.0, 36.0, 210.0, -32.0, 309.0, 70.0, 50.0, -27.0, 60.0, 130.0, -59.0, 490.0, 392.0, 50.0, 90.0, -70.0, 200.0, 10.0, 90.0, 48.0, 60.0, 82.0, 60.0, 70.0, 37.0, 110.0, 30.0, -3.0, 30.0, 50.0, 64.0, 130.0, 70.0, 30.0, 60.0, 30.0, 190.0, 60.0, 80.0, 160.0, 30.0, 60.0, 80.0, 189.0, 90.0, 70.0, 203.0, -198.0, 139.0, 68.0, 80.0, -131.0, -200.0, 90.0, 540.0, 36.0, 47.0, 27.0, 40.0, 17.0, -114.0, 130.0, 80.0, 130.0, 120.0, 50.0, 79.0, 29.0, 270.0, 89.0, 30.0, 90.0, 50.0, 30.0, 78.0, 187.0, 72.0, 40.0, 50.0, 280.0, 70.0, 460.0, 538.0, 90.0, 60.0, 88.0, -10.0, 100.0, 100.0, 70.0, 180.0, 95.0, -122.0, 39.0, 50.0, -61.0, 50.0, 42.0, 63.0, 424.0, 240.0, 36.0, 40.0, 160.0, 70.0, 60.0, 50.0, -5.0, -7.0, -14.0, 150.0, 110.0, 80.0, 153.0, 10.0, 480.0, 210.0, 29.0, -86.0, 28.0, -166.0, 264.0, 142.0, 20.0, 70.0, 30.0, 358.0, 0.0, 130.0, 40.0, 87.0, 150.0, 50.0, 30.0, 60.0, -20.0, 20.0, 100.0, -51.0, 50.0, 30.0, 80.0, 56.0, 79.0, 84.0, 49.0, 38.0, 10.0, 150.0, 110.0, 40.0, 60.0, 59.0, 49.0, 70.0, -7.0, 107.0, 67.0, 52.0, 160.0, 8.0, 190.0, 170.0, 28.0, 0.0, 880.0, 110.0, 49.0, -70.0, 100.0, 8.0, 19.0, 42.0, 180.0, 26.0, 68.0, 29.0, 70.0, 96.0, 120.0, 80.0, 80.0, 70.0, 10.0, 63.0, 100.0, 9.0, 89.0, 74.0, 30.0, 167.0, 60.0, 50.0, -5.0, 110.0, 37.0, 170.0, 100.0, 60.0, 36.0, 70.0, 3.0, 20.0, 50.0, 30.0, 60.0, 50.0, 41.0, 20.0, 36.0, 220.0, 269.0, 29.0, 40.0, 25.0, 10.0, 67.0, 70.0, -35.0, 100.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1168011255673234, "mean_inference_ms": 2.440609000324116, "mean_action_processing_ms": 0.8190785170473971, "mean_env_wait_ms": 1.6966998779766636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08208727836608887, "StateBufferConnector_ms": 0.012083768844604492, "ViewRequirementAgentConnector_ms": 0.5196685791015625}, "num_episodes": 18, "episode_return_max": 1676.0, "episode_return_min": 216.0, "episode_return_mean": 738.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.56657560268421, "num_env_steps_trained_throughput_per_sec": 32.56657560268421, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 122515.516, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122515.463, "sample_time_ms": 3284.321, "learn_time_ms": 119209.849, "learn_throughput": 33.554, "synch_weights_time_ms": 12.942}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 64, "trial_id": "6085c_00000", "date": "2024-07-02_01-08-08", "timestamp": 1719896888, "time_this_iter_s": 122.83797788619995, "time_total_s": 9735.699684381485, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9735.699684381485, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 28.455491329479763, "ram_util_percent": 79.60809248554914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.444358204233761, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.520749593009583, "policy_loss": -0.007325962553801525, "vf_loss": 7.526803828961552, "vf_explained_var": 0.006004105633694016, "kl": 0.012717246046400796, "entropy": 1.0648024806326317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 605655.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "env_runners": {"episode_reward_max": 1676.0, "episode_reward_min": 216.0, "episode_reward_mean": 739.99, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -446.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 73.999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [816.0, 1036.0, 727.0, 942.0, 879.0, 674.0, 631.0, 595.0, 477.0, 737.0, 517.0, 785.0, 583.0, 831.0, 723.0, 607.0, 717.0, 838.0, 623.0, 216.0, 856.0, 1224.0, 496.0, 838.0, 797.0, 944.0, 524.0, 739.0, 339.0, 530.0, 476.0, 456.0, 1250.0, 906.0, 649.0, 707.0, 904.0, 706.0, 746.0, 699.0, 537.0, 737.0, 360.0, 733.0, 527.0, 792.0, 1115.0, 867.0, 1201.0, 554.0, 475.0, 663.0, 680.0, 766.0, 828.0, 318.0, 551.0, 532.0, 555.0, 942.0, 747.0, 1360.0, 530.0, 840.0, 781.0, 352.0, 1007.0, 947.0, 1676.0, 820.0, 540.0, 848.0, 1141.0, 419.0, 696.0, 625.0, 1465.0, 730.0, 692.0, 688.0, 530.0, 615.0, 1001.0, 468.0, 870.0, 929.0, 574.0, 339.0, 808.0, 520.0, 1018.0, 1052.0, 530.0, 358.0, 657.0, 1097.0, 734.0, 850.0, 838.0, 834.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [86.0, 50.0, 109.0, 40.0, 120.0, 56.0, 160.0, 39.0, 60.0, 96.0, 77.0, 50.0, 49.0, 130.0, 220.0, 70.0, 60.0, 140.0, 150.0, 90.0, 80.0, 9.0, 79.0, 110.0, 100.0, 60.0, 50.0, 49.0, 40.0, 150.0, 50.0, 69.0, 68.0, 130.0, 160.0, 210.0, 48.0, 85.0, 57.0, 65.0, 69.0, 110.0, 50.0, 0.0, 169.0, 46.0, 65.0, 50.0, 290.0, 30.0, 0.0, 70.0, 100.0, 20.0, 220.0, 30.0, 80.0, 50.0, 99.0, 5.0, 37.0, 70.0, 45.0, 50.0, 60.0, 3.0, 227.0, 19.0, -10.0, 130.0, 150.0, -20.0, 50.0, 76.0, 180.0, 67.0, 50.0, -35.0, -3.0, 80.0, 28.0, -50.0, 53.0, 50.0, -12.0, 19.0, 110.0, 39.0, 120.0, 120.0, 270.0, -5.0, 40.0, 50.0, 60.0, 156.0, 58.0, 60.0, 70.0, -22.0, 25.0, 30.0, 100.0, 50.0, -11.0, 50.0, 70.0, 120.0, 35.0, 48.0, 10.0, 27.0, 180.0, 170.0, -10.0, 170.0, 79.0, 1.0, 58.0, 100.0, 75.0, 60.0, 19.0, 70.0, 80.0, 70.0, 69.0, 10.0, 90.0, 40.0, 79.0, 70.0, 130.0, 98.0, 100.0, 85.0, 120.0, 70.0, 50.0, 29.0, 145.0, 50.0, 60.0, 100.0, 130.0, 40.0, 70.0, 30.0, 60.0, 38.0, 39.0, 70.0, 110.0, 50.0, 300.0, 80.0, 160.0, 109.0, -320.0, 9.0, -10.0, 96.0, -27.0, 26.0, 50.0, 7.0, 160.0, 48.0, 217.0, 150.0, 100.0, 50.0, 50.0, 40.0, 60.0, 170.0, 60.0, 188.0, 60.0, 60.0, 50.0, 80.0, 49.0, 249.0, 30.0, 20.0, 47.0, 90.0, -12.0, 20.0, -18.0, 18.0, 18.0, 300.0, -230.0, 50.0, -16.0, 80.0, 18.0, -4.0, 53.0, 30.0, 170.0, 130.0, 40.0, 90.0, 50.0, 80.0, 118.0, 95.0, 15.0, 30.0, 40.0, 160.0, 50.0, -28.0, 67.0, 220.0, 130.0, 540.0, 25.0, 39.0, 4.0, 190.0, -41.0, 179.0, 38.0, 70.0, -22.0, 14.0, 149.0, 40.0, 180.0, 4.0, 18.0, 150.0, 50.0, 0.0, 210.0, 37.0, 60.0, 40.0, 35.0, 30.0, 75.0, 190.0, 57.0, 240.0, 50.0, 20.0, 20.0, 47.0, 36.0, 210.0, 120.0, 170.0, 41.0, 110.0, 130.0, 60.0, 32.0, 70.0, 130.0, 26.0, 60.0, 28.0, -3.0, 32.0, 79.0, 70.0, 80.0, 110.0, 70.0, 50.0, 7.0, 57.0, 65.0, 60.0, 60.0, 180.0, 24.0, -25.0, 130.0, 20.0, 50.0, 50.0, 30.0, 10.0, 10.0, 40.0, 20.0, 46.0, 120.0, 24.0, 10.0, 80.0, 110.0, 50.0, 20.0, 50.0, 15.0, 160.0, 70.0, 80.0, 50.0, 60.0, -18.0, -20.0, -1.0, 80.0, 61.0, 68.0, 77.0, -6.0, 30.0, 24.0, -3.0, 169.0, 40.0, -4.0, 300.0, 20.0, 40.0, 250.0, 90.0, 110.0, -40.0, 50.0, 70.0, 360.0, 63.0, 61.0, 150.0, 120.0, 74.0, 100.0, 70.0, 90.0, 138.0, 40.0, 40.0, 60.0, 50.0, 49.0, 110.0, 160.0, 50.0, 70.0, 10.0, 50.0, 70.0, 190.0, 27.0, 80.0, 74.0, 78.0, 18.0, 100.0, 50.0, 20.0, 80.0, 70.0, 68.0, 170.0, 130.0, 39.0, 140.0, 31.0, 90.0, 86.0, 70.0, 30.0, -80.0, 30.0, 319.0, 10.0, 87.0, 70.0, 40.0, 130.0, 8.0, 11.0, 210.0, 50.0, 57.0, 245.0, -45.0, 81.0, 60.0, 69.0, 100.0, 50.0, 270.0, 36.0, 80.0, 60.0, -26.0, 60.0, 40.0, 29.0, 60.0, 39.0, 20.0, 30.0, 18.0, 70.0, 70.0, 150.0, 40.0, 40.0, 180.0, 50.0, 68.0, 79.0, 10.0, 80.0, 30.0, 40.0, 120.0, 80.0, 40.0, 30.0, 60.0, 100.0, 110.0, 20.0, -60.0, 0.0, 40.0, 20.0, 19.0, 110.0, 120.0, 65.0, 100.0, 79.0, 70.0, 100.0, -10.0, 80.0, 159.0, 70.0, 40.0, 50.0, 19.0, 43.0, 50.0, 16.0, 50.0, 30.0, 75.0, 74.0, 170.0, 100.0, 60.0, -25.0, 100.0, 59.0, 79.0, 100.0, 47.0, 460.0, 90.0, 20.0, 0.0, 70.0, 58.0, 90.0, 220.0, 60.0, 30.0, 200.0, 70.0, 40.0, -10.0, 5.0, 45.0, 57.0, 100.0, 330.0, 300.0, 90.0, 90.0, 77.0, 75.0, 50.0, 90.0, 250.0, 179.0, 0.0, 70.0, 6.0, 48.0, 60.0, 70.0, 80.0, 40.0, 55.0, 80.0, 45.0, 13.0, 110.0, 80.0, 30.0, 40.0, -5.0, 20.0, 60.0, 70.0, 57.0, 30.0, 50.0, 100.0, 62.0, 111.0, 50.0, 73.0, 49.0, 40.0, 98.0, 97.0, 79.0, 67.0, 9.0, 39.0, 60.0, 60.0, 59.0, 80.0, 130.0, 110.0, 50.0, 242.0, 12.0, 120.0, 50.0, 100.0, 10.0, 60.0, 12.0, 110.0, 56.0, 80.0, 74.0, 18.0, 110.0, 80.0, 0.0, 140.0, 160.0, -127.0, 60.0, -3.0, 190.0, -76.0, 34.0, 100.0, 40.0, 10.0, 90.0, 70.0, 20.0, 180.0, 100.0, 30.0, 200.0, -240.0, -22.0, 33.0, 180.0, 70.0, 15.0, 50.0, 40.0, 67.0, 50.0, 25.0, 70.0, 95.0, 50.0, 30.0, 70.0, 28.0, 37.0, 70.0, 50.0, 80.0, 80.0, 60.0, 50.0, 370.0, 125.0, 70.0, 55.0, 20.0, 60.0, 35.0, 20.0, 99.0, 88.0, 36.0, 210.0, -32.0, 309.0, 70.0, 50.0, -27.0, 60.0, 130.0, -59.0, 490.0, 392.0, 50.0, 90.0, -70.0, 200.0, 10.0, 90.0, 48.0, 60.0, 82.0, 60.0, 70.0, 37.0, 110.0, 30.0, -3.0, 30.0, 50.0, 64.0, 130.0, 70.0, 30.0, 60.0, 30.0, 190.0, 60.0, 80.0, 160.0, 30.0, 60.0, 80.0, 189.0, 90.0, 70.0, 203.0, -198.0, 139.0, 68.0, 80.0, -131.0, -200.0, 90.0, 540.0, 36.0, 47.0, 27.0, 40.0, 17.0, -114.0, 130.0, 80.0, 130.0, 120.0, 50.0, 79.0, 29.0, 270.0, 89.0, 30.0, 90.0, 50.0, 30.0, 78.0, 187.0, 72.0, 40.0, 50.0, 280.0, 70.0, 460.0, 538.0, 90.0, 60.0, 88.0, -10.0, 100.0, 100.0, 70.0, 180.0, 95.0, -122.0, 39.0, 50.0, -61.0, 50.0, 42.0, 63.0, 424.0, 240.0, 36.0, 40.0, 160.0, 70.0, 60.0, 50.0, -5.0, -7.0, -14.0, 150.0, 110.0, 80.0, 153.0, 10.0, 480.0, 210.0, 29.0, -86.0, 28.0, -166.0, 264.0, 142.0, 20.0, 70.0, 30.0, 358.0, 0.0, 130.0, 40.0, 87.0, 150.0, 50.0, 30.0, 60.0, -20.0, 20.0, 100.0, -51.0, 50.0, 30.0, 80.0, 56.0, 79.0, 84.0, 49.0, 38.0, 10.0, 150.0, 110.0, 40.0, 60.0, 59.0, 49.0, 70.0, -7.0, 107.0, 67.0, 52.0, 160.0, 8.0, 190.0, 170.0, 28.0, 0.0, 880.0, 110.0, 49.0, -70.0, 100.0, 8.0, 19.0, 42.0, 180.0, 26.0, 68.0, 29.0, 70.0, 96.0, 120.0, 80.0, 80.0, 70.0, 10.0, 63.0, 100.0, 9.0, 89.0, 74.0, 30.0, 167.0, 60.0, 50.0, -5.0, 110.0, 37.0, 170.0, 100.0, 60.0, 36.0, 70.0, 3.0, 20.0, 50.0, 30.0, 60.0, 50.0, 41.0, 20.0, 36.0, 220.0, 269.0, 29.0, 40.0, 25.0, 10.0, 67.0, 70.0, -35.0, 100.0, 40.0, 80.0, 15.0, 54.0, 44.0, 47.0, 160.0, 50.0, 172.0, 179.0, 200.0, 50.0, 60.0, 2.0, 80.0, 49.0, 110.0, 120.0, -33.0, 10.0, 20.0, 370.0, 110.0, 100.0, 50.0, 70.0, 90.0, -10.0, 70.0, 60.0, -40.0, 150.0, 160.0, 45.0, -20.0, 80.0, 330.0, 60.0, 44.0, 20.0, 60.0, 80.0, 44.0, 48.0, 70.0, 24.0, 80.0, 130.0, 30.0, 40.0, 28.0, 70.0, 40.0, 28.0, 40.0, 43.0, 43.0, 15.0, 13.0, 15.0, 32.0, 100.0, 120.0, 50.0, 39.0, 49.0, 90.0, 100.0, 90.0, 50.0, 120.0, 40.0, 45.0, 40.0, 50.0, 20.0, 20.0, 50.0, 75.0, 0.0, 180.0, 130.0, 80.0, 69.0, 50.0, 69.0, 120.0, 310.0, 60.0, 50.0, 80.0, 86.0, 55.0, -7.0, 110.0, 99.0, 157.0, 169.0, 110.0, 120.0, 153.0, 80.0, -1.0, 70.0, 100.0, 30.0, 80.0, 8.0, 70.0, 26.0, 67.0, 120.0, 90.0, 70.0, 120.0, 40.0, 39.0, 110.0, 100.0, -446.0, 115.0, 20.0, 20.0, 120.0, 40.0, 91.0, 60.0, 100.0, 100.0, 45.0, 61.0, 278.0, 89.0, 188.0, 90.0, 30.0, 60.0, 34.0, 190.0, 50.0, 88.0, 83.0, 70.0, 60.0, 59.0, 118.0, 89.0, 25.0, 100.0, 70.0, 60.0, 100.0, 40.0, 180.0, 160.0, 40.0, 50.0, 90.0, 100.0, 40.0, 50.0, 50.0, 106.0, -30.0, -1.0, 278.0, 100.0, 60.0, 85.0, 110.0, 80.0, 50.0, 228.0, 20.0, 120.0, 100.0, 30.0, -30.0, 100.0, 40.0, 176.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1104471077226914, "mean_inference_ms": 2.4334879188499183, "mean_action_processing_ms": 0.8166299879552403, "mean_env_wait_ms": 1.6917300184346227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06841564178466797, "StateBufferConnector_ms": 0.011708736419677734, "ViewRequirementAgentConnector_ms": 0.47301435470581055}, "num_episodes": 18, "episode_return_max": 1676.0, "episode_return_min": 216.0, "episode_return_mean": 739.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.69800054193748, "num_env_steps_trained_throughput_per_sec": 32.69800054193748, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 2600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2600000, "timers": {"training_iteration_time_ms": 122444.36, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122444.307, "sample_time_ms": 3241.549, "learn_time_ms": 119181.401, "learn_throughput": 33.562, "synch_weights_time_ms": 12.785}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "done": false, "training_iteration": 65, "trial_id": "6085c_00000", "date": "2024-07-02_01-10-11", "timestamp": 1719897011, "time_this_iter_s": 122.34503483772278, "time_total_s": 9858.044719219208, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b3bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9858.044719219208, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 28.573410404624283, "ram_util_percent": 79.67572254335259}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8729652007547815, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.451610975143628, "policy_loss": -0.005678390805372478, "vf_loss": 7.4558475120633805, "vf_explained_var": -0.0024347312661151662, "kl": 0.014418625747195522, "entropy": 1.0454184003340932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 615045.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 1676.0, "episode_reward_min": 318.0, "episode_reward_mean": 737.97, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -446.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 73.797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [496.0, 838.0, 797.0, 944.0, 524.0, 739.0, 339.0, 530.0, 476.0, 456.0, 1250.0, 906.0, 649.0, 707.0, 904.0, 706.0, 746.0, 699.0, 537.0, 737.0, 360.0, 733.0, 527.0, 792.0, 1115.0, 867.0, 1201.0, 554.0, 475.0, 663.0, 680.0, 766.0, 828.0, 318.0, 551.0, 532.0, 555.0, 942.0, 747.0, 1360.0, 530.0, 840.0, 781.0, 352.0, 1007.0, 947.0, 1676.0, 820.0, 540.0, 848.0, 1141.0, 419.0, 696.0, 625.0, 1465.0, 730.0, 692.0, 688.0, 530.0, 615.0, 1001.0, 468.0, 870.0, 929.0, 574.0, 339.0, 808.0, 520.0, 1018.0, 1052.0, 530.0, 358.0, 657.0, 1097.0, 734.0, 850.0, 838.0, 834.0, 693.0, 851.0, 406.0, 527.0, 843.0, 624.0, 647.0, 838.0, 674.0, 590.0, 718.0, 875.0, 919.0, 839.0, 600.0, 845.0, 964.0, 564.0, 636.0, 496.0, 689.0, 994.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [25.0, 39.0, 4.0, 190.0, -41.0, 179.0, 38.0, 70.0, -22.0, 14.0, 149.0, 40.0, 180.0, 4.0, 18.0, 150.0, 50.0, 0.0, 210.0, 37.0, 60.0, 40.0, 35.0, 30.0, 75.0, 190.0, 57.0, 240.0, 50.0, 20.0, 20.0, 47.0, 36.0, 210.0, 120.0, 170.0, 41.0, 110.0, 130.0, 60.0, 32.0, 70.0, 130.0, 26.0, 60.0, 28.0, -3.0, 32.0, 79.0, 70.0, 80.0, 110.0, 70.0, 50.0, 7.0, 57.0, 65.0, 60.0, 60.0, 180.0, 24.0, -25.0, 130.0, 20.0, 50.0, 50.0, 30.0, 10.0, 10.0, 40.0, 20.0, 46.0, 120.0, 24.0, 10.0, 80.0, 110.0, 50.0, 20.0, 50.0, 15.0, 160.0, 70.0, 80.0, 50.0, 60.0, -18.0, -20.0, -1.0, 80.0, 61.0, 68.0, 77.0, -6.0, 30.0, 24.0, -3.0, 169.0, 40.0, -4.0, 300.0, 20.0, 40.0, 250.0, 90.0, 110.0, -40.0, 50.0, 70.0, 360.0, 63.0, 61.0, 150.0, 120.0, 74.0, 100.0, 70.0, 90.0, 138.0, 40.0, 40.0, 60.0, 50.0, 49.0, 110.0, 160.0, 50.0, 70.0, 10.0, 50.0, 70.0, 190.0, 27.0, 80.0, 74.0, 78.0, 18.0, 100.0, 50.0, 20.0, 80.0, 70.0, 68.0, 170.0, 130.0, 39.0, 140.0, 31.0, 90.0, 86.0, 70.0, 30.0, -80.0, 30.0, 319.0, 10.0, 87.0, 70.0, 40.0, 130.0, 8.0, 11.0, 210.0, 50.0, 57.0, 245.0, -45.0, 81.0, 60.0, 69.0, 100.0, 50.0, 270.0, 36.0, 80.0, 60.0, -26.0, 60.0, 40.0, 29.0, 60.0, 39.0, 20.0, 30.0, 18.0, 70.0, 70.0, 150.0, 40.0, 40.0, 180.0, 50.0, 68.0, 79.0, 10.0, 80.0, 30.0, 40.0, 120.0, 80.0, 40.0, 30.0, 60.0, 100.0, 110.0, 20.0, -60.0, 0.0, 40.0, 20.0, 19.0, 110.0, 120.0, 65.0, 100.0, 79.0, 70.0, 100.0, -10.0, 80.0, 159.0, 70.0, 40.0, 50.0, 19.0, 43.0, 50.0, 16.0, 50.0, 30.0, 75.0, 74.0, 170.0, 100.0, 60.0, -25.0, 100.0, 59.0, 79.0, 100.0, 47.0, 460.0, 90.0, 20.0, 0.0, 70.0, 58.0, 90.0, 220.0, 60.0, 30.0, 200.0, 70.0, 40.0, -10.0, 5.0, 45.0, 57.0, 100.0, 330.0, 300.0, 90.0, 90.0, 77.0, 75.0, 50.0, 90.0, 250.0, 179.0, 0.0, 70.0, 6.0, 48.0, 60.0, 70.0, 80.0, 40.0, 55.0, 80.0, 45.0, 13.0, 110.0, 80.0, 30.0, 40.0, -5.0, 20.0, 60.0, 70.0, 57.0, 30.0, 50.0, 100.0, 62.0, 111.0, 50.0, 73.0, 49.0, 40.0, 98.0, 97.0, 79.0, 67.0, 9.0, 39.0, 60.0, 60.0, 59.0, 80.0, 130.0, 110.0, 50.0, 242.0, 12.0, 120.0, 50.0, 100.0, 10.0, 60.0, 12.0, 110.0, 56.0, 80.0, 74.0, 18.0, 110.0, 80.0, 0.0, 140.0, 160.0, -127.0, 60.0, -3.0, 190.0, -76.0, 34.0, 100.0, 40.0, 10.0, 90.0, 70.0, 20.0, 180.0, 100.0, 30.0, 200.0, -240.0, -22.0, 33.0, 180.0, 70.0, 15.0, 50.0, 40.0, 67.0, 50.0, 25.0, 70.0, 95.0, 50.0, 30.0, 70.0, 28.0, 37.0, 70.0, 50.0, 80.0, 80.0, 60.0, 50.0, 370.0, 125.0, 70.0, 55.0, 20.0, 60.0, 35.0, 20.0, 99.0, 88.0, 36.0, 210.0, -32.0, 309.0, 70.0, 50.0, -27.0, 60.0, 130.0, -59.0, 490.0, 392.0, 50.0, 90.0, -70.0, 200.0, 10.0, 90.0, 48.0, 60.0, 82.0, 60.0, 70.0, 37.0, 110.0, 30.0, -3.0, 30.0, 50.0, 64.0, 130.0, 70.0, 30.0, 60.0, 30.0, 190.0, 60.0, 80.0, 160.0, 30.0, 60.0, 80.0, 189.0, 90.0, 70.0, 203.0, -198.0, 139.0, 68.0, 80.0, -131.0, -200.0, 90.0, 540.0, 36.0, 47.0, 27.0, 40.0, 17.0, -114.0, 130.0, 80.0, 130.0, 120.0, 50.0, 79.0, 29.0, 270.0, 89.0, 30.0, 90.0, 50.0, 30.0, 78.0, 187.0, 72.0, 40.0, 50.0, 280.0, 70.0, 460.0, 538.0, 90.0, 60.0, 88.0, -10.0, 100.0, 100.0, 70.0, 180.0, 95.0, -122.0, 39.0, 50.0, -61.0, 50.0, 42.0, 63.0, 424.0, 240.0, 36.0, 40.0, 160.0, 70.0, 60.0, 50.0, -5.0, -7.0, -14.0, 150.0, 110.0, 80.0, 153.0, 10.0, 480.0, 210.0, 29.0, -86.0, 28.0, -166.0, 264.0, 142.0, 20.0, 70.0, 30.0, 358.0, 0.0, 130.0, 40.0, 87.0, 150.0, 50.0, 30.0, 60.0, -20.0, 20.0, 100.0, -51.0, 50.0, 30.0, 80.0, 56.0, 79.0, 84.0, 49.0, 38.0, 10.0, 150.0, 110.0, 40.0, 60.0, 59.0, 49.0, 70.0, -7.0, 107.0, 67.0, 52.0, 160.0, 8.0, 190.0, 170.0, 28.0, 0.0, 880.0, 110.0, 49.0, -70.0, 100.0, 8.0, 19.0, 42.0, 180.0, 26.0, 68.0, 29.0, 70.0, 96.0, 120.0, 80.0, 80.0, 70.0, 10.0, 63.0, 100.0, 9.0, 89.0, 74.0, 30.0, 167.0, 60.0, 50.0, -5.0, 110.0, 37.0, 170.0, 100.0, 60.0, 36.0, 70.0, 3.0, 20.0, 50.0, 30.0, 60.0, 50.0, 41.0, 20.0, 36.0, 220.0, 269.0, 29.0, 40.0, 25.0, 10.0, 67.0, 70.0, -35.0, 100.0, 40.0, 80.0, 15.0, 54.0, 44.0, 47.0, 160.0, 50.0, 172.0, 179.0, 200.0, 50.0, 60.0, 2.0, 80.0, 49.0, 110.0, 120.0, -33.0, 10.0, 20.0, 370.0, 110.0, 100.0, 50.0, 70.0, 90.0, -10.0, 70.0, 60.0, -40.0, 150.0, 160.0, 45.0, -20.0, 80.0, 330.0, 60.0, 44.0, 20.0, 60.0, 80.0, 44.0, 48.0, 70.0, 24.0, 80.0, 130.0, 30.0, 40.0, 28.0, 70.0, 40.0, 28.0, 40.0, 43.0, 43.0, 15.0, 13.0, 15.0, 32.0, 100.0, 120.0, 50.0, 39.0, 49.0, 90.0, 100.0, 90.0, 50.0, 120.0, 40.0, 45.0, 40.0, 50.0, 20.0, 20.0, 50.0, 75.0, 0.0, 180.0, 130.0, 80.0, 69.0, 50.0, 69.0, 120.0, 310.0, 60.0, 50.0, 80.0, 86.0, 55.0, -7.0, 110.0, 99.0, 157.0, 169.0, 110.0, 120.0, 153.0, 80.0, -1.0, 70.0, 100.0, 30.0, 80.0, 8.0, 70.0, 26.0, 67.0, 120.0, 90.0, 70.0, 120.0, 40.0, 39.0, 110.0, 100.0, -446.0, 115.0, 20.0, 20.0, 120.0, 40.0, 91.0, 60.0, 100.0, 100.0, 45.0, 61.0, 278.0, 89.0, 188.0, 90.0, 30.0, 60.0, 34.0, 190.0, 50.0, 88.0, 83.0, 70.0, 60.0, 59.0, 118.0, 89.0, 25.0, 100.0, 70.0, 60.0, 100.0, 40.0, 180.0, 160.0, 40.0, 50.0, 90.0, 100.0, 40.0, 50.0, 50.0, 106.0, -30.0, -1.0, 278.0, 100.0, 60.0, 85.0, 110.0, 80.0, 50.0, 228.0, 20.0, 120.0, 100.0, 30.0, -30.0, 100.0, 40.0, 176.0, 80.0, 44.0, 77.0, 50.0, 170.0, 70.0, 80.0, -24.0, -24.0, 170.0, 100.0, 87.0, 120.0, 79.0, 25.0, 75.0, 110.0, 69.0, 66.0, 120.0, 56.0, 29.0, 24.0, -11.0, 10.0, 190.0, 20.0, 0.0, 28.0, 60.0, 77.0, 30.0, 150.0, 25.0, 60.0, 60.0, 12.0, 50.0, 24.0, 39.0, 60.0, 101.0, 220.0, 88.0, 60.0, 80.0, 74.0, 70.0, 70.0, 20.0, 120.0, 48.0, 40.0, 29.0, 80.0, 19.0, -20.0, 190.0, 69.0, 49.0, -120.0, 100.0, 99.0, 90.0, 58.0, 70.0, 110.0, 120.0, 60.0, 60.0, 241.0, 69.0, 184.0, 36.0, 50.0, 53.0, 10.0, 120.0, 35.0, 40.0, 40.0, 19.0, 50.0, 29.0, 17.0, 180.0, 70.0, 52.0, 157.0, 60.0, 100.0, 40.0, 110.0, 80.0, 60.0, 60.0, 20.0, 20.0, 50.0, 50.0, 70.0, -24.0, 39.0, 8.0, 10.0, 19.0, 198.0, 210.0, 28.0, 160.0, 70.0, 118.0, 62.0, 150.0, 100.0, 31.0, 57.0, 134.0, -20.0, 173.0, 160.0, 36.0, 180.0, 50.0, 28.0, 99.0, 120.0, 90.0, -5.0, 161.0, 160.0, 89.0, 38.0, 160.0, 50.0, 112.0, 60.0, 100.0, 50.0, 20.0, 369.0, -91.0, -7.0, 74.0, -12.0, 27.0, -70.0, 120.0, 100.0, 90.0, 40.0, 50.0, 40.0, 80.0, 90.0, 50.0, 20.0, 55.0, 130.0, 290.0, 50.0, 100.0, 170.0, 50.0, 130.0, 190.0, 109.0, 78.0, 39.0, 48.0, 50.0, 80.0, 51.0, 100.0, 29.0, 44.0, 40.0, 50.0, 70.0, 50.0, 20.0, 40.0, 110.0, 53.0, 23.0, 100.0, 110.0, 70.0, 60.0, 50.0, 88.0, 37.0, 58.0, 86.0, 70.0, 60.0, 130.0, -181.0, 48.0, 100.0, 90.0, 45.0, 60.0, 18.0, 200.0, -4.0, 50.0, 60.0, 110.0, 60.0, -3.0, 59.0, 290.0, -116.0, 68.0, 27.0, 530.0, 59.0, 130.0, -50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1021069134962405, "mean_inference_ms": 2.42429710234176, "mean_action_processing_ms": 0.8135258896811948, "mean_env_wait_ms": 1.6852426474011093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06545305252075195, "StateBufferConnector_ms": 0.011614561080932617, "ViewRequirementAgentConnector_ms": 0.46970295906066895}, "num_episodes": 22, "episode_return_max": 1676.0, "episode_return_min": 318.0, "episode_return_mean": 737.97, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.55794504115755, "num_env_steps_trained_throughput_per_sec": 32.55794504115755, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 122393.478, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122393.426, "sample_time_ms": 3147.753, "learn_time_ms": 119224.647, "learn_throughput": 33.55, "synch_weights_time_ms": 12.229}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 66, "trial_id": "6085c_00000", "date": "2024-07-02_01-12-14", "timestamp": 1719897134, "time_this_iter_s": 122.8716549873352, "time_total_s": 9980.916374206543, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9980.916374206543, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 28.868390804597702, "ram_util_percent": 79.67298850574711}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.041947996184722, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.538174027756761, "policy_loss": -0.005711201020180227, "vf_loss": 7.542580739225443, "vf_explained_var": -3.075679016316407e-05, "kl": 0.013044845268741018, "entropy": 1.0369162502380225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 624435.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "env_runners": {"episode_reward_max": 1772.0, "episode_reward_min": 318.0, "episode_reward_mean": 752.81, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -446.0}, "policy_reward_max": {"policy_0": 950.0}, "policy_reward_mean": {"policy_0": 75.281}, "custom_metrics": {}, "hist_stats": {"episode_reward": [792.0, 1115.0, 867.0, 1201.0, 554.0, 475.0, 663.0, 680.0, 766.0, 828.0, 318.0, 551.0, 532.0, 555.0, 942.0, 747.0, 1360.0, 530.0, 840.0, 781.0, 352.0, 1007.0, 947.0, 1676.0, 820.0, 540.0, 848.0, 1141.0, 419.0, 696.0, 625.0, 1465.0, 730.0, 692.0, 688.0, 530.0, 615.0, 1001.0, 468.0, 870.0, 929.0, 574.0, 339.0, 808.0, 520.0, 1018.0, 1052.0, 530.0, 358.0, 657.0, 1097.0, 734.0, 850.0, 838.0, 834.0, 693.0, 851.0, 406.0, 527.0, 843.0, 624.0, 647.0, 838.0, 674.0, 590.0, 718.0, 875.0, 919.0, 839.0, 600.0, 845.0, 964.0, 564.0, 636.0, 496.0, 689.0, 994.0, 695.0, 994.0, 553.0, 957.0, 877.0, 556.0, 585.0, 471.0, 763.0, 724.0, 493.0, 795.0, 610.0, 949.0, 664.0, 740.0, 1772.0, 550.0, 644.0, 581.0, 647.0, 540.0, 924.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [75.0, 74.0, 170.0, 100.0, 60.0, -25.0, 100.0, 59.0, 79.0, 100.0, 47.0, 460.0, 90.0, 20.0, 0.0, 70.0, 58.0, 90.0, 220.0, 60.0, 30.0, 200.0, 70.0, 40.0, -10.0, 5.0, 45.0, 57.0, 100.0, 330.0, 300.0, 90.0, 90.0, 77.0, 75.0, 50.0, 90.0, 250.0, 179.0, 0.0, 70.0, 6.0, 48.0, 60.0, 70.0, 80.0, 40.0, 55.0, 80.0, 45.0, 13.0, 110.0, 80.0, 30.0, 40.0, -5.0, 20.0, 60.0, 70.0, 57.0, 30.0, 50.0, 100.0, 62.0, 111.0, 50.0, 73.0, 49.0, 40.0, 98.0, 97.0, 79.0, 67.0, 9.0, 39.0, 60.0, 60.0, 59.0, 80.0, 130.0, 110.0, 50.0, 242.0, 12.0, 120.0, 50.0, 100.0, 10.0, 60.0, 12.0, 110.0, 56.0, 80.0, 74.0, 18.0, 110.0, 80.0, 0.0, 140.0, 160.0, -127.0, 60.0, -3.0, 190.0, -76.0, 34.0, 100.0, 40.0, 10.0, 90.0, 70.0, 20.0, 180.0, 100.0, 30.0, 200.0, -240.0, -22.0, 33.0, 180.0, 70.0, 15.0, 50.0, 40.0, 67.0, 50.0, 25.0, 70.0, 95.0, 50.0, 30.0, 70.0, 28.0, 37.0, 70.0, 50.0, 80.0, 80.0, 60.0, 50.0, 370.0, 125.0, 70.0, 55.0, 20.0, 60.0, 35.0, 20.0, 99.0, 88.0, 36.0, 210.0, -32.0, 309.0, 70.0, 50.0, -27.0, 60.0, 130.0, -59.0, 490.0, 392.0, 50.0, 90.0, -70.0, 200.0, 10.0, 90.0, 48.0, 60.0, 82.0, 60.0, 70.0, 37.0, 110.0, 30.0, -3.0, 30.0, 50.0, 64.0, 130.0, 70.0, 30.0, 60.0, 30.0, 190.0, 60.0, 80.0, 160.0, 30.0, 60.0, 80.0, 189.0, 90.0, 70.0, 203.0, -198.0, 139.0, 68.0, 80.0, -131.0, -200.0, 90.0, 540.0, 36.0, 47.0, 27.0, 40.0, 17.0, -114.0, 130.0, 80.0, 130.0, 120.0, 50.0, 79.0, 29.0, 270.0, 89.0, 30.0, 90.0, 50.0, 30.0, 78.0, 187.0, 72.0, 40.0, 50.0, 280.0, 70.0, 460.0, 538.0, 90.0, 60.0, 88.0, -10.0, 100.0, 100.0, 70.0, 180.0, 95.0, -122.0, 39.0, 50.0, -61.0, 50.0, 42.0, 63.0, 424.0, 240.0, 36.0, 40.0, 160.0, 70.0, 60.0, 50.0, -5.0, -7.0, -14.0, 150.0, 110.0, 80.0, 153.0, 10.0, 480.0, 210.0, 29.0, -86.0, 28.0, -166.0, 264.0, 142.0, 20.0, 70.0, 30.0, 358.0, 0.0, 130.0, 40.0, 87.0, 150.0, 50.0, 30.0, 60.0, -20.0, 20.0, 100.0, -51.0, 50.0, 30.0, 80.0, 56.0, 79.0, 84.0, 49.0, 38.0, 10.0, 150.0, 110.0, 40.0, 60.0, 59.0, 49.0, 70.0, -7.0, 107.0, 67.0, 52.0, 160.0, 8.0, 190.0, 170.0, 28.0, 0.0, 880.0, 110.0, 49.0, -70.0, 100.0, 8.0, 19.0, 42.0, 180.0, 26.0, 68.0, 29.0, 70.0, 96.0, 120.0, 80.0, 80.0, 70.0, 10.0, 63.0, 100.0, 9.0, 89.0, 74.0, 30.0, 167.0, 60.0, 50.0, -5.0, 110.0, 37.0, 170.0, 100.0, 60.0, 36.0, 70.0, 3.0, 20.0, 50.0, 30.0, 60.0, 50.0, 41.0, 20.0, 36.0, 220.0, 269.0, 29.0, 40.0, 25.0, 10.0, 67.0, 70.0, -35.0, 100.0, 40.0, 80.0, 15.0, 54.0, 44.0, 47.0, 160.0, 50.0, 172.0, 179.0, 200.0, 50.0, 60.0, 2.0, 80.0, 49.0, 110.0, 120.0, -33.0, 10.0, 20.0, 370.0, 110.0, 100.0, 50.0, 70.0, 90.0, -10.0, 70.0, 60.0, -40.0, 150.0, 160.0, 45.0, -20.0, 80.0, 330.0, 60.0, 44.0, 20.0, 60.0, 80.0, 44.0, 48.0, 70.0, 24.0, 80.0, 130.0, 30.0, 40.0, 28.0, 70.0, 40.0, 28.0, 40.0, 43.0, 43.0, 15.0, 13.0, 15.0, 32.0, 100.0, 120.0, 50.0, 39.0, 49.0, 90.0, 100.0, 90.0, 50.0, 120.0, 40.0, 45.0, 40.0, 50.0, 20.0, 20.0, 50.0, 75.0, 0.0, 180.0, 130.0, 80.0, 69.0, 50.0, 69.0, 120.0, 310.0, 60.0, 50.0, 80.0, 86.0, 55.0, -7.0, 110.0, 99.0, 157.0, 169.0, 110.0, 120.0, 153.0, 80.0, -1.0, 70.0, 100.0, 30.0, 80.0, 8.0, 70.0, 26.0, 67.0, 120.0, 90.0, 70.0, 120.0, 40.0, 39.0, 110.0, 100.0, -446.0, 115.0, 20.0, 20.0, 120.0, 40.0, 91.0, 60.0, 100.0, 100.0, 45.0, 61.0, 278.0, 89.0, 188.0, 90.0, 30.0, 60.0, 34.0, 190.0, 50.0, 88.0, 83.0, 70.0, 60.0, 59.0, 118.0, 89.0, 25.0, 100.0, 70.0, 60.0, 100.0, 40.0, 180.0, 160.0, 40.0, 50.0, 90.0, 100.0, 40.0, 50.0, 50.0, 106.0, -30.0, -1.0, 278.0, 100.0, 60.0, 85.0, 110.0, 80.0, 50.0, 228.0, 20.0, 120.0, 100.0, 30.0, -30.0, 100.0, 40.0, 176.0, 80.0, 44.0, 77.0, 50.0, 170.0, 70.0, 80.0, -24.0, -24.0, 170.0, 100.0, 87.0, 120.0, 79.0, 25.0, 75.0, 110.0, 69.0, 66.0, 120.0, 56.0, 29.0, 24.0, -11.0, 10.0, 190.0, 20.0, 0.0, 28.0, 60.0, 77.0, 30.0, 150.0, 25.0, 60.0, 60.0, 12.0, 50.0, 24.0, 39.0, 60.0, 101.0, 220.0, 88.0, 60.0, 80.0, 74.0, 70.0, 70.0, 20.0, 120.0, 48.0, 40.0, 29.0, 80.0, 19.0, -20.0, 190.0, 69.0, 49.0, -120.0, 100.0, 99.0, 90.0, 58.0, 70.0, 110.0, 120.0, 60.0, 60.0, 241.0, 69.0, 184.0, 36.0, 50.0, 53.0, 10.0, 120.0, 35.0, 40.0, 40.0, 19.0, 50.0, 29.0, 17.0, 180.0, 70.0, 52.0, 157.0, 60.0, 100.0, 40.0, 110.0, 80.0, 60.0, 60.0, 20.0, 20.0, 50.0, 50.0, 70.0, -24.0, 39.0, 8.0, 10.0, 19.0, 198.0, 210.0, 28.0, 160.0, 70.0, 118.0, 62.0, 150.0, 100.0, 31.0, 57.0, 134.0, -20.0, 173.0, 160.0, 36.0, 180.0, 50.0, 28.0, 99.0, 120.0, 90.0, -5.0, 161.0, 160.0, 89.0, 38.0, 160.0, 50.0, 112.0, 60.0, 100.0, 50.0, 20.0, 369.0, -91.0, -7.0, 74.0, -12.0, 27.0, -70.0, 120.0, 100.0, 90.0, 40.0, 50.0, 40.0, 80.0, 90.0, 50.0, 20.0, 55.0, 130.0, 290.0, 50.0, 100.0, 170.0, 50.0, 130.0, 190.0, 109.0, 78.0, 39.0, 48.0, 50.0, 80.0, 51.0, 100.0, 29.0, 44.0, 40.0, 50.0, 70.0, 50.0, 20.0, 40.0, 110.0, 53.0, 23.0, 100.0, 110.0, 70.0, 60.0, 50.0, 88.0, 37.0, 58.0, 86.0, 70.0, 60.0, 130.0, -181.0, 48.0, 100.0, 90.0, 45.0, 60.0, 18.0, 200.0, -4.0, 50.0, 60.0, 110.0, 60.0, -3.0, 59.0, 290.0, -116.0, 68.0, 27.0, 530.0, 59.0, 130.0, -50.0, 50.0, 50.0, 25.0, 190.0, 110.0, 50.0, 20.0, 40.0, 80.0, 80.0, 61.0, 42.0, 40.0, 78.0, 290.0, -136.0, 300.0, 160.0, 59.0, 100.0, 40.0, 110.0, 20.0, 50.0, 59.0, 40.0, 179.0, -45.0, 50.0, 50.0, 80.0, -51.0, 115.0, 50.0, -3.0, 570.0, 90.0, 57.0, 10.0, 39.0, -21.0, 50.0, 70.0, 50.0, 300.0, 130.0, 58.0, 70.0, 90.0, 80.0, 66.0, 57.0, 10.0, 90.0, 141.0, 28.0, 18.0, 18.0, 88.0, 40.0, 60.0, 25.0, 70.0, 30.0, 92.0, 55.0, 63.0, 70.0, 50.0, 70.0, -90.0, 70.0, 74.0, 55.0, 40.0, 78.0, 110.0, 25.0, 79.0, 30.0, -18.0, -115.0, 40.0, -40.0, 52.0, 330.0, 48.0, 320.0, 170.0, -24.0, 120.0, 50.0, 59.0, 110.0, 70.0, 90.0, 35.0, 50.0, 40.0, 100.0, -3.0, 39.0, 60.0, 30.0, 70.0, 46.0, -35.0, 36.0, 190.0, 60.0, 110.0, 140.0, 10.0, 119.0, 91.0, 46.0, 70.0, -61.0, 90.0, 180.0, -15.0, 30.0, 70.0, 90.0, 190.0, 60.0, 28.0, 80.0, 70.0, 7.0, 178.0, 79.0, -135.0, 330.0, 109.0, 73.0, -11.0, 79.0, 57.0, 190.0, 53.0, 99.0, 170.0, 50.0, 80.0, 20.0, 61.0, 31.0, 90.0, 10.0, -10.0, 70.0, 19.0, -6.0, 29.0, 100.0, 380.0, 70.0, 18.0, 70.0, 64.0, 90.0, -50.0, 150.0, 950.0, 210.0, 119.0, 99.0, 60.0, 80.0, 40.0, 132.0, 90.0, 4.0, -35.0, 150.0, 50.0, 120.0, -31.0, 30.0, 29.0, 50.0, 100.0, 60.0, 60.0, 50.0, 70.0, -5.0, 160.0, 70.0, 170.0, 50.0, 25.0, 3.0, 5.0, 260.0, 13.0, 20.0, 35.0, 0.0, 36.0, 84.0, 107.0, 60.0, 10.0, 130.0, 24.0, 120.0, 26.0, 50.0, 105.0, 90.0, 170.0, 140.0, -85.0, 100.0, 80.0, 75.0, -35.0, -100.0, 170.0, -17.0, 50.0, 11.0, 80.0, 80.0, 190.0, 70.0, 100.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0955687813465254, "mean_inference_ms": 2.4151351718654563, "mean_action_processing_ms": 0.8099131664633181, "mean_env_wait_ms": 1.6791933298948782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06732678413391113, "StateBufferConnector_ms": 0.010236978530883789, "ViewRequirementAgentConnector_ms": 0.47666454315185547}, "num_episodes": 23, "episode_return_max": 1772.0, "episode_return_min": 318.0, "episode_return_mean": 752.81, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.936496102187554, "num_env_steps_trained_throughput_per_sec": 32.936496102187554, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 2680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2680000, "timers": {"training_iteration_time_ms": 122318.566, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122318.513, "sample_time_ms": 3134.671, "learn_time_ms": 119162.883, "learn_throughput": 33.567, "synch_weights_time_ms": 12.262}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "done": false, "training_iteration": 67, "trial_id": "6085c_00000", "date": "2024-07-02_01-14-15", "timestamp": 1719897255, "time_this_iter_s": 121.45916724205017, "time_total_s": 10102.375541448593, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b3b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10102.375541448593, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 28.506976744186044, "ram_util_percent": 79.36686046511628}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4192505162744857, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.386926164058324, "policy_loss": -0.00566428392050397, "vf_loss": 7.3915633126442675, "vf_explained_var": 0.009922777508267453, "kl": 0.010271341291044104, "entropy": 1.022873282997499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 633825.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 1772.0, "episode_reward_min": 325.0, "episode_reward_mean": 740.37, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -446.0}, "policy_reward_max": {"policy_0": 950.0}, "policy_reward_mean": {"policy_0": 74.037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [840.0, 781.0, 352.0, 1007.0, 947.0, 1676.0, 820.0, 540.0, 848.0, 1141.0, 419.0, 696.0, 625.0, 1465.0, 730.0, 692.0, 688.0, 530.0, 615.0, 1001.0, 468.0, 870.0, 929.0, 574.0, 339.0, 808.0, 520.0, 1018.0, 1052.0, 530.0, 358.0, 657.0, 1097.0, 734.0, 850.0, 838.0, 834.0, 693.0, 851.0, 406.0, 527.0, 843.0, 624.0, 647.0, 838.0, 674.0, 590.0, 718.0, 875.0, 919.0, 839.0, 600.0, 845.0, 964.0, 564.0, 636.0, 496.0, 689.0, 994.0, 695.0, 994.0, 553.0, 957.0, 877.0, 556.0, 585.0, 471.0, 763.0, 724.0, 493.0, 795.0, 610.0, 949.0, 664.0, 740.0, 1772.0, 550.0, 644.0, 581.0, 647.0, 540.0, 924.0, 428.0, 697.0, 895.0, 766.0, 488.0, 899.0, 643.0, 624.0, 379.0, 1005.0, 325.0, 898.0, 737.0, 672.0, 550.0, 643.0, 848.0, 735.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 70.0, 30.0, 60.0, 30.0, 190.0, 60.0, 80.0, 160.0, 30.0, 60.0, 80.0, 189.0, 90.0, 70.0, 203.0, -198.0, 139.0, 68.0, 80.0, -131.0, -200.0, 90.0, 540.0, 36.0, 47.0, 27.0, 40.0, 17.0, -114.0, 130.0, 80.0, 130.0, 120.0, 50.0, 79.0, 29.0, 270.0, 89.0, 30.0, 90.0, 50.0, 30.0, 78.0, 187.0, 72.0, 40.0, 50.0, 280.0, 70.0, 460.0, 538.0, 90.0, 60.0, 88.0, -10.0, 100.0, 100.0, 70.0, 180.0, 95.0, -122.0, 39.0, 50.0, -61.0, 50.0, 42.0, 63.0, 424.0, 240.0, 36.0, 40.0, 160.0, 70.0, 60.0, 50.0, -5.0, -7.0, -14.0, 150.0, 110.0, 80.0, 153.0, 10.0, 480.0, 210.0, 29.0, -86.0, 28.0, -166.0, 264.0, 142.0, 20.0, 70.0, 30.0, 358.0, 0.0, 130.0, 40.0, 87.0, 150.0, 50.0, 30.0, 60.0, -20.0, 20.0, 100.0, -51.0, 50.0, 30.0, 80.0, 56.0, 79.0, 84.0, 49.0, 38.0, 10.0, 150.0, 110.0, 40.0, 60.0, 59.0, 49.0, 70.0, -7.0, 107.0, 67.0, 52.0, 160.0, 8.0, 190.0, 170.0, 28.0, 0.0, 880.0, 110.0, 49.0, -70.0, 100.0, 8.0, 19.0, 42.0, 180.0, 26.0, 68.0, 29.0, 70.0, 96.0, 120.0, 80.0, 80.0, 70.0, 10.0, 63.0, 100.0, 9.0, 89.0, 74.0, 30.0, 167.0, 60.0, 50.0, -5.0, 110.0, 37.0, 170.0, 100.0, 60.0, 36.0, 70.0, 3.0, 20.0, 50.0, 30.0, 60.0, 50.0, 41.0, 20.0, 36.0, 220.0, 269.0, 29.0, 40.0, 25.0, 10.0, 67.0, 70.0, -35.0, 100.0, 40.0, 80.0, 15.0, 54.0, 44.0, 47.0, 160.0, 50.0, 172.0, 179.0, 200.0, 50.0, 60.0, 2.0, 80.0, 49.0, 110.0, 120.0, -33.0, 10.0, 20.0, 370.0, 110.0, 100.0, 50.0, 70.0, 90.0, -10.0, 70.0, 60.0, -40.0, 150.0, 160.0, 45.0, -20.0, 80.0, 330.0, 60.0, 44.0, 20.0, 60.0, 80.0, 44.0, 48.0, 70.0, 24.0, 80.0, 130.0, 30.0, 40.0, 28.0, 70.0, 40.0, 28.0, 40.0, 43.0, 43.0, 15.0, 13.0, 15.0, 32.0, 100.0, 120.0, 50.0, 39.0, 49.0, 90.0, 100.0, 90.0, 50.0, 120.0, 40.0, 45.0, 40.0, 50.0, 20.0, 20.0, 50.0, 75.0, 0.0, 180.0, 130.0, 80.0, 69.0, 50.0, 69.0, 120.0, 310.0, 60.0, 50.0, 80.0, 86.0, 55.0, -7.0, 110.0, 99.0, 157.0, 169.0, 110.0, 120.0, 153.0, 80.0, -1.0, 70.0, 100.0, 30.0, 80.0, 8.0, 70.0, 26.0, 67.0, 120.0, 90.0, 70.0, 120.0, 40.0, 39.0, 110.0, 100.0, -446.0, 115.0, 20.0, 20.0, 120.0, 40.0, 91.0, 60.0, 100.0, 100.0, 45.0, 61.0, 278.0, 89.0, 188.0, 90.0, 30.0, 60.0, 34.0, 190.0, 50.0, 88.0, 83.0, 70.0, 60.0, 59.0, 118.0, 89.0, 25.0, 100.0, 70.0, 60.0, 100.0, 40.0, 180.0, 160.0, 40.0, 50.0, 90.0, 100.0, 40.0, 50.0, 50.0, 106.0, -30.0, -1.0, 278.0, 100.0, 60.0, 85.0, 110.0, 80.0, 50.0, 228.0, 20.0, 120.0, 100.0, 30.0, -30.0, 100.0, 40.0, 176.0, 80.0, 44.0, 77.0, 50.0, 170.0, 70.0, 80.0, -24.0, -24.0, 170.0, 100.0, 87.0, 120.0, 79.0, 25.0, 75.0, 110.0, 69.0, 66.0, 120.0, 56.0, 29.0, 24.0, -11.0, 10.0, 190.0, 20.0, 0.0, 28.0, 60.0, 77.0, 30.0, 150.0, 25.0, 60.0, 60.0, 12.0, 50.0, 24.0, 39.0, 60.0, 101.0, 220.0, 88.0, 60.0, 80.0, 74.0, 70.0, 70.0, 20.0, 120.0, 48.0, 40.0, 29.0, 80.0, 19.0, -20.0, 190.0, 69.0, 49.0, -120.0, 100.0, 99.0, 90.0, 58.0, 70.0, 110.0, 120.0, 60.0, 60.0, 241.0, 69.0, 184.0, 36.0, 50.0, 53.0, 10.0, 120.0, 35.0, 40.0, 40.0, 19.0, 50.0, 29.0, 17.0, 180.0, 70.0, 52.0, 157.0, 60.0, 100.0, 40.0, 110.0, 80.0, 60.0, 60.0, 20.0, 20.0, 50.0, 50.0, 70.0, -24.0, 39.0, 8.0, 10.0, 19.0, 198.0, 210.0, 28.0, 160.0, 70.0, 118.0, 62.0, 150.0, 100.0, 31.0, 57.0, 134.0, -20.0, 173.0, 160.0, 36.0, 180.0, 50.0, 28.0, 99.0, 120.0, 90.0, -5.0, 161.0, 160.0, 89.0, 38.0, 160.0, 50.0, 112.0, 60.0, 100.0, 50.0, 20.0, 369.0, -91.0, -7.0, 74.0, -12.0, 27.0, -70.0, 120.0, 100.0, 90.0, 40.0, 50.0, 40.0, 80.0, 90.0, 50.0, 20.0, 55.0, 130.0, 290.0, 50.0, 100.0, 170.0, 50.0, 130.0, 190.0, 109.0, 78.0, 39.0, 48.0, 50.0, 80.0, 51.0, 100.0, 29.0, 44.0, 40.0, 50.0, 70.0, 50.0, 20.0, 40.0, 110.0, 53.0, 23.0, 100.0, 110.0, 70.0, 60.0, 50.0, 88.0, 37.0, 58.0, 86.0, 70.0, 60.0, 130.0, -181.0, 48.0, 100.0, 90.0, 45.0, 60.0, 18.0, 200.0, -4.0, 50.0, 60.0, 110.0, 60.0, -3.0, 59.0, 290.0, -116.0, 68.0, 27.0, 530.0, 59.0, 130.0, -50.0, 50.0, 50.0, 25.0, 190.0, 110.0, 50.0, 20.0, 40.0, 80.0, 80.0, 61.0, 42.0, 40.0, 78.0, 290.0, -136.0, 300.0, 160.0, 59.0, 100.0, 40.0, 110.0, 20.0, 50.0, 59.0, 40.0, 179.0, -45.0, 50.0, 50.0, 80.0, -51.0, 115.0, 50.0, -3.0, 570.0, 90.0, 57.0, 10.0, 39.0, -21.0, 50.0, 70.0, 50.0, 300.0, 130.0, 58.0, 70.0, 90.0, 80.0, 66.0, 57.0, 10.0, 90.0, 141.0, 28.0, 18.0, 18.0, 88.0, 40.0, 60.0, 25.0, 70.0, 30.0, 92.0, 55.0, 63.0, 70.0, 50.0, 70.0, -90.0, 70.0, 74.0, 55.0, 40.0, 78.0, 110.0, 25.0, 79.0, 30.0, -18.0, -115.0, 40.0, -40.0, 52.0, 330.0, 48.0, 320.0, 170.0, -24.0, 120.0, 50.0, 59.0, 110.0, 70.0, 90.0, 35.0, 50.0, 40.0, 100.0, -3.0, 39.0, 60.0, 30.0, 70.0, 46.0, -35.0, 36.0, 190.0, 60.0, 110.0, 140.0, 10.0, 119.0, 91.0, 46.0, 70.0, -61.0, 90.0, 180.0, -15.0, 30.0, 70.0, 90.0, 190.0, 60.0, 28.0, 80.0, 70.0, 7.0, 178.0, 79.0, -135.0, 330.0, 109.0, 73.0, -11.0, 79.0, 57.0, 190.0, 53.0, 99.0, 170.0, 50.0, 80.0, 20.0, 61.0, 31.0, 90.0, 10.0, -10.0, 70.0, 19.0, -6.0, 29.0, 100.0, 380.0, 70.0, 18.0, 70.0, 64.0, 90.0, -50.0, 150.0, 950.0, 210.0, 119.0, 99.0, 60.0, 80.0, 40.0, 132.0, 90.0, 4.0, -35.0, 150.0, 50.0, 120.0, -31.0, 30.0, 29.0, 50.0, 100.0, 60.0, 60.0, 50.0, 70.0, -5.0, 160.0, 70.0, 170.0, 50.0, 25.0, 3.0, 5.0, 260.0, 13.0, 20.0, 35.0, 0.0, 36.0, 84.0, 107.0, 60.0, 10.0, 130.0, 24.0, 120.0, 26.0, 50.0, 105.0, 90.0, 170.0, 140.0, -85.0, 100.0, 80.0, 75.0, -35.0, -100.0, 170.0, -17.0, 50.0, 11.0, 80.0, 80.0, 190.0, 70.0, 100.0, 190.0, 60.0, 8.0, 40.0, 0.0, 90.0, 50.0, 40.0, 70.0, 30.0, 40.0, -16.0, 48.0, 46.0, 20.0, 90.0, 257.0, 45.0, 12.0, 60.0, 135.0, 45.0, 70.0, 75.0, -10.0, 220.0, 199.0, 110.0, 16.0, 110.0, 60.0, 45.0, 14.0, 6.0, 70.0, 120.0, 19.0, 24.0, 68.0, 38.0, 362.0, 40.0, 90.0, 69.0, 30.0, 90.0, -1.0, 20.0, 20.0, 70.0, 60.0, 24.0, 30.0, 90.0, 190.0, 180.0, -5.0, 90.0, 50.0, 120.0, 130.0, 20.0, 10.0, 178.0, 110.0, 40.0, 57.0, 45.0, 20.0, -5.0, 168.0, 160.0, -60.0, 60.0, 40.0, 180.0, 38.0, 18.0, 70.0, -52.0, 170.0, -3.0, 20.0, 19.0, 35.0, 18.0, 50.0, 50.0, 100.0, 50.0, 40.0, 40.0, 60.0, 70.0, 79.0, 210.0, 169.0, 2.0, 310.0, 15.0, 50.0, 20.0, 100.0, 20.0, -1.0, 60.0, 40.0, 20.0, -5.0, 48.0, 23.0, 60.0, 160.0, 88.0, 90.0, 80.0, 30.0, 110.0, 210.0, 30.0, 40.0, 80.0, 90.0, -19.0, -14.0, 120.0, 80.0, 90.0, 220.0, 40.0, 50.0, 37.0, 40.0, 149.0, 50.0, 109.0, 200.0, 55.0, 29.0, -37.0, 40.0, 6.0, 110.0, 70.0, 62.0, 78.0, 4.0, 15.0, 130.0, 60.0, 15.0, 47.0, 12.0, 90.0, 52.0, 7.0, 90.0, 270.0, 20.0, 5.0, 50.0, 68.0, 60.0, 70.0, 70.0, 89.0, 61.0, 120.0, 70.0, 70.0, 170.0, 80.0, 170.0, 50.0, 70.0, 80.0, 78.0, 87.0, 40.0, 30.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0849937518861537, "mean_inference_ms": 2.404832266207129, "mean_action_processing_ms": 0.807346757134147, "mean_env_wait_ms": 1.6725582921637459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06481409072875977, "StateBufferConnector_ms": 0.010023832321166992, "ViewRequirementAgentConnector_ms": 0.4596853256225586}, "num_episodes": 18, "episode_return_max": 1772.0, "episode_return_min": 325.0, "episode_return_mean": 740.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.92777133460029, "num_env_steps_trained_throughput_per_sec": 32.92777133460029, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 122228.547, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122228.495, "sample_time_ms": 3087.868, "learn_time_ms": 119119.566, "learn_throughput": 33.58, "synch_weights_time_ms": 12.063}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 68, "trial_id": "6085c_00000", "date": "2024-07-02_01-16-17", "timestamp": 1719897377, "time_this_iter_s": 121.49187302589417, "time_total_s": 10223.867414474487, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10223.867414474487, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 28.635465116279065, "ram_util_percent": 79.59011627906976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.312872859476981, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.200705542935096, "policy_loss": -0.006374695712499146, "vf_loss": 7.205851107181959, "vf_explained_var": 0.004790445264028157, "kl": 0.0122913257705015, "entropy": 1.0005569355365949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 643215.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "env_runners": {"episode_reward_max": 1772.0, "episode_reward_min": 325.0, "episode_reward_mean": 733.84, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -446.0}, "policy_reward_max": {"policy_0": 950.0}, "policy_reward_mean": {"policy_0": 73.384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [615.0, 1001.0, 468.0, 870.0, 929.0, 574.0, 339.0, 808.0, 520.0, 1018.0, 1052.0, 530.0, 358.0, 657.0, 1097.0, 734.0, 850.0, 838.0, 834.0, 693.0, 851.0, 406.0, 527.0, 843.0, 624.0, 647.0, 838.0, 674.0, 590.0, 718.0, 875.0, 919.0, 839.0, 600.0, 845.0, 964.0, 564.0, 636.0, 496.0, 689.0, 994.0, 695.0, 994.0, 553.0, 957.0, 877.0, 556.0, 585.0, 471.0, 763.0, 724.0, 493.0, 795.0, 610.0, 949.0, 664.0, 740.0, 1772.0, 550.0, 644.0, 581.0, 647.0, 540.0, 924.0, 428.0, 697.0, 895.0, 766.0, 488.0, 899.0, 643.0, 624.0, 379.0, 1005.0, 325.0, 898.0, 737.0, 672.0, 550.0, 643.0, 848.0, 735.0, 1246.0, 994.0, 695.0, 486.0, 1110.0, 1050.0, 833.0, 910.0, 800.0, 1164.0, 504.0, 812.0, 1003.0, 419.0, 533.0, 544.0, 416.0, 625.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [269.0, 29.0, 40.0, 25.0, 10.0, 67.0, 70.0, -35.0, 100.0, 40.0, 80.0, 15.0, 54.0, 44.0, 47.0, 160.0, 50.0, 172.0, 179.0, 200.0, 50.0, 60.0, 2.0, 80.0, 49.0, 110.0, 120.0, -33.0, 10.0, 20.0, 370.0, 110.0, 100.0, 50.0, 70.0, 90.0, -10.0, 70.0, 60.0, -40.0, 150.0, 160.0, 45.0, -20.0, 80.0, 330.0, 60.0, 44.0, 20.0, 60.0, 80.0, 44.0, 48.0, 70.0, 24.0, 80.0, 130.0, 30.0, 40.0, 28.0, 70.0, 40.0, 28.0, 40.0, 43.0, 43.0, 15.0, 13.0, 15.0, 32.0, 100.0, 120.0, 50.0, 39.0, 49.0, 90.0, 100.0, 90.0, 50.0, 120.0, 40.0, 45.0, 40.0, 50.0, 20.0, 20.0, 50.0, 75.0, 0.0, 180.0, 130.0, 80.0, 69.0, 50.0, 69.0, 120.0, 310.0, 60.0, 50.0, 80.0, 86.0, 55.0, -7.0, 110.0, 99.0, 157.0, 169.0, 110.0, 120.0, 153.0, 80.0, -1.0, 70.0, 100.0, 30.0, 80.0, 8.0, 70.0, 26.0, 67.0, 120.0, 90.0, 70.0, 120.0, 40.0, 39.0, 110.0, 100.0, -446.0, 115.0, 20.0, 20.0, 120.0, 40.0, 91.0, 60.0, 100.0, 100.0, 45.0, 61.0, 278.0, 89.0, 188.0, 90.0, 30.0, 60.0, 34.0, 190.0, 50.0, 88.0, 83.0, 70.0, 60.0, 59.0, 118.0, 89.0, 25.0, 100.0, 70.0, 60.0, 100.0, 40.0, 180.0, 160.0, 40.0, 50.0, 90.0, 100.0, 40.0, 50.0, 50.0, 106.0, -30.0, -1.0, 278.0, 100.0, 60.0, 85.0, 110.0, 80.0, 50.0, 228.0, 20.0, 120.0, 100.0, 30.0, -30.0, 100.0, 40.0, 176.0, 80.0, 44.0, 77.0, 50.0, 170.0, 70.0, 80.0, -24.0, -24.0, 170.0, 100.0, 87.0, 120.0, 79.0, 25.0, 75.0, 110.0, 69.0, 66.0, 120.0, 56.0, 29.0, 24.0, -11.0, 10.0, 190.0, 20.0, 0.0, 28.0, 60.0, 77.0, 30.0, 150.0, 25.0, 60.0, 60.0, 12.0, 50.0, 24.0, 39.0, 60.0, 101.0, 220.0, 88.0, 60.0, 80.0, 74.0, 70.0, 70.0, 20.0, 120.0, 48.0, 40.0, 29.0, 80.0, 19.0, -20.0, 190.0, 69.0, 49.0, -120.0, 100.0, 99.0, 90.0, 58.0, 70.0, 110.0, 120.0, 60.0, 60.0, 241.0, 69.0, 184.0, 36.0, 50.0, 53.0, 10.0, 120.0, 35.0, 40.0, 40.0, 19.0, 50.0, 29.0, 17.0, 180.0, 70.0, 52.0, 157.0, 60.0, 100.0, 40.0, 110.0, 80.0, 60.0, 60.0, 20.0, 20.0, 50.0, 50.0, 70.0, -24.0, 39.0, 8.0, 10.0, 19.0, 198.0, 210.0, 28.0, 160.0, 70.0, 118.0, 62.0, 150.0, 100.0, 31.0, 57.0, 134.0, -20.0, 173.0, 160.0, 36.0, 180.0, 50.0, 28.0, 99.0, 120.0, 90.0, -5.0, 161.0, 160.0, 89.0, 38.0, 160.0, 50.0, 112.0, 60.0, 100.0, 50.0, 20.0, 369.0, -91.0, -7.0, 74.0, -12.0, 27.0, -70.0, 120.0, 100.0, 90.0, 40.0, 50.0, 40.0, 80.0, 90.0, 50.0, 20.0, 55.0, 130.0, 290.0, 50.0, 100.0, 170.0, 50.0, 130.0, 190.0, 109.0, 78.0, 39.0, 48.0, 50.0, 80.0, 51.0, 100.0, 29.0, 44.0, 40.0, 50.0, 70.0, 50.0, 20.0, 40.0, 110.0, 53.0, 23.0, 100.0, 110.0, 70.0, 60.0, 50.0, 88.0, 37.0, 58.0, 86.0, 70.0, 60.0, 130.0, -181.0, 48.0, 100.0, 90.0, 45.0, 60.0, 18.0, 200.0, -4.0, 50.0, 60.0, 110.0, 60.0, -3.0, 59.0, 290.0, -116.0, 68.0, 27.0, 530.0, 59.0, 130.0, -50.0, 50.0, 50.0, 25.0, 190.0, 110.0, 50.0, 20.0, 40.0, 80.0, 80.0, 61.0, 42.0, 40.0, 78.0, 290.0, -136.0, 300.0, 160.0, 59.0, 100.0, 40.0, 110.0, 20.0, 50.0, 59.0, 40.0, 179.0, -45.0, 50.0, 50.0, 80.0, -51.0, 115.0, 50.0, -3.0, 570.0, 90.0, 57.0, 10.0, 39.0, -21.0, 50.0, 70.0, 50.0, 300.0, 130.0, 58.0, 70.0, 90.0, 80.0, 66.0, 57.0, 10.0, 90.0, 141.0, 28.0, 18.0, 18.0, 88.0, 40.0, 60.0, 25.0, 70.0, 30.0, 92.0, 55.0, 63.0, 70.0, 50.0, 70.0, -90.0, 70.0, 74.0, 55.0, 40.0, 78.0, 110.0, 25.0, 79.0, 30.0, -18.0, -115.0, 40.0, -40.0, 52.0, 330.0, 48.0, 320.0, 170.0, -24.0, 120.0, 50.0, 59.0, 110.0, 70.0, 90.0, 35.0, 50.0, 40.0, 100.0, -3.0, 39.0, 60.0, 30.0, 70.0, 46.0, -35.0, 36.0, 190.0, 60.0, 110.0, 140.0, 10.0, 119.0, 91.0, 46.0, 70.0, -61.0, 90.0, 180.0, -15.0, 30.0, 70.0, 90.0, 190.0, 60.0, 28.0, 80.0, 70.0, 7.0, 178.0, 79.0, -135.0, 330.0, 109.0, 73.0, -11.0, 79.0, 57.0, 190.0, 53.0, 99.0, 170.0, 50.0, 80.0, 20.0, 61.0, 31.0, 90.0, 10.0, -10.0, 70.0, 19.0, -6.0, 29.0, 100.0, 380.0, 70.0, 18.0, 70.0, 64.0, 90.0, -50.0, 150.0, 950.0, 210.0, 119.0, 99.0, 60.0, 80.0, 40.0, 132.0, 90.0, 4.0, -35.0, 150.0, 50.0, 120.0, -31.0, 30.0, 29.0, 50.0, 100.0, 60.0, 60.0, 50.0, 70.0, -5.0, 160.0, 70.0, 170.0, 50.0, 25.0, 3.0, 5.0, 260.0, 13.0, 20.0, 35.0, 0.0, 36.0, 84.0, 107.0, 60.0, 10.0, 130.0, 24.0, 120.0, 26.0, 50.0, 105.0, 90.0, 170.0, 140.0, -85.0, 100.0, 80.0, 75.0, -35.0, -100.0, 170.0, -17.0, 50.0, 11.0, 80.0, 80.0, 190.0, 70.0, 100.0, 190.0, 60.0, 8.0, 40.0, 0.0, 90.0, 50.0, 40.0, 70.0, 30.0, 40.0, -16.0, 48.0, 46.0, 20.0, 90.0, 257.0, 45.0, 12.0, 60.0, 135.0, 45.0, 70.0, 75.0, -10.0, 220.0, 199.0, 110.0, 16.0, 110.0, 60.0, 45.0, 14.0, 6.0, 70.0, 120.0, 19.0, 24.0, 68.0, 38.0, 362.0, 40.0, 90.0, 69.0, 30.0, 90.0, -1.0, 20.0, 20.0, 70.0, 60.0, 24.0, 30.0, 90.0, 190.0, 180.0, -5.0, 90.0, 50.0, 120.0, 130.0, 20.0, 10.0, 178.0, 110.0, 40.0, 57.0, 45.0, 20.0, -5.0, 168.0, 160.0, -60.0, 60.0, 40.0, 180.0, 38.0, 18.0, 70.0, -52.0, 170.0, -3.0, 20.0, 19.0, 35.0, 18.0, 50.0, 50.0, 100.0, 50.0, 40.0, 40.0, 60.0, 70.0, 79.0, 210.0, 169.0, 2.0, 310.0, 15.0, 50.0, 20.0, 100.0, 20.0, -1.0, 60.0, 40.0, 20.0, -5.0, 48.0, 23.0, 60.0, 160.0, 88.0, 90.0, 80.0, 30.0, 110.0, 210.0, 30.0, 40.0, 80.0, 90.0, -19.0, -14.0, 120.0, 80.0, 90.0, 220.0, 40.0, 50.0, 37.0, 40.0, 149.0, 50.0, 109.0, 200.0, 55.0, 29.0, -37.0, 40.0, 6.0, 110.0, 70.0, 62.0, 78.0, 4.0, 15.0, 130.0, 60.0, 15.0, 47.0, 12.0, 90.0, 52.0, 7.0, 90.0, 270.0, 20.0, 5.0, 50.0, 68.0, 60.0, 70.0, 70.0, 89.0, 61.0, 120.0, 70.0, 70.0, 170.0, 80.0, 170.0, 50.0, 70.0, 80.0, 78.0, 87.0, 40.0, 30.0, 50.0, 47.0, -55.0, 162.0, 200.0, -110.0, 164.0, 640.0, -2.0, 110.0, 90.0, 64.0, 67.0, 64.0, 100.0, 150.0, 89.0, 90.0, 130.0, 140.0, 100.0, -130.0, 70.0, 60.0, 90.0, 70.0, 70.0, 100.0, 320.0, 45.0, 0.0, 20.0, 60.0, 100.0, 30.0, 40.0, 19.0, 50.0, 30.0, 59.0, 78.0, 100.0, 100.0, 90.0, 100.0, 300.0, 60.0, 110.0, 50.0, 100.0, 100.0, 80.0, 110.0, 110.0, 70.0, 100.0, 120.0, 70.0, 190.0, 100.0, 100.0, 90.0, 47.0, 100.0, 80.0, -10.0, 19.0, 70.0, 299.0, 58.0, 80.0, 70.0, 120.0, 50.0, 260.0, 130.0, 80.0, 60.0, 70.0, 0.0, 70.0, 0.0, 20.0, 160.0, 120.0, 90.0, 20.0, 90.0, 60.0, 150.0, 90.0, 80.0, 60.0, 100.0, 80.0, 100.0, -35.0, 730.0, -101.0, 100.0, 50.0, 100.0, -43.0, 41.0, 90.0, 38.0, 64.0, 50.0, 48.0, 62.0, 54.0, 9.0, 70.0, 40.0, -35.0, 70.0, 60.0, 220.0, 199.0, 120.0, 59.0, 1.0, 100.0, 12.0, 230.0, 70.0, 70.0, 150.0, 20.0, 200.0, 150.0, 370.0, -30.0, 76.0, 1.0, -7.0, 70.0, -100.0, 20.0, -11.0, 30.0, 169.0, 29.0, 10.0, 30.0, 179.0, 9.0, 29.0, 60.0, -7.0, 25.0, 29.0, -20.0, 70.0, 60.0, 38.0, -15.0, 177.0, 130.0, 25.0, 50.0, 30.0, 10.0, 28.0, 70.0, 34.0, 30.0, 80.0, 70.0, 4.0, 60.0, 130.0, 170.0, 0.0, 90.0, 3.0, 90.0, 50.0, 0.0, 12.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0771977906499335, "mean_inference_ms": 2.3963512644406664, "mean_action_processing_ms": 0.80468112153866, "mean_env_wait_ms": 1.6669266343755005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06349849700927734, "StateBufferConnector_ms": 0.010139703750610352, "ViewRequirementAgentConnector_ms": 0.4530761241912842}, "num_episodes": 18, "episode_return_max": 1772.0, "episode_return_min": 325.0, "episode_return_mean": 733.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.480468240858166, "num_env_steps_trained_throughput_per_sec": 32.480468240858166, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 2760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2760000, "timers": {"training_iteration_time_ms": 122298.514, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122298.466, "sample_time_ms": 2970.282, "learn_time_ms": 119306.998, "learn_throughput": 33.527, "synch_weights_time_ms": 12.076}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "done": false, "training_iteration": 69, "trial_id": "6085c_00000", "date": "2024-07-02_01-18-20", "timestamp": 1719897500, "time_this_iter_s": 123.16752409934998, "time_total_s": 10347.034938573837, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138ad0280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10347.034938573837, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 29.277586206896558, "ram_util_percent": 80.30344827586207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1513506274825085, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.084545239092062, "policy_loss": -0.006084261185993442, "vf_loss": 7.089766232629681, "vf_explained_var": 0.002922673588489699, "kl": 0.008632709235268215, "entropy": 1.0165748248148523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 652605.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 1772.0, "episode_reward_min": 325.0, "episode_reward_mean": 736.27, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -181.0}, "policy_reward_max": {"policy_0": 950.0}, "policy_reward_mean": {"policy_0": 73.627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [834.0, 693.0, 851.0, 406.0, 527.0, 843.0, 624.0, 647.0, 838.0, 674.0, 590.0, 718.0, 875.0, 919.0, 839.0, 600.0, 845.0, 964.0, 564.0, 636.0, 496.0, 689.0, 994.0, 695.0, 994.0, 553.0, 957.0, 877.0, 556.0, 585.0, 471.0, 763.0, 724.0, 493.0, 795.0, 610.0, 949.0, 664.0, 740.0, 1772.0, 550.0, 644.0, 581.0, 647.0, 540.0, 924.0, 428.0, 697.0, 895.0, 766.0, 488.0, 899.0, 643.0, 624.0, 379.0, 1005.0, 325.0, 898.0, 737.0, 672.0, 550.0, 643.0, 848.0, 735.0, 1246.0, 994.0, 695.0, 486.0, 1110.0, 1050.0, 833.0, 910.0, 800.0, 1164.0, 504.0, 812.0, 1003.0, 419.0, 533.0, 544.0, 416.0, 625.0, 478.0, 624.0, 722.0, 576.0, 743.0, 850.0, 819.0, 1228.0, 845.0, 541.0, 394.0, 742.0, 837.0, 426.0, 1227.0, 733.0, 749.0, 967.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 228.0, 20.0, 120.0, 100.0, 30.0, -30.0, 100.0, 40.0, 176.0, 80.0, 44.0, 77.0, 50.0, 170.0, 70.0, 80.0, -24.0, -24.0, 170.0, 100.0, 87.0, 120.0, 79.0, 25.0, 75.0, 110.0, 69.0, 66.0, 120.0, 56.0, 29.0, 24.0, -11.0, 10.0, 190.0, 20.0, 0.0, 28.0, 60.0, 77.0, 30.0, 150.0, 25.0, 60.0, 60.0, 12.0, 50.0, 24.0, 39.0, 60.0, 101.0, 220.0, 88.0, 60.0, 80.0, 74.0, 70.0, 70.0, 20.0, 120.0, 48.0, 40.0, 29.0, 80.0, 19.0, -20.0, 190.0, 69.0, 49.0, -120.0, 100.0, 99.0, 90.0, 58.0, 70.0, 110.0, 120.0, 60.0, 60.0, 241.0, 69.0, 184.0, 36.0, 50.0, 53.0, 10.0, 120.0, 35.0, 40.0, 40.0, 19.0, 50.0, 29.0, 17.0, 180.0, 70.0, 52.0, 157.0, 60.0, 100.0, 40.0, 110.0, 80.0, 60.0, 60.0, 20.0, 20.0, 50.0, 50.0, 70.0, -24.0, 39.0, 8.0, 10.0, 19.0, 198.0, 210.0, 28.0, 160.0, 70.0, 118.0, 62.0, 150.0, 100.0, 31.0, 57.0, 134.0, -20.0, 173.0, 160.0, 36.0, 180.0, 50.0, 28.0, 99.0, 120.0, 90.0, -5.0, 161.0, 160.0, 89.0, 38.0, 160.0, 50.0, 112.0, 60.0, 100.0, 50.0, 20.0, 369.0, -91.0, -7.0, 74.0, -12.0, 27.0, -70.0, 120.0, 100.0, 90.0, 40.0, 50.0, 40.0, 80.0, 90.0, 50.0, 20.0, 55.0, 130.0, 290.0, 50.0, 100.0, 170.0, 50.0, 130.0, 190.0, 109.0, 78.0, 39.0, 48.0, 50.0, 80.0, 51.0, 100.0, 29.0, 44.0, 40.0, 50.0, 70.0, 50.0, 20.0, 40.0, 110.0, 53.0, 23.0, 100.0, 110.0, 70.0, 60.0, 50.0, 88.0, 37.0, 58.0, 86.0, 70.0, 60.0, 130.0, -181.0, 48.0, 100.0, 90.0, 45.0, 60.0, 18.0, 200.0, -4.0, 50.0, 60.0, 110.0, 60.0, -3.0, 59.0, 290.0, -116.0, 68.0, 27.0, 530.0, 59.0, 130.0, -50.0, 50.0, 50.0, 25.0, 190.0, 110.0, 50.0, 20.0, 40.0, 80.0, 80.0, 61.0, 42.0, 40.0, 78.0, 290.0, -136.0, 300.0, 160.0, 59.0, 100.0, 40.0, 110.0, 20.0, 50.0, 59.0, 40.0, 179.0, -45.0, 50.0, 50.0, 80.0, -51.0, 115.0, 50.0, -3.0, 570.0, 90.0, 57.0, 10.0, 39.0, -21.0, 50.0, 70.0, 50.0, 300.0, 130.0, 58.0, 70.0, 90.0, 80.0, 66.0, 57.0, 10.0, 90.0, 141.0, 28.0, 18.0, 18.0, 88.0, 40.0, 60.0, 25.0, 70.0, 30.0, 92.0, 55.0, 63.0, 70.0, 50.0, 70.0, -90.0, 70.0, 74.0, 55.0, 40.0, 78.0, 110.0, 25.0, 79.0, 30.0, -18.0, -115.0, 40.0, -40.0, 52.0, 330.0, 48.0, 320.0, 170.0, -24.0, 120.0, 50.0, 59.0, 110.0, 70.0, 90.0, 35.0, 50.0, 40.0, 100.0, -3.0, 39.0, 60.0, 30.0, 70.0, 46.0, -35.0, 36.0, 190.0, 60.0, 110.0, 140.0, 10.0, 119.0, 91.0, 46.0, 70.0, -61.0, 90.0, 180.0, -15.0, 30.0, 70.0, 90.0, 190.0, 60.0, 28.0, 80.0, 70.0, 7.0, 178.0, 79.0, -135.0, 330.0, 109.0, 73.0, -11.0, 79.0, 57.0, 190.0, 53.0, 99.0, 170.0, 50.0, 80.0, 20.0, 61.0, 31.0, 90.0, 10.0, -10.0, 70.0, 19.0, -6.0, 29.0, 100.0, 380.0, 70.0, 18.0, 70.0, 64.0, 90.0, -50.0, 150.0, 950.0, 210.0, 119.0, 99.0, 60.0, 80.0, 40.0, 132.0, 90.0, 4.0, -35.0, 150.0, 50.0, 120.0, -31.0, 30.0, 29.0, 50.0, 100.0, 60.0, 60.0, 50.0, 70.0, -5.0, 160.0, 70.0, 170.0, 50.0, 25.0, 3.0, 5.0, 260.0, 13.0, 20.0, 35.0, 0.0, 36.0, 84.0, 107.0, 60.0, 10.0, 130.0, 24.0, 120.0, 26.0, 50.0, 105.0, 90.0, 170.0, 140.0, -85.0, 100.0, 80.0, 75.0, -35.0, -100.0, 170.0, -17.0, 50.0, 11.0, 80.0, 80.0, 190.0, 70.0, 100.0, 190.0, 60.0, 8.0, 40.0, 0.0, 90.0, 50.0, 40.0, 70.0, 30.0, 40.0, -16.0, 48.0, 46.0, 20.0, 90.0, 257.0, 45.0, 12.0, 60.0, 135.0, 45.0, 70.0, 75.0, -10.0, 220.0, 199.0, 110.0, 16.0, 110.0, 60.0, 45.0, 14.0, 6.0, 70.0, 120.0, 19.0, 24.0, 68.0, 38.0, 362.0, 40.0, 90.0, 69.0, 30.0, 90.0, -1.0, 20.0, 20.0, 70.0, 60.0, 24.0, 30.0, 90.0, 190.0, 180.0, -5.0, 90.0, 50.0, 120.0, 130.0, 20.0, 10.0, 178.0, 110.0, 40.0, 57.0, 45.0, 20.0, -5.0, 168.0, 160.0, -60.0, 60.0, 40.0, 180.0, 38.0, 18.0, 70.0, -52.0, 170.0, -3.0, 20.0, 19.0, 35.0, 18.0, 50.0, 50.0, 100.0, 50.0, 40.0, 40.0, 60.0, 70.0, 79.0, 210.0, 169.0, 2.0, 310.0, 15.0, 50.0, 20.0, 100.0, 20.0, -1.0, 60.0, 40.0, 20.0, -5.0, 48.0, 23.0, 60.0, 160.0, 88.0, 90.0, 80.0, 30.0, 110.0, 210.0, 30.0, 40.0, 80.0, 90.0, -19.0, -14.0, 120.0, 80.0, 90.0, 220.0, 40.0, 50.0, 37.0, 40.0, 149.0, 50.0, 109.0, 200.0, 55.0, 29.0, -37.0, 40.0, 6.0, 110.0, 70.0, 62.0, 78.0, 4.0, 15.0, 130.0, 60.0, 15.0, 47.0, 12.0, 90.0, 52.0, 7.0, 90.0, 270.0, 20.0, 5.0, 50.0, 68.0, 60.0, 70.0, 70.0, 89.0, 61.0, 120.0, 70.0, 70.0, 170.0, 80.0, 170.0, 50.0, 70.0, 80.0, 78.0, 87.0, 40.0, 30.0, 50.0, 47.0, -55.0, 162.0, 200.0, -110.0, 164.0, 640.0, -2.0, 110.0, 90.0, 64.0, 67.0, 64.0, 100.0, 150.0, 89.0, 90.0, 130.0, 140.0, 100.0, -130.0, 70.0, 60.0, 90.0, 70.0, 70.0, 100.0, 320.0, 45.0, 0.0, 20.0, 60.0, 100.0, 30.0, 40.0, 19.0, 50.0, 30.0, 59.0, 78.0, 100.0, 100.0, 90.0, 100.0, 300.0, 60.0, 110.0, 50.0, 100.0, 100.0, 80.0, 110.0, 110.0, 70.0, 100.0, 120.0, 70.0, 190.0, 100.0, 100.0, 90.0, 47.0, 100.0, 80.0, -10.0, 19.0, 70.0, 299.0, 58.0, 80.0, 70.0, 120.0, 50.0, 260.0, 130.0, 80.0, 60.0, 70.0, 0.0, 70.0, 0.0, 20.0, 160.0, 120.0, 90.0, 20.0, 90.0, 60.0, 150.0, 90.0, 80.0, 60.0, 100.0, 80.0, 100.0, -35.0, 730.0, -101.0, 100.0, 50.0, 100.0, -43.0, 41.0, 90.0, 38.0, 64.0, 50.0, 48.0, 62.0, 54.0, 9.0, 70.0, 40.0, -35.0, 70.0, 60.0, 220.0, 199.0, 120.0, 59.0, 1.0, 100.0, 12.0, 230.0, 70.0, 70.0, 150.0, 20.0, 200.0, 150.0, 370.0, -30.0, 76.0, 1.0, -7.0, 70.0, -100.0, 20.0, -11.0, 30.0, 169.0, 29.0, 10.0, 30.0, 179.0, 9.0, 29.0, 60.0, -7.0, 25.0, 29.0, -20.0, 70.0, 60.0, 38.0, -15.0, 177.0, 130.0, 25.0, 50.0, 30.0, 10.0, 28.0, 70.0, 34.0, 30.0, 80.0, 70.0, 4.0, 60.0, 130.0, 170.0, 0.0, 90.0, 3.0, 90.0, 50.0, 0.0, 12.0, 80.0, 0.0, -5.0, 18.0, 60.0, 70.0, 20.0, 50.0, 150.0, -145.0, 260.0, 160.0, 90.0, 38.0, 56.0, -2.0, 150.0, 74.0, 16.0, 37.0, 5.0, 160.0, 20.0, 130.0, 17.0, 37.0, 39.0, 55.0, 14.0, 170.0, 80.0, 58.0, 90.0, 20.0, 0.0, 10.0, 70.0, 60.0, 18.0, 160.0, 90.0, -45.0, 90.0, 50.0, 158.0, 60.0, 77.0, 59.0, 66.0, 150.0, 78.0, 3.0, 76.0, 10.0, 190.0, 180.0, 210.0, 110.0, 20.0, -6.0, 57.0, 70.0, 70.0, 110.0, 100.0, 36.0, 67.0, 38.0, 60.0, 168.0, 100.0, 206.0, 72.0, 60.0, 70.0, 20.0, 320.0, 190.0, 20.0, 190.0, 80.0, 40.0, 80.0, 270.0, 5.0, 50.0, 70.0, 70.0, 100.0, 100.0, 60.0, 75.0, 40.0, 60.0, 60.0, 11.0, 30.0, 157.0, 60.0, 44.0, 4.0, 105.0, 55.0, 40.0, -12.0, -21.0, 15.0, 170.0, 20.0, -1.0, 23.0, 40.0, 56.0, 140.0, 69.0, 80.0, 50.0, 64.0, 50.0, 130.0, 63.0, 80.0, 70.0, 180.0, 29.0, 130.0, 28.0, 60.0, 90.0, 90.0, 80.0, 100.0, 30.0, 52.0, 20.0, 10.0, 40.0, 84.0, 60.0, 30.0, 0.0, 20.0, -3.0, 100.0, 40.0, 108.0, 10.0, 408.0, 104.0, 120.0, 320.0, 63.0, 6.0, 200.0, 109.0, 40.0, 83.0, 30.0, 130.0, 32.0, 40.0, 40.0, 50.0, 69.0, 80.0, 30.0, 160.0, 60.0, -20.0, 120.0, 160.0, 148.0, 50.0, 68.0, 95.0, 130.0, 26.0, 30.0, 60.0, 310.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0696782090036807, "mean_inference_ms": 2.387993580237927, "mean_action_processing_ms": 0.8020810073705311, "mean_env_wait_ms": 1.6614986216279322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06333684921264648, "StateBufferConnector_ms": 0.010065078735351562, "ViewRequirementAgentConnector_ms": 0.4583096504211426}, "num_episodes": 18, "episode_return_max": 1772.0, "episode_return_min": 325.0, "episode_return_mean": 736.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.77141603608173, "num_env_steps_trained_throughput_per_sec": 32.77141603608173, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 122238.516, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122238.468, "sample_time_ms": 2892.178, "learn_time_ms": 119325.466, "learn_throughput": 33.522, "synch_weights_time_ms": 11.794}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 70, "trial_id": "6085c_00000", "date": "2024-07-02_01-20-22", "timestamp": 1719897622, "time_this_iter_s": 122.07526969909668, "time_total_s": 10469.110208272934, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10469.110208272934, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 28.767052023121387, "ram_util_percent": 78.6635838150289}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1899513384404656, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.914564606328361, "policy_loss": -0.00639360810677631, "vf_loss": 6.920058117126124, "vf_explained_var": 0.007427505290292449, "kl": 0.009000917848706595, "entropy": 0.9981585149884351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 661995.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "env_runners": {"episode_reward_max": 1772.0, "episode_reward_min": 275.0, "episode_reward_mean": 724.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -258.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 72.495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [994.0, 695.0, 994.0, 553.0, 957.0, 877.0, 556.0, 585.0, 471.0, 763.0, 724.0, 493.0, 795.0, 610.0, 949.0, 664.0, 740.0, 1772.0, 550.0, 644.0, 581.0, 647.0, 540.0, 924.0, 428.0, 697.0, 895.0, 766.0, 488.0, 899.0, 643.0, 624.0, 379.0, 1005.0, 325.0, 898.0, 737.0, 672.0, 550.0, 643.0, 848.0, 735.0, 1246.0, 994.0, 695.0, 486.0, 1110.0, 1050.0, 833.0, 910.0, 800.0, 1164.0, 504.0, 812.0, 1003.0, 419.0, 533.0, 544.0, 416.0, 625.0, 478.0, 624.0, 722.0, 576.0, 743.0, 850.0, 819.0, 1228.0, 845.0, 541.0, 394.0, 742.0, 837.0, 426.0, 1227.0, 733.0, 749.0, 967.0, 585.0, 429.0, 705.0, 984.0, 859.0, 275.0, 583.0, 673.0, 467.0, 1350.0, 790.0, 727.0, 361.0, 451.0, 871.0, 598.0, 575.0, 668.0, 748.0, 904.0, 348.0, 589.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-3.0, 59.0, 290.0, -116.0, 68.0, 27.0, 530.0, 59.0, 130.0, -50.0, 50.0, 50.0, 25.0, 190.0, 110.0, 50.0, 20.0, 40.0, 80.0, 80.0, 61.0, 42.0, 40.0, 78.0, 290.0, -136.0, 300.0, 160.0, 59.0, 100.0, 40.0, 110.0, 20.0, 50.0, 59.0, 40.0, 179.0, -45.0, 50.0, 50.0, 80.0, -51.0, 115.0, 50.0, -3.0, 570.0, 90.0, 57.0, 10.0, 39.0, -21.0, 50.0, 70.0, 50.0, 300.0, 130.0, 58.0, 70.0, 90.0, 80.0, 66.0, 57.0, 10.0, 90.0, 141.0, 28.0, 18.0, 18.0, 88.0, 40.0, 60.0, 25.0, 70.0, 30.0, 92.0, 55.0, 63.0, 70.0, 50.0, 70.0, -90.0, 70.0, 74.0, 55.0, 40.0, 78.0, 110.0, 25.0, 79.0, 30.0, -18.0, -115.0, 40.0, -40.0, 52.0, 330.0, 48.0, 320.0, 170.0, -24.0, 120.0, 50.0, 59.0, 110.0, 70.0, 90.0, 35.0, 50.0, 40.0, 100.0, -3.0, 39.0, 60.0, 30.0, 70.0, 46.0, -35.0, 36.0, 190.0, 60.0, 110.0, 140.0, 10.0, 119.0, 91.0, 46.0, 70.0, -61.0, 90.0, 180.0, -15.0, 30.0, 70.0, 90.0, 190.0, 60.0, 28.0, 80.0, 70.0, 7.0, 178.0, 79.0, -135.0, 330.0, 109.0, 73.0, -11.0, 79.0, 57.0, 190.0, 53.0, 99.0, 170.0, 50.0, 80.0, 20.0, 61.0, 31.0, 90.0, 10.0, -10.0, 70.0, 19.0, -6.0, 29.0, 100.0, 380.0, 70.0, 18.0, 70.0, 64.0, 90.0, -50.0, 150.0, 950.0, 210.0, 119.0, 99.0, 60.0, 80.0, 40.0, 132.0, 90.0, 4.0, -35.0, 150.0, 50.0, 120.0, -31.0, 30.0, 29.0, 50.0, 100.0, 60.0, 60.0, 50.0, 70.0, -5.0, 160.0, 70.0, 170.0, 50.0, 25.0, 3.0, 5.0, 260.0, 13.0, 20.0, 35.0, 0.0, 36.0, 84.0, 107.0, 60.0, 10.0, 130.0, 24.0, 120.0, 26.0, 50.0, 105.0, 90.0, 170.0, 140.0, -85.0, 100.0, 80.0, 75.0, -35.0, -100.0, 170.0, -17.0, 50.0, 11.0, 80.0, 80.0, 190.0, 70.0, 100.0, 190.0, 60.0, 8.0, 40.0, 0.0, 90.0, 50.0, 40.0, 70.0, 30.0, 40.0, -16.0, 48.0, 46.0, 20.0, 90.0, 257.0, 45.0, 12.0, 60.0, 135.0, 45.0, 70.0, 75.0, -10.0, 220.0, 199.0, 110.0, 16.0, 110.0, 60.0, 45.0, 14.0, 6.0, 70.0, 120.0, 19.0, 24.0, 68.0, 38.0, 362.0, 40.0, 90.0, 69.0, 30.0, 90.0, -1.0, 20.0, 20.0, 70.0, 60.0, 24.0, 30.0, 90.0, 190.0, 180.0, -5.0, 90.0, 50.0, 120.0, 130.0, 20.0, 10.0, 178.0, 110.0, 40.0, 57.0, 45.0, 20.0, -5.0, 168.0, 160.0, -60.0, 60.0, 40.0, 180.0, 38.0, 18.0, 70.0, -52.0, 170.0, -3.0, 20.0, 19.0, 35.0, 18.0, 50.0, 50.0, 100.0, 50.0, 40.0, 40.0, 60.0, 70.0, 79.0, 210.0, 169.0, 2.0, 310.0, 15.0, 50.0, 20.0, 100.0, 20.0, -1.0, 60.0, 40.0, 20.0, -5.0, 48.0, 23.0, 60.0, 160.0, 88.0, 90.0, 80.0, 30.0, 110.0, 210.0, 30.0, 40.0, 80.0, 90.0, -19.0, -14.0, 120.0, 80.0, 90.0, 220.0, 40.0, 50.0, 37.0, 40.0, 149.0, 50.0, 109.0, 200.0, 55.0, 29.0, -37.0, 40.0, 6.0, 110.0, 70.0, 62.0, 78.0, 4.0, 15.0, 130.0, 60.0, 15.0, 47.0, 12.0, 90.0, 52.0, 7.0, 90.0, 270.0, 20.0, 5.0, 50.0, 68.0, 60.0, 70.0, 70.0, 89.0, 61.0, 120.0, 70.0, 70.0, 170.0, 80.0, 170.0, 50.0, 70.0, 80.0, 78.0, 87.0, 40.0, 30.0, 50.0, 47.0, -55.0, 162.0, 200.0, -110.0, 164.0, 640.0, -2.0, 110.0, 90.0, 64.0, 67.0, 64.0, 100.0, 150.0, 89.0, 90.0, 130.0, 140.0, 100.0, -130.0, 70.0, 60.0, 90.0, 70.0, 70.0, 100.0, 320.0, 45.0, 0.0, 20.0, 60.0, 100.0, 30.0, 40.0, 19.0, 50.0, 30.0, 59.0, 78.0, 100.0, 100.0, 90.0, 100.0, 300.0, 60.0, 110.0, 50.0, 100.0, 100.0, 80.0, 110.0, 110.0, 70.0, 100.0, 120.0, 70.0, 190.0, 100.0, 100.0, 90.0, 47.0, 100.0, 80.0, -10.0, 19.0, 70.0, 299.0, 58.0, 80.0, 70.0, 120.0, 50.0, 260.0, 130.0, 80.0, 60.0, 70.0, 0.0, 70.0, 0.0, 20.0, 160.0, 120.0, 90.0, 20.0, 90.0, 60.0, 150.0, 90.0, 80.0, 60.0, 100.0, 80.0, 100.0, -35.0, 730.0, -101.0, 100.0, 50.0, 100.0, -43.0, 41.0, 90.0, 38.0, 64.0, 50.0, 48.0, 62.0, 54.0, 9.0, 70.0, 40.0, -35.0, 70.0, 60.0, 220.0, 199.0, 120.0, 59.0, 1.0, 100.0, 12.0, 230.0, 70.0, 70.0, 150.0, 20.0, 200.0, 150.0, 370.0, -30.0, 76.0, 1.0, -7.0, 70.0, -100.0, 20.0, -11.0, 30.0, 169.0, 29.0, 10.0, 30.0, 179.0, 9.0, 29.0, 60.0, -7.0, 25.0, 29.0, -20.0, 70.0, 60.0, 38.0, -15.0, 177.0, 130.0, 25.0, 50.0, 30.0, 10.0, 28.0, 70.0, 34.0, 30.0, 80.0, 70.0, 4.0, 60.0, 130.0, 170.0, 0.0, 90.0, 3.0, 90.0, 50.0, 0.0, 12.0, 80.0, 0.0, -5.0, 18.0, 60.0, 70.0, 20.0, 50.0, 150.0, -145.0, 260.0, 160.0, 90.0, 38.0, 56.0, -2.0, 150.0, 74.0, 16.0, 37.0, 5.0, 160.0, 20.0, 130.0, 17.0, 37.0, 39.0, 55.0, 14.0, 170.0, 80.0, 58.0, 90.0, 20.0, 0.0, 10.0, 70.0, 60.0, 18.0, 160.0, 90.0, -45.0, 90.0, 50.0, 158.0, 60.0, 77.0, 59.0, 66.0, 150.0, 78.0, 3.0, 76.0, 10.0, 190.0, 180.0, 210.0, 110.0, 20.0, -6.0, 57.0, 70.0, 70.0, 110.0, 100.0, 36.0, 67.0, 38.0, 60.0, 168.0, 100.0, 206.0, 72.0, 60.0, 70.0, 20.0, 320.0, 190.0, 20.0, 190.0, 80.0, 40.0, 80.0, 270.0, 5.0, 50.0, 70.0, 70.0, 100.0, 100.0, 60.0, 75.0, 40.0, 60.0, 60.0, 11.0, 30.0, 157.0, 60.0, 44.0, 4.0, 105.0, 55.0, 40.0, -12.0, -21.0, 15.0, 170.0, 20.0, -1.0, 23.0, 40.0, 56.0, 140.0, 69.0, 80.0, 50.0, 64.0, 50.0, 130.0, 63.0, 80.0, 70.0, 180.0, 29.0, 130.0, 28.0, 60.0, 90.0, 90.0, 80.0, 100.0, 30.0, 52.0, 20.0, 10.0, 40.0, 84.0, 60.0, 30.0, 0.0, 20.0, -3.0, 100.0, 40.0, 108.0, 10.0, 408.0, 104.0, 120.0, 320.0, 63.0, 6.0, 200.0, 109.0, 40.0, 83.0, 30.0, 130.0, 32.0, 40.0, 40.0, 50.0, 69.0, 80.0, 30.0, 160.0, 60.0, -20.0, 120.0, 160.0, 148.0, 50.0, 68.0, 95.0, 130.0, 26.0, 30.0, 60.0, 310.0, 50.0, 50.0, 50.0, 26.0, 100.0, 25.0, 18.0, 30.0, 47.0, 150.0, 89.0, 70.0, 50.0, -28.0, 100.0, 67.0, 44.0, 96.0, 34.0, -84.0, 80.0, 80.0, 80.0, 36.0, 75.0, 69.0, 170.0, 49.0, 0.0, 56.0, 90.0, 39.0, 420.0, -31.0, 60.0, 2.0, 80.0, 70.0, 160.0, 28.0, 156.0, 178.0, 60.0, 120.0, 33.0, 30.0, 60.0, 120.0, 170.0, 38.0, 50.0, 100.0, -6.0, 50.0, -2.0, 8.0, 60.0, 0.0, 19.0, 26.0, 20.0, 55.0, 49.0, 13.0, -38.0, 38.0, 80.0, 60.0, 160.0, 80.0, 86.0, 58.0, 49.0, 170.0, 119.0, 40.0, 9.0, 50.0, 70.0, 58.0, 50.0, 13.0, 70.0, 35.0, 7.0, 30.0, 50.0, 26.0, 80.0, 36.0, 120.0, 168.0, -160.0, -80.0, 20.0, 44.0, 1030.0, 63.0, 120.0, -5.0, 150.0, -81.0, 27.0, 200.0, 60.0, 60.0, 90.0, 50.0, 10.0, 220.0, 154.0, 78.0, -12.0, 70.0, 36.0, 3.0, 360.0, 10.0, 60.0, 53.0, 69.0, 70.0, 0.0, -7.0, 38.0, 27.0, 40.0, 20.0, 23.0, 50.0, 100.0, 50.0, 50.0, 22.0, 40.0, 67.0, 40.0, -24.0, 90.0, 49.0, 67.0, 80.0, 37.0, 249.0, 60.0, 200.0, 27.0, 70.0, 49.0, 50.0, 49.0, 30.0, 90.0, 50.0, 68.0, 170.0, 50.0, 30.0, -10.0, 30.0, 90.0, 11.0, 50.0, -1.0, 4.0, 110.0, 32.0, 100.0, 171.0, 48.0, 50.0, 70.0, 1.0, 48.0, 70.0, 60.0, 69.0, 130.0, 100.0, 60.0, 60.0, -7.0, 50.0, 93.0, 40.0, 55.0, 100.0, 27.0, 160.0, 130.0, 100.0, 180.0, 165.0, 12.0, 103.0, -5.0, 209.0, 10.0, 60.0, 100.0, 70.0, 60.0, 70.0, 70.0, 40.0, 60.0, 7.0, -55.0, -19.0, 15.0, 100.0, 72.0, 80.0, 110.0, 30.0, -258.0, 90.0, 180.0, 55.0, 60.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.061000431526799, "mean_inference_ms": 2.3782747178750263, "mean_action_processing_ms": 0.7990625400427532, "mean_env_wait_ms": 1.6551268060307964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0614314079284668, "StateBufferConnector_ms": 0.010289669036865234, "ViewRequirementAgentConnector_ms": 0.47034144401550293}, "num_episodes": 22, "episode_return_max": 1772.0, "episode_return_min": 275.0, "episode_return_mean": 724.95, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.509653844813315, "num_env_steps_trained_throughput_per_sec": 32.509653844813315, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 2840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2840000, "timers": {"training_iteration_time_ms": 122139.445, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122139.394, "sample_time_ms": 2846.856, "learn_time_ms": 119271.422, "learn_throughput": 33.537, "synch_weights_time_ms": 11.87}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "done": false, "training_iteration": 71, "trial_id": "6085c_00000", "date": "2024-07-02_01-22-25", "timestamp": 1719897745, "time_this_iter_s": 123.0576319694519, "time_total_s": 10592.167840242386, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b0a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10592.167840242386, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 28.719540229885055, "ram_util_percent": 78.65459770114943}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5443304707955754, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.420587797693043, "policy_loss": -0.00671846697447153, "vf_loss": 7.426320808611739, "vf_explained_var": 0.0067259961423782495, "kl": 0.009854579494678113, "entropy": 0.9820669060761429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 671385.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 1390.0, "episode_reward_min": 275.0, "episode_reward_mean": 722.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -258.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 72.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [924.0, 428.0, 697.0, 895.0, 766.0, 488.0, 899.0, 643.0, 624.0, 379.0, 1005.0, 325.0, 898.0, 737.0, 672.0, 550.0, 643.0, 848.0, 735.0, 1246.0, 994.0, 695.0, 486.0, 1110.0, 1050.0, 833.0, 910.0, 800.0, 1164.0, 504.0, 812.0, 1003.0, 419.0, 533.0, 544.0, 416.0, 625.0, 478.0, 624.0, 722.0, 576.0, 743.0, 850.0, 819.0, 1228.0, 845.0, 541.0, 394.0, 742.0, 837.0, 426.0, 1227.0, 733.0, 749.0, 967.0, 585.0, 429.0, 705.0, 984.0, 859.0, 275.0, 583.0, 673.0, 467.0, 1350.0, 790.0, 727.0, 361.0, 451.0, 871.0, 598.0, 575.0, 668.0, 748.0, 904.0, 348.0, 589.0, 392.0, 1195.0, 285.0, 396.0, 789.0, 715.0, 1390.0, 669.0, 457.0, 856.0, 561.0, 879.0, 684.0, 678.0, 899.0, 814.0, 657.0, 963.0, 721.0, 522.0, 789.0, 925.0, 678.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, -17.0, 50.0, 11.0, 80.0, 80.0, 190.0, 70.0, 100.0, 190.0, 60.0, 8.0, 40.0, 0.0, 90.0, 50.0, 40.0, 70.0, 30.0, 40.0, -16.0, 48.0, 46.0, 20.0, 90.0, 257.0, 45.0, 12.0, 60.0, 135.0, 45.0, 70.0, 75.0, -10.0, 220.0, 199.0, 110.0, 16.0, 110.0, 60.0, 45.0, 14.0, 6.0, 70.0, 120.0, 19.0, 24.0, 68.0, 38.0, 362.0, 40.0, 90.0, 69.0, 30.0, 90.0, -1.0, 20.0, 20.0, 70.0, 60.0, 24.0, 30.0, 90.0, 190.0, 180.0, -5.0, 90.0, 50.0, 120.0, 130.0, 20.0, 10.0, 178.0, 110.0, 40.0, 57.0, 45.0, 20.0, -5.0, 168.0, 160.0, -60.0, 60.0, 40.0, 180.0, 38.0, 18.0, 70.0, -52.0, 170.0, -3.0, 20.0, 19.0, 35.0, 18.0, 50.0, 50.0, 100.0, 50.0, 40.0, 40.0, 60.0, 70.0, 79.0, 210.0, 169.0, 2.0, 310.0, 15.0, 50.0, 20.0, 100.0, 20.0, -1.0, 60.0, 40.0, 20.0, -5.0, 48.0, 23.0, 60.0, 160.0, 88.0, 90.0, 80.0, 30.0, 110.0, 210.0, 30.0, 40.0, 80.0, 90.0, -19.0, -14.0, 120.0, 80.0, 90.0, 220.0, 40.0, 50.0, 37.0, 40.0, 149.0, 50.0, 109.0, 200.0, 55.0, 29.0, -37.0, 40.0, 6.0, 110.0, 70.0, 62.0, 78.0, 4.0, 15.0, 130.0, 60.0, 15.0, 47.0, 12.0, 90.0, 52.0, 7.0, 90.0, 270.0, 20.0, 5.0, 50.0, 68.0, 60.0, 70.0, 70.0, 89.0, 61.0, 120.0, 70.0, 70.0, 170.0, 80.0, 170.0, 50.0, 70.0, 80.0, 78.0, 87.0, 40.0, 30.0, 50.0, 47.0, -55.0, 162.0, 200.0, -110.0, 164.0, 640.0, -2.0, 110.0, 90.0, 64.0, 67.0, 64.0, 100.0, 150.0, 89.0, 90.0, 130.0, 140.0, 100.0, -130.0, 70.0, 60.0, 90.0, 70.0, 70.0, 100.0, 320.0, 45.0, 0.0, 20.0, 60.0, 100.0, 30.0, 40.0, 19.0, 50.0, 30.0, 59.0, 78.0, 100.0, 100.0, 90.0, 100.0, 300.0, 60.0, 110.0, 50.0, 100.0, 100.0, 80.0, 110.0, 110.0, 70.0, 100.0, 120.0, 70.0, 190.0, 100.0, 100.0, 90.0, 47.0, 100.0, 80.0, -10.0, 19.0, 70.0, 299.0, 58.0, 80.0, 70.0, 120.0, 50.0, 260.0, 130.0, 80.0, 60.0, 70.0, 0.0, 70.0, 0.0, 20.0, 160.0, 120.0, 90.0, 20.0, 90.0, 60.0, 150.0, 90.0, 80.0, 60.0, 100.0, 80.0, 100.0, -35.0, 730.0, -101.0, 100.0, 50.0, 100.0, -43.0, 41.0, 90.0, 38.0, 64.0, 50.0, 48.0, 62.0, 54.0, 9.0, 70.0, 40.0, -35.0, 70.0, 60.0, 220.0, 199.0, 120.0, 59.0, 1.0, 100.0, 12.0, 230.0, 70.0, 70.0, 150.0, 20.0, 200.0, 150.0, 370.0, -30.0, 76.0, 1.0, -7.0, 70.0, -100.0, 20.0, -11.0, 30.0, 169.0, 29.0, 10.0, 30.0, 179.0, 9.0, 29.0, 60.0, -7.0, 25.0, 29.0, -20.0, 70.0, 60.0, 38.0, -15.0, 177.0, 130.0, 25.0, 50.0, 30.0, 10.0, 28.0, 70.0, 34.0, 30.0, 80.0, 70.0, 4.0, 60.0, 130.0, 170.0, 0.0, 90.0, 3.0, 90.0, 50.0, 0.0, 12.0, 80.0, 0.0, -5.0, 18.0, 60.0, 70.0, 20.0, 50.0, 150.0, -145.0, 260.0, 160.0, 90.0, 38.0, 56.0, -2.0, 150.0, 74.0, 16.0, 37.0, 5.0, 160.0, 20.0, 130.0, 17.0, 37.0, 39.0, 55.0, 14.0, 170.0, 80.0, 58.0, 90.0, 20.0, 0.0, 10.0, 70.0, 60.0, 18.0, 160.0, 90.0, -45.0, 90.0, 50.0, 158.0, 60.0, 77.0, 59.0, 66.0, 150.0, 78.0, 3.0, 76.0, 10.0, 190.0, 180.0, 210.0, 110.0, 20.0, -6.0, 57.0, 70.0, 70.0, 110.0, 100.0, 36.0, 67.0, 38.0, 60.0, 168.0, 100.0, 206.0, 72.0, 60.0, 70.0, 20.0, 320.0, 190.0, 20.0, 190.0, 80.0, 40.0, 80.0, 270.0, 5.0, 50.0, 70.0, 70.0, 100.0, 100.0, 60.0, 75.0, 40.0, 60.0, 60.0, 11.0, 30.0, 157.0, 60.0, 44.0, 4.0, 105.0, 55.0, 40.0, -12.0, -21.0, 15.0, 170.0, 20.0, -1.0, 23.0, 40.0, 56.0, 140.0, 69.0, 80.0, 50.0, 64.0, 50.0, 130.0, 63.0, 80.0, 70.0, 180.0, 29.0, 130.0, 28.0, 60.0, 90.0, 90.0, 80.0, 100.0, 30.0, 52.0, 20.0, 10.0, 40.0, 84.0, 60.0, 30.0, 0.0, 20.0, -3.0, 100.0, 40.0, 108.0, 10.0, 408.0, 104.0, 120.0, 320.0, 63.0, 6.0, 200.0, 109.0, 40.0, 83.0, 30.0, 130.0, 32.0, 40.0, 40.0, 50.0, 69.0, 80.0, 30.0, 160.0, 60.0, -20.0, 120.0, 160.0, 148.0, 50.0, 68.0, 95.0, 130.0, 26.0, 30.0, 60.0, 310.0, 50.0, 50.0, 50.0, 26.0, 100.0, 25.0, 18.0, 30.0, 47.0, 150.0, 89.0, 70.0, 50.0, -28.0, 100.0, 67.0, 44.0, 96.0, 34.0, -84.0, 80.0, 80.0, 80.0, 36.0, 75.0, 69.0, 170.0, 49.0, 0.0, 56.0, 90.0, 39.0, 420.0, -31.0, 60.0, 2.0, 80.0, 70.0, 160.0, 28.0, 156.0, 178.0, 60.0, 120.0, 33.0, 30.0, 60.0, 120.0, 170.0, 38.0, 50.0, 100.0, -6.0, 50.0, -2.0, 8.0, 60.0, 0.0, 19.0, 26.0, 20.0, 55.0, 49.0, 13.0, -38.0, 38.0, 80.0, 60.0, 160.0, 80.0, 86.0, 58.0, 49.0, 170.0, 119.0, 40.0, 9.0, 50.0, 70.0, 58.0, 50.0, 13.0, 70.0, 35.0, 7.0, 30.0, 50.0, 26.0, 80.0, 36.0, 120.0, 168.0, -160.0, -80.0, 20.0, 44.0, 1030.0, 63.0, 120.0, -5.0, 150.0, -81.0, 27.0, 200.0, 60.0, 60.0, 90.0, 50.0, 10.0, 220.0, 154.0, 78.0, -12.0, 70.0, 36.0, 3.0, 360.0, 10.0, 60.0, 53.0, 69.0, 70.0, 0.0, -7.0, 38.0, 27.0, 40.0, 20.0, 23.0, 50.0, 100.0, 50.0, 50.0, 22.0, 40.0, 67.0, 40.0, -24.0, 90.0, 49.0, 67.0, 80.0, 37.0, 249.0, 60.0, 200.0, 27.0, 70.0, 49.0, 50.0, 49.0, 30.0, 90.0, 50.0, 68.0, 170.0, 50.0, 30.0, -10.0, 30.0, 90.0, 11.0, 50.0, -1.0, 4.0, 110.0, 32.0, 100.0, 171.0, 48.0, 50.0, 70.0, 1.0, 48.0, 70.0, 60.0, 69.0, 130.0, 100.0, 60.0, 60.0, -7.0, 50.0, 93.0, 40.0, 55.0, 100.0, 27.0, 160.0, 130.0, 100.0, 180.0, 165.0, 12.0, 103.0, -5.0, 209.0, 10.0, 60.0, 100.0, 70.0, 60.0, 70.0, 70.0, 40.0, 60.0, 7.0, -55.0, -19.0, 15.0, 100.0, 72.0, 80.0, 110.0, 30.0, -258.0, 90.0, 180.0, 55.0, 60.0, 170.0, -17.0, -1.0, 57.0, 17.0, 100.0, 30.0, 7.0, 100.0, 39.0, 60.0, 130.0, 50.0, 70.0, 60.0, 607.0, 60.0, 44.0, 84.0, 40.0, 50.0, 46.0, -55.0, 70.0, 250.0, 50.0, -106.0, 25.0, -80.0, 46.0, 39.0, -151.0, 30.0, 110.0, 80.0, 60.0, 170.0, 104.0, 67.0, -144.0, 70.0, 50.0, 70.0, 80.0, 320.0, 51.0, 20.0, 58.0, -40.0, 90.0, 90.0, 17.0, 100.0, 0.0, 54.0, 8.0, 66.0, 30.0, 70.0, 70.0, 300.0, 80.0, 70.0, 600.0, 34.0, 8.0, 0.0, 169.0, 170.0, 180.0, 79.0, 178.0, 59.0, 50.0, 60.0, 50.0, 70.0, 38.0, -5.0, 119.0, 50.0, 50.0, -33.0, 38.0, 60.0, 28.0, -12.0, 18.0, 50.0, 220.0, 38.0, 100.0, 80.0, 150.0, 200.0, 87.0, 30.0, 100.0, -1.0, 40.0, 70.0, 80.0, 83.0, 110.0, 9.0, -14.0, 27.0, 45.0, 110.0, 73.0, 38.0, 40.0, 90.0, 80.0, 50.0, 70.0, 170.0, 70.0, 40.0, 209.0, 60.0, 110.0, 39.0, 90.0, 70.0, 150.0, 20.0, 90.0, -15.0, 110.0, 20.0, 90.0, 30.0, 38.0, 160.0, 54.0, -1.0, 47.0, 180.0, 10.0, 70.0, 48.0, 50.0, 100.0, 31.0, 171.0, 80.0, 8.0, 40.0, 360.0, 11.0, 310.0, 30.0, 160.0, 66.0, 179.0, 10.0, 16.0, 49.0, -15.0, 9.0, 90.0, 18.0, 25.0, 70.0, 45.0, 120.0, 129.0, 60.0, 30.0, 70.0, 71.0, 113.0, -9.0, 18.0, 160.0, 70.0, 140.0, 160.0, 170.0, 70.0, 40.0, 185.0, 30.0, 110.0, 40.0, 144.0, 30.0, 70.0, 20.0, 52.0, 150.0, 31.0, 50.0, 70.0, 67.0, 46.0, 21.0, 17.0, 40.0, 30.0, 250.0, 200.0, 30.0, 60.0, -30.0, 90.0, 33.0, 26.0, 40.0, 90.0, 80.0, 38.0, 7.0, -2.0, 418.0, 187.0, 111.0, 40.0, 24.0, 22.0, 170.0, 110.0, 110.0, -37.0, 50.0, 20.0, 80.0, 57.0, 80.0, 38.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0520895993289976, "mean_inference_ms": 2.367868621361461, "mean_action_processing_ms": 0.7959926192748664, "mean_env_wait_ms": 1.6486157715682441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06389403343200684, "StateBufferConnector_ms": 0.010332822799682617, "ViewRequirementAgentConnector_ms": 0.48049378395080566}, "num_episodes": 23, "episode_return_max": 1390.0, "episode_return_min": 275.0, "episode_return_mean": 722.55, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.651937794283796, "num_env_steps_trained_throughput_per_sec": 32.651937794283796, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 122306.775, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122306.72, "sample_time_ms": 2816.38, "learn_time_ms": 119469.014, "learn_throughput": 33.481, "synch_weights_time_ms": 11.998}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 72, "trial_id": "6085c_00000", "date": "2024-07-02_01-24-28", "timestamp": 1719897868, "time_this_iter_s": 122.5176100730896, "time_total_s": 10714.685450315475, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a88700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10714.685450315475, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 28.597687861271673, "ram_util_percent": 79.10404624277457}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.095196020349273, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.277086285711985, "policy_loss": -0.005767616870093008, "vf_loss": 7.281957816214353, "vf_explained_var": 0.000718146346755429, "kl": 0.008960803351059018, "entropy": 0.9392998900212927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 680775.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "env_runners": {"episode_reward_max": 1390.0, "episode_reward_min": 267.0, "episode_reward_mean": 737.82, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -258.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 73.782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [735.0, 1246.0, 994.0, 695.0, 486.0, 1110.0, 1050.0, 833.0, 910.0, 800.0, 1164.0, 504.0, 812.0, 1003.0, 419.0, 533.0, 544.0, 416.0, 625.0, 478.0, 624.0, 722.0, 576.0, 743.0, 850.0, 819.0, 1228.0, 845.0, 541.0, 394.0, 742.0, 837.0, 426.0, 1227.0, 733.0, 749.0, 967.0, 585.0, 429.0, 705.0, 984.0, 859.0, 275.0, 583.0, 673.0, 467.0, 1350.0, 790.0, 727.0, 361.0, 451.0, 871.0, 598.0, 575.0, 668.0, 748.0, 904.0, 348.0, 589.0, 392.0, 1195.0, 285.0, 396.0, 789.0, 715.0, 1390.0, 669.0, 457.0, 856.0, 561.0, 879.0, 684.0, 678.0, 899.0, 814.0, 657.0, 963.0, 721.0, 522.0, 789.0, 925.0, 678.0, 808.0, 1275.0, 541.0, 672.0, 1189.0, 774.0, 866.0, 962.0, 695.0, 267.0, 570.0, 982.0, 761.0, 504.0, 632.0, 364.0, 994.0, 1092.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 170.0, 50.0, 70.0, 80.0, 78.0, 87.0, 40.0, 30.0, 50.0, 47.0, -55.0, 162.0, 200.0, -110.0, 164.0, 640.0, -2.0, 110.0, 90.0, 64.0, 67.0, 64.0, 100.0, 150.0, 89.0, 90.0, 130.0, 140.0, 100.0, -130.0, 70.0, 60.0, 90.0, 70.0, 70.0, 100.0, 320.0, 45.0, 0.0, 20.0, 60.0, 100.0, 30.0, 40.0, 19.0, 50.0, 30.0, 59.0, 78.0, 100.0, 100.0, 90.0, 100.0, 300.0, 60.0, 110.0, 50.0, 100.0, 100.0, 80.0, 110.0, 110.0, 70.0, 100.0, 120.0, 70.0, 190.0, 100.0, 100.0, 90.0, 47.0, 100.0, 80.0, -10.0, 19.0, 70.0, 299.0, 58.0, 80.0, 70.0, 120.0, 50.0, 260.0, 130.0, 80.0, 60.0, 70.0, 0.0, 70.0, 0.0, 20.0, 160.0, 120.0, 90.0, 20.0, 90.0, 60.0, 150.0, 90.0, 80.0, 60.0, 100.0, 80.0, 100.0, -35.0, 730.0, -101.0, 100.0, 50.0, 100.0, -43.0, 41.0, 90.0, 38.0, 64.0, 50.0, 48.0, 62.0, 54.0, 9.0, 70.0, 40.0, -35.0, 70.0, 60.0, 220.0, 199.0, 120.0, 59.0, 1.0, 100.0, 12.0, 230.0, 70.0, 70.0, 150.0, 20.0, 200.0, 150.0, 370.0, -30.0, 76.0, 1.0, -7.0, 70.0, -100.0, 20.0, -11.0, 30.0, 169.0, 29.0, 10.0, 30.0, 179.0, 9.0, 29.0, 60.0, -7.0, 25.0, 29.0, -20.0, 70.0, 60.0, 38.0, -15.0, 177.0, 130.0, 25.0, 50.0, 30.0, 10.0, 28.0, 70.0, 34.0, 30.0, 80.0, 70.0, 4.0, 60.0, 130.0, 170.0, 0.0, 90.0, 3.0, 90.0, 50.0, 0.0, 12.0, 80.0, 0.0, -5.0, 18.0, 60.0, 70.0, 20.0, 50.0, 150.0, -145.0, 260.0, 160.0, 90.0, 38.0, 56.0, -2.0, 150.0, 74.0, 16.0, 37.0, 5.0, 160.0, 20.0, 130.0, 17.0, 37.0, 39.0, 55.0, 14.0, 170.0, 80.0, 58.0, 90.0, 20.0, 0.0, 10.0, 70.0, 60.0, 18.0, 160.0, 90.0, -45.0, 90.0, 50.0, 158.0, 60.0, 77.0, 59.0, 66.0, 150.0, 78.0, 3.0, 76.0, 10.0, 190.0, 180.0, 210.0, 110.0, 20.0, -6.0, 57.0, 70.0, 70.0, 110.0, 100.0, 36.0, 67.0, 38.0, 60.0, 168.0, 100.0, 206.0, 72.0, 60.0, 70.0, 20.0, 320.0, 190.0, 20.0, 190.0, 80.0, 40.0, 80.0, 270.0, 5.0, 50.0, 70.0, 70.0, 100.0, 100.0, 60.0, 75.0, 40.0, 60.0, 60.0, 11.0, 30.0, 157.0, 60.0, 44.0, 4.0, 105.0, 55.0, 40.0, -12.0, -21.0, 15.0, 170.0, 20.0, -1.0, 23.0, 40.0, 56.0, 140.0, 69.0, 80.0, 50.0, 64.0, 50.0, 130.0, 63.0, 80.0, 70.0, 180.0, 29.0, 130.0, 28.0, 60.0, 90.0, 90.0, 80.0, 100.0, 30.0, 52.0, 20.0, 10.0, 40.0, 84.0, 60.0, 30.0, 0.0, 20.0, -3.0, 100.0, 40.0, 108.0, 10.0, 408.0, 104.0, 120.0, 320.0, 63.0, 6.0, 200.0, 109.0, 40.0, 83.0, 30.0, 130.0, 32.0, 40.0, 40.0, 50.0, 69.0, 80.0, 30.0, 160.0, 60.0, -20.0, 120.0, 160.0, 148.0, 50.0, 68.0, 95.0, 130.0, 26.0, 30.0, 60.0, 310.0, 50.0, 50.0, 50.0, 26.0, 100.0, 25.0, 18.0, 30.0, 47.0, 150.0, 89.0, 70.0, 50.0, -28.0, 100.0, 67.0, 44.0, 96.0, 34.0, -84.0, 80.0, 80.0, 80.0, 36.0, 75.0, 69.0, 170.0, 49.0, 0.0, 56.0, 90.0, 39.0, 420.0, -31.0, 60.0, 2.0, 80.0, 70.0, 160.0, 28.0, 156.0, 178.0, 60.0, 120.0, 33.0, 30.0, 60.0, 120.0, 170.0, 38.0, 50.0, 100.0, -6.0, 50.0, -2.0, 8.0, 60.0, 0.0, 19.0, 26.0, 20.0, 55.0, 49.0, 13.0, -38.0, 38.0, 80.0, 60.0, 160.0, 80.0, 86.0, 58.0, 49.0, 170.0, 119.0, 40.0, 9.0, 50.0, 70.0, 58.0, 50.0, 13.0, 70.0, 35.0, 7.0, 30.0, 50.0, 26.0, 80.0, 36.0, 120.0, 168.0, -160.0, -80.0, 20.0, 44.0, 1030.0, 63.0, 120.0, -5.0, 150.0, -81.0, 27.0, 200.0, 60.0, 60.0, 90.0, 50.0, 10.0, 220.0, 154.0, 78.0, -12.0, 70.0, 36.0, 3.0, 360.0, 10.0, 60.0, 53.0, 69.0, 70.0, 0.0, -7.0, 38.0, 27.0, 40.0, 20.0, 23.0, 50.0, 100.0, 50.0, 50.0, 22.0, 40.0, 67.0, 40.0, -24.0, 90.0, 49.0, 67.0, 80.0, 37.0, 249.0, 60.0, 200.0, 27.0, 70.0, 49.0, 50.0, 49.0, 30.0, 90.0, 50.0, 68.0, 170.0, 50.0, 30.0, -10.0, 30.0, 90.0, 11.0, 50.0, -1.0, 4.0, 110.0, 32.0, 100.0, 171.0, 48.0, 50.0, 70.0, 1.0, 48.0, 70.0, 60.0, 69.0, 130.0, 100.0, 60.0, 60.0, -7.0, 50.0, 93.0, 40.0, 55.0, 100.0, 27.0, 160.0, 130.0, 100.0, 180.0, 165.0, 12.0, 103.0, -5.0, 209.0, 10.0, 60.0, 100.0, 70.0, 60.0, 70.0, 70.0, 40.0, 60.0, 7.0, -55.0, -19.0, 15.0, 100.0, 72.0, 80.0, 110.0, 30.0, -258.0, 90.0, 180.0, 55.0, 60.0, 170.0, -17.0, -1.0, 57.0, 17.0, 100.0, 30.0, 7.0, 100.0, 39.0, 60.0, 130.0, 50.0, 70.0, 60.0, 607.0, 60.0, 44.0, 84.0, 40.0, 50.0, 46.0, -55.0, 70.0, 250.0, 50.0, -106.0, 25.0, -80.0, 46.0, 39.0, -151.0, 30.0, 110.0, 80.0, 60.0, 170.0, 104.0, 67.0, -144.0, 70.0, 50.0, 70.0, 80.0, 320.0, 51.0, 20.0, 58.0, -40.0, 90.0, 90.0, 17.0, 100.0, 0.0, 54.0, 8.0, 66.0, 30.0, 70.0, 70.0, 300.0, 80.0, 70.0, 600.0, 34.0, 8.0, 0.0, 169.0, 170.0, 180.0, 79.0, 178.0, 59.0, 50.0, 60.0, 50.0, 70.0, 38.0, -5.0, 119.0, 50.0, 50.0, -33.0, 38.0, 60.0, 28.0, -12.0, 18.0, 50.0, 220.0, 38.0, 100.0, 80.0, 150.0, 200.0, 87.0, 30.0, 100.0, -1.0, 40.0, 70.0, 80.0, 83.0, 110.0, 9.0, -14.0, 27.0, 45.0, 110.0, 73.0, 38.0, 40.0, 90.0, 80.0, 50.0, 70.0, 170.0, 70.0, 40.0, 209.0, 60.0, 110.0, 39.0, 90.0, 70.0, 150.0, 20.0, 90.0, -15.0, 110.0, 20.0, 90.0, 30.0, 38.0, 160.0, 54.0, -1.0, 47.0, 180.0, 10.0, 70.0, 48.0, 50.0, 100.0, 31.0, 171.0, 80.0, 8.0, 40.0, 360.0, 11.0, 310.0, 30.0, 160.0, 66.0, 179.0, 10.0, 16.0, 49.0, -15.0, 9.0, 90.0, 18.0, 25.0, 70.0, 45.0, 120.0, 129.0, 60.0, 30.0, 70.0, 71.0, 113.0, -9.0, 18.0, 160.0, 70.0, 140.0, 160.0, 170.0, 70.0, 40.0, 185.0, 30.0, 110.0, 40.0, 144.0, 30.0, 70.0, 20.0, 52.0, 150.0, 31.0, 50.0, 70.0, 67.0, 46.0, 21.0, 17.0, 40.0, 30.0, 250.0, 200.0, 30.0, 60.0, -30.0, 90.0, 33.0, 26.0, 40.0, 90.0, 80.0, 38.0, 7.0, -2.0, 418.0, 187.0, 111.0, 40.0, 24.0, 22.0, 170.0, 110.0, 110.0, -37.0, 50.0, 20.0, 80.0, 57.0, 80.0, 38.0, 17.0, 209.0, 8.0, 58.0, 32.0, 5.0, 260.0, 69.0, 90.0, 60.0, 60.0, 20.0, 48.0, 120.0, 57.0, 90.0, 90.0, 430.0, 80.0, 280.0, 5.0, 150.0, 40.0, 47.0, 50.0, 35.0, 100.0, 9.0, 70.0, 35.0, 41.0, 40.0, 110.0, 120.0, 41.0, 70.0, 30.0, 60.0, 70.0, 90.0, -31.0, -2.0, 200.0, 310.0, 57.0, 350.0, 49.0, 110.0, 66.0, 80.0, 66.0, 30.0, 60.0, 187.0, 30.0, 15.0, 10.0, 260.0, 90.0, 26.0, 70.0, 70.0, 23.0, 272.0, 60.0, 59.0, 60.0, 98.0, 68.0, 86.0, -40.0, 70.0, 100.0, 90.0, 243.0, 172.0, 76.0, 100.0, 71.0, 80.0, -32.0, 40.0, 35.0, 60.0, 110.0, 180.0, 110.0, 28.0, 54.0, 110.0, 50.0, 28.0, 20.0, 70.0, 16.0, -156.0, 210.0, 43.0, -24.0, 10.0, 49.0, 60.0, 53.0, 30.0, 48.0, 20.0, 50.0, 70.0, 120.0, 70.0, 170.0, 110.0, 35.0, 100.0, 156.0, -21.0, 13.0, 200.0, 80.0, 139.0, 8.0, 20.0, 100.0, 34.0, 49.0, 210.0, 40.0, 70.0, 70.0, 160.0, 50.0, 80.0, 56.0, 90.0, 50.0, -40.0, 73.0, 70.0, 50.0, 25.0, 79.0, 70.0, 70.0, 45.0, 118.0, 13.0, 110.0, 69.0, -40.0, 98.0, 70.0, -10.0, 25.0, 60.0, 19.0, 44.0, 25.0, 65.0, 50.0, 16.0, 41.0, 130.0, 68.0, 81.0, 69.0, 60.0, 110.0, -15.0, 160.0, 290.0, 42.0, 86.0, 100.0, 176.0, 50.0, 63.0, 440.0, 90.0, -45.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.045562444745356, "mean_inference_ms": 2.3601990802299553, "mean_action_processing_ms": 0.7937022040603376, "mean_env_wait_ms": 1.6436728469858322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06440496444702148, "StateBufferConnector_ms": 0.010211944580078125, "ViewRequirementAgentConnector_ms": 0.48213887214660645}, "num_episodes": 18, "episode_return_max": 1390.0, "episode_return_min": 267.0, "episode_return_mean": 737.82, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.69190244570397, "num_env_steps_trained_throughput_per_sec": 32.69190244570397, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 2920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2920000, "timers": {"training_iteration_time_ms": 122404.636, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122404.581, "sample_time_ms": 2808.867, "learn_time_ms": 119574.431, "learn_throughput": 33.452, "synch_weights_time_ms": 12.078}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "done": false, "training_iteration": 73, "trial_id": "6085c_00000", "date": "2024-07-02_01-26-30", "timestamp": 1719897990, "time_this_iter_s": 122.37519311904907, "time_total_s": 10837.060643434525, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9128940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10837.060643434525, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 28.294219653179187, "ram_util_percent": 79.35491329479767}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4940955282654116, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.148644427166452, "policy_loss": -0.0062795783064047445, "vf_loss": 7.153960822463924, "vf_explained_var": 0.0009100999885473769, "kl": 0.009631832260513704, "entropy": 0.9274075635705893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 690165.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 1390.0, "episode_reward_min": 267.0, "episode_reward_mean": 720.57, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -258.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 72.057}, "custom_metrics": {}, "hist_stats": {"episode_reward": [625.0, 478.0, 624.0, 722.0, 576.0, 743.0, 850.0, 819.0, 1228.0, 845.0, 541.0, 394.0, 742.0, 837.0, 426.0, 1227.0, 733.0, 749.0, 967.0, 585.0, 429.0, 705.0, 984.0, 859.0, 275.0, 583.0, 673.0, 467.0, 1350.0, 790.0, 727.0, 361.0, 451.0, 871.0, 598.0, 575.0, 668.0, 748.0, 904.0, 348.0, 589.0, 392.0, 1195.0, 285.0, 396.0, 789.0, 715.0, 1390.0, 669.0, 457.0, 856.0, 561.0, 879.0, 684.0, 678.0, 899.0, 814.0, 657.0, 963.0, 721.0, 522.0, 789.0, 925.0, 678.0, 808.0, 1275.0, 541.0, 672.0, 1189.0, 774.0, 866.0, 962.0, 695.0, 267.0, 570.0, 982.0, 761.0, 504.0, 632.0, 364.0, 994.0, 1092.0, 519.0, 1039.0, 555.0, 753.0, 659.0, 591.0, 1211.0, 498.0, 385.0, 835.0, 846.0, 959.0, 904.0, 530.0, 651.0, 759.0, 397.0, 438.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 170.0, 0.0, 90.0, 3.0, 90.0, 50.0, 0.0, 12.0, 80.0, 0.0, -5.0, 18.0, 60.0, 70.0, 20.0, 50.0, 150.0, -145.0, 260.0, 160.0, 90.0, 38.0, 56.0, -2.0, 150.0, 74.0, 16.0, 37.0, 5.0, 160.0, 20.0, 130.0, 17.0, 37.0, 39.0, 55.0, 14.0, 170.0, 80.0, 58.0, 90.0, 20.0, 0.0, 10.0, 70.0, 60.0, 18.0, 160.0, 90.0, -45.0, 90.0, 50.0, 158.0, 60.0, 77.0, 59.0, 66.0, 150.0, 78.0, 3.0, 76.0, 10.0, 190.0, 180.0, 210.0, 110.0, 20.0, -6.0, 57.0, 70.0, 70.0, 110.0, 100.0, 36.0, 67.0, 38.0, 60.0, 168.0, 100.0, 206.0, 72.0, 60.0, 70.0, 20.0, 320.0, 190.0, 20.0, 190.0, 80.0, 40.0, 80.0, 270.0, 5.0, 50.0, 70.0, 70.0, 100.0, 100.0, 60.0, 75.0, 40.0, 60.0, 60.0, 11.0, 30.0, 157.0, 60.0, 44.0, 4.0, 105.0, 55.0, 40.0, -12.0, -21.0, 15.0, 170.0, 20.0, -1.0, 23.0, 40.0, 56.0, 140.0, 69.0, 80.0, 50.0, 64.0, 50.0, 130.0, 63.0, 80.0, 70.0, 180.0, 29.0, 130.0, 28.0, 60.0, 90.0, 90.0, 80.0, 100.0, 30.0, 52.0, 20.0, 10.0, 40.0, 84.0, 60.0, 30.0, 0.0, 20.0, -3.0, 100.0, 40.0, 108.0, 10.0, 408.0, 104.0, 120.0, 320.0, 63.0, 6.0, 200.0, 109.0, 40.0, 83.0, 30.0, 130.0, 32.0, 40.0, 40.0, 50.0, 69.0, 80.0, 30.0, 160.0, 60.0, -20.0, 120.0, 160.0, 148.0, 50.0, 68.0, 95.0, 130.0, 26.0, 30.0, 60.0, 310.0, 50.0, 50.0, 50.0, 26.0, 100.0, 25.0, 18.0, 30.0, 47.0, 150.0, 89.0, 70.0, 50.0, -28.0, 100.0, 67.0, 44.0, 96.0, 34.0, -84.0, 80.0, 80.0, 80.0, 36.0, 75.0, 69.0, 170.0, 49.0, 0.0, 56.0, 90.0, 39.0, 420.0, -31.0, 60.0, 2.0, 80.0, 70.0, 160.0, 28.0, 156.0, 178.0, 60.0, 120.0, 33.0, 30.0, 60.0, 120.0, 170.0, 38.0, 50.0, 100.0, -6.0, 50.0, -2.0, 8.0, 60.0, 0.0, 19.0, 26.0, 20.0, 55.0, 49.0, 13.0, -38.0, 38.0, 80.0, 60.0, 160.0, 80.0, 86.0, 58.0, 49.0, 170.0, 119.0, 40.0, 9.0, 50.0, 70.0, 58.0, 50.0, 13.0, 70.0, 35.0, 7.0, 30.0, 50.0, 26.0, 80.0, 36.0, 120.0, 168.0, -160.0, -80.0, 20.0, 44.0, 1030.0, 63.0, 120.0, -5.0, 150.0, -81.0, 27.0, 200.0, 60.0, 60.0, 90.0, 50.0, 10.0, 220.0, 154.0, 78.0, -12.0, 70.0, 36.0, 3.0, 360.0, 10.0, 60.0, 53.0, 69.0, 70.0, 0.0, -7.0, 38.0, 27.0, 40.0, 20.0, 23.0, 50.0, 100.0, 50.0, 50.0, 22.0, 40.0, 67.0, 40.0, -24.0, 90.0, 49.0, 67.0, 80.0, 37.0, 249.0, 60.0, 200.0, 27.0, 70.0, 49.0, 50.0, 49.0, 30.0, 90.0, 50.0, 68.0, 170.0, 50.0, 30.0, -10.0, 30.0, 90.0, 11.0, 50.0, -1.0, 4.0, 110.0, 32.0, 100.0, 171.0, 48.0, 50.0, 70.0, 1.0, 48.0, 70.0, 60.0, 69.0, 130.0, 100.0, 60.0, 60.0, -7.0, 50.0, 93.0, 40.0, 55.0, 100.0, 27.0, 160.0, 130.0, 100.0, 180.0, 165.0, 12.0, 103.0, -5.0, 209.0, 10.0, 60.0, 100.0, 70.0, 60.0, 70.0, 70.0, 40.0, 60.0, 7.0, -55.0, -19.0, 15.0, 100.0, 72.0, 80.0, 110.0, 30.0, -258.0, 90.0, 180.0, 55.0, 60.0, 170.0, -17.0, -1.0, 57.0, 17.0, 100.0, 30.0, 7.0, 100.0, 39.0, 60.0, 130.0, 50.0, 70.0, 60.0, 607.0, 60.0, 44.0, 84.0, 40.0, 50.0, 46.0, -55.0, 70.0, 250.0, 50.0, -106.0, 25.0, -80.0, 46.0, 39.0, -151.0, 30.0, 110.0, 80.0, 60.0, 170.0, 104.0, 67.0, -144.0, 70.0, 50.0, 70.0, 80.0, 320.0, 51.0, 20.0, 58.0, -40.0, 90.0, 90.0, 17.0, 100.0, 0.0, 54.0, 8.0, 66.0, 30.0, 70.0, 70.0, 300.0, 80.0, 70.0, 600.0, 34.0, 8.0, 0.0, 169.0, 170.0, 180.0, 79.0, 178.0, 59.0, 50.0, 60.0, 50.0, 70.0, 38.0, -5.0, 119.0, 50.0, 50.0, -33.0, 38.0, 60.0, 28.0, -12.0, 18.0, 50.0, 220.0, 38.0, 100.0, 80.0, 150.0, 200.0, 87.0, 30.0, 100.0, -1.0, 40.0, 70.0, 80.0, 83.0, 110.0, 9.0, -14.0, 27.0, 45.0, 110.0, 73.0, 38.0, 40.0, 90.0, 80.0, 50.0, 70.0, 170.0, 70.0, 40.0, 209.0, 60.0, 110.0, 39.0, 90.0, 70.0, 150.0, 20.0, 90.0, -15.0, 110.0, 20.0, 90.0, 30.0, 38.0, 160.0, 54.0, -1.0, 47.0, 180.0, 10.0, 70.0, 48.0, 50.0, 100.0, 31.0, 171.0, 80.0, 8.0, 40.0, 360.0, 11.0, 310.0, 30.0, 160.0, 66.0, 179.0, 10.0, 16.0, 49.0, -15.0, 9.0, 90.0, 18.0, 25.0, 70.0, 45.0, 120.0, 129.0, 60.0, 30.0, 70.0, 71.0, 113.0, -9.0, 18.0, 160.0, 70.0, 140.0, 160.0, 170.0, 70.0, 40.0, 185.0, 30.0, 110.0, 40.0, 144.0, 30.0, 70.0, 20.0, 52.0, 150.0, 31.0, 50.0, 70.0, 67.0, 46.0, 21.0, 17.0, 40.0, 30.0, 250.0, 200.0, 30.0, 60.0, -30.0, 90.0, 33.0, 26.0, 40.0, 90.0, 80.0, 38.0, 7.0, -2.0, 418.0, 187.0, 111.0, 40.0, 24.0, 22.0, 170.0, 110.0, 110.0, -37.0, 50.0, 20.0, 80.0, 57.0, 80.0, 38.0, 17.0, 209.0, 8.0, 58.0, 32.0, 5.0, 260.0, 69.0, 90.0, 60.0, 60.0, 20.0, 48.0, 120.0, 57.0, 90.0, 90.0, 430.0, 80.0, 280.0, 5.0, 150.0, 40.0, 47.0, 50.0, 35.0, 100.0, 9.0, 70.0, 35.0, 41.0, 40.0, 110.0, 120.0, 41.0, 70.0, 30.0, 60.0, 70.0, 90.0, -31.0, -2.0, 200.0, 310.0, 57.0, 350.0, 49.0, 110.0, 66.0, 80.0, 66.0, 30.0, 60.0, 187.0, 30.0, 15.0, 10.0, 260.0, 90.0, 26.0, 70.0, 70.0, 23.0, 272.0, 60.0, 59.0, 60.0, 98.0, 68.0, 86.0, -40.0, 70.0, 100.0, 90.0, 243.0, 172.0, 76.0, 100.0, 71.0, 80.0, -32.0, 40.0, 35.0, 60.0, 110.0, 180.0, 110.0, 28.0, 54.0, 110.0, 50.0, 28.0, 20.0, 70.0, 16.0, -156.0, 210.0, 43.0, -24.0, 10.0, 49.0, 60.0, 53.0, 30.0, 48.0, 20.0, 50.0, 70.0, 120.0, 70.0, 170.0, 110.0, 35.0, 100.0, 156.0, -21.0, 13.0, 200.0, 80.0, 139.0, 8.0, 20.0, 100.0, 34.0, 49.0, 210.0, 40.0, 70.0, 70.0, 160.0, 50.0, 80.0, 56.0, 90.0, 50.0, -40.0, 73.0, 70.0, 50.0, 25.0, 79.0, 70.0, 70.0, 45.0, 118.0, 13.0, 110.0, 69.0, -40.0, 98.0, 70.0, -10.0, 25.0, 60.0, 19.0, 44.0, 25.0, 65.0, 50.0, 16.0, 41.0, 130.0, 68.0, 81.0, 69.0, 60.0, 110.0, -15.0, 160.0, 290.0, 42.0, 86.0, 100.0, 176.0, 50.0, 63.0, 440.0, 90.0, -45.0, 90.0, 90.0, 60.0, -30.0, 48.0, 40.0, 100.0, 180.0, -30.0, 11.0, 50.0, 59.0, 30.0, 20.0, 160.0, 100.0, 360.0, 60.0, 80.0, 60.0, 110.0, 100.0, 45.0, 40.0, 100.0, 50.0, 30.0, 23.0, 30.0, 57.0, 80.0, 22.0, 155.0, 40.0, 126.0, -7.0, 100.0, 50.0, 57.0, 100.0, 110.0, 77.0, 65.0, -13.0, 54.0, 50.0, 210.0, 26.0, 70.0, 90.0, 30.0, 175.0, 13.0, 40.0, 3.0, 160.0, 55.0, 110.0, 14.0, -38.0, 59.0, 56.0, 510.0, -38.0, 60.0, 217.0, 30.0, 149.0, 98.0, 9.0, 120.0, 0.0, 40.0, 40.0, 40.0, 59.0, 80.0, 100.0, 49.0, 70.0, 20.0, 60.0, 29.0, 60.0, 2.0, 60.0, 70.0, 19.0, 26.0, 28.0, 31.0, 70.0, -8.0, 160.0, 19.0, 190.0, -10.0, 100.0, 130.0, 110.0, 74.0, 10.0, 41.0, 30.0, 270.0, 260.0, 59.0, 100.0, 60.0, 40.0, -24.0, 21.0, 48.0, 330.0, -10.0, -33.0, -37.0, 100.0, 200.0, 190.0, 150.0, 32.0, 30.0, 290.0, 70.0, 70.0, 290.0, 79.0, 16.0, -43.0, 70.0, 64.0, 105.0, 0.0, 60.0, 38.0, 85.0, 43.0, 0.0, 90.0, 45.0, 60.0, 120.0, 80.0, 30.0, 80.0, 51.0, 40.0, 80.0, 60.0, 50.0, 70.0, 80.0, 100.0, 80.0, 58.0, -10.0, 95.0, 190.0, 59.0, 37.0, 34.0, 60.0, 40.0, 19.0, 50.0, 20.0, 30.0, 59.0, 35.0, 50.0, 17.0, 10.0, 50.0, 27.0, 80.0, 18.0, 68.0, 18.0, 30.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0393810838653073, "mean_inference_ms": 2.3527714990522264, "mean_action_processing_ms": 0.7914945030065326, "mean_env_wait_ms": 1.6389526081824188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0638725757598877, "StateBufferConnector_ms": 0.010010242462158203, "ViewRequirementAgentConnector_ms": 0.47605013847351074}, "num_episodes": 18, "episode_return_max": 1390.0, "episode_return_min": 267.0, "episode_return_mean": 720.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.299704003216554, "num_env_steps_trained_throughput_per_sec": 32.299704003216554, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 122506.118, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122506.063, "sample_time_ms": 2794.191, "learn_time_ms": 119690.254, "learn_throughput": 33.42, "synch_weights_time_ms": 12.06}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 74, "trial_id": "6085c_00000", "date": "2024-07-02_01-28-34", "timestamp": 1719898114, "time_this_iter_s": 123.86990094184875, "time_total_s": 10960.930544376373, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10960.930544376373, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 29.418857142857142, "ram_util_percent": 79.96742857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.028437826770563, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.122087368746789, "policy_loss": -0.00529257807329186, "vf_loss": 7.1262886886271675, "vf_explained_var": 0.0025074075014827352, "kl": 0.010912661674204556, "entropy": 0.8922991119888517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 699555.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "env_runners": {"episode_reward_max": 1390.0, "episode_reward_min": 147.0, "episode_reward_mean": 719.68, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -258.0}, "policy_reward_max": {"policy_0": 1030.0}, "policy_reward_mean": {"policy_0": 71.968}, "custom_metrics": {}, "hist_stats": {"episode_reward": [984.0, 859.0, 275.0, 583.0, 673.0, 467.0, 1350.0, 790.0, 727.0, 361.0, 451.0, 871.0, 598.0, 575.0, 668.0, 748.0, 904.0, 348.0, 589.0, 392.0, 1195.0, 285.0, 396.0, 789.0, 715.0, 1390.0, 669.0, 457.0, 856.0, 561.0, 879.0, 684.0, 678.0, 899.0, 814.0, 657.0, 963.0, 721.0, 522.0, 789.0, 925.0, 678.0, 808.0, 1275.0, 541.0, 672.0, 1189.0, 774.0, 866.0, 962.0, 695.0, 267.0, 570.0, 982.0, 761.0, 504.0, 632.0, 364.0, 994.0, 1092.0, 519.0, 1039.0, 555.0, 753.0, 659.0, 591.0, 1211.0, 498.0, 385.0, 835.0, 846.0, 959.0, 904.0, 530.0, 651.0, 759.0, 397.0, 438.0, 1049.0, 699.0, 593.0, 502.0, 590.0, 484.0, 473.0, 1240.0, 854.0, 586.0, 652.0, 661.0, 952.0, 147.0, 853.0, 1103.0, 684.0, 601.0, 573.0, 1098.0, 629.0, 733.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [39.0, 420.0, -31.0, 60.0, 2.0, 80.0, 70.0, 160.0, 28.0, 156.0, 178.0, 60.0, 120.0, 33.0, 30.0, 60.0, 120.0, 170.0, 38.0, 50.0, 100.0, -6.0, 50.0, -2.0, 8.0, 60.0, 0.0, 19.0, 26.0, 20.0, 55.0, 49.0, 13.0, -38.0, 38.0, 80.0, 60.0, 160.0, 80.0, 86.0, 58.0, 49.0, 170.0, 119.0, 40.0, 9.0, 50.0, 70.0, 58.0, 50.0, 13.0, 70.0, 35.0, 7.0, 30.0, 50.0, 26.0, 80.0, 36.0, 120.0, 168.0, -160.0, -80.0, 20.0, 44.0, 1030.0, 63.0, 120.0, -5.0, 150.0, -81.0, 27.0, 200.0, 60.0, 60.0, 90.0, 50.0, 10.0, 220.0, 154.0, 78.0, -12.0, 70.0, 36.0, 3.0, 360.0, 10.0, 60.0, 53.0, 69.0, 70.0, 0.0, -7.0, 38.0, 27.0, 40.0, 20.0, 23.0, 50.0, 100.0, 50.0, 50.0, 22.0, 40.0, 67.0, 40.0, -24.0, 90.0, 49.0, 67.0, 80.0, 37.0, 249.0, 60.0, 200.0, 27.0, 70.0, 49.0, 50.0, 49.0, 30.0, 90.0, 50.0, 68.0, 170.0, 50.0, 30.0, -10.0, 30.0, 90.0, 11.0, 50.0, -1.0, 4.0, 110.0, 32.0, 100.0, 171.0, 48.0, 50.0, 70.0, 1.0, 48.0, 70.0, 60.0, 69.0, 130.0, 100.0, 60.0, 60.0, -7.0, 50.0, 93.0, 40.0, 55.0, 100.0, 27.0, 160.0, 130.0, 100.0, 180.0, 165.0, 12.0, 103.0, -5.0, 209.0, 10.0, 60.0, 100.0, 70.0, 60.0, 70.0, 70.0, 40.0, 60.0, 7.0, -55.0, -19.0, 15.0, 100.0, 72.0, 80.0, 110.0, 30.0, -258.0, 90.0, 180.0, 55.0, 60.0, 170.0, -17.0, -1.0, 57.0, 17.0, 100.0, 30.0, 7.0, 100.0, 39.0, 60.0, 130.0, 50.0, 70.0, 60.0, 607.0, 60.0, 44.0, 84.0, 40.0, 50.0, 46.0, -55.0, 70.0, 250.0, 50.0, -106.0, 25.0, -80.0, 46.0, 39.0, -151.0, 30.0, 110.0, 80.0, 60.0, 170.0, 104.0, 67.0, -144.0, 70.0, 50.0, 70.0, 80.0, 320.0, 51.0, 20.0, 58.0, -40.0, 90.0, 90.0, 17.0, 100.0, 0.0, 54.0, 8.0, 66.0, 30.0, 70.0, 70.0, 300.0, 80.0, 70.0, 600.0, 34.0, 8.0, 0.0, 169.0, 170.0, 180.0, 79.0, 178.0, 59.0, 50.0, 60.0, 50.0, 70.0, 38.0, -5.0, 119.0, 50.0, 50.0, -33.0, 38.0, 60.0, 28.0, -12.0, 18.0, 50.0, 220.0, 38.0, 100.0, 80.0, 150.0, 200.0, 87.0, 30.0, 100.0, -1.0, 40.0, 70.0, 80.0, 83.0, 110.0, 9.0, -14.0, 27.0, 45.0, 110.0, 73.0, 38.0, 40.0, 90.0, 80.0, 50.0, 70.0, 170.0, 70.0, 40.0, 209.0, 60.0, 110.0, 39.0, 90.0, 70.0, 150.0, 20.0, 90.0, -15.0, 110.0, 20.0, 90.0, 30.0, 38.0, 160.0, 54.0, -1.0, 47.0, 180.0, 10.0, 70.0, 48.0, 50.0, 100.0, 31.0, 171.0, 80.0, 8.0, 40.0, 360.0, 11.0, 310.0, 30.0, 160.0, 66.0, 179.0, 10.0, 16.0, 49.0, -15.0, 9.0, 90.0, 18.0, 25.0, 70.0, 45.0, 120.0, 129.0, 60.0, 30.0, 70.0, 71.0, 113.0, -9.0, 18.0, 160.0, 70.0, 140.0, 160.0, 170.0, 70.0, 40.0, 185.0, 30.0, 110.0, 40.0, 144.0, 30.0, 70.0, 20.0, 52.0, 150.0, 31.0, 50.0, 70.0, 67.0, 46.0, 21.0, 17.0, 40.0, 30.0, 250.0, 200.0, 30.0, 60.0, -30.0, 90.0, 33.0, 26.0, 40.0, 90.0, 80.0, 38.0, 7.0, -2.0, 418.0, 187.0, 111.0, 40.0, 24.0, 22.0, 170.0, 110.0, 110.0, -37.0, 50.0, 20.0, 80.0, 57.0, 80.0, 38.0, 17.0, 209.0, 8.0, 58.0, 32.0, 5.0, 260.0, 69.0, 90.0, 60.0, 60.0, 20.0, 48.0, 120.0, 57.0, 90.0, 90.0, 430.0, 80.0, 280.0, 5.0, 150.0, 40.0, 47.0, 50.0, 35.0, 100.0, 9.0, 70.0, 35.0, 41.0, 40.0, 110.0, 120.0, 41.0, 70.0, 30.0, 60.0, 70.0, 90.0, -31.0, -2.0, 200.0, 310.0, 57.0, 350.0, 49.0, 110.0, 66.0, 80.0, 66.0, 30.0, 60.0, 187.0, 30.0, 15.0, 10.0, 260.0, 90.0, 26.0, 70.0, 70.0, 23.0, 272.0, 60.0, 59.0, 60.0, 98.0, 68.0, 86.0, -40.0, 70.0, 100.0, 90.0, 243.0, 172.0, 76.0, 100.0, 71.0, 80.0, -32.0, 40.0, 35.0, 60.0, 110.0, 180.0, 110.0, 28.0, 54.0, 110.0, 50.0, 28.0, 20.0, 70.0, 16.0, -156.0, 210.0, 43.0, -24.0, 10.0, 49.0, 60.0, 53.0, 30.0, 48.0, 20.0, 50.0, 70.0, 120.0, 70.0, 170.0, 110.0, 35.0, 100.0, 156.0, -21.0, 13.0, 200.0, 80.0, 139.0, 8.0, 20.0, 100.0, 34.0, 49.0, 210.0, 40.0, 70.0, 70.0, 160.0, 50.0, 80.0, 56.0, 90.0, 50.0, -40.0, 73.0, 70.0, 50.0, 25.0, 79.0, 70.0, 70.0, 45.0, 118.0, 13.0, 110.0, 69.0, -40.0, 98.0, 70.0, -10.0, 25.0, 60.0, 19.0, 44.0, 25.0, 65.0, 50.0, 16.0, 41.0, 130.0, 68.0, 81.0, 69.0, 60.0, 110.0, -15.0, 160.0, 290.0, 42.0, 86.0, 100.0, 176.0, 50.0, 63.0, 440.0, 90.0, -45.0, 90.0, 90.0, 60.0, -30.0, 48.0, 40.0, 100.0, 180.0, -30.0, 11.0, 50.0, 59.0, 30.0, 20.0, 160.0, 100.0, 360.0, 60.0, 80.0, 60.0, 110.0, 100.0, 45.0, 40.0, 100.0, 50.0, 30.0, 23.0, 30.0, 57.0, 80.0, 22.0, 155.0, 40.0, 126.0, -7.0, 100.0, 50.0, 57.0, 100.0, 110.0, 77.0, 65.0, -13.0, 54.0, 50.0, 210.0, 26.0, 70.0, 90.0, 30.0, 175.0, 13.0, 40.0, 3.0, 160.0, 55.0, 110.0, 14.0, -38.0, 59.0, 56.0, 510.0, -38.0, 60.0, 217.0, 30.0, 149.0, 98.0, 9.0, 120.0, 0.0, 40.0, 40.0, 40.0, 59.0, 80.0, 100.0, 49.0, 70.0, 20.0, 60.0, 29.0, 60.0, 2.0, 60.0, 70.0, 19.0, 26.0, 28.0, 31.0, 70.0, -8.0, 160.0, 19.0, 190.0, -10.0, 100.0, 130.0, 110.0, 74.0, 10.0, 41.0, 30.0, 270.0, 260.0, 59.0, 100.0, 60.0, 40.0, -24.0, 21.0, 48.0, 330.0, -10.0, -33.0, -37.0, 100.0, 200.0, 190.0, 150.0, 32.0, 30.0, 290.0, 70.0, 70.0, 290.0, 79.0, 16.0, -43.0, 70.0, 64.0, 105.0, 0.0, 60.0, 38.0, 85.0, 43.0, 0.0, 90.0, 45.0, 60.0, 120.0, 80.0, 30.0, 80.0, 51.0, 40.0, 80.0, 60.0, 50.0, 70.0, 80.0, 100.0, 80.0, 58.0, -10.0, 95.0, 190.0, 59.0, 37.0, 34.0, 60.0, 40.0, 19.0, 50.0, 20.0, 30.0, 59.0, 35.0, 50.0, 17.0, 10.0, 50.0, 27.0, 80.0, 18.0, 68.0, 18.0, 30.0, 120.0, 109.0, 59.0, 34.0, 310.0, 110.0, 40.0, 68.0, 170.0, 80.0, 69.0, 0.0, 60.0, 40.0, 170.0, 110.0, 40.0, 60.0, 39.0, 50.0, 130.0, 270.0, 29.0, 10.0, 2.0, 20.0, 60.0, 5.0, -8.0, 179.0, 26.0, 27.0, -12.0, 90.0, 18.0, 82.0, 60.0, 70.0, 70.0, 37.0, 60.0, 40.0, 50.0, 80.0, 60.0, 50.0, 50.0, 80.0, 60.0, 60.0, 60.0, 0.0, -43.0, 0.0, 150.0, 24.0, 70.0, 58.0, 15.0, 120.0, 90.0, 49.0, 110.0, 29.0, 50.0, 40.0, 40.0, 58.0, 47.0, 40.0, 10.0, 450.0, 100.0, 90.0, 160.0, 30.0, -20.0, 170.0, 60.0, 130.0, 70.0, 200.0, 60.0, 290.0, 19.0, 90.0, 4.0, 23.0, 60.0, 80.0, 28.0, 50.0, 120.0, 40.0, 40.0, 60.0, 28.0, 130.0, 80.0, 30.0, 8.0, 68.0, 40.0, 70.0, 0.0, 98.0, 46.0, 80.0, 150.0, 30.0, 70.0, -1.0, 70.0, -2.0, 50.0, 50.0, -10.0, 23.0, 90.0, 320.0, 71.0, 59.0, 70.0, 99.0, 37.0, 100.0, 16.0, 472.0, 33.0, 70.0, -4.0, 90.0, 9.0, -210.0, 137.0, -237.0, 140.0, 210.0, 40.0, -8.0, -24.0, -10.0, 100.0, 29.0, 109.0, 80.0, -102.0, 70.0, 267.0, 160.0, 150.0, 36.0, 70.0, 60.0, 80.0, -30.0, 550.0, 110.0, 37.0, 120.0, 70.0, 70.0, 90.0, 100.0, 57.0, 80.0, 50.0, 50.0, 60.0, 80.0, 47.0, 66.0, 20.0, 23.0, 55.0, 90.0, 25.0, 130.0, -53.0, 50.0, 195.0, 90.0, 50.0, 39.0, 20.0, 60.0, 90.0, 23.0, 41.0, 70.0, 90.0, 70.0, 90.0, 240.0, 80.0, 18.0, 180.0, 30.0, -40.0, 120.0, 310.0, 70.0, 60.0, 70.0, 50.0, 90.0, 40.0, 70.0, 30.0, 99.0, 50.0, 80.0, 50.0, 60.0, 35.0, 70.0, 80.0, 80.0, 38.0, 80.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.037009215579547, "mean_inference_ms": 2.3455581057608668, "mean_action_processing_ms": 0.7866803696124743, "mean_env_wait_ms": 1.6341852835758914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08335089683532715, "StateBufferConnector_ms": 0.010862588882446289, "ViewRequirementAgentConnector_ms": 0.5284428596496582}, "num_episodes": 22, "episode_return_max": 1390.0, "episode_return_min": 147.0, "episode_return_mean": 719.68, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.69430091555492, "num_env_steps_trained_throughput_per_sec": 32.69430091555492, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 3000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3000000, "timers": {"training_iteration_time_ms": 122507.502, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122507.447, "sample_time_ms": 2912.077, "learn_time_ms": 119572.83, "learn_throughput": 33.452, "synch_weights_time_ms": 13.061}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "done": false, "training_iteration": 75, "trial_id": "6085c_00000", "date": "2024-07-02_01-30-36", "timestamp": 1719898236, "time_this_iter_s": 122.36417984962463, "time_total_s": 11083.294724225998, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a88700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11083.294724225998, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 28.845664739884395, "ram_util_percent": 79.65317919075144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1567971930209313, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.30260152507006, "policy_loss": -0.006393259306449673, "vf_loss": 7.30809717371314, "vf_explained_var": 0.002398846610285604, "kl": 0.00897602381144411, "entropy": 0.9003613002320575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 708945.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 1509.0, "episode_reward_min": 147.0, "episode_reward_mean": 725.66, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -258.0}, "policy_reward_max": {"policy_0": 607.0}, "policy_reward_mean": {"policy_0": 72.566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [589.0, 392.0, 1195.0, 285.0, 396.0, 789.0, 715.0, 1390.0, 669.0, 457.0, 856.0, 561.0, 879.0, 684.0, 678.0, 899.0, 814.0, 657.0, 963.0, 721.0, 522.0, 789.0, 925.0, 678.0, 808.0, 1275.0, 541.0, 672.0, 1189.0, 774.0, 866.0, 962.0, 695.0, 267.0, 570.0, 982.0, 761.0, 504.0, 632.0, 364.0, 994.0, 1092.0, 519.0, 1039.0, 555.0, 753.0, 659.0, 591.0, 1211.0, 498.0, 385.0, 835.0, 846.0, 959.0, 904.0, 530.0, 651.0, 759.0, 397.0, 438.0, 1049.0, 699.0, 593.0, 502.0, 590.0, 484.0, 473.0, 1240.0, 854.0, 586.0, 652.0, 661.0, 952.0, 147.0, 853.0, 1103.0, 684.0, 601.0, 573.0, 1098.0, 629.0, 733.0, 638.0, 346.0, 790.0, 601.0, 597.0, 454.0, 582.0, 612.0, 665.0, 726.0, 761.0, 693.0, 886.0, 861.0, 1509.0, 710.0, 760.0, 639.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [72.0, 80.0, 110.0, 30.0, -258.0, 90.0, 180.0, 55.0, 60.0, 170.0, -17.0, -1.0, 57.0, 17.0, 100.0, 30.0, 7.0, 100.0, 39.0, 60.0, 130.0, 50.0, 70.0, 60.0, 607.0, 60.0, 44.0, 84.0, 40.0, 50.0, 46.0, -55.0, 70.0, 250.0, 50.0, -106.0, 25.0, -80.0, 46.0, 39.0, -151.0, 30.0, 110.0, 80.0, 60.0, 170.0, 104.0, 67.0, -144.0, 70.0, 50.0, 70.0, 80.0, 320.0, 51.0, 20.0, 58.0, -40.0, 90.0, 90.0, 17.0, 100.0, 0.0, 54.0, 8.0, 66.0, 30.0, 70.0, 70.0, 300.0, 80.0, 70.0, 600.0, 34.0, 8.0, 0.0, 169.0, 170.0, 180.0, 79.0, 178.0, 59.0, 50.0, 60.0, 50.0, 70.0, 38.0, -5.0, 119.0, 50.0, 50.0, -33.0, 38.0, 60.0, 28.0, -12.0, 18.0, 50.0, 220.0, 38.0, 100.0, 80.0, 150.0, 200.0, 87.0, 30.0, 100.0, -1.0, 40.0, 70.0, 80.0, 83.0, 110.0, 9.0, -14.0, 27.0, 45.0, 110.0, 73.0, 38.0, 40.0, 90.0, 80.0, 50.0, 70.0, 170.0, 70.0, 40.0, 209.0, 60.0, 110.0, 39.0, 90.0, 70.0, 150.0, 20.0, 90.0, -15.0, 110.0, 20.0, 90.0, 30.0, 38.0, 160.0, 54.0, -1.0, 47.0, 180.0, 10.0, 70.0, 48.0, 50.0, 100.0, 31.0, 171.0, 80.0, 8.0, 40.0, 360.0, 11.0, 310.0, 30.0, 160.0, 66.0, 179.0, 10.0, 16.0, 49.0, -15.0, 9.0, 90.0, 18.0, 25.0, 70.0, 45.0, 120.0, 129.0, 60.0, 30.0, 70.0, 71.0, 113.0, -9.0, 18.0, 160.0, 70.0, 140.0, 160.0, 170.0, 70.0, 40.0, 185.0, 30.0, 110.0, 40.0, 144.0, 30.0, 70.0, 20.0, 52.0, 150.0, 31.0, 50.0, 70.0, 67.0, 46.0, 21.0, 17.0, 40.0, 30.0, 250.0, 200.0, 30.0, 60.0, -30.0, 90.0, 33.0, 26.0, 40.0, 90.0, 80.0, 38.0, 7.0, -2.0, 418.0, 187.0, 111.0, 40.0, 24.0, 22.0, 170.0, 110.0, 110.0, -37.0, 50.0, 20.0, 80.0, 57.0, 80.0, 38.0, 17.0, 209.0, 8.0, 58.0, 32.0, 5.0, 260.0, 69.0, 90.0, 60.0, 60.0, 20.0, 48.0, 120.0, 57.0, 90.0, 90.0, 430.0, 80.0, 280.0, 5.0, 150.0, 40.0, 47.0, 50.0, 35.0, 100.0, 9.0, 70.0, 35.0, 41.0, 40.0, 110.0, 120.0, 41.0, 70.0, 30.0, 60.0, 70.0, 90.0, -31.0, -2.0, 200.0, 310.0, 57.0, 350.0, 49.0, 110.0, 66.0, 80.0, 66.0, 30.0, 60.0, 187.0, 30.0, 15.0, 10.0, 260.0, 90.0, 26.0, 70.0, 70.0, 23.0, 272.0, 60.0, 59.0, 60.0, 98.0, 68.0, 86.0, -40.0, 70.0, 100.0, 90.0, 243.0, 172.0, 76.0, 100.0, 71.0, 80.0, -32.0, 40.0, 35.0, 60.0, 110.0, 180.0, 110.0, 28.0, 54.0, 110.0, 50.0, 28.0, 20.0, 70.0, 16.0, -156.0, 210.0, 43.0, -24.0, 10.0, 49.0, 60.0, 53.0, 30.0, 48.0, 20.0, 50.0, 70.0, 120.0, 70.0, 170.0, 110.0, 35.0, 100.0, 156.0, -21.0, 13.0, 200.0, 80.0, 139.0, 8.0, 20.0, 100.0, 34.0, 49.0, 210.0, 40.0, 70.0, 70.0, 160.0, 50.0, 80.0, 56.0, 90.0, 50.0, -40.0, 73.0, 70.0, 50.0, 25.0, 79.0, 70.0, 70.0, 45.0, 118.0, 13.0, 110.0, 69.0, -40.0, 98.0, 70.0, -10.0, 25.0, 60.0, 19.0, 44.0, 25.0, 65.0, 50.0, 16.0, 41.0, 130.0, 68.0, 81.0, 69.0, 60.0, 110.0, -15.0, 160.0, 290.0, 42.0, 86.0, 100.0, 176.0, 50.0, 63.0, 440.0, 90.0, -45.0, 90.0, 90.0, 60.0, -30.0, 48.0, 40.0, 100.0, 180.0, -30.0, 11.0, 50.0, 59.0, 30.0, 20.0, 160.0, 100.0, 360.0, 60.0, 80.0, 60.0, 110.0, 100.0, 45.0, 40.0, 100.0, 50.0, 30.0, 23.0, 30.0, 57.0, 80.0, 22.0, 155.0, 40.0, 126.0, -7.0, 100.0, 50.0, 57.0, 100.0, 110.0, 77.0, 65.0, -13.0, 54.0, 50.0, 210.0, 26.0, 70.0, 90.0, 30.0, 175.0, 13.0, 40.0, 3.0, 160.0, 55.0, 110.0, 14.0, -38.0, 59.0, 56.0, 510.0, -38.0, 60.0, 217.0, 30.0, 149.0, 98.0, 9.0, 120.0, 0.0, 40.0, 40.0, 40.0, 59.0, 80.0, 100.0, 49.0, 70.0, 20.0, 60.0, 29.0, 60.0, 2.0, 60.0, 70.0, 19.0, 26.0, 28.0, 31.0, 70.0, -8.0, 160.0, 19.0, 190.0, -10.0, 100.0, 130.0, 110.0, 74.0, 10.0, 41.0, 30.0, 270.0, 260.0, 59.0, 100.0, 60.0, 40.0, -24.0, 21.0, 48.0, 330.0, -10.0, -33.0, -37.0, 100.0, 200.0, 190.0, 150.0, 32.0, 30.0, 290.0, 70.0, 70.0, 290.0, 79.0, 16.0, -43.0, 70.0, 64.0, 105.0, 0.0, 60.0, 38.0, 85.0, 43.0, 0.0, 90.0, 45.0, 60.0, 120.0, 80.0, 30.0, 80.0, 51.0, 40.0, 80.0, 60.0, 50.0, 70.0, 80.0, 100.0, 80.0, 58.0, -10.0, 95.0, 190.0, 59.0, 37.0, 34.0, 60.0, 40.0, 19.0, 50.0, 20.0, 30.0, 59.0, 35.0, 50.0, 17.0, 10.0, 50.0, 27.0, 80.0, 18.0, 68.0, 18.0, 30.0, 120.0, 109.0, 59.0, 34.0, 310.0, 110.0, 40.0, 68.0, 170.0, 80.0, 69.0, 0.0, 60.0, 40.0, 170.0, 110.0, 40.0, 60.0, 39.0, 50.0, 130.0, 270.0, 29.0, 10.0, 2.0, 20.0, 60.0, 5.0, -8.0, 179.0, 26.0, 27.0, -12.0, 90.0, 18.0, 82.0, 60.0, 70.0, 70.0, 37.0, 60.0, 40.0, 50.0, 80.0, 60.0, 50.0, 50.0, 80.0, 60.0, 60.0, 60.0, 0.0, -43.0, 0.0, 150.0, 24.0, 70.0, 58.0, 15.0, 120.0, 90.0, 49.0, 110.0, 29.0, 50.0, 40.0, 40.0, 58.0, 47.0, 40.0, 10.0, 450.0, 100.0, 90.0, 160.0, 30.0, -20.0, 170.0, 60.0, 130.0, 70.0, 200.0, 60.0, 290.0, 19.0, 90.0, 4.0, 23.0, 60.0, 80.0, 28.0, 50.0, 120.0, 40.0, 40.0, 60.0, 28.0, 130.0, 80.0, 30.0, 8.0, 68.0, 40.0, 70.0, 0.0, 98.0, 46.0, 80.0, 150.0, 30.0, 70.0, -1.0, 70.0, -2.0, 50.0, 50.0, -10.0, 23.0, 90.0, 320.0, 71.0, 59.0, 70.0, 99.0, 37.0, 100.0, 16.0, 472.0, 33.0, 70.0, -4.0, 90.0, 9.0, -210.0, 137.0, -237.0, 140.0, 210.0, 40.0, -8.0, -24.0, -10.0, 100.0, 29.0, 109.0, 80.0, -102.0, 70.0, 267.0, 160.0, 150.0, 36.0, 70.0, 60.0, 80.0, -30.0, 550.0, 110.0, 37.0, 120.0, 70.0, 70.0, 90.0, 100.0, 57.0, 80.0, 50.0, 50.0, 60.0, 80.0, 47.0, 66.0, 20.0, 23.0, 55.0, 90.0, 25.0, 130.0, -53.0, 50.0, 195.0, 90.0, 50.0, 39.0, 20.0, 60.0, 90.0, 23.0, 41.0, 70.0, 90.0, 70.0, 90.0, 240.0, 80.0, 18.0, 180.0, 30.0, -40.0, 120.0, 310.0, 70.0, 60.0, 70.0, 50.0, 90.0, 40.0, 70.0, 30.0, 99.0, 50.0, 80.0, 50.0, 60.0, 35.0, 70.0, 80.0, 80.0, 38.0, 80.0, 160.0, 44.0, 170.0, 100.0, 50.0, 170.0, 70.0, -69.0, 10.0, 70.0, 23.0, 14.0, 31.0, 37.0, 30.0, 0.0, 50.0, 50.0, 60.0, 24.0, 50.0, 67.0, 80.0, 60.0, 70.0, 40.0, 35.0, 52.0, 140.0, 156.0, 90.0, 63.0, 8.0, 50.0, 8.0, 15.0, -9.0, 78.0, 50.0, 168.0, 170.0, 160.0, 21.0, 40.0, 30.0, 68.0, 39.0, 39.0, 29.0, 146.0, 25.0, 32.0, 90.0, 44.0, 50.0, 45.0, -4.0, 50.0, 7.0, 100.0, 40.0, 70.0, -13.0, 180.0, 190.0, 48.0, 25.0, 6.0, 40.0, 36.0, 0.0, 70.0, 30.0, 159.0, 1.0, 45.0, 150.0, 70.0, 50.0, 19.0, 18.0, 28.0, 70.0, 80.0, -50.0, 160.0, 160.0, 50.0, 60.0, 67.0, 40.0, 68.0, 120.0, 120.0, 29.0, 68.0, 50.0, 40.0, 120.0, 74.0, 37.0, 160.0, 70.0, 19.0, 20.0, 40.0, 70.0, 170.0, 148.0, 16.0, 48.0, 40.0, 110.0, 20.0, 60.0, 154.0, 47.0, 60.0, 84.0, 70.0, 48.0, 120.0, -25.0, 21.0, 80.0, 330.0, 62.0, 170.0, 37.0, 68.0, 23.0, 120.0, 37.0, 73.0, 69.0, 47.0, 110.0, 96.0, 100.0, 89.0, 120.0, 17.0, 530.0, 100.0, 130.0, 55.0, 110.0, 50.0, 280.0, 187.0, 50.0, 70.0, 80.0, 170.0, 29.0, -34.0, 180.0, 16.0, 77.0, 110.0, 12.0, 80.0, 40.0, 90.0, 80.0, 100.0, 70.0, 50.0, 70.0, 90.0, 90.0, 190.0, 60.0, 39.0, 39.0, 50.0, 10.0, 29.0, 38.0, 69.0, 115.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0323153586628813, "mean_inference_ms": 2.341505979963399, "mean_action_processing_ms": 0.7876088280979897, "mean_env_wait_ms": 1.631144599018773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0840291976928711, "StateBufferConnector_ms": 0.010901689529418945, "ViewRequirementAgentConnector_ms": 0.5266227722167969}, "num_episodes": 18, "episode_return_max": 1509.0, "episode_return_min": 147.0, "episode_return_mean": 725.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.551421090660114, "num_env_steps_trained_throughput_per_sec": 32.551421090660114, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 122509.965, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122509.909, "sample_time_ms": 2938.461, "learn_time_ms": 119548.156, "learn_throughput": 33.459, "synch_weights_time_ms": 12.804}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 76, "trial_id": "6085c_00000", "date": "2024-07-02_01-32-39", "timestamp": 1719898359, "time_this_iter_s": 122.9090518951416, "time_total_s": 11206.20377612114, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11206.20377612114, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 29.17758620689655, "ram_util_percent": 80.45459770114942}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9242701305050693, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.110733464274544, "policy_loss": -0.005759171975619845, "vf_loss": 7.115494615556841, "vf_explained_var": 0.0006998895519711593, "kl": 0.009980218443284165, "entropy": 0.858601501352363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 718335.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "env_runners": {"episode_reward_max": 1509.0, "episode_reward_min": 147.0, "episode_reward_mean": 733.29, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -237.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 73.329}, "custom_metrics": {}, "hist_stats": {"episode_reward": [678.0, 808.0, 1275.0, 541.0, 672.0, 1189.0, 774.0, 866.0, 962.0, 695.0, 267.0, 570.0, 982.0, 761.0, 504.0, 632.0, 364.0, 994.0, 1092.0, 519.0, 1039.0, 555.0, 753.0, 659.0, 591.0, 1211.0, 498.0, 385.0, 835.0, 846.0, 959.0, 904.0, 530.0, 651.0, 759.0, 397.0, 438.0, 1049.0, 699.0, 593.0, 502.0, 590.0, 484.0, 473.0, 1240.0, 854.0, 586.0, 652.0, 661.0, 952.0, 147.0, 853.0, 1103.0, 684.0, 601.0, 573.0, 1098.0, 629.0, 733.0, 638.0, 346.0, 790.0, 601.0, 597.0, 454.0, 582.0, 612.0, 665.0, 726.0, 761.0, 693.0, 886.0, 861.0, 1509.0, 710.0, 760.0, 639.0, 755.0, 476.0, 545.0, 557.0, 539.0, 625.0, 863.0, 1257.0, 741.0, 1178.0, 550.0, 982.0, 615.0, 1323.0, 326.0, 718.0, 884.0, 921.0, 780.0, 928.0, 668.0, 599.0, 758.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 110.0, 110.0, -37.0, 50.0, 20.0, 80.0, 57.0, 80.0, 38.0, 17.0, 209.0, 8.0, 58.0, 32.0, 5.0, 260.0, 69.0, 90.0, 60.0, 60.0, 20.0, 48.0, 120.0, 57.0, 90.0, 90.0, 430.0, 80.0, 280.0, 5.0, 150.0, 40.0, 47.0, 50.0, 35.0, 100.0, 9.0, 70.0, 35.0, 41.0, 40.0, 110.0, 120.0, 41.0, 70.0, 30.0, 60.0, 70.0, 90.0, -31.0, -2.0, 200.0, 310.0, 57.0, 350.0, 49.0, 110.0, 66.0, 80.0, 66.0, 30.0, 60.0, 187.0, 30.0, 15.0, 10.0, 260.0, 90.0, 26.0, 70.0, 70.0, 23.0, 272.0, 60.0, 59.0, 60.0, 98.0, 68.0, 86.0, -40.0, 70.0, 100.0, 90.0, 243.0, 172.0, 76.0, 100.0, 71.0, 80.0, -32.0, 40.0, 35.0, 60.0, 110.0, 180.0, 110.0, 28.0, 54.0, 110.0, 50.0, 28.0, 20.0, 70.0, 16.0, -156.0, 210.0, 43.0, -24.0, 10.0, 49.0, 60.0, 53.0, 30.0, 48.0, 20.0, 50.0, 70.0, 120.0, 70.0, 170.0, 110.0, 35.0, 100.0, 156.0, -21.0, 13.0, 200.0, 80.0, 139.0, 8.0, 20.0, 100.0, 34.0, 49.0, 210.0, 40.0, 70.0, 70.0, 160.0, 50.0, 80.0, 56.0, 90.0, 50.0, -40.0, 73.0, 70.0, 50.0, 25.0, 79.0, 70.0, 70.0, 45.0, 118.0, 13.0, 110.0, 69.0, -40.0, 98.0, 70.0, -10.0, 25.0, 60.0, 19.0, 44.0, 25.0, 65.0, 50.0, 16.0, 41.0, 130.0, 68.0, 81.0, 69.0, 60.0, 110.0, -15.0, 160.0, 290.0, 42.0, 86.0, 100.0, 176.0, 50.0, 63.0, 440.0, 90.0, -45.0, 90.0, 90.0, 60.0, -30.0, 48.0, 40.0, 100.0, 180.0, -30.0, 11.0, 50.0, 59.0, 30.0, 20.0, 160.0, 100.0, 360.0, 60.0, 80.0, 60.0, 110.0, 100.0, 45.0, 40.0, 100.0, 50.0, 30.0, 23.0, 30.0, 57.0, 80.0, 22.0, 155.0, 40.0, 126.0, -7.0, 100.0, 50.0, 57.0, 100.0, 110.0, 77.0, 65.0, -13.0, 54.0, 50.0, 210.0, 26.0, 70.0, 90.0, 30.0, 175.0, 13.0, 40.0, 3.0, 160.0, 55.0, 110.0, 14.0, -38.0, 59.0, 56.0, 510.0, -38.0, 60.0, 217.0, 30.0, 149.0, 98.0, 9.0, 120.0, 0.0, 40.0, 40.0, 40.0, 59.0, 80.0, 100.0, 49.0, 70.0, 20.0, 60.0, 29.0, 60.0, 2.0, 60.0, 70.0, 19.0, 26.0, 28.0, 31.0, 70.0, -8.0, 160.0, 19.0, 190.0, -10.0, 100.0, 130.0, 110.0, 74.0, 10.0, 41.0, 30.0, 270.0, 260.0, 59.0, 100.0, 60.0, 40.0, -24.0, 21.0, 48.0, 330.0, -10.0, -33.0, -37.0, 100.0, 200.0, 190.0, 150.0, 32.0, 30.0, 290.0, 70.0, 70.0, 290.0, 79.0, 16.0, -43.0, 70.0, 64.0, 105.0, 0.0, 60.0, 38.0, 85.0, 43.0, 0.0, 90.0, 45.0, 60.0, 120.0, 80.0, 30.0, 80.0, 51.0, 40.0, 80.0, 60.0, 50.0, 70.0, 80.0, 100.0, 80.0, 58.0, -10.0, 95.0, 190.0, 59.0, 37.0, 34.0, 60.0, 40.0, 19.0, 50.0, 20.0, 30.0, 59.0, 35.0, 50.0, 17.0, 10.0, 50.0, 27.0, 80.0, 18.0, 68.0, 18.0, 30.0, 120.0, 109.0, 59.0, 34.0, 310.0, 110.0, 40.0, 68.0, 170.0, 80.0, 69.0, 0.0, 60.0, 40.0, 170.0, 110.0, 40.0, 60.0, 39.0, 50.0, 130.0, 270.0, 29.0, 10.0, 2.0, 20.0, 60.0, 5.0, -8.0, 179.0, 26.0, 27.0, -12.0, 90.0, 18.0, 82.0, 60.0, 70.0, 70.0, 37.0, 60.0, 40.0, 50.0, 80.0, 60.0, 50.0, 50.0, 80.0, 60.0, 60.0, 60.0, 0.0, -43.0, 0.0, 150.0, 24.0, 70.0, 58.0, 15.0, 120.0, 90.0, 49.0, 110.0, 29.0, 50.0, 40.0, 40.0, 58.0, 47.0, 40.0, 10.0, 450.0, 100.0, 90.0, 160.0, 30.0, -20.0, 170.0, 60.0, 130.0, 70.0, 200.0, 60.0, 290.0, 19.0, 90.0, 4.0, 23.0, 60.0, 80.0, 28.0, 50.0, 120.0, 40.0, 40.0, 60.0, 28.0, 130.0, 80.0, 30.0, 8.0, 68.0, 40.0, 70.0, 0.0, 98.0, 46.0, 80.0, 150.0, 30.0, 70.0, -1.0, 70.0, -2.0, 50.0, 50.0, -10.0, 23.0, 90.0, 320.0, 71.0, 59.0, 70.0, 99.0, 37.0, 100.0, 16.0, 472.0, 33.0, 70.0, -4.0, 90.0, 9.0, -210.0, 137.0, -237.0, 140.0, 210.0, 40.0, -8.0, -24.0, -10.0, 100.0, 29.0, 109.0, 80.0, -102.0, 70.0, 267.0, 160.0, 150.0, 36.0, 70.0, 60.0, 80.0, -30.0, 550.0, 110.0, 37.0, 120.0, 70.0, 70.0, 90.0, 100.0, 57.0, 80.0, 50.0, 50.0, 60.0, 80.0, 47.0, 66.0, 20.0, 23.0, 55.0, 90.0, 25.0, 130.0, -53.0, 50.0, 195.0, 90.0, 50.0, 39.0, 20.0, 60.0, 90.0, 23.0, 41.0, 70.0, 90.0, 70.0, 90.0, 240.0, 80.0, 18.0, 180.0, 30.0, -40.0, 120.0, 310.0, 70.0, 60.0, 70.0, 50.0, 90.0, 40.0, 70.0, 30.0, 99.0, 50.0, 80.0, 50.0, 60.0, 35.0, 70.0, 80.0, 80.0, 38.0, 80.0, 160.0, 44.0, 170.0, 100.0, 50.0, 170.0, 70.0, -69.0, 10.0, 70.0, 23.0, 14.0, 31.0, 37.0, 30.0, 0.0, 50.0, 50.0, 60.0, 24.0, 50.0, 67.0, 80.0, 60.0, 70.0, 40.0, 35.0, 52.0, 140.0, 156.0, 90.0, 63.0, 8.0, 50.0, 8.0, 15.0, -9.0, 78.0, 50.0, 168.0, 170.0, 160.0, 21.0, 40.0, 30.0, 68.0, 39.0, 39.0, 29.0, 146.0, 25.0, 32.0, 90.0, 44.0, 50.0, 45.0, -4.0, 50.0, 7.0, 100.0, 40.0, 70.0, -13.0, 180.0, 190.0, 48.0, 25.0, 6.0, 40.0, 36.0, 0.0, 70.0, 30.0, 159.0, 1.0, 45.0, 150.0, 70.0, 50.0, 19.0, 18.0, 28.0, 70.0, 80.0, -50.0, 160.0, 160.0, 50.0, 60.0, 67.0, 40.0, 68.0, 120.0, 120.0, 29.0, 68.0, 50.0, 40.0, 120.0, 74.0, 37.0, 160.0, 70.0, 19.0, 20.0, 40.0, 70.0, 170.0, 148.0, 16.0, 48.0, 40.0, 110.0, 20.0, 60.0, 154.0, 47.0, 60.0, 84.0, 70.0, 48.0, 120.0, -25.0, 21.0, 80.0, 330.0, 62.0, 170.0, 37.0, 68.0, 23.0, 120.0, 37.0, 73.0, 69.0, 47.0, 110.0, 96.0, 100.0, 89.0, 120.0, 17.0, 530.0, 100.0, 130.0, 55.0, 110.0, 50.0, 280.0, 187.0, 50.0, 70.0, 80.0, 170.0, 29.0, -34.0, 180.0, 16.0, 77.0, 110.0, 12.0, 80.0, 40.0, 90.0, 80.0, 100.0, 70.0, 50.0, 70.0, 90.0, 90.0, 190.0, 60.0, 39.0, 39.0, 50.0, 10.0, 29.0, 38.0, 69.0, 115.0, 108.0, 50.0, 30.0, 20.0, 70.0, 29.0, 4.0, 220.0, 210.0, 14.0, 99.0, 60.0, 50.0, -12.0, 40.0, -8.0, 69.0, 70.0, 59.0, 49.0, 96.0, 60.0, 80.0, 50.0, 90.0, 39.0, 47.0, 27.0, 40.0, 16.0, 130.0, 39.0, 19.0, 40.0, 80.0, 80.0, 39.0, 70.0, 40.0, 20.0, 60.0, 17.0, 50.0, 30.0, 30.0, 4.0, 50.0, 160.0, 100.0, 38.0, 10.0, -70.0, 53.0, 100.0, 46.0, 49.0, 160.0, 36.0, 29.0, 212.0, 320.0, 90.0, 21.0, 60.0, 50.0, -27.0, 29.0, 160.0, 90.0, 70.0, 99.0, 49.0, 120.0, 90.0, 40.0, 60.0, 200.0, 540.0, 30.0, 29.0, 90.0, 110.0, 49.0, 90.0, 70.0, 61.0, 50.0, 81.0, 100.0, 40.0, 120.0, 50.0, 90.0, 86.0, 0.0, 270.0, 148.0, 397.0, -43.0, 60.0, 40.0, 20.0, 70.0, 40.0, 50.0, 50.0, 90.0, 80.0, 70.0, 40.0, 52.0, 170.0, 110.0, 40.0, 110.0, 250.0, 149.0, -14.0, 30.0, 85.0, 160.0, 60.0, 34.0, -20.0, 49.0, 30.0, -20.0, 300.0, 28.0, -6.0, 80.0, 79.0, 90.0, 60.0, 59.0, 79.0, 600.0, 10.0, -4.0, 270.0, 12.0, 46.0, 23.0, -12.0, 27.0, 8.0, 144.0, 80.0, 11.0, -13.0, 17.0, 65.0, 40.0, 40.0, 170.0, -13.0, 130.0, 130.0, 39.0, 100.0, 55.0, 42.0, 50.0, 310.0, 160.0, 88.0, 25.0, 48.0, 60.0, 46.0, 280.0, 49.0, -5.0, 24.0, 45.0, 19.0, 290.0, 19.0, 120.0, 80.0, 170.0, 90.0, 50.0, 100.0, 70.0, 70.0, 30.0, 170.0, -20.0, 50.0, 4.0, 4.0, 300.0, 333.0, -54.0, -7.0, 158.0, 110.0, 30.0, 50.0, 110.0, 150.0, 50.0, 46.0, -3.0, 94.0, 40.0, 60.0, 60.0, 61.0, 30.0, 178.0, 7.0, 100.0, -3.0, 50.0, 170.0, 1.0, 33.0, 33.0, 158.0, 44.0, 32.0, 171.0, 29.0, 20.0, 39.0, 32.0, 270.0, -37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.028367016145266, "mean_inference_ms": 2.3355052415188053, "mean_action_processing_ms": 0.7854484651674936, "mean_env_wait_ms": 1.6271424391366085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08017635345458984, "StateBufferConnector_ms": 0.0109405517578125, "ViewRequirementAgentConnector_ms": 0.5136721134185791}, "num_episodes": 23, "episode_return_max": 1509.0, "episode_return_min": 147.0, "episode_return_mean": 733.29, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.499754201617165, "num_env_steps_trained_throughput_per_sec": 32.499754201617165, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 3080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3080000, "timers": {"training_iteration_time_ms": 122673.167, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122673.112, "sample_time_ms": 2961.099, "learn_time_ms": 119687.958, "learn_throughput": 33.42, "synch_weights_time_ms": 12.941}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "done": false, "training_iteration": 77, "trial_id": "6085c_00000", "date": "2024-07-02_01-34-42", "timestamp": 1719898482, "time_this_iter_s": 123.0962119102478, "time_total_s": 11329.299988031387, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238edc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11329.299988031387, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 28.555172413793105, "ram_util_percent": 79.73448275862069}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1817170805570543, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.217812249048576, "policy_loss": -0.0069148548127422795, "vf_loss": 7.223810147121945, "vf_explained_var": 0.0034678524802414117, "kl": 0.009169567169066514, "entropy": 0.8600158096311953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 727725.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 1509.0, "episode_reward_min": 147.0, "episode_reward_mean": 721.72, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -237.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 72.172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1092.0, 519.0, 1039.0, 555.0, 753.0, 659.0, 591.0, 1211.0, 498.0, 385.0, 835.0, 846.0, 959.0, 904.0, 530.0, 651.0, 759.0, 397.0, 438.0, 1049.0, 699.0, 593.0, 502.0, 590.0, 484.0, 473.0, 1240.0, 854.0, 586.0, 652.0, 661.0, 952.0, 147.0, 853.0, 1103.0, 684.0, 601.0, 573.0, 1098.0, 629.0, 733.0, 638.0, 346.0, 790.0, 601.0, 597.0, 454.0, 582.0, 612.0, 665.0, 726.0, 761.0, 693.0, 886.0, 861.0, 1509.0, 710.0, 760.0, 639.0, 755.0, 476.0, 545.0, 557.0, 539.0, 625.0, 863.0, 1257.0, 741.0, 1178.0, 550.0, 982.0, 615.0, 1323.0, 326.0, 718.0, 884.0, 921.0, 780.0, 928.0, 668.0, 599.0, 758.0, 911.0, 1147.0, 945.0, 901.0, 412.0, 328.0, 419.0, 504.0, 965.0, 842.0, 483.0, 638.0, 460.0, 898.0, 380.0, 680.0, 698.0, 766.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [42.0, 86.0, 100.0, 176.0, 50.0, 63.0, 440.0, 90.0, -45.0, 90.0, 90.0, 60.0, -30.0, 48.0, 40.0, 100.0, 180.0, -30.0, 11.0, 50.0, 59.0, 30.0, 20.0, 160.0, 100.0, 360.0, 60.0, 80.0, 60.0, 110.0, 100.0, 45.0, 40.0, 100.0, 50.0, 30.0, 23.0, 30.0, 57.0, 80.0, 22.0, 155.0, 40.0, 126.0, -7.0, 100.0, 50.0, 57.0, 100.0, 110.0, 77.0, 65.0, -13.0, 54.0, 50.0, 210.0, 26.0, 70.0, 90.0, 30.0, 175.0, 13.0, 40.0, 3.0, 160.0, 55.0, 110.0, 14.0, -38.0, 59.0, 56.0, 510.0, -38.0, 60.0, 217.0, 30.0, 149.0, 98.0, 9.0, 120.0, 0.0, 40.0, 40.0, 40.0, 59.0, 80.0, 100.0, 49.0, 70.0, 20.0, 60.0, 29.0, 60.0, 2.0, 60.0, 70.0, 19.0, 26.0, 28.0, 31.0, 70.0, -8.0, 160.0, 19.0, 190.0, -10.0, 100.0, 130.0, 110.0, 74.0, 10.0, 41.0, 30.0, 270.0, 260.0, 59.0, 100.0, 60.0, 40.0, -24.0, 21.0, 48.0, 330.0, -10.0, -33.0, -37.0, 100.0, 200.0, 190.0, 150.0, 32.0, 30.0, 290.0, 70.0, 70.0, 290.0, 79.0, 16.0, -43.0, 70.0, 64.0, 105.0, 0.0, 60.0, 38.0, 85.0, 43.0, 0.0, 90.0, 45.0, 60.0, 120.0, 80.0, 30.0, 80.0, 51.0, 40.0, 80.0, 60.0, 50.0, 70.0, 80.0, 100.0, 80.0, 58.0, -10.0, 95.0, 190.0, 59.0, 37.0, 34.0, 60.0, 40.0, 19.0, 50.0, 20.0, 30.0, 59.0, 35.0, 50.0, 17.0, 10.0, 50.0, 27.0, 80.0, 18.0, 68.0, 18.0, 30.0, 120.0, 109.0, 59.0, 34.0, 310.0, 110.0, 40.0, 68.0, 170.0, 80.0, 69.0, 0.0, 60.0, 40.0, 170.0, 110.0, 40.0, 60.0, 39.0, 50.0, 130.0, 270.0, 29.0, 10.0, 2.0, 20.0, 60.0, 5.0, -8.0, 179.0, 26.0, 27.0, -12.0, 90.0, 18.0, 82.0, 60.0, 70.0, 70.0, 37.0, 60.0, 40.0, 50.0, 80.0, 60.0, 50.0, 50.0, 80.0, 60.0, 60.0, 60.0, 0.0, -43.0, 0.0, 150.0, 24.0, 70.0, 58.0, 15.0, 120.0, 90.0, 49.0, 110.0, 29.0, 50.0, 40.0, 40.0, 58.0, 47.0, 40.0, 10.0, 450.0, 100.0, 90.0, 160.0, 30.0, -20.0, 170.0, 60.0, 130.0, 70.0, 200.0, 60.0, 290.0, 19.0, 90.0, 4.0, 23.0, 60.0, 80.0, 28.0, 50.0, 120.0, 40.0, 40.0, 60.0, 28.0, 130.0, 80.0, 30.0, 8.0, 68.0, 40.0, 70.0, 0.0, 98.0, 46.0, 80.0, 150.0, 30.0, 70.0, -1.0, 70.0, -2.0, 50.0, 50.0, -10.0, 23.0, 90.0, 320.0, 71.0, 59.0, 70.0, 99.0, 37.0, 100.0, 16.0, 472.0, 33.0, 70.0, -4.0, 90.0, 9.0, -210.0, 137.0, -237.0, 140.0, 210.0, 40.0, -8.0, -24.0, -10.0, 100.0, 29.0, 109.0, 80.0, -102.0, 70.0, 267.0, 160.0, 150.0, 36.0, 70.0, 60.0, 80.0, -30.0, 550.0, 110.0, 37.0, 120.0, 70.0, 70.0, 90.0, 100.0, 57.0, 80.0, 50.0, 50.0, 60.0, 80.0, 47.0, 66.0, 20.0, 23.0, 55.0, 90.0, 25.0, 130.0, -53.0, 50.0, 195.0, 90.0, 50.0, 39.0, 20.0, 60.0, 90.0, 23.0, 41.0, 70.0, 90.0, 70.0, 90.0, 240.0, 80.0, 18.0, 180.0, 30.0, -40.0, 120.0, 310.0, 70.0, 60.0, 70.0, 50.0, 90.0, 40.0, 70.0, 30.0, 99.0, 50.0, 80.0, 50.0, 60.0, 35.0, 70.0, 80.0, 80.0, 38.0, 80.0, 160.0, 44.0, 170.0, 100.0, 50.0, 170.0, 70.0, -69.0, 10.0, 70.0, 23.0, 14.0, 31.0, 37.0, 30.0, 0.0, 50.0, 50.0, 60.0, 24.0, 50.0, 67.0, 80.0, 60.0, 70.0, 40.0, 35.0, 52.0, 140.0, 156.0, 90.0, 63.0, 8.0, 50.0, 8.0, 15.0, -9.0, 78.0, 50.0, 168.0, 170.0, 160.0, 21.0, 40.0, 30.0, 68.0, 39.0, 39.0, 29.0, 146.0, 25.0, 32.0, 90.0, 44.0, 50.0, 45.0, -4.0, 50.0, 7.0, 100.0, 40.0, 70.0, -13.0, 180.0, 190.0, 48.0, 25.0, 6.0, 40.0, 36.0, 0.0, 70.0, 30.0, 159.0, 1.0, 45.0, 150.0, 70.0, 50.0, 19.0, 18.0, 28.0, 70.0, 80.0, -50.0, 160.0, 160.0, 50.0, 60.0, 67.0, 40.0, 68.0, 120.0, 120.0, 29.0, 68.0, 50.0, 40.0, 120.0, 74.0, 37.0, 160.0, 70.0, 19.0, 20.0, 40.0, 70.0, 170.0, 148.0, 16.0, 48.0, 40.0, 110.0, 20.0, 60.0, 154.0, 47.0, 60.0, 84.0, 70.0, 48.0, 120.0, -25.0, 21.0, 80.0, 330.0, 62.0, 170.0, 37.0, 68.0, 23.0, 120.0, 37.0, 73.0, 69.0, 47.0, 110.0, 96.0, 100.0, 89.0, 120.0, 17.0, 530.0, 100.0, 130.0, 55.0, 110.0, 50.0, 280.0, 187.0, 50.0, 70.0, 80.0, 170.0, 29.0, -34.0, 180.0, 16.0, 77.0, 110.0, 12.0, 80.0, 40.0, 90.0, 80.0, 100.0, 70.0, 50.0, 70.0, 90.0, 90.0, 190.0, 60.0, 39.0, 39.0, 50.0, 10.0, 29.0, 38.0, 69.0, 115.0, 108.0, 50.0, 30.0, 20.0, 70.0, 29.0, 4.0, 220.0, 210.0, 14.0, 99.0, 60.0, 50.0, -12.0, 40.0, -8.0, 69.0, 70.0, 59.0, 49.0, 96.0, 60.0, 80.0, 50.0, 90.0, 39.0, 47.0, 27.0, 40.0, 16.0, 130.0, 39.0, 19.0, 40.0, 80.0, 80.0, 39.0, 70.0, 40.0, 20.0, 60.0, 17.0, 50.0, 30.0, 30.0, 4.0, 50.0, 160.0, 100.0, 38.0, 10.0, -70.0, 53.0, 100.0, 46.0, 49.0, 160.0, 36.0, 29.0, 212.0, 320.0, 90.0, 21.0, 60.0, 50.0, -27.0, 29.0, 160.0, 90.0, 70.0, 99.0, 49.0, 120.0, 90.0, 40.0, 60.0, 200.0, 540.0, 30.0, 29.0, 90.0, 110.0, 49.0, 90.0, 70.0, 61.0, 50.0, 81.0, 100.0, 40.0, 120.0, 50.0, 90.0, 86.0, 0.0, 270.0, 148.0, 397.0, -43.0, 60.0, 40.0, 20.0, 70.0, 40.0, 50.0, 50.0, 90.0, 80.0, 70.0, 40.0, 52.0, 170.0, 110.0, 40.0, 110.0, 250.0, 149.0, -14.0, 30.0, 85.0, 160.0, 60.0, 34.0, -20.0, 49.0, 30.0, -20.0, 300.0, 28.0, -6.0, 80.0, 79.0, 90.0, 60.0, 59.0, 79.0, 600.0, 10.0, -4.0, 270.0, 12.0, 46.0, 23.0, -12.0, 27.0, 8.0, 144.0, 80.0, 11.0, -13.0, 17.0, 65.0, 40.0, 40.0, 170.0, -13.0, 130.0, 130.0, 39.0, 100.0, 55.0, 42.0, 50.0, 310.0, 160.0, 88.0, 25.0, 48.0, 60.0, 46.0, 280.0, 49.0, -5.0, 24.0, 45.0, 19.0, 290.0, 19.0, 120.0, 80.0, 170.0, 90.0, 50.0, 100.0, 70.0, 70.0, 30.0, 170.0, -20.0, 50.0, 4.0, 4.0, 300.0, 333.0, -54.0, -7.0, 158.0, 110.0, 30.0, 50.0, 110.0, 150.0, 50.0, 46.0, -3.0, 94.0, 40.0, 60.0, 60.0, 61.0, 30.0, 178.0, 7.0, 100.0, -3.0, 50.0, 170.0, 1.0, 33.0, 33.0, 158.0, 44.0, 32.0, 171.0, 29.0, 20.0, 39.0, 32.0, 270.0, -37.0, 340.0, 136.0, 110.0, 140.0, 42.0, -14.0, 1.0, 46.0, 30.0, 80.0, 180.0, 260.0, 110.0, 59.0, 110.0, 48.0, 70.0, 80.0, 70.0, 160.0, 148.0, 30.0, 160.0, 65.0, 22.0, 210.0, 10.0, 170.0, 80.0, 50.0, 138.0, -5.0, 26.0, 310.0, 40.0, 90.0, 15.0, 90.0, 90.0, 107.0, 10.0, 70.0, 40.0, 60.0, 50.0, 60.0, 80.0, 50.0, -17.0, 9.0, 30.0, 105.0, -8.0, 40.0, 25.0, 30.0, 42.0, 0.0, -26.0, 90.0, 10.0, 270.0, 160.0, 10.0, -84.0, -1.0, 52.0, 20.0, -8.0, -10.0, 30.0, 37.0, 120.0, 6.0, 40.0, 70.0, 21.0, 20.0, 160.0, 0.0, 28.0, 110.0, 77.0, 140.0, 30.0, 150.0, 60.0, 220.0, 50.0, 100.0, 110.0, 78.0, 48.0, 60.0, 147.0, 70.0, 110.0, 58.0, 98.0, 63.0, 30.0, -26.0, 198.0, 15.0, 13.0, 23.0, 50.0, 30.0, 50.0, 100.0, 110.0, 30.0, 20.0, 20.0, 50.0, 170.0, 60.0, 100.0, 34.0, 44.0, -7.0, 14.0, 10.0, 18.0, 90.0, 4.0, 100.0, 190.0, 47.0, -6.0, 16.0, 40.0, 50.0, 130.0, -33.0, 110.0, 260.0, 57.0, 68.0, 200.0, 40.0, 28.0, 50.0, 60.0, 40.0, 0.0, 22.0, 40.0, 100.0, 0.0, -57.0, 50.0, -112.0, 70.0, 240.0, 60.0, 20.0, 70.0, 291.0, 48.0, 29.0, 70.0, 60.0, 69.0, 260.0, 20.0, 40.0, 50.0, 70.0, 30.0, 80.0, 140.0, 40.0, 70.0, 90.0, 50.0, 70.0, 70.0, 98.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.026420579420636, "mean_inference_ms": 2.331388628344762, "mean_action_processing_ms": 0.7839205068937538, "mean_env_wait_ms": 1.6244983401161712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08655834197998047, "StateBufferConnector_ms": 0.011112451553344727, "ViewRequirementAgentConnector_ms": 0.5280258655548096}, "num_episodes": 18, "episode_return_max": 1509.0, "episode_return_min": 147.0, "episode_return_mean": 721.72, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.53234370818437, "num_env_steps_trained_throughput_per_sec": 32.53234370818437, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 122820.823, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122820.767, "sample_time_ms": 2993.481, "learn_time_ms": 119803.326, "learn_throughput": 33.388, "synch_weights_time_ms": 13.201}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 78, "trial_id": "6085c_00000", "date": "2024-07-02_01-36-45", "timestamp": 1719898605, "time_this_iter_s": 122.96994400024414, "time_total_s": 11452.269932031631, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b912f5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11452.269932031631, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 28.42931034482759, "ram_util_percent": 79.41091954022987}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9445086715828244, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.190602162648568, "policy_loss": -0.007283858282313533, "vf_loss": 7.1968293059494295, "vf_explained_var": 0.00014508580501341084, "kl": 0.010567124177376538, "entropy": 0.8463339243960964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 737115.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 147.0, "episode_reward_mean": 717.23, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -237.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 71.723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [438.0, 1049.0, 699.0, 593.0, 502.0, 590.0, 484.0, 473.0, 1240.0, 854.0, 586.0, 652.0, 661.0, 952.0, 147.0, 853.0, 1103.0, 684.0, 601.0, 573.0, 1098.0, 629.0, 733.0, 638.0, 346.0, 790.0, 601.0, 597.0, 454.0, 582.0, 612.0, 665.0, 726.0, 761.0, 693.0, 886.0, 861.0, 1509.0, 710.0, 760.0, 639.0, 755.0, 476.0, 545.0, 557.0, 539.0, 625.0, 863.0, 1257.0, 741.0, 1178.0, 550.0, 982.0, 615.0, 1323.0, 326.0, 718.0, 884.0, 921.0, 780.0, 928.0, 668.0, 599.0, 758.0, 911.0, 1147.0, 945.0, 901.0, 412.0, 328.0, 419.0, 504.0, 965.0, 842.0, 483.0, 638.0, 460.0, 898.0, 380.0, 680.0, 698.0, 766.0, 1530.0, 556.0, 492.0, 446.0, 675.0, 774.0, 625.0, 901.0, 341.0, 296.0, 885.0, 670.0, 510.0, 717.0, 669.0, 690.0, 843.0, 1114.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [17.0, 10.0, 50.0, 27.0, 80.0, 18.0, 68.0, 18.0, 30.0, 120.0, 109.0, 59.0, 34.0, 310.0, 110.0, 40.0, 68.0, 170.0, 80.0, 69.0, 0.0, 60.0, 40.0, 170.0, 110.0, 40.0, 60.0, 39.0, 50.0, 130.0, 270.0, 29.0, 10.0, 2.0, 20.0, 60.0, 5.0, -8.0, 179.0, 26.0, 27.0, -12.0, 90.0, 18.0, 82.0, 60.0, 70.0, 70.0, 37.0, 60.0, 40.0, 50.0, 80.0, 60.0, 50.0, 50.0, 80.0, 60.0, 60.0, 60.0, 0.0, -43.0, 0.0, 150.0, 24.0, 70.0, 58.0, 15.0, 120.0, 90.0, 49.0, 110.0, 29.0, 50.0, 40.0, 40.0, 58.0, 47.0, 40.0, 10.0, 450.0, 100.0, 90.0, 160.0, 30.0, -20.0, 170.0, 60.0, 130.0, 70.0, 200.0, 60.0, 290.0, 19.0, 90.0, 4.0, 23.0, 60.0, 80.0, 28.0, 50.0, 120.0, 40.0, 40.0, 60.0, 28.0, 130.0, 80.0, 30.0, 8.0, 68.0, 40.0, 70.0, 0.0, 98.0, 46.0, 80.0, 150.0, 30.0, 70.0, -1.0, 70.0, -2.0, 50.0, 50.0, -10.0, 23.0, 90.0, 320.0, 71.0, 59.0, 70.0, 99.0, 37.0, 100.0, 16.0, 472.0, 33.0, 70.0, -4.0, 90.0, 9.0, -210.0, 137.0, -237.0, 140.0, 210.0, 40.0, -8.0, -24.0, -10.0, 100.0, 29.0, 109.0, 80.0, -102.0, 70.0, 267.0, 160.0, 150.0, 36.0, 70.0, 60.0, 80.0, -30.0, 550.0, 110.0, 37.0, 120.0, 70.0, 70.0, 90.0, 100.0, 57.0, 80.0, 50.0, 50.0, 60.0, 80.0, 47.0, 66.0, 20.0, 23.0, 55.0, 90.0, 25.0, 130.0, -53.0, 50.0, 195.0, 90.0, 50.0, 39.0, 20.0, 60.0, 90.0, 23.0, 41.0, 70.0, 90.0, 70.0, 90.0, 240.0, 80.0, 18.0, 180.0, 30.0, -40.0, 120.0, 310.0, 70.0, 60.0, 70.0, 50.0, 90.0, 40.0, 70.0, 30.0, 99.0, 50.0, 80.0, 50.0, 60.0, 35.0, 70.0, 80.0, 80.0, 38.0, 80.0, 160.0, 44.0, 170.0, 100.0, 50.0, 170.0, 70.0, -69.0, 10.0, 70.0, 23.0, 14.0, 31.0, 37.0, 30.0, 0.0, 50.0, 50.0, 60.0, 24.0, 50.0, 67.0, 80.0, 60.0, 70.0, 40.0, 35.0, 52.0, 140.0, 156.0, 90.0, 63.0, 8.0, 50.0, 8.0, 15.0, -9.0, 78.0, 50.0, 168.0, 170.0, 160.0, 21.0, 40.0, 30.0, 68.0, 39.0, 39.0, 29.0, 146.0, 25.0, 32.0, 90.0, 44.0, 50.0, 45.0, -4.0, 50.0, 7.0, 100.0, 40.0, 70.0, -13.0, 180.0, 190.0, 48.0, 25.0, 6.0, 40.0, 36.0, 0.0, 70.0, 30.0, 159.0, 1.0, 45.0, 150.0, 70.0, 50.0, 19.0, 18.0, 28.0, 70.0, 80.0, -50.0, 160.0, 160.0, 50.0, 60.0, 67.0, 40.0, 68.0, 120.0, 120.0, 29.0, 68.0, 50.0, 40.0, 120.0, 74.0, 37.0, 160.0, 70.0, 19.0, 20.0, 40.0, 70.0, 170.0, 148.0, 16.0, 48.0, 40.0, 110.0, 20.0, 60.0, 154.0, 47.0, 60.0, 84.0, 70.0, 48.0, 120.0, -25.0, 21.0, 80.0, 330.0, 62.0, 170.0, 37.0, 68.0, 23.0, 120.0, 37.0, 73.0, 69.0, 47.0, 110.0, 96.0, 100.0, 89.0, 120.0, 17.0, 530.0, 100.0, 130.0, 55.0, 110.0, 50.0, 280.0, 187.0, 50.0, 70.0, 80.0, 170.0, 29.0, -34.0, 180.0, 16.0, 77.0, 110.0, 12.0, 80.0, 40.0, 90.0, 80.0, 100.0, 70.0, 50.0, 70.0, 90.0, 90.0, 190.0, 60.0, 39.0, 39.0, 50.0, 10.0, 29.0, 38.0, 69.0, 115.0, 108.0, 50.0, 30.0, 20.0, 70.0, 29.0, 4.0, 220.0, 210.0, 14.0, 99.0, 60.0, 50.0, -12.0, 40.0, -8.0, 69.0, 70.0, 59.0, 49.0, 96.0, 60.0, 80.0, 50.0, 90.0, 39.0, 47.0, 27.0, 40.0, 16.0, 130.0, 39.0, 19.0, 40.0, 80.0, 80.0, 39.0, 70.0, 40.0, 20.0, 60.0, 17.0, 50.0, 30.0, 30.0, 4.0, 50.0, 160.0, 100.0, 38.0, 10.0, -70.0, 53.0, 100.0, 46.0, 49.0, 160.0, 36.0, 29.0, 212.0, 320.0, 90.0, 21.0, 60.0, 50.0, -27.0, 29.0, 160.0, 90.0, 70.0, 99.0, 49.0, 120.0, 90.0, 40.0, 60.0, 200.0, 540.0, 30.0, 29.0, 90.0, 110.0, 49.0, 90.0, 70.0, 61.0, 50.0, 81.0, 100.0, 40.0, 120.0, 50.0, 90.0, 86.0, 0.0, 270.0, 148.0, 397.0, -43.0, 60.0, 40.0, 20.0, 70.0, 40.0, 50.0, 50.0, 90.0, 80.0, 70.0, 40.0, 52.0, 170.0, 110.0, 40.0, 110.0, 250.0, 149.0, -14.0, 30.0, 85.0, 160.0, 60.0, 34.0, -20.0, 49.0, 30.0, -20.0, 300.0, 28.0, -6.0, 80.0, 79.0, 90.0, 60.0, 59.0, 79.0, 600.0, 10.0, -4.0, 270.0, 12.0, 46.0, 23.0, -12.0, 27.0, 8.0, 144.0, 80.0, 11.0, -13.0, 17.0, 65.0, 40.0, 40.0, 170.0, -13.0, 130.0, 130.0, 39.0, 100.0, 55.0, 42.0, 50.0, 310.0, 160.0, 88.0, 25.0, 48.0, 60.0, 46.0, 280.0, 49.0, -5.0, 24.0, 45.0, 19.0, 290.0, 19.0, 120.0, 80.0, 170.0, 90.0, 50.0, 100.0, 70.0, 70.0, 30.0, 170.0, -20.0, 50.0, 4.0, 4.0, 300.0, 333.0, -54.0, -7.0, 158.0, 110.0, 30.0, 50.0, 110.0, 150.0, 50.0, 46.0, -3.0, 94.0, 40.0, 60.0, 60.0, 61.0, 30.0, 178.0, 7.0, 100.0, -3.0, 50.0, 170.0, 1.0, 33.0, 33.0, 158.0, 44.0, 32.0, 171.0, 29.0, 20.0, 39.0, 32.0, 270.0, -37.0, 340.0, 136.0, 110.0, 140.0, 42.0, -14.0, 1.0, 46.0, 30.0, 80.0, 180.0, 260.0, 110.0, 59.0, 110.0, 48.0, 70.0, 80.0, 70.0, 160.0, 148.0, 30.0, 160.0, 65.0, 22.0, 210.0, 10.0, 170.0, 80.0, 50.0, 138.0, -5.0, 26.0, 310.0, 40.0, 90.0, 15.0, 90.0, 90.0, 107.0, 10.0, 70.0, 40.0, 60.0, 50.0, 60.0, 80.0, 50.0, -17.0, 9.0, 30.0, 105.0, -8.0, 40.0, 25.0, 30.0, 42.0, 0.0, -26.0, 90.0, 10.0, 270.0, 160.0, 10.0, -84.0, -1.0, 52.0, 20.0, -8.0, -10.0, 30.0, 37.0, 120.0, 6.0, 40.0, 70.0, 21.0, 20.0, 160.0, 0.0, 28.0, 110.0, 77.0, 140.0, 30.0, 150.0, 60.0, 220.0, 50.0, 100.0, 110.0, 78.0, 48.0, 60.0, 147.0, 70.0, 110.0, 58.0, 98.0, 63.0, 30.0, -26.0, 198.0, 15.0, 13.0, 23.0, 50.0, 30.0, 50.0, 100.0, 110.0, 30.0, 20.0, 20.0, 50.0, 170.0, 60.0, 100.0, 34.0, 44.0, -7.0, 14.0, 10.0, 18.0, 90.0, 4.0, 100.0, 190.0, 47.0, -6.0, 16.0, 40.0, 50.0, 130.0, -33.0, 110.0, 260.0, 57.0, 68.0, 200.0, 40.0, 28.0, 50.0, 60.0, 40.0, 0.0, 22.0, 40.0, 100.0, 0.0, -57.0, 50.0, -112.0, 70.0, 240.0, 60.0, 20.0, 70.0, 291.0, 48.0, 29.0, 70.0, 60.0, 69.0, 260.0, 20.0, 40.0, 50.0, 70.0, 30.0, 80.0, 140.0, 40.0, 70.0, 90.0, 50.0, 70.0, 70.0, 98.0, 58.0, 10.0, 180.0, 130.0, 90.0, -50.0, 310.0, 70.0, 60.0, 530.0, 200.0, 30.0, -25.0, -1.0, 38.0, 10.0, 278.0, 176.0, 120.0, 20.0, -90.0, 35.0, 100.0, 46.0, 80.0, 58.0, 53.0, -10.0, 60.0, 20.0, 50.0, 8.0, 66.0, 0.0, 8.0, 80.0, 60.0, 28.0, 13.0, 150.0, 33.0, 50.0, 50.0, 179.0, 160.0, 7.0, 20.0, 49.0, 90.0, -2.0, 72.0, 419.0, 36.0, 43.0, 37.0, 2.0, 58.0, 60.0, 40.0, 44.0, 35.0, 23.0, 24.0, 110.0, 48.0, 18.0, 150.0, -1.0, 100.0, 90.0, 63.0, 171.0, 4.0, 65.0, -3.0, 80.0, 90.0, 380.0, 42.0, 3.0, 69.0, 50.0, 77.0, 0.0, 30.0, 60.0, 4.0, 60.0, -19.0, 9.0, 70.0, 30.0, 40.0, 3.0, 87.0, -65.0, 49.0, 70.0, 8.0, 59.0, 15.0, 5.0, 30.0, 60.0, 402.0, 90.0, 50.0, 90.0, 20.0, 68.0, 70.0, 30.0, -40.0, 60.0, 50.0, 170.0, 20.0, 50.0, 50.0, 120.0, 160.0, 40.0, 40.0, 40.0, 50.0, 50.0, 40.0, 30.0, 110.0, 70.0, 40.0, 60.0, 100.0, 106.0, 60.0, 69.0, 80.0, 66.0, 66.0, 60.0, 50.0, 70.0, 0.0, 60.0, 60.0, 62.0, 71.0, 130.0, 64.0, 89.0, 63.0, 38.0, 46.0, 69.0, 30.0, 80.0, -140.0, 159.0, 22.0, 180.0, 206.0, 23.0, 320.0, -70.0, 130.0, 60.0, 60.0, 100.0, 70.0, 90.0, 60.0, 155.0, 63.0, 230.0, 170.0, 68.0, 10.0, 70.0, 90.0, 178.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0247661369983416, "mean_inference_ms": 2.3277486467748516, "mean_action_processing_ms": 0.782599891314447, "mean_env_wait_ms": 1.6222635249112054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08827757835388184, "StateBufferConnector_ms": 0.011182546615600586, "ViewRequirementAgentConnector_ms": 0.5305159091949463}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": 147.0, "episode_return_mean": 717.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.473260887260416, "num_env_steps_trained_throughput_per_sec": 32.473260887260416, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 3160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3160000, "timers": {"training_iteration_time_ms": 122823.556, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122823.5, "sample_time_ms": 3015.779, "learn_time_ms": 119784.238, "learn_throughput": 33.393, "synch_weights_time_ms": 12.945}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "done": false, "training_iteration": 79, "trial_id": "6085c_00000", "date": "2024-07-02_01-38-49", "timestamp": 1719898729, "time_this_iter_s": 123.19088530540466, "time_total_s": 11575.460817337036, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b238ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11575.460817337036, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 28.570689655172416, "ram_util_percent": 79.27011494252874}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.079642047560888, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.099502252999205, "policy_loss": -0.0059590182383916675, "vf_loss": 7.104442454044557, "vf_explained_var": 0.0014857171759945643, "kl": 0.010188187603480557, "entropy": 0.8231843115168765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 746505.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 296.0, "episode_reward_mean": 716.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 71.68}, "custom_metrics": {}, "hist_stats": {"episode_reward": [733.0, 638.0, 346.0, 790.0, 601.0, 597.0, 454.0, 582.0, 612.0, 665.0, 726.0, 761.0, 693.0, 886.0, 861.0, 1509.0, 710.0, 760.0, 639.0, 755.0, 476.0, 545.0, 557.0, 539.0, 625.0, 863.0, 1257.0, 741.0, 1178.0, 550.0, 982.0, 615.0, 1323.0, 326.0, 718.0, 884.0, 921.0, 780.0, 928.0, 668.0, 599.0, 758.0, 911.0, 1147.0, 945.0, 901.0, 412.0, 328.0, 419.0, 504.0, 965.0, 842.0, 483.0, 638.0, 460.0, 898.0, 380.0, 680.0, 698.0, 766.0, 1530.0, 556.0, 492.0, 446.0, 675.0, 774.0, 625.0, 901.0, 341.0, 296.0, 885.0, 670.0, 510.0, 717.0, 669.0, 690.0, 843.0, 1114.0, 786.0, 622.0, 447.0, 724.0, 1033.0, 738.0, 563.0, 385.0, 801.0, 882.0, 391.0, 507.0, 683.0, 553.0, 428.0, 754.0, 1284.0, 797.0, 764.0, 839.0, 362.0, 1075.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 50.0, 60.0, 35.0, 70.0, 80.0, 80.0, 38.0, 80.0, 160.0, 44.0, 170.0, 100.0, 50.0, 170.0, 70.0, -69.0, 10.0, 70.0, 23.0, 14.0, 31.0, 37.0, 30.0, 0.0, 50.0, 50.0, 60.0, 24.0, 50.0, 67.0, 80.0, 60.0, 70.0, 40.0, 35.0, 52.0, 140.0, 156.0, 90.0, 63.0, 8.0, 50.0, 8.0, 15.0, -9.0, 78.0, 50.0, 168.0, 170.0, 160.0, 21.0, 40.0, 30.0, 68.0, 39.0, 39.0, 29.0, 146.0, 25.0, 32.0, 90.0, 44.0, 50.0, 45.0, -4.0, 50.0, 7.0, 100.0, 40.0, 70.0, -13.0, 180.0, 190.0, 48.0, 25.0, 6.0, 40.0, 36.0, 0.0, 70.0, 30.0, 159.0, 1.0, 45.0, 150.0, 70.0, 50.0, 19.0, 18.0, 28.0, 70.0, 80.0, -50.0, 160.0, 160.0, 50.0, 60.0, 67.0, 40.0, 68.0, 120.0, 120.0, 29.0, 68.0, 50.0, 40.0, 120.0, 74.0, 37.0, 160.0, 70.0, 19.0, 20.0, 40.0, 70.0, 170.0, 148.0, 16.0, 48.0, 40.0, 110.0, 20.0, 60.0, 154.0, 47.0, 60.0, 84.0, 70.0, 48.0, 120.0, -25.0, 21.0, 80.0, 330.0, 62.0, 170.0, 37.0, 68.0, 23.0, 120.0, 37.0, 73.0, 69.0, 47.0, 110.0, 96.0, 100.0, 89.0, 120.0, 17.0, 530.0, 100.0, 130.0, 55.0, 110.0, 50.0, 280.0, 187.0, 50.0, 70.0, 80.0, 170.0, 29.0, -34.0, 180.0, 16.0, 77.0, 110.0, 12.0, 80.0, 40.0, 90.0, 80.0, 100.0, 70.0, 50.0, 70.0, 90.0, 90.0, 190.0, 60.0, 39.0, 39.0, 50.0, 10.0, 29.0, 38.0, 69.0, 115.0, 108.0, 50.0, 30.0, 20.0, 70.0, 29.0, 4.0, 220.0, 210.0, 14.0, 99.0, 60.0, 50.0, -12.0, 40.0, -8.0, 69.0, 70.0, 59.0, 49.0, 96.0, 60.0, 80.0, 50.0, 90.0, 39.0, 47.0, 27.0, 40.0, 16.0, 130.0, 39.0, 19.0, 40.0, 80.0, 80.0, 39.0, 70.0, 40.0, 20.0, 60.0, 17.0, 50.0, 30.0, 30.0, 4.0, 50.0, 160.0, 100.0, 38.0, 10.0, -70.0, 53.0, 100.0, 46.0, 49.0, 160.0, 36.0, 29.0, 212.0, 320.0, 90.0, 21.0, 60.0, 50.0, -27.0, 29.0, 160.0, 90.0, 70.0, 99.0, 49.0, 120.0, 90.0, 40.0, 60.0, 200.0, 540.0, 30.0, 29.0, 90.0, 110.0, 49.0, 90.0, 70.0, 61.0, 50.0, 81.0, 100.0, 40.0, 120.0, 50.0, 90.0, 86.0, 0.0, 270.0, 148.0, 397.0, -43.0, 60.0, 40.0, 20.0, 70.0, 40.0, 50.0, 50.0, 90.0, 80.0, 70.0, 40.0, 52.0, 170.0, 110.0, 40.0, 110.0, 250.0, 149.0, -14.0, 30.0, 85.0, 160.0, 60.0, 34.0, -20.0, 49.0, 30.0, -20.0, 300.0, 28.0, -6.0, 80.0, 79.0, 90.0, 60.0, 59.0, 79.0, 600.0, 10.0, -4.0, 270.0, 12.0, 46.0, 23.0, -12.0, 27.0, 8.0, 144.0, 80.0, 11.0, -13.0, 17.0, 65.0, 40.0, 40.0, 170.0, -13.0, 130.0, 130.0, 39.0, 100.0, 55.0, 42.0, 50.0, 310.0, 160.0, 88.0, 25.0, 48.0, 60.0, 46.0, 280.0, 49.0, -5.0, 24.0, 45.0, 19.0, 290.0, 19.0, 120.0, 80.0, 170.0, 90.0, 50.0, 100.0, 70.0, 70.0, 30.0, 170.0, -20.0, 50.0, 4.0, 4.0, 300.0, 333.0, -54.0, -7.0, 158.0, 110.0, 30.0, 50.0, 110.0, 150.0, 50.0, 46.0, -3.0, 94.0, 40.0, 60.0, 60.0, 61.0, 30.0, 178.0, 7.0, 100.0, -3.0, 50.0, 170.0, 1.0, 33.0, 33.0, 158.0, 44.0, 32.0, 171.0, 29.0, 20.0, 39.0, 32.0, 270.0, -37.0, 340.0, 136.0, 110.0, 140.0, 42.0, -14.0, 1.0, 46.0, 30.0, 80.0, 180.0, 260.0, 110.0, 59.0, 110.0, 48.0, 70.0, 80.0, 70.0, 160.0, 148.0, 30.0, 160.0, 65.0, 22.0, 210.0, 10.0, 170.0, 80.0, 50.0, 138.0, -5.0, 26.0, 310.0, 40.0, 90.0, 15.0, 90.0, 90.0, 107.0, 10.0, 70.0, 40.0, 60.0, 50.0, 60.0, 80.0, 50.0, -17.0, 9.0, 30.0, 105.0, -8.0, 40.0, 25.0, 30.0, 42.0, 0.0, -26.0, 90.0, 10.0, 270.0, 160.0, 10.0, -84.0, -1.0, 52.0, 20.0, -8.0, -10.0, 30.0, 37.0, 120.0, 6.0, 40.0, 70.0, 21.0, 20.0, 160.0, 0.0, 28.0, 110.0, 77.0, 140.0, 30.0, 150.0, 60.0, 220.0, 50.0, 100.0, 110.0, 78.0, 48.0, 60.0, 147.0, 70.0, 110.0, 58.0, 98.0, 63.0, 30.0, -26.0, 198.0, 15.0, 13.0, 23.0, 50.0, 30.0, 50.0, 100.0, 110.0, 30.0, 20.0, 20.0, 50.0, 170.0, 60.0, 100.0, 34.0, 44.0, -7.0, 14.0, 10.0, 18.0, 90.0, 4.0, 100.0, 190.0, 47.0, -6.0, 16.0, 40.0, 50.0, 130.0, -33.0, 110.0, 260.0, 57.0, 68.0, 200.0, 40.0, 28.0, 50.0, 60.0, 40.0, 0.0, 22.0, 40.0, 100.0, 0.0, -57.0, 50.0, -112.0, 70.0, 240.0, 60.0, 20.0, 70.0, 291.0, 48.0, 29.0, 70.0, 60.0, 69.0, 260.0, 20.0, 40.0, 50.0, 70.0, 30.0, 80.0, 140.0, 40.0, 70.0, 90.0, 50.0, 70.0, 70.0, 98.0, 58.0, 10.0, 180.0, 130.0, 90.0, -50.0, 310.0, 70.0, 60.0, 530.0, 200.0, 30.0, -25.0, -1.0, 38.0, 10.0, 278.0, 176.0, 120.0, 20.0, -90.0, 35.0, 100.0, 46.0, 80.0, 58.0, 53.0, -10.0, 60.0, 20.0, 50.0, 8.0, 66.0, 0.0, 8.0, 80.0, 60.0, 28.0, 13.0, 150.0, 33.0, 50.0, 50.0, 179.0, 160.0, 7.0, 20.0, 49.0, 90.0, -2.0, 72.0, 419.0, 36.0, 43.0, 37.0, 2.0, 58.0, 60.0, 40.0, 44.0, 35.0, 23.0, 24.0, 110.0, 48.0, 18.0, 150.0, -1.0, 100.0, 90.0, 63.0, 171.0, 4.0, 65.0, -3.0, 80.0, 90.0, 380.0, 42.0, 3.0, 69.0, 50.0, 77.0, 0.0, 30.0, 60.0, 4.0, 60.0, -19.0, 9.0, 70.0, 30.0, 40.0, 3.0, 87.0, -65.0, 49.0, 70.0, 8.0, 59.0, 15.0, 5.0, 30.0, 60.0, 402.0, 90.0, 50.0, 90.0, 20.0, 68.0, 70.0, 30.0, -40.0, 60.0, 50.0, 170.0, 20.0, 50.0, 50.0, 120.0, 160.0, 40.0, 40.0, 40.0, 50.0, 50.0, 40.0, 30.0, 110.0, 70.0, 40.0, 60.0, 100.0, 106.0, 60.0, 69.0, 80.0, 66.0, 66.0, 60.0, 50.0, 70.0, 0.0, 60.0, 60.0, 62.0, 71.0, 130.0, 64.0, 89.0, 63.0, 38.0, 46.0, 69.0, 30.0, 80.0, -140.0, 159.0, 22.0, 180.0, 206.0, 23.0, 320.0, -70.0, 130.0, 60.0, 60.0, 100.0, 70.0, 90.0, 60.0, 155.0, 63.0, 230.0, 170.0, 68.0, 10.0, 70.0, 90.0, 178.0, 80.0, 68.0, 70.0, 70.0, 93.0, 56.0, 50.0, 110.0, 120.0, 44.0, 105.0, 89.0, 49.0, 19.0, 105.0, 28.0, 70.0, 190.0, 2.0, 40.0, 30.0, 50.0, 43.0, 49.0, 4.0, 0.0, 18.0, 7.0, 40.0, 20.0, 216.0, 5.0, 160.0, 80.0, 28.0, 70.0, 80.0, 150.0, 8.0, 80.0, 63.0, 40.0, 90.0, 50.0, 180.0, 75.0, 204.0, 100.0, 3.0, 21.0, 270.0, 0.0, 64.0, 70.0, 80.0, 154.0, 80.0, 50.0, 70.0, 110.0, 60.0, 30.0, 25.0, 50.0, 37.0, 100.0, 51.0, 80.0, 70.0, 60.0, 60.0, 19.0, 20.0, 39.0, 20.0, 50.0, 30.0, 100.0, 27.0, 60.0, 20.0, 56.0, 50.0, 16.0, 19.0, 268.0, -14.0, 10.0, 360.0, -20.0, 56.0, 150.0, 169.0, 130.0, 57.0, 26.0, 50.0, 70.0, 70.0, 80.0, 80.0, -4.0, -110.0, -33.0, 260.0, 100.0, 60.0, 59.0, 8.0, 21.0, 30.0, 47.0, 40.0, 80.0, 65.0, 80.0, -15.0, 90.0, 30.0, 20.0, 70.0, 39.0, -19.0, 190.0, 109.0, 10.0, 39.0, 160.0, 38.0, 130.0, -13.0, 50.0, 39.0, 110.0, 29.0, 17.0, 34.0, 38.0, 9.0, 37.0, 190.0, 50.0, 76.0, 12.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 20.0, 50.0, 180.0, 100.0, 59.0, 3.0, 33.0, 64.0, 38.0, 37.0, 190.0, 80.0, 88.0, 57.0, 80.0, 80.0, 590.0, 140.0, 40.0, 59.0, 70.0, 40.0, 55.0, 350.0, -13.0, 60.0, 10.0, 80.0, 77.0, 39.0, 99.0, 120.0, 110.0, 68.0, 170.0, 100.0, 30.0, 80.0, 5.0, 75.0, 6.0, 44.0, 170.0, 120.0, 80.0, 90.0, 165.0, 20.0, 50.0, 50.0, 50.0, 44.0, 40.0, 16.0, 63.0, 39.0, 20.0, 18.0, 38.0, 80.0, 4.0, 75.0, 90.0, 70.0, 70.0, 40.0, -10.0, 100.0, 100.0, 140.0, 400.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0208688719426906, "mean_inference_ms": 2.3228136525797205, "mean_action_processing_ms": 0.7809592276411712, "mean_env_wait_ms": 1.6191702737575033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07080817222595215, "StateBufferConnector_ms": 0.010896921157836914, "ViewRequirementAgentConnector_ms": 0.48953890800476074}, "num_episodes": 22, "episode_return_max": 1530.0, "episode_return_min": 296.0, "episode_return_mean": 716.8, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.229587121578575, "num_env_steps_trained_throughput_per_sec": 32.229587121578575, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 123028.754, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123028.699, "sample_time_ms": 3066.57, "learn_time_ms": 119938.458, "learn_throughput": 33.35, "synch_weights_time_ms": 13.03}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": false, "training_iteration": 80, "trial_id": "6085c_00000", "date": "2024-07-02_01-40-53", "timestamp": 1719898853, "time_this_iter_s": 124.12247800827026, "time_total_s": 11699.583295345306, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b912f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11699.583295345306, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 28.802857142857142, "ram_util_percent": 80.50457142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1132712753055194, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.765710906200389, "policy_loss": -0.006491155297142335, "vf_loss": 6.771164353282307, "vf_explained_var": 0.0016512280962845515, "kl": 0.010377078080610511, "entropy": 0.8324136986773109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 755895.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 88.0, "episode_reward_mean": 681.69, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 68.169}, "custom_metrics": {}, "hist_stats": {"episode_reward": [639.0, 755.0, 476.0, 545.0, 557.0, 539.0, 625.0, 863.0, 1257.0, 741.0, 1178.0, 550.0, 982.0, 615.0, 1323.0, 326.0, 718.0, 884.0, 921.0, 780.0, 928.0, 668.0, 599.0, 758.0, 911.0, 1147.0, 945.0, 901.0, 412.0, 328.0, 419.0, 504.0, 965.0, 842.0, 483.0, 638.0, 460.0, 898.0, 380.0, 680.0, 698.0, 766.0, 1530.0, 556.0, 492.0, 446.0, 675.0, 774.0, 625.0, 901.0, 341.0, 296.0, 885.0, 670.0, 510.0, 717.0, 669.0, 690.0, 843.0, 1114.0, 786.0, 622.0, 447.0, 724.0, 1033.0, 738.0, 563.0, 385.0, 801.0, 882.0, 391.0, 507.0, 683.0, 553.0, 428.0, 754.0, 1284.0, 797.0, 764.0, 839.0, 362.0, 1075.0, 473.0, 525.0, 349.0, 595.0, 593.0, 522.0, 589.0, 678.0, 490.0, 775.0, 485.0, 88.0, 470.0, 562.0, 599.0, 616.0, 489.0, 515.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 60.0, 39.0, 39.0, 50.0, 10.0, 29.0, 38.0, 69.0, 115.0, 108.0, 50.0, 30.0, 20.0, 70.0, 29.0, 4.0, 220.0, 210.0, 14.0, 99.0, 60.0, 50.0, -12.0, 40.0, -8.0, 69.0, 70.0, 59.0, 49.0, 96.0, 60.0, 80.0, 50.0, 90.0, 39.0, 47.0, 27.0, 40.0, 16.0, 130.0, 39.0, 19.0, 40.0, 80.0, 80.0, 39.0, 70.0, 40.0, 20.0, 60.0, 17.0, 50.0, 30.0, 30.0, 4.0, 50.0, 160.0, 100.0, 38.0, 10.0, -70.0, 53.0, 100.0, 46.0, 49.0, 160.0, 36.0, 29.0, 212.0, 320.0, 90.0, 21.0, 60.0, 50.0, -27.0, 29.0, 160.0, 90.0, 70.0, 99.0, 49.0, 120.0, 90.0, 40.0, 60.0, 200.0, 540.0, 30.0, 29.0, 90.0, 110.0, 49.0, 90.0, 70.0, 61.0, 50.0, 81.0, 100.0, 40.0, 120.0, 50.0, 90.0, 86.0, 0.0, 270.0, 148.0, 397.0, -43.0, 60.0, 40.0, 20.0, 70.0, 40.0, 50.0, 50.0, 90.0, 80.0, 70.0, 40.0, 52.0, 170.0, 110.0, 40.0, 110.0, 250.0, 149.0, -14.0, 30.0, 85.0, 160.0, 60.0, 34.0, -20.0, 49.0, 30.0, -20.0, 300.0, 28.0, -6.0, 80.0, 79.0, 90.0, 60.0, 59.0, 79.0, 600.0, 10.0, -4.0, 270.0, 12.0, 46.0, 23.0, -12.0, 27.0, 8.0, 144.0, 80.0, 11.0, -13.0, 17.0, 65.0, 40.0, 40.0, 170.0, -13.0, 130.0, 130.0, 39.0, 100.0, 55.0, 42.0, 50.0, 310.0, 160.0, 88.0, 25.0, 48.0, 60.0, 46.0, 280.0, 49.0, -5.0, 24.0, 45.0, 19.0, 290.0, 19.0, 120.0, 80.0, 170.0, 90.0, 50.0, 100.0, 70.0, 70.0, 30.0, 170.0, -20.0, 50.0, 4.0, 4.0, 300.0, 333.0, -54.0, -7.0, 158.0, 110.0, 30.0, 50.0, 110.0, 150.0, 50.0, 46.0, -3.0, 94.0, 40.0, 60.0, 60.0, 61.0, 30.0, 178.0, 7.0, 100.0, -3.0, 50.0, 170.0, 1.0, 33.0, 33.0, 158.0, 44.0, 32.0, 171.0, 29.0, 20.0, 39.0, 32.0, 270.0, -37.0, 340.0, 136.0, 110.0, 140.0, 42.0, -14.0, 1.0, 46.0, 30.0, 80.0, 180.0, 260.0, 110.0, 59.0, 110.0, 48.0, 70.0, 80.0, 70.0, 160.0, 148.0, 30.0, 160.0, 65.0, 22.0, 210.0, 10.0, 170.0, 80.0, 50.0, 138.0, -5.0, 26.0, 310.0, 40.0, 90.0, 15.0, 90.0, 90.0, 107.0, 10.0, 70.0, 40.0, 60.0, 50.0, 60.0, 80.0, 50.0, -17.0, 9.0, 30.0, 105.0, -8.0, 40.0, 25.0, 30.0, 42.0, 0.0, -26.0, 90.0, 10.0, 270.0, 160.0, 10.0, -84.0, -1.0, 52.0, 20.0, -8.0, -10.0, 30.0, 37.0, 120.0, 6.0, 40.0, 70.0, 21.0, 20.0, 160.0, 0.0, 28.0, 110.0, 77.0, 140.0, 30.0, 150.0, 60.0, 220.0, 50.0, 100.0, 110.0, 78.0, 48.0, 60.0, 147.0, 70.0, 110.0, 58.0, 98.0, 63.0, 30.0, -26.0, 198.0, 15.0, 13.0, 23.0, 50.0, 30.0, 50.0, 100.0, 110.0, 30.0, 20.0, 20.0, 50.0, 170.0, 60.0, 100.0, 34.0, 44.0, -7.0, 14.0, 10.0, 18.0, 90.0, 4.0, 100.0, 190.0, 47.0, -6.0, 16.0, 40.0, 50.0, 130.0, -33.0, 110.0, 260.0, 57.0, 68.0, 200.0, 40.0, 28.0, 50.0, 60.0, 40.0, 0.0, 22.0, 40.0, 100.0, 0.0, -57.0, 50.0, -112.0, 70.0, 240.0, 60.0, 20.0, 70.0, 291.0, 48.0, 29.0, 70.0, 60.0, 69.0, 260.0, 20.0, 40.0, 50.0, 70.0, 30.0, 80.0, 140.0, 40.0, 70.0, 90.0, 50.0, 70.0, 70.0, 98.0, 58.0, 10.0, 180.0, 130.0, 90.0, -50.0, 310.0, 70.0, 60.0, 530.0, 200.0, 30.0, -25.0, -1.0, 38.0, 10.0, 278.0, 176.0, 120.0, 20.0, -90.0, 35.0, 100.0, 46.0, 80.0, 58.0, 53.0, -10.0, 60.0, 20.0, 50.0, 8.0, 66.0, 0.0, 8.0, 80.0, 60.0, 28.0, 13.0, 150.0, 33.0, 50.0, 50.0, 179.0, 160.0, 7.0, 20.0, 49.0, 90.0, -2.0, 72.0, 419.0, 36.0, 43.0, 37.0, 2.0, 58.0, 60.0, 40.0, 44.0, 35.0, 23.0, 24.0, 110.0, 48.0, 18.0, 150.0, -1.0, 100.0, 90.0, 63.0, 171.0, 4.0, 65.0, -3.0, 80.0, 90.0, 380.0, 42.0, 3.0, 69.0, 50.0, 77.0, 0.0, 30.0, 60.0, 4.0, 60.0, -19.0, 9.0, 70.0, 30.0, 40.0, 3.0, 87.0, -65.0, 49.0, 70.0, 8.0, 59.0, 15.0, 5.0, 30.0, 60.0, 402.0, 90.0, 50.0, 90.0, 20.0, 68.0, 70.0, 30.0, -40.0, 60.0, 50.0, 170.0, 20.0, 50.0, 50.0, 120.0, 160.0, 40.0, 40.0, 40.0, 50.0, 50.0, 40.0, 30.0, 110.0, 70.0, 40.0, 60.0, 100.0, 106.0, 60.0, 69.0, 80.0, 66.0, 66.0, 60.0, 50.0, 70.0, 0.0, 60.0, 60.0, 62.0, 71.0, 130.0, 64.0, 89.0, 63.0, 38.0, 46.0, 69.0, 30.0, 80.0, -140.0, 159.0, 22.0, 180.0, 206.0, 23.0, 320.0, -70.0, 130.0, 60.0, 60.0, 100.0, 70.0, 90.0, 60.0, 155.0, 63.0, 230.0, 170.0, 68.0, 10.0, 70.0, 90.0, 178.0, 80.0, 68.0, 70.0, 70.0, 93.0, 56.0, 50.0, 110.0, 120.0, 44.0, 105.0, 89.0, 49.0, 19.0, 105.0, 28.0, 70.0, 190.0, 2.0, 40.0, 30.0, 50.0, 43.0, 49.0, 4.0, 0.0, 18.0, 7.0, 40.0, 20.0, 216.0, 5.0, 160.0, 80.0, 28.0, 70.0, 80.0, 150.0, 8.0, 80.0, 63.0, 40.0, 90.0, 50.0, 180.0, 75.0, 204.0, 100.0, 3.0, 21.0, 270.0, 0.0, 64.0, 70.0, 80.0, 154.0, 80.0, 50.0, 70.0, 110.0, 60.0, 30.0, 25.0, 50.0, 37.0, 100.0, 51.0, 80.0, 70.0, 60.0, 60.0, 19.0, 20.0, 39.0, 20.0, 50.0, 30.0, 100.0, 27.0, 60.0, 20.0, 56.0, 50.0, 16.0, 19.0, 268.0, -14.0, 10.0, 360.0, -20.0, 56.0, 150.0, 169.0, 130.0, 57.0, 26.0, 50.0, 70.0, 70.0, 80.0, 80.0, -4.0, -110.0, -33.0, 260.0, 100.0, 60.0, 59.0, 8.0, 21.0, 30.0, 47.0, 40.0, 80.0, 65.0, 80.0, -15.0, 90.0, 30.0, 20.0, 70.0, 39.0, -19.0, 190.0, 109.0, 10.0, 39.0, 160.0, 38.0, 130.0, -13.0, 50.0, 39.0, 110.0, 29.0, 17.0, 34.0, 38.0, 9.0, 37.0, 190.0, 50.0, 76.0, 12.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 20.0, 50.0, 180.0, 100.0, 59.0, 3.0, 33.0, 64.0, 38.0, 37.0, 190.0, 80.0, 88.0, 57.0, 80.0, 80.0, 590.0, 140.0, 40.0, 59.0, 70.0, 40.0, 55.0, 350.0, -13.0, 60.0, 10.0, 80.0, 77.0, 39.0, 99.0, 120.0, 110.0, 68.0, 170.0, 100.0, 30.0, 80.0, 5.0, 75.0, 6.0, 44.0, 170.0, 120.0, 80.0, 90.0, 165.0, 20.0, 50.0, 50.0, 50.0, 44.0, 40.0, 16.0, 63.0, 39.0, 20.0, 18.0, 38.0, 80.0, 4.0, 75.0, 90.0, 70.0, 70.0, 40.0, -10.0, 100.0, 100.0, 140.0, 400.0, 36.0, 81.0, 110.0, 100.0, 30.0, 10.0, -83.0, 80.0, 69.0, 40.0, -20.0, 27.0, 48.0, 20.0, 60.0, 60.0, 160.0, 50.0, 50.0, 70.0, 50.0, 40.0, 20.0, 50.0, 70.0, 40.0, 60.0, 30.0, 73.0, -84.0, -34.0, 80.0, 370.0, 43.0, -11.0, 70.0, 19.0, 18.0, 3.0, 37.0, 30.0, 30.0, 131.0, 52.0, 80.0, 10.0, 40.0, 30.0, 70.0, 120.0, 80.0, 49.0, 35.0, 100.0, 50.0, -10.0, 197.0, 7.0, -34.0, 48.0, -39.0, 60.0, -3.0, 50.0, 10.0, 406.0, -48.0, 13.0, 60.0, 80.0, -1.0, 40.0, 62.0, 70.0, 190.0, 90.0, 50.0, 90.0, 47.0, 40.0, 54.0, 50.0, 70.0, 165.0, 25.0, -80.0, 80.0, 16.0, 40.0, 70.0, 110.0, 80.0, 85.0, 28.0, 20.0, 3.0, 366.0, -20.0, -7.0, 110.0, 50.0, 70.0, 50.0, 80.0, 33.0, -21.0, 40.0, -31.0, 210.0, 4.0, -32.0, 15.0, -16.0, 13.0, 10.0, -8.0, 40.0, 0.0, 46.0, 20.0, 10.0, -8.0, -30.0, 10.0, 40.0, 20.0, 160.0, 158.0, 40.0, 70.0, 60.0, 50.0, 50.0, 98.0, 90.0, 14.0, -20.0, 90.0, 90.0, 40.0, 50.0, 90.0, 82.0, 60.0, 60.0, 40.0, 30.0, 20.0, 9.0, 158.0, 80.0, 30.0, 50.0, 30.0, 70.0, 100.0, 59.0, 90.0, 40.0, 67.0, 68.0, 49.0, 40.0, 28.0, 24.0, 20.0, 100.0, 60.0, 50.0, 50.0, -12.0, 46.0, 110.0, 100.0, 1.0, 77.0, 86.0, 30.0, 70.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0175988538858127, "mean_inference_ms": 2.3185992110392757, "mean_action_processing_ms": 0.7795098388205177, "mean_env_wait_ms": 1.6165859769257989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07010769844055176, "StateBufferConnector_ms": 0.010722637176513672, "ViewRequirementAgentConnector_ms": 0.48842954635620117}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": 88.0, "episode_return_mean": 681.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.517118932129, "num_env_steps_trained_throughput_per_sec": 32.517118932129, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 3240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3240000, "timers": {"training_iteration_time_ms": 123025.929, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123025.877, "sample_time_ms": 3104.203, "learn_time_ms": 119898.579, "learn_throughput": 33.362, "synch_weights_time_ms": 12.834}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "done": false, "training_iteration": 81, "trial_id": "6085c_00000", "date": "2024-07-02_01-42-56", "timestamp": 1719898976, "time_this_iter_s": 123.02457523345947, "time_total_s": 11822.607870578766, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a54820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11822.607870578766, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 29.15919540229885, "ram_util_percent": 79.96264367816092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.036695620401726, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.764211926952846, "policy_loss": -0.0060173693987569665, "vf_loss": 6.769388639279448, "vf_explained_var": 0.0022555451296642818, "kl": 0.008406589521641023, "entropy": 0.8234275390736211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 765285.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 88.0, "episode_reward_mean": 663.69, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -163.0}, "policy_reward_max": {"policy_0": 590.0}, "policy_reward_mean": {"policy_0": 66.369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [758.0, 911.0, 1147.0, 945.0, 901.0, 412.0, 328.0, 419.0, 504.0, 965.0, 842.0, 483.0, 638.0, 460.0, 898.0, 380.0, 680.0, 698.0, 766.0, 1530.0, 556.0, 492.0, 446.0, 675.0, 774.0, 625.0, 901.0, 341.0, 296.0, 885.0, 670.0, 510.0, 717.0, 669.0, 690.0, 843.0, 1114.0, 786.0, 622.0, 447.0, 724.0, 1033.0, 738.0, 563.0, 385.0, 801.0, 882.0, 391.0, 507.0, 683.0, 553.0, 428.0, 754.0, 1284.0, 797.0, 764.0, 839.0, 362.0, 1075.0, 473.0, 525.0, 349.0, 595.0, 593.0, 522.0, 589.0, 678.0, 490.0, 775.0, 485.0, 88.0, 470.0, 562.0, 599.0, 616.0, 489.0, 515.0, 711.0, 443.0, 874.0, 947.0, 813.0, 300.0, 587.0, 791.0, 605.0, 562.0, 510.0, 1229.0, 731.0, 570.0, 553.0, 585.0, 665.0, 568.0, 554.0, 487.0, 527.0, 1160.0, 897.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [158.0, 44.0, 32.0, 171.0, 29.0, 20.0, 39.0, 32.0, 270.0, -37.0, 340.0, 136.0, 110.0, 140.0, 42.0, -14.0, 1.0, 46.0, 30.0, 80.0, 180.0, 260.0, 110.0, 59.0, 110.0, 48.0, 70.0, 80.0, 70.0, 160.0, 148.0, 30.0, 160.0, 65.0, 22.0, 210.0, 10.0, 170.0, 80.0, 50.0, 138.0, -5.0, 26.0, 310.0, 40.0, 90.0, 15.0, 90.0, 90.0, 107.0, 10.0, 70.0, 40.0, 60.0, 50.0, 60.0, 80.0, 50.0, -17.0, 9.0, 30.0, 105.0, -8.0, 40.0, 25.0, 30.0, 42.0, 0.0, -26.0, 90.0, 10.0, 270.0, 160.0, 10.0, -84.0, -1.0, 52.0, 20.0, -8.0, -10.0, 30.0, 37.0, 120.0, 6.0, 40.0, 70.0, 21.0, 20.0, 160.0, 0.0, 28.0, 110.0, 77.0, 140.0, 30.0, 150.0, 60.0, 220.0, 50.0, 100.0, 110.0, 78.0, 48.0, 60.0, 147.0, 70.0, 110.0, 58.0, 98.0, 63.0, 30.0, -26.0, 198.0, 15.0, 13.0, 23.0, 50.0, 30.0, 50.0, 100.0, 110.0, 30.0, 20.0, 20.0, 50.0, 170.0, 60.0, 100.0, 34.0, 44.0, -7.0, 14.0, 10.0, 18.0, 90.0, 4.0, 100.0, 190.0, 47.0, -6.0, 16.0, 40.0, 50.0, 130.0, -33.0, 110.0, 260.0, 57.0, 68.0, 200.0, 40.0, 28.0, 50.0, 60.0, 40.0, 0.0, 22.0, 40.0, 100.0, 0.0, -57.0, 50.0, -112.0, 70.0, 240.0, 60.0, 20.0, 70.0, 291.0, 48.0, 29.0, 70.0, 60.0, 69.0, 260.0, 20.0, 40.0, 50.0, 70.0, 30.0, 80.0, 140.0, 40.0, 70.0, 90.0, 50.0, 70.0, 70.0, 98.0, 58.0, 10.0, 180.0, 130.0, 90.0, -50.0, 310.0, 70.0, 60.0, 530.0, 200.0, 30.0, -25.0, -1.0, 38.0, 10.0, 278.0, 176.0, 120.0, 20.0, -90.0, 35.0, 100.0, 46.0, 80.0, 58.0, 53.0, -10.0, 60.0, 20.0, 50.0, 8.0, 66.0, 0.0, 8.0, 80.0, 60.0, 28.0, 13.0, 150.0, 33.0, 50.0, 50.0, 179.0, 160.0, 7.0, 20.0, 49.0, 90.0, -2.0, 72.0, 419.0, 36.0, 43.0, 37.0, 2.0, 58.0, 60.0, 40.0, 44.0, 35.0, 23.0, 24.0, 110.0, 48.0, 18.0, 150.0, -1.0, 100.0, 90.0, 63.0, 171.0, 4.0, 65.0, -3.0, 80.0, 90.0, 380.0, 42.0, 3.0, 69.0, 50.0, 77.0, 0.0, 30.0, 60.0, 4.0, 60.0, -19.0, 9.0, 70.0, 30.0, 40.0, 3.0, 87.0, -65.0, 49.0, 70.0, 8.0, 59.0, 15.0, 5.0, 30.0, 60.0, 402.0, 90.0, 50.0, 90.0, 20.0, 68.0, 70.0, 30.0, -40.0, 60.0, 50.0, 170.0, 20.0, 50.0, 50.0, 120.0, 160.0, 40.0, 40.0, 40.0, 50.0, 50.0, 40.0, 30.0, 110.0, 70.0, 40.0, 60.0, 100.0, 106.0, 60.0, 69.0, 80.0, 66.0, 66.0, 60.0, 50.0, 70.0, 0.0, 60.0, 60.0, 62.0, 71.0, 130.0, 64.0, 89.0, 63.0, 38.0, 46.0, 69.0, 30.0, 80.0, -140.0, 159.0, 22.0, 180.0, 206.0, 23.0, 320.0, -70.0, 130.0, 60.0, 60.0, 100.0, 70.0, 90.0, 60.0, 155.0, 63.0, 230.0, 170.0, 68.0, 10.0, 70.0, 90.0, 178.0, 80.0, 68.0, 70.0, 70.0, 93.0, 56.0, 50.0, 110.0, 120.0, 44.0, 105.0, 89.0, 49.0, 19.0, 105.0, 28.0, 70.0, 190.0, 2.0, 40.0, 30.0, 50.0, 43.0, 49.0, 4.0, 0.0, 18.0, 7.0, 40.0, 20.0, 216.0, 5.0, 160.0, 80.0, 28.0, 70.0, 80.0, 150.0, 8.0, 80.0, 63.0, 40.0, 90.0, 50.0, 180.0, 75.0, 204.0, 100.0, 3.0, 21.0, 270.0, 0.0, 64.0, 70.0, 80.0, 154.0, 80.0, 50.0, 70.0, 110.0, 60.0, 30.0, 25.0, 50.0, 37.0, 100.0, 51.0, 80.0, 70.0, 60.0, 60.0, 19.0, 20.0, 39.0, 20.0, 50.0, 30.0, 100.0, 27.0, 60.0, 20.0, 56.0, 50.0, 16.0, 19.0, 268.0, -14.0, 10.0, 360.0, -20.0, 56.0, 150.0, 169.0, 130.0, 57.0, 26.0, 50.0, 70.0, 70.0, 80.0, 80.0, -4.0, -110.0, -33.0, 260.0, 100.0, 60.0, 59.0, 8.0, 21.0, 30.0, 47.0, 40.0, 80.0, 65.0, 80.0, -15.0, 90.0, 30.0, 20.0, 70.0, 39.0, -19.0, 190.0, 109.0, 10.0, 39.0, 160.0, 38.0, 130.0, -13.0, 50.0, 39.0, 110.0, 29.0, 17.0, 34.0, 38.0, 9.0, 37.0, 190.0, 50.0, 76.0, 12.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 20.0, 50.0, 180.0, 100.0, 59.0, 3.0, 33.0, 64.0, 38.0, 37.0, 190.0, 80.0, 88.0, 57.0, 80.0, 80.0, 590.0, 140.0, 40.0, 59.0, 70.0, 40.0, 55.0, 350.0, -13.0, 60.0, 10.0, 80.0, 77.0, 39.0, 99.0, 120.0, 110.0, 68.0, 170.0, 100.0, 30.0, 80.0, 5.0, 75.0, 6.0, 44.0, 170.0, 120.0, 80.0, 90.0, 165.0, 20.0, 50.0, 50.0, 50.0, 44.0, 40.0, 16.0, 63.0, 39.0, 20.0, 18.0, 38.0, 80.0, 4.0, 75.0, 90.0, 70.0, 70.0, 40.0, -10.0, 100.0, 100.0, 140.0, 400.0, 36.0, 81.0, 110.0, 100.0, 30.0, 10.0, -83.0, 80.0, 69.0, 40.0, -20.0, 27.0, 48.0, 20.0, 60.0, 60.0, 160.0, 50.0, 50.0, 70.0, 50.0, 40.0, 20.0, 50.0, 70.0, 40.0, 60.0, 30.0, 73.0, -84.0, -34.0, 80.0, 370.0, 43.0, -11.0, 70.0, 19.0, 18.0, 3.0, 37.0, 30.0, 30.0, 131.0, 52.0, 80.0, 10.0, 40.0, 30.0, 70.0, 120.0, 80.0, 49.0, 35.0, 100.0, 50.0, -10.0, 197.0, 7.0, -34.0, 48.0, -39.0, 60.0, -3.0, 50.0, 10.0, 406.0, -48.0, 13.0, 60.0, 80.0, -1.0, 40.0, 62.0, 70.0, 190.0, 90.0, 50.0, 90.0, 47.0, 40.0, 54.0, 50.0, 70.0, 165.0, 25.0, -80.0, 80.0, 16.0, 40.0, 70.0, 110.0, 80.0, 85.0, 28.0, 20.0, 3.0, 366.0, -20.0, -7.0, 110.0, 50.0, 70.0, 50.0, 80.0, 33.0, -21.0, 40.0, -31.0, 210.0, 4.0, -32.0, 15.0, -16.0, 13.0, 10.0, -8.0, 40.0, 0.0, 46.0, 20.0, 10.0, -8.0, -30.0, 10.0, 40.0, 20.0, 160.0, 158.0, 40.0, 70.0, 60.0, 50.0, 50.0, 98.0, 90.0, 14.0, -20.0, 90.0, 90.0, 40.0, 50.0, 90.0, 82.0, 60.0, 60.0, 40.0, 30.0, 20.0, 9.0, 158.0, 80.0, 30.0, 50.0, 30.0, 70.0, 100.0, 59.0, 90.0, 40.0, 67.0, 68.0, 49.0, 40.0, 28.0, 24.0, 20.0, 100.0, 60.0, 50.0, 50.0, -12.0, 46.0, 110.0, 100.0, 1.0, 77.0, 86.0, 30.0, 70.0, 7.0, 60.0, 90.0, 25.0, 40.0, 40.0, 170.0, 56.0, 70.0, 110.0, 50.0, 40.0, 16.0, 40.0, 40.0, 49.0, -41.0, 200.0, 30.0, 29.0, 40.0, 280.0, 278.0, -20.0, -163.0, 190.0, 110.0, 50.0, 60.0, 49.0, 40.0, 80.0, 79.0, 60.0, 48.0, 110.0, 70.0, 370.0, 50.0, 60.0, 20.0, 40.0, 210.0, 64.0, 36.0, -5.0, 200.0, 38.0, 60.0, 80.0, 90.0, -6.0, -10.0, 0.0, 30.0, 70.0, -3.0, 30.0, 9.0, 130.0, 50.0, 26.0, 48.0, 57.0, 60.0, 30.0, 56.0, 60.0, 60.0, 30.0, 160.0, 40.0, -20.0, 360.0, 60.0, 100.0, 39.0, 0.0, 50.0, 100.0, 62.0, 50.0, 50.0, 40.0, 60.0, 20.0, 70.0, -12.0, 189.0, 58.0, 80.0, 60.0, 39.0, 60.0, 27.0, 39.0, 90.0, 47.0, 190.0, -10.0, 20.0, 60.0, 30.0, 27.0, 29.0, 160.0, 70.0, 50.0, 1.0, 43.0, 40.0, -57.0, 100.0, 110.0, 180.0, 90.0, 200.0, 158.0, 37.0, 62.0, 349.0, 249.0, 50.0, 50.0, 67.0, 60.0, 35.0, 30.0, 80.0, 60.0, 50.0, 28.0, 70.0, 90.0, 40.0, -18.0, 100.0, 20.0, 160.0, 90.0, -10.0, 68.0, 80.0, 50.0, 170.0, 24.0, 47.0, 19.0, 0.0, 89.0, 6.0, 30.0, 70.0, 100.0, 60.0, 94.0, 30.0, 13.0, 14.0, 154.0, 20.0, 60.0, 5.0, 190.0, 9.0, 56.0, 167.0, 103.0, -5.0, 30.0, 50.0, 29.0, 37.0, 63.0, 43.0, 41.0, 1.0, 80.0, 18.0, 46.0, 210.0, 31.0, 30.0, 65.0, 50.0, 78.0, 71.0, 30.0, 70.0, 89.0, 40.0, 120.0, 40.0, 20.0, 12.0, 50.0, 116.0, 10.0, 45.0, 44.0, 30.0, 4.0, 60.0, 30.0, 50.0, 53.0, 50.0, 100.0, 40.0, 90.0, 50.0, 300.0, 20.0, 90.0, 80.0, 90.0, 60.0, 20.0, 50.0, 80.0, 370.0, 4.0, 86.0, 27.0, 110.0, 60.0, 90.0, 160.0, 160.0, 63.0, 137.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.013166486999433, "mean_inference_ms": 2.3130132466660034, "mean_action_processing_ms": 0.777650259410283, "mean_env_wait_ms": 1.613115658630971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0724494457244873, "StateBufferConnector_ms": 0.01069784164428711, "ViewRequirementAgentConnector_ms": 0.48827409744262695}, "num_episodes": 23, "episode_return_max": 1530.0, "episode_return_min": 88.0, "episode_return_mean": 663.69, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.53543833894346, "num_env_steps_trained_throughput_per_sec": 32.53543833894346, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 3280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3280000, "timers": {"training_iteration_time_ms": 123069.795, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123069.746, "sample_time_ms": 3103.296, "learn_time_ms": 119943.272, "learn_throughput": 33.349, "synch_weights_time_ms": 12.696}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "done": false, "training_iteration": 82, "trial_id": "6085c_00000", "date": "2024-07-02_01-44-59", "timestamp": 1719899099, "time_this_iter_s": 122.95543909072876, "time_total_s": 11945.563309669495, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b912f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11945.563309669495, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 28.844252873563217, "ram_util_percent": 79.27011494252874}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8244071048225203, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.3741582727787724, "policy_loss": -0.006870946157262467, "vf_loss": 7.380184226244276, "vf_explained_var": 0.0013104509431333207, "kl": 0.008449930098551823, "entropy": 0.7781516046760181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 774675.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 88.0, "episode_reward_mean": 688.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -163.0}, "policy_reward_max": {"policy_0": 590.0}, "policy_reward_mean": {"policy_0": 68.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [766.0, 1530.0, 556.0, 492.0, 446.0, 675.0, 774.0, 625.0, 901.0, 341.0, 296.0, 885.0, 670.0, 510.0, 717.0, 669.0, 690.0, 843.0, 1114.0, 786.0, 622.0, 447.0, 724.0, 1033.0, 738.0, 563.0, 385.0, 801.0, 882.0, 391.0, 507.0, 683.0, 553.0, 428.0, 754.0, 1284.0, 797.0, 764.0, 839.0, 362.0, 1075.0, 473.0, 525.0, 349.0, 595.0, 593.0, 522.0, 589.0, 678.0, 490.0, 775.0, 485.0, 88.0, 470.0, 562.0, 599.0, 616.0, 489.0, 515.0, 711.0, 443.0, 874.0, 947.0, 813.0, 300.0, 587.0, 791.0, 605.0, 562.0, 510.0, 1229.0, 731.0, 570.0, 553.0, 585.0, 665.0, 568.0, 554.0, 487.0, 527.0, 1160.0, 897.0, 878.0, 843.0, 1089.0, 1187.0, 544.0, 958.0, 699.0, 1032.0, 666.0, 1033.0, 929.0, 639.0, 903.0, 868.0, 701.0, 775.0, 860.0, 261.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 140.0, 40.0, 70.0, 90.0, 50.0, 70.0, 70.0, 98.0, 58.0, 10.0, 180.0, 130.0, 90.0, -50.0, 310.0, 70.0, 60.0, 530.0, 200.0, 30.0, -25.0, -1.0, 38.0, 10.0, 278.0, 176.0, 120.0, 20.0, -90.0, 35.0, 100.0, 46.0, 80.0, 58.0, 53.0, -10.0, 60.0, 20.0, 50.0, 8.0, 66.0, 0.0, 8.0, 80.0, 60.0, 28.0, 13.0, 150.0, 33.0, 50.0, 50.0, 179.0, 160.0, 7.0, 20.0, 49.0, 90.0, -2.0, 72.0, 419.0, 36.0, 43.0, 37.0, 2.0, 58.0, 60.0, 40.0, 44.0, 35.0, 23.0, 24.0, 110.0, 48.0, 18.0, 150.0, -1.0, 100.0, 90.0, 63.0, 171.0, 4.0, 65.0, -3.0, 80.0, 90.0, 380.0, 42.0, 3.0, 69.0, 50.0, 77.0, 0.0, 30.0, 60.0, 4.0, 60.0, -19.0, 9.0, 70.0, 30.0, 40.0, 3.0, 87.0, -65.0, 49.0, 70.0, 8.0, 59.0, 15.0, 5.0, 30.0, 60.0, 402.0, 90.0, 50.0, 90.0, 20.0, 68.0, 70.0, 30.0, -40.0, 60.0, 50.0, 170.0, 20.0, 50.0, 50.0, 120.0, 160.0, 40.0, 40.0, 40.0, 50.0, 50.0, 40.0, 30.0, 110.0, 70.0, 40.0, 60.0, 100.0, 106.0, 60.0, 69.0, 80.0, 66.0, 66.0, 60.0, 50.0, 70.0, 0.0, 60.0, 60.0, 62.0, 71.0, 130.0, 64.0, 89.0, 63.0, 38.0, 46.0, 69.0, 30.0, 80.0, -140.0, 159.0, 22.0, 180.0, 206.0, 23.0, 320.0, -70.0, 130.0, 60.0, 60.0, 100.0, 70.0, 90.0, 60.0, 155.0, 63.0, 230.0, 170.0, 68.0, 10.0, 70.0, 90.0, 178.0, 80.0, 68.0, 70.0, 70.0, 93.0, 56.0, 50.0, 110.0, 120.0, 44.0, 105.0, 89.0, 49.0, 19.0, 105.0, 28.0, 70.0, 190.0, 2.0, 40.0, 30.0, 50.0, 43.0, 49.0, 4.0, 0.0, 18.0, 7.0, 40.0, 20.0, 216.0, 5.0, 160.0, 80.0, 28.0, 70.0, 80.0, 150.0, 8.0, 80.0, 63.0, 40.0, 90.0, 50.0, 180.0, 75.0, 204.0, 100.0, 3.0, 21.0, 270.0, 0.0, 64.0, 70.0, 80.0, 154.0, 80.0, 50.0, 70.0, 110.0, 60.0, 30.0, 25.0, 50.0, 37.0, 100.0, 51.0, 80.0, 70.0, 60.0, 60.0, 19.0, 20.0, 39.0, 20.0, 50.0, 30.0, 100.0, 27.0, 60.0, 20.0, 56.0, 50.0, 16.0, 19.0, 268.0, -14.0, 10.0, 360.0, -20.0, 56.0, 150.0, 169.0, 130.0, 57.0, 26.0, 50.0, 70.0, 70.0, 80.0, 80.0, -4.0, -110.0, -33.0, 260.0, 100.0, 60.0, 59.0, 8.0, 21.0, 30.0, 47.0, 40.0, 80.0, 65.0, 80.0, -15.0, 90.0, 30.0, 20.0, 70.0, 39.0, -19.0, 190.0, 109.0, 10.0, 39.0, 160.0, 38.0, 130.0, -13.0, 50.0, 39.0, 110.0, 29.0, 17.0, 34.0, 38.0, 9.0, 37.0, 190.0, 50.0, 76.0, 12.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 20.0, 50.0, 180.0, 100.0, 59.0, 3.0, 33.0, 64.0, 38.0, 37.0, 190.0, 80.0, 88.0, 57.0, 80.0, 80.0, 590.0, 140.0, 40.0, 59.0, 70.0, 40.0, 55.0, 350.0, -13.0, 60.0, 10.0, 80.0, 77.0, 39.0, 99.0, 120.0, 110.0, 68.0, 170.0, 100.0, 30.0, 80.0, 5.0, 75.0, 6.0, 44.0, 170.0, 120.0, 80.0, 90.0, 165.0, 20.0, 50.0, 50.0, 50.0, 44.0, 40.0, 16.0, 63.0, 39.0, 20.0, 18.0, 38.0, 80.0, 4.0, 75.0, 90.0, 70.0, 70.0, 40.0, -10.0, 100.0, 100.0, 140.0, 400.0, 36.0, 81.0, 110.0, 100.0, 30.0, 10.0, -83.0, 80.0, 69.0, 40.0, -20.0, 27.0, 48.0, 20.0, 60.0, 60.0, 160.0, 50.0, 50.0, 70.0, 50.0, 40.0, 20.0, 50.0, 70.0, 40.0, 60.0, 30.0, 73.0, -84.0, -34.0, 80.0, 370.0, 43.0, -11.0, 70.0, 19.0, 18.0, 3.0, 37.0, 30.0, 30.0, 131.0, 52.0, 80.0, 10.0, 40.0, 30.0, 70.0, 120.0, 80.0, 49.0, 35.0, 100.0, 50.0, -10.0, 197.0, 7.0, -34.0, 48.0, -39.0, 60.0, -3.0, 50.0, 10.0, 406.0, -48.0, 13.0, 60.0, 80.0, -1.0, 40.0, 62.0, 70.0, 190.0, 90.0, 50.0, 90.0, 47.0, 40.0, 54.0, 50.0, 70.0, 165.0, 25.0, -80.0, 80.0, 16.0, 40.0, 70.0, 110.0, 80.0, 85.0, 28.0, 20.0, 3.0, 366.0, -20.0, -7.0, 110.0, 50.0, 70.0, 50.0, 80.0, 33.0, -21.0, 40.0, -31.0, 210.0, 4.0, -32.0, 15.0, -16.0, 13.0, 10.0, -8.0, 40.0, 0.0, 46.0, 20.0, 10.0, -8.0, -30.0, 10.0, 40.0, 20.0, 160.0, 158.0, 40.0, 70.0, 60.0, 50.0, 50.0, 98.0, 90.0, 14.0, -20.0, 90.0, 90.0, 40.0, 50.0, 90.0, 82.0, 60.0, 60.0, 40.0, 30.0, 20.0, 9.0, 158.0, 80.0, 30.0, 50.0, 30.0, 70.0, 100.0, 59.0, 90.0, 40.0, 67.0, 68.0, 49.0, 40.0, 28.0, 24.0, 20.0, 100.0, 60.0, 50.0, 50.0, -12.0, 46.0, 110.0, 100.0, 1.0, 77.0, 86.0, 30.0, 70.0, 7.0, 60.0, 90.0, 25.0, 40.0, 40.0, 170.0, 56.0, 70.0, 110.0, 50.0, 40.0, 16.0, 40.0, 40.0, 49.0, -41.0, 200.0, 30.0, 29.0, 40.0, 280.0, 278.0, -20.0, -163.0, 190.0, 110.0, 50.0, 60.0, 49.0, 40.0, 80.0, 79.0, 60.0, 48.0, 110.0, 70.0, 370.0, 50.0, 60.0, 20.0, 40.0, 210.0, 64.0, 36.0, -5.0, 200.0, 38.0, 60.0, 80.0, 90.0, -6.0, -10.0, 0.0, 30.0, 70.0, -3.0, 30.0, 9.0, 130.0, 50.0, 26.0, 48.0, 57.0, 60.0, 30.0, 56.0, 60.0, 60.0, 30.0, 160.0, 40.0, -20.0, 360.0, 60.0, 100.0, 39.0, 0.0, 50.0, 100.0, 62.0, 50.0, 50.0, 40.0, 60.0, 20.0, 70.0, -12.0, 189.0, 58.0, 80.0, 60.0, 39.0, 60.0, 27.0, 39.0, 90.0, 47.0, 190.0, -10.0, 20.0, 60.0, 30.0, 27.0, 29.0, 160.0, 70.0, 50.0, 1.0, 43.0, 40.0, -57.0, 100.0, 110.0, 180.0, 90.0, 200.0, 158.0, 37.0, 62.0, 349.0, 249.0, 50.0, 50.0, 67.0, 60.0, 35.0, 30.0, 80.0, 60.0, 50.0, 28.0, 70.0, 90.0, 40.0, -18.0, 100.0, 20.0, 160.0, 90.0, -10.0, 68.0, 80.0, 50.0, 170.0, 24.0, 47.0, 19.0, 0.0, 89.0, 6.0, 30.0, 70.0, 100.0, 60.0, 94.0, 30.0, 13.0, 14.0, 154.0, 20.0, 60.0, 5.0, 190.0, 9.0, 56.0, 167.0, 103.0, -5.0, 30.0, 50.0, 29.0, 37.0, 63.0, 43.0, 41.0, 1.0, 80.0, 18.0, 46.0, 210.0, 31.0, 30.0, 65.0, 50.0, 78.0, 71.0, 30.0, 70.0, 89.0, 40.0, 120.0, 40.0, 20.0, 12.0, 50.0, 116.0, 10.0, 45.0, 44.0, 30.0, 4.0, 60.0, 30.0, 50.0, 53.0, 50.0, 100.0, 40.0, 90.0, 50.0, 300.0, 20.0, 90.0, 80.0, 90.0, 60.0, 20.0, 50.0, 80.0, 370.0, 4.0, 86.0, 27.0, 110.0, 60.0, 90.0, 160.0, 160.0, 63.0, 137.0, 39.0, 310.0, 90.0, 60.0, 30.0, 10.0, 69.0, 60.0, 120.0, 90.0, 20.0, 50.0, 81.0, 160.0, 116.0, 20.0, 40.0, 107.0, 159.0, 90.0, 50.0, 80.0, 57.0, 40.0, 76.0, 526.0, 60.0, -30.0, 160.0, 70.0, 60.0, 109.0, 320.0, 70.0, 200.0, 48.0, 80.0, 60.0, 160.0, 80.0, 7.0, 59.0, 70.0, 50.0, 60.0, 60.0, 45.0, 90.0, 37.0, 66.0, 69.0, 60.0, 120.0, 100.0, 210.0, 40.0, -1.0, 80.0, -20.0, 300.0, 90.0, 49.0, 100.0, 130.0, 90.0, 80.0, 0.0, 50.0, 80.0, 30.0, 58.0, 110.0, 188.0, 80.0, 55.0, 110.0, 60.0, 43.0, 188.0, 140.0, 60.0, 53.0, 110.0, 40.0, -10.0, 60.0, 8.0, 20.0, 55.0, 270.0, 30.0, 110.0, 65.0, 390.0, 60.0, 30.0, 170.0, 36.0, 60.0, 82.0, 343.0, 130.0, 35.0, 90.0, 50.0, -9.0, 40.0, 100.0, -10.0, 160.0, 40.0, 100.0, 156.0, 110.0, 59.0, 80.0, 70.0, 28.0, -30.0, 26.0, 48.0, 510.0, 70.0, 5.0, -20.0, 11.0, 100.0, 60.0, 54.0, 65.0, 280.0, 20.0, 195.0, 90.0, 17.0, 0.0, 49.0, 80.0, 50.0, 87.0, -1.0, 162.0, 70.0, 60.0, -50.0, 190.0, 30.0, 80.0, 70.0, 90.0, 70.0, 39.0, 80.0, 100.0, 150.0, 100.0, 76.0, 70.0, 40.0, 50.0, 200.0, 45.0, 158.0, 68.0, 141.0, 40.0, 58.0, 60.0, 70.0, 20.0, 19.0, -7.0, 28.0, 0.0, 100.0, 20.0, -11.0, 20.0, 59.0, 33.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0092473617301856, "mean_inference_ms": 2.308752285185594, "mean_action_processing_ms": 0.7762221252452629, "mean_env_wait_ms": 1.6102633883959339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0695943832397461, "StateBufferConnector_ms": 0.011025428771972656, "ViewRequirementAgentConnector_ms": 0.4866774082183838}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": 88.0, "episode_return_mean": 688.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.4606324899413, "num_env_steps_trained_throughput_per_sec": 32.4606324899413, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 3320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3320000, "timers": {"training_iteration_time_ms": 123156.968, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123156.918, "sample_time_ms": 3106.341, "learn_time_ms": 120027.193, "learn_throughput": 33.326, "synch_weights_time_ms": 12.74}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "done": false, "training_iteration": 83, "trial_id": "6085c_00000", "date": "2024-07-02_01-47-02", "timestamp": 1719899222, "time_this_iter_s": 123.23884391784668, "time_total_s": 12068.802153587341, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b3b670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12068.802153587341, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 29.548850574712645, "ram_util_percent": 79.77068965517242}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7445428310745696, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.840136143904778, "policy_loss": -0.006060849913768867, "vf_loss": 6.845293181290388, "vf_explained_var": 0.00047611770665429776, "kl": 0.00903809528529901, "entropy": 0.7785278621763467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 784065.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "env_runners": {"episode_reward_max": 1284.0, "episode_reward_min": 88.0, "episode_reward_mean": 697.57, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -163.0}, "policy_reward_max": {"policy_0": 605.0}, "policy_reward_mean": {"policy_0": 69.757}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1114.0, 786.0, 622.0, 447.0, 724.0, 1033.0, 738.0, 563.0, 385.0, 801.0, 882.0, 391.0, 507.0, 683.0, 553.0, 428.0, 754.0, 1284.0, 797.0, 764.0, 839.0, 362.0, 1075.0, 473.0, 525.0, 349.0, 595.0, 593.0, 522.0, 589.0, 678.0, 490.0, 775.0, 485.0, 88.0, 470.0, 562.0, 599.0, 616.0, 489.0, 515.0, 711.0, 443.0, 874.0, 947.0, 813.0, 300.0, 587.0, 791.0, 605.0, 562.0, 510.0, 1229.0, 731.0, 570.0, 553.0, 585.0, 665.0, 568.0, 554.0, 487.0, 527.0, 1160.0, 897.0, 878.0, 843.0, 1089.0, 1187.0, 544.0, 958.0, 699.0, 1032.0, 666.0, 1033.0, 929.0, 639.0, 903.0, 868.0, 701.0, 775.0, 860.0, 261.0, 1081.0, 470.0, 1259.0, 980.0, 687.0, 888.0, 732.0, 606.0, 415.0, 1102.0, 418.0, 718.0, 499.0, 754.0, 648.0, 701.0, 674.0, 646.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [155.0, 63.0, 230.0, 170.0, 68.0, 10.0, 70.0, 90.0, 178.0, 80.0, 68.0, 70.0, 70.0, 93.0, 56.0, 50.0, 110.0, 120.0, 44.0, 105.0, 89.0, 49.0, 19.0, 105.0, 28.0, 70.0, 190.0, 2.0, 40.0, 30.0, 50.0, 43.0, 49.0, 4.0, 0.0, 18.0, 7.0, 40.0, 20.0, 216.0, 5.0, 160.0, 80.0, 28.0, 70.0, 80.0, 150.0, 8.0, 80.0, 63.0, 40.0, 90.0, 50.0, 180.0, 75.0, 204.0, 100.0, 3.0, 21.0, 270.0, 0.0, 64.0, 70.0, 80.0, 154.0, 80.0, 50.0, 70.0, 110.0, 60.0, 30.0, 25.0, 50.0, 37.0, 100.0, 51.0, 80.0, 70.0, 60.0, 60.0, 19.0, 20.0, 39.0, 20.0, 50.0, 30.0, 100.0, 27.0, 60.0, 20.0, 56.0, 50.0, 16.0, 19.0, 268.0, -14.0, 10.0, 360.0, -20.0, 56.0, 150.0, 169.0, 130.0, 57.0, 26.0, 50.0, 70.0, 70.0, 80.0, 80.0, -4.0, -110.0, -33.0, 260.0, 100.0, 60.0, 59.0, 8.0, 21.0, 30.0, 47.0, 40.0, 80.0, 65.0, 80.0, -15.0, 90.0, 30.0, 20.0, 70.0, 39.0, -19.0, 190.0, 109.0, 10.0, 39.0, 160.0, 38.0, 130.0, -13.0, 50.0, 39.0, 110.0, 29.0, 17.0, 34.0, 38.0, 9.0, 37.0, 190.0, 50.0, 76.0, 12.0, 60.0, 60.0, 30.0, 30.0, 30.0, 60.0, 20.0, 50.0, 180.0, 100.0, 59.0, 3.0, 33.0, 64.0, 38.0, 37.0, 190.0, 80.0, 88.0, 57.0, 80.0, 80.0, 590.0, 140.0, 40.0, 59.0, 70.0, 40.0, 55.0, 350.0, -13.0, 60.0, 10.0, 80.0, 77.0, 39.0, 99.0, 120.0, 110.0, 68.0, 170.0, 100.0, 30.0, 80.0, 5.0, 75.0, 6.0, 44.0, 170.0, 120.0, 80.0, 90.0, 165.0, 20.0, 50.0, 50.0, 50.0, 44.0, 40.0, 16.0, 63.0, 39.0, 20.0, 18.0, 38.0, 80.0, 4.0, 75.0, 90.0, 70.0, 70.0, 40.0, -10.0, 100.0, 100.0, 140.0, 400.0, 36.0, 81.0, 110.0, 100.0, 30.0, 10.0, -83.0, 80.0, 69.0, 40.0, -20.0, 27.0, 48.0, 20.0, 60.0, 60.0, 160.0, 50.0, 50.0, 70.0, 50.0, 40.0, 20.0, 50.0, 70.0, 40.0, 60.0, 30.0, 73.0, -84.0, -34.0, 80.0, 370.0, 43.0, -11.0, 70.0, 19.0, 18.0, 3.0, 37.0, 30.0, 30.0, 131.0, 52.0, 80.0, 10.0, 40.0, 30.0, 70.0, 120.0, 80.0, 49.0, 35.0, 100.0, 50.0, -10.0, 197.0, 7.0, -34.0, 48.0, -39.0, 60.0, -3.0, 50.0, 10.0, 406.0, -48.0, 13.0, 60.0, 80.0, -1.0, 40.0, 62.0, 70.0, 190.0, 90.0, 50.0, 90.0, 47.0, 40.0, 54.0, 50.0, 70.0, 165.0, 25.0, -80.0, 80.0, 16.0, 40.0, 70.0, 110.0, 80.0, 85.0, 28.0, 20.0, 3.0, 366.0, -20.0, -7.0, 110.0, 50.0, 70.0, 50.0, 80.0, 33.0, -21.0, 40.0, -31.0, 210.0, 4.0, -32.0, 15.0, -16.0, 13.0, 10.0, -8.0, 40.0, 0.0, 46.0, 20.0, 10.0, -8.0, -30.0, 10.0, 40.0, 20.0, 160.0, 158.0, 40.0, 70.0, 60.0, 50.0, 50.0, 98.0, 90.0, 14.0, -20.0, 90.0, 90.0, 40.0, 50.0, 90.0, 82.0, 60.0, 60.0, 40.0, 30.0, 20.0, 9.0, 158.0, 80.0, 30.0, 50.0, 30.0, 70.0, 100.0, 59.0, 90.0, 40.0, 67.0, 68.0, 49.0, 40.0, 28.0, 24.0, 20.0, 100.0, 60.0, 50.0, 50.0, -12.0, 46.0, 110.0, 100.0, 1.0, 77.0, 86.0, 30.0, 70.0, 7.0, 60.0, 90.0, 25.0, 40.0, 40.0, 170.0, 56.0, 70.0, 110.0, 50.0, 40.0, 16.0, 40.0, 40.0, 49.0, -41.0, 200.0, 30.0, 29.0, 40.0, 280.0, 278.0, -20.0, -163.0, 190.0, 110.0, 50.0, 60.0, 49.0, 40.0, 80.0, 79.0, 60.0, 48.0, 110.0, 70.0, 370.0, 50.0, 60.0, 20.0, 40.0, 210.0, 64.0, 36.0, -5.0, 200.0, 38.0, 60.0, 80.0, 90.0, -6.0, -10.0, 0.0, 30.0, 70.0, -3.0, 30.0, 9.0, 130.0, 50.0, 26.0, 48.0, 57.0, 60.0, 30.0, 56.0, 60.0, 60.0, 30.0, 160.0, 40.0, -20.0, 360.0, 60.0, 100.0, 39.0, 0.0, 50.0, 100.0, 62.0, 50.0, 50.0, 40.0, 60.0, 20.0, 70.0, -12.0, 189.0, 58.0, 80.0, 60.0, 39.0, 60.0, 27.0, 39.0, 90.0, 47.0, 190.0, -10.0, 20.0, 60.0, 30.0, 27.0, 29.0, 160.0, 70.0, 50.0, 1.0, 43.0, 40.0, -57.0, 100.0, 110.0, 180.0, 90.0, 200.0, 158.0, 37.0, 62.0, 349.0, 249.0, 50.0, 50.0, 67.0, 60.0, 35.0, 30.0, 80.0, 60.0, 50.0, 28.0, 70.0, 90.0, 40.0, -18.0, 100.0, 20.0, 160.0, 90.0, -10.0, 68.0, 80.0, 50.0, 170.0, 24.0, 47.0, 19.0, 0.0, 89.0, 6.0, 30.0, 70.0, 100.0, 60.0, 94.0, 30.0, 13.0, 14.0, 154.0, 20.0, 60.0, 5.0, 190.0, 9.0, 56.0, 167.0, 103.0, -5.0, 30.0, 50.0, 29.0, 37.0, 63.0, 43.0, 41.0, 1.0, 80.0, 18.0, 46.0, 210.0, 31.0, 30.0, 65.0, 50.0, 78.0, 71.0, 30.0, 70.0, 89.0, 40.0, 120.0, 40.0, 20.0, 12.0, 50.0, 116.0, 10.0, 45.0, 44.0, 30.0, 4.0, 60.0, 30.0, 50.0, 53.0, 50.0, 100.0, 40.0, 90.0, 50.0, 300.0, 20.0, 90.0, 80.0, 90.0, 60.0, 20.0, 50.0, 80.0, 370.0, 4.0, 86.0, 27.0, 110.0, 60.0, 90.0, 160.0, 160.0, 63.0, 137.0, 39.0, 310.0, 90.0, 60.0, 30.0, 10.0, 69.0, 60.0, 120.0, 90.0, 20.0, 50.0, 81.0, 160.0, 116.0, 20.0, 40.0, 107.0, 159.0, 90.0, 50.0, 80.0, 57.0, 40.0, 76.0, 526.0, 60.0, -30.0, 160.0, 70.0, 60.0, 109.0, 320.0, 70.0, 200.0, 48.0, 80.0, 60.0, 160.0, 80.0, 7.0, 59.0, 70.0, 50.0, 60.0, 60.0, 45.0, 90.0, 37.0, 66.0, 69.0, 60.0, 120.0, 100.0, 210.0, 40.0, -1.0, 80.0, -20.0, 300.0, 90.0, 49.0, 100.0, 130.0, 90.0, 80.0, 0.0, 50.0, 80.0, 30.0, 58.0, 110.0, 188.0, 80.0, 55.0, 110.0, 60.0, 43.0, 188.0, 140.0, 60.0, 53.0, 110.0, 40.0, -10.0, 60.0, 8.0, 20.0, 55.0, 270.0, 30.0, 110.0, 65.0, 390.0, 60.0, 30.0, 170.0, 36.0, 60.0, 82.0, 343.0, 130.0, 35.0, 90.0, 50.0, -9.0, 40.0, 100.0, -10.0, 160.0, 40.0, 100.0, 156.0, 110.0, 59.0, 80.0, 70.0, 28.0, -30.0, 26.0, 48.0, 510.0, 70.0, 5.0, -20.0, 11.0, 100.0, 60.0, 54.0, 65.0, 280.0, 20.0, 195.0, 90.0, 17.0, 0.0, 49.0, 80.0, 50.0, 87.0, -1.0, 162.0, 70.0, 60.0, -50.0, 190.0, 30.0, 80.0, 70.0, 90.0, 70.0, 39.0, 80.0, 100.0, 150.0, 100.0, 76.0, 70.0, 40.0, 50.0, 200.0, 45.0, 158.0, 68.0, 141.0, 40.0, 58.0, 60.0, 70.0, 20.0, 19.0, -7.0, 28.0, 0.0, 100.0, 20.0, -11.0, 20.0, 59.0, 33.0, 190.0, 94.0, 300.0, 60.0, 70.0, 40.0, 110.0, 67.0, 70.0, 80.0, 60.0, 8.0, 12.0, 25.0, 158.0, 20.0, 70.0, 30.0, 29.0, 58.0, 500.0, 90.0, 230.0, 30.0, 160.0, 99.0, 100.0, -32.0, 19.0, 63.0, 180.0, 80.0, 50.0, 70.0, 60.0, 60.0, 200.0, 120.0, 110.0, 50.0, 120.0, 80.0, 53.0, 60.0, 33.0, 110.0, 80.0, 56.0, 48.0, 47.0, 69.0, 230.0, 80.0, 100.0, 106.0, 60.0, -43.0, 60.0, 49.0, 177.0, 67.0, 50.0, 70.0, 90.0, 80.0, 90.0, 57.0, 114.0, 24.0, 90.0, 179.0, 46.0, -1.0, -1.0, 180.0, 20.0, 75.0, 60.0, 50.0, -2.0, 57.0, 60.0, -11.0, 88.0, 2.0, 40.0, 39.0, 20.0, 60.0, 60.0, 170.0, -24.0, 605.0, 60.0, 100.0, -66.0, 40.0, 67.0, 80.0, 70.0, -50.0, 20.0, 50.0, 256.0, -7.0, 10.0, -37.0, 28.0, 120.0, 28.0, 70.0, 40.0, -2.0, 146.0, 89.0, 60.0, 70.0, 59.0, 68.0, 118.0, 50.0, 60.0, 152.0, 70.0, 42.0, -14.0, 29.0, 30.0, 70.0, 10.0, -22.0, 50.0, 310.0, 70.0, -39.0, 100.0, 45.0, 70.0, 100.0, 70.0, 19.0, 60.0, 30.0, 189.0, 40.0, 40.0, 100.0, 60.0, 70.0, 40.0, 160.0, 130.0, -25.0, 49.0, 51.0, 43.0, 61.0, 166.0, 29.0, 37.0, 70.0, 20.0, 40.0, 20.0, 156.0, 160.0, 32.0, -5.0, 21.0, 160.0, 17.0, 55.0, 48.0, 30.0, 49.0, 17.0, 279.0, 20.0, 39.0, 92.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0051944446604564, "mean_inference_ms": 2.304215375593684, "mean_action_processing_ms": 0.7746967871773358, "mean_env_wait_ms": 1.6071654009959855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06855034828186035, "StateBufferConnector_ms": 0.010925054550170898, "ViewRequirementAgentConnector_ms": 0.4898192882537842}, "num_episodes": 18, "episode_return_max": 1284.0, "episode_return_min": 88.0, "episode_return_mean": 697.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.28549939124422, "num_env_steps_trained_throughput_per_sec": 32.28549939124422, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 3360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3360000, "timers": {"training_iteration_time_ms": 123162.417, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123162.367, "sample_time_ms": 3141.109, "learn_time_ms": 119998.126, "learn_throughput": 33.334, "synch_weights_time_ms": 12.833}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "done": false, "training_iteration": 84, "trial_id": "6085c_00000", "date": "2024-07-02_01-49-06", "timestamp": 1719899346, "time_this_iter_s": 123.90668320655823, "time_total_s": 12192.7088367939, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12192.7088367939, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 29.643428571428572, "ram_util_percent": 79.88628571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7177658496636807, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.185593053708061, "policy_loss": -0.007598802567478488, "vf_loss": 7.192277792035835, "vf_explained_var": -0.0009450858901230038, "kl": 0.009140650691869161, "entropy": 0.7315497121554467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 793455.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "env_runners": {"episode_reward_max": 1326.0, "episode_reward_min": 88.0, "episode_reward_mean": 697.97, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -163.0}, "policy_reward_max": {"policy_0": 605.0}, "policy_reward_mean": {"policy_0": 69.797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1075.0, 473.0, 525.0, 349.0, 595.0, 593.0, 522.0, 589.0, 678.0, 490.0, 775.0, 485.0, 88.0, 470.0, 562.0, 599.0, 616.0, 489.0, 515.0, 711.0, 443.0, 874.0, 947.0, 813.0, 300.0, 587.0, 791.0, 605.0, 562.0, 510.0, 1229.0, 731.0, 570.0, 553.0, 585.0, 665.0, 568.0, 554.0, 487.0, 527.0, 1160.0, 897.0, 878.0, 843.0, 1089.0, 1187.0, 544.0, 958.0, 699.0, 1032.0, 666.0, 1033.0, 929.0, 639.0, 903.0, 868.0, 701.0, 775.0, 860.0, 261.0, 1081.0, 470.0, 1259.0, 980.0, 687.0, 888.0, 732.0, 606.0, 415.0, 1102.0, 418.0, 718.0, 499.0, 754.0, 648.0, 701.0, 674.0, 646.0, 384.0, 1023.0, 540.0, 1287.0, 259.0, 876.0, 865.0, 714.0, 565.0, 550.0, 689.0, 579.0, 1326.0, 606.0, 436.0, 648.0, 616.0, 839.0, 840.0, 632.0, 523.0, 700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [75.0, 90.0, 70.0, 70.0, 40.0, -10.0, 100.0, 100.0, 140.0, 400.0, 36.0, 81.0, 110.0, 100.0, 30.0, 10.0, -83.0, 80.0, 69.0, 40.0, -20.0, 27.0, 48.0, 20.0, 60.0, 60.0, 160.0, 50.0, 50.0, 70.0, 50.0, 40.0, 20.0, 50.0, 70.0, 40.0, 60.0, 30.0, 73.0, -84.0, -34.0, 80.0, 370.0, 43.0, -11.0, 70.0, 19.0, 18.0, 3.0, 37.0, 30.0, 30.0, 131.0, 52.0, 80.0, 10.0, 40.0, 30.0, 70.0, 120.0, 80.0, 49.0, 35.0, 100.0, 50.0, -10.0, 197.0, 7.0, -34.0, 48.0, -39.0, 60.0, -3.0, 50.0, 10.0, 406.0, -48.0, 13.0, 60.0, 80.0, -1.0, 40.0, 62.0, 70.0, 190.0, 90.0, 50.0, 90.0, 47.0, 40.0, 54.0, 50.0, 70.0, 165.0, 25.0, -80.0, 80.0, 16.0, 40.0, 70.0, 110.0, 80.0, 85.0, 28.0, 20.0, 3.0, 366.0, -20.0, -7.0, 110.0, 50.0, 70.0, 50.0, 80.0, 33.0, -21.0, 40.0, -31.0, 210.0, 4.0, -32.0, 15.0, -16.0, 13.0, 10.0, -8.0, 40.0, 0.0, 46.0, 20.0, 10.0, -8.0, -30.0, 10.0, 40.0, 20.0, 160.0, 158.0, 40.0, 70.0, 60.0, 50.0, 50.0, 98.0, 90.0, 14.0, -20.0, 90.0, 90.0, 40.0, 50.0, 90.0, 82.0, 60.0, 60.0, 40.0, 30.0, 20.0, 9.0, 158.0, 80.0, 30.0, 50.0, 30.0, 70.0, 100.0, 59.0, 90.0, 40.0, 67.0, 68.0, 49.0, 40.0, 28.0, 24.0, 20.0, 100.0, 60.0, 50.0, 50.0, -12.0, 46.0, 110.0, 100.0, 1.0, 77.0, 86.0, 30.0, 70.0, 7.0, 60.0, 90.0, 25.0, 40.0, 40.0, 170.0, 56.0, 70.0, 110.0, 50.0, 40.0, 16.0, 40.0, 40.0, 49.0, -41.0, 200.0, 30.0, 29.0, 40.0, 280.0, 278.0, -20.0, -163.0, 190.0, 110.0, 50.0, 60.0, 49.0, 40.0, 80.0, 79.0, 60.0, 48.0, 110.0, 70.0, 370.0, 50.0, 60.0, 20.0, 40.0, 210.0, 64.0, 36.0, -5.0, 200.0, 38.0, 60.0, 80.0, 90.0, -6.0, -10.0, 0.0, 30.0, 70.0, -3.0, 30.0, 9.0, 130.0, 50.0, 26.0, 48.0, 57.0, 60.0, 30.0, 56.0, 60.0, 60.0, 30.0, 160.0, 40.0, -20.0, 360.0, 60.0, 100.0, 39.0, 0.0, 50.0, 100.0, 62.0, 50.0, 50.0, 40.0, 60.0, 20.0, 70.0, -12.0, 189.0, 58.0, 80.0, 60.0, 39.0, 60.0, 27.0, 39.0, 90.0, 47.0, 190.0, -10.0, 20.0, 60.0, 30.0, 27.0, 29.0, 160.0, 70.0, 50.0, 1.0, 43.0, 40.0, -57.0, 100.0, 110.0, 180.0, 90.0, 200.0, 158.0, 37.0, 62.0, 349.0, 249.0, 50.0, 50.0, 67.0, 60.0, 35.0, 30.0, 80.0, 60.0, 50.0, 28.0, 70.0, 90.0, 40.0, -18.0, 100.0, 20.0, 160.0, 90.0, -10.0, 68.0, 80.0, 50.0, 170.0, 24.0, 47.0, 19.0, 0.0, 89.0, 6.0, 30.0, 70.0, 100.0, 60.0, 94.0, 30.0, 13.0, 14.0, 154.0, 20.0, 60.0, 5.0, 190.0, 9.0, 56.0, 167.0, 103.0, -5.0, 30.0, 50.0, 29.0, 37.0, 63.0, 43.0, 41.0, 1.0, 80.0, 18.0, 46.0, 210.0, 31.0, 30.0, 65.0, 50.0, 78.0, 71.0, 30.0, 70.0, 89.0, 40.0, 120.0, 40.0, 20.0, 12.0, 50.0, 116.0, 10.0, 45.0, 44.0, 30.0, 4.0, 60.0, 30.0, 50.0, 53.0, 50.0, 100.0, 40.0, 90.0, 50.0, 300.0, 20.0, 90.0, 80.0, 90.0, 60.0, 20.0, 50.0, 80.0, 370.0, 4.0, 86.0, 27.0, 110.0, 60.0, 90.0, 160.0, 160.0, 63.0, 137.0, 39.0, 310.0, 90.0, 60.0, 30.0, 10.0, 69.0, 60.0, 120.0, 90.0, 20.0, 50.0, 81.0, 160.0, 116.0, 20.0, 40.0, 107.0, 159.0, 90.0, 50.0, 80.0, 57.0, 40.0, 76.0, 526.0, 60.0, -30.0, 160.0, 70.0, 60.0, 109.0, 320.0, 70.0, 200.0, 48.0, 80.0, 60.0, 160.0, 80.0, 7.0, 59.0, 70.0, 50.0, 60.0, 60.0, 45.0, 90.0, 37.0, 66.0, 69.0, 60.0, 120.0, 100.0, 210.0, 40.0, -1.0, 80.0, -20.0, 300.0, 90.0, 49.0, 100.0, 130.0, 90.0, 80.0, 0.0, 50.0, 80.0, 30.0, 58.0, 110.0, 188.0, 80.0, 55.0, 110.0, 60.0, 43.0, 188.0, 140.0, 60.0, 53.0, 110.0, 40.0, -10.0, 60.0, 8.0, 20.0, 55.0, 270.0, 30.0, 110.0, 65.0, 390.0, 60.0, 30.0, 170.0, 36.0, 60.0, 82.0, 343.0, 130.0, 35.0, 90.0, 50.0, -9.0, 40.0, 100.0, -10.0, 160.0, 40.0, 100.0, 156.0, 110.0, 59.0, 80.0, 70.0, 28.0, -30.0, 26.0, 48.0, 510.0, 70.0, 5.0, -20.0, 11.0, 100.0, 60.0, 54.0, 65.0, 280.0, 20.0, 195.0, 90.0, 17.0, 0.0, 49.0, 80.0, 50.0, 87.0, -1.0, 162.0, 70.0, 60.0, -50.0, 190.0, 30.0, 80.0, 70.0, 90.0, 70.0, 39.0, 80.0, 100.0, 150.0, 100.0, 76.0, 70.0, 40.0, 50.0, 200.0, 45.0, 158.0, 68.0, 141.0, 40.0, 58.0, 60.0, 70.0, 20.0, 19.0, -7.0, 28.0, 0.0, 100.0, 20.0, -11.0, 20.0, 59.0, 33.0, 190.0, 94.0, 300.0, 60.0, 70.0, 40.0, 110.0, 67.0, 70.0, 80.0, 60.0, 8.0, 12.0, 25.0, 158.0, 20.0, 70.0, 30.0, 29.0, 58.0, 500.0, 90.0, 230.0, 30.0, 160.0, 99.0, 100.0, -32.0, 19.0, 63.0, 180.0, 80.0, 50.0, 70.0, 60.0, 60.0, 200.0, 120.0, 110.0, 50.0, 120.0, 80.0, 53.0, 60.0, 33.0, 110.0, 80.0, 56.0, 48.0, 47.0, 69.0, 230.0, 80.0, 100.0, 106.0, 60.0, -43.0, 60.0, 49.0, 177.0, 67.0, 50.0, 70.0, 90.0, 80.0, 90.0, 57.0, 114.0, 24.0, 90.0, 179.0, 46.0, -1.0, -1.0, 180.0, 20.0, 75.0, 60.0, 50.0, -2.0, 57.0, 60.0, -11.0, 88.0, 2.0, 40.0, 39.0, 20.0, 60.0, 60.0, 170.0, -24.0, 605.0, 60.0, 100.0, -66.0, 40.0, 67.0, 80.0, 70.0, -50.0, 20.0, 50.0, 256.0, -7.0, 10.0, -37.0, 28.0, 120.0, 28.0, 70.0, 40.0, -2.0, 146.0, 89.0, 60.0, 70.0, 59.0, 68.0, 118.0, 50.0, 60.0, 152.0, 70.0, 42.0, -14.0, 29.0, 30.0, 70.0, 10.0, -22.0, 50.0, 310.0, 70.0, -39.0, 100.0, 45.0, 70.0, 100.0, 70.0, 19.0, 60.0, 30.0, 189.0, 40.0, 40.0, 100.0, 60.0, 70.0, 40.0, 160.0, 130.0, -25.0, 49.0, 51.0, 43.0, 61.0, 166.0, 29.0, 37.0, 70.0, 20.0, 40.0, 20.0, 156.0, 160.0, 32.0, -5.0, 21.0, 160.0, 17.0, 55.0, 48.0, 30.0, 49.0, 17.0, 279.0, 20.0, 39.0, 92.0, 80.0, 5.0, 40.0, 10.0, 40.0, 60.0, 10.0, 53.0, 50.0, 36.0, 110.0, 93.0, 88.0, 75.0, 200.0, 20.0, 80.0, 110.0, 182.0, 65.0, 38.0, -5.0, 9.0, 170.0, 150.0, 80.0, 30.0, 31.0, 37.0, 0.0, -1.0, -70.0, 140.0, 140.0, 600.0, 180.0, 39.0, 170.0, 19.0, 70.0, 40.0, -10.0, 10.0, -40.0, -54.0, 270.0, -14.0, 90.0, -43.0, 10.0, 55.0, 389.0, 62.0, 190.0, 77.0, -101.0, -16.0, 100.0, 60.0, 60.0, 350.0, 80.0, 120.0, -30.0, 70.0, 100.0, 17.0, 30.0, 50.0, 78.0, 80.0, 21.0, 76.0, 46.0, 130.0, 48.0, 135.0, 70.0, 50.0, 58.0, 80.0, 50.0, 50.0, 40.0, 30.0, 38.0, 48.0, 79.0, 50.0, 100.0, 60.0, 72.0, 34.0, 70.0, 70.0, 30.0, 70.0, 37.0, 30.0, 77.0, 50.0, -4.0, -30.0, 160.0, 60.0, 180.0, 190.0, 83.0, 60.0, -60.0, 50.0, 50.0, 145.0, 70.0, 80.0, 60.0, 6.0, 60.0, -2.0, 60.0, 497.0, -67.0, 76.0, 220.0, 420.0, 265.0, -155.0, 50.0, 60.0, -40.0, 86.0, -4.0, 90.0, 40.0, 80.0, 100.0, 90.0, 0.0, 64.0, 60.0, -75.0, 80.0, 44.0, 100.0, 50.0, 150.0, 90.0, 13.0, 24.0, -40.0, 70.0, -30.0, 18.0, 140.0, 60.0, 208.0, 67.0, 49.0, 50.0, 16.0, 60.0, 55.0, 67.0, 35.0, 40.0, 100.0, 40.0, 69.0, 30.0, 120.0, 79.0, 110.0, 100.0, 90.0, 170.0, 70.0, 60.0, 80.0, 48.0, 32.0, 54.0, 240.0, 40.0, 179.0, 160.0, 60.0, 60.0, 10.0, 7.0, 30.0, 118.0, 47.0, 49.0, 100.0, 90.0, 40.0, 120.0, 50.0, 13.0, 5.0, 15.0, -41.0, 23.0, 35.0, -3.0, 28.0, 280.0, 60.0, 36.0, 90.0, 80.0, 10.0, 30.0, 110.0, 186.0, 150.0, 76.0, 20.0, 20.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.000151784496673, "mean_inference_ms": 2.2985154246037105, "mean_action_processing_ms": 0.772803216434051, "mean_env_wait_ms": 1.6033915728425672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06642413139343262, "StateBufferConnector_ms": 0.010779619216918945, "ViewRequirementAgentConnector_ms": 0.49285173416137695}, "num_episodes": 22, "episode_return_max": 1326.0, "episode_return_min": 88.0, "episode_return_mean": 697.97, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.223445917611436, "num_env_steps_trained_throughput_per_sec": 32.223445917611436, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 3400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3400000, "timers": {"training_iteration_time_ms": 123341.191, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123341.141, "sample_time_ms": 3058.853, "learn_time_ms": 120260.057, "learn_throughput": 33.261, "synch_weights_time_ms": 11.902}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "done": false, "training_iteration": 85, "trial_id": "6085c_00000", "date": "2024-07-02_01-51-10", "timestamp": 1719899470, "time_this_iter_s": 124.14690208435059, "time_total_s": 12316.85573887825, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a54d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12316.85573887825, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 29.106250000000003, "ram_util_percent": 79.44829545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.421152530564541, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.613450717621337, "policy_loss": -0.005672190352432287, "vf_loss": 6.618049916063254, "vf_explained_var": 0.0018770549244012315, "kl": 0.01072980346780066, "entropy": 0.7916774639242881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 802845.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "env_runners": {"episode_reward_max": 1326.0, "episode_reward_min": 259.0, "episode_reward_mean": 715.16, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -163.0}, "policy_reward_max": {"policy_0": 605.0}, "policy_reward_mean": {"policy_0": 71.516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [515.0, 711.0, 443.0, 874.0, 947.0, 813.0, 300.0, 587.0, 791.0, 605.0, 562.0, 510.0, 1229.0, 731.0, 570.0, 553.0, 585.0, 665.0, 568.0, 554.0, 487.0, 527.0, 1160.0, 897.0, 878.0, 843.0, 1089.0, 1187.0, 544.0, 958.0, 699.0, 1032.0, 666.0, 1033.0, 929.0, 639.0, 903.0, 868.0, 701.0, 775.0, 860.0, 261.0, 1081.0, 470.0, 1259.0, 980.0, 687.0, 888.0, 732.0, 606.0, 415.0, 1102.0, 418.0, 718.0, 499.0, 754.0, 648.0, 701.0, 674.0, 646.0, 384.0, 1023.0, 540.0, 1287.0, 259.0, 876.0, 865.0, 714.0, 565.0, 550.0, 689.0, 579.0, 1326.0, 606.0, 436.0, 648.0, 616.0, 839.0, 840.0, 632.0, 523.0, 700.0, 598.0, 569.0, 652.0, 914.0, 559.0, 376.0, 780.0, 371.0, 830.0, 673.0, 820.0, 952.0, 379.0, 486.0, 630.0, 491.0, 822.0, 790.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-12.0, 46.0, 110.0, 100.0, 1.0, 77.0, 86.0, 30.0, 70.0, 7.0, 60.0, 90.0, 25.0, 40.0, 40.0, 170.0, 56.0, 70.0, 110.0, 50.0, 40.0, 16.0, 40.0, 40.0, 49.0, -41.0, 200.0, 30.0, 29.0, 40.0, 280.0, 278.0, -20.0, -163.0, 190.0, 110.0, 50.0, 60.0, 49.0, 40.0, 80.0, 79.0, 60.0, 48.0, 110.0, 70.0, 370.0, 50.0, 60.0, 20.0, 40.0, 210.0, 64.0, 36.0, -5.0, 200.0, 38.0, 60.0, 80.0, 90.0, -6.0, -10.0, 0.0, 30.0, 70.0, -3.0, 30.0, 9.0, 130.0, 50.0, 26.0, 48.0, 57.0, 60.0, 30.0, 56.0, 60.0, 60.0, 30.0, 160.0, 40.0, -20.0, 360.0, 60.0, 100.0, 39.0, 0.0, 50.0, 100.0, 62.0, 50.0, 50.0, 40.0, 60.0, 20.0, 70.0, -12.0, 189.0, 58.0, 80.0, 60.0, 39.0, 60.0, 27.0, 39.0, 90.0, 47.0, 190.0, -10.0, 20.0, 60.0, 30.0, 27.0, 29.0, 160.0, 70.0, 50.0, 1.0, 43.0, 40.0, -57.0, 100.0, 110.0, 180.0, 90.0, 200.0, 158.0, 37.0, 62.0, 349.0, 249.0, 50.0, 50.0, 67.0, 60.0, 35.0, 30.0, 80.0, 60.0, 50.0, 28.0, 70.0, 90.0, 40.0, -18.0, 100.0, 20.0, 160.0, 90.0, -10.0, 68.0, 80.0, 50.0, 170.0, 24.0, 47.0, 19.0, 0.0, 89.0, 6.0, 30.0, 70.0, 100.0, 60.0, 94.0, 30.0, 13.0, 14.0, 154.0, 20.0, 60.0, 5.0, 190.0, 9.0, 56.0, 167.0, 103.0, -5.0, 30.0, 50.0, 29.0, 37.0, 63.0, 43.0, 41.0, 1.0, 80.0, 18.0, 46.0, 210.0, 31.0, 30.0, 65.0, 50.0, 78.0, 71.0, 30.0, 70.0, 89.0, 40.0, 120.0, 40.0, 20.0, 12.0, 50.0, 116.0, 10.0, 45.0, 44.0, 30.0, 4.0, 60.0, 30.0, 50.0, 53.0, 50.0, 100.0, 40.0, 90.0, 50.0, 300.0, 20.0, 90.0, 80.0, 90.0, 60.0, 20.0, 50.0, 80.0, 370.0, 4.0, 86.0, 27.0, 110.0, 60.0, 90.0, 160.0, 160.0, 63.0, 137.0, 39.0, 310.0, 90.0, 60.0, 30.0, 10.0, 69.0, 60.0, 120.0, 90.0, 20.0, 50.0, 81.0, 160.0, 116.0, 20.0, 40.0, 107.0, 159.0, 90.0, 50.0, 80.0, 57.0, 40.0, 76.0, 526.0, 60.0, -30.0, 160.0, 70.0, 60.0, 109.0, 320.0, 70.0, 200.0, 48.0, 80.0, 60.0, 160.0, 80.0, 7.0, 59.0, 70.0, 50.0, 60.0, 60.0, 45.0, 90.0, 37.0, 66.0, 69.0, 60.0, 120.0, 100.0, 210.0, 40.0, -1.0, 80.0, -20.0, 300.0, 90.0, 49.0, 100.0, 130.0, 90.0, 80.0, 0.0, 50.0, 80.0, 30.0, 58.0, 110.0, 188.0, 80.0, 55.0, 110.0, 60.0, 43.0, 188.0, 140.0, 60.0, 53.0, 110.0, 40.0, -10.0, 60.0, 8.0, 20.0, 55.0, 270.0, 30.0, 110.0, 65.0, 390.0, 60.0, 30.0, 170.0, 36.0, 60.0, 82.0, 343.0, 130.0, 35.0, 90.0, 50.0, -9.0, 40.0, 100.0, -10.0, 160.0, 40.0, 100.0, 156.0, 110.0, 59.0, 80.0, 70.0, 28.0, -30.0, 26.0, 48.0, 510.0, 70.0, 5.0, -20.0, 11.0, 100.0, 60.0, 54.0, 65.0, 280.0, 20.0, 195.0, 90.0, 17.0, 0.0, 49.0, 80.0, 50.0, 87.0, -1.0, 162.0, 70.0, 60.0, -50.0, 190.0, 30.0, 80.0, 70.0, 90.0, 70.0, 39.0, 80.0, 100.0, 150.0, 100.0, 76.0, 70.0, 40.0, 50.0, 200.0, 45.0, 158.0, 68.0, 141.0, 40.0, 58.0, 60.0, 70.0, 20.0, 19.0, -7.0, 28.0, 0.0, 100.0, 20.0, -11.0, 20.0, 59.0, 33.0, 190.0, 94.0, 300.0, 60.0, 70.0, 40.0, 110.0, 67.0, 70.0, 80.0, 60.0, 8.0, 12.0, 25.0, 158.0, 20.0, 70.0, 30.0, 29.0, 58.0, 500.0, 90.0, 230.0, 30.0, 160.0, 99.0, 100.0, -32.0, 19.0, 63.0, 180.0, 80.0, 50.0, 70.0, 60.0, 60.0, 200.0, 120.0, 110.0, 50.0, 120.0, 80.0, 53.0, 60.0, 33.0, 110.0, 80.0, 56.0, 48.0, 47.0, 69.0, 230.0, 80.0, 100.0, 106.0, 60.0, -43.0, 60.0, 49.0, 177.0, 67.0, 50.0, 70.0, 90.0, 80.0, 90.0, 57.0, 114.0, 24.0, 90.0, 179.0, 46.0, -1.0, -1.0, 180.0, 20.0, 75.0, 60.0, 50.0, -2.0, 57.0, 60.0, -11.0, 88.0, 2.0, 40.0, 39.0, 20.0, 60.0, 60.0, 170.0, -24.0, 605.0, 60.0, 100.0, -66.0, 40.0, 67.0, 80.0, 70.0, -50.0, 20.0, 50.0, 256.0, -7.0, 10.0, -37.0, 28.0, 120.0, 28.0, 70.0, 40.0, -2.0, 146.0, 89.0, 60.0, 70.0, 59.0, 68.0, 118.0, 50.0, 60.0, 152.0, 70.0, 42.0, -14.0, 29.0, 30.0, 70.0, 10.0, -22.0, 50.0, 310.0, 70.0, -39.0, 100.0, 45.0, 70.0, 100.0, 70.0, 19.0, 60.0, 30.0, 189.0, 40.0, 40.0, 100.0, 60.0, 70.0, 40.0, 160.0, 130.0, -25.0, 49.0, 51.0, 43.0, 61.0, 166.0, 29.0, 37.0, 70.0, 20.0, 40.0, 20.0, 156.0, 160.0, 32.0, -5.0, 21.0, 160.0, 17.0, 55.0, 48.0, 30.0, 49.0, 17.0, 279.0, 20.0, 39.0, 92.0, 80.0, 5.0, 40.0, 10.0, 40.0, 60.0, 10.0, 53.0, 50.0, 36.0, 110.0, 93.0, 88.0, 75.0, 200.0, 20.0, 80.0, 110.0, 182.0, 65.0, 38.0, -5.0, 9.0, 170.0, 150.0, 80.0, 30.0, 31.0, 37.0, 0.0, -1.0, -70.0, 140.0, 140.0, 600.0, 180.0, 39.0, 170.0, 19.0, 70.0, 40.0, -10.0, 10.0, -40.0, -54.0, 270.0, -14.0, 90.0, -43.0, 10.0, 55.0, 389.0, 62.0, 190.0, 77.0, -101.0, -16.0, 100.0, 60.0, 60.0, 350.0, 80.0, 120.0, -30.0, 70.0, 100.0, 17.0, 30.0, 50.0, 78.0, 80.0, 21.0, 76.0, 46.0, 130.0, 48.0, 135.0, 70.0, 50.0, 58.0, 80.0, 50.0, 50.0, 40.0, 30.0, 38.0, 48.0, 79.0, 50.0, 100.0, 60.0, 72.0, 34.0, 70.0, 70.0, 30.0, 70.0, 37.0, 30.0, 77.0, 50.0, -4.0, -30.0, 160.0, 60.0, 180.0, 190.0, 83.0, 60.0, -60.0, 50.0, 50.0, 145.0, 70.0, 80.0, 60.0, 6.0, 60.0, -2.0, 60.0, 497.0, -67.0, 76.0, 220.0, 420.0, 265.0, -155.0, 50.0, 60.0, -40.0, 86.0, -4.0, 90.0, 40.0, 80.0, 100.0, 90.0, 0.0, 64.0, 60.0, -75.0, 80.0, 44.0, 100.0, 50.0, 150.0, 90.0, 13.0, 24.0, -40.0, 70.0, -30.0, 18.0, 140.0, 60.0, 208.0, 67.0, 49.0, 50.0, 16.0, 60.0, 55.0, 67.0, 35.0, 40.0, 100.0, 40.0, 69.0, 30.0, 120.0, 79.0, 110.0, 100.0, 90.0, 170.0, 70.0, 60.0, 80.0, 48.0, 32.0, 54.0, 240.0, 40.0, 179.0, 160.0, 60.0, 60.0, 10.0, 7.0, 30.0, 118.0, 47.0, 49.0, 100.0, 90.0, 40.0, 120.0, 50.0, 13.0, 5.0, 15.0, -41.0, 23.0, 35.0, -3.0, 28.0, 280.0, 60.0, 36.0, 90.0, 80.0, 10.0, 30.0, 110.0, 186.0, 150.0, 76.0, 20.0, 20.0, 18.0, 20.0, 40.0, 100.0, 40.0, 40.0, 58.0, 50.0, 10.0, 180.0, 60.0, 19.0, 90.0, 19.0, 210.0, 28.0, 60.0, -20.0, 47.0, 56.0, 60.0, -90.0, 191.0, 27.0, 90.0, 129.0, 90.0, 130.0, 30.0, -15.0, 70.0, 89.0, 45.0, 110.0, 281.0, 120.0, 70.0, 60.0, 10.0, 60.0, 69.0, 60.0, 40.0, 30.0, 30.0, 100.0, 16.0, 110.0, 80.0, 60.0, 33.0, 29.0, 70.0, 10.0, 10.0, 28.0, 60.0, -50.0, 20.0, 149.0, 50.0, 570.0, -50.0, -20.0, 20.0, 60.0, 60.0, 110.0, 0.0, -20.0, 50.0, 26.0, 7.0, 28.0, 20.0, 190.0, 40.0, 18.0, 49.0, 8.0, -15.0, 15.0, 20.0, 59.0, 50.0, 40.0, 70.0, 40.0, 60.0, 156.0, 320.0, 60.0, 280.0, 17.0, 79.0, 50.0, 70.0, 80.0, -20.0, 60.0, -3.0, 57.0, 58.0, 130.0, 100.0, 80.0, 91.0, 80.0, 40.0, 120.0, 64.0, 46.0, 15.0, 360.0, 9.0, 98.0, 120.0, 70.0, -5.0, 90.0, 149.0, 60.0, -30.0, 49.0, 60.0, 38.0, 40.0, 50.0, 40.0, 90.0, -18.0, 70.0, 60.0, 19.0, 30.0, 13.0, 58.0, 40.0, 180.0, -3.0, 19.0, 60.0, 70.0, 160.0, 0.0, 30.0, 110.0, 30.0, 80.0, 50.0, 40.0, 49.0, 190.0, 26.0, 50.0, 87.0, 20.0, 0.0, 10.0, 40.0, 19.0, 69.0, 120.0, 58.0, 130.0, 70.0, 58.0, 70.0, 67.0, 70.0, 110.0, 40.0, 70.0, 60.0, 100.0, 260.0, 80.0, 40.0, 40.0, 50.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9960016238720748, "mean_inference_ms": 2.293666779839854, "mean_action_processing_ms": 0.7712135450500267, "mean_env_wait_ms": 1.600164803824161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06496691703796387, "StateBufferConnector_ms": 0.010232925415039062, "ViewRequirementAgentConnector_ms": 0.4846663475036621}, "num_episodes": 18, "episode_return_max": 1326.0, "episode_return_min": 259.0, "episode_return_mean": 715.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.54950149024724, "num_env_steps_trained_throughput_per_sec": 32.54950149024724, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 3440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3440000, "timers": {"training_iteration_time_ms": 123341.915, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123341.866, "sample_time_ms": 3076.548, "learn_time_ms": 120244.138, "learn_throughput": 33.266, "synch_weights_time_ms": 12.09}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "done": false, "training_iteration": 86, "trial_id": "6085c_00000", "date": "2024-07-02_01-53-13", "timestamp": 1719899593, "time_this_iter_s": 122.90209102630615, "time_total_s": 12439.757829904556, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138aa7ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12439.757829904556, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 28.915517241379312, "ram_util_percent": 79.45172413793102}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0288147514684005, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.303046397025339, "policy_loss": -0.006223357412160728, "vf_loss": 7.308382535361634, "vf_explained_var": 0.003178571689877901, "kl": 0.008872177819941336, "entropy": 0.7545577480516241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 812235.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "env_runners": {"episode_reward_max": 1373.0, "episode_reward_min": 255.0, "episode_reward_mean": 727.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -171.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 72.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [897.0, 878.0, 843.0, 1089.0, 1187.0, 544.0, 958.0, 699.0, 1032.0, 666.0, 1033.0, 929.0, 639.0, 903.0, 868.0, 701.0, 775.0, 860.0, 261.0, 1081.0, 470.0, 1259.0, 980.0, 687.0, 888.0, 732.0, 606.0, 415.0, 1102.0, 418.0, 718.0, 499.0, 754.0, 648.0, 701.0, 674.0, 646.0, 384.0, 1023.0, 540.0, 1287.0, 259.0, 876.0, 865.0, 714.0, 565.0, 550.0, 689.0, 579.0, 1326.0, 606.0, 436.0, 648.0, 616.0, 839.0, 840.0, 632.0, 523.0, 700.0, 598.0, 569.0, 652.0, 914.0, 559.0, 376.0, 780.0, 371.0, 830.0, 673.0, 820.0, 952.0, 379.0, 486.0, 630.0, 491.0, 822.0, 790.0, 1013.0, 850.0, 393.0, 695.0, 745.0, 1013.0, 598.0, 794.0, 631.0, 387.0, 817.0, 255.0, 870.0, 833.0, 861.0, 706.0, 359.0, 460.0, 513.0, 1373.0, 676.0, 743.0, 961.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [4.0, 86.0, 27.0, 110.0, 60.0, 90.0, 160.0, 160.0, 63.0, 137.0, 39.0, 310.0, 90.0, 60.0, 30.0, 10.0, 69.0, 60.0, 120.0, 90.0, 20.0, 50.0, 81.0, 160.0, 116.0, 20.0, 40.0, 107.0, 159.0, 90.0, 50.0, 80.0, 57.0, 40.0, 76.0, 526.0, 60.0, -30.0, 160.0, 70.0, 60.0, 109.0, 320.0, 70.0, 200.0, 48.0, 80.0, 60.0, 160.0, 80.0, 7.0, 59.0, 70.0, 50.0, 60.0, 60.0, 45.0, 90.0, 37.0, 66.0, 69.0, 60.0, 120.0, 100.0, 210.0, 40.0, -1.0, 80.0, -20.0, 300.0, 90.0, 49.0, 100.0, 130.0, 90.0, 80.0, 0.0, 50.0, 80.0, 30.0, 58.0, 110.0, 188.0, 80.0, 55.0, 110.0, 60.0, 43.0, 188.0, 140.0, 60.0, 53.0, 110.0, 40.0, -10.0, 60.0, 8.0, 20.0, 55.0, 270.0, 30.0, 110.0, 65.0, 390.0, 60.0, 30.0, 170.0, 36.0, 60.0, 82.0, 343.0, 130.0, 35.0, 90.0, 50.0, -9.0, 40.0, 100.0, -10.0, 160.0, 40.0, 100.0, 156.0, 110.0, 59.0, 80.0, 70.0, 28.0, -30.0, 26.0, 48.0, 510.0, 70.0, 5.0, -20.0, 11.0, 100.0, 60.0, 54.0, 65.0, 280.0, 20.0, 195.0, 90.0, 17.0, 0.0, 49.0, 80.0, 50.0, 87.0, -1.0, 162.0, 70.0, 60.0, -50.0, 190.0, 30.0, 80.0, 70.0, 90.0, 70.0, 39.0, 80.0, 100.0, 150.0, 100.0, 76.0, 70.0, 40.0, 50.0, 200.0, 45.0, 158.0, 68.0, 141.0, 40.0, 58.0, 60.0, 70.0, 20.0, 19.0, -7.0, 28.0, 0.0, 100.0, 20.0, -11.0, 20.0, 59.0, 33.0, 190.0, 94.0, 300.0, 60.0, 70.0, 40.0, 110.0, 67.0, 70.0, 80.0, 60.0, 8.0, 12.0, 25.0, 158.0, 20.0, 70.0, 30.0, 29.0, 58.0, 500.0, 90.0, 230.0, 30.0, 160.0, 99.0, 100.0, -32.0, 19.0, 63.0, 180.0, 80.0, 50.0, 70.0, 60.0, 60.0, 200.0, 120.0, 110.0, 50.0, 120.0, 80.0, 53.0, 60.0, 33.0, 110.0, 80.0, 56.0, 48.0, 47.0, 69.0, 230.0, 80.0, 100.0, 106.0, 60.0, -43.0, 60.0, 49.0, 177.0, 67.0, 50.0, 70.0, 90.0, 80.0, 90.0, 57.0, 114.0, 24.0, 90.0, 179.0, 46.0, -1.0, -1.0, 180.0, 20.0, 75.0, 60.0, 50.0, -2.0, 57.0, 60.0, -11.0, 88.0, 2.0, 40.0, 39.0, 20.0, 60.0, 60.0, 170.0, -24.0, 605.0, 60.0, 100.0, -66.0, 40.0, 67.0, 80.0, 70.0, -50.0, 20.0, 50.0, 256.0, -7.0, 10.0, -37.0, 28.0, 120.0, 28.0, 70.0, 40.0, -2.0, 146.0, 89.0, 60.0, 70.0, 59.0, 68.0, 118.0, 50.0, 60.0, 152.0, 70.0, 42.0, -14.0, 29.0, 30.0, 70.0, 10.0, -22.0, 50.0, 310.0, 70.0, -39.0, 100.0, 45.0, 70.0, 100.0, 70.0, 19.0, 60.0, 30.0, 189.0, 40.0, 40.0, 100.0, 60.0, 70.0, 40.0, 160.0, 130.0, -25.0, 49.0, 51.0, 43.0, 61.0, 166.0, 29.0, 37.0, 70.0, 20.0, 40.0, 20.0, 156.0, 160.0, 32.0, -5.0, 21.0, 160.0, 17.0, 55.0, 48.0, 30.0, 49.0, 17.0, 279.0, 20.0, 39.0, 92.0, 80.0, 5.0, 40.0, 10.0, 40.0, 60.0, 10.0, 53.0, 50.0, 36.0, 110.0, 93.0, 88.0, 75.0, 200.0, 20.0, 80.0, 110.0, 182.0, 65.0, 38.0, -5.0, 9.0, 170.0, 150.0, 80.0, 30.0, 31.0, 37.0, 0.0, -1.0, -70.0, 140.0, 140.0, 600.0, 180.0, 39.0, 170.0, 19.0, 70.0, 40.0, -10.0, 10.0, -40.0, -54.0, 270.0, -14.0, 90.0, -43.0, 10.0, 55.0, 389.0, 62.0, 190.0, 77.0, -101.0, -16.0, 100.0, 60.0, 60.0, 350.0, 80.0, 120.0, -30.0, 70.0, 100.0, 17.0, 30.0, 50.0, 78.0, 80.0, 21.0, 76.0, 46.0, 130.0, 48.0, 135.0, 70.0, 50.0, 58.0, 80.0, 50.0, 50.0, 40.0, 30.0, 38.0, 48.0, 79.0, 50.0, 100.0, 60.0, 72.0, 34.0, 70.0, 70.0, 30.0, 70.0, 37.0, 30.0, 77.0, 50.0, -4.0, -30.0, 160.0, 60.0, 180.0, 190.0, 83.0, 60.0, -60.0, 50.0, 50.0, 145.0, 70.0, 80.0, 60.0, 6.0, 60.0, -2.0, 60.0, 497.0, -67.0, 76.0, 220.0, 420.0, 265.0, -155.0, 50.0, 60.0, -40.0, 86.0, -4.0, 90.0, 40.0, 80.0, 100.0, 90.0, 0.0, 64.0, 60.0, -75.0, 80.0, 44.0, 100.0, 50.0, 150.0, 90.0, 13.0, 24.0, -40.0, 70.0, -30.0, 18.0, 140.0, 60.0, 208.0, 67.0, 49.0, 50.0, 16.0, 60.0, 55.0, 67.0, 35.0, 40.0, 100.0, 40.0, 69.0, 30.0, 120.0, 79.0, 110.0, 100.0, 90.0, 170.0, 70.0, 60.0, 80.0, 48.0, 32.0, 54.0, 240.0, 40.0, 179.0, 160.0, 60.0, 60.0, 10.0, 7.0, 30.0, 118.0, 47.0, 49.0, 100.0, 90.0, 40.0, 120.0, 50.0, 13.0, 5.0, 15.0, -41.0, 23.0, 35.0, -3.0, 28.0, 280.0, 60.0, 36.0, 90.0, 80.0, 10.0, 30.0, 110.0, 186.0, 150.0, 76.0, 20.0, 20.0, 18.0, 20.0, 40.0, 100.0, 40.0, 40.0, 58.0, 50.0, 10.0, 180.0, 60.0, 19.0, 90.0, 19.0, 210.0, 28.0, 60.0, -20.0, 47.0, 56.0, 60.0, -90.0, 191.0, 27.0, 90.0, 129.0, 90.0, 130.0, 30.0, -15.0, 70.0, 89.0, 45.0, 110.0, 281.0, 120.0, 70.0, 60.0, 10.0, 60.0, 69.0, 60.0, 40.0, 30.0, 30.0, 100.0, 16.0, 110.0, 80.0, 60.0, 33.0, 29.0, 70.0, 10.0, 10.0, 28.0, 60.0, -50.0, 20.0, 149.0, 50.0, 570.0, -50.0, -20.0, 20.0, 60.0, 60.0, 110.0, 0.0, -20.0, 50.0, 26.0, 7.0, 28.0, 20.0, 190.0, 40.0, 18.0, 49.0, 8.0, -15.0, 15.0, 20.0, 59.0, 50.0, 40.0, 70.0, 40.0, 60.0, 156.0, 320.0, 60.0, 280.0, 17.0, 79.0, 50.0, 70.0, 80.0, -20.0, 60.0, -3.0, 57.0, 58.0, 130.0, 100.0, 80.0, 91.0, 80.0, 40.0, 120.0, 64.0, 46.0, 15.0, 360.0, 9.0, 98.0, 120.0, 70.0, -5.0, 90.0, 149.0, 60.0, -30.0, 49.0, 60.0, 38.0, 40.0, 50.0, 40.0, 90.0, -18.0, 70.0, 60.0, 19.0, 30.0, 13.0, 58.0, 40.0, 180.0, -3.0, 19.0, 60.0, 70.0, 160.0, 0.0, 30.0, 110.0, 30.0, 80.0, 50.0, 40.0, 49.0, 190.0, 26.0, 50.0, 87.0, 20.0, 0.0, 10.0, 40.0, 19.0, 69.0, 120.0, 58.0, 130.0, 70.0, 58.0, 70.0, 67.0, 70.0, 110.0, 40.0, 70.0, 60.0, 100.0, 260.0, 80.0, 40.0, 40.0, 50.0, 50.0, -40.0, 60.0, 317.0, 110.0, 208.0, 20.0, 60.0, 120.0, 80.0, 78.0, 39.0, 100.0, 210.0, 58.0, 70.0, 36.0, 80.0, 70.0, 130.0, 57.0, 40.0, 70.0, -10.0, 30.0, 49.0, -1.0, 160.0, 26.0, -11.0, 40.0, 60.0, 108.0, 50.0, 80.0, 80.0, 40.0, 57.0, 70.0, 50.0, 100.0, 145.0, 48.0, 90.0, 70.0, 218.0, 28.0, -10.0, 36.0, 20.0, 100.0, 92.0, 98.0, 110.0, 60.0, 340.0, 20.0, 98.0, 110.0, -25.0, 110.0, 40.0, 50.0, 78.0, 33.0, 40.0, 20.0, 70.0, 48.0, 122.0, 97.0, 67.0, 110.0, 430.0, -9.0, 93.0, 68.0, -31.0, 20.0, -6.0, 52.0, 50.0, 40.0, 60.0, 60.0, -2.0, 38.0, 175.0, 60.0, 180.0, -30.0, 20.0, 44.0, 70.0, 80.0, 0.0, 0.0, 48.0, 45.0, 50.0, 30.0, 50.0, 60.0, 216.0, 9.0, 40.0, 70.0, 80.0, 90.0, 89.0, 113.0, 40.0, 80.0, -74.0, 6.0, -7.0, 30.0, 30.0, 10.0, 110.0, 30.0, 50.0, 160.0, -6.0, 2.0, 11.0, 44.0, 20.0, 60.0, 550.0, -21.0, 150.0, 50.0, 70.0, 18.0, 70.0, 100.0, 45.0, 60.0, 190.0, 80.0, 110.0, 670.0, -65.0, -171.0, 60.0, 50.0, 37.0, 45.0, 9.0, 116.0, 8.0, 150.0, 170.0, 70.0, 53.0, 200.0, -46.0, 60.0, -9.0, 50.0, 20.0, 70.0, -1.0, 50.0, 120.0, 30.0, 20.0, 10.0, 30.0, 10.0, 50.0, 40.0, 20.0, 40.0, 60.0, 70.0, 40.0, 100.0, 20.0, 20.0, 30.0, 80.0, 45.0, 40.0, 40.0, -19.0, 1.0, 100.0, 17.0, 179.0, 160.0, 57.0, 68.0, 144.0, -20.0, 620.0, 10.0, 190.0, 106.0, 38.0, 70.0, 50.0, 50.0, 30.0, 115.0, 40.0, 35.0, 10.0, 16.0, 260.0, 70.0, 100.0, 73.0, 70.0, 58.0, 70.0, 82.0, 110.0, 30.0, 80.0, 51.0, 59.0, 50.0, -30.0, 70.0, 49.0, 30.0, 50.0, 32.0, 600.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9911139565737757, "mean_inference_ms": 2.287386297189046, "mean_action_processing_ms": 0.7691744121608766, "mean_env_wait_ms": 1.5961472082540595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06512832641601562, "StateBufferConnector_ms": 0.010407209396362305, "ViewRequirementAgentConnector_ms": 0.48355579376220703}, "num_episodes": 23, "episode_return_max": 1373.0, "episode_return_min": 255.0, "episode_return_mean": 727.75, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.497855420000974, "num_env_steps_trained_throughput_per_sec": 32.497855420000974, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 3480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3480000, "timers": {"training_iteration_time_ms": 123342.634, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123342.585, "sample_time_ms": 3103.942, "learn_time_ms": 120218.135, "learn_throughput": 33.273, "synch_weights_time_ms": 12.008}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "done": false, "training_iteration": 87, "trial_id": "6085c_00000", "date": "2024-07-02_01-55-16", "timestamp": 1719899716, "time_this_iter_s": 123.09755277633667, "time_total_s": 12562.855382680893, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12562.855382680893, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 30.25344827586207, "ram_util_percent": 79.7287356321839}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2058695351607756, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.034209796694267, "policy_loss": -0.006482673680925042, "vf_loss": 7.039785780160191, "vf_explained_var": 0.0005914887871605139, "kl": 0.009066911098769281, "entropy": 0.7381449181876116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 821625.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "env_runners": {"episode_reward_max": 1373.0, "episode_reward_min": 255.0, "episode_reward_mean": 701.29, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -171.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 70.129}, "custom_metrics": {}, "hist_stats": {"episode_reward": [261.0, 1081.0, 470.0, 1259.0, 980.0, 687.0, 888.0, 732.0, 606.0, 415.0, 1102.0, 418.0, 718.0, 499.0, 754.0, 648.0, 701.0, 674.0, 646.0, 384.0, 1023.0, 540.0, 1287.0, 259.0, 876.0, 865.0, 714.0, 565.0, 550.0, 689.0, 579.0, 1326.0, 606.0, 436.0, 648.0, 616.0, 839.0, 840.0, 632.0, 523.0, 700.0, 598.0, 569.0, 652.0, 914.0, 559.0, 376.0, 780.0, 371.0, 830.0, 673.0, 820.0, 952.0, 379.0, 486.0, 630.0, 491.0, 822.0, 790.0, 1013.0, 850.0, 393.0, 695.0, 745.0, 1013.0, 598.0, 794.0, 631.0, 387.0, 817.0, 255.0, 870.0, 833.0, 861.0, 706.0, 359.0, 460.0, 513.0, 1373.0, 676.0, 743.0, 961.0, 685.0, 588.0, 430.0, 519.0, 1103.0, 954.0, 707.0, 1209.0, 1184.0, 818.0, 578.0, 859.0, 644.0, 560.0, 508.0, 472.0, 531.0, 506.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [19.0, -7.0, 28.0, 0.0, 100.0, 20.0, -11.0, 20.0, 59.0, 33.0, 190.0, 94.0, 300.0, 60.0, 70.0, 40.0, 110.0, 67.0, 70.0, 80.0, 60.0, 8.0, 12.0, 25.0, 158.0, 20.0, 70.0, 30.0, 29.0, 58.0, 500.0, 90.0, 230.0, 30.0, 160.0, 99.0, 100.0, -32.0, 19.0, 63.0, 180.0, 80.0, 50.0, 70.0, 60.0, 60.0, 200.0, 120.0, 110.0, 50.0, 120.0, 80.0, 53.0, 60.0, 33.0, 110.0, 80.0, 56.0, 48.0, 47.0, 69.0, 230.0, 80.0, 100.0, 106.0, 60.0, -43.0, 60.0, 49.0, 177.0, 67.0, 50.0, 70.0, 90.0, 80.0, 90.0, 57.0, 114.0, 24.0, 90.0, 179.0, 46.0, -1.0, -1.0, 180.0, 20.0, 75.0, 60.0, 50.0, -2.0, 57.0, 60.0, -11.0, 88.0, 2.0, 40.0, 39.0, 20.0, 60.0, 60.0, 170.0, -24.0, 605.0, 60.0, 100.0, -66.0, 40.0, 67.0, 80.0, 70.0, -50.0, 20.0, 50.0, 256.0, -7.0, 10.0, -37.0, 28.0, 120.0, 28.0, 70.0, 40.0, -2.0, 146.0, 89.0, 60.0, 70.0, 59.0, 68.0, 118.0, 50.0, 60.0, 152.0, 70.0, 42.0, -14.0, 29.0, 30.0, 70.0, 10.0, -22.0, 50.0, 310.0, 70.0, -39.0, 100.0, 45.0, 70.0, 100.0, 70.0, 19.0, 60.0, 30.0, 189.0, 40.0, 40.0, 100.0, 60.0, 70.0, 40.0, 160.0, 130.0, -25.0, 49.0, 51.0, 43.0, 61.0, 166.0, 29.0, 37.0, 70.0, 20.0, 40.0, 20.0, 156.0, 160.0, 32.0, -5.0, 21.0, 160.0, 17.0, 55.0, 48.0, 30.0, 49.0, 17.0, 279.0, 20.0, 39.0, 92.0, 80.0, 5.0, 40.0, 10.0, 40.0, 60.0, 10.0, 53.0, 50.0, 36.0, 110.0, 93.0, 88.0, 75.0, 200.0, 20.0, 80.0, 110.0, 182.0, 65.0, 38.0, -5.0, 9.0, 170.0, 150.0, 80.0, 30.0, 31.0, 37.0, 0.0, -1.0, -70.0, 140.0, 140.0, 600.0, 180.0, 39.0, 170.0, 19.0, 70.0, 40.0, -10.0, 10.0, -40.0, -54.0, 270.0, -14.0, 90.0, -43.0, 10.0, 55.0, 389.0, 62.0, 190.0, 77.0, -101.0, -16.0, 100.0, 60.0, 60.0, 350.0, 80.0, 120.0, -30.0, 70.0, 100.0, 17.0, 30.0, 50.0, 78.0, 80.0, 21.0, 76.0, 46.0, 130.0, 48.0, 135.0, 70.0, 50.0, 58.0, 80.0, 50.0, 50.0, 40.0, 30.0, 38.0, 48.0, 79.0, 50.0, 100.0, 60.0, 72.0, 34.0, 70.0, 70.0, 30.0, 70.0, 37.0, 30.0, 77.0, 50.0, -4.0, -30.0, 160.0, 60.0, 180.0, 190.0, 83.0, 60.0, -60.0, 50.0, 50.0, 145.0, 70.0, 80.0, 60.0, 6.0, 60.0, -2.0, 60.0, 497.0, -67.0, 76.0, 220.0, 420.0, 265.0, -155.0, 50.0, 60.0, -40.0, 86.0, -4.0, 90.0, 40.0, 80.0, 100.0, 90.0, 0.0, 64.0, 60.0, -75.0, 80.0, 44.0, 100.0, 50.0, 150.0, 90.0, 13.0, 24.0, -40.0, 70.0, -30.0, 18.0, 140.0, 60.0, 208.0, 67.0, 49.0, 50.0, 16.0, 60.0, 55.0, 67.0, 35.0, 40.0, 100.0, 40.0, 69.0, 30.0, 120.0, 79.0, 110.0, 100.0, 90.0, 170.0, 70.0, 60.0, 80.0, 48.0, 32.0, 54.0, 240.0, 40.0, 179.0, 160.0, 60.0, 60.0, 10.0, 7.0, 30.0, 118.0, 47.0, 49.0, 100.0, 90.0, 40.0, 120.0, 50.0, 13.0, 5.0, 15.0, -41.0, 23.0, 35.0, -3.0, 28.0, 280.0, 60.0, 36.0, 90.0, 80.0, 10.0, 30.0, 110.0, 186.0, 150.0, 76.0, 20.0, 20.0, 18.0, 20.0, 40.0, 100.0, 40.0, 40.0, 58.0, 50.0, 10.0, 180.0, 60.0, 19.0, 90.0, 19.0, 210.0, 28.0, 60.0, -20.0, 47.0, 56.0, 60.0, -90.0, 191.0, 27.0, 90.0, 129.0, 90.0, 130.0, 30.0, -15.0, 70.0, 89.0, 45.0, 110.0, 281.0, 120.0, 70.0, 60.0, 10.0, 60.0, 69.0, 60.0, 40.0, 30.0, 30.0, 100.0, 16.0, 110.0, 80.0, 60.0, 33.0, 29.0, 70.0, 10.0, 10.0, 28.0, 60.0, -50.0, 20.0, 149.0, 50.0, 570.0, -50.0, -20.0, 20.0, 60.0, 60.0, 110.0, 0.0, -20.0, 50.0, 26.0, 7.0, 28.0, 20.0, 190.0, 40.0, 18.0, 49.0, 8.0, -15.0, 15.0, 20.0, 59.0, 50.0, 40.0, 70.0, 40.0, 60.0, 156.0, 320.0, 60.0, 280.0, 17.0, 79.0, 50.0, 70.0, 80.0, -20.0, 60.0, -3.0, 57.0, 58.0, 130.0, 100.0, 80.0, 91.0, 80.0, 40.0, 120.0, 64.0, 46.0, 15.0, 360.0, 9.0, 98.0, 120.0, 70.0, -5.0, 90.0, 149.0, 60.0, -30.0, 49.0, 60.0, 38.0, 40.0, 50.0, 40.0, 90.0, -18.0, 70.0, 60.0, 19.0, 30.0, 13.0, 58.0, 40.0, 180.0, -3.0, 19.0, 60.0, 70.0, 160.0, 0.0, 30.0, 110.0, 30.0, 80.0, 50.0, 40.0, 49.0, 190.0, 26.0, 50.0, 87.0, 20.0, 0.0, 10.0, 40.0, 19.0, 69.0, 120.0, 58.0, 130.0, 70.0, 58.0, 70.0, 67.0, 70.0, 110.0, 40.0, 70.0, 60.0, 100.0, 260.0, 80.0, 40.0, 40.0, 50.0, 50.0, -40.0, 60.0, 317.0, 110.0, 208.0, 20.0, 60.0, 120.0, 80.0, 78.0, 39.0, 100.0, 210.0, 58.0, 70.0, 36.0, 80.0, 70.0, 130.0, 57.0, 40.0, 70.0, -10.0, 30.0, 49.0, -1.0, 160.0, 26.0, -11.0, 40.0, 60.0, 108.0, 50.0, 80.0, 80.0, 40.0, 57.0, 70.0, 50.0, 100.0, 145.0, 48.0, 90.0, 70.0, 218.0, 28.0, -10.0, 36.0, 20.0, 100.0, 92.0, 98.0, 110.0, 60.0, 340.0, 20.0, 98.0, 110.0, -25.0, 110.0, 40.0, 50.0, 78.0, 33.0, 40.0, 20.0, 70.0, 48.0, 122.0, 97.0, 67.0, 110.0, 430.0, -9.0, 93.0, 68.0, -31.0, 20.0, -6.0, 52.0, 50.0, 40.0, 60.0, 60.0, -2.0, 38.0, 175.0, 60.0, 180.0, -30.0, 20.0, 44.0, 70.0, 80.0, 0.0, 0.0, 48.0, 45.0, 50.0, 30.0, 50.0, 60.0, 216.0, 9.0, 40.0, 70.0, 80.0, 90.0, 89.0, 113.0, 40.0, 80.0, -74.0, 6.0, -7.0, 30.0, 30.0, 10.0, 110.0, 30.0, 50.0, 160.0, -6.0, 2.0, 11.0, 44.0, 20.0, 60.0, 550.0, -21.0, 150.0, 50.0, 70.0, 18.0, 70.0, 100.0, 45.0, 60.0, 190.0, 80.0, 110.0, 670.0, -65.0, -171.0, 60.0, 50.0, 37.0, 45.0, 9.0, 116.0, 8.0, 150.0, 170.0, 70.0, 53.0, 200.0, -46.0, 60.0, -9.0, 50.0, 20.0, 70.0, -1.0, 50.0, 120.0, 30.0, 20.0, 10.0, 30.0, 10.0, 50.0, 40.0, 20.0, 40.0, 60.0, 70.0, 40.0, 100.0, 20.0, 20.0, 30.0, 80.0, 45.0, 40.0, 40.0, -19.0, 1.0, 100.0, 17.0, 179.0, 160.0, 57.0, 68.0, 144.0, -20.0, 620.0, 10.0, 190.0, 106.0, 38.0, 70.0, 50.0, 50.0, 30.0, 115.0, 40.0, 35.0, 10.0, 16.0, 260.0, 70.0, 100.0, 73.0, 70.0, 58.0, 70.0, 82.0, 110.0, 30.0, 80.0, 51.0, 59.0, 50.0, -30.0, 70.0, 49.0, 30.0, 50.0, 32.0, 600.0, 89.0, 60.0, 40.0, 31.0, 50.0, 60.0, 180.0, 35.0, 100.0, 40.0, 80.0, 120.0, 44.0, 70.0, 59.0, 60.0, 41.0, 59.0, 25.0, 30.0, -2.0, 30.0, 30.0, -45.0, 138.0, 19.0, 60.0, 40.0, 100.0, 60.0, 80.0, 77.0, 59.0, 20.0, -17.0, 48.0, 10.0, 60.0, 162.0, 20.0, 130.0, 107.0, 95.0, 80.0, 50.0, 57.0, 62.0, 210.0, 285.0, 27.0, 120.0, 70.0, -20.0, 54.0, 190.0, 30.0, 100.0, 300.0, 60.0, 50.0, 13.0, 50.0, 60.0, 70.0, 130.0, 110.0, 100.0, 82.0, 90.0, 2.0, 110.0, 50.0, 80.0, 160.0, 100.0, 41.0, 40.0, 530.0, 38.0, 60.0, 170.0, 99.0, 172.0, 180.0, 69.0, 60.0, 54.0, 20.0, 240.0, 120.0, 139.0, 110.0, -34.0, 170.0, 310.0, -13.0, 27.0, 20.0, 39.0, 50.0, 39.0, 40.0, 28.0, 56.0, 38.0, 109.0, 112.0, 0.0, 56.0, 100.0, 57.0, 50.0, 57.0, 100.0, 158.0, 179.0, 22.0, 67.0, 100.0, 69.0, 160.0, 15.0, 0.0, 20.0, 200.0, 20.0, 49.0, 50.0, 90.0, 40.0, 20.0, -15.0, 160.0, 29.0, 39.0, 30.0, 60.0, 150.0, 72.0, 15.0, 70.0, 60.0, 20.0, 100.0, 60.0, 19.0, 30.0, 100.0, 40.0, 9.0, 10.0, 50.0, 65.0, 50.0, 70.0, -171.0, 120.0, 100.0, 158.0, 20.0, 75.0, 178.0, 40.0, -10.0, -4.0, 74.0, 50.0, 49.0, 29.0, 50.0, 10.0, 50.0, 19.0, 30.0, 60.0, 100.0, 70.0, 21.0, 10.0, 136.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9879521943766074, "mean_inference_ms": 2.2830536392859324, "mean_action_processing_ms": 0.7677612175347446, "mean_env_wait_ms": 1.5934799582526313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06245875358581543, "StateBufferConnector_ms": 0.010286808013916016, "ViewRequirementAgentConnector_ms": 0.4851536750793457}, "num_episodes": 18, "episode_return_max": 1373.0, "episode_return_min": 255.0, "episode_return_mean": 701.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.38008912521673, "num_env_steps_trained_throughput_per_sec": 32.38008912521673, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 3520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3520000, "timers": {"training_iteration_time_ms": 123400.449, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123400.397, "sample_time_ms": 3146.539, "learn_time_ms": 120233.216, "learn_throughput": 33.269, "synch_weights_time_ms": 11.947}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "done": false, "training_iteration": 88, "trial_id": "6085c_00000", "date": "2024-07-02_01-57-20", "timestamp": 1719899840, "time_this_iter_s": 123.54868197441101, "time_total_s": 12686.404064655304, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e5550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12686.404064655304, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 28.533142857142852, "ram_util_percent": 79.18114285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7794359113842533, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.054479327470984, "policy_loss": -0.006011453656657253, "vf_loss": 7.059547087635857, "vf_explained_var": 0.0006055094055728283, "kl": 0.009436891960253851, "entropy": 0.7205916606199246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 831015.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "env_runners": {"episode_reward_max": 1484.0, "episode_reward_min": 255.0, "episode_reward_mean": 724.96, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -171.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 72.496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1287.0, 259.0, 876.0, 865.0, 714.0, 565.0, 550.0, 689.0, 579.0, 1326.0, 606.0, 436.0, 648.0, 616.0, 839.0, 840.0, 632.0, 523.0, 700.0, 598.0, 569.0, 652.0, 914.0, 559.0, 376.0, 780.0, 371.0, 830.0, 673.0, 820.0, 952.0, 379.0, 486.0, 630.0, 491.0, 822.0, 790.0, 1013.0, 850.0, 393.0, 695.0, 745.0, 1013.0, 598.0, 794.0, 631.0, 387.0, 817.0, 255.0, 870.0, 833.0, 861.0, 706.0, 359.0, 460.0, 513.0, 1373.0, 676.0, 743.0, 961.0, 685.0, 588.0, 430.0, 519.0, 1103.0, 954.0, 707.0, 1209.0, 1184.0, 818.0, 578.0, 859.0, 644.0, 560.0, 508.0, 472.0, 531.0, 506.0, 654.0, 1082.0, 958.0, 588.0, 611.0, 543.0, 749.0, 504.0, 1190.0, 748.0, 687.0, 558.0, 283.0, 1390.0, 735.0, 671.0, 1305.0, 1484.0, 682.0, 610.0, 853.0, 968.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-1.0, -70.0, 140.0, 140.0, 600.0, 180.0, 39.0, 170.0, 19.0, 70.0, 40.0, -10.0, 10.0, -40.0, -54.0, 270.0, -14.0, 90.0, -43.0, 10.0, 55.0, 389.0, 62.0, 190.0, 77.0, -101.0, -16.0, 100.0, 60.0, 60.0, 350.0, 80.0, 120.0, -30.0, 70.0, 100.0, 17.0, 30.0, 50.0, 78.0, 80.0, 21.0, 76.0, 46.0, 130.0, 48.0, 135.0, 70.0, 50.0, 58.0, 80.0, 50.0, 50.0, 40.0, 30.0, 38.0, 48.0, 79.0, 50.0, 100.0, 60.0, 72.0, 34.0, 70.0, 70.0, 30.0, 70.0, 37.0, 30.0, 77.0, 50.0, -4.0, -30.0, 160.0, 60.0, 180.0, 190.0, 83.0, 60.0, -60.0, 50.0, 50.0, 145.0, 70.0, 80.0, 60.0, 6.0, 60.0, -2.0, 60.0, 497.0, -67.0, 76.0, 220.0, 420.0, 265.0, -155.0, 50.0, 60.0, -40.0, 86.0, -4.0, 90.0, 40.0, 80.0, 100.0, 90.0, 0.0, 64.0, 60.0, -75.0, 80.0, 44.0, 100.0, 50.0, 150.0, 90.0, 13.0, 24.0, -40.0, 70.0, -30.0, 18.0, 140.0, 60.0, 208.0, 67.0, 49.0, 50.0, 16.0, 60.0, 55.0, 67.0, 35.0, 40.0, 100.0, 40.0, 69.0, 30.0, 120.0, 79.0, 110.0, 100.0, 90.0, 170.0, 70.0, 60.0, 80.0, 48.0, 32.0, 54.0, 240.0, 40.0, 179.0, 160.0, 60.0, 60.0, 10.0, 7.0, 30.0, 118.0, 47.0, 49.0, 100.0, 90.0, 40.0, 120.0, 50.0, 13.0, 5.0, 15.0, -41.0, 23.0, 35.0, -3.0, 28.0, 280.0, 60.0, 36.0, 90.0, 80.0, 10.0, 30.0, 110.0, 186.0, 150.0, 76.0, 20.0, 20.0, 18.0, 20.0, 40.0, 100.0, 40.0, 40.0, 58.0, 50.0, 10.0, 180.0, 60.0, 19.0, 90.0, 19.0, 210.0, 28.0, 60.0, -20.0, 47.0, 56.0, 60.0, -90.0, 191.0, 27.0, 90.0, 129.0, 90.0, 130.0, 30.0, -15.0, 70.0, 89.0, 45.0, 110.0, 281.0, 120.0, 70.0, 60.0, 10.0, 60.0, 69.0, 60.0, 40.0, 30.0, 30.0, 100.0, 16.0, 110.0, 80.0, 60.0, 33.0, 29.0, 70.0, 10.0, 10.0, 28.0, 60.0, -50.0, 20.0, 149.0, 50.0, 570.0, -50.0, -20.0, 20.0, 60.0, 60.0, 110.0, 0.0, -20.0, 50.0, 26.0, 7.0, 28.0, 20.0, 190.0, 40.0, 18.0, 49.0, 8.0, -15.0, 15.0, 20.0, 59.0, 50.0, 40.0, 70.0, 40.0, 60.0, 156.0, 320.0, 60.0, 280.0, 17.0, 79.0, 50.0, 70.0, 80.0, -20.0, 60.0, -3.0, 57.0, 58.0, 130.0, 100.0, 80.0, 91.0, 80.0, 40.0, 120.0, 64.0, 46.0, 15.0, 360.0, 9.0, 98.0, 120.0, 70.0, -5.0, 90.0, 149.0, 60.0, -30.0, 49.0, 60.0, 38.0, 40.0, 50.0, 40.0, 90.0, -18.0, 70.0, 60.0, 19.0, 30.0, 13.0, 58.0, 40.0, 180.0, -3.0, 19.0, 60.0, 70.0, 160.0, 0.0, 30.0, 110.0, 30.0, 80.0, 50.0, 40.0, 49.0, 190.0, 26.0, 50.0, 87.0, 20.0, 0.0, 10.0, 40.0, 19.0, 69.0, 120.0, 58.0, 130.0, 70.0, 58.0, 70.0, 67.0, 70.0, 110.0, 40.0, 70.0, 60.0, 100.0, 260.0, 80.0, 40.0, 40.0, 50.0, 50.0, -40.0, 60.0, 317.0, 110.0, 208.0, 20.0, 60.0, 120.0, 80.0, 78.0, 39.0, 100.0, 210.0, 58.0, 70.0, 36.0, 80.0, 70.0, 130.0, 57.0, 40.0, 70.0, -10.0, 30.0, 49.0, -1.0, 160.0, 26.0, -11.0, 40.0, 60.0, 108.0, 50.0, 80.0, 80.0, 40.0, 57.0, 70.0, 50.0, 100.0, 145.0, 48.0, 90.0, 70.0, 218.0, 28.0, -10.0, 36.0, 20.0, 100.0, 92.0, 98.0, 110.0, 60.0, 340.0, 20.0, 98.0, 110.0, -25.0, 110.0, 40.0, 50.0, 78.0, 33.0, 40.0, 20.0, 70.0, 48.0, 122.0, 97.0, 67.0, 110.0, 430.0, -9.0, 93.0, 68.0, -31.0, 20.0, -6.0, 52.0, 50.0, 40.0, 60.0, 60.0, -2.0, 38.0, 175.0, 60.0, 180.0, -30.0, 20.0, 44.0, 70.0, 80.0, 0.0, 0.0, 48.0, 45.0, 50.0, 30.0, 50.0, 60.0, 216.0, 9.0, 40.0, 70.0, 80.0, 90.0, 89.0, 113.0, 40.0, 80.0, -74.0, 6.0, -7.0, 30.0, 30.0, 10.0, 110.0, 30.0, 50.0, 160.0, -6.0, 2.0, 11.0, 44.0, 20.0, 60.0, 550.0, -21.0, 150.0, 50.0, 70.0, 18.0, 70.0, 100.0, 45.0, 60.0, 190.0, 80.0, 110.0, 670.0, -65.0, -171.0, 60.0, 50.0, 37.0, 45.0, 9.0, 116.0, 8.0, 150.0, 170.0, 70.0, 53.0, 200.0, -46.0, 60.0, -9.0, 50.0, 20.0, 70.0, -1.0, 50.0, 120.0, 30.0, 20.0, 10.0, 30.0, 10.0, 50.0, 40.0, 20.0, 40.0, 60.0, 70.0, 40.0, 100.0, 20.0, 20.0, 30.0, 80.0, 45.0, 40.0, 40.0, -19.0, 1.0, 100.0, 17.0, 179.0, 160.0, 57.0, 68.0, 144.0, -20.0, 620.0, 10.0, 190.0, 106.0, 38.0, 70.0, 50.0, 50.0, 30.0, 115.0, 40.0, 35.0, 10.0, 16.0, 260.0, 70.0, 100.0, 73.0, 70.0, 58.0, 70.0, 82.0, 110.0, 30.0, 80.0, 51.0, 59.0, 50.0, -30.0, 70.0, 49.0, 30.0, 50.0, 32.0, 600.0, 89.0, 60.0, 40.0, 31.0, 50.0, 60.0, 180.0, 35.0, 100.0, 40.0, 80.0, 120.0, 44.0, 70.0, 59.0, 60.0, 41.0, 59.0, 25.0, 30.0, -2.0, 30.0, 30.0, -45.0, 138.0, 19.0, 60.0, 40.0, 100.0, 60.0, 80.0, 77.0, 59.0, 20.0, -17.0, 48.0, 10.0, 60.0, 162.0, 20.0, 130.0, 107.0, 95.0, 80.0, 50.0, 57.0, 62.0, 210.0, 285.0, 27.0, 120.0, 70.0, -20.0, 54.0, 190.0, 30.0, 100.0, 300.0, 60.0, 50.0, 13.0, 50.0, 60.0, 70.0, 130.0, 110.0, 100.0, 82.0, 90.0, 2.0, 110.0, 50.0, 80.0, 160.0, 100.0, 41.0, 40.0, 530.0, 38.0, 60.0, 170.0, 99.0, 172.0, 180.0, 69.0, 60.0, 54.0, 20.0, 240.0, 120.0, 139.0, 110.0, -34.0, 170.0, 310.0, -13.0, 27.0, 20.0, 39.0, 50.0, 39.0, 40.0, 28.0, 56.0, 38.0, 109.0, 112.0, 0.0, 56.0, 100.0, 57.0, 50.0, 57.0, 100.0, 158.0, 179.0, 22.0, 67.0, 100.0, 69.0, 160.0, 15.0, 0.0, 20.0, 200.0, 20.0, 49.0, 50.0, 90.0, 40.0, 20.0, -15.0, 160.0, 29.0, 39.0, 30.0, 60.0, 150.0, 72.0, 15.0, 70.0, 60.0, 20.0, 100.0, 60.0, 19.0, 30.0, 100.0, 40.0, 9.0, 10.0, 50.0, 65.0, 50.0, 70.0, -171.0, 120.0, 100.0, 158.0, 20.0, 75.0, 178.0, 40.0, -10.0, -4.0, 74.0, 50.0, 49.0, 29.0, 50.0, 10.0, 50.0, 19.0, 30.0, 60.0, 100.0, 70.0, 21.0, 10.0, 136.0, 50.0, 160.0, 50.0, 160.0, 29.0, 70.0, 16.0, 59.0, 36.0, 24.0, 69.0, 80.0, 60.0, 600.0, 100.0, 40.0, 50.0, 60.0, -35.0, 58.0, 20.0, 110.0, 60.0, 180.0, 370.0, 130.0, 40.0, -102.0, 80.0, 70.0, 35.0, 60.0, 100.0, 60.0, 70.0, 49.0, 40.0, 30.0, 150.0, -6.0, 200.0, 119.0, 40.0, 90.0, 45.0, 60.0, -4.0, 30.0, 30.0, 1.0, 34.0, -94.0, 180.0, 225.0, 19.0, 100.0, 36.0, -16.0, 49.0, 10.0, 26.0, 90.0, 60.0, 90.0, 58.0, 120.0, 70.0, 65.0, 165.0, 5.0, 90.0, 59.0, 16.0, 60.0, 60.0, 50.0, 14.0, 60.0, 80.0, 15.0, 67.0, 138.0, 110.0, 120.0, 70.0, 209.0, 67.0, 39.0, 310.0, 60.0, 120.0, 50.0, 50.0, 100.0, 100.0, 128.0, 50.0, 150.0, 0.0, 0.0, 60.0, 90.0, 68.0, 66.0, 80.0, 70.0, 56.0, 60.0, 70.0, 67.0, 3.0, 180.0, 100.0, 16.0, 20.0, 32.0, 20.0, 150.0, 30.0, 7.0, 0.0, 50.0, 0.0, 20.0, 85.0, -2.0, -8.0, 29.0, 50.0, 59.0, 50.0, 110.0, 60.0, 100.0, 100.0, 70.0, -30.0, 30.0, 820.0, 80.0, 87.0, 70.0, 150.0, 86.0, 20.0, 50.0, 70.0, 84.0, 70.0, 48.0, 30.0, 100.0, 30.0, 22.0, 30.0, 39.0, 50.0, 90.0, 80.0, 200.0, -10.0, 410.0, 170.0, 160.0, 70.0, 35.0, 80.0, 20.0, 320.0, 50.0, 97.0, 40.0, 510.0, 97.0, 50.0, 60.0, 380.0, 80.0, 90.0, 80.0, 65.0, 60.0, 150.0, 64.0, 80.0, 20.0, 50.0, 10.0, 33.0, 150.0, 100.0, 100.0, 50.0, 30.0, 70.0, 30.0, 60.0, 20.0, 50.0, 100.0, 98.0, 165.0, 119.0, -13.0, 70.0, 80.0, 190.0, 110.0, 0.0, 34.0, 343.0, 70.0, 50.0, 110.0, 70.0, 120.0, 60.0, 40.0, 35.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9864224818168361, "mean_inference_ms": 2.2784785951870465, "mean_action_processing_ms": 0.764210117920065, "mean_env_wait_ms": 1.5905460184321885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06139373779296875, "StateBufferConnector_ms": 0.009832620620727539, "ViewRequirementAgentConnector_ms": 0.4679296016693115}, "num_episodes": 22, "episode_return_max": 1484.0, "episode_return_min": 255.0, "episode_return_mean": 724.96, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.38484653146796, "num_env_steps_trained_throughput_per_sec": 32.38484653146796, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 3560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3560000, "timers": {"training_iteration_time_ms": 123434.078, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123434.026, "sample_time_ms": 3171.727, "learn_time_ms": 120241.416, "learn_throughput": 33.266, "synch_weights_time_ms": 12.083}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "done": false, "training_iteration": 89, "trial_id": "6085c_00000", "date": "2024-07-02_01-59-23", "timestamp": 1719899963, "time_this_iter_s": 123.52919220924377, "time_total_s": 12809.933256864548, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a54700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12809.933256864548, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 28.49137931034483, "ram_util_percent": 79.25747126436781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.289152674908582, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.754793021828729, "policy_loss": -0.006073311168707399, "vf_loss": 6.759952913432583, "vf_explained_var": 0.004414489747871098, "kl": 0.009134208732106283, "entropy": 0.742145466772766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 840405.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "env_runners": {"episode_reward_max": 1484.0, "episode_reward_min": 255.0, "episode_reward_mean": 716.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -171.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 71.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0, 598.0, 569.0, 652.0, 914.0, 559.0, 376.0, 780.0, 371.0, 830.0, 673.0, 820.0, 952.0, 379.0, 486.0, 630.0, 491.0, 822.0, 790.0, 1013.0, 850.0, 393.0, 695.0, 745.0, 1013.0, 598.0, 794.0, 631.0, 387.0, 817.0, 255.0, 870.0, 833.0, 861.0, 706.0, 359.0, 460.0, 513.0, 1373.0, 676.0, 743.0, 961.0, 685.0, 588.0, 430.0, 519.0, 1103.0, 954.0, 707.0, 1209.0, 1184.0, 818.0, 578.0, 859.0, 644.0, 560.0, 508.0, 472.0, 531.0, 506.0, 654.0, 1082.0, 958.0, 588.0, 611.0, 543.0, 749.0, 504.0, 1190.0, 748.0, 687.0, 558.0, 283.0, 1390.0, 735.0, 671.0, 1305.0, 1484.0, 682.0, 610.0, 853.0, 968.0, 592.0, 641.0, 679.0, 544.0, 698.0, 1084.0, 593.0, 331.0, 411.0, 676.0, 800.0, 1197.0, 530.0, 617.0, 768.0, 531.0, 696.0, 641.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 10.0, 30.0, 110.0, 186.0, 150.0, 76.0, 20.0, 20.0, 18.0, 20.0, 40.0, 100.0, 40.0, 40.0, 58.0, 50.0, 10.0, 180.0, 60.0, 19.0, 90.0, 19.0, 210.0, 28.0, 60.0, -20.0, 47.0, 56.0, 60.0, -90.0, 191.0, 27.0, 90.0, 129.0, 90.0, 130.0, 30.0, -15.0, 70.0, 89.0, 45.0, 110.0, 281.0, 120.0, 70.0, 60.0, 10.0, 60.0, 69.0, 60.0, 40.0, 30.0, 30.0, 100.0, 16.0, 110.0, 80.0, 60.0, 33.0, 29.0, 70.0, 10.0, 10.0, 28.0, 60.0, -50.0, 20.0, 149.0, 50.0, 570.0, -50.0, -20.0, 20.0, 60.0, 60.0, 110.0, 0.0, -20.0, 50.0, 26.0, 7.0, 28.0, 20.0, 190.0, 40.0, 18.0, 49.0, 8.0, -15.0, 15.0, 20.0, 59.0, 50.0, 40.0, 70.0, 40.0, 60.0, 156.0, 320.0, 60.0, 280.0, 17.0, 79.0, 50.0, 70.0, 80.0, -20.0, 60.0, -3.0, 57.0, 58.0, 130.0, 100.0, 80.0, 91.0, 80.0, 40.0, 120.0, 64.0, 46.0, 15.0, 360.0, 9.0, 98.0, 120.0, 70.0, -5.0, 90.0, 149.0, 60.0, -30.0, 49.0, 60.0, 38.0, 40.0, 50.0, 40.0, 90.0, -18.0, 70.0, 60.0, 19.0, 30.0, 13.0, 58.0, 40.0, 180.0, -3.0, 19.0, 60.0, 70.0, 160.0, 0.0, 30.0, 110.0, 30.0, 80.0, 50.0, 40.0, 49.0, 190.0, 26.0, 50.0, 87.0, 20.0, 0.0, 10.0, 40.0, 19.0, 69.0, 120.0, 58.0, 130.0, 70.0, 58.0, 70.0, 67.0, 70.0, 110.0, 40.0, 70.0, 60.0, 100.0, 260.0, 80.0, 40.0, 40.0, 50.0, 50.0, -40.0, 60.0, 317.0, 110.0, 208.0, 20.0, 60.0, 120.0, 80.0, 78.0, 39.0, 100.0, 210.0, 58.0, 70.0, 36.0, 80.0, 70.0, 130.0, 57.0, 40.0, 70.0, -10.0, 30.0, 49.0, -1.0, 160.0, 26.0, -11.0, 40.0, 60.0, 108.0, 50.0, 80.0, 80.0, 40.0, 57.0, 70.0, 50.0, 100.0, 145.0, 48.0, 90.0, 70.0, 218.0, 28.0, -10.0, 36.0, 20.0, 100.0, 92.0, 98.0, 110.0, 60.0, 340.0, 20.0, 98.0, 110.0, -25.0, 110.0, 40.0, 50.0, 78.0, 33.0, 40.0, 20.0, 70.0, 48.0, 122.0, 97.0, 67.0, 110.0, 430.0, -9.0, 93.0, 68.0, -31.0, 20.0, -6.0, 52.0, 50.0, 40.0, 60.0, 60.0, -2.0, 38.0, 175.0, 60.0, 180.0, -30.0, 20.0, 44.0, 70.0, 80.0, 0.0, 0.0, 48.0, 45.0, 50.0, 30.0, 50.0, 60.0, 216.0, 9.0, 40.0, 70.0, 80.0, 90.0, 89.0, 113.0, 40.0, 80.0, -74.0, 6.0, -7.0, 30.0, 30.0, 10.0, 110.0, 30.0, 50.0, 160.0, -6.0, 2.0, 11.0, 44.0, 20.0, 60.0, 550.0, -21.0, 150.0, 50.0, 70.0, 18.0, 70.0, 100.0, 45.0, 60.0, 190.0, 80.0, 110.0, 670.0, -65.0, -171.0, 60.0, 50.0, 37.0, 45.0, 9.0, 116.0, 8.0, 150.0, 170.0, 70.0, 53.0, 200.0, -46.0, 60.0, -9.0, 50.0, 20.0, 70.0, -1.0, 50.0, 120.0, 30.0, 20.0, 10.0, 30.0, 10.0, 50.0, 40.0, 20.0, 40.0, 60.0, 70.0, 40.0, 100.0, 20.0, 20.0, 30.0, 80.0, 45.0, 40.0, 40.0, -19.0, 1.0, 100.0, 17.0, 179.0, 160.0, 57.0, 68.0, 144.0, -20.0, 620.0, 10.0, 190.0, 106.0, 38.0, 70.0, 50.0, 50.0, 30.0, 115.0, 40.0, 35.0, 10.0, 16.0, 260.0, 70.0, 100.0, 73.0, 70.0, 58.0, 70.0, 82.0, 110.0, 30.0, 80.0, 51.0, 59.0, 50.0, -30.0, 70.0, 49.0, 30.0, 50.0, 32.0, 600.0, 89.0, 60.0, 40.0, 31.0, 50.0, 60.0, 180.0, 35.0, 100.0, 40.0, 80.0, 120.0, 44.0, 70.0, 59.0, 60.0, 41.0, 59.0, 25.0, 30.0, -2.0, 30.0, 30.0, -45.0, 138.0, 19.0, 60.0, 40.0, 100.0, 60.0, 80.0, 77.0, 59.0, 20.0, -17.0, 48.0, 10.0, 60.0, 162.0, 20.0, 130.0, 107.0, 95.0, 80.0, 50.0, 57.0, 62.0, 210.0, 285.0, 27.0, 120.0, 70.0, -20.0, 54.0, 190.0, 30.0, 100.0, 300.0, 60.0, 50.0, 13.0, 50.0, 60.0, 70.0, 130.0, 110.0, 100.0, 82.0, 90.0, 2.0, 110.0, 50.0, 80.0, 160.0, 100.0, 41.0, 40.0, 530.0, 38.0, 60.0, 170.0, 99.0, 172.0, 180.0, 69.0, 60.0, 54.0, 20.0, 240.0, 120.0, 139.0, 110.0, -34.0, 170.0, 310.0, -13.0, 27.0, 20.0, 39.0, 50.0, 39.0, 40.0, 28.0, 56.0, 38.0, 109.0, 112.0, 0.0, 56.0, 100.0, 57.0, 50.0, 57.0, 100.0, 158.0, 179.0, 22.0, 67.0, 100.0, 69.0, 160.0, 15.0, 0.0, 20.0, 200.0, 20.0, 49.0, 50.0, 90.0, 40.0, 20.0, -15.0, 160.0, 29.0, 39.0, 30.0, 60.0, 150.0, 72.0, 15.0, 70.0, 60.0, 20.0, 100.0, 60.0, 19.0, 30.0, 100.0, 40.0, 9.0, 10.0, 50.0, 65.0, 50.0, 70.0, -171.0, 120.0, 100.0, 158.0, 20.0, 75.0, 178.0, 40.0, -10.0, -4.0, 74.0, 50.0, 49.0, 29.0, 50.0, 10.0, 50.0, 19.0, 30.0, 60.0, 100.0, 70.0, 21.0, 10.0, 136.0, 50.0, 160.0, 50.0, 160.0, 29.0, 70.0, 16.0, 59.0, 36.0, 24.0, 69.0, 80.0, 60.0, 600.0, 100.0, 40.0, 50.0, 60.0, -35.0, 58.0, 20.0, 110.0, 60.0, 180.0, 370.0, 130.0, 40.0, -102.0, 80.0, 70.0, 35.0, 60.0, 100.0, 60.0, 70.0, 49.0, 40.0, 30.0, 150.0, -6.0, 200.0, 119.0, 40.0, 90.0, 45.0, 60.0, -4.0, 30.0, 30.0, 1.0, 34.0, -94.0, 180.0, 225.0, 19.0, 100.0, 36.0, -16.0, 49.0, 10.0, 26.0, 90.0, 60.0, 90.0, 58.0, 120.0, 70.0, 65.0, 165.0, 5.0, 90.0, 59.0, 16.0, 60.0, 60.0, 50.0, 14.0, 60.0, 80.0, 15.0, 67.0, 138.0, 110.0, 120.0, 70.0, 209.0, 67.0, 39.0, 310.0, 60.0, 120.0, 50.0, 50.0, 100.0, 100.0, 128.0, 50.0, 150.0, 0.0, 0.0, 60.0, 90.0, 68.0, 66.0, 80.0, 70.0, 56.0, 60.0, 70.0, 67.0, 3.0, 180.0, 100.0, 16.0, 20.0, 32.0, 20.0, 150.0, 30.0, 7.0, 0.0, 50.0, 0.0, 20.0, 85.0, -2.0, -8.0, 29.0, 50.0, 59.0, 50.0, 110.0, 60.0, 100.0, 100.0, 70.0, -30.0, 30.0, 820.0, 80.0, 87.0, 70.0, 150.0, 86.0, 20.0, 50.0, 70.0, 84.0, 70.0, 48.0, 30.0, 100.0, 30.0, 22.0, 30.0, 39.0, 50.0, 90.0, 80.0, 200.0, -10.0, 410.0, 170.0, 160.0, 70.0, 35.0, 80.0, 20.0, 320.0, 50.0, 97.0, 40.0, 510.0, 97.0, 50.0, 60.0, 380.0, 80.0, 90.0, 80.0, 65.0, 60.0, 150.0, 64.0, 80.0, 20.0, 50.0, 10.0, 33.0, 150.0, 100.0, 100.0, 50.0, 30.0, 70.0, 30.0, 60.0, 20.0, 50.0, 100.0, 98.0, 165.0, 119.0, -13.0, 70.0, 80.0, 190.0, 110.0, 0.0, 34.0, 343.0, 70.0, 50.0, 110.0, 70.0, 120.0, 60.0, 40.0, 35.0, 70.0, 50.0, 48.0, 37.0, -55.0, 50.0, 60.0, 213.0, 120.0, 29.0, 40.0, 57.0, 76.0, 160.0, 50.0, 40.0, 70.0, -2.0, 30.0, 70.0, 90.0, 40.0, 30.0, 59.0, 30.0, 30.0, 80.0, 170.0, 20.0, 50.0, 170.0, 60.0, 10.0, 80.0, 69.0, 109.0, 70.0, 49.0, 40.0, 30.0, 27.0, 79.0, 119.0, 40.0, 50.0, 40.0, 50.0, 50.0, 80.0, 70.0, 120.0, 28.0, 270.0, 70.0, 259.0, 50.0, 20.0, 60.0, 47.0, 230.0, 50.0, 70.0, 50.0, 60.0, 170.0, 110.0, -2.0, 25.0, 20.0, -40.0, 130.0, 170.0, 12.0, 37.0, 17.0, 10.0, 14.0, 7.0, 44.0, 21.0, -1.0, 10.0, 98.0, 20.0, 60.0, 80.0, 30.0, 35.0, 10.0, 50.0, 18.0, -51.0, -30.0, 10.0, 90.0, 300.0, 100.0, 60.0, 67.0, 50.0, 80.0, 40.0, 220.0, 190.0, 40.0, -31.0, 75.0, 72.0, 158.0, 66.0, -30.0, 49.0, 30.0, 68.0, 40.0, 80.0, 280.0, 110.0, 330.0, 90.0, 120.0, 50.0, 50.0, 70.0, 60.0, 70.0, 70.0, 10.0, 80.0, 20.0, 50.0, 60.0, 10.0, 20.0, 80.0, 180.0, 38.0, 29.0, 100.0, 70.0, 30.0, 27.0, 80.0, 186.0, 300.0, 120.0, 35.0, 28.0, -58.0, 20.0, 30.0, 40.0, 2.0, -7.0, -4.0, 90.0, 190.0, 90.0, 40.0, 10.0, 80.0, 50.0, 24.0, 67.0, 76.0, 100.0, 10.0, 40.0, 189.0, 20.0, 120.0, 60.0, 25.0, 29.0, 170.0, 20.0, 100.0, 60.0, 10.0, 130.0, 37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9819331480704567, "mean_inference_ms": 2.2742974984831967, "mean_action_processing_ms": 0.7650142103691114, "mean_env_wait_ms": 1.5880241427281654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059394121170043945, "StateBufferConnector_ms": 0.009732484817504883, "ViewRequirementAgentConnector_ms": 0.4539940357208252}, "num_episodes": 18, "episode_return_max": 1484.0, "episode_return_min": 255.0, "episode_return_mean": 716.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.75467671537613, "num_env_steps_trained_throughput_per_sec": 32.75467671537613, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 3600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3600000, "timers": {"training_iteration_time_ms": 123235.118, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123235.066, "sample_time_ms": 3180.354, "learn_time_ms": 120033.846, "learn_throughput": 33.324, "synch_weights_time_ms": 12.243}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "done": false, "training_iteration": 90, "trial_id": "6085c_00000", "date": "2024-07-02_02-01-25", "timestamp": 1719900085, "time_this_iter_s": 122.13577914237976, "time_total_s": 12932.069036006927, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13800f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12932.069036006927, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 28.103468208092483, "ram_util_percent": 79.25953757225435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.081640478743278, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.461367662366841, "policy_loss": -0.006928252922673536, "vf_loss": 7.467260462077408, "vf_explained_var": 0.0010348807699002397, "kl": 0.010354515802202341, "entropy": 0.7024733718718711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 849795.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "env_runners": {"episode_reward_max": 1484.0, "episode_reward_min": 255.0, "episode_reward_mean": 731.27, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -171.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 73.127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [745.0, 1013.0, 598.0, 794.0, 631.0, 387.0, 817.0, 255.0, 870.0, 833.0, 861.0, 706.0, 359.0, 460.0, 513.0, 1373.0, 676.0, 743.0, 961.0, 685.0, 588.0, 430.0, 519.0, 1103.0, 954.0, 707.0, 1209.0, 1184.0, 818.0, 578.0, 859.0, 644.0, 560.0, 508.0, 472.0, 531.0, 506.0, 654.0, 1082.0, 958.0, 588.0, 611.0, 543.0, 749.0, 504.0, 1190.0, 748.0, 687.0, 558.0, 283.0, 1390.0, 735.0, 671.0, 1305.0, 1484.0, 682.0, 610.0, 853.0, 968.0, 592.0, 641.0, 679.0, 544.0, 698.0, 1084.0, 593.0, 331.0, 411.0, 676.0, 800.0, 1197.0, 530.0, 617.0, 768.0, 531.0, 696.0, 641.0, 984.0, 430.0, 764.0, 658.0, 734.0, 878.0, 897.0, 352.0, 371.0, 675.0, 806.0, 755.0, 820.0, 706.0, 949.0, 949.0, 839.0, 626.0, 677.0, 729.0, 927.0, 640.0, 629.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [145.0, 48.0, 90.0, 70.0, 218.0, 28.0, -10.0, 36.0, 20.0, 100.0, 92.0, 98.0, 110.0, 60.0, 340.0, 20.0, 98.0, 110.0, -25.0, 110.0, 40.0, 50.0, 78.0, 33.0, 40.0, 20.0, 70.0, 48.0, 122.0, 97.0, 67.0, 110.0, 430.0, -9.0, 93.0, 68.0, -31.0, 20.0, -6.0, 52.0, 50.0, 40.0, 60.0, 60.0, -2.0, 38.0, 175.0, 60.0, 180.0, -30.0, 20.0, 44.0, 70.0, 80.0, 0.0, 0.0, 48.0, 45.0, 50.0, 30.0, 50.0, 60.0, 216.0, 9.0, 40.0, 70.0, 80.0, 90.0, 89.0, 113.0, 40.0, 80.0, -74.0, 6.0, -7.0, 30.0, 30.0, 10.0, 110.0, 30.0, 50.0, 160.0, -6.0, 2.0, 11.0, 44.0, 20.0, 60.0, 550.0, -21.0, 150.0, 50.0, 70.0, 18.0, 70.0, 100.0, 45.0, 60.0, 190.0, 80.0, 110.0, 670.0, -65.0, -171.0, 60.0, 50.0, 37.0, 45.0, 9.0, 116.0, 8.0, 150.0, 170.0, 70.0, 53.0, 200.0, -46.0, 60.0, -9.0, 50.0, 20.0, 70.0, -1.0, 50.0, 120.0, 30.0, 20.0, 10.0, 30.0, 10.0, 50.0, 40.0, 20.0, 40.0, 60.0, 70.0, 40.0, 100.0, 20.0, 20.0, 30.0, 80.0, 45.0, 40.0, 40.0, -19.0, 1.0, 100.0, 17.0, 179.0, 160.0, 57.0, 68.0, 144.0, -20.0, 620.0, 10.0, 190.0, 106.0, 38.0, 70.0, 50.0, 50.0, 30.0, 115.0, 40.0, 35.0, 10.0, 16.0, 260.0, 70.0, 100.0, 73.0, 70.0, 58.0, 70.0, 82.0, 110.0, 30.0, 80.0, 51.0, 59.0, 50.0, -30.0, 70.0, 49.0, 30.0, 50.0, 32.0, 600.0, 89.0, 60.0, 40.0, 31.0, 50.0, 60.0, 180.0, 35.0, 100.0, 40.0, 80.0, 120.0, 44.0, 70.0, 59.0, 60.0, 41.0, 59.0, 25.0, 30.0, -2.0, 30.0, 30.0, -45.0, 138.0, 19.0, 60.0, 40.0, 100.0, 60.0, 80.0, 77.0, 59.0, 20.0, -17.0, 48.0, 10.0, 60.0, 162.0, 20.0, 130.0, 107.0, 95.0, 80.0, 50.0, 57.0, 62.0, 210.0, 285.0, 27.0, 120.0, 70.0, -20.0, 54.0, 190.0, 30.0, 100.0, 300.0, 60.0, 50.0, 13.0, 50.0, 60.0, 70.0, 130.0, 110.0, 100.0, 82.0, 90.0, 2.0, 110.0, 50.0, 80.0, 160.0, 100.0, 41.0, 40.0, 530.0, 38.0, 60.0, 170.0, 99.0, 172.0, 180.0, 69.0, 60.0, 54.0, 20.0, 240.0, 120.0, 139.0, 110.0, -34.0, 170.0, 310.0, -13.0, 27.0, 20.0, 39.0, 50.0, 39.0, 40.0, 28.0, 56.0, 38.0, 109.0, 112.0, 0.0, 56.0, 100.0, 57.0, 50.0, 57.0, 100.0, 158.0, 179.0, 22.0, 67.0, 100.0, 69.0, 160.0, 15.0, 0.0, 20.0, 200.0, 20.0, 49.0, 50.0, 90.0, 40.0, 20.0, -15.0, 160.0, 29.0, 39.0, 30.0, 60.0, 150.0, 72.0, 15.0, 70.0, 60.0, 20.0, 100.0, 60.0, 19.0, 30.0, 100.0, 40.0, 9.0, 10.0, 50.0, 65.0, 50.0, 70.0, -171.0, 120.0, 100.0, 158.0, 20.0, 75.0, 178.0, 40.0, -10.0, -4.0, 74.0, 50.0, 49.0, 29.0, 50.0, 10.0, 50.0, 19.0, 30.0, 60.0, 100.0, 70.0, 21.0, 10.0, 136.0, 50.0, 160.0, 50.0, 160.0, 29.0, 70.0, 16.0, 59.0, 36.0, 24.0, 69.0, 80.0, 60.0, 600.0, 100.0, 40.0, 50.0, 60.0, -35.0, 58.0, 20.0, 110.0, 60.0, 180.0, 370.0, 130.0, 40.0, -102.0, 80.0, 70.0, 35.0, 60.0, 100.0, 60.0, 70.0, 49.0, 40.0, 30.0, 150.0, -6.0, 200.0, 119.0, 40.0, 90.0, 45.0, 60.0, -4.0, 30.0, 30.0, 1.0, 34.0, -94.0, 180.0, 225.0, 19.0, 100.0, 36.0, -16.0, 49.0, 10.0, 26.0, 90.0, 60.0, 90.0, 58.0, 120.0, 70.0, 65.0, 165.0, 5.0, 90.0, 59.0, 16.0, 60.0, 60.0, 50.0, 14.0, 60.0, 80.0, 15.0, 67.0, 138.0, 110.0, 120.0, 70.0, 209.0, 67.0, 39.0, 310.0, 60.0, 120.0, 50.0, 50.0, 100.0, 100.0, 128.0, 50.0, 150.0, 0.0, 0.0, 60.0, 90.0, 68.0, 66.0, 80.0, 70.0, 56.0, 60.0, 70.0, 67.0, 3.0, 180.0, 100.0, 16.0, 20.0, 32.0, 20.0, 150.0, 30.0, 7.0, 0.0, 50.0, 0.0, 20.0, 85.0, -2.0, -8.0, 29.0, 50.0, 59.0, 50.0, 110.0, 60.0, 100.0, 100.0, 70.0, -30.0, 30.0, 820.0, 80.0, 87.0, 70.0, 150.0, 86.0, 20.0, 50.0, 70.0, 84.0, 70.0, 48.0, 30.0, 100.0, 30.0, 22.0, 30.0, 39.0, 50.0, 90.0, 80.0, 200.0, -10.0, 410.0, 170.0, 160.0, 70.0, 35.0, 80.0, 20.0, 320.0, 50.0, 97.0, 40.0, 510.0, 97.0, 50.0, 60.0, 380.0, 80.0, 90.0, 80.0, 65.0, 60.0, 150.0, 64.0, 80.0, 20.0, 50.0, 10.0, 33.0, 150.0, 100.0, 100.0, 50.0, 30.0, 70.0, 30.0, 60.0, 20.0, 50.0, 100.0, 98.0, 165.0, 119.0, -13.0, 70.0, 80.0, 190.0, 110.0, 0.0, 34.0, 343.0, 70.0, 50.0, 110.0, 70.0, 120.0, 60.0, 40.0, 35.0, 70.0, 50.0, 48.0, 37.0, -55.0, 50.0, 60.0, 213.0, 120.0, 29.0, 40.0, 57.0, 76.0, 160.0, 50.0, 40.0, 70.0, -2.0, 30.0, 70.0, 90.0, 40.0, 30.0, 59.0, 30.0, 30.0, 80.0, 170.0, 20.0, 50.0, 170.0, 60.0, 10.0, 80.0, 69.0, 109.0, 70.0, 49.0, 40.0, 30.0, 27.0, 79.0, 119.0, 40.0, 50.0, 40.0, 50.0, 50.0, 80.0, 70.0, 120.0, 28.0, 270.0, 70.0, 259.0, 50.0, 20.0, 60.0, 47.0, 230.0, 50.0, 70.0, 50.0, 60.0, 170.0, 110.0, -2.0, 25.0, 20.0, -40.0, 130.0, 170.0, 12.0, 37.0, 17.0, 10.0, 14.0, 7.0, 44.0, 21.0, -1.0, 10.0, 98.0, 20.0, 60.0, 80.0, 30.0, 35.0, 10.0, 50.0, 18.0, -51.0, -30.0, 10.0, 90.0, 300.0, 100.0, 60.0, 67.0, 50.0, 80.0, 40.0, 220.0, 190.0, 40.0, -31.0, 75.0, 72.0, 158.0, 66.0, -30.0, 49.0, 30.0, 68.0, 40.0, 80.0, 280.0, 110.0, 330.0, 90.0, 120.0, 50.0, 50.0, 70.0, 60.0, 70.0, 70.0, 10.0, 80.0, 20.0, 50.0, 60.0, 10.0, 20.0, 80.0, 180.0, 38.0, 29.0, 100.0, 70.0, 30.0, 27.0, 80.0, 186.0, 300.0, 120.0, 35.0, 28.0, -58.0, 20.0, 30.0, 40.0, 2.0, -7.0, -4.0, 90.0, 190.0, 90.0, 40.0, 10.0, 80.0, 50.0, 24.0, 67.0, 76.0, 100.0, 10.0, 40.0, 189.0, 20.0, 120.0, 60.0, 25.0, 29.0, 170.0, 20.0, 100.0, 60.0, 10.0, 130.0, 37.0, 50.0, 300.0, 70.0, 50.0, 70.0, 80.0, -13.0, 100.0, 157.0, 120.0, 84.0, 34.0, 16.0, -4.0, 60.0, 20.0, 40.0, 100.0, 30.0, 50.0, 457.0, 20.0, 45.0, 10.0, 37.0, 30.0, 110.0, 90.0, 5.0, -40.0, 60.0, 40.0, 110.0, 40.0, 60.0, 100.0, 59.0, 90.0, 60.0, 39.0, 160.0, 54.0, 80.0, 100.0, 50.0, 50.0, 70.0, 1.0, 70.0, 99.0, 90.0, 90.0, -30.0, 500.0, 99.0, -70.0, 49.0, 70.0, 30.0, 50.0, 40.0, 80.0, 170.0, 60.0, 180.0, 70.0, 79.0, 68.0, 60.0, 90.0, 30.0, -48.0, 30.0, 50.0, 40.0, 20.0, 20.0, 10.0, 170.0, 30.0, 26.0, -48.0, 10.0, 28.0, 38.0, 14.0, 64.0, 134.0, 35.0, 70.0, 60.0, 110.0, 88.0, 60.0, 60.0, 60.0, 34.0, 64.0, 79.0, 60.0, 90.0, 77.0, 110.0, 20.0, 210.0, 8.0, -59.0, 230.0, 40.0, 80.0, 184.0, -28.0, 55.0, 7.0, 24.0, 110.0, 270.0, 55.0, 43.0, 35.0, -40.0, 120.0, 166.0, 55.0, 70.0, 100.0, 185.0, 70.0, 44.0, 50.0, 50.0, 63.0, 15.0, 110.0, 100.0, 110.0, 70.0, 57.0, 54.0, 77.0, 98.0, 30.0, 60.0, 100.0, 380.0, 30.0, 11.0, -40.0, 190.0, 90.0, 80.0, -35.0, 185.0, 370.0, 30.0, 100.0, 19.0, 120.0, 70.0, 10.0, 100.0, 140.0, 80.0, 40.0, 40.0, 37.0, 120.0, 120.0, 56.0, 106.0, 20.0, 10.0, 73.0, 50.0, 49.0, 46.0, 167.0, 110.0, 81.0, 20.0, 120.0, 110.0, 40.0, 76.0, 55.0, 50.0, 10.0, 66.0, 90.0, 60.0, 67.0, 170.0, 100.0, 49.0, 50.0, 37.0, 40.0, 140.0, 16.0, 60.0, 86.0, 360.0, 40.0, 51.0, 50.0, 120.0, 40.0, 70.0, 80.0, 30.0, -30.0, 10.0, 260.0, -7.0, 40.0, 168.0, 150.0, 10.0, 10.0, 29.0, 170.0, 39.0, 70.0, 0.0, 38.0, 15.0, 27.0, 126.0, 90.0, 54.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9814410124092938, "mean_inference_ms": 2.270317201365961, "mean_action_processing_ms": 0.7635285986481171, "mean_env_wait_ms": 1.585803691200688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06019091606140137, "StateBufferConnector_ms": 0.009782075881958008, "ViewRequirementAgentConnector_ms": 0.43950748443603516}, "num_episodes": 23, "episode_return_max": 1484.0, "episode_return_min": 255.0, "episode_return_mean": 731.27, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 24.89042951762022, "num_env_steps_trained_throughput_per_sec": 24.89042951762022, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 3640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3640000, "timers": {"training_iteration_time_ms": 127004.339, "restore_workers_time_ms": 0.013, "training_step_time_ms": 127004.287, "sample_time_ms": 3221.922, "learn_time_ms": 123760.424, "learn_throughput": 32.321, "synch_weights_time_ms": 12.338}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "done": false, "training_iteration": 91, "trial_id": "6085c_00000", "date": "2024-07-02_02-04-06", "timestamp": 1719900246, "time_this_iter_s": 160.7360713481903, "time_total_s": 13092.805107355118, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13092.805107355118, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 42.66728110599078, "ram_util_percent": 81.48663594470045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.908672291484758, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.022812962100402, "policy_loss": -0.0051541710523610755, "vf_loss": 7.027101414246808, "vf_explained_var": 0.0009573219619746914, "kl": 0.008657209495736574, "entropy": 0.6732186935008905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 859185.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "env_runners": {"episode_reward_max": 1484.0, "episode_reward_min": 272.0, "episode_reward_mean": 713.83, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -171.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 71.383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [961.0, 685.0, 588.0, 430.0, 519.0, 1103.0, 954.0, 707.0, 1209.0, 1184.0, 818.0, 578.0, 859.0, 644.0, 560.0, 508.0, 472.0, 531.0, 506.0, 654.0, 1082.0, 958.0, 588.0, 611.0, 543.0, 749.0, 504.0, 1190.0, 748.0, 687.0, 558.0, 283.0, 1390.0, 735.0, 671.0, 1305.0, 1484.0, 682.0, 610.0, 853.0, 968.0, 592.0, 641.0, 679.0, 544.0, 698.0, 1084.0, 593.0, 331.0, 411.0, 676.0, 800.0, 1197.0, 530.0, 617.0, 768.0, 531.0, 696.0, 641.0, 984.0, 430.0, 764.0, 658.0, 734.0, 878.0, 897.0, 352.0, 371.0, 675.0, 806.0, 755.0, 820.0, 706.0, 949.0, 949.0, 839.0, 626.0, 677.0, 729.0, 927.0, 640.0, 629.0, 407.0, 904.0, 695.0, 757.0, 728.0, 500.0, 529.0, 558.0, 496.0, 699.0, 637.0, 869.0, 373.0, 272.0, 475.0, 881.0, 665.0, 445.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [51.0, 59.0, 50.0, -30.0, 70.0, 49.0, 30.0, 50.0, 32.0, 600.0, 89.0, 60.0, 40.0, 31.0, 50.0, 60.0, 180.0, 35.0, 100.0, 40.0, 80.0, 120.0, 44.0, 70.0, 59.0, 60.0, 41.0, 59.0, 25.0, 30.0, -2.0, 30.0, 30.0, -45.0, 138.0, 19.0, 60.0, 40.0, 100.0, 60.0, 80.0, 77.0, 59.0, 20.0, -17.0, 48.0, 10.0, 60.0, 162.0, 20.0, 130.0, 107.0, 95.0, 80.0, 50.0, 57.0, 62.0, 210.0, 285.0, 27.0, 120.0, 70.0, -20.0, 54.0, 190.0, 30.0, 100.0, 300.0, 60.0, 50.0, 13.0, 50.0, 60.0, 70.0, 130.0, 110.0, 100.0, 82.0, 90.0, 2.0, 110.0, 50.0, 80.0, 160.0, 100.0, 41.0, 40.0, 530.0, 38.0, 60.0, 170.0, 99.0, 172.0, 180.0, 69.0, 60.0, 54.0, 20.0, 240.0, 120.0, 139.0, 110.0, -34.0, 170.0, 310.0, -13.0, 27.0, 20.0, 39.0, 50.0, 39.0, 40.0, 28.0, 56.0, 38.0, 109.0, 112.0, 0.0, 56.0, 100.0, 57.0, 50.0, 57.0, 100.0, 158.0, 179.0, 22.0, 67.0, 100.0, 69.0, 160.0, 15.0, 0.0, 20.0, 200.0, 20.0, 49.0, 50.0, 90.0, 40.0, 20.0, -15.0, 160.0, 29.0, 39.0, 30.0, 60.0, 150.0, 72.0, 15.0, 70.0, 60.0, 20.0, 100.0, 60.0, 19.0, 30.0, 100.0, 40.0, 9.0, 10.0, 50.0, 65.0, 50.0, 70.0, -171.0, 120.0, 100.0, 158.0, 20.0, 75.0, 178.0, 40.0, -10.0, -4.0, 74.0, 50.0, 49.0, 29.0, 50.0, 10.0, 50.0, 19.0, 30.0, 60.0, 100.0, 70.0, 21.0, 10.0, 136.0, 50.0, 160.0, 50.0, 160.0, 29.0, 70.0, 16.0, 59.0, 36.0, 24.0, 69.0, 80.0, 60.0, 600.0, 100.0, 40.0, 50.0, 60.0, -35.0, 58.0, 20.0, 110.0, 60.0, 180.0, 370.0, 130.0, 40.0, -102.0, 80.0, 70.0, 35.0, 60.0, 100.0, 60.0, 70.0, 49.0, 40.0, 30.0, 150.0, -6.0, 200.0, 119.0, 40.0, 90.0, 45.0, 60.0, -4.0, 30.0, 30.0, 1.0, 34.0, -94.0, 180.0, 225.0, 19.0, 100.0, 36.0, -16.0, 49.0, 10.0, 26.0, 90.0, 60.0, 90.0, 58.0, 120.0, 70.0, 65.0, 165.0, 5.0, 90.0, 59.0, 16.0, 60.0, 60.0, 50.0, 14.0, 60.0, 80.0, 15.0, 67.0, 138.0, 110.0, 120.0, 70.0, 209.0, 67.0, 39.0, 310.0, 60.0, 120.0, 50.0, 50.0, 100.0, 100.0, 128.0, 50.0, 150.0, 0.0, 0.0, 60.0, 90.0, 68.0, 66.0, 80.0, 70.0, 56.0, 60.0, 70.0, 67.0, 3.0, 180.0, 100.0, 16.0, 20.0, 32.0, 20.0, 150.0, 30.0, 7.0, 0.0, 50.0, 0.0, 20.0, 85.0, -2.0, -8.0, 29.0, 50.0, 59.0, 50.0, 110.0, 60.0, 100.0, 100.0, 70.0, -30.0, 30.0, 820.0, 80.0, 87.0, 70.0, 150.0, 86.0, 20.0, 50.0, 70.0, 84.0, 70.0, 48.0, 30.0, 100.0, 30.0, 22.0, 30.0, 39.0, 50.0, 90.0, 80.0, 200.0, -10.0, 410.0, 170.0, 160.0, 70.0, 35.0, 80.0, 20.0, 320.0, 50.0, 97.0, 40.0, 510.0, 97.0, 50.0, 60.0, 380.0, 80.0, 90.0, 80.0, 65.0, 60.0, 150.0, 64.0, 80.0, 20.0, 50.0, 10.0, 33.0, 150.0, 100.0, 100.0, 50.0, 30.0, 70.0, 30.0, 60.0, 20.0, 50.0, 100.0, 98.0, 165.0, 119.0, -13.0, 70.0, 80.0, 190.0, 110.0, 0.0, 34.0, 343.0, 70.0, 50.0, 110.0, 70.0, 120.0, 60.0, 40.0, 35.0, 70.0, 50.0, 48.0, 37.0, -55.0, 50.0, 60.0, 213.0, 120.0, 29.0, 40.0, 57.0, 76.0, 160.0, 50.0, 40.0, 70.0, -2.0, 30.0, 70.0, 90.0, 40.0, 30.0, 59.0, 30.0, 30.0, 80.0, 170.0, 20.0, 50.0, 170.0, 60.0, 10.0, 80.0, 69.0, 109.0, 70.0, 49.0, 40.0, 30.0, 27.0, 79.0, 119.0, 40.0, 50.0, 40.0, 50.0, 50.0, 80.0, 70.0, 120.0, 28.0, 270.0, 70.0, 259.0, 50.0, 20.0, 60.0, 47.0, 230.0, 50.0, 70.0, 50.0, 60.0, 170.0, 110.0, -2.0, 25.0, 20.0, -40.0, 130.0, 170.0, 12.0, 37.0, 17.0, 10.0, 14.0, 7.0, 44.0, 21.0, -1.0, 10.0, 98.0, 20.0, 60.0, 80.0, 30.0, 35.0, 10.0, 50.0, 18.0, -51.0, -30.0, 10.0, 90.0, 300.0, 100.0, 60.0, 67.0, 50.0, 80.0, 40.0, 220.0, 190.0, 40.0, -31.0, 75.0, 72.0, 158.0, 66.0, -30.0, 49.0, 30.0, 68.0, 40.0, 80.0, 280.0, 110.0, 330.0, 90.0, 120.0, 50.0, 50.0, 70.0, 60.0, 70.0, 70.0, 10.0, 80.0, 20.0, 50.0, 60.0, 10.0, 20.0, 80.0, 180.0, 38.0, 29.0, 100.0, 70.0, 30.0, 27.0, 80.0, 186.0, 300.0, 120.0, 35.0, 28.0, -58.0, 20.0, 30.0, 40.0, 2.0, -7.0, -4.0, 90.0, 190.0, 90.0, 40.0, 10.0, 80.0, 50.0, 24.0, 67.0, 76.0, 100.0, 10.0, 40.0, 189.0, 20.0, 120.0, 60.0, 25.0, 29.0, 170.0, 20.0, 100.0, 60.0, 10.0, 130.0, 37.0, 50.0, 300.0, 70.0, 50.0, 70.0, 80.0, -13.0, 100.0, 157.0, 120.0, 84.0, 34.0, 16.0, -4.0, 60.0, 20.0, 40.0, 100.0, 30.0, 50.0, 457.0, 20.0, 45.0, 10.0, 37.0, 30.0, 110.0, 90.0, 5.0, -40.0, 60.0, 40.0, 110.0, 40.0, 60.0, 100.0, 59.0, 90.0, 60.0, 39.0, 160.0, 54.0, 80.0, 100.0, 50.0, 50.0, 70.0, 1.0, 70.0, 99.0, 90.0, 90.0, -30.0, 500.0, 99.0, -70.0, 49.0, 70.0, 30.0, 50.0, 40.0, 80.0, 170.0, 60.0, 180.0, 70.0, 79.0, 68.0, 60.0, 90.0, 30.0, -48.0, 30.0, 50.0, 40.0, 20.0, 20.0, 10.0, 170.0, 30.0, 26.0, -48.0, 10.0, 28.0, 38.0, 14.0, 64.0, 134.0, 35.0, 70.0, 60.0, 110.0, 88.0, 60.0, 60.0, 60.0, 34.0, 64.0, 79.0, 60.0, 90.0, 77.0, 110.0, 20.0, 210.0, 8.0, -59.0, 230.0, 40.0, 80.0, 184.0, -28.0, 55.0, 7.0, 24.0, 110.0, 270.0, 55.0, 43.0, 35.0, -40.0, 120.0, 166.0, 55.0, 70.0, 100.0, 185.0, 70.0, 44.0, 50.0, 50.0, 63.0, 15.0, 110.0, 100.0, 110.0, 70.0, 57.0, 54.0, 77.0, 98.0, 30.0, 60.0, 100.0, 380.0, 30.0, 11.0, -40.0, 190.0, 90.0, 80.0, -35.0, 185.0, 370.0, 30.0, 100.0, 19.0, 120.0, 70.0, 10.0, 100.0, 140.0, 80.0, 40.0, 40.0, 37.0, 120.0, 120.0, 56.0, 106.0, 20.0, 10.0, 73.0, 50.0, 49.0, 46.0, 167.0, 110.0, 81.0, 20.0, 120.0, 110.0, 40.0, 76.0, 55.0, 50.0, 10.0, 66.0, 90.0, 60.0, 67.0, 170.0, 100.0, 49.0, 50.0, 37.0, 40.0, 140.0, 16.0, 60.0, 86.0, 360.0, 40.0, 51.0, 50.0, 120.0, 40.0, 70.0, 80.0, 30.0, -30.0, 10.0, 260.0, -7.0, 40.0, 168.0, 150.0, 10.0, 10.0, 29.0, 170.0, 39.0, 70.0, 0.0, 38.0, 15.0, 27.0, 126.0, 90.0, 54.0, 19.0, 90.0, 20.0, 30.0, 40.0, 60.0, 78.0, 40.0, 10.0, 20.0, 270.0, 70.0, 3.0, 50.0, 30.0, 50.0, 32.0, 100.0, 250.0, 49.0, 30.0, 50.0, 45.0, 50.0, 30.0, 30.0, 70.0, 200.0, 80.0, 110.0, 0.0, 70.0, 24.0, 60.0, 70.0, -50.0, 60.0, 470.0, -10.0, 63.0, 8.0, 28.0, 49.0, 265.0, 28.0, 60.0, 30.0, 174.0, -14.0, 100.0, 90.0, 100.0, 60.0, 20.0, 50.0, 20.0, -27.0, 57.0, 60.0, 70.0, 60.0, 10.0, 15.0, 70.0, 14.0, 70.0, 40.0, 180.0, 40.0, 30.0, 30.0, 100.0, 30.0, 52.0, 30.0, 46.0, 58.0, 32.0, 100.0, 80.0, 23.0, 36.0, -5.0, -3.0, 160.0, 10.0, 110.0, 105.0, 40.0, 20.0, 90.0, 20.0, 80.0, 59.0, 30.0, 70.0, 30.0, 90.0, 160.0, 70.0, 236.0, 70.0, 80.0, -38.0, 60.0, 38.0, 38.0, 60.0, 43.0, 50.0, 110.0, 90.0, 34.0, 100.0, 110.0, 120.0, 60.0, 70.0, 75.0, 100.0, 50.0, 110.0, 0.0, -50.0, 49.0, 69.0, 80.0, 10.0, 60.0, -5.0, 8.0, 20.0, 30.0, -2.0, 10.0, 45.0, 0.0, 20.0, 131.0, 10.0, 20.0, 50.0, 30.0, 20.0, 90.0, 49.0, 140.0, 20.0, 39.0, 17.0, 0.0, 130.0, 3.0, 30.0, 40.0, 160.0, 180.0, 38.0, 50.0, 250.0, 16.0, 90.0, 119.0, 48.0, 90.0, 110.0, 80.0, 69.0, -47.0, 90.0, 36.0, 80.0, 40.0, 60.0, 3.0, 6.0, 70.0, 60.0, 60.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9772823410346774, "mean_inference_ms": 2.2657842097545755, "mean_action_processing_ms": 0.7624477784627062, "mean_env_wait_ms": 1.5827258696899553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060274362564086914, "StateBufferConnector_ms": 0.009581565856933594, "ViewRequirementAgentConnector_ms": 0.43131041526794434}, "num_episodes": 18, "episode_return_max": 1484.0, "episode_return_min": 272.0, "episode_return_mean": 713.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.94758653925071, "num_env_steps_trained_throughput_per_sec": 31.94758653925071, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 3680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3680000, "timers": {"training_iteration_time_ms": 127230.559, "restore_workers_time_ms": 0.013, "training_step_time_ms": 127230.507, "sample_time_ms": 3286.889, "learn_time_ms": 123921.545, "learn_throughput": 32.278, "synch_weights_time_ms": 12.454}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "done": false, "training_iteration": 92, "trial_id": "6085c_00000", "date": "2024-07-02_02-06-11", "timestamp": 1719900371, "time_this_iter_s": 125.2179970741272, "time_total_s": 13218.023104429245, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9138dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13218.023104429245, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 22.028813559322032, "ram_util_percent": 80.30338983050848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.709842176216479, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.304680516646185, "policy_loss": -0.006416137169769353, "vf_loss": 7.310221318010324, "vf_explained_var": -6.437251489129437e-05, "kl": 0.008753317233877227, "entropy": 0.6712541975057164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 868575.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "env_runners": {"episode_reward_max": 1484.0, "episode_reward_min": 272.0, "episode_reward_mean": 710.11, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -102.0}, "policy_reward_max": {"policy_0": 820.0}, "policy_reward_mean": {"policy_0": 71.011}, "custom_metrics": {}, "hist_stats": {"episode_reward": [506.0, 654.0, 1082.0, 958.0, 588.0, 611.0, 543.0, 749.0, 504.0, 1190.0, 748.0, 687.0, 558.0, 283.0, 1390.0, 735.0, 671.0, 1305.0, 1484.0, 682.0, 610.0, 853.0, 968.0, 592.0, 641.0, 679.0, 544.0, 698.0, 1084.0, 593.0, 331.0, 411.0, 676.0, 800.0, 1197.0, 530.0, 617.0, 768.0, 531.0, 696.0, 641.0, 984.0, 430.0, 764.0, 658.0, 734.0, 878.0, 897.0, 352.0, 371.0, 675.0, 806.0, 755.0, 820.0, 706.0, 949.0, 949.0, 839.0, 626.0, 677.0, 729.0, 927.0, 640.0, 629.0, 407.0, 904.0, 695.0, 757.0, 728.0, 500.0, 529.0, 558.0, 496.0, 699.0, 637.0, 869.0, 373.0, 272.0, 475.0, 881.0, 665.0, 445.0, 992.0, 475.0, 526.0, 787.0, 590.0, 895.0, 1030.0, 500.0, 994.0, 892.0, 500.0, 681.0, 860.0, 537.0, 612.0, 568.0, 547.0, 952.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 50.0, 19.0, 30.0, 60.0, 100.0, 70.0, 21.0, 10.0, 136.0, 50.0, 160.0, 50.0, 160.0, 29.0, 70.0, 16.0, 59.0, 36.0, 24.0, 69.0, 80.0, 60.0, 600.0, 100.0, 40.0, 50.0, 60.0, -35.0, 58.0, 20.0, 110.0, 60.0, 180.0, 370.0, 130.0, 40.0, -102.0, 80.0, 70.0, 35.0, 60.0, 100.0, 60.0, 70.0, 49.0, 40.0, 30.0, 150.0, -6.0, 200.0, 119.0, 40.0, 90.0, 45.0, 60.0, -4.0, 30.0, 30.0, 1.0, 34.0, -94.0, 180.0, 225.0, 19.0, 100.0, 36.0, -16.0, 49.0, 10.0, 26.0, 90.0, 60.0, 90.0, 58.0, 120.0, 70.0, 65.0, 165.0, 5.0, 90.0, 59.0, 16.0, 60.0, 60.0, 50.0, 14.0, 60.0, 80.0, 15.0, 67.0, 138.0, 110.0, 120.0, 70.0, 209.0, 67.0, 39.0, 310.0, 60.0, 120.0, 50.0, 50.0, 100.0, 100.0, 128.0, 50.0, 150.0, 0.0, 0.0, 60.0, 90.0, 68.0, 66.0, 80.0, 70.0, 56.0, 60.0, 70.0, 67.0, 3.0, 180.0, 100.0, 16.0, 20.0, 32.0, 20.0, 150.0, 30.0, 7.0, 0.0, 50.0, 0.0, 20.0, 85.0, -2.0, -8.0, 29.0, 50.0, 59.0, 50.0, 110.0, 60.0, 100.0, 100.0, 70.0, -30.0, 30.0, 820.0, 80.0, 87.0, 70.0, 150.0, 86.0, 20.0, 50.0, 70.0, 84.0, 70.0, 48.0, 30.0, 100.0, 30.0, 22.0, 30.0, 39.0, 50.0, 90.0, 80.0, 200.0, -10.0, 410.0, 170.0, 160.0, 70.0, 35.0, 80.0, 20.0, 320.0, 50.0, 97.0, 40.0, 510.0, 97.0, 50.0, 60.0, 380.0, 80.0, 90.0, 80.0, 65.0, 60.0, 150.0, 64.0, 80.0, 20.0, 50.0, 10.0, 33.0, 150.0, 100.0, 100.0, 50.0, 30.0, 70.0, 30.0, 60.0, 20.0, 50.0, 100.0, 98.0, 165.0, 119.0, -13.0, 70.0, 80.0, 190.0, 110.0, 0.0, 34.0, 343.0, 70.0, 50.0, 110.0, 70.0, 120.0, 60.0, 40.0, 35.0, 70.0, 50.0, 48.0, 37.0, -55.0, 50.0, 60.0, 213.0, 120.0, 29.0, 40.0, 57.0, 76.0, 160.0, 50.0, 40.0, 70.0, -2.0, 30.0, 70.0, 90.0, 40.0, 30.0, 59.0, 30.0, 30.0, 80.0, 170.0, 20.0, 50.0, 170.0, 60.0, 10.0, 80.0, 69.0, 109.0, 70.0, 49.0, 40.0, 30.0, 27.0, 79.0, 119.0, 40.0, 50.0, 40.0, 50.0, 50.0, 80.0, 70.0, 120.0, 28.0, 270.0, 70.0, 259.0, 50.0, 20.0, 60.0, 47.0, 230.0, 50.0, 70.0, 50.0, 60.0, 170.0, 110.0, -2.0, 25.0, 20.0, -40.0, 130.0, 170.0, 12.0, 37.0, 17.0, 10.0, 14.0, 7.0, 44.0, 21.0, -1.0, 10.0, 98.0, 20.0, 60.0, 80.0, 30.0, 35.0, 10.0, 50.0, 18.0, -51.0, -30.0, 10.0, 90.0, 300.0, 100.0, 60.0, 67.0, 50.0, 80.0, 40.0, 220.0, 190.0, 40.0, -31.0, 75.0, 72.0, 158.0, 66.0, -30.0, 49.0, 30.0, 68.0, 40.0, 80.0, 280.0, 110.0, 330.0, 90.0, 120.0, 50.0, 50.0, 70.0, 60.0, 70.0, 70.0, 10.0, 80.0, 20.0, 50.0, 60.0, 10.0, 20.0, 80.0, 180.0, 38.0, 29.0, 100.0, 70.0, 30.0, 27.0, 80.0, 186.0, 300.0, 120.0, 35.0, 28.0, -58.0, 20.0, 30.0, 40.0, 2.0, -7.0, -4.0, 90.0, 190.0, 90.0, 40.0, 10.0, 80.0, 50.0, 24.0, 67.0, 76.0, 100.0, 10.0, 40.0, 189.0, 20.0, 120.0, 60.0, 25.0, 29.0, 170.0, 20.0, 100.0, 60.0, 10.0, 130.0, 37.0, 50.0, 300.0, 70.0, 50.0, 70.0, 80.0, -13.0, 100.0, 157.0, 120.0, 84.0, 34.0, 16.0, -4.0, 60.0, 20.0, 40.0, 100.0, 30.0, 50.0, 457.0, 20.0, 45.0, 10.0, 37.0, 30.0, 110.0, 90.0, 5.0, -40.0, 60.0, 40.0, 110.0, 40.0, 60.0, 100.0, 59.0, 90.0, 60.0, 39.0, 160.0, 54.0, 80.0, 100.0, 50.0, 50.0, 70.0, 1.0, 70.0, 99.0, 90.0, 90.0, -30.0, 500.0, 99.0, -70.0, 49.0, 70.0, 30.0, 50.0, 40.0, 80.0, 170.0, 60.0, 180.0, 70.0, 79.0, 68.0, 60.0, 90.0, 30.0, -48.0, 30.0, 50.0, 40.0, 20.0, 20.0, 10.0, 170.0, 30.0, 26.0, -48.0, 10.0, 28.0, 38.0, 14.0, 64.0, 134.0, 35.0, 70.0, 60.0, 110.0, 88.0, 60.0, 60.0, 60.0, 34.0, 64.0, 79.0, 60.0, 90.0, 77.0, 110.0, 20.0, 210.0, 8.0, -59.0, 230.0, 40.0, 80.0, 184.0, -28.0, 55.0, 7.0, 24.0, 110.0, 270.0, 55.0, 43.0, 35.0, -40.0, 120.0, 166.0, 55.0, 70.0, 100.0, 185.0, 70.0, 44.0, 50.0, 50.0, 63.0, 15.0, 110.0, 100.0, 110.0, 70.0, 57.0, 54.0, 77.0, 98.0, 30.0, 60.0, 100.0, 380.0, 30.0, 11.0, -40.0, 190.0, 90.0, 80.0, -35.0, 185.0, 370.0, 30.0, 100.0, 19.0, 120.0, 70.0, 10.0, 100.0, 140.0, 80.0, 40.0, 40.0, 37.0, 120.0, 120.0, 56.0, 106.0, 20.0, 10.0, 73.0, 50.0, 49.0, 46.0, 167.0, 110.0, 81.0, 20.0, 120.0, 110.0, 40.0, 76.0, 55.0, 50.0, 10.0, 66.0, 90.0, 60.0, 67.0, 170.0, 100.0, 49.0, 50.0, 37.0, 40.0, 140.0, 16.0, 60.0, 86.0, 360.0, 40.0, 51.0, 50.0, 120.0, 40.0, 70.0, 80.0, 30.0, -30.0, 10.0, 260.0, -7.0, 40.0, 168.0, 150.0, 10.0, 10.0, 29.0, 170.0, 39.0, 70.0, 0.0, 38.0, 15.0, 27.0, 126.0, 90.0, 54.0, 19.0, 90.0, 20.0, 30.0, 40.0, 60.0, 78.0, 40.0, 10.0, 20.0, 270.0, 70.0, 3.0, 50.0, 30.0, 50.0, 32.0, 100.0, 250.0, 49.0, 30.0, 50.0, 45.0, 50.0, 30.0, 30.0, 70.0, 200.0, 80.0, 110.0, 0.0, 70.0, 24.0, 60.0, 70.0, -50.0, 60.0, 470.0, -10.0, 63.0, 8.0, 28.0, 49.0, 265.0, 28.0, 60.0, 30.0, 174.0, -14.0, 100.0, 90.0, 100.0, 60.0, 20.0, 50.0, 20.0, -27.0, 57.0, 60.0, 70.0, 60.0, 10.0, 15.0, 70.0, 14.0, 70.0, 40.0, 180.0, 40.0, 30.0, 30.0, 100.0, 30.0, 52.0, 30.0, 46.0, 58.0, 32.0, 100.0, 80.0, 23.0, 36.0, -5.0, -3.0, 160.0, 10.0, 110.0, 105.0, 40.0, 20.0, 90.0, 20.0, 80.0, 59.0, 30.0, 70.0, 30.0, 90.0, 160.0, 70.0, 236.0, 70.0, 80.0, -38.0, 60.0, 38.0, 38.0, 60.0, 43.0, 50.0, 110.0, 90.0, 34.0, 100.0, 110.0, 120.0, 60.0, 70.0, 75.0, 100.0, 50.0, 110.0, 0.0, -50.0, 49.0, 69.0, 80.0, 10.0, 60.0, -5.0, 8.0, 20.0, 30.0, -2.0, 10.0, 45.0, 0.0, 20.0, 131.0, 10.0, 20.0, 50.0, 30.0, 20.0, 90.0, 49.0, 140.0, 20.0, 39.0, 17.0, 0.0, 130.0, 3.0, 30.0, 40.0, 160.0, 180.0, 38.0, 50.0, 250.0, 16.0, 90.0, 119.0, 48.0, 90.0, 110.0, 80.0, 69.0, -47.0, 90.0, 36.0, 80.0, 40.0, 60.0, 3.0, 6.0, 70.0, 60.0, 60.0, 30.0, 89.0, 49.0, 60.0, 100.0, 30.0, 30.0, 79.0, 75.0, 390.0, 90.0, 36.0, 50.0, 90.0, 32.0, 60.0, 89.0, 40.0, 19.0, 30.0, 29.0, 50.0, 90.0, 20.0, 20.0, 88.0, 70.0, -51.0, 59.0, 10.0, 170.0, 80.0, 106.0, 210.0, -5.0, 30.0, 50.0, 80.0, 100.0, 46.0, 90.0, -11.0, 50.0, -9.0, 300.0, 90.0, 30.0, 59.0, 70.0, 60.0, -49.0, 53.0, 178.0, 40.0, 308.0, 50.0, 50.0, 20.0, 49.0, 37.0, 110.0, 98.0, 60.0, 47.0, 33.0, 90.0, 119.0, 85.0, 230.0, 219.0, 49.0, 18.0, 3.0, 50.0, 70.0, 180.0, 79.0, 80.0, 50.0, -54.0, 24.0, 130.0, 90.0, 160.0, 49.0, -40.0, 53.0, 52.0, 100.0, 90.0, 310.0, 57.0, 100.0, 150.0, 89.0, 50.0, 70.0, 170.0, 80.0, 80.0, 46.0, 49.0, 86.0, 40.0, 50.0, 30.0, 40.0, 40.0, 90.0, -15.0, 90.0, 30.0, 80.0, -70.0, 70.0, 50.0, 170.0, 170.0, 25.0, 100.0, 56.0, 49.0, -34.0, -20.0, 220.0, 90.0, 330.0, 45.0, 30.0, 70.0, 80.0, 47.0, 49.0, 38.0, 36.0, 48.0, 50.0, 49.0, 120.0, 70.0, 30.0, 80.0, 50.0, 24.0, 100.0, 60.0, 60.0, 100.0, 58.0, 50.0, 30.0, 60.0, -40.0, 29.0, 30.0, 30.0, -11.0, -60.0, 30.0, 470.0, 30.0, 38.0, 50.0, 60.0, 21.0, 61.0, 40.0, 200.0, 40.0, -21.0, 58.0, 200.0, 34.0, 144.0, 28.0, 209.0, 27.0, 20.0, 40.0, 160.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9748863383693214, "mean_inference_ms": 2.2616443050620645, "mean_action_processing_ms": 0.7612293092382398, "mean_env_wait_ms": 1.5801851795340867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06316065788269043, "StateBufferConnector_ms": 0.009543418884277344, "ViewRequirementAgentConnector_ms": 0.4345414638519287}, "num_episodes": 18, "episode_return_max": 1484.0, "episode_return_min": 272.0, "episode_return_mean": 710.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.608303698600295, "num_env_steps_trained_throughput_per_sec": 32.608303698600295, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 3720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3720000, "timers": {"training_iteration_time_ms": 127174.754, "restore_workers_time_ms": 0.013, "training_step_time_ms": 127174.703, "sample_time_ms": 3308.495, "learn_time_ms": 123844.382, "learn_throughput": 32.299, "synch_weights_time_ms": 12.277}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "done": false, "training_iteration": 93, "trial_id": "6085c_00000", "date": "2024-07-02_02-08-14", "timestamp": 1719900494, "time_this_iter_s": 122.68110990524292, "time_total_s": 13340.704214334488, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b91793a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13340.704214334488, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 20.41149425287356, "ram_util_percent": 80.13793103448276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.882419000526333, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.295402831340623, "policy_loss": -0.00661115478827143, "vf_loss": 7.30114544847141, "vf_explained_var": 0.0007444204931188062, "kl": 0.008685391948319299, "entropy": 0.6714092951295729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 877965.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "env_runners": {"episode_reward_max": 1542.0, "episode_reward_min": 272.0, "episode_reward_mean": 706.76, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 70.676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [968.0, 592.0, 641.0, 679.0, 544.0, 698.0, 1084.0, 593.0, 331.0, 411.0, 676.0, 800.0, 1197.0, 530.0, 617.0, 768.0, 531.0, 696.0, 641.0, 984.0, 430.0, 764.0, 658.0, 734.0, 878.0, 897.0, 352.0, 371.0, 675.0, 806.0, 755.0, 820.0, 706.0, 949.0, 949.0, 839.0, 626.0, 677.0, 729.0, 927.0, 640.0, 629.0, 407.0, 904.0, 695.0, 757.0, 728.0, 500.0, 529.0, 558.0, 496.0, 699.0, 637.0, 869.0, 373.0, 272.0, 475.0, 881.0, 665.0, 445.0, 992.0, 475.0, 526.0, 787.0, 590.0, 895.0, 1030.0, 500.0, 994.0, 892.0, 500.0, 681.0, 860.0, 537.0, 612.0, 568.0, 547.0, 952.0, 579.0, 699.0, 740.0, 820.0, 1542.0, 560.0, 617.0, 646.0, 948.0, 710.0, 495.0, 753.0, 781.0, 690.0, 433.0, 317.0, 593.0, 1304.0, 1486.0, 1129.0, 742.0, 472.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [343.0, 70.0, 50.0, 110.0, 70.0, 120.0, 60.0, 40.0, 35.0, 70.0, 50.0, 48.0, 37.0, -55.0, 50.0, 60.0, 213.0, 120.0, 29.0, 40.0, 57.0, 76.0, 160.0, 50.0, 40.0, 70.0, -2.0, 30.0, 70.0, 90.0, 40.0, 30.0, 59.0, 30.0, 30.0, 80.0, 170.0, 20.0, 50.0, 170.0, 60.0, 10.0, 80.0, 69.0, 109.0, 70.0, 49.0, 40.0, 30.0, 27.0, 79.0, 119.0, 40.0, 50.0, 40.0, 50.0, 50.0, 80.0, 70.0, 120.0, 28.0, 270.0, 70.0, 259.0, 50.0, 20.0, 60.0, 47.0, 230.0, 50.0, 70.0, 50.0, 60.0, 170.0, 110.0, -2.0, 25.0, 20.0, -40.0, 130.0, 170.0, 12.0, 37.0, 17.0, 10.0, 14.0, 7.0, 44.0, 21.0, -1.0, 10.0, 98.0, 20.0, 60.0, 80.0, 30.0, 35.0, 10.0, 50.0, 18.0, -51.0, -30.0, 10.0, 90.0, 300.0, 100.0, 60.0, 67.0, 50.0, 80.0, 40.0, 220.0, 190.0, 40.0, -31.0, 75.0, 72.0, 158.0, 66.0, -30.0, 49.0, 30.0, 68.0, 40.0, 80.0, 280.0, 110.0, 330.0, 90.0, 120.0, 50.0, 50.0, 70.0, 60.0, 70.0, 70.0, 10.0, 80.0, 20.0, 50.0, 60.0, 10.0, 20.0, 80.0, 180.0, 38.0, 29.0, 100.0, 70.0, 30.0, 27.0, 80.0, 186.0, 300.0, 120.0, 35.0, 28.0, -58.0, 20.0, 30.0, 40.0, 2.0, -7.0, -4.0, 90.0, 190.0, 90.0, 40.0, 10.0, 80.0, 50.0, 24.0, 67.0, 76.0, 100.0, 10.0, 40.0, 189.0, 20.0, 120.0, 60.0, 25.0, 29.0, 170.0, 20.0, 100.0, 60.0, 10.0, 130.0, 37.0, 50.0, 300.0, 70.0, 50.0, 70.0, 80.0, -13.0, 100.0, 157.0, 120.0, 84.0, 34.0, 16.0, -4.0, 60.0, 20.0, 40.0, 100.0, 30.0, 50.0, 457.0, 20.0, 45.0, 10.0, 37.0, 30.0, 110.0, 90.0, 5.0, -40.0, 60.0, 40.0, 110.0, 40.0, 60.0, 100.0, 59.0, 90.0, 60.0, 39.0, 160.0, 54.0, 80.0, 100.0, 50.0, 50.0, 70.0, 1.0, 70.0, 99.0, 90.0, 90.0, -30.0, 500.0, 99.0, -70.0, 49.0, 70.0, 30.0, 50.0, 40.0, 80.0, 170.0, 60.0, 180.0, 70.0, 79.0, 68.0, 60.0, 90.0, 30.0, -48.0, 30.0, 50.0, 40.0, 20.0, 20.0, 10.0, 170.0, 30.0, 26.0, -48.0, 10.0, 28.0, 38.0, 14.0, 64.0, 134.0, 35.0, 70.0, 60.0, 110.0, 88.0, 60.0, 60.0, 60.0, 34.0, 64.0, 79.0, 60.0, 90.0, 77.0, 110.0, 20.0, 210.0, 8.0, -59.0, 230.0, 40.0, 80.0, 184.0, -28.0, 55.0, 7.0, 24.0, 110.0, 270.0, 55.0, 43.0, 35.0, -40.0, 120.0, 166.0, 55.0, 70.0, 100.0, 185.0, 70.0, 44.0, 50.0, 50.0, 63.0, 15.0, 110.0, 100.0, 110.0, 70.0, 57.0, 54.0, 77.0, 98.0, 30.0, 60.0, 100.0, 380.0, 30.0, 11.0, -40.0, 190.0, 90.0, 80.0, -35.0, 185.0, 370.0, 30.0, 100.0, 19.0, 120.0, 70.0, 10.0, 100.0, 140.0, 80.0, 40.0, 40.0, 37.0, 120.0, 120.0, 56.0, 106.0, 20.0, 10.0, 73.0, 50.0, 49.0, 46.0, 167.0, 110.0, 81.0, 20.0, 120.0, 110.0, 40.0, 76.0, 55.0, 50.0, 10.0, 66.0, 90.0, 60.0, 67.0, 170.0, 100.0, 49.0, 50.0, 37.0, 40.0, 140.0, 16.0, 60.0, 86.0, 360.0, 40.0, 51.0, 50.0, 120.0, 40.0, 70.0, 80.0, 30.0, -30.0, 10.0, 260.0, -7.0, 40.0, 168.0, 150.0, 10.0, 10.0, 29.0, 170.0, 39.0, 70.0, 0.0, 38.0, 15.0, 27.0, 126.0, 90.0, 54.0, 19.0, 90.0, 20.0, 30.0, 40.0, 60.0, 78.0, 40.0, 10.0, 20.0, 270.0, 70.0, 3.0, 50.0, 30.0, 50.0, 32.0, 100.0, 250.0, 49.0, 30.0, 50.0, 45.0, 50.0, 30.0, 30.0, 70.0, 200.0, 80.0, 110.0, 0.0, 70.0, 24.0, 60.0, 70.0, -50.0, 60.0, 470.0, -10.0, 63.0, 8.0, 28.0, 49.0, 265.0, 28.0, 60.0, 30.0, 174.0, -14.0, 100.0, 90.0, 100.0, 60.0, 20.0, 50.0, 20.0, -27.0, 57.0, 60.0, 70.0, 60.0, 10.0, 15.0, 70.0, 14.0, 70.0, 40.0, 180.0, 40.0, 30.0, 30.0, 100.0, 30.0, 52.0, 30.0, 46.0, 58.0, 32.0, 100.0, 80.0, 23.0, 36.0, -5.0, -3.0, 160.0, 10.0, 110.0, 105.0, 40.0, 20.0, 90.0, 20.0, 80.0, 59.0, 30.0, 70.0, 30.0, 90.0, 160.0, 70.0, 236.0, 70.0, 80.0, -38.0, 60.0, 38.0, 38.0, 60.0, 43.0, 50.0, 110.0, 90.0, 34.0, 100.0, 110.0, 120.0, 60.0, 70.0, 75.0, 100.0, 50.0, 110.0, 0.0, -50.0, 49.0, 69.0, 80.0, 10.0, 60.0, -5.0, 8.0, 20.0, 30.0, -2.0, 10.0, 45.0, 0.0, 20.0, 131.0, 10.0, 20.0, 50.0, 30.0, 20.0, 90.0, 49.0, 140.0, 20.0, 39.0, 17.0, 0.0, 130.0, 3.0, 30.0, 40.0, 160.0, 180.0, 38.0, 50.0, 250.0, 16.0, 90.0, 119.0, 48.0, 90.0, 110.0, 80.0, 69.0, -47.0, 90.0, 36.0, 80.0, 40.0, 60.0, 3.0, 6.0, 70.0, 60.0, 60.0, 30.0, 89.0, 49.0, 60.0, 100.0, 30.0, 30.0, 79.0, 75.0, 390.0, 90.0, 36.0, 50.0, 90.0, 32.0, 60.0, 89.0, 40.0, 19.0, 30.0, 29.0, 50.0, 90.0, 20.0, 20.0, 88.0, 70.0, -51.0, 59.0, 10.0, 170.0, 80.0, 106.0, 210.0, -5.0, 30.0, 50.0, 80.0, 100.0, 46.0, 90.0, -11.0, 50.0, -9.0, 300.0, 90.0, 30.0, 59.0, 70.0, 60.0, -49.0, 53.0, 178.0, 40.0, 308.0, 50.0, 50.0, 20.0, 49.0, 37.0, 110.0, 98.0, 60.0, 47.0, 33.0, 90.0, 119.0, 85.0, 230.0, 219.0, 49.0, 18.0, 3.0, 50.0, 70.0, 180.0, 79.0, 80.0, 50.0, -54.0, 24.0, 130.0, 90.0, 160.0, 49.0, -40.0, 53.0, 52.0, 100.0, 90.0, 310.0, 57.0, 100.0, 150.0, 89.0, 50.0, 70.0, 170.0, 80.0, 80.0, 46.0, 49.0, 86.0, 40.0, 50.0, 30.0, 40.0, 40.0, 90.0, -15.0, 90.0, 30.0, 80.0, -70.0, 70.0, 50.0, 170.0, 170.0, 25.0, 100.0, 56.0, 49.0, -34.0, -20.0, 220.0, 90.0, 330.0, 45.0, 30.0, 70.0, 80.0, 47.0, 49.0, 38.0, 36.0, 48.0, 50.0, 49.0, 120.0, 70.0, 30.0, 80.0, 50.0, 24.0, 100.0, 60.0, 60.0, 100.0, 58.0, 50.0, 30.0, 60.0, -40.0, 29.0, 30.0, 30.0, -11.0, -60.0, 30.0, 470.0, 30.0, 38.0, 50.0, 60.0, 21.0, 61.0, 40.0, 200.0, 40.0, -21.0, 58.0, 200.0, 34.0, 144.0, 28.0, 209.0, 27.0, 20.0, 40.0, 160.0, 90.0, 60.0, -15.0, 70.0, 40.0, 176.0, -2.0, 45.0, 45.0, 60.0, 100.0, 170.0, 70.0, 160.0, 70.0, 70.0, 70.0, -30.0, 60.0, 25.0, 34.0, 81.0, 50.0, 100.0, 49.0, 60.0, 70.0, 70.0, 80.0, 70.0, 110.0, 10.0, 58.0, 160.0, 39.0, 70.0, 79.0, 76.0, 130.0, 160.0, 38.0, 10.0, 598.0, 270.0, 42.0, 205.0, 48.0, 120.0, 90.0, 90.0, 69.0, -10.0, -20.0, 60.0, 90.0, 20.0, 60.0, 200.0, 50.0, 70.0, 40.0, 94.0, 50.0, 40.0, 110.0, 28.0, 70.0, 20.0, 14.0, 21.0, 170.0, 20.0, 80.0, 60.0, 70.0, 3.0, 180.0, 60.0, 90.0, 80.0, 3.0, -91.0, 41.0, 630.0, 80.0, 70.0, 61.0, 80.0, 40.0, 39.0, -2.0, 40.0, 70.0, 110.0, 20.0, 160.0, 50.0, 60.0, 60.0, 40.0, 100.0, 60.0, 63.0, 82.0, -19.0, 50.0, 40.0, 80.0, 80.0, 10.0, 49.0, 90.0, 100.0, 70.0, 28.0, 30.0, 60.0, 100.0, 55.0, 190.0, 30.0, 78.0, 60.0, 70.0, 90.0, 90.0, 100.0, 53.0, 70.0, 50.0, 120.0, 50.0, 359.0, 60.0, -130.0, 90.0, 157.0, 50.0, 42.0, 12.0, 0.0, 40.0, 28.0, 50.0, 100.0, 20.0, 65.0, 0.0, 90.0, 10.0, 30.0, 110.0, 38.0, 49.0, -120.0, 80.0, 14.0, 57.0, -160.0, 59.0, 190.0, -22.0, 90.0, 27.0, 57.0, 60.0, 170.0, 6.0, 120.0, 70.0, 15.0, 210.0, 70.0, 510.0, 110.0, 50.0, 120.0, 49.0, 25.0, 60.0, 100.0, 110.0, -10.0, 90.0, 240.0, 310.0, 47.0, 390.0, 91.0, 68.0, 150.0, 50.0, 50.0, 159.0, 60.0, 100.0, 140.0, 90.0, 160.0, 150.0, 170.0, 31.0, 70.0, 50.0, 110.0, 30.0, 90.0, 87.0, 128.0, 70.0, 76.0, 40.0, 68.0, 49.0, 45.0, 84.0, 70.0, 20.0, 69.0, 10.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9721564287025115, "mean_inference_ms": 2.2566837942186866, "mean_action_processing_ms": 0.7598168077073574, "mean_env_wait_ms": 1.577234675138057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0625753402709961, "StateBufferConnector_ms": 0.009407758712768555, "ViewRequirementAgentConnector_ms": 0.4311859607696533}, "num_episodes": 22, "episode_return_max": 1542.0, "episode_return_min": 272.0, "episode_return_mean": 706.76, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.440261361693196, "num_env_steps_trained_throughput_per_sec": 32.440261361693196, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 3760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3760000, "timers": {"training_iteration_time_ms": 127115.648, "restore_workers_time_ms": 0.013, "training_step_time_ms": 127115.596, "sample_time_ms": 3303.046, "learn_time_ms": 123790.598, "learn_throughput": 32.313, "synch_weights_time_ms": 12.505}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "done": false, "training_iteration": 94, "trial_id": "6085c_00000", "date": "2024-07-02_02-10-17", "timestamp": 1719900617, "time_this_iter_s": 123.31906914710999, "time_total_s": 13464.023283481598, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13800f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13464.023283481598, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 20.993678160919536, "ram_util_percent": 79.67758620689655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.183673463423793, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.164313315380369, "policy_loss": -0.006906546127344695, "vf_loss": 7.170270691283594, "vf_explained_var": 0.0017169625170060747, "kl": 0.009491679255966055, "entropy": 0.6891740512162352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 887355.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "env_runners": {"episode_reward_max": 1542.0, "episode_reward_min": 216.0, "episode_reward_mean": 701.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 70.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [641.0, 984.0, 430.0, 764.0, 658.0, 734.0, 878.0, 897.0, 352.0, 371.0, 675.0, 806.0, 755.0, 820.0, 706.0, 949.0, 949.0, 839.0, 626.0, 677.0, 729.0, 927.0, 640.0, 629.0, 407.0, 904.0, 695.0, 757.0, 728.0, 500.0, 529.0, 558.0, 496.0, 699.0, 637.0, 869.0, 373.0, 272.0, 475.0, 881.0, 665.0, 445.0, 992.0, 475.0, 526.0, 787.0, 590.0, 895.0, 1030.0, 500.0, 994.0, 892.0, 500.0, 681.0, 860.0, 537.0, 612.0, 568.0, 547.0, 952.0, 579.0, 699.0, 740.0, 820.0, 1542.0, 560.0, 617.0, 646.0, 948.0, 710.0, 495.0, 753.0, 781.0, 690.0, 433.0, 317.0, 593.0, 1304.0, 1486.0, 1129.0, 742.0, 472.0, 716.0, 551.0, 494.0, 477.0, 581.0, 919.0, 814.0, 1076.0, 720.0, 529.0, 852.0, 500.0, 694.0, 216.0, 863.0, 783.0, 711.0, 359.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 25.0, 29.0, 170.0, 20.0, 100.0, 60.0, 10.0, 130.0, 37.0, 50.0, 300.0, 70.0, 50.0, 70.0, 80.0, -13.0, 100.0, 157.0, 120.0, 84.0, 34.0, 16.0, -4.0, 60.0, 20.0, 40.0, 100.0, 30.0, 50.0, 457.0, 20.0, 45.0, 10.0, 37.0, 30.0, 110.0, 90.0, 5.0, -40.0, 60.0, 40.0, 110.0, 40.0, 60.0, 100.0, 59.0, 90.0, 60.0, 39.0, 160.0, 54.0, 80.0, 100.0, 50.0, 50.0, 70.0, 1.0, 70.0, 99.0, 90.0, 90.0, -30.0, 500.0, 99.0, -70.0, 49.0, 70.0, 30.0, 50.0, 40.0, 80.0, 170.0, 60.0, 180.0, 70.0, 79.0, 68.0, 60.0, 90.0, 30.0, -48.0, 30.0, 50.0, 40.0, 20.0, 20.0, 10.0, 170.0, 30.0, 26.0, -48.0, 10.0, 28.0, 38.0, 14.0, 64.0, 134.0, 35.0, 70.0, 60.0, 110.0, 88.0, 60.0, 60.0, 60.0, 34.0, 64.0, 79.0, 60.0, 90.0, 77.0, 110.0, 20.0, 210.0, 8.0, -59.0, 230.0, 40.0, 80.0, 184.0, -28.0, 55.0, 7.0, 24.0, 110.0, 270.0, 55.0, 43.0, 35.0, -40.0, 120.0, 166.0, 55.0, 70.0, 100.0, 185.0, 70.0, 44.0, 50.0, 50.0, 63.0, 15.0, 110.0, 100.0, 110.0, 70.0, 57.0, 54.0, 77.0, 98.0, 30.0, 60.0, 100.0, 380.0, 30.0, 11.0, -40.0, 190.0, 90.0, 80.0, -35.0, 185.0, 370.0, 30.0, 100.0, 19.0, 120.0, 70.0, 10.0, 100.0, 140.0, 80.0, 40.0, 40.0, 37.0, 120.0, 120.0, 56.0, 106.0, 20.0, 10.0, 73.0, 50.0, 49.0, 46.0, 167.0, 110.0, 81.0, 20.0, 120.0, 110.0, 40.0, 76.0, 55.0, 50.0, 10.0, 66.0, 90.0, 60.0, 67.0, 170.0, 100.0, 49.0, 50.0, 37.0, 40.0, 140.0, 16.0, 60.0, 86.0, 360.0, 40.0, 51.0, 50.0, 120.0, 40.0, 70.0, 80.0, 30.0, -30.0, 10.0, 260.0, -7.0, 40.0, 168.0, 150.0, 10.0, 10.0, 29.0, 170.0, 39.0, 70.0, 0.0, 38.0, 15.0, 27.0, 126.0, 90.0, 54.0, 19.0, 90.0, 20.0, 30.0, 40.0, 60.0, 78.0, 40.0, 10.0, 20.0, 270.0, 70.0, 3.0, 50.0, 30.0, 50.0, 32.0, 100.0, 250.0, 49.0, 30.0, 50.0, 45.0, 50.0, 30.0, 30.0, 70.0, 200.0, 80.0, 110.0, 0.0, 70.0, 24.0, 60.0, 70.0, -50.0, 60.0, 470.0, -10.0, 63.0, 8.0, 28.0, 49.0, 265.0, 28.0, 60.0, 30.0, 174.0, -14.0, 100.0, 90.0, 100.0, 60.0, 20.0, 50.0, 20.0, -27.0, 57.0, 60.0, 70.0, 60.0, 10.0, 15.0, 70.0, 14.0, 70.0, 40.0, 180.0, 40.0, 30.0, 30.0, 100.0, 30.0, 52.0, 30.0, 46.0, 58.0, 32.0, 100.0, 80.0, 23.0, 36.0, -5.0, -3.0, 160.0, 10.0, 110.0, 105.0, 40.0, 20.0, 90.0, 20.0, 80.0, 59.0, 30.0, 70.0, 30.0, 90.0, 160.0, 70.0, 236.0, 70.0, 80.0, -38.0, 60.0, 38.0, 38.0, 60.0, 43.0, 50.0, 110.0, 90.0, 34.0, 100.0, 110.0, 120.0, 60.0, 70.0, 75.0, 100.0, 50.0, 110.0, 0.0, -50.0, 49.0, 69.0, 80.0, 10.0, 60.0, -5.0, 8.0, 20.0, 30.0, -2.0, 10.0, 45.0, 0.0, 20.0, 131.0, 10.0, 20.0, 50.0, 30.0, 20.0, 90.0, 49.0, 140.0, 20.0, 39.0, 17.0, 0.0, 130.0, 3.0, 30.0, 40.0, 160.0, 180.0, 38.0, 50.0, 250.0, 16.0, 90.0, 119.0, 48.0, 90.0, 110.0, 80.0, 69.0, -47.0, 90.0, 36.0, 80.0, 40.0, 60.0, 3.0, 6.0, 70.0, 60.0, 60.0, 30.0, 89.0, 49.0, 60.0, 100.0, 30.0, 30.0, 79.0, 75.0, 390.0, 90.0, 36.0, 50.0, 90.0, 32.0, 60.0, 89.0, 40.0, 19.0, 30.0, 29.0, 50.0, 90.0, 20.0, 20.0, 88.0, 70.0, -51.0, 59.0, 10.0, 170.0, 80.0, 106.0, 210.0, -5.0, 30.0, 50.0, 80.0, 100.0, 46.0, 90.0, -11.0, 50.0, -9.0, 300.0, 90.0, 30.0, 59.0, 70.0, 60.0, -49.0, 53.0, 178.0, 40.0, 308.0, 50.0, 50.0, 20.0, 49.0, 37.0, 110.0, 98.0, 60.0, 47.0, 33.0, 90.0, 119.0, 85.0, 230.0, 219.0, 49.0, 18.0, 3.0, 50.0, 70.0, 180.0, 79.0, 80.0, 50.0, -54.0, 24.0, 130.0, 90.0, 160.0, 49.0, -40.0, 53.0, 52.0, 100.0, 90.0, 310.0, 57.0, 100.0, 150.0, 89.0, 50.0, 70.0, 170.0, 80.0, 80.0, 46.0, 49.0, 86.0, 40.0, 50.0, 30.0, 40.0, 40.0, 90.0, -15.0, 90.0, 30.0, 80.0, -70.0, 70.0, 50.0, 170.0, 170.0, 25.0, 100.0, 56.0, 49.0, -34.0, -20.0, 220.0, 90.0, 330.0, 45.0, 30.0, 70.0, 80.0, 47.0, 49.0, 38.0, 36.0, 48.0, 50.0, 49.0, 120.0, 70.0, 30.0, 80.0, 50.0, 24.0, 100.0, 60.0, 60.0, 100.0, 58.0, 50.0, 30.0, 60.0, -40.0, 29.0, 30.0, 30.0, -11.0, -60.0, 30.0, 470.0, 30.0, 38.0, 50.0, 60.0, 21.0, 61.0, 40.0, 200.0, 40.0, -21.0, 58.0, 200.0, 34.0, 144.0, 28.0, 209.0, 27.0, 20.0, 40.0, 160.0, 90.0, 60.0, -15.0, 70.0, 40.0, 176.0, -2.0, 45.0, 45.0, 60.0, 100.0, 170.0, 70.0, 160.0, 70.0, 70.0, 70.0, -30.0, 60.0, 25.0, 34.0, 81.0, 50.0, 100.0, 49.0, 60.0, 70.0, 70.0, 80.0, 70.0, 110.0, 10.0, 58.0, 160.0, 39.0, 70.0, 79.0, 76.0, 130.0, 160.0, 38.0, 10.0, 598.0, 270.0, 42.0, 205.0, 48.0, 120.0, 90.0, 90.0, 69.0, -10.0, -20.0, 60.0, 90.0, 20.0, 60.0, 200.0, 50.0, 70.0, 40.0, 94.0, 50.0, 40.0, 110.0, 28.0, 70.0, 20.0, 14.0, 21.0, 170.0, 20.0, 80.0, 60.0, 70.0, 3.0, 180.0, 60.0, 90.0, 80.0, 3.0, -91.0, 41.0, 630.0, 80.0, 70.0, 61.0, 80.0, 40.0, 39.0, -2.0, 40.0, 70.0, 110.0, 20.0, 160.0, 50.0, 60.0, 60.0, 40.0, 100.0, 60.0, 63.0, 82.0, -19.0, 50.0, 40.0, 80.0, 80.0, 10.0, 49.0, 90.0, 100.0, 70.0, 28.0, 30.0, 60.0, 100.0, 55.0, 190.0, 30.0, 78.0, 60.0, 70.0, 90.0, 90.0, 100.0, 53.0, 70.0, 50.0, 120.0, 50.0, 359.0, 60.0, -130.0, 90.0, 157.0, 50.0, 42.0, 12.0, 0.0, 40.0, 28.0, 50.0, 100.0, 20.0, 65.0, 0.0, 90.0, 10.0, 30.0, 110.0, 38.0, 49.0, -120.0, 80.0, 14.0, 57.0, -160.0, 59.0, 190.0, -22.0, 90.0, 27.0, 57.0, 60.0, 170.0, 6.0, 120.0, 70.0, 15.0, 210.0, 70.0, 510.0, 110.0, 50.0, 120.0, 49.0, 25.0, 60.0, 100.0, 110.0, -10.0, 90.0, 240.0, 310.0, 47.0, 390.0, 91.0, 68.0, 150.0, 50.0, 50.0, 159.0, 60.0, 100.0, 140.0, 90.0, 160.0, 150.0, 170.0, 31.0, 70.0, 50.0, 110.0, 30.0, 90.0, 87.0, 128.0, 70.0, 76.0, 40.0, 68.0, 49.0, 45.0, 84.0, 70.0, 20.0, 69.0, 10.0, 17.0, 32.0, 155.0, 70.0, 117.0, 30.0, 90.0, 90.0, 32.0, 50.0, 50.0, 40.0, 60.0, 19.0, 10.0, 98.0, 79.0, 15.0, 110.0, 50.0, 70.0, 10.0, 40.0, 60.0, 60.0, 30.0, 50.0, 35.0, 59.0, 80.0, 70.0, 170.0, -2.0, 90.0, 28.0, 70.0, 37.0, 20.0, 30.0, -2.0, 36.0, 146.0, 92.0, 8.0, 13.0, 57.0, 50.0, 61.0, 60.0, 68.0, 26.0, 169.0, 190.0, -10.0, 52.0, 90.0, 69.0, 170.0, 90.0, 70.0, 29.0, 216.0, 160.0, 121.0, 194.0, 70.0, -20.0, 80.0, 50.0, 70.0, -127.0, 15.0, 10.0, 186.0, 70.0, 220.0, 35.0, 30.0, 40.0, 60.0, 410.0, 90.0, 56.0, 64.0, 30.0, 60.0, 51.0, 140.0, 80.0, 140.0, 9.0, 40.0, 40.0, 20.0, 70.0, 60.0, 50.0, 19.0, 120.0, 50.0, 60.0, 164.0, 5.0, 26.0, 0.0, 110.0, 40.0, 187.0, 50.0, 220.0, 50.0, 60.0, 60.0, 60.0, 50.0, 40.0, 40.0, 70.0, 30.0, 40.0, 50.0, 0.0, 41.0, 69.0, 350.0, 30.0, -28.0, 44.0, 42.0, 29.0, 117.0, -85.0, 170.0, -37.0, -1.0, 50.0, -4.0, 3.0, 0.0, 60.0, 60.0, 62.0, 160.0, 180.0, 140.0, 60.0, 73.0, 56.0, 50.0, 48.0, 34.0, 70.0, 50.0, 50.0, 6.0, 430.0, 10.0, -25.0, 22.0, 90.0, 80.0, 37.0, 20.0, 70.0, 70.0, 70.0, 40.0, 180.0, 50.0, 160.0, 14.0, 25.0, 50.0, 10.0, 10.0, 60.0, 30.0, 39.0, 25.0, 70.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9696002731712952, "mean_inference_ms": 2.2524389286055277, "mean_action_processing_ms": 0.7584905610308273, "mean_env_wait_ms": 1.5748025435203667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06397581100463867, "StateBufferConnector_ms": 0.009555816650390625, "ViewRequirementAgentConnector_ms": 0.4390847682952881}, "num_episodes": 18, "episode_return_max": 1542.0, "episode_return_min": 216.0, "episode_return_mean": 701.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.65411520169025, "num_env_steps_trained_throughput_per_sec": 32.65411520169025, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 3800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3800000, "timers": {"training_iteration_time_ms": 126951.931, "restore_workers_time_ms": 0.012, "training_step_time_ms": 126951.879, "sample_time_ms": 3299.837, "learn_time_ms": 123630.047, "learn_throughput": 32.355, "synch_weights_time_ms": 12.67}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "done": false, "training_iteration": 95, "trial_id": "6085c_00000", "date": "2024-07-02_02-12-20", "timestamp": 1719900740, "time_this_iter_s": 122.50859999656677, "time_total_s": 13586.531883478165, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13586.531883478165, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 20.241618497109826, "ram_util_percent": 80.09768786127168}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7739540305508337, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.98985717319452, "policy_loss": -0.00667761584898334, "vf_loss": 6.995619658743357, "vf_explained_var": -0.0030455139307930066, "kl": 0.009151320411503095, "entropy": 0.6840771560026561, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 896745.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "env_runners": {"episode_reward_max": 1542.0, "episode_reward_min": -120.0, "episode_reward_mean": 678.03, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -630.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 67.803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [629.0, 407.0, 904.0, 695.0, 757.0, 728.0, 500.0, 529.0, 558.0, 496.0, 699.0, 637.0, 869.0, 373.0, 272.0, 475.0, 881.0, 665.0, 445.0, 992.0, 475.0, 526.0, 787.0, 590.0, 895.0, 1030.0, 500.0, 994.0, 892.0, 500.0, 681.0, 860.0, 537.0, 612.0, 568.0, 547.0, 952.0, 579.0, 699.0, 740.0, 820.0, 1542.0, 560.0, 617.0, 646.0, 948.0, 710.0, 495.0, 753.0, 781.0, 690.0, 433.0, 317.0, 593.0, 1304.0, 1486.0, 1129.0, 742.0, 472.0, 716.0, 551.0, 494.0, 477.0, 581.0, 919.0, 814.0, 1076.0, 720.0, 529.0, 852.0, 500.0, 694.0, 216.0, 863.0, 783.0, 711.0, 359.0, 1356.0, -120.0, 681.0, 686.0, 809.0, 671.0, 293.0, 577.0, 867.0, 573.0, 17.0, 867.0, 775.0, 422.0, 739.0, 531.0, 828.0, 464.0, 847.0, 674.0, 588.0, 731.0, 559.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 39.0, 70.0, 0.0, 38.0, 15.0, 27.0, 126.0, 90.0, 54.0, 19.0, 90.0, 20.0, 30.0, 40.0, 60.0, 78.0, 40.0, 10.0, 20.0, 270.0, 70.0, 3.0, 50.0, 30.0, 50.0, 32.0, 100.0, 250.0, 49.0, 30.0, 50.0, 45.0, 50.0, 30.0, 30.0, 70.0, 200.0, 80.0, 110.0, 0.0, 70.0, 24.0, 60.0, 70.0, -50.0, 60.0, 470.0, -10.0, 63.0, 8.0, 28.0, 49.0, 265.0, 28.0, 60.0, 30.0, 174.0, -14.0, 100.0, 90.0, 100.0, 60.0, 20.0, 50.0, 20.0, -27.0, 57.0, 60.0, 70.0, 60.0, 10.0, 15.0, 70.0, 14.0, 70.0, 40.0, 180.0, 40.0, 30.0, 30.0, 100.0, 30.0, 52.0, 30.0, 46.0, 58.0, 32.0, 100.0, 80.0, 23.0, 36.0, -5.0, -3.0, 160.0, 10.0, 110.0, 105.0, 40.0, 20.0, 90.0, 20.0, 80.0, 59.0, 30.0, 70.0, 30.0, 90.0, 160.0, 70.0, 236.0, 70.0, 80.0, -38.0, 60.0, 38.0, 38.0, 60.0, 43.0, 50.0, 110.0, 90.0, 34.0, 100.0, 110.0, 120.0, 60.0, 70.0, 75.0, 100.0, 50.0, 110.0, 0.0, -50.0, 49.0, 69.0, 80.0, 10.0, 60.0, -5.0, 8.0, 20.0, 30.0, -2.0, 10.0, 45.0, 0.0, 20.0, 131.0, 10.0, 20.0, 50.0, 30.0, 20.0, 90.0, 49.0, 140.0, 20.0, 39.0, 17.0, 0.0, 130.0, 3.0, 30.0, 40.0, 160.0, 180.0, 38.0, 50.0, 250.0, 16.0, 90.0, 119.0, 48.0, 90.0, 110.0, 80.0, 69.0, -47.0, 90.0, 36.0, 80.0, 40.0, 60.0, 3.0, 6.0, 70.0, 60.0, 60.0, 30.0, 89.0, 49.0, 60.0, 100.0, 30.0, 30.0, 79.0, 75.0, 390.0, 90.0, 36.0, 50.0, 90.0, 32.0, 60.0, 89.0, 40.0, 19.0, 30.0, 29.0, 50.0, 90.0, 20.0, 20.0, 88.0, 70.0, -51.0, 59.0, 10.0, 170.0, 80.0, 106.0, 210.0, -5.0, 30.0, 50.0, 80.0, 100.0, 46.0, 90.0, -11.0, 50.0, -9.0, 300.0, 90.0, 30.0, 59.0, 70.0, 60.0, -49.0, 53.0, 178.0, 40.0, 308.0, 50.0, 50.0, 20.0, 49.0, 37.0, 110.0, 98.0, 60.0, 47.0, 33.0, 90.0, 119.0, 85.0, 230.0, 219.0, 49.0, 18.0, 3.0, 50.0, 70.0, 180.0, 79.0, 80.0, 50.0, -54.0, 24.0, 130.0, 90.0, 160.0, 49.0, -40.0, 53.0, 52.0, 100.0, 90.0, 310.0, 57.0, 100.0, 150.0, 89.0, 50.0, 70.0, 170.0, 80.0, 80.0, 46.0, 49.0, 86.0, 40.0, 50.0, 30.0, 40.0, 40.0, 90.0, -15.0, 90.0, 30.0, 80.0, -70.0, 70.0, 50.0, 170.0, 170.0, 25.0, 100.0, 56.0, 49.0, -34.0, -20.0, 220.0, 90.0, 330.0, 45.0, 30.0, 70.0, 80.0, 47.0, 49.0, 38.0, 36.0, 48.0, 50.0, 49.0, 120.0, 70.0, 30.0, 80.0, 50.0, 24.0, 100.0, 60.0, 60.0, 100.0, 58.0, 50.0, 30.0, 60.0, -40.0, 29.0, 30.0, 30.0, -11.0, -60.0, 30.0, 470.0, 30.0, 38.0, 50.0, 60.0, 21.0, 61.0, 40.0, 200.0, 40.0, -21.0, 58.0, 200.0, 34.0, 144.0, 28.0, 209.0, 27.0, 20.0, 40.0, 160.0, 90.0, 60.0, -15.0, 70.0, 40.0, 176.0, -2.0, 45.0, 45.0, 60.0, 100.0, 170.0, 70.0, 160.0, 70.0, 70.0, 70.0, -30.0, 60.0, 25.0, 34.0, 81.0, 50.0, 100.0, 49.0, 60.0, 70.0, 70.0, 80.0, 70.0, 110.0, 10.0, 58.0, 160.0, 39.0, 70.0, 79.0, 76.0, 130.0, 160.0, 38.0, 10.0, 598.0, 270.0, 42.0, 205.0, 48.0, 120.0, 90.0, 90.0, 69.0, -10.0, -20.0, 60.0, 90.0, 20.0, 60.0, 200.0, 50.0, 70.0, 40.0, 94.0, 50.0, 40.0, 110.0, 28.0, 70.0, 20.0, 14.0, 21.0, 170.0, 20.0, 80.0, 60.0, 70.0, 3.0, 180.0, 60.0, 90.0, 80.0, 3.0, -91.0, 41.0, 630.0, 80.0, 70.0, 61.0, 80.0, 40.0, 39.0, -2.0, 40.0, 70.0, 110.0, 20.0, 160.0, 50.0, 60.0, 60.0, 40.0, 100.0, 60.0, 63.0, 82.0, -19.0, 50.0, 40.0, 80.0, 80.0, 10.0, 49.0, 90.0, 100.0, 70.0, 28.0, 30.0, 60.0, 100.0, 55.0, 190.0, 30.0, 78.0, 60.0, 70.0, 90.0, 90.0, 100.0, 53.0, 70.0, 50.0, 120.0, 50.0, 359.0, 60.0, -130.0, 90.0, 157.0, 50.0, 42.0, 12.0, 0.0, 40.0, 28.0, 50.0, 100.0, 20.0, 65.0, 0.0, 90.0, 10.0, 30.0, 110.0, 38.0, 49.0, -120.0, 80.0, 14.0, 57.0, -160.0, 59.0, 190.0, -22.0, 90.0, 27.0, 57.0, 60.0, 170.0, 6.0, 120.0, 70.0, 15.0, 210.0, 70.0, 510.0, 110.0, 50.0, 120.0, 49.0, 25.0, 60.0, 100.0, 110.0, -10.0, 90.0, 240.0, 310.0, 47.0, 390.0, 91.0, 68.0, 150.0, 50.0, 50.0, 159.0, 60.0, 100.0, 140.0, 90.0, 160.0, 150.0, 170.0, 31.0, 70.0, 50.0, 110.0, 30.0, 90.0, 87.0, 128.0, 70.0, 76.0, 40.0, 68.0, 49.0, 45.0, 84.0, 70.0, 20.0, 69.0, 10.0, 17.0, 32.0, 155.0, 70.0, 117.0, 30.0, 90.0, 90.0, 32.0, 50.0, 50.0, 40.0, 60.0, 19.0, 10.0, 98.0, 79.0, 15.0, 110.0, 50.0, 70.0, 10.0, 40.0, 60.0, 60.0, 30.0, 50.0, 35.0, 59.0, 80.0, 70.0, 170.0, -2.0, 90.0, 28.0, 70.0, 37.0, 20.0, 30.0, -2.0, 36.0, 146.0, 92.0, 8.0, 13.0, 57.0, 50.0, 61.0, 60.0, 68.0, 26.0, 169.0, 190.0, -10.0, 52.0, 90.0, 69.0, 170.0, 90.0, 70.0, 29.0, 216.0, 160.0, 121.0, 194.0, 70.0, -20.0, 80.0, 50.0, 70.0, -127.0, 15.0, 10.0, 186.0, 70.0, 220.0, 35.0, 30.0, 40.0, 60.0, 410.0, 90.0, 56.0, 64.0, 30.0, 60.0, 51.0, 140.0, 80.0, 140.0, 9.0, 40.0, 40.0, 20.0, 70.0, 60.0, 50.0, 19.0, 120.0, 50.0, 60.0, 164.0, 5.0, 26.0, 0.0, 110.0, 40.0, 187.0, 50.0, 220.0, 50.0, 60.0, 60.0, 60.0, 50.0, 40.0, 40.0, 70.0, 30.0, 40.0, 50.0, 0.0, 41.0, 69.0, 350.0, 30.0, -28.0, 44.0, 42.0, 29.0, 117.0, -85.0, 170.0, -37.0, -1.0, 50.0, -4.0, 3.0, 0.0, 60.0, 60.0, 62.0, 160.0, 180.0, 140.0, 60.0, 73.0, 56.0, 50.0, 48.0, 34.0, 70.0, 50.0, 50.0, 6.0, 430.0, 10.0, -25.0, 22.0, 90.0, 80.0, 37.0, 20.0, 70.0, 70.0, 70.0, 40.0, 180.0, 50.0, 160.0, 14.0, 25.0, 50.0, 10.0, 10.0, 60.0, 30.0, 39.0, 25.0, 70.0, 40.0, 110.0, 7.0, 35.0, 30.0, 520.0, 80.0, 70.0, 36.0, 400.0, 68.0, -147.0, 117.0, 13.0, 30.0, 30.0, -46.0, -138.0, 0.0, 13.0, 8.0, 40.0, 50.0, 69.0, 70.0, -50.0, 120.0, 70.0, 170.0, 62.0, 80.0, 30.0, 50.0, 40.0, 10.0, 200.0, 60.0, 66.0, 40.0, 90.0, 100.0, 100.0, 70.0, 50.0, 59.0, 50.0, 50.0, 50.0, 330.0, 80.0, -30.0, 58.0, 50.0, 70.0, 88.0, 80.0, 90.0, 67.0, 50.0, 59.0, 59.0, 130.0, 100.0, 80.0, 60.0, 90.0, 56.0, -51.0, 60.0, -292.0, 60.0, 118.0, -9.0, 108.0, 40.0, 60.0, 47.0, 33.0, 40.0, 40.0, 100.0, 26.0, 0.0, 330.0, 165.0, 10.0, 80.0, 57.0, 80.0, 69.0, 50.0, 40.0, 120.0, 70.0, 60.0, -17.0, 100.0, 50.0, 40.0, 50.0, 60.0, 90.0, 100.0, 100.0, 57.0, -630.0, 30.0, 60.0, 180.0, -20.0, 50.0, 310.0, 170.0, 40.0, 10.0, 50.0, 27.0, 70.0, 100.0, 100.0, -10.0, 60.0, 120.0, 60.0, 68.0, 90.0, 87.0, 60.0, 50.0, 100.0, 80.0, 110.0, 110.0, 27.0, -5.0, 140.0, 30.0, 40.0, 16.0, 0.0, -46.0, 160.0, 100.0, 22.0, 69.0, 19.0, -141.0, 25.0, 5.0, 410.0, 70.0, 40.0, 180.0, 144.0, 49.0, 70.0, 10.0, 1.0, 4.0, 34.0, -1.0, 60.0, 80.0, 50.0, 88.0, 100.0, 40.0, 70.0, 230.0, 70.0, 40.0, 20.0, 48.0, 48.0, 48.0, 26.0, 74.0, 10.0, 60.0, 20.0, 110.0, 70.0, 75.0, 20.0, 300.0, 60.0, 70.0, 100.0, 15.0, 57.0, 80.0, 15.0, 200.0, -60.0, 170.0, 110.0, 30.0, 66.0, -10.0, 123.0, 30.0, 60.0, 50.0, 92.0, 40.0, 157.0, 120.0, 52.0, 28.0, 2.0, -13.0, 60.0, 60.0, 53.0, 78.0, 60.0, 100.0, 50.0, 160.0, 60.0, 50.0, 50.0, 29.0, 10.0, 25.0, 20.0, 80.0, 220.0, 90.0, 50.0, -15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9657234745735392, "mean_inference_ms": 2.246392897413355, "mean_action_processing_ms": 0.756701022510084, "mean_env_wait_ms": 1.5714155493091453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06523847579956055, "StateBufferConnector_ms": 0.009513616561889648, "ViewRequirementAgentConnector_ms": 0.44826292991638184}, "num_episodes": 23, "episode_return_max": 1542.0, "episode_return_min": -120.0, "episode_return_mean": 678.03, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.29069975170317, "num_env_steps_trained_throughput_per_sec": 32.29069975170317, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 3840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3840000, "timers": {"training_iteration_time_ms": 127050.424, "restore_workers_time_ms": 0.012, "training_step_time_ms": 127050.373, "sample_time_ms": 3281.328, "learn_time_ms": 123746.972, "learn_throughput": 32.324, "synch_weights_time_ms": 12.573}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "done": false, "training_iteration": 96, "trial_id": "6085c_00000", "date": "2024-07-02_02-14-24", "timestamp": 1719900864, "time_this_iter_s": 123.88891220092773, "time_total_s": 13710.420795679092, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13800ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13710.420795679092, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 21.028000000000002, "ram_util_percent": 79.76114285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.732363016771686, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.107586538804352, "policy_loss": -0.0074081997307641305, "vf_loss": 7.114153955843502, "vf_explained_var": -8.235154187463469e-05, "kl": 0.008407719696189394, "entropy": 0.697900162883206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 906135.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "env_runners": {"episode_reward_max": 1542.0, "episode_reward_min": -120.0, "episode_reward_mean": 706.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -630.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 70.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [445.0, 992.0, 475.0, 526.0, 787.0, 590.0, 895.0, 1030.0, 500.0, 994.0, 892.0, 500.0, 681.0, 860.0, 537.0, 612.0, 568.0, 547.0, 952.0, 579.0, 699.0, 740.0, 820.0, 1542.0, 560.0, 617.0, 646.0, 948.0, 710.0, 495.0, 753.0, 781.0, 690.0, 433.0, 317.0, 593.0, 1304.0, 1486.0, 1129.0, 742.0, 472.0, 716.0, 551.0, 494.0, 477.0, 581.0, 919.0, 814.0, 1076.0, 720.0, 529.0, 852.0, 500.0, 694.0, 216.0, 863.0, 783.0, 711.0, 359.0, 1356.0, -120.0, 681.0, 686.0, 809.0, 671.0, 293.0, 577.0, 867.0, 573.0, 17.0, 867.0, 775.0, 422.0, 739.0, 531.0, 828.0, 464.0, 847.0, 674.0, 588.0, 731.0, 559.0, 665.0, 680.0, 963.0, 692.0, 640.0, 700.0, 1285.0, 616.0, 940.0, 663.0, 853.0, 937.0, 982.0, 1017.0, 537.0, 583.0, 558.0, 610.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [36.0, 80.0, 40.0, 60.0, 3.0, 6.0, 70.0, 60.0, 60.0, 30.0, 89.0, 49.0, 60.0, 100.0, 30.0, 30.0, 79.0, 75.0, 390.0, 90.0, 36.0, 50.0, 90.0, 32.0, 60.0, 89.0, 40.0, 19.0, 30.0, 29.0, 50.0, 90.0, 20.0, 20.0, 88.0, 70.0, -51.0, 59.0, 10.0, 170.0, 80.0, 106.0, 210.0, -5.0, 30.0, 50.0, 80.0, 100.0, 46.0, 90.0, -11.0, 50.0, -9.0, 300.0, 90.0, 30.0, 59.0, 70.0, 60.0, -49.0, 53.0, 178.0, 40.0, 308.0, 50.0, 50.0, 20.0, 49.0, 37.0, 110.0, 98.0, 60.0, 47.0, 33.0, 90.0, 119.0, 85.0, 230.0, 219.0, 49.0, 18.0, 3.0, 50.0, 70.0, 180.0, 79.0, 80.0, 50.0, -54.0, 24.0, 130.0, 90.0, 160.0, 49.0, -40.0, 53.0, 52.0, 100.0, 90.0, 310.0, 57.0, 100.0, 150.0, 89.0, 50.0, 70.0, 170.0, 80.0, 80.0, 46.0, 49.0, 86.0, 40.0, 50.0, 30.0, 40.0, 40.0, 90.0, -15.0, 90.0, 30.0, 80.0, -70.0, 70.0, 50.0, 170.0, 170.0, 25.0, 100.0, 56.0, 49.0, -34.0, -20.0, 220.0, 90.0, 330.0, 45.0, 30.0, 70.0, 80.0, 47.0, 49.0, 38.0, 36.0, 48.0, 50.0, 49.0, 120.0, 70.0, 30.0, 80.0, 50.0, 24.0, 100.0, 60.0, 60.0, 100.0, 58.0, 50.0, 30.0, 60.0, -40.0, 29.0, 30.0, 30.0, -11.0, -60.0, 30.0, 470.0, 30.0, 38.0, 50.0, 60.0, 21.0, 61.0, 40.0, 200.0, 40.0, -21.0, 58.0, 200.0, 34.0, 144.0, 28.0, 209.0, 27.0, 20.0, 40.0, 160.0, 90.0, 60.0, -15.0, 70.0, 40.0, 176.0, -2.0, 45.0, 45.0, 60.0, 100.0, 170.0, 70.0, 160.0, 70.0, 70.0, 70.0, -30.0, 60.0, 25.0, 34.0, 81.0, 50.0, 100.0, 49.0, 60.0, 70.0, 70.0, 80.0, 70.0, 110.0, 10.0, 58.0, 160.0, 39.0, 70.0, 79.0, 76.0, 130.0, 160.0, 38.0, 10.0, 598.0, 270.0, 42.0, 205.0, 48.0, 120.0, 90.0, 90.0, 69.0, -10.0, -20.0, 60.0, 90.0, 20.0, 60.0, 200.0, 50.0, 70.0, 40.0, 94.0, 50.0, 40.0, 110.0, 28.0, 70.0, 20.0, 14.0, 21.0, 170.0, 20.0, 80.0, 60.0, 70.0, 3.0, 180.0, 60.0, 90.0, 80.0, 3.0, -91.0, 41.0, 630.0, 80.0, 70.0, 61.0, 80.0, 40.0, 39.0, -2.0, 40.0, 70.0, 110.0, 20.0, 160.0, 50.0, 60.0, 60.0, 40.0, 100.0, 60.0, 63.0, 82.0, -19.0, 50.0, 40.0, 80.0, 80.0, 10.0, 49.0, 90.0, 100.0, 70.0, 28.0, 30.0, 60.0, 100.0, 55.0, 190.0, 30.0, 78.0, 60.0, 70.0, 90.0, 90.0, 100.0, 53.0, 70.0, 50.0, 120.0, 50.0, 359.0, 60.0, -130.0, 90.0, 157.0, 50.0, 42.0, 12.0, 0.0, 40.0, 28.0, 50.0, 100.0, 20.0, 65.0, 0.0, 90.0, 10.0, 30.0, 110.0, 38.0, 49.0, -120.0, 80.0, 14.0, 57.0, -160.0, 59.0, 190.0, -22.0, 90.0, 27.0, 57.0, 60.0, 170.0, 6.0, 120.0, 70.0, 15.0, 210.0, 70.0, 510.0, 110.0, 50.0, 120.0, 49.0, 25.0, 60.0, 100.0, 110.0, -10.0, 90.0, 240.0, 310.0, 47.0, 390.0, 91.0, 68.0, 150.0, 50.0, 50.0, 159.0, 60.0, 100.0, 140.0, 90.0, 160.0, 150.0, 170.0, 31.0, 70.0, 50.0, 110.0, 30.0, 90.0, 87.0, 128.0, 70.0, 76.0, 40.0, 68.0, 49.0, 45.0, 84.0, 70.0, 20.0, 69.0, 10.0, 17.0, 32.0, 155.0, 70.0, 117.0, 30.0, 90.0, 90.0, 32.0, 50.0, 50.0, 40.0, 60.0, 19.0, 10.0, 98.0, 79.0, 15.0, 110.0, 50.0, 70.0, 10.0, 40.0, 60.0, 60.0, 30.0, 50.0, 35.0, 59.0, 80.0, 70.0, 170.0, -2.0, 90.0, 28.0, 70.0, 37.0, 20.0, 30.0, -2.0, 36.0, 146.0, 92.0, 8.0, 13.0, 57.0, 50.0, 61.0, 60.0, 68.0, 26.0, 169.0, 190.0, -10.0, 52.0, 90.0, 69.0, 170.0, 90.0, 70.0, 29.0, 216.0, 160.0, 121.0, 194.0, 70.0, -20.0, 80.0, 50.0, 70.0, -127.0, 15.0, 10.0, 186.0, 70.0, 220.0, 35.0, 30.0, 40.0, 60.0, 410.0, 90.0, 56.0, 64.0, 30.0, 60.0, 51.0, 140.0, 80.0, 140.0, 9.0, 40.0, 40.0, 20.0, 70.0, 60.0, 50.0, 19.0, 120.0, 50.0, 60.0, 164.0, 5.0, 26.0, 0.0, 110.0, 40.0, 187.0, 50.0, 220.0, 50.0, 60.0, 60.0, 60.0, 50.0, 40.0, 40.0, 70.0, 30.0, 40.0, 50.0, 0.0, 41.0, 69.0, 350.0, 30.0, -28.0, 44.0, 42.0, 29.0, 117.0, -85.0, 170.0, -37.0, -1.0, 50.0, -4.0, 3.0, 0.0, 60.0, 60.0, 62.0, 160.0, 180.0, 140.0, 60.0, 73.0, 56.0, 50.0, 48.0, 34.0, 70.0, 50.0, 50.0, 6.0, 430.0, 10.0, -25.0, 22.0, 90.0, 80.0, 37.0, 20.0, 70.0, 70.0, 70.0, 40.0, 180.0, 50.0, 160.0, 14.0, 25.0, 50.0, 10.0, 10.0, 60.0, 30.0, 39.0, 25.0, 70.0, 40.0, 110.0, 7.0, 35.0, 30.0, 520.0, 80.0, 70.0, 36.0, 400.0, 68.0, -147.0, 117.0, 13.0, 30.0, 30.0, -46.0, -138.0, 0.0, 13.0, 8.0, 40.0, 50.0, 69.0, 70.0, -50.0, 120.0, 70.0, 170.0, 62.0, 80.0, 30.0, 50.0, 40.0, 10.0, 200.0, 60.0, 66.0, 40.0, 90.0, 100.0, 100.0, 70.0, 50.0, 59.0, 50.0, 50.0, 50.0, 330.0, 80.0, -30.0, 58.0, 50.0, 70.0, 88.0, 80.0, 90.0, 67.0, 50.0, 59.0, 59.0, 130.0, 100.0, 80.0, 60.0, 90.0, 56.0, -51.0, 60.0, -292.0, 60.0, 118.0, -9.0, 108.0, 40.0, 60.0, 47.0, 33.0, 40.0, 40.0, 100.0, 26.0, 0.0, 330.0, 165.0, 10.0, 80.0, 57.0, 80.0, 69.0, 50.0, 40.0, 120.0, 70.0, 60.0, -17.0, 100.0, 50.0, 40.0, 50.0, 60.0, 90.0, 100.0, 100.0, 57.0, -630.0, 30.0, 60.0, 180.0, -20.0, 50.0, 310.0, 170.0, 40.0, 10.0, 50.0, 27.0, 70.0, 100.0, 100.0, -10.0, 60.0, 120.0, 60.0, 68.0, 90.0, 87.0, 60.0, 50.0, 100.0, 80.0, 110.0, 110.0, 27.0, -5.0, 140.0, 30.0, 40.0, 16.0, 0.0, -46.0, 160.0, 100.0, 22.0, 69.0, 19.0, -141.0, 25.0, 5.0, 410.0, 70.0, 40.0, 180.0, 144.0, 49.0, 70.0, 10.0, 1.0, 4.0, 34.0, -1.0, 60.0, 80.0, 50.0, 88.0, 100.0, 40.0, 70.0, 230.0, 70.0, 40.0, 20.0, 48.0, 48.0, 48.0, 26.0, 74.0, 10.0, 60.0, 20.0, 110.0, 70.0, 75.0, 20.0, 300.0, 60.0, 70.0, 100.0, 15.0, 57.0, 80.0, 15.0, 200.0, -60.0, 170.0, 110.0, 30.0, 66.0, -10.0, 123.0, 30.0, 60.0, 50.0, 92.0, 40.0, 157.0, 120.0, 52.0, 28.0, 2.0, -13.0, 60.0, 60.0, 53.0, 78.0, 60.0, 100.0, 50.0, 160.0, 60.0, 50.0, 50.0, 29.0, 10.0, 25.0, 20.0, 80.0, 220.0, 90.0, 50.0, -15.0, 100.0, 60.0, 80.0, 48.0, 50.0, 48.0, 80.0, 159.0, 20.0, 20.0, 10.0, 70.0, 50.0, 150.0, 163.0, 27.0, 80.0, 70.0, 40.0, 20.0, 90.0, 160.0, 80.0, 70.0, 160.0, 177.0, 170.0, -20.0, 46.0, 30.0, 210.0, 20.0, 90.0, -22.0, 50.0, 70.0, 80.0, 40.0, 170.0, -16.0, 50.0, 80.0, 90.0, 0.0, 110.0, 70.0, 60.0, 60.0, 40.0, 80.0, 70.0, 55.0, 70.0, 80.0, -7.0, 120.0, 60.0, 27.0, 75.0, 150.0, 118.0, 59.0, 100.0, 120.0, 90.0, 228.0, 100.0, 230.0, 110.0, 130.0, 49.0, 70.0, 90.0, 90.0, 70.0, 48.0, 20.0, 59.0, 80.0, 40.0, 180.0, 70.0, 90.0, 90.0, 200.0, 10.0, 60.0, 150.0, 50.0, 40.0, 50.0, 70.0, 320.0, 10.0, 47.0, 30.0, 60.0, -40.0, 90.0, 26.0, 70.0, 60.0, 149.0, 52.0, 40.0, 0.0, 50.0, 327.0, 80.0, 25.0, 8.0, 80.0, 208.0, -21.0, 100.0, 80.0, 6.0, 26.0, 270.0, 180.0, 90.0, 50.0, 30.0, 100.0, -10.0, 42.0, 100.0, 120.0, 52.0, 408.0, 40.0, 67.0, 176.0, 30.0, 109.0, 300.0, -23.0, 58.0, 50.0, 210.0, -10.0, 180.0, 40.0, 50.0, 39.0, 70.0, 38.0, 50.0, 60.0, 20.0, 110.0, -50.0, 90.0, 79.0, 74.0, 13.0, 67.0, 90.0, 50.0, 60.0, 47.0, 40.0, 80.0, 39.0, 59.0, 80.0, 60.0, 83.0, 50.0, 20.0, 20.0, 70.0, 70.0, 80.0, 148.0, 50.0, 22.0, 40.0, 60.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9626728463662504, "mean_inference_ms": 2.2415658637616263, "mean_action_processing_ms": 0.7553313825511239, "mean_env_wait_ms": 1.5686508315222982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06512928009033203, "StateBufferConnector_ms": 0.009696722030639648, "ViewRequirementAgentConnector_ms": 0.46325159072875977}, "num_episodes": 18, "episode_return_max": 1542.0, "episode_return_min": -120.0, "episode_return_mean": 706.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.413584673937, "num_env_steps_trained_throughput_per_sec": 32.413584673937, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 3880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3880000, "timers": {"training_iteration_time_ms": 127082.425, "restore_workers_time_ms": 0.012, "training_step_time_ms": 127082.374, "sample_time_ms": 3267.053, "learn_time_ms": 123793.508, "learn_throughput": 32.312, "synch_weights_time_ms": 12.395}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "done": false, "training_iteration": 97, "trial_id": "6085c_00000", "date": "2024-07-02_02-16-27", "timestamp": 1719900987, "time_this_iter_s": 123.41821885108948, "time_total_s": 13833.839014530182, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a744c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13833.839014530182, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 20.931428571428572, "ram_util_percent": 79.57085714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1761944133951006, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.0003039669812805, "policy_loss": -0.006445460741311962, "vf_loss": 7.005856164448812, "vf_explained_var": -4.441371233191607e-05, "kl": 0.008932723888818267, "entropy": 0.7097862317920112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 915525.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "env_runners": {"episode_reward_max": 1542.0, "episode_reward_min": -120.0, "episode_reward_mean": 702.71, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -630.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 70.271}, "custom_metrics": {}, "hist_stats": {"episode_reward": [952.0, 579.0, 699.0, 740.0, 820.0, 1542.0, 560.0, 617.0, 646.0, 948.0, 710.0, 495.0, 753.0, 781.0, 690.0, 433.0, 317.0, 593.0, 1304.0, 1486.0, 1129.0, 742.0, 472.0, 716.0, 551.0, 494.0, 477.0, 581.0, 919.0, 814.0, 1076.0, 720.0, 529.0, 852.0, 500.0, 694.0, 216.0, 863.0, 783.0, 711.0, 359.0, 1356.0, -120.0, 681.0, 686.0, 809.0, 671.0, 293.0, 577.0, 867.0, 573.0, 17.0, 867.0, 775.0, 422.0, 739.0, 531.0, 828.0, 464.0, 847.0, 674.0, 588.0, 731.0, 559.0, 665.0, 680.0, 963.0, 692.0, 640.0, 700.0, 1285.0, 616.0, 940.0, 663.0, 853.0, 937.0, 982.0, 1017.0, 537.0, 583.0, 558.0, 610.0, 722.0, 675.0, 913.0, 662.0, 579.0, 632.0, 946.0, 752.0, 1068.0, 612.0, 790.0, 415.0, 357.0, 571.0, 589.0, 407.0, 737.0, 625.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [200.0, 34.0, 144.0, 28.0, 209.0, 27.0, 20.0, 40.0, 160.0, 90.0, 60.0, -15.0, 70.0, 40.0, 176.0, -2.0, 45.0, 45.0, 60.0, 100.0, 170.0, 70.0, 160.0, 70.0, 70.0, 70.0, -30.0, 60.0, 25.0, 34.0, 81.0, 50.0, 100.0, 49.0, 60.0, 70.0, 70.0, 80.0, 70.0, 110.0, 10.0, 58.0, 160.0, 39.0, 70.0, 79.0, 76.0, 130.0, 160.0, 38.0, 10.0, 598.0, 270.0, 42.0, 205.0, 48.0, 120.0, 90.0, 90.0, 69.0, -10.0, -20.0, 60.0, 90.0, 20.0, 60.0, 200.0, 50.0, 70.0, 40.0, 94.0, 50.0, 40.0, 110.0, 28.0, 70.0, 20.0, 14.0, 21.0, 170.0, 20.0, 80.0, 60.0, 70.0, 3.0, 180.0, 60.0, 90.0, 80.0, 3.0, -91.0, 41.0, 630.0, 80.0, 70.0, 61.0, 80.0, 40.0, 39.0, -2.0, 40.0, 70.0, 110.0, 20.0, 160.0, 50.0, 60.0, 60.0, 40.0, 100.0, 60.0, 63.0, 82.0, -19.0, 50.0, 40.0, 80.0, 80.0, 10.0, 49.0, 90.0, 100.0, 70.0, 28.0, 30.0, 60.0, 100.0, 55.0, 190.0, 30.0, 78.0, 60.0, 70.0, 90.0, 90.0, 100.0, 53.0, 70.0, 50.0, 120.0, 50.0, 359.0, 60.0, -130.0, 90.0, 157.0, 50.0, 42.0, 12.0, 0.0, 40.0, 28.0, 50.0, 100.0, 20.0, 65.0, 0.0, 90.0, 10.0, 30.0, 110.0, 38.0, 49.0, -120.0, 80.0, 14.0, 57.0, -160.0, 59.0, 190.0, -22.0, 90.0, 27.0, 57.0, 60.0, 170.0, 6.0, 120.0, 70.0, 15.0, 210.0, 70.0, 510.0, 110.0, 50.0, 120.0, 49.0, 25.0, 60.0, 100.0, 110.0, -10.0, 90.0, 240.0, 310.0, 47.0, 390.0, 91.0, 68.0, 150.0, 50.0, 50.0, 159.0, 60.0, 100.0, 140.0, 90.0, 160.0, 150.0, 170.0, 31.0, 70.0, 50.0, 110.0, 30.0, 90.0, 87.0, 128.0, 70.0, 76.0, 40.0, 68.0, 49.0, 45.0, 84.0, 70.0, 20.0, 69.0, 10.0, 17.0, 32.0, 155.0, 70.0, 117.0, 30.0, 90.0, 90.0, 32.0, 50.0, 50.0, 40.0, 60.0, 19.0, 10.0, 98.0, 79.0, 15.0, 110.0, 50.0, 70.0, 10.0, 40.0, 60.0, 60.0, 30.0, 50.0, 35.0, 59.0, 80.0, 70.0, 170.0, -2.0, 90.0, 28.0, 70.0, 37.0, 20.0, 30.0, -2.0, 36.0, 146.0, 92.0, 8.0, 13.0, 57.0, 50.0, 61.0, 60.0, 68.0, 26.0, 169.0, 190.0, -10.0, 52.0, 90.0, 69.0, 170.0, 90.0, 70.0, 29.0, 216.0, 160.0, 121.0, 194.0, 70.0, -20.0, 80.0, 50.0, 70.0, -127.0, 15.0, 10.0, 186.0, 70.0, 220.0, 35.0, 30.0, 40.0, 60.0, 410.0, 90.0, 56.0, 64.0, 30.0, 60.0, 51.0, 140.0, 80.0, 140.0, 9.0, 40.0, 40.0, 20.0, 70.0, 60.0, 50.0, 19.0, 120.0, 50.0, 60.0, 164.0, 5.0, 26.0, 0.0, 110.0, 40.0, 187.0, 50.0, 220.0, 50.0, 60.0, 60.0, 60.0, 50.0, 40.0, 40.0, 70.0, 30.0, 40.0, 50.0, 0.0, 41.0, 69.0, 350.0, 30.0, -28.0, 44.0, 42.0, 29.0, 117.0, -85.0, 170.0, -37.0, -1.0, 50.0, -4.0, 3.0, 0.0, 60.0, 60.0, 62.0, 160.0, 180.0, 140.0, 60.0, 73.0, 56.0, 50.0, 48.0, 34.0, 70.0, 50.0, 50.0, 6.0, 430.0, 10.0, -25.0, 22.0, 90.0, 80.0, 37.0, 20.0, 70.0, 70.0, 70.0, 40.0, 180.0, 50.0, 160.0, 14.0, 25.0, 50.0, 10.0, 10.0, 60.0, 30.0, 39.0, 25.0, 70.0, 40.0, 110.0, 7.0, 35.0, 30.0, 520.0, 80.0, 70.0, 36.0, 400.0, 68.0, -147.0, 117.0, 13.0, 30.0, 30.0, -46.0, -138.0, 0.0, 13.0, 8.0, 40.0, 50.0, 69.0, 70.0, -50.0, 120.0, 70.0, 170.0, 62.0, 80.0, 30.0, 50.0, 40.0, 10.0, 200.0, 60.0, 66.0, 40.0, 90.0, 100.0, 100.0, 70.0, 50.0, 59.0, 50.0, 50.0, 50.0, 330.0, 80.0, -30.0, 58.0, 50.0, 70.0, 88.0, 80.0, 90.0, 67.0, 50.0, 59.0, 59.0, 130.0, 100.0, 80.0, 60.0, 90.0, 56.0, -51.0, 60.0, -292.0, 60.0, 118.0, -9.0, 108.0, 40.0, 60.0, 47.0, 33.0, 40.0, 40.0, 100.0, 26.0, 0.0, 330.0, 165.0, 10.0, 80.0, 57.0, 80.0, 69.0, 50.0, 40.0, 120.0, 70.0, 60.0, -17.0, 100.0, 50.0, 40.0, 50.0, 60.0, 90.0, 100.0, 100.0, 57.0, -630.0, 30.0, 60.0, 180.0, -20.0, 50.0, 310.0, 170.0, 40.0, 10.0, 50.0, 27.0, 70.0, 100.0, 100.0, -10.0, 60.0, 120.0, 60.0, 68.0, 90.0, 87.0, 60.0, 50.0, 100.0, 80.0, 110.0, 110.0, 27.0, -5.0, 140.0, 30.0, 40.0, 16.0, 0.0, -46.0, 160.0, 100.0, 22.0, 69.0, 19.0, -141.0, 25.0, 5.0, 410.0, 70.0, 40.0, 180.0, 144.0, 49.0, 70.0, 10.0, 1.0, 4.0, 34.0, -1.0, 60.0, 80.0, 50.0, 88.0, 100.0, 40.0, 70.0, 230.0, 70.0, 40.0, 20.0, 48.0, 48.0, 48.0, 26.0, 74.0, 10.0, 60.0, 20.0, 110.0, 70.0, 75.0, 20.0, 300.0, 60.0, 70.0, 100.0, 15.0, 57.0, 80.0, 15.0, 200.0, -60.0, 170.0, 110.0, 30.0, 66.0, -10.0, 123.0, 30.0, 60.0, 50.0, 92.0, 40.0, 157.0, 120.0, 52.0, 28.0, 2.0, -13.0, 60.0, 60.0, 53.0, 78.0, 60.0, 100.0, 50.0, 160.0, 60.0, 50.0, 50.0, 29.0, 10.0, 25.0, 20.0, 80.0, 220.0, 90.0, 50.0, -15.0, 100.0, 60.0, 80.0, 48.0, 50.0, 48.0, 80.0, 159.0, 20.0, 20.0, 10.0, 70.0, 50.0, 150.0, 163.0, 27.0, 80.0, 70.0, 40.0, 20.0, 90.0, 160.0, 80.0, 70.0, 160.0, 177.0, 170.0, -20.0, 46.0, 30.0, 210.0, 20.0, 90.0, -22.0, 50.0, 70.0, 80.0, 40.0, 170.0, -16.0, 50.0, 80.0, 90.0, 0.0, 110.0, 70.0, 60.0, 60.0, 40.0, 80.0, 70.0, 55.0, 70.0, 80.0, -7.0, 120.0, 60.0, 27.0, 75.0, 150.0, 118.0, 59.0, 100.0, 120.0, 90.0, 228.0, 100.0, 230.0, 110.0, 130.0, 49.0, 70.0, 90.0, 90.0, 70.0, 48.0, 20.0, 59.0, 80.0, 40.0, 180.0, 70.0, 90.0, 90.0, 200.0, 10.0, 60.0, 150.0, 50.0, 40.0, 50.0, 70.0, 320.0, 10.0, 47.0, 30.0, 60.0, -40.0, 90.0, 26.0, 70.0, 60.0, 149.0, 52.0, 40.0, 0.0, 50.0, 327.0, 80.0, 25.0, 8.0, 80.0, 208.0, -21.0, 100.0, 80.0, 6.0, 26.0, 270.0, 180.0, 90.0, 50.0, 30.0, 100.0, -10.0, 42.0, 100.0, 120.0, 52.0, 408.0, 40.0, 67.0, 176.0, 30.0, 109.0, 300.0, -23.0, 58.0, 50.0, 210.0, -10.0, 180.0, 40.0, 50.0, 39.0, 70.0, 38.0, 50.0, 60.0, 20.0, 110.0, -50.0, 90.0, 79.0, 74.0, 13.0, 67.0, 90.0, 50.0, 60.0, 47.0, 40.0, 80.0, 39.0, 59.0, 80.0, 60.0, 83.0, 50.0, 20.0, 20.0, 70.0, 70.0, 80.0, 148.0, 50.0, 22.0, 40.0, 60.0, 50.0, 50.0, -22.0, 36.0, 39.0, 280.0, 130.0, 50.0, 39.0, 90.0, 30.0, 70.0, 50.0, 24.0, -24.0, 20.0, 84.0, 11.0, 260.0, 34.0, 146.0, 220.0, 50.0, 100.0, 70.0, 46.0, 90.0, 47.0, 110.0, 130.0, 50.0, 30.0, -28.0, 120.0, 80.0, 90.0, 50.0, 59.0, 50.0, 31.0, 180.0, 59.0, 70.0, 40.0, 40.0, 80.0, 60.0, 20.0, 90.0, 80.0, 40.0, 100.0, -7.0, 10.0, 59.0, 90.0, 110.0, 70.0, 40.0, 110.0, 50.0, 230.0, 100.0, 25.0, 20.0, 82.0, 50.0, 90.0, 50.0, 260.0, 39.0, 95.0, 94.0, 64.0, 119.0, 80.0, 40.0, 70.0, 70.0, 60.0, 60.0, 98.0, 530.0, 77.0, 0.0, 110.0, 50.0, 80.0, 61.0, -20.0, 82.0, 25.0, 220.0, 49.0, 70.0, 50.0, 41.0, 30.0, 39.0, 60.0, 28.0, 100.0, 70.0, 60.0, 80.0, 54.0, 10.0, 36.0, 70.0, 230.0, 80.0, 37.0, 56.0, 8.0, 1.0, 19.0, 200.0, 22.0, -13.0, 40.0, 45.0, 23.0, 44.0, 70.0, 20.0, 31.0, 80.0, 16.0, -4.0, 30.0, 47.0, 180.0, 4.0, 17.0, 90.0, 150.0, 20.0, 30.0, 50.0, 20.0, 10.0, 29.0, 36.0, -20.0, 150.0, 39.0, 80.0, 110.0, 170.0, 8.0, -13.0, 0.0, 40.0, 29.0, 30.0, 110.0, -1.0, 19.0, 60.0, 110.0, 10.0, 75.0, 79.0, 90.0, 91.0, 30.0, 53.0, 130.0, 19.0, 80.0, 90.0, 110.0, 40.0, 20.0, 50.0, 60.0, 60.0, 15.0, 280.0, -20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9601939122243628, "mean_inference_ms": 2.2375537942391293, "mean_action_processing_ms": 0.7541035653285982, "mean_env_wait_ms": 1.5662617575457023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06187748908996582, "StateBufferConnector_ms": 0.009712457656860352, "ViewRequirementAgentConnector_ms": 0.45761585235595703}, "num_episodes": 18, "episode_return_max": 1542.0, "episode_return_min": -120.0, "episode_return_mean": 702.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.22515412436643, "num_env_steps_trained_throughput_per_sec": 32.22515412436643, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 3920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3920000, "timers": {"training_iteration_time_ms": 127141.818, "restore_workers_time_ms": 0.012, "training_step_time_ms": 127141.77, "sample_time_ms": 3260.35, "learn_time_ms": 123859.33, "learn_throughput": 32.295, "synch_weights_time_ms": 12.131}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "done": false, "training_iteration": 98, "trial_id": "6085c_00000", "date": "2024-07-02_02-18-32", "timestamp": 1719901112, "time_this_iter_s": 124.14418625831604, "time_total_s": 13957.983200788498, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c52dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13957.983200788498, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 21.899428571428572, "ram_util_percent": 81.29599999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7210526212907067, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.048477593422952, "policy_loss": -0.006931198318079769, "vf_loss": 7.054560719460598, "vf_explained_var": 0.0011001785532735026, "kl": 0.008480778280964005, "entropy": 0.6482849119697262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 924915.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "env_runners": {"episode_reward_max": 1356.0, "episode_reward_min": -120.0, "episode_reward_mean": 689.58, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -630.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 68.958}, "custom_metrics": {}, "hist_stats": {"episode_reward": [472.0, 716.0, 551.0, 494.0, 477.0, 581.0, 919.0, 814.0, 1076.0, 720.0, 529.0, 852.0, 500.0, 694.0, 216.0, 863.0, 783.0, 711.0, 359.0, 1356.0, -120.0, 681.0, 686.0, 809.0, 671.0, 293.0, 577.0, 867.0, 573.0, 17.0, 867.0, 775.0, 422.0, 739.0, 531.0, 828.0, 464.0, 847.0, 674.0, 588.0, 731.0, 559.0, 665.0, 680.0, 963.0, 692.0, 640.0, 700.0, 1285.0, 616.0, 940.0, 663.0, 853.0, 937.0, 982.0, 1017.0, 537.0, 583.0, 558.0, 610.0, 722.0, 675.0, 913.0, 662.0, 579.0, 632.0, 946.0, 752.0, 1068.0, 612.0, 790.0, 415.0, 357.0, 571.0, 589.0, 407.0, 737.0, 625.0, 472.0, 777.0, 764.0, 786.0, 490.0, 696.0, 590.0, 814.0, 659.0, 916.0, 464.0, 816.0, 745.0, 889.0, 1090.0, 918.0, 619.0, 821.0, 225.0, 1203.0, 438.0, 1031.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 68.0, 49.0, 45.0, 84.0, 70.0, 20.0, 69.0, 10.0, 17.0, 32.0, 155.0, 70.0, 117.0, 30.0, 90.0, 90.0, 32.0, 50.0, 50.0, 40.0, 60.0, 19.0, 10.0, 98.0, 79.0, 15.0, 110.0, 50.0, 70.0, 10.0, 40.0, 60.0, 60.0, 30.0, 50.0, 35.0, 59.0, 80.0, 70.0, 170.0, -2.0, 90.0, 28.0, 70.0, 37.0, 20.0, 30.0, -2.0, 36.0, 146.0, 92.0, 8.0, 13.0, 57.0, 50.0, 61.0, 60.0, 68.0, 26.0, 169.0, 190.0, -10.0, 52.0, 90.0, 69.0, 170.0, 90.0, 70.0, 29.0, 216.0, 160.0, 121.0, 194.0, 70.0, -20.0, 80.0, 50.0, 70.0, -127.0, 15.0, 10.0, 186.0, 70.0, 220.0, 35.0, 30.0, 40.0, 60.0, 410.0, 90.0, 56.0, 64.0, 30.0, 60.0, 51.0, 140.0, 80.0, 140.0, 9.0, 40.0, 40.0, 20.0, 70.0, 60.0, 50.0, 19.0, 120.0, 50.0, 60.0, 164.0, 5.0, 26.0, 0.0, 110.0, 40.0, 187.0, 50.0, 220.0, 50.0, 60.0, 60.0, 60.0, 50.0, 40.0, 40.0, 70.0, 30.0, 40.0, 50.0, 0.0, 41.0, 69.0, 350.0, 30.0, -28.0, 44.0, 42.0, 29.0, 117.0, -85.0, 170.0, -37.0, -1.0, 50.0, -4.0, 3.0, 0.0, 60.0, 60.0, 62.0, 160.0, 180.0, 140.0, 60.0, 73.0, 56.0, 50.0, 48.0, 34.0, 70.0, 50.0, 50.0, 6.0, 430.0, 10.0, -25.0, 22.0, 90.0, 80.0, 37.0, 20.0, 70.0, 70.0, 70.0, 40.0, 180.0, 50.0, 160.0, 14.0, 25.0, 50.0, 10.0, 10.0, 60.0, 30.0, 39.0, 25.0, 70.0, 40.0, 110.0, 7.0, 35.0, 30.0, 520.0, 80.0, 70.0, 36.0, 400.0, 68.0, -147.0, 117.0, 13.0, 30.0, 30.0, -46.0, -138.0, 0.0, 13.0, 8.0, 40.0, 50.0, 69.0, 70.0, -50.0, 120.0, 70.0, 170.0, 62.0, 80.0, 30.0, 50.0, 40.0, 10.0, 200.0, 60.0, 66.0, 40.0, 90.0, 100.0, 100.0, 70.0, 50.0, 59.0, 50.0, 50.0, 50.0, 330.0, 80.0, -30.0, 58.0, 50.0, 70.0, 88.0, 80.0, 90.0, 67.0, 50.0, 59.0, 59.0, 130.0, 100.0, 80.0, 60.0, 90.0, 56.0, -51.0, 60.0, -292.0, 60.0, 118.0, -9.0, 108.0, 40.0, 60.0, 47.0, 33.0, 40.0, 40.0, 100.0, 26.0, 0.0, 330.0, 165.0, 10.0, 80.0, 57.0, 80.0, 69.0, 50.0, 40.0, 120.0, 70.0, 60.0, -17.0, 100.0, 50.0, 40.0, 50.0, 60.0, 90.0, 100.0, 100.0, 57.0, -630.0, 30.0, 60.0, 180.0, -20.0, 50.0, 310.0, 170.0, 40.0, 10.0, 50.0, 27.0, 70.0, 100.0, 100.0, -10.0, 60.0, 120.0, 60.0, 68.0, 90.0, 87.0, 60.0, 50.0, 100.0, 80.0, 110.0, 110.0, 27.0, -5.0, 140.0, 30.0, 40.0, 16.0, 0.0, -46.0, 160.0, 100.0, 22.0, 69.0, 19.0, -141.0, 25.0, 5.0, 410.0, 70.0, 40.0, 180.0, 144.0, 49.0, 70.0, 10.0, 1.0, 4.0, 34.0, -1.0, 60.0, 80.0, 50.0, 88.0, 100.0, 40.0, 70.0, 230.0, 70.0, 40.0, 20.0, 48.0, 48.0, 48.0, 26.0, 74.0, 10.0, 60.0, 20.0, 110.0, 70.0, 75.0, 20.0, 300.0, 60.0, 70.0, 100.0, 15.0, 57.0, 80.0, 15.0, 200.0, -60.0, 170.0, 110.0, 30.0, 66.0, -10.0, 123.0, 30.0, 60.0, 50.0, 92.0, 40.0, 157.0, 120.0, 52.0, 28.0, 2.0, -13.0, 60.0, 60.0, 53.0, 78.0, 60.0, 100.0, 50.0, 160.0, 60.0, 50.0, 50.0, 29.0, 10.0, 25.0, 20.0, 80.0, 220.0, 90.0, 50.0, -15.0, 100.0, 60.0, 80.0, 48.0, 50.0, 48.0, 80.0, 159.0, 20.0, 20.0, 10.0, 70.0, 50.0, 150.0, 163.0, 27.0, 80.0, 70.0, 40.0, 20.0, 90.0, 160.0, 80.0, 70.0, 160.0, 177.0, 170.0, -20.0, 46.0, 30.0, 210.0, 20.0, 90.0, -22.0, 50.0, 70.0, 80.0, 40.0, 170.0, -16.0, 50.0, 80.0, 90.0, 0.0, 110.0, 70.0, 60.0, 60.0, 40.0, 80.0, 70.0, 55.0, 70.0, 80.0, -7.0, 120.0, 60.0, 27.0, 75.0, 150.0, 118.0, 59.0, 100.0, 120.0, 90.0, 228.0, 100.0, 230.0, 110.0, 130.0, 49.0, 70.0, 90.0, 90.0, 70.0, 48.0, 20.0, 59.0, 80.0, 40.0, 180.0, 70.0, 90.0, 90.0, 200.0, 10.0, 60.0, 150.0, 50.0, 40.0, 50.0, 70.0, 320.0, 10.0, 47.0, 30.0, 60.0, -40.0, 90.0, 26.0, 70.0, 60.0, 149.0, 52.0, 40.0, 0.0, 50.0, 327.0, 80.0, 25.0, 8.0, 80.0, 208.0, -21.0, 100.0, 80.0, 6.0, 26.0, 270.0, 180.0, 90.0, 50.0, 30.0, 100.0, -10.0, 42.0, 100.0, 120.0, 52.0, 408.0, 40.0, 67.0, 176.0, 30.0, 109.0, 300.0, -23.0, 58.0, 50.0, 210.0, -10.0, 180.0, 40.0, 50.0, 39.0, 70.0, 38.0, 50.0, 60.0, 20.0, 110.0, -50.0, 90.0, 79.0, 74.0, 13.0, 67.0, 90.0, 50.0, 60.0, 47.0, 40.0, 80.0, 39.0, 59.0, 80.0, 60.0, 83.0, 50.0, 20.0, 20.0, 70.0, 70.0, 80.0, 148.0, 50.0, 22.0, 40.0, 60.0, 50.0, 50.0, -22.0, 36.0, 39.0, 280.0, 130.0, 50.0, 39.0, 90.0, 30.0, 70.0, 50.0, 24.0, -24.0, 20.0, 84.0, 11.0, 260.0, 34.0, 146.0, 220.0, 50.0, 100.0, 70.0, 46.0, 90.0, 47.0, 110.0, 130.0, 50.0, 30.0, -28.0, 120.0, 80.0, 90.0, 50.0, 59.0, 50.0, 31.0, 180.0, 59.0, 70.0, 40.0, 40.0, 80.0, 60.0, 20.0, 90.0, 80.0, 40.0, 100.0, -7.0, 10.0, 59.0, 90.0, 110.0, 70.0, 40.0, 110.0, 50.0, 230.0, 100.0, 25.0, 20.0, 82.0, 50.0, 90.0, 50.0, 260.0, 39.0, 95.0, 94.0, 64.0, 119.0, 80.0, 40.0, 70.0, 70.0, 60.0, 60.0, 98.0, 530.0, 77.0, 0.0, 110.0, 50.0, 80.0, 61.0, -20.0, 82.0, 25.0, 220.0, 49.0, 70.0, 50.0, 41.0, 30.0, 39.0, 60.0, 28.0, 100.0, 70.0, 60.0, 80.0, 54.0, 10.0, 36.0, 70.0, 230.0, 80.0, 37.0, 56.0, 8.0, 1.0, 19.0, 200.0, 22.0, -13.0, 40.0, 45.0, 23.0, 44.0, 70.0, 20.0, 31.0, 80.0, 16.0, -4.0, 30.0, 47.0, 180.0, 4.0, 17.0, 90.0, 150.0, 20.0, 30.0, 50.0, 20.0, 10.0, 29.0, 36.0, -20.0, 150.0, 39.0, 80.0, 110.0, 170.0, 8.0, -13.0, 0.0, 40.0, 29.0, 30.0, 110.0, -1.0, 19.0, 60.0, 110.0, 10.0, 75.0, 79.0, 90.0, 91.0, 30.0, 53.0, 130.0, 19.0, 80.0, 90.0, 110.0, 40.0, 20.0, 50.0, 60.0, 60.0, 15.0, 280.0, -20.0, 10.0, 14.0, 30.0, 150.0, 69.0, 69.0, -3.0, 40.0, 53.0, 40.0, 10.0, 70.0, 0.0, 69.0, 70.0, 110.0, 70.0, 181.0, 67.0, 90.0, 50.0, 57.0, 60.0, 130.0, 40.0, 60.0, 67.0, 0.0, -20.0, 70.0, 300.0, 180.0, 90.0, 50.0, 64.0, 80.0, 100.0, 60.0, 69.0, 60.0, 33.0, 50.0, 30.0, -93.0, 58.0, 80.0, 70.0, 47.0, 60.0, 100.0, 88.0, 20.0, 70.0, 20.0, 110.0, 30.0, 80.0, 90.0, 30.0, 156.0, 90.0, 50.0, 25.0, 35.0, 18.0, 120.0, 150.0, 50.0, 40.0, 80.0, 22.0, -5.0, 40.0, 48.0, 40.0, 70.0, 90.0, 235.0, 110.0, 100.0, 86.0, 20.0, 200.0, 30.0, 50.0, -20.0, 30.0, 200.0, 30.0, 80.0, 39.0, -64.0, 90.0, 515.0, 40.0, 65.0, 50.0, 27.0, 53.0, 50.0, 90.0, 6.0, 20.0, 4.0, 30.0, 30.0, 30.0, 30.0, 50.0, 147.0, 117.0, 80.0, 79.0, 30.0, 400.0, 20.0, 90.0, 0.0, 47.0, 20.0, 50.0, 70.0, 70.0, 39.0, 40.0, -170.0, 210.0, 60.0, 287.0, 69.0, 70.0, 80.0, 126.0, 8.0, 37.0, 29.0, 60.0, 60.0, 80.0, 430.0, -21.0, 40.0, 690.0, 40.0, 100.0, 100.0, 140.0, 30.0, 110.0, -200.0, 40.0, 50.0, 50.0, 300.0, 40.0, 115.0, 70.0, 84.0, 80.0, 70.0, 59.0, 49.0, 70.0, 120.0, 150.0, 60.0, 50.0, 20.0, 50.0, 30.0, 20.0, 10.0, 75.0, 80.0, 100.0, 230.0, 30.0, 90.0, 90.0, 50.0, 66.0, 48.0, 19.0, 7.0, -224.0, 105.0, 70.0, 57.0, 3.0, 95.0, 45.0, 50.0, 307.0, 84.0, 40.0, 130.0, 100.0, -28.0, 400.0, 50.0, 70.0, 60.0, 70.0, -10.0, 60.0, 60.0, 60.0, 30.0, 50.0, 8.0, 50.0, 80.0, 230.0, 80.0, 178.0, 60.0, 120.0, 70.0, 54.0, 100.0, 59.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9617981469258734, "mean_inference_ms": 2.2344411574963625, "mean_action_processing_ms": 0.7550307765272228, "mean_env_wait_ms": 1.564310882827503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06529474258422852, "StateBufferConnector_ms": 0.010045766830444336, "ViewRequirementAgentConnector_ms": 0.47513628005981445}, "num_episodes": 22, "episode_return_max": 1356.0, "episode_return_min": -120.0, "episode_return_mean": 689.58, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 31.88278433185405, "num_env_steps_trained_throughput_per_sec": 31.88278433185405, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 3960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3960000, "timers": {"training_iteration_time_ms": 127336.318, "restore_workers_time_ms": 0.012, "training_step_time_ms": 127336.27, "sample_time_ms": 3485.386, "learn_time_ms": 123828.67, "learn_throughput": 32.303, "synch_weights_time_ms": 12.338}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "done": false, "training_iteration": 99, "trial_id": "6085c_00000", "date": "2024-07-02_02-20-37", "timestamp": 1719901237, "time_this_iter_s": 125.50693202018738, "time_total_s": 14083.490132808685, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b91799d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14083.490132808685, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 23.16741573033708, "ram_util_percent": 81.14157303370787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8023296679234226, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.982778420768226, "policy_loss": -0.00765751678835307, "vf_loss": 6.989562564967667, "vf_explained_var": 0.0025818315557778453, "kl": 0.008733660748346238, "entropy": 0.6780652923547168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 934305.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "env_runners": {"episode_reward_max": 1356.0, "episode_reward_min": -120.0, "episode_reward_mean": 705.38, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -630.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 70.538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.0, 1356.0, -120.0, 681.0, 686.0, 809.0, 671.0, 293.0, 577.0, 867.0, 573.0, 17.0, 867.0, 775.0, 422.0, 739.0, 531.0, 828.0, 464.0, 847.0, 674.0, 588.0, 731.0, 559.0, 665.0, 680.0, 963.0, 692.0, 640.0, 700.0, 1285.0, 616.0, 940.0, 663.0, 853.0, 937.0, 982.0, 1017.0, 537.0, 583.0, 558.0, 610.0, 722.0, 675.0, 913.0, 662.0, 579.0, 632.0, 946.0, 752.0, 1068.0, 612.0, 790.0, 415.0, 357.0, 571.0, 589.0, 407.0, 737.0, 625.0, 472.0, 777.0, 764.0, 786.0, 490.0, 696.0, 590.0, 814.0, 659.0, 916.0, 464.0, 816.0, 745.0, 889.0, 1090.0, 918.0, 619.0, 821.0, 225.0, 1203.0, 438.0, 1031.0, 693.0, 662.0, 873.0, 1053.0, 639.0, 929.0, 963.0, 652.0, 845.0, 430.0, 886.0, 607.0, 962.0, 705.0, 846.0, 487.0, 806.0, 510.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [25.0, 50.0, 10.0, 10.0, 60.0, 30.0, 39.0, 25.0, 70.0, 40.0, 110.0, 7.0, 35.0, 30.0, 520.0, 80.0, 70.0, 36.0, 400.0, 68.0, -147.0, 117.0, 13.0, 30.0, 30.0, -46.0, -138.0, 0.0, 13.0, 8.0, 40.0, 50.0, 69.0, 70.0, -50.0, 120.0, 70.0, 170.0, 62.0, 80.0, 30.0, 50.0, 40.0, 10.0, 200.0, 60.0, 66.0, 40.0, 90.0, 100.0, 100.0, 70.0, 50.0, 59.0, 50.0, 50.0, 50.0, 330.0, 80.0, -30.0, 58.0, 50.0, 70.0, 88.0, 80.0, 90.0, 67.0, 50.0, 59.0, 59.0, 130.0, 100.0, 80.0, 60.0, 90.0, 56.0, -51.0, 60.0, -292.0, 60.0, 118.0, -9.0, 108.0, 40.0, 60.0, 47.0, 33.0, 40.0, 40.0, 100.0, 26.0, 0.0, 330.0, 165.0, 10.0, 80.0, 57.0, 80.0, 69.0, 50.0, 40.0, 120.0, 70.0, 60.0, -17.0, 100.0, 50.0, 40.0, 50.0, 60.0, 90.0, 100.0, 100.0, 57.0, -630.0, 30.0, 60.0, 180.0, -20.0, 50.0, 310.0, 170.0, 40.0, 10.0, 50.0, 27.0, 70.0, 100.0, 100.0, -10.0, 60.0, 120.0, 60.0, 68.0, 90.0, 87.0, 60.0, 50.0, 100.0, 80.0, 110.0, 110.0, 27.0, -5.0, 140.0, 30.0, 40.0, 16.0, 0.0, -46.0, 160.0, 100.0, 22.0, 69.0, 19.0, -141.0, 25.0, 5.0, 410.0, 70.0, 40.0, 180.0, 144.0, 49.0, 70.0, 10.0, 1.0, 4.0, 34.0, -1.0, 60.0, 80.0, 50.0, 88.0, 100.0, 40.0, 70.0, 230.0, 70.0, 40.0, 20.0, 48.0, 48.0, 48.0, 26.0, 74.0, 10.0, 60.0, 20.0, 110.0, 70.0, 75.0, 20.0, 300.0, 60.0, 70.0, 100.0, 15.0, 57.0, 80.0, 15.0, 200.0, -60.0, 170.0, 110.0, 30.0, 66.0, -10.0, 123.0, 30.0, 60.0, 50.0, 92.0, 40.0, 157.0, 120.0, 52.0, 28.0, 2.0, -13.0, 60.0, 60.0, 53.0, 78.0, 60.0, 100.0, 50.0, 160.0, 60.0, 50.0, 50.0, 29.0, 10.0, 25.0, 20.0, 80.0, 220.0, 90.0, 50.0, -15.0, 100.0, 60.0, 80.0, 48.0, 50.0, 48.0, 80.0, 159.0, 20.0, 20.0, 10.0, 70.0, 50.0, 150.0, 163.0, 27.0, 80.0, 70.0, 40.0, 20.0, 90.0, 160.0, 80.0, 70.0, 160.0, 177.0, 170.0, -20.0, 46.0, 30.0, 210.0, 20.0, 90.0, -22.0, 50.0, 70.0, 80.0, 40.0, 170.0, -16.0, 50.0, 80.0, 90.0, 0.0, 110.0, 70.0, 60.0, 60.0, 40.0, 80.0, 70.0, 55.0, 70.0, 80.0, -7.0, 120.0, 60.0, 27.0, 75.0, 150.0, 118.0, 59.0, 100.0, 120.0, 90.0, 228.0, 100.0, 230.0, 110.0, 130.0, 49.0, 70.0, 90.0, 90.0, 70.0, 48.0, 20.0, 59.0, 80.0, 40.0, 180.0, 70.0, 90.0, 90.0, 200.0, 10.0, 60.0, 150.0, 50.0, 40.0, 50.0, 70.0, 320.0, 10.0, 47.0, 30.0, 60.0, -40.0, 90.0, 26.0, 70.0, 60.0, 149.0, 52.0, 40.0, 0.0, 50.0, 327.0, 80.0, 25.0, 8.0, 80.0, 208.0, -21.0, 100.0, 80.0, 6.0, 26.0, 270.0, 180.0, 90.0, 50.0, 30.0, 100.0, -10.0, 42.0, 100.0, 120.0, 52.0, 408.0, 40.0, 67.0, 176.0, 30.0, 109.0, 300.0, -23.0, 58.0, 50.0, 210.0, -10.0, 180.0, 40.0, 50.0, 39.0, 70.0, 38.0, 50.0, 60.0, 20.0, 110.0, -50.0, 90.0, 79.0, 74.0, 13.0, 67.0, 90.0, 50.0, 60.0, 47.0, 40.0, 80.0, 39.0, 59.0, 80.0, 60.0, 83.0, 50.0, 20.0, 20.0, 70.0, 70.0, 80.0, 148.0, 50.0, 22.0, 40.0, 60.0, 50.0, 50.0, -22.0, 36.0, 39.0, 280.0, 130.0, 50.0, 39.0, 90.0, 30.0, 70.0, 50.0, 24.0, -24.0, 20.0, 84.0, 11.0, 260.0, 34.0, 146.0, 220.0, 50.0, 100.0, 70.0, 46.0, 90.0, 47.0, 110.0, 130.0, 50.0, 30.0, -28.0, 120.0, 80.0, 90.0, 50.0, 59.0, 50.0, 31.0, 180.0, 59.0, 70.0, 40.0, 40.0, 80.0, 60.0, 20.0, 90.0, 80.0, 40.0, 100.0, -7.0, 10.0, 59.0, 90.0, 110.0, 70.0, 40.0, 110.0, 50.0, 230.0, 100.0, 25.0, 20.0, 82.0, 50.0, 90.0, 50.0, 260.0, 39.0, 95.0, 94.0, 64.0, 119.0, 80.0, 40.0, 70.0, 70.0, 60.0, 60.0, 98.0, 530.0, 77.0, 0.0, 110.0, 50.0, 80.0, 61.0, -20.0, 82.0, 25.0, 220.0, 49.0, 70.0, 50.0, 41.0, 30.0, 39.0, 60.0, 28.0, 100.0, 70.0, 60.0, 80.0, 54.0, 10.0, 36.0, 70.0, 230.0, 80.0, 37.0, 56.0, 8.0, 1.0, 19.0, 200.0, 22.0, -13.0, 40.0, 45.0, 23.0, 44.0, 70.0, 20.0, 31.0, 80.0, 16.0, -4.0, 30.0, 47.0, 180.0, 4.0, 17.0, 90.0, 150.0, 20.0, 30.0, 50.0, 20.0, 10.0, 29.0, 36.0, -20.0, 150.0, 39.0, 80.0, 110.0, 170.0, 8.0, -13.0, 0.0, 40.0, 29.0, 30.0, 110.0, -1.0, 19.0, 60.0, 110.0, 10.0, 75.0, 79.0, 90.0, 91.0, 30.0, 53.0, 130.0, 19.0, 80.0, 90.0, 110.0, 40.0, 20.0, 50.0, 60.0, 60.0, 15.0, 280.0, -20.0, 10.0, 14.0, 30.0, 150.0, 69.0, 69.0, -3.0, 40.0, 53.0, 40.0, 10.0, 70.0, 0.0, 69.0, 70.0, 110.0, 70.0, 181.0, 67.0, 90.0, 50.0, 57.0, 60.0, 130.0, 40.0, 60.0, 67.0, 0.0, -20.0, 70.0, 300.0, 180.0, 90.0, 50.0, 64.0, 80.0, 100.0, 60.0, 69.0, 60.0, 33.0, 50.0, 30.0, -93.0, 58.0, 80.0, 70.0, 47.0, 60.0, 100.0, 88.0, 20.0, 70.0, 20.0, 110.0, 30.0, 80.0, 90.0, 30.0, 156.0, 90.0, 50.0, 25.0, 35.0, 18.0, 120.0, 150.0, 50.0, 40.0, 80.0, 22.0, -5.0, 40.0, 48.0, 40.0, 70.0, 90.0, 235.0, 110.0, 100.0, 86.0, 20.0, 200.0, 30.0, 50.0, -20.0, 30.0, 200.0, 30.0, 80.0, 39.0, -64.0, 90.0, 515.0, 40.0, 65.0, 50.0, 27.0, 53.0, 50.0, 90.0, 6.0, 20.0, 4.0, 30.0, 30.0, 30.0, 30.0, 50.0, 147.0, 117.0, 80.0, 79.0, 30.0, 400.0, 20.0, 90.0, 0.0, 47.0, 20.0, 50.0, 70.0, 70.0, 39.0, 40.0, -170.0, 210.0, 60.0, 287.0, 69.0, 70.0, 80.0, 126.0, 8.0, 37.0, 29.0, 60.0, 60.0, 80.0, 430.0, -21.0, 40.0, 690.0, 40.0, 100.0, 100.0, 140.0, 30.0, 110.0, -200.0, 40.0, 50.0, 50.0, 300.0, 40.0, 115.0, 70.0, 84.0, 80.0, 70.0, 59.0, 49.0, 70.0, 120.0, 150.0, 60.0, 50.0, 20.0, 50.0, 30.0, 20.0, 10.0, 75.0, 80.0, 100.0, 230.0, 30.0, 90.0, 90.0, 50.0, 66.0, 48.0, 19.0, 7.0, -224.0, 105.0, 70.0, 57.0, 3.0, 95.0, 45.0, 50.0, 307.0, 84.0, 40.0, 130.0, 100.0, -28.0, 400.0, 50.0, 70.0, 60.0, 70.0, -10.0, 60.0, 60.0, 60.0, 30.0, 50.0, 8.0, 50.0, 80.0, 230.0, 80.0, 178.0, 60.0, 120.0, 70.0, 54.0, 100.0, 59.0, 60.0, 80.0, 110.0, 30.0, 60.0, 50.0, 90.0, 62.0, 77.0, 74.0, 78.0, 50.0, 50.0, 35.0, -4.0, 190.0, 62.0, 168.0, 23.0, 10.0, 33.0, 48.0, -47.0, 50.0, 89.0, 300.0, 70.0, 150.0, 80.0, 100.0, 354.0, 60.0, 10.0, 80.0, 49.0, 50.0, 80.0, 100.0, 70.0, 200.0, 60.0, 170.0, 70.0, 70.0, 35.0, 44.0, -50.0, 90.0, 60.0, 90.0, 40.0, -1.0, 40.0, 440.0, 4.0, 50.0, 10.0, -24.0, 170.0, 200.0, 28.0, 20.0, 289.0, 60.0, 4.0, 110.0, 70.0, 87.0, 49.0, 246.0, 150.0, 22.0, 100.0, 60.0, 40.0, 20.0, 50.0, 120.0, 60.0, 30.0, 210.0, 90.0, 70.0, 80.0, 50.0, 100.0, 70.0, 27.0, 88.0, 60.0, 40.0, 18.0, 70.0, 30.0, 60.0, 50.0, 60.0, 50.0, 14.0, 38.0, 90.0, 300.0, 80.0, 100.0, 30.0, 80.0, 58.0, 89.0, 50.0, 9.0, 20.0, 60.0, 30.0, 30.0, 110.0, 40.0, 27.0, 130.0, 90.0, 70.0, 159.0, 50.0, 70.0, 50.0, 28.0, 175.0, 100.0, 110.0, 120.0, 100.0, 60.0, 60.0, 120.0, 180.0, 59.0, 20.0, 80.0, 28.0, 38.0, 60.0, 90.0, 80.0, 100.0, 60.0, 110.0, 50.0, 58.0, 100.0, 88.0, 110.0, 20.0, 39.0, 22.0, 30.0, 40.0, 100.0, 50.0, 30.0, 96.0, 60.0, 140.0, 45.0, 100.0, 80.0, 60.0, 100.0, 77.0, 35.0, 170.0, -1.0, 70.0, 50.0, 30.0, 40.0, 50.0, 90.0, 20.0, 20.0, 40.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9630344593818756, "mean_inference_ms": 2.2326156120167306, "mean_action_processing_ms": 0.756397686538582, "mean_env_wait_ms": 1.5631192709210842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06592273712158203, "StateBufferConnector_ms": 0.010017871856689453, "ViewRequirementAgentConnector_ms": 0.47368407249450684}, "num_episodes": 18, "episode_return_max": 1356.0, "episode_return_min": -120.0, "episode_return_mean": 705.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.5019610381186, "num_env_steps_trained_throughput_per_sec": 32.5019610381186, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 4000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000000, "timers": {"training_iteration_time_ms": 127431.273, "restore_workers_time_ms": 0.015, "training_step_time_ms": 127431.218, "sample_time_ms": 3521.726, "learn_time_ms": 123885.436, "learn_throughput": 32.288, "synch_weights_time_ms": 13.036}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "done": false, "training_iteration": 100, "trial_id": "6085c_00000", "date": "2024-07-02_02-22-40", "timestamp": 1719901360, "time_this_iter_s": 123.17789697647095, "time_total_s": 14206.668029785156, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13800ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14206.668029785156, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 21.256321839080464, "ram_util_percent": 79.32758620689656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.788228924129718, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.110348706504407, "policy_loss": -0.006287627163255355, "vf_loss": 7.115710856891669, "vf_explained_var": 0.0032072332783882863, "kl": 0.009254759132306542, "entropy": 0.6636084203268139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 943695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "env_runners": {"episode_reward_max": 1285.0, "episode_reward_min": 225.0, "episode_reward_mean": 731.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -224.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 73.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [559.0, 665.0, 680.0, 963.0, 692.0, 640.0, 700.0, 1285.0, 616.0, 940.0, 663.0, 853.0, 937.0, 982.0, 1017.0, 537.0, 583.0, 558.0, 610.0, 722.0, 675.0, 913.0, 662.0, 579.0, 632.0, 946.0, 752.0, 1068.0, 612.0, 790.0, 415.0, 357.0, 571.0, 589.0, 407.0, 737.0, 625.0, 472.0, 777.0, 764.0, 786.0, 490.0, 696.0, 590.0, 814.0, 659.0, 916.0, 464.0, 816.0, 745.0, 889.0, 1090.0, 918.0, 619.0, 821.0, 225.0, 1203.0, 438.0, 1031.0, 693.0, 662.0, 873.0, 1053.0, 639.0, 929.0, 963.0, 652.0, 845.0, 430.0, 886.0, 607.0, 962.0, 705.0, 846.0, 487.0, 806.0, 510.0, 676.0, 803.0, 709.0, 706.0, 562.0, 504.0, 925.0, 655.0, 829.0, 830.0, 1192.0, 588.0, 613.0, 545.0, 453.0, 1207.0, 449.0, 934.0, 619.0, 828.0, 672.0, 773.0, 820.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 29.0, 10.0, 25.0, 20.0, 80.0, 220.0, 90.0, 50.0, -15.0, 100.0, 60.0, 80.0, 48.0, 50.0, 48.0, 80.0, 159.0, 20.0, 20.0, 10.0, 70.0, 50.0, 150.0, 163.0, 27.0, 80.0, 70.0, 40.0, 20.0, 90.0, 160.0, 80.0, 70.0, 160.0, 177.0, 170.0, -20.0, 46.0, 30.0, 210.0, 20.0, 90.0, -22.0, 50.0, 70.0, 80.0, 40.0, 170.0, -16.0, 50.0, 80.0, 90.0, 0.0, 110.0, 70.0, 60.0, 60.0, 40.0, 80.0, 70.0, 55.0, 70.0, 80.0, -7.0, 120.0, 60.0, 27.0, 75.0, 150.0, 118.0, 59.0, 100.0, 120.0, 90.0, 228.0, 100.0, 230.0, 110.0, 130.0, 49.0, 70.0, 90.0, 90.0, 70.0, 48.0, 20.0, 59.0, 80.0, 40.0, 180.0, 70.0, 90.0, 90.0, 200.0, 10.0, 60.0, 150.0, 50.0, 40.0, 50.0, 70.0, 320.0, 10.0, 47.0, 30.0, 60.0, -40.0, 90.0, 26.0, 70.0, 60.0, 149.0, 52.0, 40.0, 0.0, 50.0, 327.0, 80.0, 25.0, 8.0, 80.0, 208.0, -21.0, 100.0, 80.0, 6.0, 26.0, 270.0, 180.0, 90.0, 50.0, 30.0, 100.0, -10.0, 42.0, 100.0, 120.0, 52.0, 408.0, 40.0, 67.0, 176.0, 30.0, 109.0, 300.0, -23.0, 58.0, 50.0, 210.0, -10.0, 180.0, 40.0, 50.0, 39.0, 70.0, 38.0, 50.0, 60.0, 20.0, 110.0, -50.0, 90.0, 79.0, 74.0, 13.0, 67.0, 90.0, 50.0, 60.0, 47.0, 40.0, 80.0, 39.0, 59.0, 80.0, 60.0, 83.0, 50.0, 20.0, 20.0, 70.0, 70.0, 80.0, 148.0, 50.0, 22.0, 40.0, 60.0, 50.0, 50.0, -22.0, 36.0, 39.0, 280.0, 130.0, 50.0, 39.0, 90.0, 30.0, 70.0, 50.0, 24.0, -24.0, 20.0, 84.0, 11.0, 260.0, 34.0, 146.0, 220.0, 50.0, 100.0, 70.0, 46.0, 90.0, 47.0, 110.0, 130.0, 50.0, 30.0, -28.0, 120.0, 80.0, 90.0, 50.0, 59.0, 50.0, 31.0, 180.0, 59.0, 70.0, 40.0, 40.0, 80.0, 60.0, 20.0, 90.0, 80.0, 40.0, 100.0, -7.0, 10.0, 59.0, 90.0, 110.0, 70.0, 40.0, 110.0, 50.0, 230.0, 100.0, 25.0, 20.0, 82.0, 50.0, 90.0, 50.0, 260.0, 39.0, 95.0, 94.0, 64.0, 119.0, 80.0, 40.0, 70.0, 70.0, 60.0, 60.0, 98.0, 530.0, 77.0, 0.0, 110.0, 50.0, 80.0, 61.0, -20.0, 82.0, 25.0, 220.0, 49.0, 70.0, 50.0, 41.0, 30.0, 39.0, 60.0, 28.0, 100.0, 70.0, 60.0, 80.0, 54.0, 10.0, 36.0, 70.0, 230.0, 80.0, 37.0, 56.0, 8.0, 1.0, 19.0, 200.0, 22.0, -13.0, 40.0, 45.0, 23.0, 44.0, 70.0, 20.0, 31.0, 80.0, 16.0, -4.0, 30.0, 47.0, 180.0, 4.0, 17.0, 90.0, 150.0, 20.0, 30.0, 50.0, 20.0, 10.0, 29.0, 36.0, -20.0, 150.0, 39.0, 80.0, 110.0, 170.0, 8.0, -13.0, 0.0, 40.0, 29.0, 30.0, 110.0, -1.0, 19.0, 60.0, 110.0, 10.0, 75.0, 79.0, 90.0, 91.0, 30.0, 53.0, 130.0, 19.0, 80.0, 90.0, 110.0, 40.0, 20.0, 50.0, 60.0, 60.0, 15.0, 280.0, -20.0, 10.0, 14.0, 30.0, 150.0, 69.0, 69.0, -3.0, 40.0, 53.0, 40.0, 10.0, 70.0, 0.0, 69.0, 70.0, 110.0, 70.0, 181.0, 67.0, 90.0, 50.0, 57.0, 60.0, 130.0, 40.0, 60.0, 67.0, 0.0, -20.0, 70.0, 300.0, 180.0, 90.0, 50.0, 64.0, 80.0, 100.0, 60.0, 69.0, 60.0, 33.0, 50.0, 30.0, -93.0, 58.0, 80.0, 70.0, 47.0, 60.0, 100.0, 88.0, 20.0, 70.0, 20.0, 110.0, 30.0, 80.0, 90.0, 30.0, 156.0, 90.0, 50.0, 25.0, 35.0, 18.0, 120.0, 150.0, 50.0, 40.0, 80.0, 22.0, -5.0, 40.0, 48.0, 40.0, 70.0, 90.0, 235.0, 110.0, 100.0, 86.0, 20.0, 200.0, 30.0, 50.0, -20.0, 30.0, 200.0, 30.0, 80.0, 39.0, -64.0, 90.0, 515.0, 40.0, 65.0, 50.0, 27.0, 53.0, 50.0, 90.0, 6.0, 20.0, 4.0, 30.0, 30.0, 30.0, 30.0, 50.0, 147.0, 117.0, 80.0, 79.0, 30.0, 400.0, 20.0, 90.0, 0.0, 47.0, 20.0, 50.0, 70.0, 70.0, 39.0, 40.0, -170.0, 210.0, 60.0, 287.0, 69.0, 70.0, 80.0, 126.0, 8.0, 37.0, 29.0, 60.0, 60.0, 80.0, 430.0, -21.0, 40.0, 690.0, 40.0, 100.0, 100.0, 140.0, 30.0, 110.0, -200.0, 40.0, 50.0, 50.0, 300.0, 40.0, 115.0, 70.0, 84.0, 80.0, 70.0, 59.0, 49.0, 70.0, 120.0, 150.0, 60.0, 50.0, 20.0, 50.0, 30.0, 20.0, 10.0, 75.0, 80.0, 100.0, 230.0, 30.0, 90.0, 90.0, 50.0, 66.0, 48.0, 19.0, 7.0, -224.0, 105.0, 70.0, 57.0, 3.0, 95.0, 45.0, 50.0, 307.0, 84.0, 40.0, 130.0, 100.0, -28.0, 400.0, 50.0, 70.0, 60.0, 70.0, -10.0, 60.0, 60.0, 60.0, 30.0, 50.0, 8.0, 50.0, 80.0, 230.0, 80.0, 178.0, 60.0, 120.0, 70.0, 54.0, 100.0, 59.0, 60.0, 80.0, 110.0, 30.0, 60.0, 50.0, 90.0, 62.0, 77.0, 74.0, 78.0, 50.0, 50.0, 35.0, -4.0, 190.0, 62.0, 168.0, 23.0, 10.0, 33.0, 48.0, -47.0, 50.0, 89.0, 300.0, 70.0, 150.0, 80.0, 100.0, 354.0, 60.0, 10.0, 80.0, 49.0, 50.0, 80.0, 100.0, 70.0, 200.0, 60.0, 170.0, 70.0, 70.0, 35.0, 44.0, -50.0, 90.0, 60.0, 90.0, 40.0, -1.0, 40.0, 440.0, 4.0, 50.0, 10.0, -24.0, 170.0, 200.0, 28.0, 20.0, 289.0, 60.0, 4.0, 110.0, 70.0, 87.0, 49.0, 246.0, 150.0, 22.0, 100.0, 60.0, 40.0, 20.0, 50.0, 120.0, 60.0, 30.0, 210.0, 90.0, 70.0, 80.0, 50.0, 100.0, 70.0, 27.0, 88.0, 60.0, 40.0, 18.0, 70.0, 30.0, 60.0, 50.0, 60.0, 50.0, 14.0, 38.0, 90.0, 300.0, 80.0, 100.0, 30.0, 80.0, 58.0, 89.0, 50.0, 9.0, 20.0, 60.0, 30.0, 30.0, 110.0, 40.0, 27.0, 130.0, 90.0, 70.0, 159.0, 50.0, 70.0, 50.0, 28.0, 175.0, 100.0, 110.0, 120.0, 100.0, 60.0, 60.0, 120.0, 180.0, 59.0, 20.0, 80.0, 28.0, 38.0, 60.0, 90.0, 80.0, 100.0, 60.0, 110.0, 50.0, 58.0, 100.0, 88.0, 110.0, 20.0, 39.0, 22.0, 30.0, 40.0, 100.0, 50.0, 30.0, 96.0, 60.0, 140.0, 45.0, 100.0, 80.0, 60.0, 100.0, 77.0, 35.0, 170.0, -1.0, 70.0, 50.0, 30.0, 40.0, 50.0, 90.0, 20.0, 20.0, 40.0, 100.0, 180.0, 50.0, 80.0, 59.0, 88.0, 89.0, 80.0, -47.0, 20.0, 77.0, 200.0, 100.0, 37.0, 165.0, -33.0, 60.0, 49.0, 120.0, 80.0, 25.0, 40.0, 50.0, 80.0, 60.0, 50.0, 139.0, 140.0, 30.0, 70.0, 50.0, 69.0, 60.0, 48.0, 24.0, 70.0, 55.0, 60.0, 90.0, 60.0, 170.0, 100.0, 221.0, 9.0, 39.0, 40.0, 19.0, 60.0, 70.0, -56.0, 60.0, 49.0, 42.0, 60.0, 70.0, 57.0, 35.0, 59.0, -7.0, 69.0, 70.0, 120.0, 130.0, 60.0, 146.0, 80.0, 39.0, 70.0, 70.0, 30.0, 180.0, 74.0, 69.0, 60.0, 50.0, 60.0, 27.0, 76.0, 79.0, 110.0, 50.0, 87.0, 5.0, 80.0, 70.0, 63.0, 197.0, 67.0, 20.0, 70.0, 170.0, 40.0, 410.0, 82.0, 60.0, -7.0, 40.0, 103.0, 12.0, 30.0, 60.0, 70.0, 20.0, 55.0, 367.0, 60.0, 283.0, 80.0, 96.0, 87.0, 74.0, 40.0, 60.0, 33.0, 46.0, 70.0, 86.0, 60.0, 13.0, 80.0, 100.0, 60.0, 69.0, 50.0, 98.0, 36.0, 192.0, 48.0, 27.0, 19.0, 14.0, 96.0, 65.0, 50.0, 150.0, 0.0, 60.0, 64.0, 12.0, -32.0, 80.0, 39.0, 40.0, 130.0, 19.0, 90.0, 20.0, 50.0, -3.0, 49.0, 19.0, 80.0, 190.0, 100.0, 580.0, 120.0, 120.0, 11.0, -20.0, 60.0, -34.0, 30.0, 70.0, 6.0, 70.0, 30.0, 24.0, 19.0, 70.0, 70.0, 60.0, 40.0, 118.0, 410.0, -102.0, 30.0, 50.0, 50.0, 90.0, 169.0, 79.0, 10.0, 13.0, 300.0, 21.0, 11.0, 110.0, 50.0, 34.0, 50.0, 20.0, 25.0, 60.0, 70.0, 35.0, 30.0, 70.0, 170.0, 190.0, 140.0, 38.0, 120.0, 50.0, 100.0, 52.0, 70.0, 79.0, 50.0, 70.0, 35.0, 46.0, 59.0, 70.0, 90.0, 57.0, -34.0, 170.0, 75.0, 117.0, 90.0, 79.0, 110.0, 90.0, 50.0, 60.0, 80.0, 140.0, 60.0, 110.0, 50.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9638457255548314, "mean_inference_ms": 2.2303800838851586, "mean_action_processing_ms": 0.7585642241087963, "mean_env_wait_ms": 1.5616831528185398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06779599189758301, "StateBufferConnector_ms": 0.010149478912353516, "ViewRequirementAgentConnector_ms": 0.49242210388183594}, "num_episodes": 23, "episode_return_max": 1285.0, "episode_return_min": 225.0, "episode_return_mean": 731.95, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.502924305296375, "num_env_steps_trained_throughput_per_sec": 32.502924305296375, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 4040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4040000, "timers": {"training_iteration_time_ms": 123667.424, "restore_workers_time_ms": 0.015, "training_step_time_ms": 123667.368, "sample_time_ms": 3486.1, "learn_time_ms": 120157.977, "learn_throughput": 33.29, "synch_weights_time_ms": 13.129}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "done": false, "training_iteration": 101, "trial_id": "6085c_00000", "date": "2024-07-02_02-24-43", "timestamp": 1719901483, "time_this_iter_s": 123.10771489143372, "time_total_s": 14329.77574467659, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138adfb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14329.77574467659, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 20.348275862068967, "ram_util_percent": 80.11781609195404}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.928618537960723, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.218896880926796, "policy_loss": -0.007293312260593437, "vf_loss": 7.225259123620388, "vf_explained_var": 0.0029274595875582628, "kl": 0.009310613803238643, "entropy": 0.6580281203166365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 953085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "env_runners": {"episode_reward_max": 1207.0, "episode_reward_min": 225.0, "episode_reward_mean": 715.03, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -405.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 71.503}, "custom_metrics": {}, "hist_stats": {"episode_reward": [610.0, 722.0, 675.0, 913.0, 662.0, 579.0, 632.0, 946.0, 752.0, 1068.0, 612.0, 790.0, 415.0, 357.0, 571.0, 589.0, 407.0, 737.0, 625.0, 472.0, 777.0, 764.0, 786.0, 490.0, 696.0, 590.0, 814.0, 659.0, 916.0, 464.0, 816.0, 745.0, 889.0, 1090.0, 918.0, 619.0, 821.0, 225.0, 1203.0, 438.0, 1031.0, 693.0, 662.0, 873.0, 1053.0, 639.0, 929.0, 963.0, 652.0, 845.0, 430.0, 886.0, 607.0, 962.0, 705.0, 846.0, 487.0, 806.0, 510.0, 676.0, 803.0, 709.0, 706.0, 562.0, 504.0, 925.0, 655.0, 829.0, 830.0, 1192.0, 588.0, 613.0, 545.0, 453.0, 1207.0, 449.0, 934.0, 619.0, 828.0, 672.0, 773.0, 820.0, 621.0, 594.0, 573.0, 869.0, 843.0, 824.0, 1026.0, 685.0, 723.0, 794.0, 289.0, 614.0, 348.0, 775.0, 873.0, 565.0, 692.0, 470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 70.0, 70.0, 80.0, 148.0, 50.0, 22.0, 40.0, 60.0, 50.0, 50.0, -22.0, 36.0, 39.0, 280.0, 130.0, 50.0, 39.0, 90.0, 30.0, 70.0, 50.0, 24.0, -24.0, 20.0, 84.0, 11.0, 260.0, 34.0, 146.0, 220.0, 50.0, 100.0, 70.0, 46.0, 90.0, 47.0, 110.0, 130.0, 50.0, 30.0, -28.0, 120.0, 80.0, 90.0, 50.0, 59.0, 50.0, 31.0, 180.0, 59.0, 70.0, 40.0, 40.0, 80.0, 60.0, 20.0, 90.0, 80.0, 40.0, 100.0, -7.0, 10.0, 59.0, 90.0, 110.0, 70.0, 40.0, 110.0, 50.0, 230.0, 100.0, 25.0, 20.0, 82.0, 50.0, 90.0, 50.0, 260.0, 39.0, 95.0, 94.0, 64.0, 119.0, 80.0, 40.0, 70.0, 70.0, 60.0, 60.0, 98.0, 530.0, 77.0, 0.0, 110.0, 50.0, 80.0, 61.0, -20.0, 82.0, 25.0, 220.0, 49.0, 70.0, 50.0, 41.0, 30.0, 39.0, 60.0, 28.0, 100.0, 70.0, 60.0, 80.0, 54.0, 10.0, 36.0, 70.0, 230.0, 80.0, 37.0, 56.0, 8.0, 1.0, 19.0, 200.0, 22.0, -13.0, 40.0, 45.0, 23.0, 44.0, 70.0, 20.0, 31.0, 80.0, 16.0, -4.0, 30.0, 47.0, 180.0, 4.0, 17.0, 90.0, 150.0, 20.0, 30.0, 50.0, 20.0, 10.0, 29.0, 36.0, -20.0, 150.0, 39.0, 80.0, 110.0, 170.0, 8.0, -13.0, 0.0, 40.0, 29.0, 30.0, 110.0, -1.0, 19.0, 60.0, 110.0, 10.0, 75.0, 79.0, 90.0, 91.0, 30.0, 53.0, 130.0, 19.0, 80.0, 90.0, 110.0, 40.0, 20.0, 50.0, 60.0, 60.0, 15.0, 280.0, -20.0, 10.0, 14.0, 30.0, 150.0, 69.0, 69.0, -3.0, 40.0, 53.0, 40.0, 10.0, 70.0, 0.0, 69.0, 70.0, 110.0, 70.0, 181.0, 67.0, 90.0, 50.0, 57.0, 60.0, 130.0, 40.0, 60.0, 67.0, 0.0, -20.0, 70.0, 300.0, 180.0, 90.0, 50.0, 64.0, 80.0, 100.0, 60.0, 69.0, 60.0, 33.0, 50.0, 30.0, -93.0, 58.0, 80.0, 70.0, 47.0, 60.0, 100.0, 88.0, 20.0, 70.0, 20.0, 110.0, 30.0, 80.0, 90.0, 30.0, 156.0, 90.0, 50.0, 25.0, 35.0, 18.0, 120.0, 150.0, 50.0, 40.0, 80.0, 22.0, -5.0, 40.0, 48.0, 40.0, 70.0, 90.0, 235.0, 110.0, 100.0, 86.0, 20.0, 200.0, 30.0, 50.0, -20.0, 30.0, 200.0, 30.0, 80.0, 39.0, -64.0, 90.0, 515.0, 40.0, 65.0, 50.0, 27.0, 53.0, 50.0, 90.0, 6.0, 20.0, 4.0, 30.0, 30.0, 30.0, 30.0, 50.0, 147.0, 117.0, 80.0, 79.0, 30.0, 400.0, 20.0, 90.0, 0.0, 47.0, 20.0, 50.0, 70.0, 70.0, 39.0, 40.0, -170.0, 210.0, 60.0, 287.0, 69.0, 70.0, 80.0, 126.0, 8.0, 37.0, 29.0, 60.0, 60.0, 80.0, 430.0, -21.0, 40.0, 690.0, 40.0, 100.0, 100.0, 140.0, 30.0, 110.0, -200.0, 40.0, 50.0, 50.0, 300.0, 40.0, 115.0, 70.0, 84.0, 80.0, 70.0, 59.0, 49.0, 70.0, 120.0, 150.0, 60.0, 50.0, 20.0, 50.0, 30.0, 20.0, 10.0, 75.0, 80.0, 100.0, 230.0, 30.0, 90.0, 90.0, 50.0, 66.0, 48.0, 19.0, 7.0, -224.0, 105.0, 70.0, 57.0, 3.0, 95.0, 45.0, 50.0, 307.0, 84.0, 40.0, 130.0, 100.0, -28.0, 400.0, 50.0, 70.0, 60.0, 70.0, -10.0, 60.0, 60.0, 60.0, 30.0, 50.0, 8.0, 50.0, 80.0, 230.0, 80.0, 178.0, 60.0, 120.0, 70.0, 54.0, 100.0, 59.0, 60.0, 80.0, 110.0, 30.0, 60.0, 50.0, 90.0, 62.0, 77.0, 74.0, 78.0, 50.0, 50.0, 35.0, -4.0, 190.0, 62.0, 168.0, 23.0, 10.0, 33.0, 48.0, -47.0, 50.0, 89.0, 300.0, 70.0, 150.0, 80.0, 100.0, 354.0, 60.0, 10.0, 80.0, 49.0, 50.0, 80.0, 100.0, 70.0, 200.0, 60.0, 170.0, 70.0, 70.0, 35.0, 44.0, -50.0, 90.0, 60.0, 90.0, 40.0, -1.0, 40.0, 440.0, 4.0, 50.0, 10.0, -24.0, 170.0, 200.0, 28.0, 20.0, 289.0, 60.0, 4.0, 110.0, 70.0, 87.0, 49.0, 246.0, 150.0, 22.0, 100.0, 60.0, 40.0, 20.0, 50.0, 120.0, 60.0, 30.0, 210.0, 90.0, 70.0, 80.0, 50.0, 100.0, 70.0, 27.0, 88.0, 60.0, 40.0, 18.0, 70.0, 30.0, 60.0, 50.0, 60.0, 50.0, 14.0, 38.0, 90.0, 300.0, 80.0, 100.0, 30.0, 80.0, 58.0, 89.0, 50.0, 9.0, 20.0, 60.0, 30.0, 30.0, 110.0, 40.0, 27.0, 130.0, 90.0, 70.0, 159.0, 50.0, 70.0, 50.0, 28.0, 175.0, 100.0, 110.0, 120.0, 100.0, 60.0, 60.0, 120.0, 180.0, 59.0, 20.0, 80.0, 28.0, 38.0, 60.0, 90.0, 80.0, 100.0, 60.0, 110.0, 50.0, 58.0, 100.0, 88.0, 110.0, 20.0, 39.0, 22.0, 30.0, 40.0, 100.0, 50.0, 30.0, 96.0, 60.0, 140.0, 45.0, 100.0, 80.0, 60.0, 100.0, 77.0, 35.0, 170.0, -1.0, 70.0, 50.0, 30.0, 40.0, 50.0, 90.0, 20.0, 20.0, 40.0, 100.0, 180.0, 50.0, 80.0, 59.0, 88.0, 89.0, 80.0, -47.0, 20.0, 77.0, 200.0, 100.0, 37.0, 165.0, -33.0, 60.0, 49.0, 120.0, 80.0, 25.0, 40.0, 50.0, 80.0, 60.0, 50.0, 139.0, 140.0, 30.0, 70.0, 50.0, 69.0, 60.0, 48.0, 24.0, 70.0, 55.0, 60.0, 90.0, 60.0, 170.0, 100.0, 221.0, 9.0, 39.0, 40.0, 19.0, 60.0, 70.0, -56.0, 60.0, 49.0, 42.0, 60.0, 70.0, 57.0, 35.0, 59.0, -7.0, 69.0, 70.0, 120.0, 130.0, 60.0, 146.0, 80.0, 39.0, 70.0, 70.0, 30.0, 180.0, 74.0, 69.0, 60.0, 50.0, 60.0, 27.0, 76.0, 79.0, 110.0, 50.0, 87.0, 5.0, 80.0, 70.0, 63.0, 197.0, 67.0, 20.0, 70.0, 170.0, 40.0, 410.0, 82.0, 60.0, -7.0, 40.0, 103.0, 12.0, 30.0, 60.0, 70.0, 20.0, 55.0, 367.0, 60.0, 283.0, 80.0, 96.0, 87.0, 74.0, 40.0, 60.0, 33.0, 46.0, 70.0, 86.0, 60.0, 13.0, 80.0, 100.0, 60.0, 69.0, 50.0, 98.0, 36.0, 192.0, 48.0, 27.0, 19.0, 14.0, 96.0, 65.0, 50.0, 150.0, 0.0, 60.0, 64.0, 12.0, -32.0, 80.0, 39.0, 40.0, 130.0, 19.0, 90.0, 20.0, 50.0, -3.0, 49.0, 19.0, 80.0, 190.0, 100.0, 580.0, 120.0, 120.0, 11.0, -20.0, 60.0, -34.0, 30.0, 70.0, 6.0, 70.0, 30.0, 24.0, 19.0, 70.0, 70.0, 60.0, 40.0, 118.0, 410.0, -102.0, 30.0, 50.0, 50.0, 90.0, 169.0, 79.0, 10.0, 13.0, 300.0, 21.0, 11.0, 110.0, 50.0, 34.0, 50.0, 20.0, 25.0, 60.0, 70.0, 35.0, 30.0, 70.0, 170.0, 190.0, 140.0, 38.0, 120.0, 50.0, 100.0, 52.0, 70.0, 79.0, 50.0, 70.0, 35.0, 46.0, 59.0, 70.0, 90.0, 57.0, -34.0, 170.0, 75.0, 117.0, 90.0, 79.0, 110.0, 90.0, 50.0, 60.0, 80.0, 140.0, 60.0, 110.0, 50.0, 70.0, 26.0, 210.0, 50.0, 70.0, 60.0, 25.0, 180.0, -22.0, -8.0, 30.0, -10.0, 170.0, 44.0, 80.0, 10.0, 95.0, 160.0, 10.0, -25.0, 60.0, -48.0, 10.0, 32.0, 4.0, 70.0, 1.0, 50.0, 410.0, 17.0, 27.0, 90.0, 100.0, 200.0, 40.0, 110.0, 80.0, 69.0, 60.0, 30.0, 90.0, 43.0, 53.0, 16.0, 80.0, 90.0, 227.0, 68.0, 160.0, 60.0, 46.0, 70.0, 140.0, 10.0, 70.0, 120.0, 89.0, 82.0, 80.0, 133.0, 30.0, 3.0, 73.0, -39.0, 37.0, 178.0, 15.0, -1.0, 100.0, 50.0, 610.0, 60.0, 79.0, 60.0, 110.0, 90.0, 150.0, -54.0, 100.0, 70.0, 20.0, -92.0, -10.0, 120.0, 90.0, 7.0, 60.0, 210.0, 37.0, 243.0, 58.0, 60.0, 30.0, 49.0, 500.0, 180.0, 130.0, 100.0, 40.0, 110.0, -405.0, 30.0, -223.0, 106.0, 15.0, 60.0, 50.0, 144.0, 40.0, 17.0, 50.0, 10.0, 190.0, 50.0, 90.0, 39.0, 40.0, 70.0, 60.0, 40.0, 25.0, 70.0, -5.0, 68.0, 41.0, 28.0, 35.0, 23.0, -12.0, 40.0, 60.0, 60.0, 70.0, 60.0, 230.0, 50.0, 100.0, 103.0, -9.0, 11.0, 100.0, 20.0, 30.0, 90.0, 110.0, 60.0, 33.0, 60.0, 140.0, 180.0, 150.0, 30.0, -1.0, 64.0, 60.0, 30.0, 170.0, 17.0, 50.0, 50.0, 95.0, 0.0, 97.0, 88.0, 109.0, 65.0, 25.0, 19.0, 50.0, 119.0, 120.0, 80.0, 30.0, 50.0, 70.0, 20.0, 50.0, 10.0, 70.0, 60.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9653897909914837, "mean_inference_ms": 2.2294813518992362, "mean_action_processing_ms": 0.7601260680211549, "mean_env_wait_ms": 1.561059722573562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06482338905334473, "StateBufferConnector_ms": 0.010016202926635742, "ViewRequirementAgentConnector_ms": 0.501396894454956}, "num_episodes": 18, "episode_return_max": 1207.0, "episode_return_min": 225.0, "episode_return_mean": 715.03, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.563420880720756, "num_env_steps_trained_throughput_per_sec": 32.563420880720756, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 4080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4080000, "timers": {"training_iteration_time_ms": 123430.639, "restore_workers_time_ms": 0.014, "training_step_time_ms": 123430.581, "sample_time_ms": 3479.325, "learn_time_ms": 119928.389, "learn_throughput": 33.353, "synch_weights_time_ms": 12.944}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "done": false, "training_iteration": 102, "trial_id": "6085c_00000", "date": "2024-07-02_02-26-46", "timestamp": 1719901606, "time_this_iter_s": 122.84817504882812, "time_total_s": 14452.623919725418, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c52e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14452.623919725418, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 20.195977011494254, "ram_util_percent": 80.0551724137931}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.005787630685475, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.815420426550511, "policy_loss": -0.007276870625780914, "vf_loss": 6.821737004697513, "vf_explained_var": 0.0021230604448003636, "kl": 0.00960284999723911, "entropy": 0.6656072144088145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 962475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "env_runners": {"episode_reward_max": 1209.0, "episode_reward_min": 225.0, "episode_reward_mean": 724.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -405.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 72.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [786.0, 490.0, 696.0, 590.0, 814.0, 659.0, 916.0, 464.0, 816.0, 745.0, 889.0, 1090.0, 918.0, 619.0, 821.0, 225.0, 1203.0, 438.0, 1031.0, 693.0, 662.0, 873.0, 1053.0, 639.0, 929.0, 963.0, 652.0, 845.0, 430.0, 886.0, 607.0, 962.0, 705.0, 846.0, 487.0, 806.0, 510.0, 676.0, 803.0, 709.0, 706.0, 562.0, 504.0, 925.0, 655.0, 829.0, 830.0, 1192.0, 588.0, 613.0, 545.0, 453.0, 1207.0, 449.0, 934.0, 619.0, 828.0, 672.0, 773.0, 820.0, 621.0, 594.0, 573.0, 869.0, 843.0, 824.0, 1026.0, 685.0, 723.0, 794.0, 289.0, 614.0, 348.0, 775.0, 873.0, 565.0, 692.0, 470.0, 580.0, 453.0, 766.0, 459.0, 504.0, 450.0, 716.0, 812.0, 837.0, 615.0, 749.0, 863.0, 588.0, 744.0, 788.0, 758.0, 1209.0, 621.0, 1079.0, 577.0, 415.0, 1019.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 90.0, 50.0, 64.0, 80.0, 100.0, 60.0, 69.0, 60.0, 33.0, 50.0, 30.0, -93.0, 58.0, 80.0, 70.0, 47.0, 60.0, 100.0, 88.0, 20.0, 70.0, 20.0, 110.0, 30.0, 80.0, 90.0, 30.0, 156.0, 90.0, 50.0, 25.0, 35.0, 18.0, 120.0, 150.0, 50.0, 40.0, 80.0, 22.0, -5.0, 40.0, 48.0, 40.0, 70.0, 90.0, 235.0, 110.0, 100.0, 86.0, 20.0, 200.0, 30.0, 50.0, -20.0, 30.0, 200.0, 30.0, 80.0, 39.0, -64.0, 90.0, 515.0, 40.0, 65.0, 50.0, 27.0, 53.0, 50.0, 90.0, 6.0, 20.0, 4.0, 30.0, 30.0, 30.0, 30.0, 50.0, 147.0, 117.0, 80.0, 79.0, 30.0, 400.0, 20.0, 90.0, 0.0, 47.0, 20.0, 50.0, 70.0, 70.0, 39.0, 40.0, -170.0, 210.0, 60.0, 287.0, 69.0, 70.0, 80.0, 126.0, 8.0, 37.0, 29.0, 60.0, 60.0, 80.0, 430.0, -21.0, 40.0, 690.0, 40.0, 100.0, 100.0, 140.0, 30.0, 110.0, -200.0, 40.0, 50.0, 50.0, 300.0, 40.0, 115.0, 70.0, 84.0, 80.0, 70.0, 59.0, 49.0, 70.0, 120.0, 150.0, 60.0, 50.0, 20.0, 50.0, 30.0, 20.0, 10.0, 75.0, 80.0, 100.0, 230.0, 30.0, 90.0, 90.0, 50.0, 66.0, 48.0, 19.0, 7.0, -224.0, 105.0, 70.0, 57.0, 3.0, 95.0, 45.0, 50.0, 307.0, 84.0, 40.0, 130.0, 100.0, -28.0, 400.0, 50.0, 70.0, 60.0, 70.0, -10.0, 60.0, 60.0, 60.0, 30.0, 50.0, 8.0, 50.0, 80.0, 230.0, 80.0, 178.0, 60.0, 120.0, 70.0, 54.0, 100.0, 59.0, 60.0, 80.0, 110.0, 30.0, 60.0, 50.0, 90.0, 62.0, 77.0, 74.0, 78.0, 50.0, 50.0, 35.0, -4.0, 190.0, 62.0, 168.0, 23.0, 10.0, 33.0, 48.0, -47.0, 50.0, 89.0, 300.0, 70.0, 150.0, 80.0, 100.0, 354.0, 60.0, 10.0, 80.0, 49.0, 50.0, 80.0, 100.0, 70.0, 200.0, 60.0, 170.0, 70.0, 70.0, 35.0, 44.0, -50.0, 90.0, 60.0, 90.0, 40.0, -1.0, 40.0, 440.0, 4.0, 50.0, 10.0, -24.0, 170.0, 200.0, 28.0, 20.0, 289.0, 60.0, 4.0, 110.0, 70.0, 87.0, 49.0, 246.0, 150.0, 22.0, 100.0, 60.0, 40.0, 20.0, 50.0, 120.0, 60.0, 30.0, 210.0, 90.0, 70.0, 80.0, 50.0, 100.0, 70.0, 27.0, 88.0, 60.0, 40.0, 18.0, 70.0, 30.0, 60.0, 50.0, 60.0, 50.0, 14.0, 38.0, 90.0, 300.0, 80.0, 100.0, 30.0, 80.0, 58.0, 89.0, 50.0, 9.0, 20.0, 60.0, 30.0, 30.0, 110.0, 40.0, 27.0, 130.0, 90.0, 70.0, 159.0, 50.0, 70.0, 50.0, 28.0, 175.0, 100.0, 110.0, 120.0, 100.0, 60.0, 60.0, 120.0, 180.0, 59.0, 20.0, 80.0, 28.0, 38.0, 60.0, 90.0, 80.0, 100.0, 60.0, 110.0, 50.0, 58.0, 100.0, 88.0, 110.0, 20.0, 39.0, 22.0, 30.0, 40.0, 100.0, 50.0, 30.0, 96.0, 60.0, 140.0, 45.0, 100.0, 80.0, 60.0, 100.0, 77.0, 35.0, 170.0, -1.0, 70.0, 50.0, 30.0, 40.0, 50.0, 90.0, 20.0, 20.0, 40.0, 100.0, 180.0, 50.0, 80.0, 59.0, 88.0, 89.0, 80.0, -47.0, 20.0, 77.0, 200.0, 100.0, 37.0, 165.0, -33.0, 60.0, 49.0, 120.0, 80.0, 25.0, 40.0, 50.0, 80.0, 60.0, 50.0, 139.0, 140.0, 30.0, 70.0, 50.0, 69.0, 60.0, 48.0, 24.0, 70.0, 55.0, 60.0, 90.0, 60.0, 170.0, 100.0, 221.0, 9.0, 39.0, 40.0, 19.0, 60.0, 70.0, -56.0, 60.0, 49.0, 42.0, 60.0, 70.0, 57.0, 35.0, 59.0, -7.0, 69.0, 70.0, 120.0, 130.0, 60.0, 146.0, 80.0, 39.0, 70.0, 70.0, 30.0, 180.0, 74.0, 69.0, 60.0, 50.0, 60.0, 27.0, 76.0, 79.0, 110.0, 50.0, 87.0, 5.0, 80.0, 70.0, 63.0, 197.0, 67.0, 20.0, 70.0, 170.0, 40.0, 410.0, 82.0, 60.0, -7.0, 40.0, 103.0, 12.0, 30.0, 60.0, 70.0, 20.0, 55.0, 367.0, 60.0, 283.0, 80.0, 96.0, 87.0, 74.0, 40.0, 60.0, 33.0, 46.0, 70.0, 86.0, 60.0, 13.0, 80.0, 100.0, 60.0, 69.0, 50.0, 98.0, 36.0, 192.0, 48.0, 27.0, 19.0, 14.0, 96.0, 65.0, 50.0, 150.0, 0.0, 60.0, 64.0, 12.0, -32.0, 80.0, 39.0, 40.0, 130.0, 19.0, 90.0, 20.0, 50.0, -3.0, 49.0, 19.0, 80.0, 190.0, 100.0, 580.0, 120.0, 120.0, 11.0, -20.0, 60.0, -34.0, 30.0, 70.0, 6.0, 70.0, 30.0, 24.0, 19.0, 70.0, 70.0, 60.0, 40.0, 118.0, 410.0, -102.0, 30.0, 50.0, 50.0, 90.0, 169.0, 79.0, 10.0, 13.0, 300.0, 21.0, 11.0, 110.0, 50.0, 34.0, 50.0, 20.0, 25.0, 60.0, 70.0, 35.0, 30.0, 70.0, 170.0, 190.0, 140.0, 38.0, 120.0, 50.0, 100.0, 52.0, 70.0, 79.0, 50.0, 70.0, 35.0, 46.0, 59.0, 70.0, 90.0, 57.0, -34.0, 170.0, 75.0, 117.0, 90.0, 79.0, 110.0, 90.0, 50.0, 60.0, 80.0, 140.0, 60.0, 110.0, 50.0, 70.0, 26.0, 210.0, 50.0, 70.0, 60.0, 25.0, 180.0, -22.0, -8.0, 30.0, -10.0, 170.0, 44.0, 80.0, 10.0, 95.0, 160.0, 10.0, -25.0, 60.0, -48.0, 10.0, 32.0, 4.0, 70.0, 1.0, 50.0, 410.0, 17.0, 27.0, 90.0, 100.0, 200.0, 40.0, 110.0, 80.0, 69.0, 60.0, 30.0, 90.0, 43.0, 53.0, 16.0, 80.0, 90.0, 227.0, 68.0, 160.0, 60.0, 46.0, 70.0, 140.0, 10.0, 70.0, 120.0, 89.0, 82.0, 80.0, 133.0, 30.0, 3.0, 73.0, -39.0, 37.0, 178.0, 15.0, -1.0, 100.0, 50.0, 610.0, 60.0, 79.0, 60.0, 110.0, 90.0, 150.0, -54.0, 100.0, 70.0, 20.0, -92.0, -10.0, 120.0, 90.0, 7.0, 60.0, 210.0, 37.0, 243.0, 58.0, 60.0, 30.0, 49.0, 500.0, 180.0, 130.0, 100.0, 40.0, 110.0, -405.0, 30.0, -223.0, 106.0, 15.0, 60.0, 50.0, 144.0, 40.0, 17.0, 50.0, 10.0, 190.0, 50.0, 90.0, 39.0, 40.0, 70.0, 60.0, 40.0, 25.0, 70.0, -5.0, 68.0, 41.0, 28.0, 35.0, 23.0, -12.0, 40.0, 60.0, 60.0, 70.0, 60.0, 230.0, 50.0, 100.0, 103.0, -9.0, 11.0, 100.0, 20.0, 30.0, 90.0, 110.0, 60.0, 33.0, 60.0, 140.0, 180.0, 150.0, 30.0, -1.0, 64.0, 60.0, 30.0, 170.0, 17.0, 50.0, 50.0, 95.0, 0.0, 97.0, 88.0, 109.0, 65.0, 25.0, 19.0, 50.0, 119.0, 120.0, 80.0, 30.0, 50.0, 70.0, 20.0, 50.0, 10.0, 70.0, 60.0, 30.0, 60.0, 40.0, 80.0, 70.0, 10.0, 10.0, 80.0, 110.0, 40.0, 80.0, 20.0, 80.0, -1.0, 39.0, 40.0, 90.0, 39.0, 16.0, 50.0, 80.0, 17.0, 19.0, 248.0, 53.0, 70.0, 158.0, 45.0, 40.0, 76.0, 40.0, 90.0, 10.0, 35.0, 64.0, 40.0, 20.0, 40.0, 49.0, 78.0, 33.0, 16.0, -3.0, 26.0, 20.0, 120.0, 5.0, 90.0, 160.0, 20.0, 50.0, 36.0, 30.0, 0.0, 160.0, -20.0, 39.0, 50.0, 80.0, 50.0, 25.0, 86.0, 11.0, 45.0, 120.0, 97.0, 100.0, 60.0, 50.0, 80.0, 67.0, 40.0, 140.0, 90.0, 60.0, 218.0, 60.0, 40.0, 64.0, 80.0, 20.0, 162.0, 212.0, 100.0, 100.0, 40.0, 45.0, 40.0, 79.0, 20.0, 39.0, 20.0, 80.0, 29.0, 60.0, 51.0, 170.0, 50.0, 70.0, 40.0, 45.0, 40.0, 190.0, 70.0, 24.0, 40.0, 40.0, 143.0, 65.0, 87.0, 50.0, 160.0, 30.0, 90.0, 92.0, 79.0, 40.0, 120.0, 90.0, 92.0, 70.0, 20.0, 80.0, 220.0, -6.0, -6.0, 30.0, 60.0, 70.0, 80.0, 40.0, 50.0, -12.0, 40.0, 50.0, 260.0, 80.0, 59.0, 38.0, 79.0, 100.0, 50.0, 60.0, 50.0, 129.0, 12.0, 70.0, 76.0, 120.0, 170.0, 51.0, 90.0, 50.0, 120.0, 189.0, 40.0, 60.0, 40.0, 99.0, 30.0, 40.0, 75.0, 90.0, 65.0, 109.0, 132.0, 23.0, 557.0, -140.0, 110.0, 188.0, 90.0, 87.0, 179.0, -30.0, 39.0, 40.0, 0.0, 90.0, 67.0, 59.0, 70.0, 510.0, 150.0, 13.0, -50.0, 17.0, 90.0, -10.0, 269.0, 20.0, 35.0, 30.0, 40.0, 130.0, 30.0, 47.0, 48.0, 90.0, 76.0, 51.0, 40.0, 70.0, 100.0, 60.0, 60.0, 58.0, 10.0, -20.0, 0.0, 37.0, 50.0, 0.0, 60.0, -50.0, 610.0, 59.0, 40.0, 140.0, 80.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9688201837382626, "mean_inference_ms": 2.2298122202182533, "mean_action_processing_ms": 0.760317470906491, "mean_env_wait_ms": 1.5608294168789223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10588526725769043, "StateBufferConnector_ms": 0.010148286819458008, "ViewRequirementAgentConnector_ms": 0.5072848796844482}, "num_episodes": 22, "episode_return_max": 1209.0, "episode_return_min": 225.0, "episode_return_mean": 724.3, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.80214985693582, "num_env_steps_trained_throughput_per_sec": 32.80214985693582, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 4120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4120000, "timers": {"training_iteration_time_ms": 123358.147, "restore_workers_time_ms": 0.014, "training_step_time_ms": 123358.09, "sample_time_ms": 3525.983, "learn_time_ms": 119807.233, "learn_throughput": 33.387, "synch_weights_time_ms": 14.956}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "done": false, "training_iteration": 103, "trial_id": "6085c_00000", "date": "2024-07-02_02-28-48", "timestamp": 1719901728, "time_this_iter_s": 121.96194410324097, "time_total_s": 14574.585863828659, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a745e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14574.585863828659, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 20.544767441860465, "ram_util_percent": 79.12790697674419}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7612652558742115, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.258183827161535, "policy_loss": -0.0071646575569259486, "vf_loss": 7.264449695936534, "vf_explained_var": 0.002248676567158887, "kl": 0.008987906878476906, "entropy": 0.6148267299571611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 971865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "env_runners": {"episode_reward_max": 1301.0, "episode_reward_min": 289.0, "episode_reward_mean": 737.09, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -405.0}, "policy_reward_max": {"policy_0": 730.0}, "policy_reward_mean": {"policy_0": 73.709}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1031.0, 693.0, 662.0, 873.0, 1053.0, 639.0, 929.0, 963.0, 652.0, 845.0, 430.0, 886.0, 607.0, 962.0, 705.0, 846.0, 487.0, 806.0, 510.0, 676.0, 803.0, 709.0, 706.0, 562.0, 504.0, 925.0, 655.0, 829.0, 830.0, 1192.0, 588.0, 613.0, 545.0, 453.0, 1207.0, 449.0, 934.0, 619.0, 828.0, 672.0, 773.0, 820.0, 621.0, 594.0, 573.0, 869.0, 843.0, 824.0, 1026.0, 685.0, 723.0, 794.0, 289.0, 614.0, 348.0, 775.0, 873.0, 565.0, 692.0, 470.0, 580.0, 453.0, 766.0, 459.0, 504.0, 450.0, 716.0, 812.0, 837.0, 615.0, 749.0, 863.0, 588.0, 744.0, 788.0, 758.0, 1209.0, 621.0, 1079.0, 577.0, 415.0, 1019.0, 1083.0, 1265.0, 491.0, 720.0, 811.0, 509.0, 769.0, 811.0, 899.0, 925.0, 705.0, 668.0, 490.0, 609.0, 799.0, 1301.0, 805.0, 798.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 230.0, 80.0, 178.0, 60.0, 120.0, 70.0, 54.0, 100.0, 59.0, 60.0, 80.0, 110.0, 30.0, 60.0, 50.0, 90.0, 62.0, 77.0, 74.0, 78.0, 50.0, 50.0, 35.0, -4.0, 190.0, 62.0, 168.0, 23.0, 10.0, 33.0, 48.0, -47.0, 50.0, 89.0, 300.0, 70.0, 150.0, 80.0, 100.0, 354.0, 60.0, 10.0, 80.0, 49.0, 50.0, 80.0, 100.0, 70.0, 200.0, 60.0, 170.0, 70.0, 70.0, 35.0, 44.0, -50.0, 90.0, 60.0, 90.0, 40.0, -1.0, 40.0, 440.0, 4.0, 50.0, 10.0, -24.0, 170.0, 200.0, 28.0, 20.0, 289.0, 60.0, 4.0, 110.0, 70.0, 87.0, 49.0, 246.0, 150.0, 22.0, 100.0, 60.0, 40.0, 20.0, 50.0, 120.0, 60.0, 30.0, 210.0, 90.0, 70.0, 80.0, 50.0, 100.0, 70.0, 27.0, 88.0, 60.0, 40.0, 18.0, 70.0, 30.0, 60.0, 50.0, 60.0, 50.0, 14.0, 38.0, 90.0, 300.0, 80.0, 100.0, 30.0, 80.0, 58.0, 89.0, 50.0, 9.0, 20.0, 60.0, 30.0, 30.0, 110.0, 40.0, 27.0, 130.0, 90.0, 70.0, 159.0, 50.0, 70.0, 50.0, 28.0, 175.0, 100.0, 110.0, 120.0, 100.0, 60.0, 60.0, 120.0, 180.0, 59.0, 20.0, 80.0, 28.0, 38.0, 60.0, 90.0, 80.0, 100.0, 60.0, 110.0, 50.0, 58.0, 100.0, 88.0, 110.0, 20.0, 39.0, 22.0, 30.0, 40.0, 100.0, 50.0, 30.0, 96.0, 60.0, 140.0, 45.0, 100.0, 80.0, 60.0, 100.0, 77.0, 35.0, 170.0, -1.0, 70.0, 50.0, 30.0, 40.0, 50.0, 90.0, 20.0, 20.0, 40.0, 100.0, 180.0, 50.0, 80.0, 59.0, 88.0, 89.0, 80.0, -47.0, 20.0, 77.0, 200.0, 100.0, 37.0, 165.0, -33.0, 60.0, 49.0, 120.0, 80.0, 25.0, 40.0, 50.0, 80.0, 60.0, 50.0, 139.0, 140.0, 30.0, 70.0, 50.0, 69.0, 60.0, 48.0, 24.0, 70.0, 55.0, 60.0, 90.0, 60.0, 170.0, 100.0, 221.0, 9.0, 39.0, 40.0, 19.0, 60.0, 70.0, -56.0, 60.0, 49.0, 42.0, 60.0, 70.0, 57.0, 35.0, 59.0, -7.0, 69.0, 70.0, 120.0, 130.0, 60.0, 146.0, 80.0, 39.0, 70.0, 70.0, 30.0, 180.0, 74.0, 69.0, 60.0, 50.0, 60.0, 27.0, 76.0, 79.0, 110.0, 50.0, 87.0, 5.0, 80.0, 70.0, 63.0, 197.0, 67.0, 20.0, 70.0, 170.0, 40.0, 410.0, 82.0, 60.0, -7.0, 40.0, 103.0, 12.0, 30.0, 60.0, 70.0, 20.0, 55.0, 367.0, 60.0, 283.0, 80.0, 96.0, 87.0, 74.0, 40.0, 60.0, 33.0, 46.0, 70.0, 86.0, 60.0, 13.0, 80.0, 100.0, 60.0, 69.0, 50.0, 98.0, 36.0, 192.0, 48.0, 27.0, 19.0, 14.0, 96.0, 65.0, 50.0, 150.0, 0.0, 60.0, 64.0, 12.0, -32.0, 80.0, 39.0, 40.0, 130.0, 19.0, 90.0, 20.0, 50.0, -3.0, 49.0, 19.0, 80.0, 190.0, 100.0, 580.0, 120.0, 120.0, 11.0, -20.0, 60.0, -34.0, 30.0, 70.0, 6.0, 70.0, 30.0, 24.0, 19.0, 70.0, 70.0, 60.0, 40.0, 118.0, 410.0, -102.0, 30.0, 50.0, 50.0, 90.0, 169.0, 79.0, 10.0, 13.0, 300.0, 21.0, 11.0, 110.0, 50.0, 34.0, 50.0, 20.0, 25.0, 60.0, 70.0, 35.0, 30.0, 70.0, 170.0, 190.0, 140.0, 38.0, 120.0, 50.0, 100.0, 52.0, 70.0, 79.0, 50.0, 70.0, 35.0, 46.0, 59.0, 70.0, 90.0, 57.0, -34.0, 170.0, 75.0, 117.0, 90.0, 79.0, 110.0, 90.0, 50.0, 60.0, 80.0, 140.0, 60.0, 110.0, 50.0, 70.0, 26.0, 210.0, 50.0, 70.0, 60.0, 25.0, 180.0, -22.0, -8.0, 30.0, -10.0, 170.0, 44.0, 80.0, 10.0, 95.0, 160.0, 10.0, -25.0, 60.0, -48.0, 10.0, 32.0, 4.0, 70.0, 1.0, 50.0, 410.0, 17.0, 27.0, 90.0, 100.0, 200.0, 40.0, 110.0, 80.0, 69.0, 60.0, 30.0, 90.0, 43.0, 53.0, 16.0, 80.0, 90.0, 227.0, 68.0, 160.0, 60.0, 46.0, 70.0, 140.0, 10.0, 70.0, 120.0, 89.0, 82.0, 80.0, 133.0, 30.0, 3.0, 73.0, -39.0, 37.0, 178.0, 15.0, -1.0, 100.0, 50.0, 610.0, 60.0, 79.0, 60.0, 110.0, 90.0, 150.0, -54.0, 100.0, 70.0, 20.0, -92.0, -10.0, 120.0, 90.0, 7.0, 60.0, 210.0, 37.0, 243.0, 58.0, 60.0, 30.0, 49.0, 500.0, 180.0, 130.0, 100.0, 40.0, 110.0, -405.0, 30.0, -223.0, 106.0, 15.0, 60.0, 50.0, 144.0, 40.0, 17.0, 50.0, 10.0, 190.0, 50.0, 90.0, 39.0, 40.0, 70.0, 60.0, 40.0, 25.0, 70.0, -5.0, 68.0, 41.0, 28.0, 35.0, 23.0, -12.0, 40.0, 60.0, 60.0, 70.0, 60.0, 230.0, 50.0, 100.0, 103.0, -9.0, 11.0, 100.0, 20.0, 30.0, 90.0, 110.0, 60.0, 33.0, 60.0, 140.0, 180.0, 150.0, 30.0, -1.0, 64.0, 60.0, 30.0, 170.0, 17.0, 50.0, 50.0, 95.0, 0.0, 97.0, 88.0, 109.0, 65.0, 25.0, 19.0, 50.0, 119.0, 120.0, 80.0, 30.0, 50.0, 70.0, 20.0, 50.0, 10.0, 70.0, 60.0, 30.0, 60.0, 40.0, 80.0, 70.0, 10.0, 10.0, 80.0, 110.0, 40.0, 80.0, 20.0, 80.0, -1.0, 39.0, 40.0, 90.0, 39.0, 16.0, 50.0, 80.0, 17.0, 19.0, 248.0, 53.0, 70.0, 158.0, 45.0, 40.0, 76.0, 40.0, 90.0, 10.0, 35.0, 64.0, 40.0, 20.0, 40.0, 49.0, 78.0, 33.0, 16.0, -3.0, 26.0, 20.0, 120.0, 5.0, 90.0, 160.0, 20.0, 50.0, 36.0, 30.0, 0.0, 160.0, -20.0, 39.0, 50.0, 80.0, 50.0, 25.0, 86.0, 11.0, 45.0, 120.0, 97.0, 100.0, 60.0, 50.0, 80.0, 67.0, 40.0, 140.0, 90.0, 60.0, 218.0, 60.0, 40.0, 64.0, 80.0, 20.0, 162.0, 212.0, 100.0, 100.0, 40.0, 45.0, 40.0, 79.0, 20.0, 39.0, 20.0, 80.0, 29.0, 60.0, 51.0, 170.0, 50.0, 70.0, 40.0, 45.0, 40.0, 190.0, 70.0, 24.0, 40.0, 40.0, 143.0, 65.0, 87.0, 50.0, 160.0, 30.0, 90.0, 92.0, 79.0, 40.0, 120.0, 90.0, 92.0, 70.0, 20.0, 80.0, 220.0, -6.0, -6.0, 30.0, 60.0, 70.0, 80.0, 40.0, 50.0, -12.0, 40.0, 50.0, 260.0, 80.0, 59.0, 38.0, 79.0, 100.0, 50.0, 60.0, 50.0, 129.0, 12.0, 70.0, 76.0, 120.0, 170.0, 51.0, 90.0, 50.0, 120.0, 189.0, 40.0, 60.0, 40.0, 99.0, 30.0, 40.0, 75.0, 90.0, 65.0, 109.0, 132.0, 23.0, 557.0, -140.0, 110.0, 188.0, 90.0, 87.0, 179.0, -30.0, 39.0, 40.0, 0.0, 90.0, 67.0, 59.0, 70.0, 510.0, 150.0, 13.0, -50.0, 17.0, 90.0, -10.0, 269.0, 20.0, 35.0, 30.0, 40.0, 130.0, 30.0, 47.0, 48.0, 90.0, 76.0, 51.0, 40.0, 70.0, 100.0, 60.0, 60.0, 58.0, 10.0, -20.0, 0.0, 37.0, 50.0, 0.0, 60.0, -50.0, 610.0, 59.0, 40.0, 140.0, 80.0, 30.0, 86.0, 60.0, 94.0, 251.0, 75.0, 170.0, 169.0, 50.0, 10.0, 118.0, 460.0, 50.0, 75.0, 60.0, 310.0, 60.0, 90.0, 30.0, 90.0, 40.0, 70.0, 100.0, 30.0, 50.0, 90.0, 31.0, 40.0, -12.0, 60.0, 32.0, 200.0, -10.0, 30.0, 70.0, 60.0, 150.0, 60.0, 30.0, 80.0, 50.0, -121.0, 79.0, 24.0, 320.0, -20.0, 340.0, 34.0, 100.0, 160.0, -105.0, 37.0, 40.0, 50.0, 70.0, 54.0, 58.0, 20.0, 85.0, 40.0, 55.0, 130.0, 100.0, 100.0, 70.0, 50.0, 130.0, 27.0, 90.0, 50.0, 22.0, 76.0, 80.0, 80.0, 57.0, 30.0, 28.0, 100.0, 80.0, 200.0, 80.0, 30.0, 549.0, 90.0, 60.0, 40.0, -20.0, 10.0, 10.0, 60.0, 70.0, 100.0, 170.0, 100.0, 60.0, 50.0, 120.0, 50.0, 25.0, 190.0, 60.0, 59.0, 100.0, 130.0, 59.0, 178.0, 30.0, 11.0, 4.0, 140.0, -6.0, 15.0, 58.0, 80.0, 80.0, -30.0, 50.0, 80.0, 45.0, 200.0, 90.0, 0.0, 70.0, 60.0, 30.0, 50.0, 110.0, 6.0, 56.0, 40.0, 68.0, 30.0, 60.0, 120.0, 89.0, 88.0, 60.0, 65.0, 30.0, 7.0, 60.0, -20.0, 40.0, 19.0, 90.0, 300.0, 80.0, 120.0, 40.0, 90.0, 40.0, 55.0, 69.0, 3.0, 730.0, 70.0, 27.0, 130.0, 70.0, 90.0, 57.0, 67.0, 159.0, 70.0, 70.0, 80.0, 60.0, 71.0, 90.0, 88.0, 50.0, 50.0, 80.0, 45.0, 49.0, 57.0, 80.0, 70.0, 89.0, 78.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9653017085105824, "mean_inference_ms": 2.2268562980353512, "mean_action_processing_ms": 0.7611626360333237, "mean_env_wait_ms": 1.5591083326731054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10388851165771484, "StateBufferConnector_ms": 0.009987831115722656, "ViewRequirementAgentConnector_ms": 0.503852128982544}, "num_episodes": 18, "episode_return_max": 1301.0, "episode_return_min": 289.0, "episode_return_mean": 737.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.4631944443262, "num_env_steps_trained_throughput_per_sec": 32.4631944443262, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 4160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4160000, "timers": {"training_iteration_time_ms": 123349.436, "restore_workers_time_ms": 0.015, "training_step_time_ms": 123349.373, "sample_time_ms": 3570.745, "learn_time_ms": 119753.992, "learn_throughput": 33.402, "synch_weights_time_ms": 14.616}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "done": false, "training_iteration": 104, "trial_id": "6085c_00000", "date": "2024-07-02_02-30-52", "timestamp": 1719901852, "time_this_iter_s": 123.23344087600708, "time_total_s": 14697.819304704666, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c52700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14697.819304704666, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 20.497142857142858, "ram_util_percent": 79.27485714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9129882505209173, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.101511176630331, "policy_loss": -0.00736501670631712, "vf_loss": 7.108025493408545, "vf_explained_var": 0.000817188395224948, "kl": 0.008507058612955084, "entropy": 0.624427399204308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 981255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "env_runners": {"episode_reward_max": 1557.0, "episode_reward_min": 289.0, "episode_reward_mean": 739.66, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -405.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 73.966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [510.0, 676.0, 803.0, 709.0, 706.0, 562.0, 504.0, 925.0, 655.0, 829.0, 830.0, 1192.0, 588.0, 613.0, 545.0, 453.0, 1207.0, 449.0, 934.0, 619.0, 828.0, 672.0, 773.0, 820.0, 621.0, 594.0, 573.0, 869.0, 843.0, 824.0, 1026.0, 685.0, 723.0, 794.0, 289.0, 614.0, 348.0, 775.0, 873.0, 565.0, 692.0, 470.0, 580.0, 453.0, 766.0, 459.0, 504.0, 450.0, 716.0, 812.0, 837.0, 615.0, 749.0, 863.0, 588.0, 744.0, 788.0, 758.0, 1209.0, 621.0, 1079.0, 577.0, 415.0, 1019.0, 1083.0, 1265.0, 491.0, 720.0, 811.0, 509.0, 769.0, 811.0, 899.0, 925.0, 705.0, 668.0, 490.0, 609.0, 799.0, 1301.0, 805.0, 798.0, 938.0, 919.0, 580.0, 690.0, 575.0, 1062.0, 502.0, 810.0, 792.0, 580.0, 750.0, 1099.0, 602.0, 583.0, 1195.0, 739.0, 353.0, 1557.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 50.0, 30.0, 40.0, 50.0, 90.0, 20.0, 20.0, 40.0, 100.0, 180.0, 50.0, 80.0, 59.0, 88.0, 89.0, 80.0, -47.0, 20.0, 77.0, 200.0, 100.0, 37.0, 165.0, -33.0, 60.0, 49.0, 120.0, 80.0, 25.0, 40.0, 50.0, 80.0, 60.0, 50.0, 139.0, 140.0, 30.0, 70.0, 50.0, 69.0, 60.0, 48.0, 24.0, 70.0, 55.0, 60.0, 90.0, 60.0, 170.0, 100.0, 221.0, 9.0, 39.0, 40.0, 19.0, 60.0, 70.0, -56.0, 60.0, 49.0, 42.0, 60.0, 70.0, 57.0, 35.0, 59.0, -7.0, 69.0, 70.0, 120.0, 130.0, 60.0, 146.0, 80.0, 39.0, 70.0, 70.0, 30.0, 180.0, 74.0, 69.0, 60.0, 50.0, 60.0, 27.0, 76.0, 79.0, 110.0, 50.0, 87.0, 5.0, 80.0, 70.0, 63.0, 197.0, 67.0, 20.0, 70.0, 170.0, 40.0, 410.0, 82.0, 60.0, -7.0, 40.0, 103.0, 12.0, 30.0, 60.0, 70.0, 20.0, 55.0, 367.0, 60.0, 283.0, 80.0, 96.0, 87.0, 74.0, 40.0, 60.0, 33.0, 46.0, 70.0, 86.0, 60.0, 13.0, 80.0, 100.0, 60.0, 69.0, 50.0, 98.0, 36.0, 192.0, 48.0, 27.0, 19.0, 14.0, 96.0, 65.0, 50.0, 150.0, 0.0, 60.0, 64.0, 12.0, -32.0, 80.0, 39.0, 40.0, 130.0, 19.0, 90.0, 20.0, 50.0, -3.0, 49.0, 19.0, 80.0, 190.0, 100.0, 580.0, 120.0, 120.0, 11.0, -20.0, 60.0, -34.0, 30.0, 70.0, 6.0, 70.0, 30.0, 24.0, 19.0, 70.0, 70.0, 60.0, 40.0, 118.0, 410.0, -102.0, 30.0, 50.0, 50.0, 90.0, 169.0, 79.0, 10.0, 13.0, 300.0, 21.0, 11.0, 110.0, 50.0, 34.0, 50.0, 20.0, 25.0, 60.0, 70.0, 35.0, 30.0, 70.0, 170.0, 190.0, 140.0, 38.0, 120.0, 50.0, 100.0, 52.0, 70.0, 79.0, 50.0, 70.0, 35.0, 46.0, 59.0, 70.0, 90.0, 57.0, -34.0, 170.0, 75.0, 117.0, 90.0, 79.0, 110.0, 90.0, 50.0, 60.0, 80.0, 140.0, 60.0, 110.0, 50.0, 70.0, 26.0, 210.0, 50.0, 70.0, 60.0, 25.0, 180.0, -22.0, -8.0, 30.0, -10.0, 170.0, 44.0, 80.0, 10.0, 95.0, 160.0, 10.0, -25.0, 60.0, -48.0, 10.0, 32.0, 4.0, 70.0, 1.0, 50.0, 410.0, 17.0, 27.0, 90.0, 100.0, 200.0, 40.0, 110.0, 80.0, 69.0, 60.0, 30.0, 90.0, 43.0, 53.0, 16.0, 80.0, 90.0, 227.0, 68.0, 160.0, 60.0, 46.0, 70.0, 140.0, 10.0, 70.0, 120.0, 89.0, 82.0, 80.0, 133.0, 30.0, 3.0, 73.0, -39.0, 37.0, 178.0, 15.0, -1.0, 100.0, 50.0, 610.0, 60.0, 79.0, 60.0, 110.0, 90.0, 150.0, -54.0, 100.0, 70.0, 20.0, -92.0, -10.0, 120.0, 90.0, 7.0, 60.0, 210.0, 37.0, 243.0, 58.0, 60.0, 30.0, 49.0, 500.0, 180.0, 130.0, 100.0, 40.0, 110.0, -405.0, 30.0, -223.0, 106.0, 15.0, 60.0, 50.0, 144.0, 40.0, 17.0, 50.0, 10.0, 190.0, 50.0, 90.0, 39.0, 40.0, 70.0, 60.0, 40.0, 25.0, 70.0, -5.0, 68.0, 41.0, 28.0, 35.0, 23.0, -12.0, 40.0, 60.0, 60.0, 70.0, 60.0, 230.0, 50.0, 100.0, 103.0, -9.0, 11.0, 100.0, 20.0, 30.0, 90.0, 110.0, 60.0, 33.0, 60.0, 140.0, 180.0, 150.0, 30.0, -1.0, 64.0, 60.0, 30.0, 170.0, 17.0, 50.0, 50.0, 95.0, 0.0, 97.0, 88.0, 109.0, 65.0, 25.0, 19.0, 50.0, 119.0, 120.0, 80.0, 30.0, 50.0, 70.0, 20.0, 50.0, 10.0, 70.0, 60.0, 30.0, 60.0, 40.0, 80.0, 70.0, 10.0, 10.0, 80.0, 110.0, 40.0, 80.0, 20.0, 80.0, -1.0, 39.0, 40.0, 90.0, 39.0, 16.0, 50.0, 80.0, 17.0, 19.0, 248.0, 53.0, 70.0, 158.0, 45.0, 40.0, 76.0, 40.0, 90.0, 10.0, 35.0, 64.0, 40.0, 20.0, 40.0, 49.0, 78.0, 33.0, 16.0, -3.0, 26.0, 20.0, 120.0, 5.0, 90.0, 160.0, 20.0, 50.0, 36.0, 30.0, 0.0, 160.0, -20.0, 39.0, 50.0, 80.0, 50.0, 25.0, 86.0, 11.0, 45.0, 120.0, 97.0, 100.0, 60.0, 50.0, 80.0, 67.0, 40.0, 140.0, 90.0, 60.0, 218.0, 60.0, 40.0, 64.0, 80.0, 20.0, 162.0, 212.0, 100.0, 100.0, 40.0, 45.0, 40.0, 79.0, 20.0, 39.0, 20.0, 80.0, 29.0, 60.0, 51.0, 170.0, 50.0, 70.0, 40.0, 45.0, 40.0, 190.0, 70.0, 24.0, 40.0, 40.0, 143.0, 65.0, 87.0, 50.0, 160.0, 30.0, 90.0, 92.0, 79.0, 40.0, 120.0, 90.0, 92.0, 70.0, 20.0, 80.0, 220.0, -6.0, -6.0, 30.0, 60.0, 70.0, 80.0, 40.0, 50.0, -12.0, 40.0, 50.0, 260.0, 80.0, 59.0, 38.0, 79.0, 100.0, 50.0, 60.0, 50.0, 129.0, 12.0, 70.0, 76.0, 120.0, 170.0, 51.0, 90.0, 50.0, 120.0, 189.0, 40.0, 60.0, 40.0, 99.0, 30.0, 40.0, 75.0, 90.0, 65.0, 109.0, 132.0, 23.0, 557.0, -140.0, 110.0, 188.0, 90.0, 87.0, 179.0, -30.0, 39.0, 40.0, 0.0, 90.0, 67.0, 59.0, 70.0, 510.0, 150.0, 13.0, -50.0, 17.0, 90.0, -10.0, 269.0, 20.0, 35.0, 30.0, 40.0, 130.0, 30.0, 47.0, 48.0, 90.0, 76.0, 51.0, 40.0, 70.0, 100.0, 60.0, 60.0, 58.0, 10.0, -20.0, 0.0, 37.0, 50.0, 0.0, 60.0, -50.0, 610.0, 59.0, 40.0, 140.0, 80.0, 30.0, 86.0, 60.0, 94.0, 251.0, 75.0, 170.0, 169.0, 50.0, 10.0, 118.0, 460.0, 50.0, 75.0, 60.0, 310.0, 60.0, 90.0, 30.0, 90.0, 40.0, 70.0, 100.0, 30.0, 50.0, 90.0, 31.0, 40.0, -12.0, 60.0, 32.0, 200.0, -10.0, 30.0, 70.0, 60.0, 150.0, 60.0, 30.0, 80.0, 50.0, -121.0, 79.0, 24.0, 320.0, -20.0, 340.0, 34.0, 100.0, 160.0, -105.0, 37.0, 40.0, 50.0, 70.0, 54.0, 58.0, 20.0, 85.0, 40.0, 55.0, 130.0, 100.0, 100.0, 70.0, 50.0, 130.0, 27.0, 90.0, 50.0, 22.0, 76.0, 80.0, 80.0, 57.0, 30.0, 28.0, 100.0, 80.0, 200.0, 80.0, 30.0, 549.0, 90.0, 60.0, 40.0, -20.0, 10.0, 10.0, 60.0, 70.0, 100.0, 170.0, 100.0, 60.0, 50.0, 120.0, 50.0, 25.0, 190.0, 60.0, 59.0, 100.0, 130.0, 59.0, 178.0, 30.0, 11.0, 4.0, 140.0, -6.0, 15.0, 58.0, 80.0, 80.0, -30.0, 50.0, 80.0, 45.0, 200.0, 90.0, 0.0, 70.0, 60.0, 30.0, 50.0, 110.0, 6.0, 56.0, 40.0, 68.0, 30.0, 60.0, 120.0, 89.0, 88.0, 60.0, 65.0, 30.0, 7.0, 60.0, -20.0, 40.0, 19.0, 90.0, 300.0, 80.0, 120.0, 40.0, 90.0, 40.0, 55.0, 69.0, 3.0, 730.0, 70.0, 27.0, 130.0, 70.0, 90.0, 57.0, 67.0, 159.0, 70.0, 70.0, 80.0, 60.0, 71.0, 90.0, 88.0, 50.0, 50.0, 80.0, 45.0, 49.0, 57.0, 80.0, 70.0, 89.0, 78.0, 200.0, -40.0, 55.0, 160.0, 147.0, 19.0, 369.0, 50.0, 50.0, 30.0, 98.0, 171.0, 167.0, 75.0, 47.0, 89.0, 60.0, 60.0, 70.0, 80.0, 100.0, 38.0, 80.0, 60.0, 69.0, 50.0, 10.0, 56.0, 68.0, 90.0, 59.0, 57.0, 130.0, 150.0, 69.0, 60.0, 50.0, 31.0, 53.0, 20.0, 70.0, 0.0, 60.0, 110.0, 150.0, 70.0, -44.0, 49.0, 30.0, 70.0, 80.0, 70.0, 80.0, 80.0, 118.0, 59.0, 380.0, 70.0, 169.0, 57.0, -21.0, 30.0, 40.0, 38.0, 150.0, -8.0, 59.0, 60.0, 68.0, 15.0, 50.0, 40.0, 90.0, 50.0, 100.0, 60.0, 100.0, 50.0, 80.0, 60.0, 180.0, 60.0, 32.0, -20.0, 70.0, 210.0, 180.0, 100.0, 10.0, 80.0, 70.0, 30.0, 100.0, 40.0, 100.0, 50.0, 90.0, 40.0, 70.0, 30.0, 30.0, 190.0, 60.0, 40.0, 0.0, 20.0, 100.0, 50.0, 210.0, 62.0, 18.0, 20.0, 20.0, 44.0, 60.0, 70.0, 60.0, 50.0, 670.0, 10.0, 95.0, 20.0, 60.0, 0.0, 60.0, 8.0, 40.0, 140.0, 80.0, 178.0, 16.0, 40.0, 100.0, 25.0, 40.0, 90.0, 38.0, 10.0, 70.0, 110.0, 60.0, 30.0, 70.0, 90.0, 20.0, 210.0, 290.0, 220.0, 20.0, 65.0, 180.0, 130.0, 60.0, 160.0, -35.0, -33.0, 30.0, -13.0, 270.0, 70.0, 100.0, 30.0, 40.0, 15.0, 60.0, -18.0, 39.0, 40.0, 28.0, 80.0, 39.0, 110.0, 100.0, 50.0, -30.0, 770.0, 50.0, 50.0, -1.0, 369.0, 89.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9637922357105964, "mean_inference_ms": 2.224726825109207, "mean_action_processing_ms": 0.7602456774880133, "mean_env_wait_ms": 1.5575921544493412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12633705139160156, "StateBufferConnector_ms": 0.01009511947631836, "ViewRequirementAgentConnector_ms": 0.5295515060424805}, "num_episodes": 18, "episode_return_max": 1557.0, "episode_return_min": 289.0, "episode_return_mean": 739.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.24722767942603, "num_env_steps_trained_throughput_per_sec": 32.24722767942603, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 4200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4200000, "timers": {"training_iteration_time_ms": 123503.999, "restore_workers_time_ms": 0.015, "training_step_time_ms": 123503.935, "sample_time_ms": 3599.27, "learn_time_ms": 119879.926, "learn_throughput": 33.367, "synch_weights_time_ms": 14.453}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "done": false, "training_iteration": 105, "trial_id": "6085c_00000", "date": "2024-07-02_02-32-56", "timestamp": 1719901976, "time_this_iter_s": 124.07215595245361, "time_total_s": 14821.89146065712, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b0aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14821.89146065712, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 21.173714285714286, "ram_util_percent": 80.84857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.950957870699219, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.433728647536744, "policy_loss": -0.006270444579967977, "vf_loss": 7.439093969881344, "vf_explained_var": 0.0018534679001512618, "kl": 0.009051258533748932, "entropy": 0.5924924150950358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 990645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "env_runners": {"episode_reward_max": 1557.0, "episode_reward_min": 289.0, "episode_reward_mean": 753.14, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -405.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 75.314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [820.0, 621.0, 594.0, 573.0, 869.0, 843.0, 824.0, 1026.0, 685.0, 723.0, 794.0, 289.0, 614.0, 348.0, 775.0, 873.0, 565.0, 692.0, 470.0, 580.0, 453.0, 766.0, 459.0, 504.0, 450.0, 716.0, 812.0, 837.0, 615.0, 749.0, 863.0, 588.0, 744.0, 788.0, 758.0, 1209.0, 621.0, 1079.0, 577.0, 415.0, 1019.0, 1083.0, 1265.0, 491.0, 720.0, 811.0, 509.0, 769.0, 811.0, 899.0, 925.0, 705.0, 668.0, 490.0, 609.0, 799.0, 1301.0, 805.0, 798.0, 938.0, 919.0, 580.0, 690.0, 575.0, 1062.0, 502.0, 810.0, 792.0, 580.0, 750.0, 1099.0, 602.0, 583.0, 1195.0, 739.0, 353.0, 1557.0, 679.0, 746.0, 449.0, 1145.0, 557.0, 1056.0, 687.0, 717.0, 722.0, 792.0, 818.0, 1004.0, 591.0, 930.0, 754.0, 486.0, 1380.0, 579.0, 555.0, 604.0, 767.0, 1207.0, 705.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 90.0, 50.0, 60.0, 80.0, 140.0, 60.0, 110.0, 50.0, 70.0, 26.0, 210.0, 50.0, 70.0, 60.0, 25.0, 180.0, -22.0, -8.0, 30.0, -10.0, 170.0, 44.0, 80.0, 10.0, 95.0, 160.0, 10.0, -25.0, 60.0, -48.0, 10.0, 32.0, 4.0, 70.0, 1.0, 50.0, 410.0, 17.0, 27.0, 90.0, 100.0, 200.0, 40.0, 110.0, 80.0, 69.0, 60.0, 30.0, 90.0, 43.0, 53.0, 16.0, 80.0, 90.0, 227.0, 68.0, 160.0, 60.0, 46.0, 70.0, 140.0, 10.0, 70.0, 120.0, 89.0, 82.0, 80.0, 133.0, 30.0, 3.0, 73.0, -39.0, 37.0, 178.0, 15.0, -1.0, 100.0, 50.0, 610.0, 60.0, 79.0, 60.0, 110.0, 90.0, 150.0, -54.0, 100.0, 70.0, 20.0, -92.0, -10.0, 120.0, 90.0, 7.0, 60.0, 210.0, 37.0, 243.0, 58.0, 60.0, 30.0, 49.0, 500.0, 180.0, 130.0, 100.0, 40.0, 110.0, -405.0, 30.0, -223.0, 106.0, 15.0, 60.0, 50.0, 144.0, 40.0, 17.0, 50.0, 10.0, 190.0, 50.0, 90.0, 39.0, 40.0, 70.0, 60.0, 40.0, 25.0, 70.0, -5.0, 68.0, 41.0, 28.0, 35.0, 23.0, -12.0, 40.0, 60.0, 60.0, 70.0, 60.0, 230.0, 50.0, 100.0, 103.0, -9.0, 11.0, 100.0, 20.0, 30.0, 90.0, 110.0, 60.0, 33.0, 60.0, 140.0, 180.0, 150.0, 30.0, -1.0, 64.0, 60.0, 30.0, 170.0, 17.0, 50.0, 50.0, 95.0, 0.0, 97.0, 88.0, 109.0, 65.0, 25.0, 19.0, 50.0, 119.0, 120.0, 80.0, 30.0, 50.0, 70.0, 20.0, 50.0, 10.0, 70.0, 60.0, 30.0, 60.0, 40.0, 80.0, 70.0, 10.0, 10.0, 80.0, 110.0, 40.0, 80.0, 20.0, 80.0, -1.0, 39.0, 40.0, 90.0, 39.0, 16.0, 50.0, 80.0, 17.0, 19.0, 248.0, 53.0, 70.0, 158.0, 45.0, 40.0, 76.0, 40.0, 90.0, 10.0, 35.0, 64.0, 40.0, 20.0, 40.0, 49.0, 78.0, 33.0, 16.0, -3.0, 26.0, 20.0, 120.0, 5.0, 90.0, 160.0, 20.0, 50.0, 36.0, 30.0, 0.0, 160.0, -20.0, 39.0, 50.0, 80.0, 50.0, 25.0, 86.0, 11.0, 45.0, 120.0, 97.0, 100.0, 60.0, 50.0, 80.0, 67.0, 40.0, 140.0, 90.0, 60.0, 218.0, 60.0, 40.0, 64.0, 80.0, 20.0, 162.0, 212.0, 100.0, 100.0, 40.0, 45.0, 40.0, 79.0, 20.0, 39.0, 20.0, 80.0, 29.0, 60.0, 51.0, 170.0, 50.0, 70.0, 40.0, 45.0, 40.0, 190.0, 70.0, 24.0, 40.0, 40.0, 143.0, 65.0, 87.0, 50.0, 160.0, 30.0, 90.0, 92.0, 79.0, 40.0, 120.0, 90.0, 92.0, 70.0, 20.0, 80.0, 220.0, -6.0, -6.0, 30.0, 60.0, 70.0, 80.0, 40.0, 50.0, -12.0, 40.0, 50.0, 260.0, 80.0, 59.0, 38.0, 79.0, 100.0, 50.0, 60.0, 50.0, 129.0, 12.0, 70.0, 76.0, 120.0, 170.0, 51.0, 90.0, 50.0, 120.0, 189.0, 40.0, 60.0, 40.0, 99.0, 30.0, 40.0, 75.0, 90.0, 65.0, 109.0, 132.0, 23.0, 557.0, -140.0, 110.0, 188.0, 90.0, 87.0, 179.0, -30.0, 39.0, 40.0, 0.0, 90.0, 67.0, 59.0, 70.0, 510.0, 150.0, 13.0, -50.0, 17.0, 90.0, -10.0, 269.0, 20.0, 35.0, 30.0, 40.0, 130.0, 30.0, 47.0, 48.0, 90.0, 76.0, 51.0, 40.0, 70.0, 100.0, 60.0, 60.0, 58.0, 10.0, -20.0, 0.0, 37.0, 50.0, 0.0, 60.0, -50.0, 610.0, 59.0, 40.0, 140.0, 80.0, 30.0, 86.0, 60.0, 94.0, 251.0, 75.0, 170.0, 169.0, 50.0, 10.0, 118.0, 460.0, 50.0, 75.0, 60.0, 310.0, 60.0, 90.0, 30.0, 90.0, 40.0, 70.0, 100.0, 30.0, 50.0, 90.0, 31.0, 40.0, -12.0, 60.0, 32.0, 200.0, -10.0, 30.0, 70.0, 60.0, 150.0, 60.0, 30.0, 80.0, 50.0, -121.0, 79.0, 24.0, 320.0, -20.0, 340.0, 34.0, 100.0, 160.0, -105.0, 37.0, 40.0, 50.0, 70.0, 54.0, 58.0, 20.0, 85.0, 40.0, 55.0, 130.0, 100.0, 100.0, 70.0, 50.0, 130.0, 27.0, 90.0, 50.0, 22.0, 76.0, 80.0, 80.0, 57.0, 30.0, 28.0, 100.0, 80.0, 200.0, 80.0, 30.0, 549.0, 90.0, 60.0, 40.0, -20.0, 10.0, 10.0, 60.0, 70.0, 100.0, 170.0, 100.0, 60.0, 50.0, 120.0, 50.0, 25.0, 190.0, 60.0, 59.0, 100.0, 130.0, 59.0, 178.0, 30.0, 11.0, 4.0, 140.0, -6.0, 15.0, 58.0, 80.0, 80.0, -30.0, 50.0, 80.0, 45.0, 200.0, 90.0, 0.0, 70.0, 60.0, 30.0, 50.0, 110.0, 6.0, 56.0, 40.0, 68.0, 30.0, 60.0, 120.0, 89.0, 88.0, 60.0, 65.0, 30.0, 7.0, 60.0, -20.0, 40.0, 19.0, 90.0, 300.0, 80.0, 120.0, 40.0, 90.0, 40.0, 55.0, 69.0, 3.0, 730.0, 70.0, 27.0, 130.0, 70.0, 90.0, 57.0, 67.0, 159.0, 70.0, 70.0, 80.0, 60.0, 71.0, 90.0, 88.0, 50.0, 50.0, 80.0, 45.0, 49.0, 57.0, 80.0, 70.0, 89.0, 78.0, 200.0, -40.0, 55.0, 160.0, 147.0, 19.0, 369.0, 50.0, 50.0, 30.0, 98.0, 171.0, 167.0, 75.0, 47.0, 89.0, 60.0, 60.0, 70.0, 80.0, 100.0, 38.0, 80.0, 60.0, 69.0, 50.0, 10.0, 56.0, 68.0, 90.0, 59.0, 57.0, 130.0, 150.0, 69.0, 60.0, 50.0, 31.0, 53.0, 20.0, 70.0, 0.0, 60.0, 110.0, 150.0, 70.0, -44.0, 49.0, 30.0, 70.0, 80.0, 70.0, 80.0, 80.0, 118.0, 59.0, 380.0, 70.0, 169.0, 57.0, -21.0, 30.0, 40.0, 38.0, 150.0, -8.0, 59.0, 60.0, 68.0, 15.0, 50.0, 40.0, 90.0, 50.0, 100.0, 60.0, 100.0, 50.0, 80.0, 60.0, 180.0, 60.0, 32.0, -20.0, 70.0, 210.0, 180.0, 100.0, 10.0, 80.0, 70.0, 30.0, 100.0, 40.0, 100.0, 50.0, 90.0, 40.0, 70.0, 30.0, 30.0, 190.0, 60.0, 40.0, 0.0, 20.0, 100.0, 50.0, 210.0, 62.0, 18.0, 20.0, 20.0, 44.0, 60.0, 70.0, 60.0, 50.0, 670.0, 10.0, 95.0, 20.0, 60.0, 0.0, 60.0, 8.0, 40.0, 140.0, 80.0, 178.0, 16.0, 40.0, 100.0, 25.0, 40.0, 90.0, 38.0, 10.0, 70.0, 110.0, 60.0, 30.0, 70.0, 90.0, 20.0, 210.0, 290.0, 220.0, 20.0, 65.0, 180.0, 130.0, 60.0, 160.0, -35.0, -33.0, 30.0, -13.0, 270.0, 70.0, 100.0, 30.0, 40.0, 15.0, 60.0, -18.0, 39.0, 40.0, 28.0, 80.0, 39.0, 110.0, 100.0, 50.0, -30.0, 770.0, 50.0, 50.0, -1.0, 369.0, 89.0, 20.0, 60.0, 100.0, 90.0, 160.0, 10.0, 90.0, 80.0, 60.0, 9.0, 120.0, 19.0, 30.0, 40.0, 89.0, 220.0, 39.0, 70.0, 59.0, 60.0, 20.0, 60.0, 36.0, 35.0, 170.0, 20.0, 38.0, 10.0, 10.0, 50.0, 60.0, 60.0, 60.0, 100.0, 79.0, 240.0, 170.0, 76.0, 200.0, 100.0, 39.0, 99.0, 7.0, 1.0, -49.0, 20.0, 280.0, 10.0, 40.0, 110.0, 110.0, 118.0, 90.0, 490.0, 68.0, 40.0, 0.0, 80.0, 20.0, 40.0, 30.0, 110.0, 80.0, 60.0, 27.0, 90.0, 70.0, 50.0, 90.0, 80.0, 62.0, 45.0, 80.0, 60.0, 110.0, 80.0, 70.0, 84.0, 66.0, 60.0, 70.0, 90.0, 20.0, 70.0, 85.0, 100.0, 27.0, 60.0, 130.0, 70.0, 100.0, 100.0, 100.0, 80.0, 70.0, 60.0, 100.0, 100.0, 44.0, 38.0, 30.0, 90.0, 60.0, 120.0, 130.0, 43.0, 60.0, -55.0, 40.0, 300.0, 110.0, 50.0, 90.0, 70.0, 70.0, 306.0, 103.0, 60.0, 115.0, 30.0, 30.0, 39.0, 20.0, 45.0, -5.0, 28.0, 170.0, 17.0, 37.0, 210.0, 130.0, 50.0, 190.0, 80.0, -21.0, 267.0, 34.0, 165.0, 15.0, 20.0, 80.0, 20.0, 80.0, 62.0, 145.0, 4.0, 73.0, 100.0, 120.0, 70.0, 52.0, 30.0, 40.0, 10.0, 39.0, 116.0, 60.0, -11.0, 30.0, 120.0, -14.0, -73.0, 410.0, 59.0, 78.0, 61.0, 90.0, 69.0, 280.0, 420.0, -37.0, 28.0, 50.0, 26.0, 110.0, 70.0, 70.0, 170.0, 90.0, 2.0, 80.0, 11.0, 14.0, 27.0, 50.0, 200.0, 16.0, 17.0, 60.0, 80.0, 100.0, 40.0, 83.0, 5.0, -7.0, 99.0, 34.0, 70.0, 50.0, 130.0, 190.0, 70.0, 44.0, 51.0, 25.0, 70.0, 5.0, 240.0, 22.0, 50.0, 70.0, 142.0, 48.0, 667.0, 60.0, 110.0, -40.0, 50.0, 20.0, 80.0, 79.0, 100.0, -30.0, 200.0, 50.0, 100.0, 26.0, 50.0, 40.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9619192586205259, "mean_inference_ms": 2.2221559220140072, "mean_action_processing_ms": 0.7590984267922845, "mean_env_wait_ms": 1.5555311761032113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13695859909057617, "StateBufferConnector_ms": 0.01033329963684082, "ViewRequirementAgentConnector_ms": 0.5385046005249023}, "num_episodes": 23, "episode_return_max": 1557.0, "episode_return_min": 289.0, "episode_return_mean": 753.14, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.5569029489103, "num_env_steps_trained_throughput_per_sec": 32.5569029489103, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 4240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4240000, "timers": {"training_iteration_time_ms": 123402.713, "restore_workers_time_ms": 0.015, "training_step_time_ms": 123402.647, "sample_time_ms": 3621.068, "learn_time_ms": 119756.712, "learn_throughput": 33.401, "synch_weights_time_ms": 14.538}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "done": false, "training_iteration": 106, "trial_id": "6085c_00000", "date": "2024-07-02_02-34-59", "timestamp": 1719902099, "time_this_iter_s": 122.8711998462677, "time_total_s": 14944.762660503387, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c93af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14944.762660503387, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 20.547126436781607, "ram_util_percent": 79.20344827586206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.02043948544227, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.392482169773886, "policy_loss": -0.007318679102524397, "vf_loss": 7.398998615612237, "vf_explained_var": 0.0018438240019277262, "kl": 0.008022341849937801, "entropy": 0.6077433132262021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1000035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "env_runners": {"episode_reward_max": 1557.0, "episode_reward_min": 353.0, "episode_reward_mean": 777.27, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -188.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 77.727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [470.0, 580.0, 453.0, 766.0, 459.0, 504.0, 450.0, 716.0, 812.0, 837.0, 615.0, 749.0, 863.0, 588.0, 744.0, 788.0, 758.0, 1209.0, 621.0, 1079.0, 577.0, 415.0, 1019.0, 1083.0, 1265.0, 491.0, 720.0, 811.0, 509.0, 769.0, 811.0, 899.0, 925.0, 705.0, 668.0, 490.0, 609.0, 799.0, 1301.0, 805.0, 798.0, 938.0, 919.0, 580.0, 690.0, 575.0, 1062.0, 502.0, 810.0, 792.0, 580.0, 750.0, 1099.0, 602.0, 583.0, 1195.0, 739.0, 353.0, 1557.0, 679.0, 746.0, 449.0, 1145.0, 557.0, 1056.0, 687.0, 717.0, 722.0, 792.0, 818.0, 1004.0, 591.0, 930.0, 754.0, 486.0, 1380.0, 579.0, 555.0, 604.0, 767.0, 1207.0, 705.0, 771.0, 606.0, 512.0, 577.0, 652.0, 775.0, 1105.0, 630.0, 515.0, 899.0, 1341.0, 973.0, 779.0, 680.0, 1253.0, 511.0, 990.0, 1372.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 30.0, 50.0, 70.0, 20.0, 50.0, 10.0, 70.0, 60.0, 30.0, 60.0, 40.0, 80.0, 70.0, 10.0, 10.0, 80.0, 110.0, 40.0, 80.0, 20.0, 80.0, -1.0, 39.0, 40.0, 90.0, 39.0, 16.0, 50.0, 80.0, 17.0, 19.0, 248.0, 53.0, 70.0, 158.0, 45.0, 40.0, 76.0, 40.0, 90.0, 10.0, 35.0, 64.0, 40.0, 20.0, 40.0, 49.0, 78.0, 33.0, 16.0, -3.0, 26.0, 20.0, 120.0, 5.0, 90.0, 160.0, 20.0, 50.0, 36.0, 30.0, 0.0, 160.0, -20.0, 39.0, 50.0, 80.0, 50.0, 25.0, 86.0, 11.0, 45.0, 120.0, 97.0, 100.0, 60.0, 50.0, 80.0, 67.0, 40.0, 140.0, 90.0, 60.0, 218.0, 60.0, 40.0, 64.0, 80.0, 20.0, 162.0, 212.0, 100.0, 100.0, 40.0, 45.0, 40.0, 79.0, 20.0, 39.0, 20.0, 80.0, 29.0, 60.0, 51.0, 170.0, 50.0, 70.0, 40.0, 45.0, 40.0, 190.0, 70.0, 24.0, 40.0, 40.0, 143.0, 65.0, 87.0, 50.0, 160.0, 30.0, 90.0, 92.0, 79.0, 40.0, 120.0, 90.0, 92.0, 70.0, 20.0, 80.0, 220.0, -6.0, -6.0, 30.0, 60.0, 70.0, 80.0, 40.0, 50.0, -12.0, 40.0, 50.0, 260.0, 80.0, 59.0, 38.0, 79.0, 100.0, 50.0, 60.0, 50.0, 129.0, 12.0, 70.0, 76.0, 120.0, 170.0, 51.0, 90.0, 50.0, 120.0, 189.0, 40.0, 60.0, 40.0, 99.0, 30.0, 40.0, 75.0, 90.0, 65.0, 109.0, 132.0, 23.0, 557.0, -140.0, 110.0, 188.0, 90.0, 87.0, 179.0, -30.0, 39.0, 40.0, 0.0, 90.0, 67.0, 59.0, 70.0, 510.0, 150.0, 13.0, -50.0, 17.0, 90.0, -10.0, 269.0, 20.0, 35.0, 30.0, 40.0, 130.0, 30.0, 47.0, 48.0, 90.0, 76.0, 51.0, 40.0, 70.0, 100.0, 60.0, 60.0, 58.0, 10.0, -20.0, 0.0, 37.0, 50.0, 0.0, 60.0, -50.0, 610.0, 59.0, 40.0, 140.0, 80.0, 30.0, 86.0, 60.0, 94.0, 251.0, 75.0, 170.0, 169.0, 50.0, 10.0, 118.0, 460.0, 50.0, 75.0, 60.0, 310.0, 60.0, 90.0, 30.0, 90.0, 40.0, 70.0, 100.0, 30.0, 50.0, 90.0, 31.0, 40.0, -12.0, 60.0, 32.0, 200.0, -10.0, 30.0, 70.0, 60.0, 150.0, 60.0, 30.0, 80.0, 50.0, -121.0, 79.0, 24.0, 320.0, -20.0, 340.0, 34.0, 100.0, 160.0, -105.0, 37.0, 40.0, 50.0, 70.0, 54.0, 58.0, 20.0, 85.0, 40.0, 55.0, 130.0, 100.0, 100.0, 70.0, 50.0, 130.0, 27.0, 90.0, 50.0, 22.0, 76.0, 80.0, 80.0, 57.0, 30.0, 28.0, 100.0, 80.0, 200.0, 80.0, 30.0, 549.0, 90.0, 60.0, 40.0, -20.0, 10.0, 10.0, 60.0, 70.0, 100.0, 170.0, 100.0, 60.0, 50.0, 120.0, 50.0, 25.0, 190.0, 60.0, 59.0, 100.0, 130.0, 59.0, 178.0, 30.0, 11.0, 4.0, 140.0, -6.0, 15.0, 58.0, 80.0, 80.0, -30.0, 50.0, 80.0, 45.0, 200.0, 90.0, 0.0, 70.0, 60.0, 30.0, 50.0, 110.0, 6.0, 56.0, 40.0, 68.0, 30.0, 60.0, 120.0, 89.0, 88.0, 60.0, 65.0, 30.0, 7.0, 60.0, -20.0, 40.0, 19.0, 90.0, 300.0, 80.0, 120.0, 40.0, 90.0, 40.0, 55.0, 69.0, 3.0, 730.0, 70.0, 27.0, 130.0, 70.0, 90.0, 57.0, 67.0, 159.0, 70.0, 70.0, 80.0, 60.0, 71.0, 90.0, 88.0, 50.0, 50.0, 80.0, 45.0, 49.0, 57.0, 80.0, 70.0, 89.0, 78.0, 200.0, -40.0, 55.0, 160.0, 147.0, 19.0, 369.0, 50.0, 50.0, 30.0, 98.0, 171.0, 167.0, 75.0, 47.0, 89.0, 60.0, 60.0, 70.0, 80.0, 100.0, 38.0, 80.0, 60.0, 69.0, 50.0, 10.0, 56.0, 68.0, 90.0, 59.0, 57.0, 130.0, 150.0, 69.0, 60.0, 50.0, 31.0, 53.0, 20.0, 70.0, 0.0, 60.0, 110.0, 150.0, 70.0, -44.0, 49.0, 30.0, 70.0, 80.0, 70.0, 80.0, 80.0, 118.0, 59.0, 380.0, 70.0, 169.0, 57.0, -21.0, 30.0, 40.0, 38.0, 150.0, -8.0, 59.0, 60.0, 68.0, 15.0, 50.0, 40.0, 90.0, 50.0, 100.0, 60.0, 100.0, 50.0, 80.0, 60.0, 180.0, 60.0, 32.0, -20.0, 70.0, 210.0, 180.0, 100.0, 10.0, 80.0, 70.0, 30.0, 100.0, 40.0, 100.0, 50.0, 90.0, 40.0, 70.0, 30.0, 30.0, 190.0, 60.0, 40.0, 0.0, 20.0, 100.0, 50.0, 210.0, 62.0, 18.0, 20.0, 20.0, 44.0, 60.0, 70.0, 60.0, 50.0, 670.0, 10.0, 95.0, 20.0, 60.0, 0.0, 60.0, 8.0, 40.0, 140.0, 80.0, 178.0, 16.0, 40.0, 100.0, 25.0, 40.0, 90.0, 38.0, 10.0, 70.0, 110.0, 60.0, 30.0, 70.0, 90.0, 20.0, 210.0, 290.0, 220.0, 20.0, 65.0, 180.0, 130.0, 60.0, 160.0, -35.0, -33.0, 30.0, -13.0, 270.0, 70.0, 100.0, 30.0, 40.0, 15.0, 60.0, -18.0, 39.0, 40.0, 28.0, 80.0, 39.0, 110.0, 100.0, 50.0, -30.0, 770.0, 50.0, 50.0, -1.0, 369.0, 89.0, 20.0, 60.0, 100.0, 90.0, 160.0, 10.0, 90.0, 80.0, 60.0, 9.0, 120.0, 19.0, 30.0, 40.0, 89.0, 220.0, 39.0, 70.0, 59.0, 60.0, 20.0, 60.0, 36.0, 35.0, 170.0, 20.0, 38.0, 10.0, 10.0, 50.0, 60.0, 60.0, 60.0, 100.0, 79.0, 240.0, 170.0, 76.0, 200.0, 100.0, 39.0, 99.0, 7.0, 1.0, -49.0, 20.0, 280.0, 10.0, 40.0, 110.0, 110.0, 118.0, 90.0, 490.0, 68.0, 40.0, 0.0, 80.0, 20.0, 40.0, 30.0, 110.0, 80.0, 60.0, 27.0, 90.0, 70.0, 50.0, 90.0, 80.0, 62.0, 45.0, 80.0, 60.0, 110.0, 80.0, 70.0, 84.0, 66.0, 60.0, 70.0, 90.0, 20.0, 70.0, 85.0, 100.0, 27.0, 60.0, 130.0, 70.0, 100.0, 100.0, 100.0, 80.0, 70.0, 60.0, 100.0, 100.0, 44.0, 38.0, 30.0, 90.0, 60.0, 120.0, 130.0, 43.0, 60.0, -55.0, 40.0, 300.0, 110.0, 50.0, 90.0, 70.0, 70.0, 306.0, 103.0, 60.0, 115.0, 30.0, 30.0, 39.0, 20.0, 45.0, -5.0, 28.0, 170.0, 17.0, 37.0, 210.0, 130.0, 50.0, 190.0, 80.0, -21.0, 267.0, 34.0, 165.0, 15.0, 20.0, 80.0, 20.0, 80.0, 62.0, 145.0, 4.0, 73.0, 100.0, 120.0, 70.0, 52.0, 30.0, 40.0, 10.0, 39.0, 116.0, 60.0, -11.0, 30.0, 120.0, -14.0, -73.0, 410.0, 59.0, 78.0, 61.0, 90.0, 69.0, 280.0, 420.0, -37.0, 28.0, 50.0, 26.0, 110.0, 70.0, 70.0, 170.0, 90.0, 2.0, 80.0, 11.0, 14.0, 27.0, 50.0, 200.0, 16.0, 17.0, 60.0, 80.0, 100.0, 40.0, 83.0, 5.0, -7.0, 99.0, 34.0, 70.0, 50.0, 130.0, 190.0, 70.0, 44.0, 51.0, 25.0, 70.0, 5.0, 240.0, 22.0, 50.0, 70.0, 142.0, 48.0, 667.0, 60.0, 110.0, -40.0, 50.0, 20.0, 80.0, 79.0, 100.0, -30.0, 200.0, 50.0, 100.0, 26.0, 50.0, 40.0, 90.0, 50.0, 66.0, 90.0, 80.0, 50.0, 50.0, 65.0, 100.0, 130.0, 90.0, 100.0, 50.0, 89.0, -36.0, 77.0, 14.0, 80.0, 80.0, 110.0, 42.0, 50.0, 159.0, 98.0, 90.0, 20.0, -120.0, 90.0, 30.0, 70.0, 25.0, -19.0, -76.0, 100.0, 18.0, 180.0, 110.0, 162.0, 22.0, 30.0, 50.0, 40.0, 168.0, 170.0, 103.0, 0.0, 60.0, 4.0, 195.0, -188.0, 100.0, 51.0, 99.0, 39.0, 129.0, 28.0, 100.0, 90.0, 59.0, 110.0, 70.0, 200.0, 79.0, 303.0, 40.0, 170.0, -6.0, 80.0, 50.0, 89.0, 100.0, -22.0, 19.0, 39.0, 50.0, 13.0, 315.0, 80.0, 80.0, -4.0, 60.0, 25.0, 76.0, -25.0, 50.0, 60.0, 190.0, 7.0, 36.0, 35.0, 61.0, 30.0, 130.0, 67.0, 80.0, 70.0, 15.0, 150.0, 120.0, 67.0, 170.0, 82.0, 31.0, 80.0, 40.0, 43.0, 209.0, 88.0, 558.0, 130.0, 80.0, 50.0, 80.0, 90.0, 70.0, 68.0, 80.0, 60.0, 120.0, 300.0, 55.0, 90.0, -41.0, 320.0, 70.0, 60.0, 10.0, 60.0, 100.0, 20.0, 90.0, 100.0, 190.0, 17.0, -35.0, 29.0, 25.0, 85.0, 80.0, 119.0, 70.0, 92.0, 110.0, 50.0, 89.0, 80.0, 30.0, 190.0, 340.0, 80.0, 192.0, 40.0, 30.0, 40.0, 60.0, 0.0, 14.0, 180.0, 7.0, 30.0, 110.0, 98.0, 100.0, 40.0, 33.0, 90.0, 103.0, 40.0, 214.0, 103.0, 169.0, 60.0, 45.0, 351.0, 119.0, 105.0, 100.0, 70.0, 382.0, 130.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9606740285484188, "mean_inference_ms": 2.220067625936001, "mean_action_processing_ms": 0.7581594388852037, "mean_env_wait_ms": 1.553855643185297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1384744644165039, "StateBufferConnector_ms": 0.010348796844482422, "ViewRequirementAgentConnector_ms": 0.517918586730957}, "num_episodes": 18, "episode_return_max": 1557.0, "episode_return_min": 353.0, "episode_return_mean": 777.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.66252746769889, "num_env_steps_trained_throughput_per_sec": 32.66252746769889, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 4280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4280000, "timers": {"training_iteration_time_ms": 123308.658, "restore_workers_time_ms": 0.015, "training_step_time_ms": 123308.591, "sample_time_ms": 3644.109, "learn_time_ms": 119639.427, "learn_throughput": 33.434, "synch_weights_time_ms": 14.444}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "done": false, "training_iteration": 107, "trial_id": "6085c_00000", "date": "2024-07-02_02-37-01", "timestamp": 1719902221, "time_this_iter_s": 122.47551894187927, "time_total_s": 15067.238179445267, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a74040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15067.238179445267, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 25.9514450867052, "ram_util_percent": 80.68901734104047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.013311172407656, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.885079615210065, "policy_loss": -0.007295192069625948, "vf_loss": 6.891467236203, "vf_explained_var": 0.0012003787726766893, "kl": 0.009075696670468826, "entropy": 0.6272360548488122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1009425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "env_runners": {"episode_reward_max": 1557.0, "episode_reward_min": 353.0, "episode_reward_mean": 793.91, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -188.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 79.391}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1019.0, 1083.0, 1265.0, 491.0, 720.0, 811.0, 509.0, 769.0, 811.0, 899.0, 925.0, 705.0, 668.0, 490.0, 609.0, 799.0, 1301.0, 805.0, 798.0, 938.0, 919.0, 580.0, 690.0, 575.0, 1062.0, 502.0, 810.0, 792.0, 580.0, 750.0, 1099.0, 602.0, 583.0, 1195.0, 739.0, 353.0, 1557.0, 679.0, 746.0, 449.0, 1145.0, 557.0, 1056.0, 687.0, 717.0, 722.0, 792.0, 818.0, 1004.0, 591.0, 930.0, 754.0, 486.0, 1380.0, 579.0, 555.0, 604.0, 767.0, 1207.0, 705.0, 771.0, 606.0, 512.0, 577.0, 652.0, 775.0, 1105.0, 630.0, 515.0, 899.0, 1341.0, 973.0, 779.0, 680.0, 1253.0, 511.0, 990.0, 1372.0, 450.0, 993.0, 690.0, 865.0, 520.0, 390.0, 1072.0, 970.0, 688.0, 1249.0, 933.0, 1048.0, 960.0, 755.0, 398.0, 655.0, 438.0, 918.0, 455.0, 1180.0, 449.0, 641.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 0.0, 60.0, -50.0, 610.0, 59.0, 40.0, 140.0, 80.0, 30.0, 86.0, 60.0, 94.0, 251.0, 75.0, 170.0, 169.0, 50.0, 10.0, 118.0, 460.0, 50.0, 75.0, 60.0, 310.0, 60.0, 90.0, 30.0, 90.0, 40.0, 70.0, 100.0, 30.0, 50.0, 90.0, 31.0, 40.0, -12.0, 60.0, 32.0, 200.0, -10.0, 30.0, 70.0, 60.0, 150.0, 60.0, 30.0, 80.0, 50.0, -121.0, 79.0, 24.0, 320.0, -20.0, 340.0, 34.0, 100.0, 160.0, -105.0, 37.0, 40.0, 50.0, 70.0, 54.0, 58.0, 20.0, 85.0, 40.0, 55.0, 130.0, 100.0, 100.0, 70.0, 50.0, 130.0, 27.0, 90.0, 50.0, 22.0, 76.0, 80.0, 80.0, 57.0, 30.0, 28.0, 100.0, 80.0, 200.0, 80.0, 30.0, 549.0, 90.0, 60.0, 40.0, -20.0, 10.0, 10.0, 60.0, 70.0, 100.0, 170.0, 100.0, 60.0, 50.0, 120.0, 50.0, 25.0, 190.0, 60.0, 59.0, 100.0, 130.0, 59.0, 178.0, 30.0, 11.0, 4.0, 140.0, -6.0, 15.0, 58.0, 80.0, 80.0, -30.0, 50.0, 80.0, 45.0, 200.0, 90.0, 0.0, 70.0, 60.0, 30.0, 50.0, 110.0, 6.0, 56.0, 40.0, 68.0, 30.0, 60.0, 120.0, 89.0, 88.0, 60.0, 65.0, 30.0, 7.0, 60.0, -20.0, 40.0, 19.0, 90.0, 300.0, 80.0, 120.0, 40.0, 90.0, 40.0, 55.0, 69.0, 3.0, 730.0, 70.0, 27.0, 130.0, 70.0, 90.0, 57.0, 67.0, 159.0, 70.0, 70.0, 80.0, 60.0, 71.0, 90.0, 88.0, 50.0, 50.0, 80.0, 45.0, 49.0, 57.0, 80.0, 70.0, 89.0, 78.0, 200.0, -40.0, 55.0, 160.0, 147.0, 19.0, 369.0, 50.0, 50.0, 30.0, 98.0, 171.0, 167.0, 75.0, 47.0, 89.0, 60.0, 60.0, 70.0, 80.0, 100.0, 38.0, 80.0, 60.0, 69.0, 50.0, 10.0, 56.0, 68.0, 90.0, 59.0, 57.0, 130.0, 150.0, 69.0, 60.0, 50.0, 31.0, 53.0, 20.0, 70.0, 0.0, 60.0, 110.0, 150.0, 70.0, -44.0, 49.0, 30.0, 70.0, 80.0, 70.0, 80.0, 80.0, 118.0, 59.0, 380.0, 70.0, 169.0, 57.0, -21.0, 30.0, 40.0, 38.0, 150.0, -8.0, 59.0, 60.0, 68.0, 15.0, 50.0, 40.0, 90.0, 50.0, 100.0, 60.0, 100.0, 50.0, 80.0, 60.0, 180.0, 60.0, 32.0, -20.0, 70.0, 210.0, 180.0, 100.0, 10.0, 80.0, 70.0, 30.0, 100.0, 40.0, 100.0, 50.0, 90.0, 40.0, 70.0, 30.0, 30.0, 190.0, 60.0, 40.0, 0.0, 20.0, 100.0, 50.0, 210.0, 62.0, 18.0, 20.0, 20.0, 44.0, 60.0, 70.0, 60.0, 50.0, 670.0, 10.0, 95.0, 20.0, 60.0, 0.0, 60.0, 8.0, 40.0, 140.0, 80.0, 178.0, 16.0, 40.0, 100.0, 25.0, 40.0, 90.0, 38.0, 10.0, 70.0, 110.0, 60.0, 30.0, 70.0, 90.0, 20.0, 210.0, 290.0, 220.0, 20.0, 65.0, 180.0, 130.0, 60.0, 160.0, -35.0, -33.0, 30.0, -13.0, 270.0, 70.0, 100.0, 30.0, 40.0, 15.0, 60.0, -18.0, 39.0, 40.0, 28.0, 80.0, 39.0, 110.0, 100.0, 50.0, -30.0, 770.0, 50.0, 50.0, -1.0, 369.0, 89.0, 20.0, 60.0, 100.0, 90.0, 160.0, 10.0, 90.0, 80.0, 60.0, 9.0, 120.0, 19.0, 30.0, 40.0, 89.0, 220.0, 39.0, 70.0, 59.0, 60.0, 20.0, 60.0, 36.0, 35.0, 170.0, 20.0, 38.0, 10.0, 10.0, 50.0, 60.0, 60.0, 60.0, 100.0, 79.0, 240.0, 170.0, 76.0, 200.0, 100.0, 39.0, 99.0, 7.0, 1.0, -49.0, 20.0, 280.0, 10.0, 40.0, 110.0, 110.0, 118.0, 90.0, 490.0, 68.0, 40.0, 0.0, 80.0, 20.0, 40.0, 30.0, 110.0, 80.0, 60.0, 27.0, 90.0, 70.0, 50.0, 90.0, 80.0, 62.0, 45.0, 80.0, 60.0, 110.0, 80.0, 70.0, 84.0, 66.0, 60.0, 70.0, 90.0, 20.0, 70.0, 85.0, 100.0, 27.0, 60.0, 130.0, 70.0, 100.0, 100.0, 100.0, 80.0, 70.0, 60.0, 100.0, 100.0, 44.0, 38.0, 30.0, 90.0, 60.0, 120.0, 130.0, 43.0, 60.0, -55.0, 40.0, 300.0, 110.0, 50.0, 90.0, 70.0, 70.0, 306.0, 103.0, 60.0, 115.0, 30.0, 30.0, 39.0, 20.0, 45.0, -5.0, 28.0, 170.0, 17.0, 37.0, 210.0, 130.0, 50.0, 190.0, 80.0, -21.0, 267.0, 34.0, 165.0, 15.0, 20.0, 80.0, 20.0, 80.0, 62.0, 145.0, 4.0, 73.0, 100.0, 120.0, 70.0, 52.0, 30.0, 40.0, 10.0, 39.0, 116.0, 60.0, -11.0, 30.0, 120.0, -14.0, -73.0, 410.0, 59.0, 78.0, 61.0, 90.0, 69.0, 280.0, 420.0, -37.0, 28.0, 50.0, 26.0, 110.0, 70.0, 70.0, 170.0, 90.0, 2.0, 80.0, 11.0, 14.0, 27.0, 50.0, 200.0, 16.0, 17.0, 60.0, 80.0, 100.0, 40.0, 83.0, 5.0, -7.0, 99.0, 34.0, 70.0, 50.0, 130.0, 190.0, 70.0, 44.0, 51.0, 25.0, 70.0, 5.0, 240.0, 22.0, 50.0, 70.0, 142.0, 48.0, 667.0, 60.0, 110.0, -40.0, 50.0, 20.0, 80.0, 79.0, 100.0, -30.0, 200.0, 50.0, 100.0, 26.0, 50.0, 40.0, 90.0, 50.0, 66.0, 90.0, 80.0, 50.0, 50.0, 65.0, 100.0, 130.0, 90.0, 100.0, 50.0, 89.0, -36.0, 77.0, 14.0, 80.0, 80.0, 110.0, 42.0, 50.0, 159.0, 98.0, 90.0, 20.0, -120.0, 90.0, 30.0, 70.0, 25.0, -19.0, -76.0, 100.0, 18.0, 180.0, 110.0, 162.0, 22.0, 30.0, 50.0, 40.0, 168.0, 170.0, 103.0, 0.0, 60.0, 4.0, 195.0, -188.0, 100.0, 51.0, 99.0, 39.0, 129.0, 28.0, 100.0, 90.0, 59.0, 110.0, 70.0, 200.0, 79.0, 303.0, 40.0, 170.0, -6.0, 80.0, 50.0, 89.0, 100.0, -22.0, 19.0, 39.0, 50.0, 13.0, 315.0, 80.0, 80.0, -4.0, 60.0, 25.0, 76.0, -25.0, 50.0, 60.0, 190.0, 7.0, 36.0, 35.0, 61.0, 30.0, 130.0, 67.0, 80.0, 70.0, 15.0, 150.0, 120.0, 67.0, 170.0, 82.0, 31.0, 80.0, 40.0, 43.0, 209.0, 88.0, 558.0, 130.0, 80.0, 50.0, 80.0, 90.0, 70.0, 68.0, 80.0, 60.0, 120.0, 300.0, 55.0, 90.0, -41.0, 320.0, 70.0, 60.0, 10.0, 60.0, 100.0, 20.0, 90.0, 100.0, 190.0, 17.0, -35.0, 29.0, 25.0, 85.0, 80.0, 119.0, 70.0, 92.0, 110.0, 50.0, 89.0, 80.0, 30.0, 190.0, 340.0, 80.0, 192.0, 40.0, 30.0, 40.0, 60.0, 0.0, 14.0, 180.0, 7.0, 30.0, 110.0, 98.0, 100.0, 40.0, 33.0, 90.0, 103.0, 40.0, 214.0, 103.0, 169.0, 60.0, 45.0, 351.0, 119.0, 105.0, 100.0, 70.0, 382.0, 130.0, 10.0, -30.0, -19.0, 19.0, 20.0, 190.0, 40.0, 101.0, -14.0, 103.0, 40.0, 415.0, 50.0, 78.0, 168.0, 79.0, -15.0, 98.0, 70.0, 55.0, -5.0, -20.0, 150.0, 59.0, 100.0, 170.0, 60.0, 70.0, 7.0, 68.0, 26.0, 120.0, 100.0, 100.0, 80.0, 130.0, 68.0, 90.0, 67.0, 40.0, 70.0, 60.0, 60.0, 70.0, 90.0, -13.0, 30.0, 69.0, 38.0, 60.0, 56.0, 8.0, 58.0, 80.0, 53.0, 60.0, -33.0, 7.0, 60.0, 60.0, 37.0, 62.0, 30.0, 95.0, 90.0, 20.0, 23.0, 230.0, -20.0, 560.0, -18.0, 180.0, 260.0, 130.0, 100.0, -40.0, -10.0, 40.0, 80.0, 170.0, 60.0, 50.0, 30.0, 110.0, 100.0, 29.0, 31.0, 70.0, 58.0, 110.0, 100.0, 40.0, 560.0, 0.0, 130.0, 35.0, 79.0, 167.0, 88.0, 70.0, 80.0, 35.0, 90.0, 10.0, 40.0, 125.0, 30.0, -10.0, 359.0, 144.0, 110.0, 49.0, 80.0, 60.0, 70.0, 50.0, 30.0, 200.0, 10.0, 320.0, 179.0, 150.0, 140.0, 110.0, 68.0, 10.0, 170.0, 113.0, 100.0, 79.0, 20.0, 70.0, 25.0, 20.0, 60.0, 160.0, 84.0, 10.0, 156.0, 130.0, 40.0, 60.0, 60.0, 5.0, 30.0, 49.0, 20.0, 20.0, 80.0, 60.0, 14.0, 50.0, 90.0, 80.0, -85.0, 140.0, 110.0, 40.0, 20.0, 160.0, 50.0, 40.0, 28.0, 170.0, 40.0, -5.0, 50.0, 60.0, 20.0, 10.0, 25.0, 80.0, 120.0, 0.0, 69.0, 90.0, 350.0, 50.0, 60.0, 60.0, 39.0, 49.0, 60.0, 40.0, 89.0, 37.0, 33.0, 100.0, 17.0, 0.0, 30.0, 120.0, 400.0, 100.0, 80.0, 50.0, 90.0, 10.0, 230.0, 70.0, 30.0, 10.0, 120.0, 70.0, 20.0, 5.0, 30.0, 34.0, 120.0, -10.0, 50.0, 30.0, 5.0, 47.0, 13.0, -4.0, 80.0, 20.0, 200.0, 160.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.959302163860529, "mean_inference_ms": 2.217928209131459, "mean_action_processing_ms": 0.7571187117334921, "mean_env_wait_ms": 1.5519537103911027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10348296165466309, "StateBufferConnector_ms": 0.011348962783813477, "ViewRequirementAgentConnector_ms": 0.5469202995300293}, "num_episodes": 22, "episode_return_max": 1557.0, "episode_return_min": 353.0, "episode_return_mean": 793.91, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.65035960647367, "num_env_steps_trained_throughput_per_sec": 32.65035960647367, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 4320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4320000, "timers": {"training_iteration_time_ms": 123147.007, "restore_workers_time_ms": 0.015, "training_step_time_ms": 123146.94, "sample_time_ms": 3681.006, "learn_time_ms": 119440.719, "learn_throughput": 33.489, "synch_weights_time_ms": 14.632}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "done": false, "training_iteration": 108, "trial_id": "6085c_00000", "date": "2024-07-02_02-39-04", "timestamp": 1719902344, "time_this_iter_s": 122.5267722606659, "time_total_s": 15189.764951705933, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b73700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15189.764951705933, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 21.090751445086703, "ram_util_percent": 78.99364161849711}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8983801064209436, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.924808469951089, "policy_loss": -0.006798465220672718, "vf_loss": 6.930774293641567, "vf_explained_var": 0.0006557113065506322, "kl": 0.008326421689980445, "entropy": 0.6289492173475453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1018815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "env_runners": {"episode_reward_max": 1557.0, "episode_reward_min": 353.0, "episode_reward_mean": 767.67, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 76.767}, "custom_metrics": {}, "hist_stats": {"episode_reward": [798.0, 938.0, 919.0, 580.0, 690.0, 575.0, 1062.0, 502.0, 810.0, 792.0, 580.0, 750.0, 1099.0, 602.0, 583.0, 1195.0, 739.0, 353.0, 1557.0, 679.0, 746.0, 449.0, 1145.0, 557.0, 1056.0, 687.0, 717.0, 722.0, 792.0, 818.0, 1004.0, 591.0, 930.0, 754.0, 486.0, 1380.0, 579.0, 555.0, 604.0, 767.0, 1207.0, 705.0, 771.0, 606.0, 512.0, 577.0, 652.0, 775.0, 1105.0, 630.0, 515.0, 899.0, 1341.0, 973.0, 779.0, 680.0, 1253.0, 511.0, 990.0, 1372.0, 450.0, 993.0, 690.0, 865.0, 520.0, 390.0, 1072.0, 970.0, 688.0, 1249.0, 933.0, 1048.0, 960.0, 755.0, 398.0, 655.0, 438.0, 918.0, 455.0, 1180.0, 449.0, 641.0, 694.0, 734.0, 732.0, 913.0, 1200.0, 432.0, 447.0, 766.0, 483.0, 424.0, 649.0, 491.0, 653.0, 705.0, 752.0, 709.0, 629.0, 642.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 80.0, 45.0, 49.0, 57.0, 80.0, 70.0, 89.0, 78.0, 200.0, -40.0, 55.0, 160.0, 147.0, 19.0, 369.0, 50.0, 50.0, 30.0, 98.0, 171.0, 167.0, 75.0, 47.0, 89.0, 60.0, 60.0, 70.0, 80.0, 100.0, 38.0, 80.0, 60.0, 69.0, 50.0, 10.0, 56.0, 68.0, 90.0, 59.0, 57.0, 130.0, 150.0, 69.0, 60.0, 50.0, 31.0, 53.0, 20.0, 70.0, 0.0, 60.0, 110.0, 150.0, 70.0, -44.0, 49.0, 30.0, 70.0, 80.0, 70.0, 80.0, 80.0, 118.0, 59.0, 380.0, 70.0, 169.0, 57.0, -21.0, 30.0, 40.0, 38.0, 150.0, -8.0, 59.0, 60.0, 68.0, 15.0, 50.0, 40.0, 90.0, 50.0, 100.0, 60.0, 100.0, 50.0, 80.0, 60.0, 180.0, 60.0, 32.0, -20.0, 70.0, 210.0, 180.0, 100.0, 10.0, 80.0, 70.0, 30.0, 100.0, 40.0, 100.0, 50.0, 90.0, 40.0, 70.0, 30.0, 30.0, 190.0, 60.0, 40.0, 0.0, 20.0, 100.0, 50.0, 210.0, 62.0, 18.0, 20.0, 20.0, 44.0, 60.0, 70.0, 60.0, 50.0, 670.0, 10.0, 95.0, 20.0, 60.0, 0.0, 60.0, 8.0, 40.0, 140.0, 80.0, 178.0, 16.0, 40.0, 100.0, 25.0, 40.0, 90.0, 38.0, 10.0, 70.0, 110.0, 60.0, 30.0, 70.0, 90.0, 20.0, 210.0, 290.0, 220.0, 20.0, 65.0, 180.0, 130.0, 60.0, 160.0, -35.0, -33.0, 30.0, -13.0, 270.0, 70.0, 100.0, 30.0, 40.0, 15.0, 60.0, -18.0, 39.0, 40.0, 28.0, 80.0, 39.0, 110.0, 100.0, 50.0, -30.0, 770.0, 50.0, 50.0, -1.0, 369.0, 89.0, 20.0, 60.0, 100.0, 90.0, 160.0, 10.0, 90.0, 80.0, 60.0, 9.0, 120.0, 19.0, 30.0, 40.0, 89.0, 220.0, 39.0, 70.0, 59.0, 60.0, 20.0, 60.0, 36.0, 35.0, 170.0, 20.0, 38.0, 10.0, 10.0, 50.0, 60.0, 60.0, 60.0, 100.0, 79.0, 240.0, 170.0, 76.0, 200.0, 100.0, 39.0, 99.0, 7.0, 1.0, -49.0, 20.0, 280.0, 10.0, 40.0, 110.0, 110.0, 118.0, 90.0, 490.0, 68.0, 40.0, 0.0, 80.0, 20.0, 40.0, 30.0, 110.0, 80.0, 60.0, 27.0, 90.0, 70.0, 50.0, 90.0, 80.0, 62.0, 45.0, 80.0, 60.0, 110.0, 80.0, 70.0, 84.0, 66.0, 60.0, 70.0, 90.0, 20.0, 70.0, 85.0, 100.0, 27.0, 60.0, 130.0, 70.0, 100.0, 100.0, 100.0, 80.0, 70.0, 60.0, 100.0, 100.0, 44.0, 38.0, 30.0, 90.0, 60.0, 120.0, 130.0, 43.0, 60.0, -55.0, 40.0, 300.0, 110.0, 50.0, 90.0, 70.0, 70.0, 306.0, 103.0, 60.0, 115.0, 30.0, 30.0, 39.0, 20.0, 45.0, -5.0, 28.0, 170.0, 17.0, 37.0, 210.0, 130.0, 50.0, 190.0, 80.0, -21.0, 267.0, 34.0, 165.0, 15.0, 20.0, 80.0, 20.0, 80.0, 62.0, 145.0, 4.0, 73.0, 100.0, 120.0, 70.0, 52.0, 30.0, 40.0, 10.0, 39.0, 116.0, 60.0, -11.0, 30.0, 120.0, -14.0, -73.0, 410.0, 59.0, 78.0, 61.0, 90.0, 69.0, 280.0, 420.0, -37.0, 28.0, 50.0, 26.0, 110.0, 70.0, 70.0, 170.0, 90.0, 2.0, 80.0, 11.0, 14.0, 27.0, 50.0, 200.0, 16.0, 17.0, 60.0, 80.0, 100.0, 40.0, 83.0, 5.0, -7.0, 99.0, 34.0, 70.0, 50.0, 130.0, 190.0, 70.0, 44.0, 51.0, 25.0, 70.0, 5.0, 240.0, 22.0, 50.0, 70.0, 142.0, 48.0, 667.0, 60.0, 110.0, -40.0, 50.0, 20.0, 80.0, 79.0, 100.0, -30.0, 200.0, 50.0, 100.0, 26.0, 50.0, 40.0, 90.0, 50.0, 66.0, 90.0, 80.0, 50.0, 50.0, 65.0, 100.0, 130.0, 90.0, 100.0, 50.0, 89.0, -36.0, 77.0, 14.0, 80.0, 80.0, 110.0, 42.0, 50.0, 159.0, 98.0, 90.0, 20.0, -120.0, 90.0, 30.0, 70.0, 25.0, -19.0, -76.0, 100.0, 18.0, 180.0, 110.0, 162.0, 22.0, 30.0, 50.0, 40.0, 168.0, 170.0, 103.0, 0.0, 60.0, 4.0, 195.0, -188.0, 100.0, 51.0, 99.0, 39.0, 129.0, 28.0, 100.0, 90.0, 59.0, 110.0, 70.0, 200.0, 79.0, 303.0, 40.0, 170.0, -6.0, 80.0, 50.0, 89.0, 100.0, -22.0, 19.0, 39.0, 50.0, 13.0, 315.0, 80.0, 80.0, -4.0, 60.0, 25.0, 76.0, -25.0, 50.0, 60.0, 190.0, 7.0, 36.0, 35.0, 61.0, 30.0, 130.0, 67.0, 80.0, 70.0, 15.0, 150.0, 120.0, 67.0, 170.0, 82.0, 31.0, 80.0, 40.0, 43.0, 209.0, 88.0, 558.0, 130.0, 80.0, 50.0, 80.0, 90.0, 70.0, 68.0, 80.0, 60.0, 120.0, 300.0, 55.0, 90.0, -41.0, 320.0, 70.0, 60.0, 10.0, 60.0, 100.0, 20.0, 90.0, 100.0, 190.0, 17.0, -35.0, 29.0, 25.0, 85.0, 80.0, 119.0, 70.0, 92.0, 110.0, 50.0, 89.0, 80.0, 30.0, 190.0, 340.0, 80.0, 192.0, 40.0, 30.0, 40.0, 60.0, 0.0, 14.0, 180.0, 7.0, 30.0, 110.0, 98.0, 100.0, 40.0, 33.0, 90.0, 103.0, 40.0, 214.0, 103.0, 169.0, 60.0, 45.0, 351.0, 119.0, 105.0, 100.0, 70.0, 382.0, 130.0, 10.0, -30.0, -19.0, 19.0, 20.0, 190.0, 40.0, 101.0, -14.0, 103.0, 40.0, 415.0, 50.0, 78.0, 168.0, 79.0, -15.0, 98.0, 70.0, 55.0, -5.0, -20.0, 150.0, 59.0, 100.0, 170.0, 60.0, 70.0, 7.0, 68.0, 26.0, 120.0, 100.0, 100.0, 80.0, 130.0, 68.0, 90.0, 67.0, 40.0, 70.0, 60.0, 60.0, 70.0, 90.0, -13.0, 30.0, 69.0, 38.0, 60.0, 56.0, 8.0, 58.0, 80.0, 53.0, 60.0, -33.0, 7.0, 60.0, 60.0, 37.0, 62.0, 30.0, 95.0, 90.0, 20.0, 23.0, 230.0, -20.0, 560.0, -18.0, 180.0, 260.0, 130.0, 100.0, -40.0, -10.0, 40.0, 80.0, 170.0, 60.0, 50.0, 30.0, 110.0, 100.0, 29.0, 31.0, 70.0, 58.0, 110.0, 100.0, 40.0, 560.0, 0.0, 130.0, 35.0, 79.0, 167.0, 88.0, 70.0, 80.0, 35.0, 90.0, 10.0, 40.0, 125.0, 30.0, -10.0, 359.0, 144.0, 110.0, 49.0, 80.0, 60.0, 70.0, 50.0, 30.0, 200.0, 10.0, 320.0, 179.0, 150.0, 140.0, 110.0, 68.0, 10.0, 170.0, 113.0, 100.0, 79.0, 20.0, 70.0, 25.0, 20.0, 60.0, 160.0, 84.0, 10.0, 156.0, 130.0, 40.0, 60.0, 60.0, 5.0, 30.0, 49.0, 20.0, 20.0, 80.0, 60.0, 14.0, 50.0, 90.0, 80.0, -85.0, 140.0, 110.0, 40.0, 20.0, 160.0, 50.0, 40.0, 28.0, 170.0, 40.0, -5.0, 50.0, 60.0, 20.0, 10.0, 25.0, 80.0, 120.0, 0.0, 69.0, 90.0, 350.0, 50.0, 60.0, 60.0, 39.0, 49.0, 60.0, 40.0, 89.0, 37.0, 33.0, 100.0, 17.0, 0.0, 30.0, 120.0, 400.0, 100.0, 80.0, 50.0, 90.0, 10.0, 230.0, 70.0, 30.0, 10.0, 120.0, 70.0, 20.0, 5.0, 30.0, 34.0, 120.0, -10.0, 50.0, 30.0, 5.0, 47.0, 13.0, -4.0, 80.0, 20.0, 200.0, 160.0, 90.0, 57.0, 60.0, 60.0, 66.0, 89.0, 62.0, 120.0, 50.0, 70.0, 60.0, 50.0, 100.0, 100.0, -27.0, 241.0, 30.0, 80.0, 60.0, 50.0, 50.0, 63.0, 60.0, 88.0, 30.0, 49.0, 60.0, 120.0, 84.0, 98.0, 80.0, 530.0, 60.0, 66.0, 30.0, 90.0, 50.0, -70.0, 60.0, 110.0, -13.0, 30.0, 110.0, 50.0, 50.0, 60.0, 660.0, 80.0, -10.0, 90.0, 80.0, 65.0, 46.0, 20.0, 20.0, 60.0, 62.0, 30.0, 49.0, 70.0, 10.0, 30.0, 10.0, 60.0, 60.0, 67.0, 70.0, 68.0, 100.0, 57.0, -75.0, 9.0, 100.0, 30.0, 118.0, 50.0, 80.0, 170.0, 107.0, 80.0, 22.0, 20.0, 70.0, -57.0, 80.0, 98.0, 45.0, 50.0, 77.0, 0.0, 100.0, 19.0, 20.0, 60.0, 60.0, -20.0, 100.0, 30.0, 70.0, 5.0, 80.0, 10.0, 188.0, 40.0, 49.0, 60.0, 22.0, 50.0, 50.0, 100.0, 80.0, 17.0, 23.0, 60.0, 88.0, 50.0, 95.0, 80.0, 100.0, -60.0, 38.0, 30.0, 383.0, 20.0, 23.0, 60.0, 60.0, -3.0, 30.0, 40.0, 10.0, 40.0, 70.0, 60.0, 150.0, 120.0, 90.0, -20.0, 25.0, 50.0, 120.0, 31.0, 3.0, 43.0, 378.0, 65.0, -10.0, 110.0, 60.0, 59.0, 13.0, 60.0, -5.0, 110.0, 40.0, 350.0, 100.0, 27.0, 20.0, -30.0, 37.0, 180.0, 90.0, 9.0, 30.0, 20.0, 60.0, 60.0, 70.0, 50.0, 60.0, 50.0, 309.0, 100.0, 9.0, -340.0, 194.0, 70.0, 80.0, 90.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9578960359459052, "mean_inference_ms": 2.2161090963778807, "mean_action_processing_ms": 0.7562857476219427, "mean_env_wait_ms": 1.5504549684324298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10327816009521484, "StateBufferConnector_ms": 0.011300086975097656, "ViewRequirementAgentConnector_ms": 0.5270071029663086}, "num_episodes": 18, "episode_return_max": 1557.0, "episode_return_min": 353.0, "episode_return_mean": 767.67, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.53686099914711, "num_env_steps_trained_throughput_per_sec": 32.53686099914711, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 4360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4360000, "timers": {"training_iteration_time_ms": 122894.801, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122894.733, "sample_time_ms": 3446.342, "learn_time_ms": 119423.211, "learn_throughput": 33.494, "synch_weights_time_ms": 14.48}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "done": false, "training_iteration": 109, "trial_id": "6085c_00000", "date": "2024-07-02_02-41-07", "timestamp": 1719902467, "time_this_iter_s": 122.95496582984924, "time_total_s": 15312.719917535782, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9179c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15312.719917535782, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 21.348275862068967, "ram_util_percent": 79.27528735632184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9667332944143823, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.138870211023365, "policy_loss": -0.007530244643263384, "vf_loss": 7.145521910122027, "vf_explained_var": 0.0010106969247864713, "kl": 0.008785473932007536, "entropy": 0.6320780815122227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1028205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "env_runners": {"episode_reward_max": 1557.0, "episode_reward_min": 60.0, "episode_reward_mean": 772.23, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 77.223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1557.0, 679.0, 746.0, 449.0, 1145.0, 557.0, 1056.0, 687.0, 717.0, 722.0, 792.0, 818.0, 1004.0, 591.0, 930.0, 754.0, 486.0, 1380.0, 579.0, 555.0, 604.0, 767.0, 1207.0, 705.0, 771.0, 606.0, 512.0, 577.0, 652.0, 775.0, 1105.0, 630.0, 515.0, 899.0, 1341.0, 973.0, 779.0, 680.0, 1253.0, 511.0, 990.0, 1372.0, 450.0, 993.0, 690.0, 865.0, 520.0, 390.0, 1072.0, 970.0, 688.0, 1249.0, 933.0, 1048.0, 960.0, 755.0, 398.0, 655.0, 438.0, 918.0, 455.0, 1180.0, 449.0, 641.0, 694.0, 734.0, 732.0, 913.0, 1200.0, 432.0, 447.0, 766.0, 483.0, 424.0, 649.0, 491.0, 653.0, 705.0, 752.0, 709.0, 629.0, 642.0, 60.0, 1405.0, 1051.0, 659.0, 566.0, 824.0, 672.0, 810.0, 795.0, 1051.0, 640.0, 804.0, 819.0, 758.0, 810.0, 639.0, 530.0, 1130.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 100.0, 50.0, -30.0, 770.0, 50.0, 50.0, -1.0, 369.0, 89.0, 20.0, 60.0, 100.0, 90.0, 160.0, 10.0, 90.0, 80.0, 60.0, 9.0, 120.0, 19.0, 30.0, 40.0, 89.0, 220.0, 39.0, 70.0, 59.0, 60.0, 20.0, 60.0, 36.0, 35.0, 170.0, 20.0, 38.0, 10.0, 10.0, 50.0, 60.0, 60.0, 60.0, 100.0, 79.0, 240.0, 170.0, 76.0, 200.0, 100.0, 39.0, 99.0, 7.0, 1.0, -49.0, 20.0, 280.0, 10.0, 40.0, 110.0, 110.0, 118.0, 90.0, 490.0, 68.0, 40.0, 0.0, 80.0, 20.0, 40.0, 30.0, 110.0, 80.0, 60.0, 27.0, 90.0, 70.0, 50.0, 90.0, 80.0, 62.0, 45.0, 80.0, 60.0, 110.0, 80.0, 70.0, 84.0, 66.0, 60.0, 70.0, 90.0, 20.0, 70.0, 85.0, 100.0, 27.0, 60.0, 130.0, 70.0, 100.0, 100.0, 100.0, 80.0, 70.0, 60.0, 100.0, 100.0, 44.0, 38.0, 30.0, 90.0, 60.0, 120.0, 130.0, 43.0, 60.0, -55.0, 40.0, 300.0, 110.0, 50.0, 90.0, 70.0, 70.0, 306.0, 103.0, 60.0, 115.0, 30.0, 30.0, 39.0, 20.0, 45.0, -5.0, 28.0, 170.0, 17.0, 37.0, 210.0, 130.0, 50.0, 190.0, 80.0, -21.0, 267.0, 34.0, 165.0, 15.0, 20.0, 80.0, 20.0, 80.0, 62.0, 145.0, 4.0, 73.0, 100.0, 120.0, 70.0, 52.0, 30.0, 40.0, 10.0, 39.0, 116.0, 60.0, -11.0, 30.0, 120.0, -14.0, -73.0, 410.0, 59.0, 78.0, 61.0, 90.0, 69.0, 280.0, 420.0, -37.0, 28.0, 50.0, 26.0, 110.0, 70.0, 70.0, 170.0, 90.0, 2.0, 80.0, 11.0, 14.0, 27.0, 50.0, 200.0, 16.0, 17.0, 60.0, 80.0, 100.0, 40.0, 83.0, 5.0, -7.0, 99.0, 34.0, 70.0, 50.0, 130.0, 190.0, 70.0, 44.0, 51.0, 25.0, 70.0, 5.0, 240.0, 22.0, 50.0, 70.0, 142.0, 48.0, 667.0, 60.0, 110.0, -40.0, 50.0, 20.0, 80.0, 79.0, 100.0, -30.0, 200.0, 50.0, 100.0, 26.0, 50.0, 40.0, 90.0, 50.0, 66.0, 90.0, 80.0, 50.0, 50.0, 65.0, 100.0, 130.0, 90.0, 100.0, 50.0, 89.0, -36.0, 77.0, 14.0, 80.0, 80.0, 110.0, 42.0, 50.0, 159.0, 98.0, 90.0, 20.0, -120.0, 90.0, 30.0, 70.0, 25.0, -19.0, -76.0, 100.0, 18.0, 180.0, 110.0, 162.0, 22.0, 30.0, 50.0, 40.0, 168.0, 170.0, 103.0, 0.0, 60.0, 4.0, 195.0, -188.0, 100.0, 51.0, 99.0, 39.0, 129.0, 28.0, 100.0, 90.0, 59.0, 110.0, 70.0, 200.0, 79.0, 303.0, 40.0, 170.0, -6.0, 80.0, 50.0, 89.0, 100.0, -22.0, 19.0, 39.0, 50.0, 13.0, 315.0, 80.0, 80.0, -4.0, 60.0, 25.0, 76.0, -25.0, 50.0, 60.0, 190.0, 7.0, 36.0, 35.0, 61.0, 30.0, 130.0, 67.0, 80.0, 70.0, 15.0, 150.0, 120.0, 67.0, 170.0, 82.0, 31.0, 80.0, 40.0, 43.0, 209.0, 88.0, 558.0, 130.0, 80.0, 50.0, 80.0, 90.0, 70.0, 68.0, 80.0, 60.0, 120.0, 300.0, 55.0, 90.0, -41.0, 320.0, 70.0, 60.0, 10.0, 60.0, 100.0, 20.0, 90.0, 100.0, 190.0, 17.0, -35.0, 29.0, 25.0, 85.0, 80.0, 119.0, 70.0, 92.0, 110.0, 50.0, 89.0, 80.0, 30.0, 190.0, 340.0, 80.0, 192.0, 40.0, 30.0, 40.0, 60.0, 0.0, 14.0, 180.0, 7.0, 30.0, 110.0, 98.0, 100.0, 40.0, 33.0, 90.0, 103.0, 40.0, 214.0, 103.0, 169.0, 60.0, 45.0, 351.0, 119.0, 105.0, 100.0, 70.0, 382.0, 130.0, 10.0, -30.0, -19.0, 19.0, 20.0, 190.0, 40.0, 101.0, -14.0, 103.0, 40.0, 415.0, 50.0, 78.0, 168.0, 79.0, -15.0, 98.0, 70.0, 55.0, -5.0, -20.0, 150.0, 59.0, 100.0, 170.0, 60.0, 70.0, 7.0, 68.0, 26.0, 120.0, 100.0, 100.0, 80.0, 130.0, 68.0, 90.0, 67.0, 40.0, 70.0, 60.0, 60.0, 70.0, 90.0, -13.0, 30.0, 69.0, 38.0, 60.0, 56.0, 8.0, 58.0, 80.0, 53.0, 60.0, -33.0, 7.0, 60.0, 60.0, 37.0, 62.0, 30.0, 95.0, 90.0, 20.0, 23.0, 230.0, -20.0, 560.0, -18.0, 180.0, 260.0, 130.0, 100.0, -40.0, -10.0, 40.0, 80.0, 170.0, 60.0, 50.0, 30.0, 110.0, 100.0, 29.0, 31.0, 70.0, 58.0, 110.0, 100.0, 40.0, 560.0, 0.0, 130.0, 35.0, 79.0, 167.0, 88.0, 70.0, 80.0, 35.0, 90.0, 10.0, 40.0, 125.0, 30.0, -10.0, 359.0, 144.0, 110.0, 49.0, 80.0, 60.0, 70.0, 50.0, 30.0, 200.0, 10.0, 320.0, 179.0, 150.0, 140.0, 110.0, 68.0, 10.0, 170.0, 113.0, 100.0, 79.0, 20.0, 70.0, 25.0, 20.0, 60.0, 160.0, 84.0, 10.0, 156.0, 130.0, 40.0, 60.0, 60.0, 5.0, 30.0, 49.0, 20.0, 20.0, 80.0, 60.0, 14.0, 50.0, 90.0, 80.0, -85.0, 140.0, 110.0, 40.0, 20.0, 160.0, 50.0, 40.0, 28.0, 170.0, 40.0, -5.0, 50.0, 60.0, 20.0, 10.0, 25.0, 80.0, 120.0, 0.0, 69.0, 90.0, 350.0, 50.0, 60.0, 60.0, 39.0, 49.0, 60.0, 40.0, 89.0, 37.0, 33.0, 100.0, 17.0, 0.0, 30.0, 120.0, 400.0, 100.0, 80.0, 50.0, 90.0, 10.0, 230.0, 70.0, 30.0, 10.0, 120.0, 70.0, 20.0, 5.0, 30.0, 34.0, 120.0, -10.0, 50.0, 30.0, 5.0, 47.0, 13.0, -4.0, 80.0, 20.0, 200.0, 160.0, 90.0, 57.0, 60.0, 60.0, 66.0, 89.0, 62.0, 120.0, 50.0, 70.0, 60.0, 50.0, 100.0, 100.0, -27.0, 241.0, 30.0, 80.0, 60.0, 50.0, 50.0, 63.0, 60.0, 88.0, 30.0, 49.0, 60.0, 120.0, 84.0, 98.0, 80.0, 530.0, 60.0, 66.0, 30.0, 90.0, 50.0, -70.0, 60.0, 110.0, -13.0, 30.0, 110.0, 50.0, 50.0, 60.0, 660.0, 80.0, -10.0, 90.0, 80.0, 65.0, 46.0, 20.0, 20.0, 60.0, 62.0, 30.0, 49.0, 70.0, 10.0, 30.0, 10.0, 60.0, 60.0, 67.0, 70.0, 68.0, 100.0, 57.0, -75.0, 9.0, 100.0, 30.0, 118.0, 50.0, 80.0, 170.0, 107.0, 80.0, 22.0, 20.0, 70.0, -57.0, 80.0, 98.0, 45.0, 50.0, 77.0, 0.0, 100.0, 19.0, 20.0, 60.0, 60.0, -20.0, 100.0, 30.0, 70.0, 5.0, 80.0, 10.0, 188.0, 40.0, 49.0, 60.0, 22.0, 50.0, 50.0, 100.0, 80.0, 17.0, 23.0, 60.0, 88.0, 50.0, 95.0, 80.0, 100.0, -60.0, 38.0, 30.0, 383.0, 20.0, 23.0, 60.0, 60.0, -3.0, 30.0, 40.0, 10.0, 40.0, 70.0, 60.0, 150.0, 120.0, 90.0, -20.0, 25.0, 50.0, 120.0, 31.0, 3.0, 43.0, 378.0, 65.0, -10.0, 110.0, 60.0, 59.0, 13.0, 60.0, -5.0, 110.0, 40.0, 350.0, 100.0, 27.0, 20.0, -30.0, 37.0, 180.0, 90.0, 9.0, 30.0, 20.0, 60.0, 60.0, 70.0, 50.0, 60.0, 50.0, 309.0, 100.0, 9.0, -340.0, 194.0, 70.0, 80.0, 90.0, 80.0, 22.0, 7.0, 10.0, 10.0, -10.0, -49.0, 10.0, 10.0, 20.0, 30.0, 80.0, 230.0, 50.0, 70.0, 110.0, 120.0, 35.0, 150.0, 460.0, 100.0, 507.0, 89.0, 70.0, 57.0, 118.0, -3.0, 16.0, 57.0, 50.0, 90.0, 99.0, 100.0, 32.0, 50.0, 8.0, 110.0, 90.0, 70.0, 40.0, 60.0, 50.0, 20.0, 30.0, 160.0, 111.0, 0.0, 40.0, 50.0, 105.0, 0.0, 40.0, 397.0, 38.0, 230.0, 41.0, -32.0, 50.0, 40.0, -50.0, 70.0, 130.0, 60.0, 49.0, 70.0, 25.0, 60.0, 60.0, 58.0, 80.0, 80.0, 130.0, 70.0, 20.0, 40.0, 200.0, 120.0, 40.0, 70.0, 30.0, 90.0, 17.0, 40.0, -13.0, 73.0, 360.0, 66.0, 23.0, 50.0, 100.0, 79.0, 178.0, 310.0, -47.0, 88.0, 136.0, 80.0, 70.0, 96.0, 60.0, 80.0, 130.0, 30.0, 50.0, 70.0, 80.0, 80.0, 51.0, 3.0, 66.0, 80.0, 346.0, -2.0, 39.0, 60.0, 60.0, 140.0, 70.0, 8.0, 25.0, 58.0, 80.0, 120.0, 40.0, 100.0, -11.0, 70.0, 70.0, 50.0, 210.0, 90.0, 260.0, 57.0, 80.0, 79.0, 100.0, -5.0, -12.0, 60.0, 49.0, 90.0, 47.0, 90.0, 260.0, 30.0, 20.0, 80.0, 180.0, 15.0, 48.0, 40.0, 130.0, 159.0, -60.0, 50.0, 150.0, 15.0, 60.0, 27.0, 90.0, 18.0, 100.0, 70.0, 75.0, -1.0, 30.0, 10.0, 80.0, 20.0, 100.0, 46.0, 120.0, 30.0, 310.0, 80.0, 110.0, 90.0, 80.0, 60.0, 130.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.956093118352984, "mean_inference_ms": 2.214353656225689, "mean_action_processing_ms": 0.755465296393091, "mean_env_wait_ms": 1.5487717955246594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08476138114929199, "StateBufferConnector_ms": 0.011942386627197266, "ViewRequirementAgentConnector_ms": 0.49979591369628906}, "num_episodes": 18, "episode_return_max": 1557.0, "episode_return_min": 60.0, "episode_return_mean": 772.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.749281035460335, "num_env_steps_trained_throughput_per_sec": 32.749281035460335, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 4400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4400000, "timers": {"training_iteration_time_ms": 122801.858, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122801.797, "sample_time_ms": 3400.408, "learn_time_ms": 119378.41, "learn_throughput": 33.507, "synch_weights_time_ms": 13.555}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "done": false, "training_iteration": 110, "trial_id": "6085c_00000", "date": "2024-07-02_02-43-09", "timestamp": 1719902589, "time_this_iter_s": 122.15074014663696, "time_total_s": 15434.870657682419, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13800ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15434.870657682419, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 21.247976878612718, "ram_util_percent": 79.50635838150289}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.938099383635008, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.099992437027514, "policy_loss": -0.0066289964325292605, "vf_loss": 7.105806267832795, "vf_explained_var": 0.0016951027071387115, "kl": 0.008151598398406823, "entropy": 0.6269927733051129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1037595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "env_runners": {"episode_reward_max": 1405.0, "episode_reward_min": 60.0, "episode_reward_mean": 767.04, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 76.704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [705.0, 771.0, 606.0, 512.0, 577.0, 652.0, 775.0, 1105.0, 630.0, 515.0, 899.0, 1341.0, 973.0, 779.0, 680.0, 1253.0, 511.0, 990.0, 1372.0, 450.0, 993.0, 690.0, 865.0, 520.0, 390.0, 1072.0, 970.0, 688.0, 1249.0, 933.0, 1048.0, 960.0, 755.0, 398.0, 655.0, 438.0, 918.0, 455.0, 1180.0, 449.0, 641.0, 694.0, 734.0, 732.0, 913.0, 1200.0, 432.0, 447.0, 766.0, 483.0, 424.0, 649.0, 491.0, 653.0, 705.0, 752.0, 709.0, 629.0, 642.0, 60.0, 1405.0, 1051.0, 659.0, 566.0, 824.0, 672.0, 810.0, 795.0, 1051.0, 640.0, 804.0, 819.0, 758.0, 810.0, 639.0, 530.0, 1130.0, 890.0, 617.0, 570.0, 1023.0, 860.0, 878.0, 971.0, 740.0, 828.0, 513.0, 575.0, 954.0, 790.0, 1035.0, 807.0, 725.0, 1038.0, 653.0, 552.0, 773.0, 950.0, 532.0, 989.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [79.0, 100.0, -30.0, 200.0, 50.0, 100.0, 26.0, 50.0, 40.0, 90.0, 50.0, 66.0, 90.0, 80.0, 50.0, 50.0, 65.0, 100.0, 130.0, 90.0, 100.0, 50.0, 89.0, -36.0, 77.0, 14.0, 80.0, 80.0, 110.0, 42.0, 50.0, 159.0, 98.0, 90.0, 20.0, -120.0, 90.0, 30.0, 70.0, 25.0, -19.0, -76.0, 100.0, 18.0, 180.0, 110.0, 162.0, 22.0, 30.0, 50.0, 40.0, 168.0, 170.0, 103.0, 0.0, 60.0, 4.0, 195.0, -188.0, 100.0, 51.0, 99.0, 39.0, 129.0, 28.0, 100.0, 90.0, 59.0, 110.0, 70.0, 200.0, 79.0, 303.0, 40.0, 170.0, -6.0, 80.0, 50.0, 89.0, 100.0, -22.0, 19.0, 39.0, 50.0, 13.0, 315.0, 80.0, 80.0, -4.0, 60.0, 25.0, 76.0, -25.0, 50.0, 60.0, 190.0, 7.0, 36.0, 35.0, 61.0, 30.0, 130.0, 67.0, 80.0, 70.0, 15.0, 150.0, 120.0, 67.0, 170.0, 82.0, 31.0, 80.0, 40.0, 43.0, 209.0, 88.0, 558.0, 130.0, 80.0, 50.0, 80.0, 90.0, 70.0, 68.0, 80.0, 60.0, 120.0, 300.0, 55.0, 90.0, -41.0, 320.0, 70.0, 60.0, 10.0, 60.0, 100.0, 20.0, 90.0, 100.0, 190.0, 17.0, -35.0, 29.0, 25.0, 85.0, 80.0, 119.0, 70.0, 92.0, 110.0, 50.0, 89.0, 80.0, 30.0, 190.0, 340.0, 80.0, 192.0, 40.0, 30.0, 40.0, 60.0, 0.0, 14.0, 180.0, 7.0, 30.0, 110.0, 98.0, 100.0, 40.0, 33.0, 90.0, 103.0, 40.0, 214.0, 103.0, 169.0, 60.0, 45.0, 351.0, 119.0, 105.0, 100.0, 70.0, 382.0, 130.0, 10.0, -30.0, -19.0, 19.0, 20.0, 190.0, 40.0, 101.0, -14.0, 103.0, 40.0, 415.0, 50.0, 78.0, 168.0, 79.0, -15.0, 98.0, 70.0, 55.0, -5.0, -20.0, 150.0, 59.0, 100.0, 170.0, 60.0, 70.0, 7.0, 68.0, 26.0, 120.0, 100.0, 100.0, 80.0, 130.0, 68.0, 90.0, 67.0, 40.0, 70.0, 60.0, 60.0, 70.0, 90.0, -13.0, 30.0, 69.0, 38.0, 60.0, 56.0, 8.0, 58.0, 80.0, 53.0, 60.0, -33.0, 7.0, 60.0, 60.0, 37.0, 62.0, 30.0, 95.0, 90.0, 20.0, 23.0, 230.0, -20.0, 560.0, -18.0, 180.0, 260.0, 130.0, 100.0, -40.0, -10.0, 40.0, 80.0, 170.0, 60.0, 50.0, 30.0, 110.0, 100.0, 29.0, 31.0, 70.0, 58.0, 110.0, 100.0, 40.0, 560.0, 0.0, 130.0, 35.0, 79.0, 167.0, 88.0, 70.0, 80.0, 35.0, 90.0, 10.0, 40.0, 125.0, 30.0, -10.0, 359.0, 144.0, 110.0, 49.0, 80.0, 60.0, 70.0, 50.0, 30.0, 200.0, 10.0, 320.0, 179.0, 150.0, 140.0, 110.0, 68.0, 10.0, 170.0, 113.0, 100.0, 79.0, 20.0, 70.0, 25.0, 20.0, 60.0, 160.0, 84.0, 10.0, 156.0, 130.0, 40.0, 60.0, 60.0, 5.0, 30.0, 49.0, 20.0, 20.0, 80.0, 60.0, 14.0, 50.0, 90.0, 80.0, -85.0, 140.0, 110.0, 40.0, 20.0, 160.0, 50.0, 40.0, 28.0, 170.0, 40.0, -5.0, 50.0, 60.0, 20.0, 10.0, 25.0, 80.0, 120.0, 0.0, 69.0, 90.0, 350.0, 50.0, 60.0, 60.0, 39.0, 49.0, 60.0, 40.0, 89.0, 37.0, 33.0, 100.0, 17.0, 0.0, 30.0, 120.0, 400.0, 100.0, 80.0, 50.0, 90.0, 10.0, 230.0, 70.0, 30.0, 10.0, 120.0, 70.0, 20.0, 5.0, 30.0, 34.0, 120.0, -10.0, 50.0, 30.0, 5.0, 47.0, 13.0, -4.0, 80.0, 20.0, 200.0, 160.0, 90.0, 57.0, 60.0, 60.0, 66.0, 89.0, 62.0, 120.0, 50.0, 70.0, 60.0, 50.0, 100.0, 100.0, -27.0, 241.0, 30.0, 80.0, 60.0, 50.0, 50.0, 63.0, 60.0, 88.0, 30.0, 49.0, 60.0, 120.0, 84.0, 98.0, 80.0, 530.0, 60.0, 66.0, 30.0, 90.0, 50.0, -70.0, 60.0, 110.0, -13.0, 30.0, 110.0, 50.0, 50.0, 60.0, 660.0, 80.0, -10.0, 90.0, 80.0, 65.0, 46.0, 20.0, 20.0, 60.0, 62.0, 30.0, 49.0, 70.0, 10.0, 30.0, 10.0, 60.0, 60.0, 67.0, 70.0, 68.0, 100.0, 57.0, -75.0, 9.0, 100.0, 30.0, 118.0, 50.0, 80.0, 170.0, 107.0, 80.0, 22.0, 20.0, 70.0, -57.0, 80.0, 98.0, 45.0, 50.0, 77.0, 0.0, 100.0, 19.0, 20.0, 60.0, 60.0, -20.0, 100.0, 30.0, 70.0, 5.0, 80.0, 10.0, 188.0, 40.0, 49.0, 60.0, 22.0, 50.0, 50.0, 100.0, 80.0, 17.0, 23.0, 60.0, 88.0, 50.0, 95.0, 80.0, 100.0, -60.0, 38.0, 30.0, 383.0, 20.0, 23.0, 60.0, 60.0, -3.0, 30.0, 40.0, 10.0, 40.0, 70.0, 60.0, 150.0, 120.0, 90.0, -20.0, 25.0, 50.0, 120.0, 31.0, 3.0, 43.0, 378.0, 65.0, -10.0, 110.0, 60.0, 59.0, 13.0, 60.0, -5.0, 110.0, 40.0, 350.0, 100.0, 27.0, 20.0, -30.0, 37.0, 180.0, 90.0, 9.0, 30.0, 20.0, 60.0, 60.0, 70.0, 50.0, 60.0, 50.0, 309.0, 100.0, 9.0, -340.0, 194.0, 70.0, 80.0, 90.0, 80.0, 22.0, 7.0, 10.0, 10.0, -10.0, -49.0, 10.0, 10.0, 20.0, 30.0, 80.0, 230.0, 50.0, 70.0, 110.0, 120.0, 35.0, 150.0, 460.0, 100.0, 507.0, 89.0, 70.0, 57.0, 118.0, -3.0, 16.0, 57.0, 50.0, 90.0, 99.0, 100.0, 32.0, 50.0, 8.0, 110.0, 90.0, 70.0, 40.0, 60.0, 50.0, 20.0, 30.0, 160.0, 111.0, 0.0, 40.0, 50.0, 105.0, 0.0, 40.0, 397.0, 38.0, 230.0, 41.0, -32.0, 50.0, 40.0, -50.0, 70.0, 130.0, 60.0, 49.0, 70.0, 25.0, 60.0, 60.0, 58.0, 80.0, 80.0, 130.0, 70.0, 20.0, 40.0, 200.0, 120.0, 40.0, 70.0, 30.0, 90.0, 17.0, 40.0, -13.0, 73.0, 360.0, 66.0, 23.0, 50.0, 100.0, 79.0, 178.0, 310.0, -47.0, 88.0, 136.0, 80.0, 70.0, 96.0, 60.0, 80.0, 130.0, 30.0, 50.0, 70.0, 80.0, 80.0, 51.0, 3.0, 66.0, 80.0, 346.0, -2.0, 39.0, 60.0, 60.0, 140.0, 70.0, 8.0, 25.0, 58.0, 80.0, 120.0, 40.0, 100.0, -11.0, 70.0, 70.0, 50.0, 210.0, 90.0, 260.0, 57.0, 80.0, 79.0, 100.0, -5.0, -12.0, 60.0, 49.0, 90.0, 47.0, 90.0, 260.0, 30.0, 20.0, 80.0, 180.0, 15.0, 48.0, 40.0, 130.0, 159.0, -60.0, 50.0, 150.0, 15.0, 60.0, 27.0, 90.0, 18.0, 100.0, 70.0, 75.0, -1.0, 30.0, 10.0, 80.0, 20.0, 100.0, 46.0, 120.0, 30.0, 310.0, 80.0, 110.0, 90.0, 80.0, 60.0, 130.0, 120.0, 60.0, 10.0, 110.0, 50.0, 90.0, 60.0, 160.0, 170.0, 50.0, 130.0, 59.0, 50.0, 80.0, 58.0, 80.0, 30.0, 30.0, 70.0, 90.0, 70.0, 24.0, 39.0, 7.0, -15.0, 280.0, 15.0, 50.0, 60.0, 100.0, 10.0, 18.0, 60.0, 80.0, 90.0, 50.0, 25.0, 570.0, 70.0, 30.0, 30.0, 90.0, 50.0, 70.0, 60.0, 60.0, 110.0, 70.0, 100.0, 130.0, 120.0, 52.0, 90.0, 90.0, 50.0, 300.0, 120.0, 80.0, -4.0, 61.0, 39.0, 80.0, 70.0, -25.0, 59.0, -110.0, 68.0, 140.0, 89.0, 50.0, 550.0, 80.0, 10.0, 30.0, 20.0, 50.0, 400.0, 50.0, 70.0, 35.0, -5.0, 70.0, 80.0, 69.0, 130.0, 120.0, 90.0, 60.0, 90.0, 69.0, 50.0, 30.0, 90.0, 50.0, 50.0, 70.0, 0.0, 43.0, 60.0, 60.0, 60.0, 50.0, 35.0, 70.0, 40.0, 40.0, 130.0, 40.0, 60.0, 60.0, 50.0, 100.0, 60.0, 100.0, 76.0, 78.0, 250.0, 50.0, 100.0, 100.0, 40.0, 130.0, 110.0, 400.0, 0.0, 50.0, 0.0, 46.0, -25.0, 40.0, 39.0, 152.0, 4.0, 59.0, -10.0, 40.0, 220.0, 80.0, 40.0, 310.0, 140.0, 59.0, 70.0, 170.0, -10.0, 0.0, 70.0, 60.0, 40.0, 300.0, 48.0, 158.0, 57.0, 120.0, 40.0, 70.0, 50.0, 70.0, 60.0, -30.0, 130.0, 65.0, 43.0, -13.0, 55.0, 80.0, 515.0, 23.0, 70.0, 60.0, 140.0, 39.0, 150.0, 10.0, 100.0, 60.0, 140.0, 58.0, 50.0, 41.0, 5.0, 100.0, 40.0, 90.0, 77.0, 19.0, 160.0, 20.0, 5.0, 60.0, -19.0, 380.0, 55.0, 20.0, 60.0, -2.0, 80.0, 60.0, 10.0, 50.0, 60.0, 89.0, 100.0, 100.0, 9.0, 90.0, 149.0, 50.0, 97.0, 57.0, 209.0, 70.0, -11.0, 40.0, 300.0, 20.0, 50.0, 40.0, 0.0, -4.0, 27.0, 90.0, 49.0, 200.0, 110.0, 50.0, 90.0, 80.0, 60.0, -20.0, 280.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.953657810804994, "mean_inference_ms": 2.2119148988119948, "mean_action_processing_ms": 0.7543424314928865, "mean_env_wait_ms": 1.546691533957913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08267641067504883, "StateBufferConnector_ms": 0.013384103775024414, "ViewRequirementAgentConnector_ms": 0.5119180679321289}, "num_episodes": 23, "episode_return_max": 1405.0, "episode_return_min": 60.0, "episode_return_mean": 767.04, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.5234374079947, "num_env_steps_trained_throughput_per_sec": 32.5234374079947, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 4440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4440000, "timers": {"training_iteration_time_ms": 122794.095, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122794.035, "sample_time_ms": 3398.03, "learn_time_ms": 119372.929, "learn_throughput": 33.508, "synch_weights_time_ms": 13.495}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "done": false, "training_iteration": 111, "trial_id": "6085c_00000", "date": "2024-07-02_02-45-12", "timestamp": 1719902712, "time_this_iter_s": 123.00032091140747, "time_total_s": 15557.870978593826, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138bbd700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15557.870978593826, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 21.556896551724137, "ram_util_percent": 80.15632183908045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.866206884542847, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.044159807970983, "policy_loss": -0.00722497801437252, "vf_loss": 7.050482944939464, "vf_explained_var": 0.0015110407584010602, "kl": 0.009018403989773887, "entropy": 0.6065743336154503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1046985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "env_runners": {"episode_reward_max": 1405.0, "episode_reward_min": 60.0, "episode_reward_mean": 754.96, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 75.496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1372.0, 450.0, 993.0, 690.0, 865.0, 520.0, 390.0, 1072.0, 970.0, 688.0, 1249.0, 933.0, 1048.0, 960.0, 755.0, 398.0, 655.0, 438.0, 918.0, 455.0, 1180.0, 449.0, 641.0, 694.0, 734.0, 732.0, 913.0, 1200.0, 432.0, 447.0, 766.0, 483.0, 424.0, 649.0, 491.0, 653.0, 705.0, 752.0, 709.0, 629.0, 642.0, 60.0, 1405.0, 1051.0, 659.0, 566.0, 824.0, 672.0, 810.0, 795.0, 1051.0, 640.0, 804.0, 819.0, 758.0, 810.0, 639.0, 530.0, 1130.0, 890.0, 617.0, 570.0, 1023.0, 860.0, 878.0, 971.0, 740.0, 828.0, 513.0, 575.0, 954.0, 790.0, 1035.0, 807.0, 725.0, 1038.0, 653.0, 552.0, 773.0, 950.0, 532.0, 989.0, 565.0, 859.0, 757.0, 1175.0, 379.0, 1132.0, 790.0, 554.0, 1110.0, 513.0, 861.0, 767.0, 728.0, 505.0, 610.0, 497.0, 648.0, 616.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 45.0, 351.0, 119.0, 105.0, 100.0, 70.0, 382.0, 130.0, 10.0, -30.0, -19.0, 19.0, 20.0, 190.0, 40.0, 101.0, -14.0, 103.0, 40.0, 415.0, 50.0, 78.0, 168.0, 79.0, -15.0, 98.0, 70.0, 55.0, -5.0, -20.0, 150.0, 59.0, 100.0, 170.0, 60.0, 70.0, 7.0, 68.0, 26.0, 120.0, 100.0, 100.0, 80.0, 130.0, 68.0, 90.0, 67.0, 40.0, 70.0, 60.0, 60.0, 70.0, 90.0, -13.0, 30.0, 69.0, 38.0, 60.0, 56.0, 8.0, 58.0, 80.0, 53.0, 60.0, -33.0, 7.0, 60.0, 60.0, 37.0, 62.0, 30.0, 95.0, 90.0, 20.0, 23.0, 230.0, -20.0, 560.0, -18.0, 180.0, 260.0, 130.0, 100.0, -40.0, -10.0, 40.0, 80.0, 170.0, 60.0, 50.0, 30.0, 110.0, 100.0, 29.0, 31.0, 70.0, 58.0, 110.0, 100.0, 40.0, 560.0, 0.0, 130.0, 35.0, 79.0, 167.0, 88.0, 70.0, 80.0, 35.0, 90.0, 10.0, 40.0, 125.0, 30.0, -10.0, 359.0, 144.0, 110.0, 49.0, 80.0, 60.0, 70.0, 50.0, 30.0, 200.0, 10.0, 320.0, 179.0, 150.0, 140.0, 110.0, 68.0, 10.0, 170.0, 113.0, 100.0, 79.0, 20.0, 70.0, 25.0, 20.0, 60.0, 160.0, 84.0, 10.0, 156.0, 130.0, 40.0, 60.0, 60.0, 5.0, 30.0, 49.0, 20.0, 20.0, 80.0, 60.0, 14.0, 50.0, 90.0, 80.0, -85.0, 140.0, 110.0, 40.0, 20.0, 160.0, 50.0, 40.0, 28.0, 170.0, 40.0, -5.0, 50.0, 60.0, 20.0, 10.0, 25.0, 80.0, 120.0, 0.0, 69.0, 90.0, 350.0, 50.0, 60.0, 60.0, 39.0, 49.0, 60.0, 40.0, 89.0, 37.0, 33.0, 100.0, 17.0, 0.0, 30.0, 120.0, 400.0, 100.0, 80.0, 50.0, 90.0, 10.0, 230.0, 70.0, 30.0, 10.0, 120.0, 70.0, 20.0, 5.0, 30.0, 34.0, 120.0, -10.0, 50.0, 30.0, 5.0, 47.0, 13.0, -4.0, 80.0, 20.0, 200.0, 160.0, 90.0, 57.0, 60.0, 60.0, 66.0, 89.0, 62.0, 120.0, 50.0, 70.0, 60.0, 50.0, 100.0, 100.0, -27.0, 241.0, 30.0, 80.0, 60.0, 50.0, 50.0, 63.0, 60.0, 88.0, 30.0, 49.0, 60.0, 120.0, 84.0, 98.0, 80.0, 530.0, 60.0, 66.0, 30.0, 90.0, 50.0, -70.0, 60.0, 110.0, -13.0, 30.0, 110.0, 50.0, 50.0, 60.0, 660.0, 80.0, -10.0, 90.0, 80.0, 65.0, 46.0, 20.0, 20.0, 60.0, 62.0, 30.0, 49.0, 70.0, 10.0, 30.0, 10.0, 60.0, 60.0, 67.0, 70.0, 68.0, 100.0, 57.0, -75.0, 9.0, 100.0, 30.0, 118.0, 50.0, 80.0, 170.0, 107.0, 80.0, 22.0, 20.0, 70.0, -57.0, 80.0, 98.0, 45.0, 50.0, 77.0, 0.0, 100.0, 19.0, 20.0, 60.0, 60.0, -20.0, 100.0, 30.0, 70.0, 5.0, 80.0, 10.0, 188.0, 40.0, 49.0, 60.0, 22.0, 50.0, 50.0, 100.0, 80.0, 17.0, 23.0, 60.0, 88.0, 50.0, 95.0, 80.0, 100.0, -60.0, 38.0, 30.0, 383.0, 20.0, 23.0, 60.0, 60.0, -3.0, 30.0, 40.0, 10.0, 40.0, 70.0, 60.0, 150.0, 120.0, 90.0, -20.0, 25.0, 50.0, 120.0, 31.0, 3.0, 43.0, 378.0, 65.0, -10.0, 110.0, 60.0, 59.0, 13.0, 60.0, -5.0, 110.0, 40.0, 350.0, 100.0, 27.0, 20.0, -30.0, 37.0, 180.0, 90.0, 9.0, 30.0, 20.0, 60.0, 60.0, 70.0, 50.0, 60.0, 50.0, 309.0, 100.0, 9.0, -340.0, 194.0, 70.0, 80.0, 90.0, 80.0, 22.0, 7.0, 10.0, 10.0, -10.0, -49.0, 10.0, 10.0, 20.0, 30.0, 80.0, 230.0, 50.0, 70.0, 110.0, 120.0, 35.0, 150.0, 460.0, 100.0, 507.0, 89.0, 70.0, 57.0, 118.0, -3.0, 16.0, 57.0, 50.0, 90.0, 99.0, 100.0, 32.0, 50.0, 8.0, 110.0, 90.0, 70.0, 40.0, 60.0, 50.0, 20.0, 30.0, 160.0, 111.0, 0.0, 40.0, 50.0, 105.0, 0.0, 40.0, 397.0, 38.0, 230.0, 41.0, -32.0, 50.0, 40.0, -50.0, 70.0, 130.0, 60.0, 49.0, 70.0, 25.0, 60.0, 60.0, 58.0, 80.0, 80.0, 130.0, 70.0, 20.0, 40.0, 200.0, 120.0, 40.0, 70.0, 30.0, 90.0, 17.0, 40.0, -13.0, 73.0, 360.0, 66.0, 23.0, 50.0, 100.0, 79.0, 178.0, 310.0, -47.0, 88.0, 136.0, 80.0, 70.0, 96.0, 60.0, 80.0, 130.0, 30.0, 50.0, 70.0, 80.0, 80.0, 51.0, 3.0, 66.0, 80.0, 346.0, -2.0, 39.0, 60.0, 60.0, 140.0, 70.0, 8.0, 25.0, 58.0, 80.0, 120.0, 40.0, 100.0, -11.0, 70.0, 70.0, 50.0, 210.0, 90.0, 260.0, 57.0, 80.0, 79.0, 100.0, -5.0, -12.0, 60.0, 49.0, 90.0, 47.0, 90.0, 260.0, 30.0, 20.0, 80.0, 180.0, 15.0, 48.0, 40.0, 130.0, 159.0, -60.0, 50.0, 150.0, 15.0, 60.0, 27.0, 90.0, 18.0, 100.0, 70.0, 75.0, -1.0, 30.0, 10.0, 80.0, 20.0, 100.0, 46.0, 120.0, 30.0, 310.0, 80.0, 110.0, 90.0, 80.0, 60.0, 130.0, 120.0, 60.0, 10.0, 110.0, 50.0, 90.0, 60.0, 160.0, 170.0, 50.0, 130.0, 59.0, 50.0, 80.0, 58.0, 80.0, 30.0, 30.0, 70.0, 90.0, 70.0, 24.0, 39.0, 7.0, -15.0, 280.0, 15.0, 50.0, 60.0, 100.0, 10.0, 18.0, 60.0, 80.0, 90.0, 50.0, 25.0, 570.0, 70.0, 30.0, 30.0, 90.0, 50.0, 70.0, 60.0, 60.0, 110.0, 70.0, 100.0, 130.0, 120.0, 52.0, 90.0, 90.0, 50.0, 300.0, 120.0, 80.0, -4.0, 61.0, 39.0, 80.0, 70.0, -25.0, 59.0, -110.0, 68.0, 140.0, 89.0, 50.0, 550.0, 80.0, 10.0, 30.0, 20.0, 50.0, 400.0, 50.0, 70.0, 35.0, -5.0, 70.0, 80.0, 69.0, 130.0, 120.0, 90.0, 60.0, 90.0, 69.0, 50.0, 30.0, 90.0, 50.0, 50.0, 70.0, 0.0, 43.0, 60.0, 60.0, 60.0, 50.0, 35.0, 70.0, 40.0, 40.0, 130.0, 40.0, 60.0, 60.0, 50.0, 100.0, 60.0, 100.0, 76.0, 78.0, 250.0, 50.0, 100.0, 100.0, 40.0, 130.0, 110.0, 400.0, 0.0, 50.0, 0.0, 46.0, -25.0, 40.0, 39.0, 152.0, 4.0, 59.0, -10.0, 40.0, 220.0, 80.0, 40.0, 310.0, 140.0, 59.0, 70.0, 170.0, -10.0, 0.0, 70.0, 60.0, 40.0, 300.0, 48.0, 158.0, 57.0, 120.0, 40.0, 70.0, 50.0, 70.0, 60.0, -30.0, 130.0, 65.0, 43.0, -13.0, 55.0, 80.0, 515.0, 23.0, 70.0, 60.0, 140.0, 39.0, 150.0, 10.0, 100.0, 60.0, 140.0, 58.0, 50.0, 41.0, 5.0, 100.0, 40.0, 90.0, 77.0, 19.0, 160.0, 20.0, 5.0, 60.0, -19.0, 380.0, 55.0, 20.0, 60.0, -2.0, 80.0, 60.0, 10.0, 50.0, 60.0, 89.0, 100.0, 100.0, 9.0, 90.0, 149.0, 50.0, 97.0, 57.0, 209.0, 70.0, -11.0, 40.0, 300.0, 20.0, 50.0, 40.0, 0.0, -4.0, 27.0, 90.0, 49.0, 200.0, 110.0, 50.0, 90.0, 80.0, 60.0, -20.0, 280.0, 60.0, 0.0, 17.0, 18.0, 50.0, 20.0, 90.0, 120.0, 170.0, 20.0, 80.0, 29.0, 120.0, 0.0, 50.0, 30.0, 30.0, 20.0, 290.0, 210.0, 30.0, 80.0, 75.0, 7.0, 24.0, 110.0, 30.0, 198.0, 33.0, 170.0, 70.0, 60.0, 50.0, 140.0, 320.0, -20.0, 220.0, 138.0, 107.0, 90.0, 30.0, 88.0, 10.0, 20.0, 58.0, 40.0, 34.0, 50.0, 30.0, 19.0, 80.0, 70.0, 40.0, 790.0, 24.0, 54.0, -30.0, -40.0, 70.0, 74.0, 40.0, 190.0, 80.0, 70.0, 200.0, -10.0, 30.0, 90.0, 70.0, 30.0, 20.0, 78.0, 87.0, 50.0, 50.0, 180.0, -60.0, 50.0, 60.0, 39.0, 90.0, 110.0, 90.0, 8.0, 61.0, 100.0, 40.0, -13.0, 699.0, -75.0, 50.0, 70.0, 4.0, 60.0, 200.0, 42.0, 39.0, 12.0, 29.0, 7.0, 102.0, 80.0, 73.0, 180.0, 80.0, 110.0, -87.0, 153.0, 70.0, 100.0, 50.0, 10.0, 100.0, 320.0, 100.0, -10.0, 10.0, 160.0, 80.0, -53.0, 120.0, 80.0, 80.0, 7.0, 157.0, 20.0, 31.0, 75.0, 69.0, 89.0, 30.0, 50.0, 31.0, 120.0, 55.0, 18.0, 80.0, -19.0, 50.0, 90.0, 50.0, 70.0, 100.0, 70.0, 50.0, 60.0, 100.0, 40.0, 50.0, 20.0, 40.0, 40.0, 18.0, 25.0, 50.0, 70.0, 50.0, 10.0, 178.0, 16.0, 150.0, 109.0, -10.0, 50.0, 70.0, 110.0, 50.0, 0.0, 59.0, 60.0, 88.0, 110.0, 70.0, 50.0, 20.0, 25.0, 71.0, 60.0, 32.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9516336612115948, "mean_inference_ms": 2.2101062852897, "mean_action_processing_ms": 0.7535169758180217, "mean_env_wait_ms": 1.545091175993362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08836245536804199, "StateBufferConnector_ms": 0.013285398483276367, "ViewRequirementAgentConnector_ms": 0.49986958503723145}, "num_episodes": 18, "episode_return_max": 1405.0, "episode_return_min": 60.0, "episode_return_mean": 754.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.28198550284474, "num_env_steps_trained_throughput_per_sec": 32.28198550284474, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 4480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4480000, "timers": {"training_iteration_time_ms": 122901.185, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122901.128, "sample_time_ms": 3385.562, "learn_time_ms": 119492.562, "learn_throughput": 33.475, "synch_weights_time_ms": 13.54}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "done": false, "training_iteration": 112, "trial_id": "6085c_00000", "date": "2024-07-02_02-47-16", "timestamp": 1719902836, "time_this_iter_s": 123.91908812522888, "time_total_s": 15681.790066719055, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9138dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15681.790066719055, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 21.001714285714286, "ram_util_percent": 80.67428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.73095029977183, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.998470090017024, "policy_loss": -0.006751414779940654, "vf_loss": 7.004266883059939, "vf_explained_var": 0.0011113680589694185, "kl": 0.009546205418675766, "entropy": 0.6434012788331039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1056375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "env_runners": {"episode_reward_max": 1405.0, "episode_reward_min": 60.0, "episode_reward_mean": 735.72, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 73.572}, "custom_metrics": {}, "hist_stats": {"episode_reward": [641.0, 694.0, 734.0, 732.0, 913.0, 1200.0, 432.0, 447.0, 766.0, 483.0, 424.0, 649.0, 491.0, 653.0, 705.0, 752.0, 709.0, 629.0, 642.0, 60.0, 1405.0, 1051.0, 659.0, 566.0, 824.0, 672.0, 810.0, 795.0, 1051.0, 640.0, 804.0, 819.0, 758.0, 810.0, 639.0, 530.0, 1130.0, 890.0, 617.0, 570.0, 1023.0, 860.0, 878.0, 971.0, 740.0, 828.0, 513.0, 575.0, 954.0, 790.0, 1035.0, 807.0, 725.0, 1038.0, 653.0, 552.0, 773.0, 950.0, 532.0, 989.0, 565.0, 859.0, 757.0, 1175.0, 379.0, 1132.0, 790.0, 554.0, 1110.0, 513.0, 861.0, 767.0, 728.0, 505.0, 610.0, 497.0, 648.0, 616.0, 880.0, 379.0, 1290.0, 541.0, 467.0, 1083.0, 669.0, 897.0, 509.0, 714.0, 631.0, 956.0, 514.0, 625.0, 568.0, 686.0, 419.0, 1097.0, 424.0, 1164.0, 356.0, 655.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 5.0, 47.0, 13.0, -4.0, 80.0, 20.0, 200.0, 160.0, 90.0, 57.0, 60.0, 60.0, 66.0, 89.0, 62.0, 120.0, 50.0, 70.0, 60.0, 50.0, 100.0, 100.0, -27.0, 241.0, 30.0, 80.0, 60.0, 50.0, 50.0, 63.0, 60.0, 88.0, 30.0, 49.0, 60.0, 120.0, 84.0, 98.0, 80.0, 530.0, 60.0, 66.0, 30.0, 90.0, 50.0, -70.0, 60.0, 110.0, -13.0, 30.0, 110.0, 50.0, 50.0, 60.0, 660.0, 80.0, -10.0, 90.0, 80.0, 65.0, 46.0, 20.0, 20.0, 60.0, 62.0, 30.0, 49.0, 70.0, 10.0, 30.0, 10.0, 60.0, 60.0, 67.0, 70.0, 68.0, 100.0, 57.0, -75.0, 9.0, 100.0, 30.0, 118.0, 50.0, 80.0, 170.0, 107.0, 80.0, 22.0, 20.0, 70.0, -57.0, 80.0, 98.0, 45.0, 50.0, 77.0, 0.0, 100.0, 19.0, 20.0, 60.0, 60.0, -20.0, 100.0, 30.0, 70.0, 5.0, 80.0, 10.0, 188.0, 40.0, 49.0, 60.0, 22.0, 50.0, 50.0, 100.0, 80.0, 17.0, 23.0, 60.0, 88.0, 50.0, 95.0, 80.0, 100.0, -60.0, 38.0, 30.0, 383.0, 20.0, 23.0, 60.0, 60.0, -3.0, 30.0, 40.0, 10.0, 40.0, 70.0, 60.0, 150.0, 120.0, 90.0, -20.0, 25.0, 50.0, 120.0, 31.0, 3.0, 43.0, 378.0, 65.0, -10.0, 110.0, 60.0, 59.0, 13.0, 60.0, -5.0, 110.0, 40.0, 350.0, 100.0, 27.0, 20.0, -30.0, 37.0, 180.0, 90.0, 9.0, 30.0, 20.0, 60.0, 60.0, 70.0, 50.0, 60.0, 50.0, 309.0, 100.0, 9.0, -340.0, 194.0, 70.0, 80.0, 90.0, 80.0, 22.0, 7.0, 10.0, 10.0, -10.0, -49.0, 10.0, 10.0, 20.0, 30.0, 80.0, 230.0, 50.0, 70.0, 110.0, 120.0, 35.0, 150.0, 460.0, 100.0, 507.0, 89.0, 70.0, 57.0, 118.0, -3.0, 16.0, 57.0, 50.0, 90.0, 99.0, 100.0, 32.0, 50.0, 8.0, 110.0, 90.0, 70.0, 40.0, 60.0, 50.0, 20.0, 30.0, 160.0, 111.0, 0.0, 40.0, 50.0, 105.0, 0.0, 40.0, 397.0, 38.0, 230.0, 41.0, -32.0, 50.0, 40.0, -50.0, 70.0, 130.0, 60.0, 49.0, 70.0, 25.0, 60.0, 60.0, 58.0, 80.0, 80.0, 130.0, 70.0, 20.0, 40.0, 200.0, 120.0, 40.0, 70.0, 30.0, 90.0, 17.0, 40.0, -13.0, 73.0, 360.0, 66.0, 23.0, 50.0, 100.0, 79.0, 178.0, 310.0, -47.0, 88.0, 136.0, 80.0, 70.0, 96.0, 60.0, 80.0, 130.0, 30.0, 50.0, 70.0, 80.0, 80.0, 51.0, 3.0, 66.0, 80.0, 346.0, -2.0, 39.0, 60.0, 60.0, 140.0, 70.0, 8.0, 25.0, 58.0, 80.0, 120.0, 40.0, 100.0, -11.0, 70.0, 70.0, 50.0, 210.0, 90.0, 260.0, 57.0, 80.0, 79.0, 100.0, -5.0, -12.0, 60.0, 49.0, 90.0, 47.0, 90.0, 260.0, 30.0, 20.0, 80.0, 180.0, 15.0, 48.0, 40.0, 130.0, 159.0, -60.0, 50.0, 150.0, 15.0, 60.0, 27.0, 90.0, 18.0, 100.0, 70.0, 75.0, -1.0, 30.0, 10.0, 80.0, 20.0, 100.0, 46.0, 120.0, 30.0, 310.0, 80.0, 110.0, 90.0, 80.0, 60.0, 130.0, 120.0, 60.0, 10.0, 110.0, 50.0, 90.0, 60.0, 160.0, 170.0, 50.0, 130.0, 59.0, 50.0, 80.0, 58.0, 80.0, 30.0, 30.0, 70.0, 90.0, 70.0, 24.0, 39.0, 7.0, -15.0, 280.0, 15.0, 50.0, 60.0, 100.0, 10.0, 18.0, 60.0, 80.0, 90.0, 50.0, 25.0, 570.0, 70.0, 30.0, 30.0, 90.0, 50.0, 70.0, 60.0, 60.0, 110.0, 70.0, 100.0, 130.0, 120.0, 52.0, 90.0, 90.0, 50.0, 300.0, 120.0, 80.0, -4.0, 61.0, 39.0, 80.0, 70.0, -25.0, 59.0, -110.0, 68.0, 140.0, 89.0, 50.0, 550.0, 80.0, 10.0, 30.0, 20.0, 50.0, 400.0, 50.0, 70.0, 35.0, -5.0, 70.0, 80.0, 69.0, 130.0, 120.0, 90.0, 60.0, 90.0, 69.0, 50.0, 30.0, 90.0, 50.0, 50.0, 70.0, 0.0, 43.0, 60.0, 60.0, 60.0, 50.0, 35.0, 70.0, 40.0, 40.0, 130.0, 40.0, 60.0, 60.0, 50.0, 100.0, 60.0, 100.0, 76.0, 78.0, 250.0, 50.0, 100.0, 100.0, 40.0, 130.0, 110.0, 400.0, 0.0, 50.0, 0.0, 46.0, -25.0, 40.0, 39.0, 152.0, 4.0, 59.0, -10.0, 40.0, 220.0, 80.0, 40.0, 310.0, 140.0, 59.0, 70.0, 170.0, -10.0, 0.0, 70.0, 60.0, 40.0, 300.0, 48.0, 158.0, 57.0, 120.0, 40.0, 70.0, 50.0, 70.0, 60.0, -30.0, 130.0, 65.0, 43.0, -13.0, 55.0, 80.0, 515.0, 23.0, 70.0, 60.0, 140.0, 39.0, 150.0, 10.0, 100.0, 60.0, 140.0, 58.0, 50.0, 41.0, 5.0, 100.0, 40.0, 90.0, 77.0, 19.0, 160.0, 20.0, 5.0, 60.0, -19.0, 380.0, 55.0, 20.0, 60.0, -2.0, 80.0, 60.0, 10.0, 50.0, 60.0, 89.0, 100.0, 100.0, 9.0, 90.0, 149.0, 50.0, 97.0, 57.0, 209.0, 70.0, -11.0, 40.0, 300.0, 20.0, 50.0, 40.0, 0.0, -4.0, 27.0, 90.0, 49.0, 200.0, 110.0, 50.0, 90.0, 80.0, 60.0, -20.0, 280.0, 60.0, 0.0, 17.0, 18.0, 50.0, 20.0, 90.0, 120.0, 170.0, 20.0, 80.0, 29.0, 120.0, 0.0, 50.0, 30.0, 30.0, 20.0, 290.0, 210.0, 30.0, 80.0, 75.0, 7.0, 24.0, 110.0, 30.0, 198.0, 33.0, 170.0, 70.0, 60.0, 50.0, 140.0, 320.0, -20.0, 220.0, 138.0, 107.0, 90.0, 30.0, 88.0, 10.0, 20.0, 58.0, 40.0, 34.0, 50.0, 30.0, 19.0, 80.0, 70.0, 40.0, 790.0, 24.0, 54.0, -30.0, -40.0, 70.0, 74.0, 40.0, 190.0, 80.0, 70.0, 200.0, -10.0, 30.0, 90.0, 70.0, 30.0, 20.0, 78.0, 87.0, 50.0, 50.0, 180.0, -60.0, 50.0, 60.0, 39.0, 90.0, 110.0, 90.0, 8.0, 61.0, 100.0, 40.0, -13.0, 699.0, -75.0, 50.0, 70.0, 4.0, 60.0, 200.0, 42.0, 39.0, 12.0, 29.0, 7.0, 102.0, 80.0, 73.0, 180.0, 80.0, 110.0, -87.0, 153.0, 70.0, 100.0, 50.0, 10.0, 100.0, 320.0, 100.0, -10.0, 10.0, 160.0, 80.0, -53.0, 120.0, 80.0, 80.0, 7.0, 157.0, 20.0, 31.0, 75.0, 69.0, 89.0, 30.0, 50.0, 31.0, 120.0, 55.0, 18.0, 80.0, -19.0, 50.0, 90.0, 50.0, 70.0, 100.0, 70.0, 50.0, 60.0, 100.0, 40.0, 50.0, 20.0, 40.0, 40.0, 18.0, 25.0, 50.0, 70.0, 50.0, 10.0, 178.0, 16.0, 150.0, 109.0, -10.0, 50.0, 70.0, 110.0, 50.0, 0.0, 59.0, 60.0, 88.0, 110.0, 70.0, 50.0, 20.0, 25.0, 71.0, 60.0, 32.0, 90.0, 30.0, 400.0, 60.0, 40.0, 90.0, 100.0, 120.0, 50.0, -20.0, 10.0, 50.0, 16.0, 0.0, 29.0, 180.0, 18.0, 31.0, 26.0, 24.0, 5.0, -30.0, 20.0, 160.0, 60.0, -20.0, 60.0, 70.0, 880.0, 90.0, 0.0, 61.0, 100.0, 10.0, -1.0, 70.0, 60.0, 71.0, 20.0, 50.0, 100.0, 10.0, 30.0, 80.0, 48.0, 100.0, 50.0, -1.0, 80.0, 40.0, 30.0, 45.0, 15.0, 120.0, 118.0, 110.0, -45.0, 90.0, 480.0, 110.0, 40.0, 86.0, 70.0, 30.0, 55.0, 390.0, 80.0, 70.0, -180.0, -20.0, 88.0, 87.0, 70.0, 320.0, 70.0, 0.0, 0.0, 70.0, 270.0, -50.0, 60.0, 72.0, 50.0, 2.0, 180.0, 25.0, 20.0, 20.0, 50.0, 60.0, 30.0, 80.0, 49.0, 60.0, 80.0, -65.0, 10.0, 220.0, 150.0, 50.0, 80.0, 31.0, 30.0, 90.0, 60.0, 35.0, 139.0, 150.0, 50.0, 40.0, 6.0, 76.0, 60.0, 170.0, 80.0, 90.0, 70.0, 130.0, 90.0, 70.0, 120.0, 60.0, 59.0, 66.0, 65.0, 40.0, 110.0, 80.0, 20.0, -6.0, 20.0, 50.0, 40.0, 40.0, 79.0, 40.0, 25.0, 25.0, 186.0, 50.0, 90.0, 90.0, 90.0, 50.0, 20.0, 50.0, 50.0, 70.0, 28.0, 60.0, 60.0, 50.0, 69.0, 120.0, 60.0, 70.0, 70.0, 50.0, 77.0, 70.0, 50.0, 77.0, -1.0, 40.0, 20.0, 3.0, 120.0, 40.0, 10.0, 33.0, 77.0, 98.0, 30.0, 460.0, 120.0, 69.0, 150.0, 110.0, 10.0, -10.0, 60.0, 14.0, 19.0, 50.0, 26.0, 50.0, 140.0, 160.0, -80.0, 20.0, 25.0, 100.0, 380.0, 100.0, 99.0, 59.0, 90.0, 66.0, 70.0, 30.0, 170.0, 100.0, -16.0, 34.0, 60.0, 70.0, 40.0, 18.0, -11.0, 70.0, -9.0, 40.0, 70.0, 10.0, 30.0, -75.0, 0.0, 80.0, 60.0, 380.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.948699017323284, "mean_inference_ms": 2.207331925059531, "mean_action_processing_ms": 0.7524403740278384, "mean_env_wait_ms": 1.5429499032298084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08582377433776855, "StateBufferConnector_ms": 0.012403488159179688, "ViewRequirementAgentConnector_ms": 0.48236584663391113}, "num_episodes": 22, "episode_return_max": 1405.0, "episode_return_min": 60.0, "episode_return_mean": 735.72, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.510270323748344, "num_env_steps_trained_throughput_per_sec": 32.510270323748344, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 4520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4520000, "timers": {"training_iteration_time_ms": 123010.667, "restore_workers_time_ms": 0.014, "training_step_time_ms": 123010.609, "sample_time_ms": 3361.326, "learn_time_ms": 119627.831, "learn_throughput": 33.437, "synch_weights_time_ms": 11.744}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "done": false, "training_iteration": 113, "trial_id": "6085c_00000", "date": "2024-07-02_02-49-19", "timestamp": 1719902959, "time_this_iter_s": 123.04673910140991, "time_total_s": 15804.836805820465, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138bbddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15804.836805820465, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 21.383333333333333, "ram_util_percent": 79.74827586206897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0587714011740252, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.734704821102155, "policy_loss": -0.007292780626458101, "vf_loss": 6.741072432555583, "vf_explained_var": 2.834320195312825e-05, "kl": 0.009251742849337, "entropy": 0.6342921111816034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1065765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "env_runners": {"episode_reward_max": 1405.0, "episode_reward_min": 60.0, "episode_reward_mean": 751.27, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -340.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 75.127}, "custom_metrics": {}, "hist_stats": {"episode_reward": [642.0, 60.0, 1405.0, 1051.0, 659.0, 566.0, 824.0, 672.0, 810.0, 795.0, 1051.0, 640.0, 804.0, 819.0, 758.0, 810.0, 639.0, 530.0, 1130.0, 890.0, 617.0, 570.0, 1023.0, 860.0, 878.0, 971.0, 740.0, 828.0, 513.0, 575.0, 954.0, 790.0, 1035.0, 807.0, 725.0, 1038.0, 653.0, 552.0, 773.0, 950.0, 532.0, 989.0, 565.0, 859.0, 757.0, 1175.0, 379.0, 1132.0, 790.0, 554.0, 1110.0, 513.0, 861.0, 767.0, 728.0, 505.0, 610.0, 497.0, 648.0, 616.0, 880.0, 379.0, 1290.0, 541.0, 467.0, 1083.0, 669.0, 897.0, 509.0, 714.0, 631.0, 956.0, 514.0, 625.0, 568.0, 686.0, 419.0, 1097.0, 424.0, 1164.0, 356.0, 655.0, 713.0, 690.0, 865.0, 761.0, 637.0, 702.0, 539.0, 1155.0, 817.0, 888.0, 874.0, 519.0, 660.0, 577.0, 907.0, 688.0, 951.0, 666.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 309.0, 100.0, 9.0, -340.0, 194.0, 70.0, 80.0, 90.0, 80.0, 22.0, 7.0, 10.0, 10.0, -10.0, -49.0, 10.0, 10.0, 20.0, 30.0, 80.0, 230.0, 50.0, 70.0, 110.0, 120.0, 35.0, 150.0, 460.0, 100.0, 507.0, 89.0, 70.0, 57.0, 118.0, -3.0, 16.0, 57.0, 50.0, 90.0, 99.0, 100.0, 32.0, 50.0, 8.0, 110.0, 90.0, 70.0, 40.0, 60.0, 50.0, 20.0, 30.0, 160.0, 111.0, 0.0, 40.0, 50.0, 105.0, 0.0, 40.0, 397.0, 38.0, 230.0, 41.0, -32.0, 50.0, 40.0, -50.0, 70.0, 130.0, 60.0, 49.0, 70.0, 25.0, 60.0, 60.0, 58.0, 80.0, 80.0, 130.0, 70.0, 20.0, 40.0, 200.0, 120.0, 40.0, 70.0, 30.0, 90.0, 17.0, 40.0, -13.0, 73.0, 360.0, 66.0, 23.0, 50.0, 100.0, 79.0, 178.0, 310.0, -47.0, 88.0, 136.0, 80.0, 70.0, 96.0, 60.0, 80.0, 130.0, 30.0, 50.0, 70.0, 80.0, 80.0, 51.0, 3.0, 66.0, 80.0, 346.0, -2.0, 39.0, 60.0, 60.0, 140.0, 70.0, 8.0, 25.0, 58.0, 80.0, 120.0, 40.0, 100.0, -11.0, 70.0, 70.0, 50.0, 210.0, 90.0, 260.0, 57.0, 80.0, 79.0, 100.0, -5.0, -12.0, 60.0, 49.0, 90.0, 47.0, 90.0, 260.0, 30.0, 20.0, 80.0, 180.0, 15.0, 48.0, 40.0, 130.0, 159.0, -60.0, 50.0, 150.0, 15.0, 60.0, 27.0, 90.0, 18.0, 100.0, 70.0, 75.0, -1.0, 30.0, 10.0, 80.0, 20.0, 100.0, 46.0, 120.0, 30.0, 310.0, 80.0, 110.0, 90.0, 80.0, 60.0, 130.0, 120.0, 60.0, 10.0, 110.0, 50.0, 90.0, 60.0, 160.0, 170.0, 50.0, 130.0, 59.0, 50.0, 80.0, 58.0, 80.0, 30.0, 30.0, 70.0, 90.0, 70.0, 24.0, 39.0, 7.0, -15.0, 280.0, 15.0, 50.0, 60.0, 100.0, 10.0, 18.0, 60.0, 80.0, 90.0, 50.0, 25.0, 570.0, 70.0, 30.0, 30.0, 90.0, 50.0, 70.0, 60.0, 60.0, 110.0, 70.0, 100.0, 130.0, 120.0, 52.0, 90.0, 90.0, 50.0, 300.0, 120.0, 80.0, -4.0, 61.0, 39.0, 80.0, 70.0, -25.0, 59.0, -110.0, 68.0, 140.0, 89.0, 50.0, 550.0, 80.0, 10.0, 30.0, 20.0, 50.0, 400.0, 50.0, 70.0, 35.0, -5.0, 70.0, 80.0, 69.0, 130.0, 120.0, 90.0, 60.0, 90.0, 69.0, 50.0, 30.0, 90.0, 50.0, 50.0, 70.0, 0.0, 43.0, 60.0, 60.0, 60.0, 50.0, 35.0, 70.0, 40.0, 40.0, 130.0, 40.0, 60.0, 60.0, 50.0, 100.0, 60.0, 100.0, 76.0, 78.0, 250.0, 50.0, 100.0, 100.0, 40.0, 130.0, 110.0, 400.0, 0.0, 50.0, 0.0, 46.0, -25.0, 40.0, 39.0, 152.0, 4.0, 59.0, -10.0, 40.0, 220.0, 80.0, 40.0, 310.0, 140.0, 59.0, 70.0, 170.0, -10.0, 0.0, 70.0, 60.0, 40.0, 300.0, 48.0, 158.0, 57.0, 120.0, 40.0, 70.0, 50.0, 70.0, 60.0, -30.0, 130.0, 65.0, 43.0, -13.0, 55.0, 80.0, 515.0, 23.0, 70.0, 60.0, 140.0, 39.0, 150.0, 10.0, 100.0, 60.0, 140.0, 58.0, 50.0, 41.0, 5.0, 100.0, 40.0, 90.0, 77.0, 19.0, 160.0, 20.0, 5.0, 60.0, -19.0, 380.0, 55.0, 20.0, 60.0, -2.0, 80.0, 60.0, 10.0, 50.0, 60.0, 89.0, 100.0, 100.0, 9.0, 90.0, 149.0, 50.0, 97.0, 57.0, 209.0, 70.0, -11.0, 40.0, 300.0, 20.0, 50.0, 40.0, 0.0, -4.0, 27.0, 90.0, 49.0, 200.0, 110.0, 50.0, 90.0, 80.0, 60.0, -20.0, 280.0, 60.0, 0.0, 17.0, 18.0, 50.0, 20.0, 90.0, 120.0, 170.0, 20.0, 80.0, 29.0, 120.0, 0.0, 50.0, 30.0, 30.0, 20.0, 290.0, 210.0, 30.0, 80.0, 75.0, 7.0, 24.0, 110.0, 30.0, 198.0, 33.0, 170.0, 70.0, 60.0, 50.0, 140.0, 320.0, -20.0, 220.0, 138.0, 107.0, 90.0, 30.0, 88.0, 10.0, 20.0, 58.0, 40.0, 34.0, 50.0, 30.0, 19.0, 80.0, 70.0, 40.0, 790.0, 24.0, 54.0, -30.0, -40.0, 70.0, 74.0, 40.0, 190.0, 80.0, 70.0, 200.0, -10.0, 30.0, 90.0, 70.0, 30.0, 20.0, 78.0, 87.0, 50.0, 50.0, 180.0, -60.0, 50.0, 60.0, 39.0, 90.0, 110.0, 90.0, 8.0, 61.0, 100.0, 40.0, -13.0, 699.0, -75.0, 50.0, 70.0, 4.0, 60.0, 200.0, 42.0, 39.0, 12.0, 29.0, 7.0, 102.0, 80.0, 73.0, 180.0, 80.0, 110.0, -87.0, 153.0, 70.0, 100.0, 50.0, 10.0, 100.0, 320.0, 100.0, -10.0, 10.0, 160.0, 80.0, -53.0, 120.0, 80.0, 80.0, 7.0, 157.0, 20.0, 31.0, 75.0, 69.0, 89.0, 30.0, 50.0, 31.0, 120.0, 55.0, 18.0, 80.0, -19.0, 50.0, 90.0, 50.0, 70.0, 100.0, 70.0, 50.0, 60.0, 100.0, 40.0, 50.0, 20.0, 40.0, 40.0, 18.0, 25.0, 50.0, 70.0, 50.0, 10.0, 178.0, 16.0, 150.0, 109.0, -10.0, 50.0, 70.0, 110.0, 50.0, 0.0, 59.0, 60.0, 88.0, 110.0, 70.0, 50.0, 20.0, 25.0, 71.0, 60.0, 32.0, 90.0, 30.0, 400.0, 60.0, 40.0, 90.0, 100.0, 120.0, 50.0, -20.0, 10.0, 50.0, 16.0, 0.0, 29.0, 180.0, 18.0, 31.0, 26.0, 24.0, 5.0, -30.0, 20.0, 160.0, 60.0, -20.0, 60.0, 70.0, 880.0, 90.0, 0.0, 61.0, 100.0, 10.0, -1.0, 70.0, 60.0, 71.0, 20.0, 50.0, 100.0, 10.0, 30.0, 80.0, 48.0, 100.0, 50.0, -1.0, 80.0, 40.0, 30.0, 45.0, 15.0, 120.0, 118.0, 110.0, -45.0, 90.0, 480.0, 110.0, 40.0, 86.0, 70.0, 30.0, 55.0, 390.0, 80.0, 70.0, -180.0, -20.0, 88.0, 87.0, 70.0, 320.0, 70.0, 0.0, 0.0, 70.0, 270.0, -50.0, 60.0, 72.0, 50.0, 2.0, 180.0, 25.0, 20.0, 20.0, 50.0, 60.0, 30.0, 80.0, 49.0, 60.0, 80.0, -65.0, 10.0, 220.0, 150.0, 50.0, 80.0, 31.0, 30.0, 90.0, 60.0, 35.0, 139.0, 150.0, 50.0, 40.0, 6.0, 76.0, 60.0, 170.0, 80.0, 90.0, 70.0, 130.0, 90.0, 70.0, 120.0, 60.0, 59.0, 66.0, 65.0, 40.0, 110.0, 80.0, 20.0, -6.0, 20.0, 50.0, 40.0, 40.0, 79.0, 40.0, 25.0, 25.0, 186.0, 50.0, 90.0, 90.0, 90.0, 50.0, 20.0, 50.0, 50.0, 70.0, 28.0, 60.0, 60.0, 50.0, 69.0, 120.0, 60.0, 70.0, 70.0, 50.0, 77.0, 70.0, 50.0, 77.0, -1.0, 40.0, 20.0, 3.0, 120.0, 40.0, 10.0, 33.0, 77.0, 98.0, 30.0, 460.0, 120.0, 69.0, 150.0, 110.0, 10.0, -10.0, 60.0, 14.0, 19.0, 50.0, 26.0, 50.0, 140.0, 160.0, -80.0, 20.0, 25.0, 100.0, 380.0, 100.0, 99.0, 59.0, 90.0, 66.0, 70.0, 30.0, 170.0, 100.0, -16.0, 34.0, 60.0, 70.0, 40.0, 18.0, -11.0, 70.0, -9.0, 40.0, 70.0, 10.0, 30.0, -75.0, 0.0, 80.0, 60.0, 380.0, 60.0, -8.0, 48.0, 390.0, 120.0, 100.0, 28.0, -32.0, 45.0, -20.0, 42.0, -44.0, 40.0, 243.0, 44.0, 60.0, 200.0, 57.0, 10.0, 70.0, 10.0, 108.0, 300.0, 75.0, 60.0, 90.0, 50.0, 10.0, 92.0, 60.0, 20.0, 29.0, 76.0, 61.0, -19.0, 108.0, 68.0, 287.0, 50.0, 32.0, 69.0, 60.0, 70.0, 50.0, 100.0, 80.0, 59.0, 20.0, 58.0, 60.0, 80.0, 38.0, 44.0, -30.0, 60.0, 18.0, 340.0, 12.0, -17.0, 7.0, 230.0, 76.0, 10.0, 40.0, 60.0, 40.0, 68.0, 30.0, 30.0, 26.0, 159.0, 420.0, 130.0, 56.0, 70.0, 70.0, 120.0, 80.0, 109.0, 50.0, 50.0, 190.0, 42.0, 80.0, 150.0, 90.0, 50.0, -23.0, 120.0, 100.0, 18.0, 0.0, 327.0, 110.0, 30.0, 59.0, 40.0, 70.0, 57.0, 170.0, 25.0, -1.0, 100.0, 45.0, 130.0, 50.0, 70.0, 120.0, 260.0, 60.0, 40.0, 0.0, 70.0, 50.0, 90.0, 19.0, -50.0, 70.0, 50.0, 70.0, 150.0, 170.0, 70.0, 18.0, 20.0, 9.0, 28.0, 70.0, 50.0, 150.0, 75.0, 100.0, 80.0, 50.0, 90.0, 15.0, -5.0, 110.0, 50.0, 57.0, 30.0, 48.0, 50.0, 120.0, 9.0, 300.0, 20.0, 30.0, 70.0, 220.0, 40.0, 29.0, 120.0, 27.0, 50.0, 128.0, 70.0, 70.0, 40.0, 14.0, 140.0, -16.0, 40.0, 120.0, 110.0, 35.0, 200.0, 70.0, 82.0, 90.0, 220.0, 100.0, 130.0, 60.0, 40.0, 60.0, 68.0, 30.0, 30.0, 48.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9464138152885337, "mean_inference_ms": 2.2049012528090297, "mean_action_processing_ms": 0.7514861974681776, "mean_env_wait_ms": 1.541087235566294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08578991889953613, "StateBufferConnector_ms": 0.012457609176635742, "ViewRequirementAgentConnector_ms": 0.49059295654296875}, "num_episodes": 18, "episode_return_max": 1405.0, "episode_return_min": 60.0, "episode_return_mean": 751.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.75588096380669, "num_env_steps_trained_throughput_per_sec": 32.75588096380669, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 4560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4560000, "timers": {"training_iteration_time_ms": 122900.568, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122900.518, "sample_time_ms": 3325.232, "learn_time_ms": 119554.028, "learn_throughput": 33.458, "synch_weights_time_ms": 11.584}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "done": false, "training_iteration": 114, "trial_id": "6085c_00000", "date": "2024-07-02_02-51-21", "timestamp": 1719903081, "time_this_iter_s": 122.12867712974548, "time_total_s": 15926.96548295021, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c52d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15926.96548295021, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 20.123837209302323, "ram_util_percent": 78.76220930232559}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8537209224269287, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.959477234496095, "policy_loss": -0.007275713476971292, "vf_loss": 6.965849606957806, "vf_explained_var": 0.00017988418999571388, "kl": 0.009033362788363992, "entropy": 0.5896409033142086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1075155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "env_runners": {"episode_reward_max": 1290.0, "episode_reward_min": 49.0, "episode_reward_mean": 741.72, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -556.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 74.172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [860.0, 878.0, 971.0, 740.0, 828.0, 513.0, 575.0, 954.0, 790.0, 1035.0, 807.0, 725.0, 1038.0, 653.0, 552.0, 773.0, 950.0, 532.0, 989.0, 565.0, 859.0, 757.0, 1175.0, 379.0, 1132.0, 790.0, 554.0, 1110.0, 513.0, 861.0, 767.0, 728.0, 505.0, 610.0, 497.0, 648.0, 616.0, 880.0, 379.0, 1290.0, 541.0, 467.0, 1083.0, 669.0, 897.0, 509.0, 714.0, 631.0, 956.0, 514.0, 625.0, 568.0, 686.0, 419.0, 1097.0, 424.0, 1164.0, 356.0, 655.0, 713.0, 690.0, 865.0, 761.0, 637.0, 702.0, 539.0, 1155.0, 817.0, 888.0, 874.0, 519.0, 660.0, 577.0, 907.0, 688.0, 951.0, 666.0, 690.0, 592.0, 631.0, 1250.0, 1068.0, 1078.0, 888.0, 797.0, 560.0, 730.0, 628.0, 545.0, 1275.0, 739.0, 903.0, 623.0, 666.0, 589.0, 49.0, 1040.0, 490.0, 660.0, 319.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 50.0, 70.0, 60.0, 60.0, 110.0, 70.0, 100.0, 130.0, 120.0, 52.0, 90.0, 90.0, 50.0, 300.0, 120.0, 80.0, -4.0, 61.0, 39.0, 80.0, 70.0, -25.0, 59.0, -110.0, 68.0, 140.0, 89.0, 50.0, 550.0, 80.0, 10.0, 30.0, 20.0, 50.0, 400.0, 50.0, 70.0, 35.0, -5.0, 70.0, 80.0, 69.0, 130.0, 120.0, 90.0, 60.0, 90.0, 69.0, 50.0, 30.0, 90.0, 50.0, 50.0, 70.0, 0.0, 43.0, 60.0, 60.0, 60.0, 50.0, 35.0, 70.0, 40.0, 40.0, 130.0, 40.0, 60.0, 60.0, 50.0, 100.0, 60.0, 100.0, 76.0, 78.0, 250.0, 50.0, 100.0, 100.0, 40.0, 130.0, 110.0, 400.0, 0.0, 50.0, 0.0, 46.0, -25.0, 40.0, 39.0, 152.0, 4.0, 59.0, -10.0, 40.0, 220.0, 80.0, 40.0, 310.0, 140.0, 59.0, 70.0, 170.0, -10.0, 0.0, 70.0, 60.0, 40.0, 300.0, 48.0, 158.0, 57.0, 120.0, 40.0, 70.0, 50.0, 70.0, 60.0, -30.0, 130.0, 65.0, 43.0, -13.0, 55.0, 80.0, 515.0, 23.0, 70.0, 60.0, 140.0, 39.0, 150.0, 10.0, 100.0, 60.0, 140.0, 58.0, 50.0, 41.0, 5.0, 100.0, 40.0, 90.0, 77.0, 19.0, 160.0, 20.0, 5.0, 60.0, -19.0, 380.0, 55.0, 20.0, 60.0, -2.0, 80.0, 60.0, 10.0, 50.0, 60.0, 89.0, 100.0, 100.0, 9.0, 90.0, 149.0, 50.0, 97.0, 57.0, 209.0, 70.0, -11.0, 40.0, 300.0, 20.0, 50.0, 40.0, 0.0, -4.0, 27.0, 90.0, 49.0, 200.0, 110.0, 50.0, 90.0, 80.0, 60.0, -20.0, 280.0, 60.0, 0.0, 17.0, 18.0, 50.0, 20.0, 90.0, 120.0, 170.0, 20.0, 80.0, 29.0, 120.0, 0.0, 50.0, 30.0, 30.0, 20.0, 290.0, 210.0, 30.0, 80.0, 75.0, 7.0, 24.0, 110.0, 30.0, 198.0, 33.0, 170.0, 70.0, 60.0, 50.0, 140.0, 320.0, -20.0, 220.0, 138.0, 107.0, 90.0, 30.0, 88.0, 10.0, 20.0, 58.0, 40.0, 34.0, 50.0, 30.0, 19.0, 80.0, 70.0, 40.0, 790.0, 24.0, 54.0, -30.0, -40.0, 70.0, 74.0, 40.0, 190.0, 80.0, 70.0, 200.0, -10.0, 30.0, 90.0, 70.0, 30.0, 20.0, 78.0, 87.0, 50.0, 50.0, 180.0, -60.0, 50.0, 60.0, 39.0, 90.0, 110.0, 90.0, 8.0, 61.0, 100.0, 40.0, -13.0, 699.0, -75.0, 50.0, 70.0, 4.0, 60.0, 200.0, 42.0, 39.0, 12.0, 29.0, 7.0, 102.0, 80.0, 73.0, 180.0, 80.0, 110.0, -87.0, 153.0, 70.0, 100.0, 50.0, 10.0, 100.0, 320.0, 100.0, -10.0, 10.0, 160.0, 80.0, -53.0, 120.0, 80.0, 80.0, 7.0, 157.0, 20.0, 31.0, 75.0, 69.0, 89.0, 30.0, 50.0, 31.0, 120.0, 55.0, 18.0, 80.0, -19.0, 50.0, 90.0, 50.0, 70.0, 100.0, 70.0, 50.0, 60.0, 100.0, 40.0, 50.0, 20.0, 40.0, 40.0, 18.0, 25.0, 50.0, 70.0, 50.0, 10.0, 178.0, 16.0, 150.0, 109.0, -10.0, 50.0, 70.0, 110.0, 50.0, 0.0, 59.0, 60.0, 88.0, 110.0, 70.0, 50.0, 20.0, 25.0, 71.0, 60.0, 32.0, 90.0, 30.0, 400.0, 60.0, 40.0, 90.0, 100.0, 120.0, 50.0, -20.0, 10.0, 50.0, 16.0, 0.0, 29.0, 180.0, 18.0, 31.0, 26.0, 24.0, 5.0, -30.0, 20.0, 160.0, 60.0, -20.0, 60.0, 70.0, 880.0, 90.0, 0.0, 61.0, 100.0, 10.0, -1.0, 70.0, 60.0, 71.0, 20.0, 50.0, 100.0, 10.0, 30.0, 80.0, 48.0, 100.0, 50.0, -1.0, 80.0, 40.0, 30.0, 45.0, 15.0, 120.0, 118.0, 110.0, -45.0, 90.0, 480.0, 110.0, 40.0, 86.0, 70.0, 30.0, 55.0, 390.0, 80.0, 70.0, -180.0, -20.0, 88.0, 87.0, 70.0, 320.0, 70.0, 0.0, 0.0, 70.0, 270.0, -50.0, 60.0, 72.0, 50.0, 2.0, 180.0, 25.0, 20.0, 20.0, 50.0, 60.0, 30.0, 80.0, 49.0, 60.0, 80.0, -65.0, 10.0, 220.0, 150.0, 50.0, 80.0, 31.0, 30.0, 90.0, 60.0, 35.0, 139.0, 150.0, 50.0, 40.0, 6.0, 76.0, 60.0, 170.0, 80.0, 90.0, 70.0, 130.0, 90.0, 70.0, 120.0, 60.0, 59.0, 66.0, 65.0, 40.0, 110.0, 80.0, 20.0, -6.0, 20.0, 50.0, 40.0, 40.0, 79.0, 40.0, 25.0, 25.0, 186.0, 50.0, 90.0, 90.0, 90.0, 50.0, 20.0, 50.0, 50.0, 70.0, 28.0, 60.0, 60.0, 50.0, 69.0, 120.0, 60.0, 70.0, 70.0, 50.0, 77.0, 70.0, 50.0, 77.0, -1.0, 40.0, 20.0, 3.0, 120.0, 40.0, 10.0, 33.0, 77.0, 98.0, 30.0, 460.0, 120.0, 69.0, 150.0, 110.0, 10.0, -10.0, 60.0, 14.0, 19.0, 50.0, 26.0, 50.0, 140.0, 160.0, -80.0, 20.0, 25.0, 100.0, 380.0, 100.0, 99.0, 59.0, 90.0, 66.0, 70.0, 30.0, 170.0, 100.0, -16.0, 34.0, 60.0, 70.0, 40.0, 18.0, -11.0, 70.0, -9.0, 40.0, 70.0, 10.0, 30.0, -75.0, 0.0, 80.0, 60.0, 380.0, 60.0, -8.0, 48.0, 390.0, 120.0, 100.0, 28.0, -32.0, 45.0, -20.0, 42.0, -44.0, 40.0, 243.0, 44.0, 60.0, 200.0, 57.0, 10.0, 70.0, 10.0, 108.0, 300.0, 75.0, 60.0, 90.0, 50.0, 10.0, 92.0, 60.0, 20.0, 29.0, 76.0, 61.0, -19.0, 108.0, 68.0, 287.0, 50.0, 32.0, 69.0, 60.0, 70.0, 50.0, 100.0, 80.0, 59.0, 20.0, 58.0, 60.0, 80.0, 38.0, 44.0, -30.0, 60.0, 18.0, 340.0, 12.0, -17.0, 7.0, 230.0, 76.0, 10.0, 40.0, 60.0, 40.0, 68.0, 30.0, 30.0, 26.0, 159.0, 420.0, 130.0, 56.0, 70.0, 70.0, 120.0, 80.0, 109.0, 50.0, 50.0, 190.0, 42.0, 80.0, 150.0, 90.0, 50.0, -23.0, 120.0, 100.0, 18.0, 0.0, 327.0, 110.0, 30.0, 59.0, 40.0, 70.0, 57.0, 170.0, 25.0, -1.0, 100.0, 45.0, 130.0, 50.0, 70.0, 120.0, 260.0, 60.0, 40.0, 0.0, 70.0, 50.0, 90.0, 19.0, -50.0, 70.0, 50.0, 70.0, 150.0, 170.0, 70.0, 18.0, 20.0, 9.0, 28.0, 70.0, 50.0, 150.0, 75.0, 100.0, 80.0, 50.0, 90.0, 15.0, -5.0, 110.0, 50.0, 57.0, 30.0, 48.0, 50.0, 120.0, 9.0, 300.0, 20.0, 30.0, 70.0, 220.0, 40.0, 29.0, 120.0, 27.0, 50.0, 128.0, 70.0, 70.0, 40.0, 14.0, 140.0, -16.0, 40.0, 120.0, 110.0, 35.0, 200.0, 70.0, 82.0, 90.0, 220.0, 100.0, 130.0, 60.0, 40.0, 60.0, 68.0, 30.0, 30.0, 48.0, 100.0, 63.0, 160.0, 30.0, -10.0, 22.0, 80.0, 21.0, 150.0, 97.0, 77.0, 90.0, 34.0, 23.0, 59.0, 23.0, 45.0, 90.0, 140.0, 18.0, 70.0, 90.0, 90.0, 30.0, 65.0, 76.0, 50.0, 60.0, 70.0, 40.0, 60.0, 79.0, 72.0, 160.0, 130.0, 110.0, 308.0, 60.0, 190.0, 110.0, 31.0, 260.0, 110.0, 80.0, 175.0, 98.0, -5.0, 64.0, 160.0, 50.0, 76.0, 50.0, 350.0, 100.0, 50.0, 70.0, 130.0, 50.0, 150.0, 38.0, 90.0, 30.0, 190.0, 62.0, 90.0, 170.0, 70.0, 20.0, 60.0, 86.0, 110.0, 109.0, 50.0, 35.0, 24.0, 50.0, 150.0, 130.0, 40.0, 250.0, -41.0, 40.0, 60.0, 20.0, 70.0, 60.0, 70.0, 30.0, 70.0, 40.0, 100.0, 90.0, 70.0, 160.0, 50.0, 40.0, 60.0, 80.0, 60.0, 50.0, 70.0, 80.0, 40.0, 100.0, 29.0, 80.0, 40.0, 70.0, 50.0, 29.0, 110.0, -5.0, 30.0, 60.0, 40.0, 60.0, 80.0, 120.0, 90.0, 50.0, 20.0, 840.0, 76.0, -2.0, 110.0, 90.0, -44.0, 79.0, 12.0, 60.0, 54.0, 69.0, 40.0, 80.0, 100.0, 126.0, 100.0, 70.0, 59.0, 66.0, 29.0, 80.0, 189.0, 80.0, 316.0, 50.0, 45.0, 96.0, 100.0, 14.0, -67.0, 90.0, 185.0, 5.0, 30.0, 20.0, 90.0, 38.0, 60.0, 40.0, 65.0, 30.0, 43.0, 79.0, 70.0, 120.0, 94.0, 60.0, 40.0, 70.0, 60.0, 20.0, 69.0, 70.0, 30.0, 70.0, 70.0, 50.0, 60.0, 110.0, 40.0, 49.0, 140.0, 49.0, 70.0, 50.0, 25.0, -556.0, 112.0, 70.0, 40.0, -20.0, 50.0, 60.0, -50.0, 13.0, -10.0, 60.0, 200.0, 57.0, 680.0, 70.0, 10.0, 30.0, 20.0, 40.0, 60.0, 130.0, 10.0, 80.0, 40.0, 140.0, 80.0, 20.0, 50.0, 50.0, 60.0, 20.0, 100.0, 80.0, 60.0, 20.0, 60.0, 20.0, 19.0, 30.0, 80.0, 10.0, 30.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9441067136666776, "mean_inference_ms": 2.2021132645098285, "mean_action_processing_ms": 0.7510730894566601, "mean_env_wait_ms": 1.5391383240349479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0731821060180664, "StateBufferConnector_ms": 0.011249542236328125, "ViewRequirementAgentConnector_ms": 0.46585845947265625}, "num_episodes": 23, "episode_return_max": 1290.0, "episode_return_min": 49.0, "episode_return_mean": 741.72, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.548593807006775, "num_env_steps_trained_throughput_per_sec": 32.548593807006775, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 4600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4600000, "timers": {"training_iteration_time_ms": 122785.718, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122785.669, "sample_time_ms": 3303.481, "learn_time_ms": 119460.969, "learn_throughput": 33.484, "synch_weights_time_ms": 11.426}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "done": false, "training_iteration": 115, "trial_id": "6085c_00000", "date": "2024-07-02_02-53-24", "timestamp": 1719903204, "time_this_iter_s": 122.92918801307678, "time_total_s": 16049.894670963287, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138bbdca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16049.894670963287, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 20.70919540229885, "ram_util_percent": 79.21724137931035}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.837190283436618, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.382500805870031, "policy_loss": -0.008327651453969149, "vf_loss": 7.389843205318918, "vf_explained_var": -0.0023845710947363774, "kl": 0.009852518983007557, "entropy": 0.5986032244528191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1084545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "env_runners": {"episode_reward_max": 1310.0, "episode_reward_min": 49.0, "episode_reward_mean": 748.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -556.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 74.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [989.0, 565.0, 859.0, 757.0, 1175.0, 379.0, 1132.0, 790.0, 554.0, 1110.0, 513.0, 861.0, 767.0, 728.0, 505.0, 610.0, 497.0, 648.0, 616.0, 880.0, 379.0, 1290.0, 541.0, 467.0, 1083.0, 669.0, 897.0, 509.0, 714.0, 631.0, 956.0, 514.0, 625.0, 568.0, 686.0, 419.0, 1097.0, 424.0, 1164.0, 356.0, 655.0, 713.0, 690.0, 865.0, 761.0, 637.0, 702.0, 539.0, 1155.0, 817.0, 888.0, 874.0, 519.0, 660.0, 577.0, 907.0, 688.0, 951.0, 666.0, 690.0, 592.0, 631.0, 1250.0, 1068.0, 1078.0, 888.0, 797.0, 560.0, 730.0, 628.0, 545.0, 1275.0, 739.0, 903.0, 623.0, 666.0, 589.0, 49.0, 1040.0, 490.0, 660.0, 319.0, 1074.0, 866.0, 1007.0, 1045.0, 843.0, 747.0, 661.0, 392.0, 778.0, 1310.0, 555.0, 1070.0, 946.0, 832.0, 729.0, 574.0, 725.0, 743.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 49.0, 200.0, 110.0, 50.0, 90.0, 80.0, 60.0, -20.0, 280.0, 60.0, 0.0, 17.0, 18.0, 50.0, 20.0, 90.0, 120.0, 170.0, 20.0, 80.0, 29.0, 120.0, 0.0, 50.0, 30.0, 30.0, 20.0, 290.0, 210.0, 30.0, 80.0, 75.0, 7.0, 24.0, 110.0, 30.0, 198.0, 33.0, 170.0, 70.0, 60.0, 50.0, 140.0, 320.0, -20.0, 220.0, 138.0, 107.0, 90.0, 30.0, 88.0, 10.0, 20.0, 58.0, 40.0, 34.0, 50.0, 30.0, 19.0, 80.0, 70.0, 40.0, 790.0, 24.0, 54.0, -30.0, -40.0, 70.0, 74.0, 40.0, 190.0, 80.0, 70.0, 200.0, -10.0, 30.0, 90.0, 70.0, 30.0, 20.0, 78.0, 87.0, 50.0, 50.0, 180.0, -60.0, 50.0, 60.0, 39.0, 90.0, 110.0, 90.0, 8.0, 61.0, 100.0, 40.0, -13.0, 699.0, -75.0, 50.0, 70.0, 4.0, 60.0, 200.0, 42.0, 39.0, 12.0, 29.0, 7.0, 102.0, 80.0, 73.0, 180.0, 80.0, 110.0, -87.0, 153.0, 70.0, 100.0, 50.0, 10.0, 100.0, 320.0, 100.0, -10.0, 10.0, 160.0, 80.0, -53.0, 120.0, 80.0, 80.0, 7.0, 157.0, 20.0, 31.0, 75.0, 69.0, 89.0, 30.0, 50.0, 31.0, 120.0, 55.0, 18.0, 80.0, -19.0, 50.0, 90.0, 50.0, 70.0, 100.0, 70.0, 50.0, 60.0, 100.0, 40.0, 50.0, 20.0, 40.0, 40.0, 18.0, 25.0, 50.0, 70.0, 50.0, 10.0, 178.0, 16.0, 150.0, 109.0, -10.0, 50.0, 70.0, 110.0, 50.0, 0.0, 59.0, 60.0, 88.0, 110.0, 70.0, 50.0, 20.0, 25.0, 71.0, 60.0, 32.0, 90.0, 30.0, 400.0, 60.0, 40.0, 90.0, 100.0, 120.0, 50.0, -20.0, 10.0, 50.0, 16.0, 0.0, 29.0, 180.0, 18.0, 31.0, 26.0, 24.0, 5.0, -30.0, 20.0, 160.0, 60.0, -20.0, 60.0, 70.0, 880.0, 90.0, 0.0, 61.0, 100.0, 10.0, -1.0, 70.0, 60.0, 71.0, 20.0, 50.0, 100.0, 10.0, 30.0, 80.0, 48.0, 100.0, 50.0, -1.0, 80.0, 40.0, 30.0, 45.0, 15.0, 120.0, 118.0, 110.0, -45.0, 90.0, 480.0, 110.0, 40.0, 86.0, 70.0, 30.0, 55.0, 390.0, 80.0, 70.0, -180.0, -20.0, 88.0, 87.0, 70.0, 320.0, 70.0, 0.0, 0.0, 70.0, 270.0, -50.0, 60.0, 72.0, 50.0, 2.0, 180.0, 25.0, 20.0, 20.0, 50.0, 60.0, 30.0, 80.0, 49.0, 60.0, 80.0, -65.0, 10.0, 220.0, 150.0, 50.0, 80.0, 31.0, 30.0, 90.0, 60.0, 35.0, 139.0, 150.0, 50.0, 40.0, 6.0, 76.0, 60.0, 170.0, 80.0, 90.0, 70.0, 130.0, 90.0, 70.0, 120.0, 60.0, 59.0, 66.0, 65.0, 40.0, 110.0, 80.0, 20.0, -6.0, 20.0, 50.0, 40.0, 40.0, 79.0, 40.0, 25.0, 25.0, 186.0, 50.0, 90.0, 90.0, 90.0, 50.0, 20.0, 50.0, 50.0, 70.0, 28.0, 60.0, 60.0, 50.0, 69.0, 120.0, 60.0, 70.0, 70.0, 50.0, 77.0, 70.0, 50.0, 77.0, -1.0, 40.0, 20.0, 3.0, 120.0, 40.0, 10.0, 33.0, 77.0, 98.0, 30.0, 460.0, 120.0, 69.0, 150.0, 110.0, 10.0, -10.0, 60.0, 14.0, 19.0, 50.0, 26.0, 50.0, 140.0, 160.0, -80.0, 20.0, 25.0, 100.0, 380.0, 100.0, 99.0, 59.0, 90.0, 66.0, 70.0, 30.0, 170.0, 100.0, -16.0, 34.0, 60.0, 70.0, 40.0, 18.0, -11.0, 70.0, -9.0, 40.0, 70.0, 10.0, 30.0, -75.0, 0.0, 80.0, 60.0, 380.0, 60.0, -8.0, 48.0, 390.0, 120.0, 100.0, 28.0, -32.0, 45.0, -20.0, 42.0, -44.0, 40.0, 243.0, 44.0, 60.0, 200.0, 57.0, 10.0, 70.0, 10.0, 108.0, 300.0, 75.0, 60.0, 90.0, 50.0, 10.0, 92.0, 60.0, 20.0, 29.0, 76.0, 61.0, -19.0, 108.0, 68.0, 287.0, 50.0, 32.0, 69.0, 60.0, 70.0, 50.0, 100.0, 80.0, 59.0, 20.0, 58.0, 60.0, 80.0, 38.0, 44.0, -30.0, 60.0, 18.0, 340.0, 12.0, -17.0, 7.0, 230.0, 76.0, 10.0, 40.0, 60.0, 40.0, 68.0, 30.0, 30.0, 26.0, 159.0, 420.0, 130.0, 56.0, 70.0, 70.0, 120.0, 80.0, 109.0, 50.0, 50.0, 190.0, 42.0, 80.0, 150.0, 90.0, 50.0, -23.0, 120.0, 100.0, 18.0, 0.0, 327.0, 110.0, 30.0, 59.0, 40.0, 70.0, 57.0, 170.0, 25.0, -1.0, 100.0, 45.0, 130.0, 50.0, 70.0, 120.0, 260.0, 60.0, 40.0, 0.0, 70.0, 50.0, 90.0, 19.0, -50.0, 70.0, 50.0, 70.0, 150.0, 170.0, 70.0, 18.0, 20.0, 9.0, 28.0, 70.0, 50.0, 150.0, 75.0, 100.0, 80.0, 50.0, 90.0, 15.0, -5.0, 110.0, 50.0, 57.0, 30.0, 48.0, 50.0, 120.0, 9.0, 300.0, 20.0, 30.0, 70.0, 220.0, 40.0, 29.0, 120.0, 27.0, 50.0, 128.0, 70.0, 70.0, 40.0, 14.0, 140.0, -16.0, 40.0, 120.0, 110.0, 35.0, 200.0, 70.0, 82.0, 90.0, 220.0, 100.0, 130.0, 60.0, 40.0, 60.0, 68.0, 30.0, 30.0, 48.0, 100.0, 63.0, 160.0, 30.0, -10.0, 22.0, 80.0, 21.0, 150.0, 97.0, 77.0, 90.0, 34.0, 23.0, 59.0, 23.0, 45.0, 90.0, 140.0, 18.0, 70.0, 90.0, 90.0, 30.0, 65.0, 76.0, 50.0, 60.0, 70.0, 40.0, 60.0, 79.0, 72.0, 160.0, 130.0, 110.0, 308.0, 60.0, 190.0, 110.0, 31.0, 260.0, 110.0, 80.0, 175.0, 98.0, -5.0, 64.0, 160.0, 50.0, 76.0, 50.0, 350.0, 100.0, 50.0, 70.0, 130.0, 50.0, 150.0, 38.0, 90.0, 30.0, 190.0, 62.0, 90.0, 170.0, 70.0, 20.0, 60.0, 86.0, 110.0, 109.0, 50.0, 35.0, 24.0, 50.0, 150.0, 130.0, 40.0, 250.0, -41.0, 40.0, 60.0, 20.0, 70.0, 60.0, 70.0, 30.0, 70.0, 40.0, 100.0, 90.0, 70.0, 160.0, 50.0, 40.0, 60.0, 80.0, 60.0, 50.0, 70.0, 80.0, 40.0, 100.0, 29.0, 80.0, 40.0, 70.0, 50.0, 29.0, 110.0, -5.0, 30.0, 60.0, 40.0, 60.0, 80.0, 120.0, 90.0, 50.0, 20.0, 840.0, 76.0, -2.0, 110.0, 90.0, -44.0, 79.0, 12.0, 60.0, 54.0, 69.0, 40.0, 80.0, 100.0, 126.0, 100.0, 70.0, 59.0, 66.0, 29.0, 80.0, 189.0, 80.0, 316.0, 50.0, 45.0, 96.0, 100.0, 14.0, -67.0, 90.0, 185.0, 5.0, 30.0, 20.0, 90.0, 38.0, 60.0, 40.0, 65.0, 30.0, 43.0, 79.0, 70.0, 120.0, 94.0, 60.0, 40.0, 70.0, 60.0, 20.0, 69.0, 70.0, 30.0, 70.0, 70.0, 50.0, 60.0, 110.0, 40.0, 49.0, 140.0, 49.0, 70.0, 50.0, 25.0, -556.0, 112.0, 70.0, 40.0, -20.0, 50.0, 60.0, -50.0, 13.0, -10.0, 60.0, 200.0, 57.0, 680.0, 70.0, 10.0, 30.0, 20.0, 40.0, 60.0, 130.0, 10.0, 80.0, 40.0, 140.0, 80.0, 20.0, 50.0, 50.0, 60.0, 20.0, 100.0, 80.0, 60.0, 20.0, 60.0, 20.0, 19.0, 30.0, 80.0, 10.0, 30.0, 30.0, 20.0, 50.0, 60.0, 70.0, 460.0, 90.0, 58.0, 90.0, 108.0, 38.0, 50.0, 80.0, 293.0, 40.0, 18.0, 100.0, 35.0, 50.0, 60.0, 100.0, 90.0, 169.0, 100.0, 180.0, -30.0, 8.0, 90.0, -30.0, 140.0, 280.0, 100.0, 180.0, 80.0, 69.0, 120.0, 110.0, 110.0, 110.0, 86.0, 50.0, 130.0, 20.0, 48.0, 60.0, -40.0, 50.0, 460.0, 26.0, 22.0, 27.0, 170.0, 340.0, 18.0, -40.0, 50.0, 50.0, 47.0, 210.0, 58.0, 79.0, -65.0, 60.0, -50.0, 196.0, 30.0, 80.0, 160.0, 79.0, 50.0, -3.0, 59.0, 40.0, 180.0, 40.0, 20.0, -1.0, 70.0, 20.0, -20.0, 30.0, 13.0, 49.0, 60.0, 140.0, 40.0, 100.0, 160.0, 49.0, 70.0, 80.0, 30.0, 80.0, 40.0, 90.0, 110.0, 580.0, -30.0, 80.0, 320.0, -10.0, 50.0, 110.0, 60.0, 70.0, 90.0, 30.0, 30.0, 60.0, 91.0, -13.0, 27.0, 50.0, 153.0, 70.0, 53.0, 120.0, 50.0, 39.0, 45.0, 50.0, 440.0, 120.0, 64.0, 60.0, 50.0, 123.0, 100.0, 100.0, 50.0, 209.0, 70.0, 70.0, 110.0, 50.0, 50.0, -23.0, 165.0, 70.0, 100.0, 180.0, 60.0, 56.0, 50.0, 160.0, 66.0, 170.0, -12.0, 50.0, 70.0, 70.0, 49.0, 38.0, 60.0, 40.0, 35.0, 30.0, 30.0, 76.0, 75.0, 110.0, 80.0, 60.0, 70.0, 35.0, 40.0, 47.0, 180.0, 88.0, 36.0, 69.0, 100.0, -38.0, 90.0, 80.0, 110.0, 70.0, 176.0, 0.0, 70.0, 50.0, 135.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9415864742143925, "mean_inference_ms": 2.198525549844309, "mean_action_processing_ms": 0.7493117450803553, "mean_env_wait_ms": 1.536782034011711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07496404647827148, "StateBufferConnector_ms": 0.009602546691894531, "ViewRequirementAgentConnector_ms": 0.4520144462585449}, "num_episodes": 18, "episode_return_max": 1310.0, "episode_return_min": 49.0, "episode_return_mean": 748.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.40340530084571, "num_env_steps_trained_throughput_per_sec": 32.40340530084571, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 4640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4640000, "timers": {"training_iteration_time_ms": 122843.918, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122843.87, "sample_time_ms": 3280.916, "learn_time_ms": 119541.855, "learn_throughput": 33.461, "synch_weights_time_ms": 11.479}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "done": false, "training_iteration": 116, "trial_id": "6085c_00000", "date": "2024-07-02_02-55-27", "timestamp": 1719903327, "time_this_iter_s": 123.45934891700745, "time_total_s": 16173.354019880295, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13800fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16173.354019880295, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 23.716571428571427, "ram_util_percent": 79.79428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9510170003794, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.27796014454672, "policy_loss": -0.007627579823122196, "vf_loss": 7.284717362579573, "vf_explained_var": 0.0006159870959699344, "kl": 0.008703599586137187, "entropy": 0.6029502660004349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1093935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "env_runners": {"episode_reward_max": 1561.0, "episode_reward_min": 49.0, "episode_reward_mean": 767.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -556.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 76.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [541.0, 467.0, 1083.0, 669.0, 897.0, 509.0, 714.0, 631.0, 956.0, 514.0, 625.0, 568.0, 686.0, 419.0, 1097.0, 424.0, 1164.0, 356.0, 655.0, 713.0, 690.0, 865.0, 761.0, 637.0, 702.0, 539.0, 1155.0, 817.0, 888.0, 874.0, 519.0, 660.0, 577.0, 907.0, 688.0, 951.0, 666.0, 690.0, 592.0, 631.0, 1250.0, 1068.0, 1078.0, 888.0, 797.0, 560.0, 730.0, 628.0, 545.0, 1275.0, 739.0, 903.0, 623.0, 666.0, 589.0, 49.0, 1040.0, 490.0, 660.0, 319.0, 1074.0, 866.0, 1007.0, 1045.0, 843.0, 747.0, 661.0, 392.0, 778.0, 1310.0, 555.0, 1070.0, 946.0, 832.0, 729.0, 574.0, 725.0, 743.0, 1063.0, 1102.0, 480.0, 810.0, 750.0, 748.0, 672.0, 1127.0, 1183.0, 1561.0, 660.0, 723.0, 715.0, 1223.0, 424.0, 618.0, 874.0, 746.0, 290.0, 774.0, 817.0, 1059.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [61.0, 100.0, 10.0, -1.0, 70.0, 60.0, 71.0, 20.0, 50.0, 100.0, 10.0, 30.0, 80.0, 48.0, 100.0, 50.0, -1.0, 80.0, 40.0, 30.0, 45.0, 15.0, 120.0, 118.0, 110.0, -45.0, 90.0, 480.0, 110.0, 40.0, 86.0, 70.0, 30.0, 55.0, 390.0, 80.0, 70.0, -180.0, -20.0, 88.0, 87.0, 70.0, 320.0, 70.0, 0.0, 0.0, 70.0, 270.0, -50.0, 60.0, 72.0, 50.0, 2.0, 180.0, 25.0, 20.0, 20.0, 50.0, 60.0, 30.0, 80.0, 49.0, 60.0, 80.0, -65.0, 10.0, 220.0, 150.0, 50.0, 80.0, 31.0, 30.0, 90.0, 60.0, 35.0, 139.0, 150.0, 50.0, 40.0, 6.0, 76.0, 60.0, 170.0, 80.0, 90.0, 70.0, 130.0, 90.0, 70.0, 120.0, 60.0, 59.0, 66.0, 65.0, 40.0, 110.0, 80.0, 20.0, -6.0, 20.0, 50.0, 40.0, 40.0, 79.0, 40.0, 25.0, 25.0, 186.0, 50.0, 90.0, 90.0, 90.0, 50.0, 20.0, 50.0, 50.0, 70.0, 28.0, 60.0, 60.0, 50.0, 69.0, 120.0, 60.0, 70.0, 70.0, 50.0, 77.0, 70.0, 50.0, 77.0, -1.0, 40.0, 20.0, 3.0, 120.0, 40.0, 10.0, 33.0, 77.0, 98.0, 30.0, 460.0, 120.0, 69.0, 150.0, 110.0, 10.0, -10.0, 60.0, 14.0, 19.0, 50.0, 26.0, 50.0, 140.0, 160.0, -80.0, 20.0, 25.0, 100.0, 380.0, 100.0, 99.0, 59.0, 90.0, 66.0, 70.0, 30.0, 170.0, 100.0, -16.0, 34.0, 60.0, 70.0, 40.0, 18.0, -11.0, 70.0, -9.0, 40.0, 70.0, 10.0, 30.0, -75.0, 0.0, 80.0, 60.0, 380.0, 60.0, -8.0, 48.0, 390.0, 120.0, 100.0, 28.0, -32.0, 45.0, -20.0, 42.0, -44.0, 40.0, 243.0, 44.0, 60.0, 200.0, 57.0, 10.0, 70.0, 10.0, 108.0, 300.0, 75.0, 60.0, 90.0, 50.0, 10.0, 92.0, 60.0, 20.0, 29.0, 76.0, 61.0, -19.0, 108.0, 68.0, 287.0, 50.0, 32.0, 69.0, 60.0, 70.0, 50.0, 100.0, 80.0, 59.0, 20.0, 58.0, 60.0, 80.0, 38.0, 44.0, -30.0, 60.0, 18.0, 340.0, 12.0, -17.0, 7.0, 230.0, 76.0, 10.0, 40.0, 60.0, 40.0, 68.0, 30.0, 30.0, 26.0, 159.0, 420.0, 130.0, 56.0, 70.0, 70.0, 120.0, 80.0, 109.0, 50.0, 50.0, 190.0, 42.0, 80.0, 150.0, 90.0, 50.0, -23.0, 120.0, 100.0, 18.0, 0.0, 327.0, 110.0, 30.0, 59.0, 40.0, 70.0, 57.0, 170.0, 25.0, -1.0, 100.0, 45.0, 130.0, 50.0, 70.0, 120.0, 260.0, 60.0, 40.0, 0.0, 70.0, 50.0, 90.0, 19.0, -50.0, 70.0, 50.0, 70.0, 150.0, 170.0, 70.0, 18.0, 20.0, 9.0, 28.0, 70.0, 50.0, 150.0, 75.0, 100.0, 80.0, 50.0, 90.0, 15.0, -5.0, 110.0, 50.0, 57.0, 30.0, 48.0, 50.0, 120.0, 9.0, 300.0, 20.0, 30.0, 70.0, 220.0, 40.0, 29.0, 120.0, 27.0, 50.0, 128.0, 70.0, 70.0, 40.0, 14.0, 140.0, -16.0, 40.0, 120.0, 110.0, 35.0, 200.0, 70.0, 82.0, 90.0, 220.0, 100.0, 130.0, 60.0, 40.0, 60.0, 68.0, 30.0, 30.0, 48.0, 100.0, 63.0, 160.0, 30.0, -10.0, 22.0, 80.0, 21.0, 150.0, 97.0, 77.0, 90.0, 34.0, 23.0, 59.0, 23.0, 45.0, 90.0, 140.0, 18.0, 70.0, 90.0, 90.0, 30.0, 65.0, 76.0, 50.0, 60.0, 70.0, 40.0, 60.0, 79.0, 72.0, 160.0, 130.0, 110.0, 308.0, 60.0, 190.0, 110.0, 31.0, 260.0, 110.0, 80.0, 175.0, 98.0, -5.0, 64.0, 160.0, 50.0, 76.0, 50.0, 350.0, 100.0, 50.0, 70.0, 130.0, 50.0, 150.0, 38.0, 90.0, 30.0, 190.0, 62.0, 90.0, 170.0, 70.0, 20.0, 60.0, 86.0, 110.0, 109.0, 50.0, 35.0, 24.0, 50.0, 150.0, 130.0, 40.0, 250.0, -41.0, 40.0, 60.0, 20.0, 70.0, 60.0, 70.0, 30.0, 70.0, 40.0, 100.0, 90.0, 70.0, 160.0, 50.0, 40.0, 60.0, 80.0, 60.0, 50.0, 70.0, 80.0, 40.0, 100.0, 29.0, 80.0, 40.0, 70.0, 50.0, 29.0, 110.0, -5.0, 30.0, 60.0, 40.0, 60.0, 80.0, 120.0, 90.0, 50.0, 20.0, 840.0, 76.0, -2.0, 110.0, 90.0, -44.0, 79.0, 12.0, 60.0, 54.0, 69.0, 40.0, 80.0, 100.0, 126.0, 100.0, 70.0, 59.0, 66.0, 29.0, 80.0, 189.0, 80.0, 316.0, 50.0, 45.0, 96.0, 100.0, 14.0, -67.0, 90.0, 185.0, 5.0, 30.0, 20.0, 90.0, 38.0, 60.0, 40.0, 65.0, 30.0, 43.0, 79.0, 70.0, 120.0, 94.0, 60.0, 40.0, 70.0, 60.0, 20.0, 69.0, 70.0, 30.0, 70.0, 70.0, 50.0, 60.0, 110.0, 40.0, 49.0, 140.0, 49.0, 70.0, 50.0, 25.0, -556.0, 112.0, 70.0, 40.0, -20.0, 50.0, 60.0, -50.0, 13.0, -10.0, 60.0, 200.0, 57.0, 680.0, 70.0, 10.0, 30.0, 20.0, 40.0, 60.0, 130.0, 10.0, 80.0, 40.0, 140.0, 80.0, 20.0, 50.0, 50.0, 60.0, 20.0, 100.0, 80.0, 60.0, 20.0, 60.0, 20.0, 19.0, 30.0, 80.0, 10.0, 30.0, 30.0, 20.0, 50.0, 60.0, 70.0, 460.0, 90.0, 58.0, 90.0, 108.0, 38.0, 50.0, 80.0, 293.0, 40.0, 18.0, 100.0, 35.0, 50.0, 60.0, 100.0, 90.0, 169.0, 100.0, 180.0, -30.0, 8.0, 90.0, -30.0, 140.0, 280.0, 100.0, 180.0, 80.0, 69.0, 120.0, 110.0, 110.0, 110.0, 86.0, 50.0, 130.0, 20.0, 48.0, 60.0, -40.0, 50.0, 460.0, 26.0, 22.0, 27.0, 170.0, 340.0, 18.0, -40.0, 50.0, 50.0, 47.0, 210.0, 58.0, 79.0, -65.0, 60.0, -50.0, 196.0, 30.0, 80.0, 160.0, 79.0, 50.0, -3.0, 59.0, 40.0, 180.0, 40.0, 20.0, -1.0, 70.0, 20.0, -20.0, 30.0, 13.0, 49.0, 60.0, 140.0, 40.0, 100.0, 160.0, 49.0, 70.0, 80.0, 30.0, 80.0, 40.0, 90.0, 110.0, 580.0, -30.0, 80.0, 320.0, -10.0, 50.0, 110.0, 60.0, 70.0, 90.0, 30.0, 30.0, 60.0, 91.0, -13.0, 27.0, 50.0, 153.0, 70.0, 53.0, 120.0, 50.0, 39.0, 45.0, 50.0, 440.0, 120.0, 64.0, 60.0, 50.0, 123.0, 100.0, 100.0, 50.0, 209.0, 70.0, 70.0, 110.0, 50.0, 50.0, -23.0, 165.0, 70.0, 100.0, 180.0, 60.0, 56.0, 50.0, 160.0, 66.0, 170.0, -12.0, 50.0, 70.0, 70.0, 49.0, 38.0, 60.0, 40.0, 35.0, 30.0, 30.0, 76.0, 75.0, 110.0, 80.0, 60.0, 70.0, 35.0, 40.0, 47.0, 180.0, 88.0, 36.0, 69.0, 100.0, -38.0, 90.0, 80.0, 110.0, 70.0, 176.0, 0.0, 70.0, 50.0, 135.0, 260.0, 70.0, 90.0, 100.0, 5.0, 30.0, 180.0, 160.0, 28.0, 140.0, 60.0, 70.0, 40.0, 80.0, 241.0, 190.0, 110.0, 110.0, 110.0, 91.0, 70.0, 130.0, 70.0, 50.0, 60.0, 40.0, -20.0, 0.0, 60.0, 20.0, 208.0, 80.0, 110.0, 68.0, 90.0, 54.0, 10.0, 50.0, 50.0, 90.0, 90.0, 40.0, 40.0, 50.0, 23.0, 120.0, 200.0, 44.0, 70.0, 73.0, 80.0, 29.0, 60.0, 60.0, 80.0, 38.0, 210.0, 120.0, 11.0, 60.0, 90.0, 22.0, 69.0, 80.0, 60.0, 50.0, 58.0, 70.0, 110.0, 63.0, -16.0, 74.0, 100.0, 170.0, 160.0, 16.0, 100.0, 531.0, -28.0, 20.0, 210.0, 560.0, 120.0, -2.0, 40.0, 13.0, 10.0, 149.0, -15.0, 98.0, 70.0, 1000.0, 0.0, 50.0, 145.0, 60.0, 74.0, 28.0, 38.0, 96.0, 40.0, 300.0, 4.0, 11.0, 41.0, -20.0, 130.0, 100.0, 29.0, 25.0, 130.0, 80.0, 40.0, 110.0, 129.0, 90.0, 20.0, 64.0, 20.0, 40.0, 100.0, 80.0, 100.0, 110.0, 50.0, 56.0, 50.0, 70.0, 29.0, 70.0, 47.0, 35.0, 243.0, 85.0, 140.0, 48.0, 210.0, 80.0, 285.0, 50.0, 70.0, 40.0, 40.0, 50.0, 19.0, 60.0, 30.0, 90.0, 30.0, -5.0, 120.0, 50.0, 80.0, 90.0, 20.0, 60.0, 62.0, 10.0, 56.0, 70.0, 100.0, 80.0, 22.0, 110.0, 40.0, 278.0, 48.0, 99.0, 50.0, 47.0, 120.0, 100.0, 65.0, 60.0, 60.0, 93.0, 80.0, 40.0, 68.0, 60.0, 100.0, 36.0, 18.0, 27.0, 29.0, 8.0, 27.0, 20.0, 40.0, -15.0, 63.0, -30.0, 50.0, 49.0, 40.0, 48.0, 67.0, 390.0, 34.0, 63.0, 80.0, 19.0, 38.0, 70.0, 110.0, 110.0, 100.0, 110.0, 80.0, 100.0, 40.0, 190.0, 50.0, 59.0, 310.0, 100.0, 40.0, 90.0, 110.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9407205935106209, "mean_inference_ms": 2.1968160778638888, "mean_action_processing_ms": 0.7469892465013401, "mean_env_wait_ms": 1.5352939514872437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0662844181060791, "StateBufferConnector_ms": 0.009569644927978516, "ViewRequirementAgentConnector_ms": 0.4434688091278076}, "num_episodes": 22, "episode_return_max": 1561.0, "episode_return_min": 49.0, "episode_return_mean": 767.1, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.24045032985772, "num_env_steps_trained_throughput_per_sec": 32.24045032985772, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 4680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4680000, "timers": {"training_iteration_time_ms": 123004.243, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123004.195, "sample_time_ms": 3259.496, "learn_time_ms": 119723.511, "learn_throughput": 33.41, "synch_weights_time_ms": 11.72}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "done": false, "training_iteration": 117, "trial_id": "6085c_00000", "date": "2024-07-02_02-57-31", "timestamp": 1719903451, "time_this_iter_s": 124.08130526542664, "time_total_s": 16297.435325145721, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c934c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16297.435325145721, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 20.698285714285717, "ram_util_percent": 79.85828571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.141585979630518, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4084824214728116, "policy_loss": -0.007689375634363697, "vf_loss": 7.415128174782815, "vf_explained_var": 0.0015864192296902592, "kl": 0.010436152699376701, "entropy": 0.5852158569648497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1103325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "env_runners": {"episode_reward_max": 1561.0, "episode_reward_min": 49.0, "episode_reward_mean": 797.54, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -556.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 79.754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [655.0, 713.0, 690.0, 865.0, 761.0, 637.0, 702.0, 539.0, 1155.0, 817.0, 888.0, 874.0, 519.0, 660.0, 577.0, 907.0, 688.0, 951.0, 666.0, 690.0, 592.0, 631.0, 1250.0, 1068.0, 1078.0, 888.0, 797.0, 560.0, 730.0, 628.0, 545.0, 1275.0, 739.0, 903.0, 623.0, 666.0, 589.0, 49.0, 1040.0, 490.0, 660.0, 319.0, 1074.0, 866.0, 1007.0, 1045.0, 843.0, 747.0, 661.0, 392.0, 778.0, 1310.0, 555.0, 1070.0, 946.0, 832.0, 729.0, 574.0, 725.0, 743.0, 1063.0, 1102.0, 480.0, 810.0, 750.0, 748.0, 672.0, 1127.0, 1183.0, 1561.0, 660.0, 723.0, 715.0, 1223.0, 424.0, 618.0, 874.0, 746.0, 290.0, 774.0, 817.0, 1059.0, 702.0, 768.0, 705.0, 584.0, 836.0, 838.0, 1388.0, 492.0, 523.0, 635.0, 642.0, 1265.0, 1477.0, 623.0, 950.0, 913.0, 864.0, 1159.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 70.0, 10.0, 30.0, -75.0, 0.0, 80.0, 60.0, 380.0, 60.0, -8.0, 48.0, 390.0, 120.0, 100.0, 28.0, -32.0, 45.0, -20.0, 42.0, -44.0, 40.0, 243.0, 44.0, 60.0, 200.0, 57.0, 10.0, 70.0, 10.0, 108.0, 300.0, 75.0, 60.0, 90.0, 50.0, 10.0, 92.0, 60.0, 20.0, 29.0, 76.0, 61.0, -19.0, 108.0, 68.0, 287.0, 50.0, 32.0, 69.0, 60.0, 70.0, 50.0, 100.0, 80.0, 59.0, 20.0, 58.0, 60.0, 80.0, 38.0, 44.0, -30.0, 60.0, 18.0, 340.0, 12.0, -17.0, 7.0, 230.0, 76.0, 10.0, 40.0, 60.0, 40.0, 68.0, 30.0, 30.0, 26.0, 159.0, 420.0, 130.0, 56.0, 70.0, 70.0, 120.0, 80.0, 109.0, 50.0, 50.0, 190.0, 42.0, 80.0, 150.0, 90.0, 50.0, -23.0, 120.0, 100.0, 18.0, 0.0, 327.0, 110.0, 30.0, 59.0, 40.0, 70.0, 57.0, 170.0, 25.0, -1.0, 100.0, 45.0, 130.0, 50.0, 70.0, 120.0, 260.0, 60.0, 40.0, 0.0, 70.0, 50.0, 90.0, 19.0, -50.0, 70.0, 50.0, 70.0, 150.0, 170.0, 70.0, 18.0, 20.0, 9.0, 28.0, 70.0, 50.0, 150.0, 75.0, 100.0, 80.0, 50.0, 90.0, 15.0, -5.0, 110.0, 50.0, 57.0, 30.0, 48.0, 50.0, 120.0, 9.0, 300.0, 20.0, 30.0, 70.0, 220.0, 40.0, 29.0, 120.0, 27.0, 50.0, 128.0, 70.0, 70.0, 40.0, 14.0, 140.0, -16.0, 40.0, 120.0, 110.0, 35.0, 200.0, 70.0, 82.0, 90.0, 220.0, 100.0, 130.0, 60.0, 40.0, 60.0, 68.0, 30.0, 30.0, 48.0, 100.0, 63.0, 160.0, 30.0, -10.0, 22.0, 80.0, 21.0, 150.0, 97.0, 77.0, 90.0, 34.0, 23.0, 59.0, 23.0, 45.0, 90.0, 140.0, 18.0, 70.0, 90.0, 90.0, 30.0, 65.0, 76.0, 50.0, 60.0, 70.0, 40.0, 60.0, 79.0, 72.0, 160.0, 130.0, 110.0, 308.0, 60.0, 190.0, 110.0, 31.0, 260.0, 110.0, 80.0, 175.0, 98.0, -5.0, 64.0, 160.0, 50.0, 76.0, 50.0, 350.0, 100.0, 50.0, 70.0, 130.0, 50.0, 150.0, 38.0, 90.0, 30.0, 190.0, 62.0, 90.0, 170.0, 70.0, 20.0, 60.0, 86.0, 110.0, 109.0, 50.0, 35.0, 24.0, 50.0, 150.0, 130.0, 40.0, 250.0, -41.0, 40.0, 60.0, 20.0, 70.0, 60.0, 70.0, 30.0, 70.0, 40.0, 100.0, 90.0, 70.0, 160.0, 50.0, 40.0, 60.0, 80.0, 60.0, 50.0, 70.0, 80.0, 40.0, 100.0, 29.0, 80.0, 40.0, 70.0, 50.0, 29.0, 110.0, -5.0, 30.0, 60.0, 40.0, 60.0, 80.0, 120.0, 90.0, 50.0, 20.0, 840.0, 76.0, -2.0, 110.0, 90.0, -44.0, 79.0, 12.0, 60.0, 54.0, 69.0, 40.0, 80.0, 100.0, 126.0, 100.0, 70.0, 59.0, 66.0, 29.0, 80.0, 189.0, 80.0, 316.0, 50.0, 45.0, 96.0, 100.0, 14.0, -67.0, 90.0, 185.0, 5.0, 30.0, 20.0, 90.0, 38.0, 60.0, 40.0, 65.0, 30.0, 43.0, 79.0, 70.0, 120.0, 94.0, 60.0, 40.0, 70.0, 60.0, 20.0, 69.0, 70.0, 30.0, 70.0, 70.0, 50.0, 60.0, 110.0, 40.0, 49.0, 140.0, 49.0, 70.0, 50.0, 25.0, -556.0, 112.0, 70.0, 40.0, -20.0, 50.0, 60.0, -50.0, 13.0, -10.0, 60.0, 200.0, 57.0, 680.0, 70.0, 10.0, 30.0, 20.0, 40.0, 60.0, 130.0, 10.0, 80.0, 40.0, 140.0, 80.0, 20.0, 50.0, 50.0, 60.0, 20.0, 100.0, 80.0, 60.0, 20.0, 60.0, 20.0, 19.0, 30.0, 80.0, 10.0, 30.0, 30.0, 20.0, 50.0, 60.0, 70.0, 460.0, 90.0, 58.0, 90.0, 108.0, 38.0, 50.0, 80.0, 293.0, 40.0, 18.0, 100.0, 35.0, 50.0, 60.0, 100.0, 90.0, 169.0, 100.0, 180.0, -30.0, 8.0, 90.0, -30.0, 140.0, 280.0, 100.0, 180.0, 80.0, 69.0, 120.0, 110.0, 110.0, 110.0, 86.0, 50.0, 130.0, 20.0, 48.0, 60.0, -40.0, 50.0, 460.0, 26.0, 22.0, 27.0, 170.0, 340.0, 18.0, -40.0, 50.0, 50.0, 47.0, 210.0, 58.0, 79.0, -65.0, 60.0, -50.0, 196.0, 30.0, 80.0, 160.0, 79.0, 50.0, -3.0, 59.0, 40.0, 180.0, 40.0, 20.0, -1.0, 70.0, 20.0, -20.0, 30.0, 13.0, 49.0, 60.0, 140.0, 40.0, 100.0, 160.0, 49.0, 70.0, 80.0, 30.0, 80.0, 40.0, 90.0, 110.0, 580.0, -30.0, 80.0, 320.0, -10.0, 50.0, 110.0, 60.0, 70.0, 90.0, 30.0, 30.0, 60.0, 91.0, -13.0, 27.0, 50.0, 153.0, 70.0, 53.0, 120.0, 50.0, 39.0, 45.0, 50.0, 440.0, 120.0, 64.0, 60.0, 50.0, 123.0, 100.0, 100.0, 50.0, 209.0, 70.0, 70.0, 110.0, 50.0, 50.0, -23.0, 165.0, 70.0, 100.0, 180.0, 60.0, 56.0, 50.0, 160.0, 66.0, 170.0, -12.0, 50.0, 70.0, 70.0, 49.0, 38.0, 60.0, 40.0, 35.0, 30.0, 30.0, 76.0, 75.0, 110.0, 80.0, 60.0, 70.0, 35.0, 40.0, 47.0, 180.0, 88.0, 36.0, 69.0, 100.0, -38.0, 90.0, 80.0, 110.0, 70.0, 176.0, 0.0, 70.0, 50.0, 135.0, 260.0, 70.0, 90.0, 100.0, 5.0, 30.0, 180.0, 160.0, 28.0, 140.0, 60.0, 70.0, 40.0, 80.0, 241.0, 190.0, 110.0, 110.0, 110.0, 91.0, 70.0, 130.0, 70.0, 50.0, 60.0, 40.0, -20.0, 0.0, 60.0, 20.0, 208.0, 80.0, 110.0, 68.0, 90.0, 54.0, 10.0, 50.0, 50.0, 90.0, 90.0, 40.0, 40.0, 50.0, 23.0, 120.0, 200.0, 44.0, 70.0, 73.0, 80.0, 29.0, 60.0, 60.0, 80.0, 38.0, 210.0, 120.0, 11.0, 60.0, 90.0, 22.0, 69.0, 80.0, 60.0, 50.0, 58.0, 70.0, 110.0, 63.0, -16.0, 74.0, 100.0, 170.0, 160.0, 16.0, 100.0, 531.0, -28.0, 20.0, 210.0, 560.0, 120.0, -2.0, 40.0, 13.0, 10.0, 149.0, -15.0, 98.0, 70.0, 1000.0, 0.0, 50.0, 145.0, 60.0, 74.0, 28.0, 38.0, 96.0, 40.0, 300.0, 4.0, 11.0, 41.0, -20.0, 130.0, 100.0, 29.0, 25.0, 130.0, 80.0, 40.0, 110.0, 129.0, 90.0, 20.0, 64.0, 20.0, 40.0, 100.0, 80.0, 100.0, 110.0, 50.0, 56.0, 50.0, 70.0, 29.0, 70.0, 47.0, 35.0, 243.0, 85.0, 140.0, 48.0, 210.0, 80.0, 285.0, 50.0, 70.0, 40.0, 40.0, 50.0, 19.0, 60.0, 30.0, 90.0, 30.0, -5.0, 120.0, 50.0, 80.0, 90.0, 20.0, 60.0, 62.0, 10.0, 56.0, 70.0, 100.0, 80.0, 22.0, 110.0, 40.0, 278.0, 48.0, 99.0, 50.0, 47.0, 120.0, 100.0, 65.0, 60.0, 60.0, 93.0, 80.0, 40.0, 68.0, 60.0, 100.0, 36.0, 18.0, 27.0, 29.0, 8.0, 27.0, 20.0, 40.0, -15.0, 63.0, -30.0, 50.0, 49.0, 40.0, 48.0, 67.0, 390.0, 34.0, 63.0, 80.0, 19.0, 38.0, 70.0, 110.0, 110.0, 100.0, 110.0, 80.0, 100.0, 40.0, 190.0, 50.0, 59.0, 310.0, 100.0, 40.0, 90.0, 110.0, 70.0, 9.0, 65.0, 18.0, 25.0, 80.0, 90.0, 60.0, 80.0, 205.0, 70.0, 10.0, 37.0, 100.0, 150.0, 43.0, 8.0, 204.0, 80.0, 79.0, 57.0, 50.0, 80.0, 80.0, 61.0, 100.0, 50.0, 80.0, 80.0, 64.0, 60.0, 19.0, 51.0, 138.0, 69.0, 52.0, 40.0, 74.0, 6.0, 58.0, 77.0, 30.0, 70.0, -75.0, 297.0, 70.0, 75.0, 140.0, 50.0, 110.0, 69.0, -11.0, 339.0, -33.0, 38.0, 50.0, 80.0, 150.0, 15.0, 140.0, 70.0, 49.0, 60.0, 20.0, 50.0, 160.0, 709.0, 100.0, 80.0, 100.0, 60.0, 21.0, 160.0, -2.0, 29.0, -2.0, 37.0, 60.0, 100.0, 80.0, 9.0, 29.0, 50.0, 46.0, 130.0, 20.0, 90.0, 18.0, 70.0, 60.0, 10.0, 8.0, 49.0, 110.0, 87.0, 28.0, 60.0, 220.0, 41.0, 38.0, -6.0, 110.0, 40.0, 9.0, 32.0, 60.0, 180.0, 60.0, 77.0, 21.0, 53.0, 65.0, 100.0, 13.0, 100.0, 77.0, 50.0, 170.0, 565.0, 55.0, 70.0, 160.0, 30.0, 60.0, 120.0, 40.0, 283.0, 85.0, 21.0, 640.0, 38.0, 161.0, 60.0, 30.0, 7.0, 27.0, 160.0, 170.0, -81.0, 64.0, 25.0, 120.0, 90.0, 100.0, 50.0, 100.0, 30.0, 230.0, 60.0, 120.0, 50.0, 4.0, 27.0, 180.0, 25.0, 67.0, 34.0, 50.0, 85.0, 410.0, 31.0, 120.0, 56.0, 84.0, 30.0, 150.0, 110.0, 86.0, 78.0, 70.0, 80.0, 96.0, -13.0, 550.0, 170.0, 40.0, 160.0, 9.0, 17.0, 10.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9365651947607203, "mean_inference_ms": 2.191957947688654, "mean_action_processing_ms": 0.7471559708414284, "mean_env_wait_ms": 1.5324055491656663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06314325332641602, "StateBufferConnector_ms": 0.009340524673461914, "ViewRequirementAgentConnector_ms": 0.43971729278564453}, "num_episodes": 18, "episode_return_max": 1561.0, "episode_return_min": 49.0, "episode_return_mean": 797.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.35571906720695, "num_env_steps_trained_throughput_per_sec": 32.35571906720695, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 4720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4720000, "timers": {"training_iteration_time_ms": 123115.805, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123115.757, "sample_time_ms": 3201.195, "learn_time_ms": 119894.136, "learn_throughput": 33.363, "synch_weights_time_ms": 11.742}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "done": false, "training_iteration": 118, "trial_id": "6085c_00000", "date": "2024-07-02_02-59-35", "timestamp": 1719903575, "time_this_iter_s": 123.63900995254517, "time_total_s": 16421.074335098267, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138aa78b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16421.074335098267, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 21.210285714285714, "ram_util_percent": 79.28342857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9918563682685138, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.424605794404896, "policy_loss": -0.007159151268936495, "vf_loss": 7.430945133375792, "vf_explained_var": 0.0022553775638056257, "kl": 0.008198075064962264, "entropy": 0.5624319846828144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1112715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "env_runners": {"episode_reward_max": 1734.0, "episode_reward_min": 49.0, "episode_reward_mean": 824.11, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -556.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 82.411}, "custom_metrics": {}, "hist_stats": {"episode_reward": [666.0, 690.0, 592.0, 631.0, 1250.0, 1068.0, 1078.0, 888.0, 797.0, 560.0, 730.0, 628.0, 545.0, 1275.0, 739.0, 903.0, 623.0, 666.0, 589.0, 49.0, 1040.0, 490.0, 660.0, 319.0, 1074.0, 866.0, 1007.0, 1045.0, 843.0, 747.0, 661.0, 392.0, 778.0, 1310.0, 555.0, 1070.0, 946.0, 832.0, 729.0, 574.0, 725.0, 743.0, 1063.0, 1102.0, 480.0, 810.0, 750.0, 748.0, 672.0, 1127.0, 1183.0, 1561.0, 660.0, 723.0, 715.0, 1223.0, 424.0, 618.0, 874.0, 746.0, 290.0, 774.0, 817.0, 1059.0, 702.0, 768.0, 705.0, 584.0, 836.0, 838.0, 1388.0, 492.0, 523.0, 635.0, 642.0, 1265.0, 1477.0, 623.0, 950.0, 913.0, 864.0, 1159.0, 578.0, 782.0, 1132.0, 846.0, 1734.0, 1223.0, 816.0, 830.0, 588.0, 635.0, 972.0, 1088.0, 995.0, 884.0, 591.0, 653.0, 1204.0, 704.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 130.0, 60.0, 40.0, 60.0, 68.0, 30.0, 30.0, 48.0, 100.0, 63.0, 160.0, 30.0, -10.0, 22.0, 80.0, 21.0, 150.0, 97.0, 77.0, 90.0, 34.0, 23.0, 59.0, 23.0, 45.0, 90.0, 140.0, 18.0, 70.0, 90.0, 90.0, 30.0, 65.0, 76.0, 50.0, 60.0, 70.0, 40.0, 60.0, 79.0, 72.0, 160.0, 130.0, 110.0, 308.0, 60.0, 190.0, 110.0, 31.0, 260.0, 110.0, 80.0, 175.0, 98.0, -5.0, 64.0, 160.0, 50.0, 76.0, 50.0, 350.0, 100.0, 50.0, 70.0, 130.0, 50.0, 150.0, 38.0, 90.0, 30.0, 190.0, 62.0, 90.0, 170.0, 70.0, 20.0, 60.0, 86.0, 110.0, 109.0, 50.0, 35.0, 24.0, 50.0, 150.0, 130.0, 40.0, 250.0, -41.0, 40.0, 60.0, 20.0, 70.0, 60.0, 70.0, 30.0, 70.0, 40.0, 100.0, 90.0, 70.0, 160.0, 50.0, 40.0, 60.0, 80.0, 60.0, 50.0, 70.0, 80.0, 40.0, 100.0, 29.0, 80.0, 40.0, 70.0, 50.0, 29.0, 110.0, -5.0, 30.0, 60.0, 40.0, 60.0, 80.0, 120.0, 90.0, 50.0, 20.0, 840.0, 76.0, -2.0, 110.0, 90.0, -44.0, 79.0, 12.0, 60.0, 54.0, 69.0, 40.0, 80.0, 100.0, 126.0, 100.0, 70.0, 59.0, 66.0, 29.0, 80.0, 189.0, 80.0, 316.0, 50.0, 45.0, 96.0, 100.0, 14.0, -67.0, 90.0, 185.0, 5.0, 30.0, 20.0, 90.0, 38.0, 60.0, 40.0, 65.0, 30.0, 43.0, 79.0, 70.0, 120.0, 94.0, 60.0, 40.0, 70.0, 60.0, 20.0, 69.0, 70.0, 30.0, 70.0, 70.0, 50.0, 60.0, 110.0, 40.0, 49.0, 140.0, 49.0, 70.0, 50.0, 25.0, -556.0, 112.0, 70.0, 40.0, -20.0, 50.0, 60.0, -50.0, 13.0, -10.0, 60.0, 200.0, 57.0, 680.0, 70.0, 10.0, 30.0, 20.0, 40.0, 60.0, 130.0, 10.0, 80.0, 40.0, 140.0, 80.0, 20.0, 50.0, 50.0, 60.0, 20.0, 100.0, 80.0, 60.0, 20.0, 60.0, 20.0, 19.0, 30.0, 80.0, 10.0, 30.0, 30.0, 20.0, 50.0, 60.0, 70.0, 460.0, 90.0, 58.0, 90.0, 108.0, 38.0, 50.0, 80.0, 293.0, 40.0, 18.0, 100.0, 35.0, 50.0, 60.0, 100.0, 90.0, 169.0, 100.0, 180.0, -30.0, 8.0, 90.0, -30.0, 140.0, 280.0, 100.0, 180.0, 80.0, 69.0, 120.0, 110.0, 110.0, 110.0, 86.0, 50.0, 130.0, 20.0, 48.0, 60.0, -40.0, 50.0, 460.0, 26.0, 22.0, 27.0, 170.0, 340.0, 18.0, -40.0, 50.0, 50.0, 47.0, 210.0, 58.0, 79.0, -65.0, 60.0, -50.0, 196.0, 30.0, 80.0, 160.0, 79.0, 50.0, -3.0, 59.0, 40.0, 180.0, 40.0, 20.0, -1.0, 70.0, 20.0, -20.0, 30.0, 13.0, 49.0, 60.0, 140.0, 40.0, 100.0, 160.0, 49.0, 70.0, 80.0, 30.0, 80.0, 40.0, 90.0, 110.0, 580.0, -30.0, 80.0, 320.0, -10.0, 50.0, 110.0, 60.0, 70.0, 90.0, 30.0, 30.0, 60.0, 91.0, -13.0, 27.0, 50.0, 153.0, 70.0, 53.0, 120.0, 50.0, 39.0, 45.0, 50.0, 440.0, 120.0, 64.0, 60.0, 50.0, 123.0, 100.0, 100.0, 50.0, 209.0, 70.0, 70.0, 110.0, 50.0, 50.0, -23.0, 165.0, 70.0, 100.0, 180.0, 60.0, 56.0, 50.0, 160.0, 66.0, 170.0, -12.0, 50.0, 70.0, 70.0, 49.0, 38.0, 60.0, 40.0, 35.0, 30.0, 30.0, 76.0, 75.0, 110.0, 80.0, 60.0, 70.0, 35.0, 40.0, 47.0, 180.0, 88.0, 36.0, 69.0, 100.0, -38.0, 90.0, 80.0, 110.0, 70.0, 176.0, 0.0, 70.0, 50.0, 135.0, 260.0, 70.0, 90.0, 100.0, 5.0, 30.0, 180.0, 160.0, 28.0, 140.0, 60.0, 70.0, 40.0, 80.0, 241.0, 190.0, 110.0, 110.0, 110.0, 91.0, 70.0, 130.0, 70.0, 50.0, 60.0, 40.0, -20.0, 0.0, 60.0, 20.0, 208.0, 80.0, 110.0, 68.0, 90.0, 54.0, 10.0, 50.0, 50.0, 90.0, 90.0, 40.0, 40.0, 50.0, 23.0, 120.0, 200.0, 44.0, 70.0, 73.0, 80.0, 29.0, 60.0, 60.0, 80.0, 38.0, 210.0, 120.0, 11.0, 60.0, 90.0, 22.0, 69.0, 80.0, 60.0, 50.0, 58.0, 70.0, 110.0, 63.0, -16.0, 74.0, 100.0, 170.0, 160.0, 16.0, 100.0, 531.0, -28.0, 20.0, 210.0, 560.0, 120.0, -2.0, 40.0, 13.0, 10.0, 149.0, -15.0, 98.0, 70.0, 1000.0, 0.0, 50.0, 145.0, 60.0, 74.0, 28.0, 38.0, 96.0, 40.0, 300.0, 4.0, 11.0, 41.0, -20.0, 130.0, 100.0, 29.0, 25.0, 130.0, 80.0, 40.0, 110.0, 129.0, 90.0, 20.0, 64.0, 20.0, 40.0, 100.0, 80.0, 100.0, 110.0, 50.0, 56.0, 50.0, 70.0, 29.0, 70.0, 47.0, 35.0, 243.0, 85.0, 140.0, 48.0, 210.0, 80.0, 285.0, 50.0, 70.0, 40.0, 40.0, 50.0, 19.0, 60.0, 30.0, 90.0, 30.0, -5.0, 120.0, 50.0, 80.0, 90.0, 20.0, 60.0, 62.0, 10.0, 56.0, 70.0, 100.0, 80.0, 22.0, 110.0, 40.0, 278.0, 48.0, 99.0, 50.0, 47.0, 120.0, 100.0, 65.0, 60.0, 60.0, 93.0, 80.0, 40.0, 68.0, 60.0, 100.0, 36.0, 18.0, 27.0, 29.0, 8.0, 27.0, 20.0, 40.0, -15.0, 63.0, -30.0, 50.0, 49.0, 40.0, 48.0, 67.0, 390.0, 34.0, 63.0, 80.0, 19.0, 38.0, 70.0, 110.0, 110.0, 100.0, 110.0, 80.0, 100.0, 40.0, 190.0, 50.0, 59.0, 310.0, 100.0, 40.0, 90.0, 110.0, 70.0, 9.0, 65.0, 18.0, 25.0, 80.0, 90.0, 60.0, 80.0, 205.0, 70.0, 10.0, 37.0, 100.0, 150.0, 43.0, 8.0, 204.0, 80.0, 79.0, 57.0, 50.0, 80.0, 80.0, 61.0, 100.0, 50.0, 80.0, 80.0, 64.0, 60.0, 19.0, 51.0, 138.0, 69.0, 52.0, 40.0, 74.0, 6.0, 58.0, 77.0, 30.0, 70.0, -75.0, 297.0, 70.0, 75.0, 140.0, 50.0, 110.0, 69.0, -11.0, 339.0, -33.0, 38.0, 50.0, 80.0, 150.0, 15.0, 140.0, 70.0, 49.0, 60.0, 20.0, 50.0, 160.0, 709.0, 100.0, 80.0, 100.0, 60.0, 21.0, 160.0, -2.0, 29.0, -2.0, 37.0, 60.0, 100.0, 80.0, 9.0, 29.0, 50.0, 46.0, 130.0, 20.0, 90.0, 18.0, 70.0, 60.0, 10.0, 8.0, 49.0, 110.0, 87.0, 28.0, 60.0, 220.0, 41.0, 38.0, -6.0, 110.0, 40.0, 9.0, 32.0, 60.0, 180.0, 60.0, 77.0, 21.0, 53.0, 65.0, 100.0, 13.0, 100.0, 77.0, 50.0, 170.0, 565.0, 55.0, 70.0, 160.0, 30.0, 60.0, 120.0, 40.0, 283.0, 85.0, 21.0, 640.0, 38.0, 161.0, 60.0, 30.0, 7.0, 27.0, 160.0, 170.0, -81.0, 64.0, 25.0, 120.0, 90.0, 100.0, 50.0, 100.0, 30.0, 230.0, 60.0, 120.0, 50.0, 4.0, 27.0, 180.0, 25.0, 67.0, 34.0, 50.0, 85.0, 410.0, 31.0, 120.0, 56.0, 84.0, 30.0, 150.0, 110.0, 86.0, 78.0, 70.0, 80.0, 96.0, -13.0, 550.0, 170.0, 40.0, 160.0, 9.0, 17.0, 10.0, 120.0, 40.0, -10.0, 59.0, 50.0, 60.0, 50.0, 20.0, 99.0, 70.0, 140.0, 75.0, 60.0, 69.0, 59.0, 82.0, 80.0, 70.0, 110.0, 86.0, 91.0, 310.0, 100.0, 80.0, 180.0, 80.0, 140.0, 50.0, 12.0, 80.0, 100.0, 40.0, 63.0, 50.0, 10.0, 80.0, 60.0, 93.0, 90.0, 180.0, 180.0, 595.0, 120.0, 14.0, 120.0, 40.0, 110.0, 420.0, 140.0, 70.0, 105.0, 180.0, 322.0, 290.0, 26.0, 180.0, 110.0, 40.0, 50.0, 80.0, -55.0, 190.0, 80.0, 41.0, 44.0, 70.0, 101.0, 50.0, 110.0, 80.0, 50.0, 85.0, 20.0, 84.0, 7.0, 159.0, 230.0, 70.0, -15.0, 130.0, 60.0, 70.0, 60.0, 100.0, 40.0, 30.0, 38.0, 20.0, 30.0, 150.0, 50.0, 50.0, 60.0, 60.0, 100.0, 90.0, 30.0, 20.0, 160.0, 5.0, 60.0, 70.0, -83.0, 70.0, 20.0, 180.0, 370.0, 100.0, 100.0, 48.0, 97.0, 90.0, 62.0, 90.0, 90.0, 73.0, 24.0, 99.0, 320.0, 180.0, 60.0, 70.0, 90.0, 180.0, 90.0, 295.0, 170.0, 0.0, 100.0, -60.0, 60.0, 140.0, 72.0, 69.0, 90.0, 210.0, 63.0, 50.0, 61.0, 70.0, 59.0, 39.0, 60.0, 80.0, 50.0, 60.0, 35.0, 110.0, 20.0, 97.0, 40.0, 10.0, 146.0, 25.0, 35.0, 90.0, 50.0, 380.0, 17.0, -74.0, -26.0, 89.0, 100.0, 30.0, 100.0, 60.0, 190.0, 520.0, 150.0, -15.0, -20.0, 66.0, 77.0, 150.0, 44.0, 31.0, 113.0, 60.0, 53.0, 80.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9348261588626974, "mean_inference_ms": 2.189939619921052, "mean_action_processing_ms": 0.7463512027391781, "mean_env_wait_ms": 1.5310113899461628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06456851959228516, "StateBufferConnector_ms": 0.009462356567382812, "ViewRequirementAgentConnector_ms": 0.44437170028686523}, "num_episodes": 18, "episode_return_max": 1734.0, "episode_return_min": 49.0, "episode_return_mean": 824.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.44316716102395, "num_env_steps_trained_throughput_per_sec": 32.44316716102395, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 4760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4760000, "timers": {"training_iteration_time_ms": 123151.308, "restore_workers_time_ms": 0.012, "training_step_time_ms": 123151.262, "sample_time_ms": 3278.148, "learn_time_ms": 119852.653, "learn_throughput": 33.374, "synch_weights_time_ms": 11.857}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "done": false, "training_iteration": 119, "trial_id": "6085c_00000", "date": "2024-07-02_03-01-38", "timestamp": 1719903698, "time_this_iter_s": 123.31973791122437, "time_total_s": 16544.39407300949, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9128940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16544.39407300949, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 20.996571428571432, "ram_util_percent": 78.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.096251330684168, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.443176796134161, "policy_loss": -0.006980341776195791, "vf_loss": 7.449325564875009, "vf_explained_var": 0.0024667293309403684, "kl": 0.00831570807673642, "entropy": 0.5840506307677593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1122105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "env_runners": {"episode_reward_max": 1734.0, "episode_reward_min": 290.0, "episode_reward_mean": 825.78, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -121.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 82.578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.0, 1074.0, 866.0, 1007.0, 1045.0, 843.0, 747.0, 661.0, 392.0, 778.0, 1310.0, 555.0, 1070.0, 946.0, 832.0, 729.0, 574.0, 725.0, 743.0, 1063.0, 1102.0, 480.0, 810.0, 750.0, 748.0, 672.0, 1127.0, 1183.0, 1561.0, 660.0, 723.0, 715.0, 1223.0, 424.0, 618.0, 874.0, 746.0, 290.0, 774.0, 817.0, 1059.0, 702.0, 768.0, 705.0, 584.0, 836.0, 838.0, 1388.0, 492.0, 523.0, 635.0, 642.0, 1265.0, 1477.0, 623.0, 950.0, 913.0, 864.0, 1159.0, 578.0, 782.0, 1132.0, 846.0, 1734.0, 1223.0, 816.0, 830.0, 588.0, 635.0, 972.0, 1088.0, 995.0, 884.0, 591.0, 653.0, 1204.0, 704.0, 1031.0, 622.0, 449.0, 570.0, 452.0, 1016.0, 935.0, 894.0, 474.0, 598.0, 845.0, 905.0, 837.0, 800.0, 896.0, 764.0, 977.0, 539.0, 696.0, 829.0, 928.0, 725.0, 542.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 60.0, 20.0, 19.0, 30.0, 80.0, 10.0, 30.0, 30.0, 20.0, 50.0, 60.0, 70.0, 460.0, 90.0, 58.0, 90.0, 108.0, 38.0, 50.0, 80.0, 293.0, 40.0, 18.0, 100.0, 35.0, 50.0, 60.0, 100.0, 90.0, 169.0, 100.0, 180.0, -30.0, 8.0, 90.0, -30.0, 140.0, 280.0, 100.0, 180.0, 80.0, 69.0, 120.0, 110.0, 110.0, 110.0, 86.0, 50.0, 130.0, 20.0, 48.0, 60.0, -40.0, 50.0, 460.0, 26.0, 22.0, 27.0, 170.0, 340.0, 18.0, -40.0, 50.0, 50.0, 47.0, 210.0, 58.0, 79.0, -65.0, 60.0, -50.0, 196.0, 30.0, 80.0, 160.0, 79.0, 50.0, -3.0, 59.0, 40.0, 180.0, 40.0, 20.0, -1.0, 70.0, 20.0, -20.0, 30.0, 13.0, 49.0, 60.0, 140.0, 40.0, 100.0, 160.0, 49.0, 70.0, 80.0, 30.0, 80.0, 40.0, 90.0, 110.0, 580.0, -30.0, 80.0, 320.0, -10.0, 50.0, 110.0, 60.0, 70.0, 90.0, 30.0, 30.0, 60.0, 91.0, -13.0, 27.0, 50.0, 153.0, 70.0, 53.0, 120.0, 50.0, 39.0, 45.0, 50.0, 440.0, 120.0, 64.0, 60.0, 50.0, 123.0, 100.0, 100.0, 50.0, 209.0, 70.0, 70.0, 110.0, 50.0, 50.0, -23.0, 165.0, 70.0, 100.0, 180.0, 60.0, 56.0, 50.0, 160.0, 66.0, 170.0, -12.0, 50.0, 70.0, 70.0, 49.0, 38.0, 60.0, 40.0, 35.0, 30.0, 30.0, 76.0, 75.0, 110.0, 80.0, 60.0, 70.0, 35.0, 40.0, 47.0, 180.0, 88.0, 36.0, 69.0, 100.0, -38.0, 90.0, 80.0, 110.0, 70.0, 176.0, 0.0, 70.0, 50.0, 135.0, 260.0, 70.0, 90.0, 100.0, 5.0, 30.0, 180.0, 160.0, 28.0, 140.0, 60.0, 70.0, 40.0, 80.0, 241.0, 190.0, 110.0, 110.0, 110.0, 91.0, 70.0, 130.0, 70.0, 50.0, 60.0, 40.0, -20.0, 0.0, 60.0, 20.0, 208.0, 80.0, 110.0, 68.0, 90.0, 54.0, 10.0, 50.0, 50.0, 90.0, 90.0, 40.0, 40.0, 50.0, 23.0, 120.0, 200.0, 44.0, 70.0, 73.0, 80.0, 29.0, 60.0, 60.0, 80.0, 38.0, 210.0, 120.0, 11.0, 60.0, 90.0, 22.0, 69.0, 80.0, 60.0, 50.0, 58.0, 70.0, 110.0, 63.0, -16.0, 74.0, 100.0, 170.0, 160.0, 16.0, 100.0, 531.0, -28.0, 20.0, 210.0, 560.0, 120.0, -2.0, 40.0, 13.0, 10.0, 149.0, -15.0, 98.0, 70.0, 1000.0, 0.0, 50.0, 145.0, 60.0, 74.0, 28.0, 38.0, 96.0, 40.0, 300.0, 4.0, 11.0, 41.0, -20.0, 130.0, 100.0, 29.0, 25.0, 130.0, 80.0, 40.0, 110.0, 129.0, 90.0, 20.0, 64.0, 20.0, 40.0, 100.0, 80.0, 100.0, 110.0, 50.0, 56.0, 50.0, 70.0, 29.0, 70.0, 47.0, 35.0, 243.0, 85.0, 140.0, 48.0, 210.0, 80.0, 285.0, 50.0, 70.0, 40.0, 40.0, 50.0, 19.0, 60.0, 30.0, 90.0, 30.0, -5.0, 120.0, 50.0, 80.0, 90.0, 20.0, 60.0, 62.0, 10.0, 56.0, 70.0, 100.0, 80.0, 22.0, 110.0, 40.0, 278.0, 48.0, 99.0, 50.0, 47.0, 120.0, 100.0, 65.0, 60.0, 60.0, 93.0, 80.0, 40.0, 68.0, 60.0, 100.0, 36.0, 18.0, 27.0, 29.0, 8.0, 27.0, 20.0, 40.0, -15.0, 63.0, -30.0, 50.0, 49.0, 40.0, 48.0, 67.0, 390.0, 34.0, 63.0, 80.0, 19.0, 38.0, 70.0, 110.0, 110.0, 100.0, 110.0, 80.0, 100.0, 40.0, 190.0, 50.0, 59.0, 310.0, 100.0, 40.0, 90.0, 110.0, 70.0, 9.0, 65.0, 18.0, 25.0, 80.0, 90.0, 60.0, 80.0, 205.0, 70.0, 10.0, 37.0, 100.0, 150.0, 43.0, 8.0, 204.0, 80.0, 79.0, 57.0, 50.0, 80.0, 80.0, 61.0, 100.0, 50.0, 80.0, 80.0, 64.0, 60.0, 19.0, 51.0, 138.0, 69.0, 52.0, 40.0, 74.0, 6.0, 58.0, 77.0, 30.0, 70.0, -75.0, 297.0, 70.0, 75.0, 140.0, 50.0, 110.0, 69.0, -11.0, 339.0, -33.0, 38.0, 50.0, 80.0, 150.0, 15.0, 140.0, 70.0, 49.0, 60.0, 20.0, 50.0, 160.0, 709.0, 100.0, 80.0, 100.0, 60.0, 21.0, 160.0, -2.0, 29.0, -2.0, 37.0, 60.0, 100.0, 80.0, 9.0, 29.0, 50.0, 46.0, 130.0, 20.0, 90.0, 18.0, 70.0, 60.0, 10.0, 8.0, 49.0, 110.0, 87.0, 28.0, 60.0, 220.0, 41.0, 38.0, -6.0, 110.0, 40.0, 9.0, 32.0, 60.0, 180.0, 60.0, 77.0, 21.0, 53.0, 65.0, 100.0, 13.0, 100.0, 77.0, 50.0, 170.0, 565.0, 55.0, 70.0, 160.0, 30.0, 60.0, 120.0, 40.0, 283.0, 85.0, 21.0, 640.0, 38.0, 161.0, 60.0, 30.0, 7.0, 27.0, 160.0, 170.0, -81.0, 64.0, 25.0, 120.0, 90.0, 100.0, 50.0, 100.0, 30.0, 230.0, 60.0, 120.0, 50.0, 4.0, 27.0, 180.0, 25.0, 67.0, 34.0, 50.0, 85.0, 410.0, 31.0, 120.0, 56.0, 84.0, 30.0, 150.0, 110.0, 86.0, 78.0, 70.0, 80.0, 96.0, -13.0, 550.0, 170.0, 40.0, 160.0, 9.0, 17.0, 10.0, 120.0, 40.0, -10.0, 59.0, 50.0, 60.0, 50.0, 20.0, 99.0, 70.0, 140.0, 75.0, 60.0, 69.0, 59.0, 82.0, 80.0, 70.0, 110.0, 86.0, 91.0, 310.0, 100.0, 80.0, 180.0, 80.0, 140.0, 50.0, 12.0, 80.0, 100.0, 40.0, 63.0, 50.0, 10.0, 80.0, 60.0, 93.0, 90.0, 180.0, 180.0, 595.0, 120.0, 14.0, 120.0, 40.0, 110.0, 420.0, 140.0, 70.0, 105.0, 180.0, 322.0, 290.0, 26.0, 180.0, 110.0, 40.0, 50.0, 80.0, -55.0, 190.0, 80.0, 41.0, 44.0, 70.0, 101.0, 50.0, 110.0, 80.0, 50.0, 85.0, 20.0, 84.0, 7.0, 159.0, 230.0, 70.0, -15.0, 130.0, 60.0, 70.0, 60.0, 100.0, 40.0, 30.0, 38.0, 20.0, 30.0, 150.0, 50.0, 50.0, 60.0, 60.0, 100.0, 90.0, 30.0, 20.0, 160.0, 5.0, 60.0, 70.0, -83.0, 70.0, 20.0, 180.0, 370.0, 100.0, 100.0, 48.0, 97.0, 90.0, 62.0, 90.0, 90.0, 73.0, 24.0, 99.0, 320.0, 180.0, 60.0, 70.0, 90.0, 180.0, 90.0, 295.0, 170.0, 0.0, 100.0, -60.0, 60.0, 140.0, 72.0, 69.0, 90.0, 210.0, 63.0, 50.0, 61.0, 70.0, 59.0, 39.0, 60.0, 80.0, 50.0, 60.0, 35.0, 110.0, 20.0, 97.0, 40.0, 10.0, 146.0, 25.0, 35.0, 90.0, 50.0, 380.0, 17.0, -74.0, -26.0, 89.0, 100.0, 30.0, 100.0, 60.0, 190.0, 520.0, 150.0, -15.0, -20.0, 66.0, 77.0, 150.0, 44.0, 31.0, 113.0, 60.0, 53.0, 80.0, 30.0, 150.0, 90.0, 130.0, 80.0, 150.0, 148.0, 90.0, 90.0, 60.0, 43.0, -30.0, 39.0, 59.0, 160.0, 25.0, 60.0, -1.0, 80.0, 160.0, 70.0, 39.0, 40.0, 40.0, 50.0, 100.0, 30.0, 50.0, 50.0, 40.0, 10.0, 60.0, 170.0, 70.0, 50.0, 50.0, 70.0, 40.0, -100.0, 70.0, 90.0, 65.0, -52.0, 110.0, 33.0, 50.0, 39.0, 10.0, 60.0, 67.0, 70.0, 247.0, 80.0, 230.0, 40.0, 50.0, 79.0, 50.0, 120.0, 80.0, 40.0, 170.0, 100.0, 50.0, 70.0, 120.0, 70.0, 120.0, 160.0, -5.0, 80.0, 90.0, 21.0, 90.0, 180.0, 100.0, 168.0, 40.0, 60.0, 100.0, 45.0, 30.0, 20.0, 50.0, 50.0, 80.0, 80.0, -65.0, 69.0, 90.0, 70.0, 97.0, 100.0, 60.0, 47.0, 139.0, 10.0, 5.0, 50.0, 60.0, 30.0, 40.0, 90.0, 0.0, 47.0, 130.0, 120.0, 0.0, 320.0, 90.0, 8.0, 90.0, 20.0, 110.0, 46.0, 80.0, 49.0, 170.0, 160.0, 50.0, 130.0, 67.0, 60.0, 40.0, 70.0, 27.0, 79.0, 86.0, 280.0, 38.0, 90.0, 57.0, 19.0, 26.0, 300.0, 40.0, 170.0, 49.0, 60.0, 29.0, 50.0, 60.0, 60.0, -10.0, 170.0, 60.0, 310.0, 60.0, 40.0, 44.0, 102.0, 16.0, -1.0, -90.0, 80.0, 80.0, 320.0, 100.0, 100.0, 80.0, 79.0, 290.0, 56.0, 79.0, 35.0, 158.0, 78.0, 56.0, 44.0, 1.0, 180.0, 60.0, 70.0, 72.0, 0.0, 45.0, 80.0, 80.0, 62.0, 20.0, 50.0, 47.0, 10.0, 150.0, 0.0, 10.0, 100.0, 79.0, 60.0, 170.0, 70.0, 26.0, 69.0, 120.0, 39.0, 36.0, 100.0, 99.0, 140.0, 140.0, 60.0, 120.0, 49.0, 80.0, 70.0, 89.0, 70.0, 140.0, 100.0, 110.0, 100.0, 155.0, 60.0, 70.0, 48.0, -121.0, 86.0, 37.0, 110.0, 110.0, 170.0, 35.0, 50.0, 40.0, 37.0, 7.0, 45.0, 50.0, 38.0, 160.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9331331530393576, "mean_inference_ms": 2.1881528158931416, "mean_action_processing_ms": 0.7454609183109414, "mean_env_wait_ms": 1.52957912184605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06439471244812012, "StateBufferConnector_ms": 0.009766340255737305, "ViewRequirementAgentConnector_ms": 0.4574925899505615}, "num_episodes": 23, "episode_return_max": 1734.0, "episode_return_min": 290.0, "episode_return_mean": 825.78, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.42275515730456, "num_env_steps_trained_throughput_per_sec": 32.42275515730456, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 4800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4800000, "timers": {"training_iteration_time_ms": 123274.314, "restore_workers_time_ms": 0.012, "training_step_time_ms": 123274.267, "sample_time_ms": 3325.083, "learn_time_ms": 119928.685, "learn_throughput": 33.353, "synch_weights_time_ms": 11.864}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "done": false, "training_iteration": 120, "trial_id": "6085c_00000", "date": "2024-07-02_03-03-42", "timestamp": 1719903822, "time_this_iter_s": 123.38652396202087, "time_total_s": 16667.780596971512, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138aa7820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16667.780596971512, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 20.41206896551724, "ram_util_percent": 80.6844827586207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.922476711866066, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.570154869518341, "policy_loss": -0.007649460373445354, "vf_loss": 7.577017801739792, "vf_explained_var": 0.0010277550949202305, "kl": 0.007865392167712825, "entropy": 0.574988512978894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1131495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "env_runners": {"episode_reward_max": 1734.0, "episode_reward_min": 290.0, "episode_reward_mean": 839.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -121.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 83.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [743.0, 1063.0, 1102.0, 480.0, 810.0, 750.0, 748.0, 672.0, 1127.0, 1183.0, 1561.0, 660.0, 723.0, 715.0, 1223.0, 424.0, 618.0, 874.0, 746.0, 290.0, 774.0, 817.0, 1059.0, 702.0, 768.0, 705.0, 584.0, 836.0, 838.0, 1388.0, 492.0, 523.0, 635.0, 642.0, 1265.0, 1477.0, 623.0, 950.0, 913.0, 864.0, 1159.0, 578.0, 782.0, 1132.0, 846.0, 1734.0, 1223.0, 816.0, 830.0, 588.0, 635.0, 972.0, 1088.0, 995.0, 884.0, 591.0, 653.0, 1204.0, 704.0, 1031.0, 622.0, 449.0, 570.0, 452.0, 1016.0, 935.0, 894.0, 474.0, 598.0, 845.0, 905.0, 837.0, 800.0, 896.0, 764.0, 977.0, 539.0, 696.0, 829.0, 928.0, 725.0, 542.0, 1059.0, 724.0, 847.0, 1268.0, 881.0, 1078.0, 841.0, 733.0, 784.0, 832.0, 986.0, 707.0, 723.0, 775.0, 1030.0, 695.0, 863.0, 1034.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-38.0, 90.0, 80.0, 110.0, 70.0, 176.0, 0.0, 70.0, 50.0, 135.0, 260.0, 70.0, 90.0, 100.0, 5.0, 30.0, 180.0, 160.0, 28.0, 140.0, 60.0, 70.0, 40.0, 80.0, 241.0, 190.0, 110.0, 110.0, 110.0, 91.0, 70.0, 130.0, 70.0, 50.0, 60.0, 40.0, -20.0, 0.0, 60.0, 20.0, 208.0, 80.0, 110.0, 68.0, 90.0, 54.0, 10.0, 50.0, 50.0, 90.0, 90.0, 40.0, 40.0, 50.0, 23.0, 120.0, 200.0, 44.0, 70.0, 73.0, 80.0, 29.0, 60.0, 60.0, 80.0, 38.0, 210.0, 120.0, 11.0, 60.0, 90.0, 22.0, 69.0, 80.0, 60.0, 50.0, 58.0, 70.0, 110.0, 63.0, -16.0, 74.0, 100.0, 170.0, 160.0, 16.0, 100.0, 531.0, -28.0, 20.0, 210.0, 560.0, 120.0, -2.0, 40.0, 13.0, 10.0, 149.0, -15.0, 98.0, 70.0, 1000.0, 0.0, 50.0, 145.0, 60.0, 74.0, 28.0, 38.0, 96.0, 40.0, 300.0, 4.0, 11.0, 41.0, -20.0, 130.0, 100.0, 29.0, 25.0, 130.0, 80.0, 40.0, 110.0, 129.0, 90.0, 20.0, 64.0, 20.0, 40.0, 100.0, 80.0, 100.0, 110.0, 50.0, 56.0, 50.0, 70.0, 29.0, 70.0, 47.0, 35.0, 243.0, 85.0, 140.0, 48.0, 210.0, 80.0, 285.0, 50.0, 70.0, 40.0, 40.0, 50.0, 19.0, 60.0, 30.0, 90.0, 30.0, -5.0, 120.0, 50.0, 80.0, 90.0, 20.0, 60.0, 62.0, 10.0, 56.0, 70.0, 100.0, 80.0, 22.0, 110.0, 40.0, 278.0, 48.0, 99.0, 50.0, 47.0, 120.0, 100.0, 65.0, 60.0, 60.0, 93.0, 80.0, 40.0, 68.0, 60.0, 100.0, 36.0, 18.0, 27.0, 29.0, 8.0, 27.0, 20.0, 40.0, -15.0, 63.0, -30.0, 50.0, 49.0, 40.0, 48.0, 67.0, 390.0, 34.0, 63.0, 80.0, 19.0, 38.0, 70.0, 110.0, 110.0, 100.0, 110.0, 80.0, 100.0, 40.0, 190.0, 50.0, 59.0, 310.0, 100.0, 40.0, 90.0, 110.0, 70.0, 9.0, 65.0, 18.0, 25.0, 80.0, 90.0, 60.0, 80.0, 205.0, 70.0, 10.0, 37.0, 100.0, 150.0, 43.0, 8.0, 204.0, 80.0, 79.0, 57.0, 50.0, 80.0, 80.0, 61.0, 100.0, 50.0, 80.0, 80.0, 64.0, 60.0, 19.0, 51.0, 138.0, 69.0, 52.0, 40.0, 74.0, 6.0, 58.0, 77.0, 30.0, 70.0, -75.0, 297.0, 70.0, 75.0, 140.0, 50.0, 110.0, 69.0, -11.0, 339.0, -33.0, 38.0, 50.0, 80.0, 150.0, 15.0, 140.0, 70.0, 49.0, 60.0, 20.0, 50.0, 160.0, 709.0, 100.0, 80.0, 100.0, 60.0, 21.0, 160.0, -2.0, 29.0, -2.0, 37.0, 60.0, 100.0, 80.0, 9.0, 29.0, 50.0, 46.0, 130.0, 20.0, 90.0, 18.0, 70.0, 60.0, 10.0, 8.0, 49.0, 110.0, 87.0, 28.0, 60.0, 220.0, 41.0, 38.0, -6.0, 110.0, 40.0, 9.0, 32.0, 60.0, 180.0, 60.0, 77.0, 21.0, 53.0, 65.0, 100.0, 13.0, 100.0, 77.0, 50.0, 170.0, 565.0, 55.0, 70.0, 160.0, 30.0, 60.0, 120.0, 40.0, 283.0, 85.0, 21.0, 640.0, 38.0, 161.0, 60.0, 30.0, 7.0, 27.0, 160.0, 170.0, -81.0, 64.0, 25.0, 120.0, 90.0, 100.0, 50.0, 100.0, 30.0, 230.0, 60.0, 120.0, 50.0, 4.0, 27.0, 180.0, 25.0, 67.0, 34.0, 50.0, 85.0, 410.0, 31.0, 120.0, 56.0, 84.0, 30.0, 150.0, 110.0, 86.0, 78.0, 70.0, 80.0, 96.0, -13.0, 550.0, 170.0, 40.0, 160.0, 9.0, 17.0, 10.0, 120.0, 40.0, -10.0, 59.0, 50.0, 60.0, 50.0, 20.0, 99.0, 70.0, 140.0, 75.0, 60.0, 69.0, 59.0, 82.0, 80.0, 70.0, 110.0, 86.0, 91.0, 310.0, 100.0, 80.0, 180.0, 80.0, 140.0, 50.0, 12.0, 80.0, 100.0, 40.0, 63.0, 50.0, 10.0, 80.0, 60.0, 93.0, 90.0, 180.0, 180.0, 595.0, 120.0, 14.0, 120.0, 40.0, 110.0, 420.0, 140.0, 70.0, 105.0, 180.0, 322.0, 290.0, 26.0, 180.0, 110.0, 40.0, 50.0, 80.0, -55.0, 190.0, 80.0, 41.0, 44.0, 70.0, 101.0, 50.0, 110.0, 80.0, 50.0, 85.0, 20.0, 84.0, 7.0, 159.0, 230.0, 70.0, -15.0, 130.0, 60.0, 70.0, 60.0, 100.0, 40.0, 30.0, 38.0, 20.0, 30.0, 150.0, 50.0, 50.0, 60.0, 60.0, 100.0, 90.0, 30.0, 20.0, 160.0, 5.0, 60.0, 70.0, -83.0, 70.0, 20.0, 180.0, 370.0, 100.0, 100.0, 48.0, 97.0, 90.0, 62.0, 90.0, 90.0, 73.0, 24.0, 99.0, 320.0, 180.0, 60.0, 70.0, 90.0, 180.0, 90.0, 295.0, 170.0, 0.0, 100.0, -60.0, 60.0, 140.0, 72.0, 69.0, 90.0, 210.0, 63.0, 50.0, 61.0, 70.0, 59.0, 39.0, 60.0, 80.0, 50.0, 60.0, 35.0, 110.0, 20.0, 97.0, 40.0, 10.0, 146.0, 25.0, 35.0, 90.0, 50.0, 380.0, 17.0, -74.0, -26.0, 89.0, 100.0, 30.0, 100.0, 60.0, 190.0, 520.0, 150.0, -15.0, -20.0, 66.0, 77.0, 150.0, 44.0, 31.0, 113.0, 60.0, 53.0, 80.0, 30.0, 150.0, 90.0, 130.0, 80.0, 150.0, 148.0, 90.0, 90.0, 60.0, 43.0, -30.0, 39.0, 59.0, 160.0, 25.0, 60.0, -1.0, 80.0, 160.0, 70.0, 39.0, 40.0, 40.0, 50.0, 100.0, 30.0, 50.0, 50.0, 40.0, 10.0, 60.0, 170.0, 70.0, 50.0, 50.0, 70.0, 40.0, -100.0, 70.0, 90.0, 65.0, -52.0, 110.0, 33.0, 50.0, 39.0, 10.0, 60.0, 67.0, 70.0, 247.0, 80.0, 230.0, 40.0, 50.0, 79.0, 50.0, 120.0, 80.0, 40.0, 170.0, 100.0, 50.0, 70.0, 120.0, 70.0, 120.0, 160.0, -5.0, 80.0, 90.0, 21.0, 90.0, 180.0, 100.0, 168.0, 40.0, 60.0, 100.0, 45.0, 30.0, 20.0, 50.0, 50.0, 80.0, 80.0, -65.0, 69.0, 90.0, 70.0, 97.0, 100.0, 60.0, 47.0, 139.0, 10.0, 5.0, 50.0, 60.0, 30.0, 40.0, 90.0, 0.0, 47.0, 130.0, 120.0, 0.0, 320.0, 90.0, 8.0, 90.0, 20.0, 110.0, 46.0, 80.0, 49.0, 170.0, 160.0, 50.0, 130.0, 67.0, 60.0, 40.0, 70.0, 27.0, 79.0, 86.0, 280.0, 38.0, 90.0, 57.0, 19.0, 26.0, 300.0, 40.0, 170.0, 49.0, 60.0, 29.0, 50.0, 60.0, 60.0, -10.0, 170.0, 60.0, 310.0, 60.0, 40.0, 44.0, 102.0, 16.0, -1.0, -90.0, 80.0, 80.0, 320.0, 100.0, 100.0, 80.0, 79.0, 290.0, 56.0, 79.0, 35.0, 158.0, 78.0, 56.0, 44.0, 1.0, 180.0, 60.0, 70.0, 72.0, 0.0, 45.0, 80.0, 80.0, 62.0, 20.0, 50.0, 47.0, 10.0, 150.0, 0.0, 10.0, 100.0, 79.0, 60.0, 170.0, 70.0, 26.0, 69.0, 120.0, 39.0, 36.0, 100.0, 99.0, 140.0, 140.0, 60.0, 120.0, 49.0, 80.0, 70.0, 89.0, 70.0, 140.0, 100.0, 110.0, 100.0, 155.0, 60.0, 70.0, 48.0, -121.0, 86.0, 37.0, 110.0, 110.0, 170.0, 35.0, 50.0, 40.0, 37.0, 7.0, 45.0, 50.0, 38.0, 160.0, 80.0, 99.0, 580.0, 30.0, 50.0, 20.0, 70.0, 30.0, 50.0, 40.0, 90.0, 10.0, 80.0, 41.0, 7.0, 100.0, 70.0, 50.0, 266.0, 50.0, 50.0, 80.0, 100.0, 59.0, 374.0, 95.0, 40.0, 70.0, 9.0, -30.0, 50.0, -31.0, 100.0, 190.0, 60.0, 308.0, 88.0, 80.0, 25.0, 139.0, 309.0, 90.0, 60.0, 20.0, 99.0, 60.0, 47.0, 60.0, 101.0, 300.0, 44.0, 160.0, 40.0, 130.0, 60.0, 180.0, 120.0, 180.0, 60.0, 90.0, 58.0, 100.0, 41.0, 77.0, 110.0, 80.0, 63.0, 70.0, 70.0, 140.0, 90.0, 80.0, 15.0, 71.0, 49.0, 80.0, 70.0, 47.0, 80.0, 211.0, 30.0, 74.0, 79.0, 90.0, 84.0, 209.0, 104.0, -83.0, 70.0, 89.0, 68.0, 90.0, 60.0, 181.0, 76.0, 103.0, 80.0, 45.0, 60.0, 67.0, 70.0, 87.0, 98.0, 34.0, 380.0, -41.0, 130.0, 45.0, 13.0, 140.0, 100.0, 168.0, -70.0, 90.0, 20.0, 20.0, 70.0, 25.0, 168.0, 156.0, 60.0, 140.0, 40.0, 70.0, 65.0, 110.0, 80.0, 59.0, 29.0, 60.0, 70.0, 140.0, 100.0, 118.0, 50.0, 10.0, 40.0, 160.0, 70.0, 57.0, 30.0, 130.0, 280.0, 109.0, 83.0, 70.0, 70.0, 90.0, 80.0, 60.0, 58.0, 40.0, 60.0, 50.0, 160.0, 57.0, 64.0, 54.0, 80.0, 40.0, 90.0, 107.0, 64.0, 70.0, 70.0, 128.0, 66.0, 48.0, 80.0, 140.0, 90.0, 139.0, -39.0, 90.0, 141.0, 130.0, 70.0, 110.0, 265.0, 38.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9325082671955527, "mean_inference_ms": 2.187340268616891, "mean_action_processing_ms": 0.7448851753928696, "mean_env_wait_ms": 1.5287514721502777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0612027645111084, "StateBufferConnector_ms": 0.01076817512512207, "ViewRequirementAgentConnector_ms": 0.46767735481262207}, "num_episodes": 18, "episode_return_max": 1734.0, "episode_return_min": 290.0, "episode_return_mean": 839.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.31992769552919, "num_env_steps_trained_throughput_per_sec": 32.31992769552919, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 4840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4840000, "timers": {"training_iteration_time_ms": 123351.757, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123351.707, "sample_time_ms": 3372.275, "learn_time_ms": 119959.039, "learn_throughput": 33.345, "synch_weights_time_ms": 11.687}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "done": false, "training_iteration": 121, "trial_id": "6085c_00000", "date": "2024-07-02_03-05-46", "timestamp": 1719903946, "time_this_iter_s": 123.77543807029724, "time_total_s": 16791.55603504181, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b73940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16791.55603504181, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 21.13942857142857, "ram_util_percent": 79.46685714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0418117915733425, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.313429976576052, "policy_loss": -0.007437585793220844, "vf_loss": 7.320067373251382, "vf_explained_var": 0.0037282351360788234, "kl": 0.008001919651049981, "entropy": 0.5940990121981587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1140885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "env_runners": {"episode_reward_max": 1734.0, "episode_reward_min": 305.0, "episode_reward_mean": 840.06, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -121.0}, "policy_reward_max": {"policy_0": 709.0}, "policy_reward_mean": {"policy_0": 84.006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1059.0, 702.0, 768.0, 705.0, 584.0, 836.0, 838.0, 1388.0, 492.0, 523.0, 635.0, 642.0, 1265.0, 1477.0, 623.0, 950.0, 913.0, 864.0, 1159.0, 578.0, 782.0, 1132.0, 846.0, 1734.0, 1223.0, 816.0, 830.0, 588.0, 635.0, 972.0, 1088.0, 995.0, 884.0, 591.0, 653.0, 1204.0, 704.0, 1031.0, 622.0, 449.0, 570.0, 452.0, 1016.0, 935.0, 894.0, 474.0, 598.0, 845.0, 905.0, 837.0, 800.0, 896.0, 764.0, 977.0, 539.0, 696.0, 829.0, 928.0, 725.0, 542.0, 1059.0, 724.0, 847.0, 1268.0, 881.0, 1078.0, 841.0, 733.0, 784.0, 832.0, 986.0, 707.0, 723.0, 775.0, 1030.0, 695.0, 863.0, 1034.0, 305.0, 474.0, 735.0, 902.0, 785.0, 907.0, 1014.0, 811.0, 754.0, 872.0, 668.0, 1188.0, 1101.0, 715.0, 1150.0, 712.0, 657.0, 500.0, 1179.0, 754.0, 1332.0, 629.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 190.0, 50.0, 59.0, 310.0, 100.0, 40.0, 90.0, 110.0, 70.0, 9.0, 65.0, 18.0, 25.0, 80.0, 90.0, 60.0, 80.0, 205.0, 70.0, 10.0, 37.0, 100.0, 150.0, 43.0, 8.0, 204.0, 80.0, 79.0, 57.0, 50.0, 80.0, 80.0, 61.0, 100.0, 50.0, 80.0, 80.0, 64.0, 60.0, 19.0, 51.0, 138.0, 69.0, 52.0, 40.0, 74.0, 6.0, 58.0, 77.0, 30.0, 70.0, -75.0, 297.0, 70.0, 75.0, 140.0, 50.0, 110.0, 69.0, -11.0, 339.0, -33.0, 38.0, 50.0, 80.0, 150.0, 15.0, 140.0, 70.0, 49.0, 60.0, 20.0, 50.0, 160.0, 709.0, 100.0, 80.0, 100.0, 60.0, 21.0, 160.0, -2.0, 29.0, -2.0, 37.0, 60.0, 100.0, 80.0, 9.0, 29.0, 50.0, 46.0, 130.0, 20.0, 90.0, 18.0, 70.0, 60.0, 10.0, 8.0, 49.0, 110.0, 87.0, 28.0, 60.0, 220.0, 41.0, 38.0, -6.0, 110.0, 40.0, 9.0, 32.0, 60.0, 180.0, 60.0, 77.0, 21.0, 53.0, 65.0, 100.0, 13.0, 100.0, 77.0, 50.0, 170.0, 565.0, 55.0, 70.0, 160.0, 30.0, 60.0, 120.0, 40.0, 283.0, 85.0, 21.0, 640.0, 38.0, 161.0, 60.0, 30.0, 7.0, 27.0, 160.0, 170.0, -81.0, 64.0, 25.0, 120.0, 90.0, 100.0, 50.0, 100.0, 30.0, 230.0, 60.0, 120.0, 50.0, 4.0, 27.0, 180.0, 25.0, 67.0, 34.0, 50.0, 85.0, 410.0, 31.0, 120.0, 56.0, 84.0, 30.0, 150.0, 110.0, 86.0, 78.0, 70.0, 80.0, 96.0, -13.0, 550.0, 170.0, 40.0, 160.0, 9.0, 17.0, 10.0, 120.0, 40.0, -10.0, 59.0, 50.0, 60.0, 50.0, 20.0, 99.0, 70.0, 140.0, 75.0, 60.0, 69.0, 59.0, 82.0, 80.0, 70.0, 110.0, 86.0, 91.0, 310.0, 100.0, 80.0, 180.0, 80.0, 140.0, 50.0, 12.0, 80.0, 100.0, 40.0, 63.0, 50.0, 10.0, 80.0, 60.0, 93.0, 90.0, 180.0, 180.0, 595.0, 120.0, 14.0, 120.0, 40.0, 110.0, 420.0, 140.0, 70.0, 105.0, 180.0, 322.0, 290.0, 26.0, 180.0, 110.0, 40.0, 50.0, 80.0, -55.0, 190.0, 80.0, 41.0, 44.0, 70.0, 101.0, 50.0, 110.0, 80.0, 50.0, 85.0, 20.0, 84.0, 7.0, 159.0, 230.0, 70.0, -15.0, 130.0, 60.0, 70.0, 60.0, 100.0, 40.0, 30.0, 38.0, 20.0, 30.0, 150.0, 50.0, 50.0, 60.0, 60.0, 100.0, 90.0, 30.0, 20.0, 160.0, 5.0, 60.0, 70.0, -83.0, 70.0, 20.0, 180.0, 370.0, 100.0, 100.0, 48.0, 97.0, 90.0, 62.0, 90.0, 90.0, 73.0, 24.0, 99.0, 320.0, 180.0, 60.0, 70.0, 90.0, 180.0, 90.0, 295.0, 170.0, 0.0, 100.0, -60.0, 60.0, 140.0, 72.0, 69.0, 90.0, 210.0, 63.0, 50.0, 61.0, 70.0, 59.0, 39.0, 60.0, 80.0, 50.0, 60.0, 35.0, 110.0, 20.0, 97.0, 40.0, 10.0, 146.0, 25.0, 35.0, 90.0, 50.0, 380.0, 17.0, -74.0, -26.0, 89.0, 100.0, 30.0, 100.0, 60.0, 190.0, 520.0, 150.0, -15.0, -20.0, 66.0, 77.0, 150.0, 44.0, 31.0, 113.0, 60.0, 53.0, 80.0, 30.0, 150.0, 90.0, 130.0, 80.0, 150.0, 148.0, 90.0, 90.0, 60.0, 43.0, -30.0, 39.0, 59.0, 160.0, 25.0, 60.0, -1.0, 80.0, 160.0, 70.0, 39.0, 40.0, 40.0, 50.0, 100.0, 30.0, 50.0, 50.0, 40.0, 10.0, 60.0, 170.0, 70.0, 50.0, 50.0, 70.0, 40.0, -100.0, 70.0, 90.0, 65.0, -52.0, 110.0, 33.0, 50.0, 39.0, 10.0, 60.0, 67.0, 70.0, 247.0, 80.0, 230.0, 40.0, 50.0, 79.0, 50.0, 120.0, 80.0, 40.0, 170.0, 100.0, 50.0, 70.0, 120.0, 70.0, 120.0, 160.0, -5.0, 80.0, 90.0, 21.0, 90.0, 180.0, 100.0, 168.0, 40.0, 60.0, 100.0, 45.0, 30.0, 20.0, 50.0, 50.0, 80.0, 80.0, -65.0, 69.0, 90.0, 70.0, 97.0, 100.0, 60.0, 47.0, 139.0, 10.0, 5.0, 50.0, 60.0, 30.0, 40.0, 90.0, 0.0, 47.0, 130.0, 120.0, 0.0, 320.0, 90.0, 8.0, 90.0, 20.0, 110.0, 46.0, 80.0, 49.0, 170.0, 160.0, 50.0, 130.0, 67.0, 60.0, 40.0, 70.0, 27.0, 79.0, 86.0, 280.0, 38.0, 90.0, 57.0, 19.0, 26.0, 300.0, 40.0, 170.0, 49.0, 60.0, 29.0, 50.0, 60.0, 60.0, -10.0, 170.0, 60.0, 310.0, 60.0, 40.0, 44.0, 102.0, 16.0, -1.0, -90.0, 80.0, 80.0, 320.0, 100.0, 100.0, 80.0, 79.0, 290.0, 56.0, 79.0, 35.0, 158.0, 78.0, 56.0, 44.0, 1.0, 180.0, 60.0, 70.0, 72.0, 0.0, 45.0, 80.0, 80.0, 62.0, 20.0, 50.0, 47.0, 10.0, 150.0, 0.0, 10.0, 100.0, 79.0, 60.0, 170.0, 70.0, 26.0, 69.0, 120.0, 39.0, 36.0, 100.0, 99.0, 140.0, 140.0, 60.0, 120.0, 49.0, 80.0, 70.0, 89.0, 70.0, 140.0, 100.0, 110.0, 100.0, 155.0, 60.0, 70.0, 48.0, -121.0, 86.0, 37.0, 110.0, 110.0, 170.0, 35.0, 50.0, 40.0, 37.0, 7.0, 45.0, 50.0, 38.0, 160.0, 80.0, 99.0, 580.0, 30.0, 50.0, 20.0, 70.0, 30.0, 50.0, 40.0, 90.0, 10.0, 80.0, 41.0, 7.0, 100.0, 70.0, 50.0, 266.0, 50.0, 50.0, 80.0, 100.0, 59.0, 374.0, 95.0, 40.0, 70.0, 9.0, -30.0, 50.0, -31.0, 100.0, 190.0, 60.0, 308.0, 88.0, 80.0, 25.0, 139.0, 309.0, 90.0, 60.0, 20.0, 99.0, 60.0, 47.0, 60.0, 101.0, 300.0, 44.0, 160.0, 40.0, 130.0, 60.0, 180.0, 120.0, 180.0, 60.0, 90.0, 58.0, 100.0, 41.0, 77.0, 110.0, 80.0, 63.0, 70.0, 70.0, 140.0, 90.0, 80.0, 15.0, 71.0, 49.0, 80.0, 70.0, 47.0, 80.0, 211.0, 30.0, 74.0, 79.0, 90.0, 84.0, 209.0, 104.0, -83.0, 70.0, 89.0, 68.0, 90.0, 60.0, 181.0, 76.0, 103.0, 80.0, 45.0, 60.0, 67.0, 70.0, 87.0, 98.0, 34.0, 380.0, -41.0, 130.0, 45.0, 13.0, 140.0, 100.0, 168.0, -70.0, 90.0, 20.0, 20.0, 70.0, 25.0, 168.0, 156.0, 60.0, 140.0, 40.0, 70.0, 65.0, 110.0, 80.0, 59.0, 29.0, 60.0, 70.0, 140.0, 100.0, 118.0, 50.0, 10.0, 40.0, 160.0, 70.0, 57.0, 30.0, 130.0, 280.0, 109.0, 83.0, 70.0, 70.0, 90.0, 80.0, 60.0, 58.0, 40.0, 60.0, 50.0, 160.0, 57.0, 64.0, 54.0, 80.0, 40.0, 90.0, 107.0, 64.0, 70.0, 70.0, 128.0, 66.0, 48.0, 80.0, 140.0, 90.0, 139.0, -39.0, 90.0, 141.0, 130.0, 70.0, 110.0, 265.0, 38.0, 90.0, 10.0, 15.0, 30.0, 50.0, 10.0, 30.0, 40.0, 60.0, 50.0, 10.0, 0.0, -20.0, 20.0, 80.0, 10.0, 70.0, 160.0, 80.0, 49.0, 25.0, 60.0, 130.0, 40.0, 60.0, 70.0, 100.0, 89.0, 17.0, 59.0, 110.0, 107.0, 70.0, 100.0, 108.0, 89.0, -100.0, 310.0, 60.0, 60.0, 98.0, 70.0, 15.0, 60.0, 150.0, 5.0, 60.0, 76.0, 37.0, 165.0, 147.0, 52.0, 50.0, 73.0, 145.0, 110.0, 132.0, 15.0, 100.0, 110.0, 120.0, 77.0, 10.0, 15.0, 65.0, 54.0, 160.0, 389.0, 80.0, 70.0, 94.0, 109.0, 78.0, 4.0, 118.0, 97.0, 21.0, 185.0, 60.0, 90.0, 49.0, 70.0, 60.0, 60.0, 70.0, 60.0, 90.0, 120.0, 25.0, 130.0, 69.0, 58.0, -80.0, 48.0, 560.0, 70.0, 86.0, -40.0, 100.0, 60.0, 10.0, 60.0, 110.0, 60.0, -15.0, 0.0, 90.0, 70.0, 50.0, 78.0, 165.0, 70.0, 110.0, 60.0, 140.0, 80.0, 195.0, 210.0, 73.0, 140.0, 110.0, 360.0, 80.0, 46.0, 59.0, 57.0, 90.0, 150.0, 159.0, 60.0, 40.0, 20.0, 91.0, 107.0, 44.0, 65.0, 70.0, 37.0, 70.0, 123.0, 88.0, 410.0, 100.0, 90.0, 100.0, 100.0, 10.0, 169.0, 65.0, -14.0, 120.0, 70.0, 87.0, 40.0, 200.0, 13.0, 68.0, 79.0, 40.0, 40.0, 75.0, 40.0, 20.0, 40.0, 69.0, 60.0, 100.0, 98.0, 50.0, 90.0, 90.0, 20.0, 17.0, 10.0, 256.0, -28.0, 69.0, -34.0, 50.0, 100.0, 40.0, -37.0, 10.0, 220.0, 71.0, 70.0, 130.0, 110.0, 210.0, 85.0, 310.0, 70.0, 80.0, 90.0, 40.0, 40.0, 200.0, 35.0, 30.0, 79.0, 90.0, 310.0, 70.0, 50.0, 50.0, 70.0, 596.0, 50.0, 95.0, 60.0, -19.0, 60.0, 20.0, 140.0, 70.0, 56.0, 67.0, 30.0, 59.0, 67.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.93215375577673, "mean_inference_ms": 2.1868738256697426, "mean_action_processing_ms": 0.744359314071709, "mean_env_wait_ms": 1.5281062553507445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0610349178314209, "StateBufferConnector_ms": 0.016925573348999023, "ViewRequirementAgentConnector_ms": 0.47270965576171875}, "num_episodes": 22, "episode_return_max": 1734.0, "episode_return_min": 305.0, "episode_return_mean": 840.06, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.22067946363701, "num_env_steps_trained_throughput_per_sec": 32.22067946363701, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 4880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4880000, "timers": {"training_iteration_time_ms": 123375.332, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123375.283, "sample_time_ms": 3382.625, "learn_time_ms": 119972.021, "learn_throughput": 33.341, "synch_weights_time_ms": 11.836}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "done": false, "training_iteration": 122, "trial_id": "6085c_00000", "date": "2024-07-02_03-07-50", "timestamp": 1719904070, "time_this_iter_s": 124.1563868522644, "time_total_s": 16915.712421894073, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138aa7790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16915.712421894073, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 20.693749999999998, "ram_util_percent": 79.46988636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8536699505850147, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.414251149221223, "policy_loss": -0.007985694490916654, "vf_loss": 7.4212482044618096, "vf_explained_var": 0.0010375065861926418, "kl": 0.00988645345256742, "entropy": 0.6009128552370558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1150275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "env_runners": {"episode_reward_max": 1734.0, "episode_reward_min": 217.0, "episode_reward_mean": 837.56, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -255.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 83.756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1159.0, 578.0, 782.0, 1132.0, 846.0, 1734.0, 1223.0, 816.0, 830.0, 588.0, 635.0, 972.0, 1088.0, 995.0, 884.0, 591.0, 653.0, 1204.0, 704.0, 1031.0, 622.0, 449.0, 570.0, 452.0, 1016.0, 935.0, 894.0, 474.0, 598.0, 845.0, 905.0, 837.0, 800.0, 896.0, 764.0, 977.0, 539.0, 696.0, 829.0, 928.0, 725.0, 542.0, 1059.0, 724.0, 847.0, 1268.0, 881.0, 1078.0, 841.0, 733.0, 784.0, 832.0, 986.0, 707.0, 723.0, 775.0, 1030.0, 695.0, 863.0, 1034.0, 305.0, 474.0, 735.0, 902.0, 785.0, 907.0, 1014.0, 811.0, 754.0, 872.0, 668.0, 1188.0, 1101.0, 715.0, 1150.0, 712.0, 657.0, 500.0, 1179.0, 754.0, 1332.0, 629.0, 960.0, 641.0, 869.0, 1125.0, 764.0, 520.0, 217.0, 868.0, 702.0, 889.0, 637.0, 1081.0, 875.0, 749.0, 965.0, 746.0, 820.0, 1586.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [96.0, -13.0, 550.0, 170.0, 40.0, 160.0, 9.0, 17.0, 10.0, 120.0, 40.0, -10.0, 59.0, 50.0, 60.0, 50.0, 20.0, 99.0, 70.0, 140.0, 75.0, 60.0, 69.0, 59.0, 82.0, 80.0, 70.0, 110.0, 86.0, 91.0, 310.0, 100.0, 80.0, 180.0, 80.0, 140.0, 50.0, 12.0, 80.0, 100.0, 40.0, 63.0, 50.0, 10.0, 80.0, 60.0, 93.0, 90.0, 180.0, 180.0, 595.0, 120.0, 14.0, 120.0, 40.0, 110.0, 420.0, 140.0, 70.0, 105.0, 180.0, 322.0, 290.0, 26.0, 180.0, 110.0, 40.0, 50.0, 80.0, -55.0, 190.0, 80.0, 41.0, 44.0, 70.0, 101.0, 50.0, 110.0, 80.0, 50.0, 85.0, 20.0, 84.0, 7.0, 159.0, 230.0, 70.0, -15.0, 130.0, 60.0, 70.0, 60.0, 100.0, 40.0, 30.0, 38.0, 20.0, 30.0, 150.0, 50.0, 50.0, 60.0, 60.0, 100.0, 90.0, 30.0, 20.0, 160.0, 5.0, 60.0, 70.0, -83.0, 70.0, 20.0, 180.0, 370.0, 100.0, 100.0, 48.0, 97.0, 90.0, 62.0, 90.0, 90.0, 73.0, 24.0, 99.0, 320.0, 180.0, 60.0, 70.0, 90.0, 180.0, 90.0, 295.0, 170.0, 0.0, 100.0, -60.0, 60.0, 140.0, 72.0, 69.0, 90.0, 210.0, 63.0, 50.0, 61.0, 70.0, 59.0, 39.0, 60.0, 80.0, 50.0, 60.0, 35.0, 110.0, 20.0, 97.0, 40.0, 10.0, 146.0, 25.0, 35.0, 90.0, 50.0, 380.0, 17.0, -74.0, -26.0, 89.0, 100.0, 30.0, 100.0, 60.0, 190.0, 520.0, 150.0, -15.0, -20.0, 66.0, 77.0, 150.0, 44.0, 31.0, 113.0, 60.0, 53.0, 80.0, 30.0, 150.0, 90.0, 130.0, 80.0, 150.0, 148.0, 90.0, 90.0, 60.0, 43.0, -30.0, 39.0, 59.0, 160.0, 25.0, 60.0, -1.0, 80.0, 160.0, 70.0, 39.0, 40.0, 40.0, 50.0, 100.0, 30.0, 50.0, 50.0, 40.0, 10.0, 60.0, 170.0, 70.0, 50.0, 50.0, 70.0, 40.0, -100.0, 70.0, 90.0, 65.0, -52.0, 110.0, 33.0, 50.0, 39.0, 10.0, 60.0, 67.0, 70.0, 247.0, 80.0, 230.0, 40.0, 50.0, 79.0, 50.0, 120.0, 80.0, 40.0, 170.0, 100.0, 50.0, 70.0, 120.0, 70.0, 120.0, 160.0, -5.0, 80.0, 90.0, 21.0, 90.0, 180.0, 100.0, 168.0, 40.0, 60.0, 100.0, 45.0, 30.0, 20.0, 50.0, 50.0, 80.0, 80.0, -65.0, 69.0, 90.0, 70.0, 97.0, 100.0, 60.0, 47.0, 139.0, 10.0, 5.0, 50.0, 60.0, 30.0, 40.0, 90.0, 0.0, 47.0, 130.0, 120.0, 0.0, 320.0, 90.0, 8.0, 90.0, 20.0, 110.0, 46.0, 80.0, 49.0, 170.0, 160.0, 50.0, 130.0, 67.0, 60.0, 40.0, 70.0, 27.0, 79.0, 86.0, 280.0, 38.0, 90.0, 57.0, 19.0, 26.0, 300.0, 40.0, 170.0, 49.0, 60.0, 29.0, 50.0, 60.0, 60.0, -10.0, 170.0, 60.0, 310.0, 60.0, 40.0, 44.0, 102.0, 16.0, -1.0, -90.0, 80.0, 80.0, 320.0, 100.0, 100.0, 80.0, 79.0, 290.0, 56.0, 79.0, 35.0, 158.0, 78.0, 56.0, 44.0, 1.0, 180.0, 60.0, 70.0, 72.0, 0.0, 45.0, 80.0, 80.0, 62.0, 20.0, 50.0, 47.0, 10.0, 150.0, 0.0, 10.0, 100.0, 79.0, 60.0, 170.0, 70.0, 26.0, 69.0, 120.0, 39.0, 36.0, 100.0, 99.0, 140.0, 140.0, 60.0, 120.0, 49.0, 80.0, 70.0, 89.0, 70.0, 140.0, 100.0, 110.0, 100.0, 155.0, 60.0, 70.0, 48.0, -121.0, 86.0, 37.0, 110.0, 110.0, 170.0, 35.0, 50.0, 40.0, 37.0, 7.0, 45.0, 50.0, 38.0, 160.0, 80.0, 99.0, 580.0, 30.0, 50.0, 20.0, 70.0, 30.0, 50.0, 40.0, 90.0, 10.0, 80.0, 41.0, 7.0, 100.0, 70.0, 50.0, 266.0, 50.0, 50.0, 80.0, 100.0, 59.0, 374.0, 95.0, 40.0, 70.0, 9.0, -30.0, 50.0, -31.0, 100.0, 190.0, 60.0, 308.0, 88.0, 80.0, 25.0, 139.0, 309.0, 90.0, 60.0, 20.0, 99.0, 60.0, 47.0, 60.0, 101.0, 300.0, 44.0, 160.0, 40.0, 130.0, 60.0, 180.0, 120.0, 180.0, 60.0, 90.0, 58.0, 100.0, 41.0, 77.0, 110.0, 80.0, 63.0, 70.0, 70.0, 140.0, 90.0, 80.0, 15.0, 71.0, 49.0, 80.0, 70.0, 47.0, 80.0, 211.0, 30.0, 74.0, 79.0, 90.0, 84.0, 209.0, 104.0, -83.0, 70.0, 89.0, 68.0, 90.0, 60.0, 181.0, 76.0, 103.0, 80.0, 45.0, 60.0, 67.0, 70.0, 87.0, 98.0, 34.0, 380.0, -41.0, 130.0, 45.0, 13.0, 140.0, 100.0, 168.0, -70.0, 90.0, 20.0, 20.0, 70.0, 25.0, 168.0, 156.0, 60.0, 140.0, 40.0, 70.0, 65.0, 110.0, 80.0, 59.0, 29.0, 60.0, 70.0, 140.0, 100.0, 118.0, 50.0, 10.0, 40.0, 160.0, 70.0, 57.0, 30.0, 130.0, 280.0, 109.0, 83.0, 70.0, 70.0, 90.0, 80.0, 60.0, 58.0, 40.0, 60.0, 50.0, 160.0, 57.0, 64.0, 54.0, 80.0, 40.0, 90.0, 107.0, 64.0, 70.0, 70.0, 128.0, 66.0, 48.0, 80.0, 140.0, 90.0, 139.0, -39.0, 90.0, 141.0, 130.0, 70.0, 110.0, 265.0, 38.0, 90.0, 10.0, 15.0, 30.0, 50.0, 10.0, 30.0, 40.0, 60.0, 50.0, 10.0, 0.0, -20.0, 20.0, 80.0, 10.0, 70.0, 160.0, 80.0, 49.0, 25.0, 60.0, 130.0, 40.0, 60.0, 70.0, 100.0, 89.0, 17.0, 59.0, 110.0, 107.0, 70.0, 100.0, 108.0, 89.0, -100.0, 310.0, 60.0, 60.0, 98.0, 70.0, 15.0, 60.0, 150.0, 5.0, 60.0, 76.0, 37.0, 165.0, 147.0, 52.0, 50.0, 73.0, 145.0, 110.0, 132.0, 15.0, 100.0, 110.0, 120.0, 77.0, 10.0, 15.0, 65.0, 54.0, 160.0, 389.0, 80.0, 70.0, 94.0, 109.0, 78.0, 4.0, 118.0, 97.0, 21.0, 185.0, 60.0, 90.0, 49.0, 70.0, 60.0, 60.0, 70.0, 60.0, 90.0, 120.0, 25.0, 130.0, 69.0, 58.0, -80.0, 48.0, 560.0, 70.0, 86.0, -40.0, 100.0, 60.0, 10.0, 60.0, 110.0, 60.0, -15.0, 0.0, 90.0, 70.0, 50.0, 78.0, 165.0, 70.0, 110.0, 60.0, 140.0, 80.0, 195.0, 210.0, 73.0, 140.0, 110.0, 360.0, 80.0, 46.0, 59.0, 57.0, 90.0, 150.0, 159.0, 60.0, 40.0, 20.0, 91.0, 107.0, 44.0, 65.0, 70.0, 37.0, 70.0, 123.0, 88.0, 410.0, 100.0, 90.0, 100.0, 100.0, 10.0, 169.0, 65.0, -14.0, 120.0, 70.0, 87.0, 40.0, 200.0, 13.0, 68.0, 79.0, 40.0, 40.0, 75.0, 40.0, 20.0, 40.0, 69.0, 60.0, 100.0, 98.0, 50.0, 90.0, 90.0, 20.0, 17.0, 10.0, 256.0, -28.0, 69.0, -34.0, 50.0, 100.0, 40.0, -37.0, 10.0, 220.0, 71.0, 70.0, 130.0, 110.0, 210.0, 85.0, 310.0, 70.0, 80.0, 90.0, 40.0, 40.0, 200.0, 35.0, 30.0, 79.0, 90.0, 310.0, 70.0, 50.0, 50.0, 70.0, 596.0, 50.0, 95.0, 60.0, -19.0, 60.0, 20.0, 140.0, 70.0, 56.0, 67.0, 30.0, 59.0, 67.0, 60.0, -10.0, 110.0, 30.0, 200.0, 120.0, 280.0, 40.0, 90.0, 20.0, 80.0, 50.0, 50.0, 16.0, 85.0, 30.0, 100.0, 50.0, 40.0, 100.0, 120.0, -55.0, 76.0, 130.0, 80.0, 100.0, 52.0, 200.0, 68.0, 178.0, 40.0, 120.0, 70.0, 70.0, 25.0, 140.0, 320.0, 130.0, 30.0, 130.0, 90.0, 60.0, 37.0, -7.0, 18.0, 204.0, 70.0, 140.0, -22.0, 224.0, 40.0, 100.0, 110.0, 60.0, 120.0, -255.0, 200.0, 50.0, 35.0, 30.0, 70.0, -28.0, -11.0, 14.0, 80.0, 0.0, 22.0, 33.0, 37.0, 20.0, 50.0, 120.0, 100.0, 60.0, 55.0, 120.0, 36.0, 7.0, 170.0, 100.0, 100.0, 51.0, 35.0, 50.0, 210.0, 50.0, 20.0, 96.0, 130.0, 60.0, 0.0, 60.0, -60.0, 130.0, 130.0, 170.0, 340.0, 44.0, -10.0, 60.0, 25.0, 0.0, 30.0, 13.0, 0.0, 150.0, 59.0, 270.0, 30.0, -5.0, 90.0, 330.0, 122.0, 50.0, 115.0, 30.0, 130.0, 35.0, 89.0, 90.0, 90.0, 90.0, 56.0, 370.0, 63.0, 64.0, 76.0, 6.0, 110.0, 40.0, 0.0, 80.0, 68.0, 84.0, 80.0, 23.0, 34.0, 90.0, 60.0, 130.0, 100.0, 70.0, 70.0, 60.0, 70.0, 200.0, 110.0, 130.0, 120.0, 85.0, 50.0, 80.0, 24.0, 50.0, 35.0, 80.0, 210.0, 70.0, 38.0, 69.0, 90.0, 80.0, 70.0, 30.0, 110.0, 400.0, 40.0, -240.0, 50.0, 110.0, 170.0, 90.0, 80.0, 130.0, 670.0, 26.0, 70.0, 190.0, 110.0, 120.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9319843549240312, "mean_inference_ms": 2.186340127760972, "mean_action_processing_ms": 0.7439478968202331, "mean_env_wait_ms": 1.5275523241799938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06456112861633301, "StateBufferConnector_ms": 0.017009258270263672, "ViewRequirementAgentConnector_ms": 0.46382951736450195}, "num_episodes": 18, "episode_return_max": 1734.0, "episode_return_min": 217.0, "episode_return_mean": 837.56, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.65463026691365, "num_env_steps_trained_throughput_per_sec": 32.65463026691365, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 4920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4920000, "timers": {"training_iteration_time_ms": 123320.939, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123320.89, "sample_time_ms": 3369.396, "learn_time_ms": 119931.412, "learn_throughput": 33.352, "synch_weights_time_ms": 11.475}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "done": false, "training_iteration": 123, "trial_id": "6085c_00000", "date": "2024-07-02_03-09-52", "timestamp": 1719904192, "time_this_iter_s": 122.50368285179138, "time_total_s": 17038.216104745865, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b1d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17038.216104745865, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 20.35549132947977, "ram_util_percent": 79.4578034682081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9716613961738774, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.84712705221166, "policy_loss": -0.007200261510643787, "vf_loss": 7.853473174102263, "vf_explained_var": 0.0008880358661452548, "kl": 0.008541371101568775, "entropy": 0.5403588012162361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1159665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "env_runners": {"episode_reward_max": 1586.0, "episode_reward_min": 217.0, "episode_reward_mean": 833.36, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -255.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 83.336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [704.0, 1031.0, 622.0, 449.0, 570.0, 452.0, 1016.0, 935.0, 894.0, 474.0, 598.0, 845.0, 905.0, 837.0, 800.0, 896.0, 764.0, 977.0, 539.0, 696.0, 829.0, 928.0, 725.0, 542.0, 1059.0, 724.0, 847.0, 1268.0, 881.0, 1078.0, 841.0, 733.0, 784.0, 832.0, 986.0, 707.0, 723.0, 775.0, 1030.0, 695.0, 863.0, 1034.0, 305.0, 474.0, 735.0, 902.0, 785.0, 907.0, 1014.0, 811.0, 754.0, 872.0, 668.0, 1188.0, 1101.0, 715.0, 1150.0, 712.0, 657.0, 500.0, 1179.0, 754.0, 1332.0, 629.0, 960.0, 641.0, 869.0, 1125.0, 764.0, 520.0, 217.0, 868.0, 702.0, 889.0, 637.0, 1081.0, 875.0, 749.0, 965.0, 746.0, 820.0, 1586.0, 1110.0, 569.0, 898.0, 1316.0, 780.0, 959.0, 431.0, 999.0, 893.0, 926.0, 921.0, 833.0, 630.0, 637.0, 1345.0, 1187.0, 916.0, 940.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [66.0, 77.0, 150.0, 44.0, 31.0, 113.0, 60.0, 53.0, 80.0, 30.0, 150.0, 90.0, 130.0, 80.0, 150.0, 148.0, 90.0, 90.0, 60.0, 43.0, -30.0, 39.0, 59.0, 160.0, 25.0, 60.0, -1.0, 80.0, 160.0, 70.0, 39.0, 40.0, 40.0, 50.0, 100.0, 30.0, 50.0, 50.0, 40.0, 10.0, 60.0, 170.0, 70.0, 50.0, 50.0, 70.0, 40.0, -100.0, 70.0, 90.0, 65.0, -52.0, 110.0, 33.0, 50.0, 39.0, 10.0, 60.0, 67.0, 70.0, 247.0, 80.0, 230.0, 40.0, 50.0, 79.0, 50.0, 120.0, 80.0, 40.0, 170.0, 100.0, 50.0, 70.0, 120.0, 70.0, 120.0, 160.0, -5.0, 80.0, 90.0, 21.0, 90.0, 180.0, 100.0, 168.0, 40.0, 60.0, 100.0, 45.0, 30.0, 20.0, 50.0, 50.0, 80.0, 80.0, -65.0, 69.0, 90.0, 70.0, 97.0, 100.0, 60.0, 47.0, 139.0, 10.0, 5.0, 50.0, 60.0, 30.0, 40.0, 90.0, 0.0, 47.0, 130.0, 120.0, 0.0, 320.0, 90.0, 8.0, 90.0, 20.0, 110.0, 46.0, 80.0, 49.0, 170.0, 160.0, 50.0, 130.0, 67.0, 60.0, 40.0, 70.0, 27.0, 79.0, 86.0, 280.0, 38.0, 90.0, 57.0, 19.0, 26.0, 300.0, 40.0, 170.0, 49.0, 60.0, 29.0, 50.0, 60.0, 60.0, -10.0, 170.0, 60.0, 310.0, 60.0, 40.0, 44.0, 102.0, 16.0, -1.0, -90.0, 80.0, 80.0, 320.0, 100.0, 100.0, 80.0, 79.0, 290.0, 56.0, 79.0, 35.0, 158.0, 78.0, 56.0, 44.0, 1.0, 180.0, 60.0, 70.0, 72.0, 0.0, 45.0, 80.0, 80.0, 62.0, 20.0, 50.0, 47.0, 10.0, 150.0, 0.0, 10.0, 100.0, 79.0, 60.0, 170.0, 70.0, 26.0, 69.0, 120.0, 39.0, 36.0, 100.0, 99.0, 140.0, 140.0, 60.0, 120.0, 49.0, 80.0, 70.0, 89.0, 70.0, 140.0, 100.0, 110.0, 100.0, 155.0, 60.0, 70.0, 48.0, -121.0, 86.0, 37.0, 110.0, 110.0, 170.0, 35.0, 50.0, 40.0, 37.0, 7.0, 45.0, 50.0, 38.0, 160.0, 80.0, 99.0, 580.0, 30.0, 50.0, 20.0, 70.0, 30.0, 50.0, 40.0, 90.0, 10.0, 80.0, 41.0, 7.0, 100.0, 70.0, 50.0, 266.0, 50.0, 50.0, 80.0, 100.0, 59.0, 374.0, 95.0, 40.0, 70.0, 9.0, -30.0, 50.0, -31.0, 100.0, 190.0, 60.0, 308.0, 88.0, 80.0, 25.0, 139.0, 309.0, 90.0, 60.0, 20.0, 99.0, 60.0, 47.0, 60.0, 101.0, 300.0, 44.0, 160.0, 40.0, 130.0, 60.0, 180.0, 120.0, 180.0, 60.0, 90.0, 58.0, 100.0, 41.0, 77.0, 110.0, 80.0, 63.0, 70.0, 70.0, 140.0, 90.0, 80.0, 15.0, 71.0, 49.0, 80.0, 70.0, 47.0, 80.0, 211.0, 30.0, 74.0, 79.0, 90.0, 84.0, 209.0, 104.0, -83.0, 70.0, 89.0, 68.0, 90.0, 60.0, 181.0, 76.0, 103.0, 80.0, 45.0, 60.0, 67.0, 70.0, 87.0, 98.0, 34.0, 380.0, -41.0, 130.0, 45.0, 13.0, 140.0, 100.0, 168.0, -70.0, 90.0, 20.0, 20.0, 70.0, 25.0, 168.0, 156.0, 60.0, 140.0, 40.0, 70.0, 65.0, 110.0, 80.0, 59.0, 29.0, 60.0, 70.0, 140.0, 100.0, 118.0, 50.0, 10.0, 40.0, 160.0, 70.0, 57.0, 30.0, 130.0, 280.0, 109.0, 83.0, 70.0, 70.0, 90.0, 80.0, 60.0, 58.0, 40.0, 60.0, 50.0, 160.0, 57.0, 64.0, 54.0, 80.0, 40.0, 90.0, 107.0, 64.0, 70.0, 70.0, 128.0, 66.0, 48.0, 80.0, 140.0, 90.0, 139.0, -39.0, 90.0, 141.0, 130.0, 70.0, 110.0, 265.0, 38.0, 90.0, 10.0, 15.0, 30.0, 50.0, 10.0, 30.0, 40.0, 60.0, 50.0, 10.0, 0.0, -20.0, 20.0, 80.0, 10.0, 70.0, 160.0, 80.0, 49.0, 25.0, 60.0, 130.0, 40.0, 60.0, 70.0, 100.0, 89.0, 17.0, 59.0, 110.0, 107.0, 70.0, 100.0, 108.0, 89.0, -100.0, 310.0, 60.0, 60.0, 98.0, 70.0, 15.0, 60.0, 150.0, 5.0, 60.0, 76.0, 37.0, 165.0, 147.0, 52.0, 50.0, 73.0, 145.0, 110.0, 132.0, 15.0, 100.0, 110.0, 120.0, 77.0, 10.0, 15.0, 65.0, 54.0, 160.0, 389.0, 80.0, 70.0, 94.0, 109.0, 78.0, 4.0, 118.0, 97.0, 21.0, 185.0, 60.0, 90.0, 49.0, 70.0, 60.0, 60.0, 70.0, 60.0, 90.0, 120.0, 25.0, 130.0, 69.0, 58.0, -80.0, 48.0, 560.0, 70.0, 86.0, -40.0, 100.0, 60.0, 10.0, 60.0, 110.0, 60.0, -15.0, 0.0, 90.0, 70.0, 50.0, 78.0, 165.0, 70.0, 110.0, 60.0, 140.0, 80.0, 195.0, 210.0, 73.0, 140.0, 110.0, 360.0, 80.0, 46.0, 59.0, 57.0, 90.0, 150.0, 159.0, 60.0, 40.0, 20.0, 91.0, 107.0, 44.0, 65.0, 70.0, 37.0, 70.0, 123.0, 88.0, 410.0, 100.0, 90.0, 100.0, 100.0, 10.0, 169.0, 65.0, -14.0, 120.0, 70.0, 87.0, 40.0, 200.0, 13.0, 68.0, 79.0, 40.0, 40.0, 75.0, 40.0, 20.0, 40.0, 69.0, 60.0, 100.0, 98.0, 50.0, 90.0, 90.0, 20.0, 17.0, 10.0, 256.0, -28.0, 69.0, -34.0, 50.0, 100.0, 40.0, -37.0, 10.0, 220.0, 71.0, 70.0, 130.0, 110.0, 210.0, 85.0, 310.0, 70.0, 80.0, 90.0, 40.0, 40.0, 200.0, 35.0, 30.0, 79.0, 90.0, 310.0, 70.0, 50.0, 50.0, 70.0, 596.0, 50.0, 95.0, 60.0, -19.0, 60.0, 20.0, 140.0, 70.0, 56.0, 67.0, 30.0, 59.0, 67.0, 60.0, -10.0, 110.0, 30.0, 200.0, 120.0, 280.0, 40.0, 90.0, 20.0, 80.0, 50.0, 50.0, 16.0, 85.0, 30.0, 100.0, 50.0, 40.0, 100.0, 120.0, -55.0, 76.0, 130.0, 80.0, 100.0, 52.0, 200.0, 68.0, 178.0, 40.0, 120.0, 70.0, 70.0, 25.0, 140.0, 320.0, 130.0, 30.0, 130.0, 90.0, 60.0, 37.0, -7.0, 18.0, 204.0, 70.0, 140.0, -22.0, 224.0, 40.0, 100.0, 110.0, 60.0, 120.0, -255.0, 200.0, 50.0, 35.0, 30.0, 70.0, -28.0, -11.0, 14.0, 80.0, 0.0, 22.0, 33.0, 37.0, 20.0, 50.0, 120.0, 100.0, 60.0, 55.0, 120.0, 36.0, 7.0, 170.0, 100.0, 100.0, 51.0, 35.0, 50.0, 210.0, 50.0, 20.0, 96.0, 130.0, 60.0, 0.0, 60.0, -60.0, 130.0, 130.0, 170.0, 340.0, 44.0, -10.0, 60.0, 25.0, 0.0, 30.0, 13.0, 0.0, 150.0, 59.0, 270.0, 30.0, -5.0, 90.0, 330.0, 122.0, 50.0, 115.0, 30.0, 130.0, 35.0, 89.0, 90.0, 90.0, 90.0, 56.0, 370.0, 63.0, 64.0, 76.0, 6.0, 110.0, 40.0, 0.0, 80.0, 68.0, 84.0, 80.0, 23.0, 34.0, 90.0, 60.0, 130.0, 100.0, 70.0, 70.0, 60.0, 70.0, 200.0, 110.0, 130.0, 120.0, 85.0, 50.0, 80.0, 24.0, 50.0, 35.0, 80.0, 210.0, 70.0, 38.0, 69.0, 90.0, 80.0, 70.0, 30.0, 110.0, 400.0, 40.0, -240.0, 50.0, 110.0, 170.0, 90.0, 80.0, 130.0, 670.0, 26.0, 70.0, 190.0, 110.0, 120.0, 100.0, 460.0, 49.0, 230.0, 50.0, 100.0, -10.0, 64.0, 60.0, 55.0, 52.0, 125.0, 60.0, 9.0, -20.0, 50.0, 5.0, 18.0, 110.0, 27.0, 185.0, 70.0, 176.0, 80.0, 139.0, 90.0, 119.0, 39.0, 35.0, 100.0, 50.0, 90.0, 570.0, 26.0, 20.0, 20.0, 59.0, 320.0, 69.0, 170.0, -28.0, 30.0, 230.0, 70.0, 65.0, 100.0, -5.0, 90.0, 100.0, 70.0, 30.0, 80.0, 49.0, 14.0, 26.0, 190.0, 95.0, 95.0, 80.0, 190.0, 140.0, 70.0, 15.0, 7.0, 50.0, 46.0, 50.0, 10.0, 26.0, 100.0, 57.0, 40.0, 80.0, 160.0, 108.0, 260.0, 77.0, 180.0, 25.0, 0.0, 69.0, 70.0, 110.0, -15.0, 99.0, 80.0, 60.0, 69.0, 100.0, 200.0, 120.0, 70.0, 100.0, 2.0, 27.0, 120.0, 40.0, 260.0, 200.0, 27.0, 80.0, 10.0, 100.0, 60.0, 305.0, 70.0, 96.0, 70.0, 60.0, 80.0, 70.0, 30.0, 38.0, 110.0, 50.0, 80.0, 40.0, 60.0, 25.0, 80.0, 320.0, 120.0, 60.0, 110.0, 22.0, 45.0, 40.0, 0.0, 25.0, 70.0, 138.0, 49.0, 69.0, 80.0, 100.0, 70.0, 20.0, 50.0, 120.0, 59.0, 20.0, 70.0, 180.0, 140.0, 90.0, 80.0, 15.0, 450.0, 110.0, 150.0, 60.0, 350.0, 100.0, 130.0, 48.0, 79.0, 60.0, 100.0, 140.0, 110.0, 70.0, 40.0, 200.0, 150.0, 60.0, 40.0, -10.0, 319.0, 27.0, 80.0, 10.0, 160.0, 90.0, 110.0, 100.0, 50.0, 52.0, 110.0, -70.0, 158.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9316573436306024, "mean_inference_ms": 2.18504441715994, "mean_action_processing_ms": 0.7434570181533191, "mean_env_wait_ms": 1.5267534514854055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06519222259521484, "StateBufferConnector_ms": 0.0169064998626709, "ViewRequirementAgentConnector_ms": 0.45943760871887207}, "num_episodes": 18, "episode_return_max": 1586.0, "episode_return_min": 217.0, "episode_return_mean": 833.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.703576126752154, "num_env_steps_trained_throughput_per_sec": 32.703576126752154, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 4960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4960000, "timers": {"training_iteration_time_ms": 123340.47, "restore_workers_time_ms": 0.012, "training_step_time_ms": 123340.419, "sample_time_ms": 3397.245, "learn_time_ms": 119921.863, "learn_throughput": 33.355, "synch_weights_time_ms": 11.644}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "done": false, "training_iteration": 124, "trial_id": "6085c_00000", "date": "2024-07-02_03-11-55", "timestamp": 1719904315, "time_this_iter_s": 122.32509803771973, "time_total_s": 17160.541202783585, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b912f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17160.541202783585, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 20.865895953757228, "ram_util_percent": 79.14566473988438}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9412063976319325, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007818923832048266, "vf_loss": 7.922881826679038, "vf_explained_var": 0.00023844471246924518, "kl": Infinity, "entropy": 0.535573625567749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1169055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "env_runners": {"episode_reward_max": 1616.0, "episode_reward_min": 217.0, "episode_reward_mean": 869.81, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -255.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 86.981}, "custom_metrics": {}, "hist_stats": {"episode_reward": [542.0, 1059.0, 724.0, 847.0, 1268.0, 881.0, 1078.0, 841.0, 733.0, 784.0, 832.0, 986.0, 707.0, 723.0, 775.0, 1030.0, 695.0, 863.0, 1034.0, 305.0, 474.0, 735.0, 902.0, 785.0, 907.0, 1014.0, 811.0, 754.0, 872.0, 668.0, 1188.0, 1101.0, 715.0, 1150.0, 712.0, 657.0, 500.0, 1179.0, 754.0, 1332.0, 629.0, 960.0, 641.0, 869.0, 1125.0, 764.0, 520.0, 217.0, 868.0, 702.0, 889.0, 637.0, 1081.0, 875.0, 749.0, 965.0, 746.0, 820.0, 1586.0, 1110.0, 569.0, 898.0, 1316.0, 780.0, 959.0, 431.0, 999.0, 893.0, 926.0, 921.0, 833.0, 630.0, 637.0, 1345.0, 1187.0, 916.0, 940.0, 452.0, 1192.0, 558.0, 1156.0, 875.0, 847.0, 1436.0, 738.0, 743.0, 947.0, 897.0, 1025.0, 929.0, 1037.0, 724.0, 942.0, 758.0, 797.0, 1616.0, 1020.0, 666.0, 464.0, 1312.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [35.0, 50.0, 40.0, 37.0, 7.0, 45.0, 50.0, 38.0, 160.0, 80.0, 99.0, 580.0, 30.0, 50.0, 20.0, 70.0, 30.0, 50.0, 40.0, 90.0, 10.0, 80.0, 41.0, 7.0, 100.0, 70.0, 50.0, 266.0, 50.0, 50.0, 80.0, 100.0, 59.0, 374.0, 95.0, 40.0, 70.0, 9.0, -30.0, 50.0, -31.0, 100.0, 190.0, 60.0, 308.0, 88.0, 80.0, 25.0, 139.0, 309.0, 90.0, 60.0, 20.0, 99.0, 60.0, 47.0, 60.0, 101.0, 300.0, 44.0, 160.0, 40.0, 130.0, 60.0, 180.0, 120.0, 180.0, 60.0, 90.0, 58.0, 100.0, 41.0, 77.0, 110.0, 80.0, 63.0, 70.0, 70.0, 140.0, 90.0, 80.0, 15.0, 71.0, 49.0, 80.0, 70.0, 47.0, 80.0, 211.0, 30.0, 74.0, 79.0, 90.0, 84.0, 209.0, 104.0, -83.0, 70.0, 89.0, 68.0, 90.0, 60.0, 181.0, 76.0, 103.0, 80.0, 45.0, 60.0, 67.0, 70.0, 87.0, 98.0, 34.0, 380.0, -41.0, 130.0, 45.0, 13.0, 140.0, 100.0, 168.0, -70.0, 90.0, 20.0, 20.0, 70.0, 25.0, 168.0, 156.0, 60.0, 140.0, 40.0, 70.0, 65.0, 110.0, 80.0, 59.0, 29.0, 60.0, 70.0, 140.0, 100.0, 118.0, 50.0, 10.0, 40.0, 160.0, 70.0, 57.0, 30.0, 130.0, 280.0, 109.0, 83.0, 70.0, 70.0, 90.0, 80.0, 60.0, 58.0, 40.0, 60.0, 50.0, 160.0, 57.0, 64.0, 54.0, 80.0, 40.0, 90.0, 107.0, 64.0, 70.0, 70.0, 128.0, 66.0, 48.0, 80.0, 140.0, 90.0, 139.0, -39.0, 90.0, 141.0, 130.0, 70.0, 110.0, 265.0, 38.0, 90.0, 10.0, 15.0, 30.0, 50.0, 10.0, 30.0, 40.0, 60.0, 50.0, 10.0, 0.0, -20.0, 20.0, 80.0, 10.0, 70.0, 160.0, 80.0, 49.0, 25.0, 60.0, 130.0, 40.0, 60.0, 70.0, 100.0, 89.0, 17.0, 59.0, 110.0, 107.0, 70.0, 100.0, 108.0, 89.0, -100.0, 310.0, 60.0, 60.0, 98.0, 70.0, 15.0, 60.0, 150.0, 5.0, 60.0, 76.0, 37.0, 165.0, 147.0, 52.0, 50.0, 73.0, 145.0, 110.0, 132.0, 15.0, 100.0, 110.0, 120.0, 77.0, 10.0, 15.0, 65.0, 54.0, 160.0, 389.0, 80.0, 70.0, 94.0, 109.0, 78.0, 4.0, 118.0, 97.0, 21.0, 185.0, 60.0, 90.0, 49.0, 70.0, 60.0, 60.0, 70.0, 60.0, 90.0, 120.0, 25.0, 130.0, 69.0, 58.0, -80.0, 48.0, 560.0, 70.0, 86.0, -40.0, 100.0, 60.0, 10.0, 60.0, 110.0, 60.0, -15.0, 0.0, 90.0, 70.0, 50.0, 78.0, 165.0, 70.0, 110.0, 60.0, 140.0, 80.0, 195.0, 210.0, 73.0, 140.0, 110.0, 360.0, 80.0, 46.0, 59.0, 57.0, 90.0, 150.0, 159.0, 60.0, 40.0, 20.0, 91.0, 107.0, 44.0, 65.0, 70.0, 37.0, 70.0, 123.0, 88.0, 410.0, 100.0, 90.0, 100.0, 100.0, 10.0, 169.0, 65.0, -14.0, 120.0, 70.0, 87.0, 40.0, 200.0, 13.0, 68.0, 79.0, 40.0, 40.0, 75.0, 40.0, 20.0, 40.0, 69.0, 60.0, 100.0, 98.0, 50.0, 90.0, 90.0, 20.0, 17.0, 10.0, 256.0, -28.0, 69.0, -34.0, 50.0, 100.0, 40.0, -37.0, 10.0, 220.0, 71.0, 70.0, 130.0, 110.0, 210.0, 85.0, 310.0, 70.0, 80.0, 90.0, 40.0, 40.0, 200.0, 35.0, 30.0, 79.0, 90.0, 310.0, 70.0, 50.0, 50.0, 70.0, 596.0, 50.0, 95.0, 60.0, -19.0, 60.0, 20.0, 140.0, 70.0, 56.0, 67.0, 30.0, 59.0, 67.0, 60.0, -10.0, 110.0, 30.0, 200.0, 120.0, 280.0, 40.0, 90.0, 20.0, 80.0, 50.0, 50.0, 16.0, 85.0, 30.0, 100.0, 50.0, 40.0, 100.0, 120.0, -55.0, 76.0, 130.0, 80.0, 100.0, 52.0, 200.0, 68.0, 178.0, 40.0, 120.0, 70.0, 70.0, 25.0, 140.0, 320.0, 130.0, 30.0, 130.0, 90.0, 60.0, 37.0, -7.0, 18.0, 204.0, 70.0, 140.0, -22.0, 224.0, 40.0, 100.0, 110.0, 60.0, 120.0, -255.0, 200.0, 50.0, 35.0, 30.0, 70.0, -28.0, -11.0, 14.0, 80.0, 0.0, 22.0, 33.0, 37.0, 20.0, 50.0, 120.0, 100.0, 60.0, 55.0, 120.0, 36.0, 7.0, 170.0, 100.0, 100.0, 51.0, 35.0, 50.0, 210.0, 50.0, 20.0, 96.0, 130.0, 60.0, 0.0, 60.0, -60.0, 130.0, 130.0, 170.0, 340.0, 44.0, -10.0, 60.0, 25.0, 0.0, 30.0, 13.0, 0.0, 150.0, 59.0, 270.0, 30.0, -5.0, 90.0, 330.0, 122.0, 50.0, 115.0, 30.0, 130.0, 35.0, 89.0, 90.0, 90.0, 90.0, 56.0, 370.0, 63.0, 64.0, 76.0, 6.0, 110.0, 40.0, 0.0, 80.0, 68.0, 84.0, 80.0, 23.0, 34.0, 90.0, 60.0, 130.0, 100.0, 70.0, 70.0, 60.0, 70.0, 200.0, 110.0, 130.0, 120.0, 85.0, 50.0, 80.0, 24.0, 50.0, 35.0, 80.0, 210.0, 70.0, 38.0, 69.0, 90.0, 80.0, 70.0, 30.0, 110.0, 400.0, 40.0, -240.0, 50.0, 110.0, 170.0, 90.0, 80.0, 130.0, 670.0, 26.0, 70.0, 190.0, 110.0, 120.0, 100.0, 460.0, 49.0, 230.0, 50.0, 100.0, -10.0, 64.0, 60.0, 55.0, 52.0, 125.0, 60.0, 9.0, -20.0, 50.0, 5.0, 18.0, 110.0, 27.0, 185.0, 70.0, 176.0, 80.0, 139.0, 90.0, 119.0, 39.0, 35.0, 100.0, 50.0, 90.0, 570.0, 26.0, 20.0, 20.0, 59.0, 320.0, 69.0, 170.0, -28.0, 30.0, 230.0, 70.0, 65.0, 100.0, -5.0, 90.0, 100.0, 70.0, 30.0, 80.0, 49.0, 14.0, 26.0, 190.0, 95.0, 95.0, 80.0, 190.0, 140.0, 70.0, 15.0, 7.0, 50.0, 46.0, 50.0, 10.0, 26.0, 100.0, 57.0, 40.0, 80.0, 160.0, 108.0, 260.0, 77.0, 180.0, 25.0, 0.0, 69.0, 70.0, 110.0, -15.0, 99.0, 80.0, 60.0, 69.0, 100.0, 200.0, 120.0, 70.0, 100.0, 2.0, 27.0, 120.0, 40.0, 260.0, 200.0, 27.0, 80.0, 10.0, 100.0, 60.0, 305.0, 70.0, 96.0, 70.0, 60.0, 80.0, 70.0, 30.0, 38.0, 110.0, 50.0, 80.0, 40.0, 60.0, 25.0, 80.0, 320.0, 120.0, 60.0, 110.0, 22.0, 45.0, 40.0, 0.0, 25.0, 70.0, 138.0, 49.0, 69.0, 80.0, 100.0, 70.0, 20.0, 50.0, 120.0, 59.0, 20.0, 70.0, 180.0, 140.0, 90.0, 80.0, 15.0, 450.0, 110.0, 150.0, 60.0, 350.0, 100.0, 130.0, 48.0, 79.0, 60.0, 100.0, 140.0, 110.0, 70.0, 40.0, 200.0, 150.0, 60.0, 40.0, -10.0, 319.0, 27.0, 80.0, 10.0, 160.0, 90.0, 110.0, 100.0, 50.0, 52.0, 110.0, -70.0, 158.0, 180.0, 35.0, 125.0, -1.0, 30.0, 80.0, 39.0, 70.0, 36.0, 8.0, 30.0, 275.0, 77.0, 120.0, 100.0, 120.0, 100.0, 50.0, 130.0, 120.0, 100.0, -19.0, 70.0, -30.0, 60.0, 89.0, 40.0, 98.0, 120.0, 30.0, 100.0, 77.0, 140.0, 96.0, 58.0, 90.0, 200.0, 88.0, 268.0, 50.0, 89.0, 60.0, 53.0, 75.0, 90.0, 74.0, 60.0, 100.0, 77.0, 76.0, 210.0, 80.0, 338.0, 39.0, 0.0, 82.0, 50.0, 90.0, 99.0, 52.0, 17.0, 90.0, 128.0, 120.0, 310.0, 40.0, 90.0, 100.0, 370.0, 98.0, 90.0, 380.0, 29.0, 80.0, 70.0, 30.0, 10.0, 97.0, 30.0, -38.0, 50.0, 70.0, 130.0, 50.0, 45.0, 48.0, -8.0, 68.0, 90.0, 152.0, 98.0, 60.0, 220.0, 115.0, 33.0, 32.0, 110.0, 157.0, 30.0, 130.0, 60.0, 70.0, 40.0, 40.0, 60.0, 109.0, 70.0, 100.0, 110.0, 90.0, 208.0, 350.0, 60.0, 90.0, 90.0, 80.0, 260.0, -10.0, 40.0, -30.0, 95.0, 160.0, 70.0, 100.0, 89.0, 60.0, 110.0, 100.0, 60.0, 100.0, 80.0, 150.0, 100.0, -30.0, 30.0, 50.0, 580.0, 80.0, 67.0, -30.0, 40.0, 60.0, 160.0, 95.0, 60.0, -5.0, 140.0, 41.0, 58.0, 60.0, 55.0, 80.0, 90.0, 60.0, 60.0, 50.0, 73.0, 110.0, 60.0, 59.0, 300.0, 104.0, 30.0, 160.0, 50.0, 21.0, 62.0, -4.0, 240.0, 50.0, 45.0, 70.0, 50.0, 140.0, -32.0, 60.0, 120.0, 50.0, 110.0, 159.0, 70.0, 31.0, 190.0, 153.0, 100.0, 120.0, 490.0, 100.0, 209.0, 178.0, 45.0, 48.0, 51.0, 198.0, 20.0, 80.0, 47.0, 58.0, 388.0, 50.0, 80.0, 60.0, 40.0, 60.0, 14.0, 130.0, 14.0, 60.0, 68.0, 120.0, 100.0, 30.0, 127.0, 22.0, 39.0, 20.0, 30.0, 50.0, 26.0, 80.0, 40.0, 80.0, 40.0, 478.0, 110.0, -50.0, 84.0, 10.0, 120.0, 80.0, 360.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9308967378343909, "mean_inference_ms": 2.1828955891569954, "mean_action_processing_ms": 0.7426796185879158, "mean_env_wait_ms": 1.5254005027167312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06615233421325684, "StateBufferConnector_ms": 0.016996383666992188, "ViewRequirementAgentConnector_ms": 0.46034741401672363}, "num_episodes": 23, "episode_return_max": 1616.0, "episode_return_min": 217.0, "episode_return_mean": 869.81, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.960293377214605, "num_env_steps_trained_throughput_per_sec": 32.960293377214605, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 5000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5000000, "timers": {"training_iteration_time_ms": 123186.966, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123186.914, "sample_time_ms": 3428.812, "learn_time_ms": 119736.621, "learn_throughput": 33.407, "synch_weights_time_ms": 11.907}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "done": false, "training_iteration": 125, "trial_id": "6085c_00000", "date": "2024-07-02_03-13-56", "timestamp": 1719904436, "time_this_iter_s": 121.37229108810425, "time_total_s": 17281.91349387169, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b73940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17281.91349387169, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 20.17209302325581, "ram_util_percent": 79.46104651162791}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.858148734815839, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.02848339908547, "policy_loss": -0.007742091697661545, "vf_loss": 8.035172458959464, "vf_explained_var": -2.776642703908447e-05, "kl": 0.007020171123782693, "entropy": 0.5299431434867227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1178445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "env_runners": {"episode_reward_max": 1688.0, "episode_reward_min": 217.0, "episode_reward_mean": 898.92, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -255.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 89.892}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1034.0, 305.0, 474.0, 735.0, 902.0, 785.0, 907.0, 1014.0, 811.0, 754.0, 872.0, 668.0, 1188.0, 1101.0, 715.0, 1150.0, 712.0, 657.0, 500.0, 1179.0, 754.0, 1332.0, 629.0, 960.0, 641.0, 869.0, 1125.0, 764.0, 520.0, 217.0, 868.0, 702.0, 889.0, 637.0, 1081.0, 875.0, 749.0, 965.0, 746.0, 820.0, 1586.0, 1110.0, 569.0, 898.0, 1316.0, 780.0, 959.0, 431.0, 999.0, 893.0, 926.0, 921.0, 833.0, 630.0, 637.0, 1345.0, 1187.0, 916.0, 940.0, 452.0, 1192.0, 558.0, 1156.0, 875.0, 847.0, 1436.0, 738.0, 743.0, 947.0, 897.0, 1025.0, 929.0, 1037.0, 724.0, 942.0, 758.0, 797.0, 1616.0, 1020.0, 666.0, 464.0, 1312.0, 1688.0, 1124.0, 1279.0, 1201.0, 721.0, 816.0, 1318.0, 942.0, 632.0, 772.0, 755.0, 758.0, 885.0, 911.0, 659.0, 1524.0, 879.0, 1415.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [139.0, -39.0, 90.0, 141.0, 130.0, 70.0, 110.0, 265.0, 38.0, 90.0, 10.0, 15.0, 30.0, 50.0, 10.0, 30.0, 40.0, 60.0, 50.0, 10.0, 0.0, -20.0, 20.0, 80.0, 10.0, 70.0, 160.0, 80.0, 49.0, 25.0, 60.0, 130.0, 40.0, 60.0, 70.0, 100.0, 89.0, 17.0, 59.0, 110.0, 107.0, 70.0, 100.0, 108.0, 89.0, -100.0, 310.0, 60.0, 60.0, 98.0, 70.0, 15.0, 60.0, 150.0, 5.0, 60.0, 76.0, 37.0, 165.0, 147.0, 52.0, 50.0, 73.0, 145.0, 110.0, 132.0, 15.0, 100.0, 110.0, 120.0, 77.0, 10.0, 15.0, 65.0, 54.0, 160.0, 389.0, 80.0, 70.0, 94.0, 109.0, 78.0, 4.0, 118.0, 97.0, 21.0, 185.0, 60.0, 90.0, 49.0, 70.0, 60.0, 60.0, 70.0, 60.0, 90.0, 120.0, 25.0, 130.0, 69.0, 58.0, -80.0, 48.0, 560.0, 70.0, 86.0, -40.0, 100.0, 60.0, 10.0, 60.0, 110.0, 60.0, -15.0, 0.0, 90.0, 70.0, 50.0, 78.0, 165.0, 70.0, 110.0, 60.0, 140.0, 80.0, 195.0, 210.0, 73.0, 140.0, 110.0, 360.0, 80.0, 46.0, 59.0, 57.0, 90.0, 150.0, 159.0, 60.0, 40.0, 20.0, 91.0, 107.0, 44.0, 65.0, 70.0, 37.0, 70.0, 123.0, 88.0, 410.0, 100.0, 90.0, 100.0, 100.0, 10.0, 169.0, 65.0, -14.0, 120.0, 70.0, 87.0, 40.0, 200.0, 13.0, 68.0, 79.0, 40.0, 40.0, 75.0, 40.0, 20.0, 40.0, 69.0, 60.0, 100.0, 98.0, 50.0, 90.0, 90.0, 20.0, 17.0, 10.0, 256.0, -28.0, 69.0, -34.0, 50.0, 100.0, 40.0, -37.0, 10.0, 220.0, 71.0, 70.0, 130.0, 110.0, 210.0, 85.0, 310.0, 70.0, 80.0, 90.0, 40.0, 40.0, 200.0, 35.0, 30.0, 79.0, 90.0, 310.0, 70.0, 50.0, 50.0, 70.0, 596.0, 50.0, 95.0, 60.0, -19.0, 60.0, 20.0, 140.0, 70.0, 56.0, 67.0, 30.0, 59.0, 67.0, 60.0, -10.0, 110.0, 30.0, 200.0, 120.0, 280.0, 40.0, 90.0, 20.0, 80.0, 50.0, 50.0, 16.0, 85.0, 30.0, 100.0, 50.0, 40.0, 100.0, 120.0, -55.0, 76.0, 130.0, 80.0, 100.0, 52.0, 200.0, 68.0, 178.0, 40.0, 120.0, 70.0, 70.0, 25.0, 140.0, 320.0, 130.0, 30.0, 130.0, 90.0, 60.0, 37.0, -7.0, 18.0, 204.0, 70.0, 140.0, -22.0, 224.0, 40.0, 100.0, 110.0, 60.0, 120.0, -255.0, 200.0, 50.0, 35.0, 30.0, 70.0, -28.0, -11.0, 14.0, 80.0, 0.0, 22.0, 33.0, 37.0, 20.0, 50.0, 120.0, 100.0, 60.0, 55.0, 120.0, 36.0, 7.0, 170.0, 100.0, 100.0, 51.0, 35.0, 50.0, 210.0, 50.0, 20.0, 96.0, 130.0, 60.0, 0.0, 60.0, -60.0, 130.0, 130.0, 170.0, 340.0, 44.0, -10.0, 60.0, 25.0, 0.0, 30.0, 13.0, 0.0, 150.0, 59.0, 270.0, 30.0, -5.0, 90.0, 330.0, 122.0, 50.0, 115.0, 30.0, 130.0, 35.0, 89.0, 90.0, 90.0, 90.0, 56.0, 370.0, 63.0, 64.0, 76.0, 6.0, 110.0, 40.0, 0.0, 80.0, 68.0, 84.0, 80.0, 23.0, 34.0, 90.0, 60.0, 130.0, 100.0, 70.0, 70.0, 60.0, 70.0, 200.0, 110.0, 130.0, 120.0, 85.0, 50.0, 80.0, 24.0, 50.0, 35.0, 80.0, 210.0, 70.0, 38.0, 69.0, 90.0, 80.0, 70.0, 30.0, 110.0, 400.0, 40.0, -240.0, 50.0, 110.0, 170.0, 90.0, 80.0, 130.0, 670.0, 26.0, 70.0, 190.0, 110.0, 120.0, 100.0, 460.0, 49.0, 230.0, 50.0, 100.0, -10.0, 64.0, 60.0, 55.0, 52.0, 125.0, 60.0, 9.0, -20.0, 50.0, 5.0, 18.0, 110.0, 27.0, 185.0, 70.0, 176.0, 80.0, 139.0, 90.0, 119.0, 39.0, 35.0, 100.0, 50.0, 90.0, 570.0, 26.0, 20.0, 20.0, 59.0, 320.0, 69.0, 170.0, -28.0, 30.0, 230.0, 70.0, 65.0, 100.0, -5.0, 90.0, 100.0, 70.0, 30.0, 80.0, 49.0, 14.0, 26.0, 190.0, 95.0, 95.0, 80.0, 190.0, 140.0, 70.0, 15.0, 7.0, 50.0, 46.0, 50.0, 10.0, 26.0, 100.0, 57.0, 40.0, 80.0, 160.0, 108.0, 260.0, 77.0, 180.0, 25.0, 0.0, 69.0, 70.0, 110.0, -15.0, 99.0, 80.0, 60.0, 69.0, 100.0, 200.0, 120.0, 70.0, 100.0, 2.0, 27.0, 120.0, 40.0, 260.0, 200.0, 27.0, 80.0, 10.0, 100.0, 60.0, 305.0, 70.0, 96.0, 70.0, 60.0, 80.0, 70.0, 30.0, 38.0, 110.0, 50.0, 80.0, 40.0, 60.0, 25.0, 80.0, 320.0, 120.0, 60.0, 110.0, 22.0, 45.0, 40.0, 0.0, 25.0, 70.0, 138.0, 49.0, 69.0, 80.0, 100.0, 70.0, 20.0, 50.0, 120.0, 59.0, 20.0, 70.0, 180.0, 140.0, 90.0, 80.0, 15.0, 450.0, 110.0, 150.0, 60.0, 350.0, 100.0, 130.0, 48.0, 79.0, 60.0, 100.0, 140.0, 110.0, 70.0, 40.0, 200.0, 150.0, 60.0, 40.0, -10.0, 319.0, 27.0, 80.0, 10.0, 160.0, 90.0, 110.0, 100.0, 50.0, 52.0, 110.0, -70.0, 158.0, 180.0, 35.0, 125.0, -1.0, 30.0, 80.0, 39.0, 70.0, 36.0, 8.0, 30.0, 275.0, 77.0, 120.0, 100.0, 120.0, 100.0, 50.0, 130.0, 120.0, 100.0, -19.0, 70.0, -30.0, 60.0, 89.0, 40.0, 98.0, 120.0, 30.0, 100.0, 77.0, 140.0, 96.0, 58.0, 90.0, 200.0, 88.0, 268.0, 50.0, 89.0, 60.0, 53.0, 75.0, 90.0, 74.0, 60.0, 100.0, 77.0, 76.0, 210.0, 80.0, 338.0, 39.0, 0.0, 82.0, 50.0, 90.0, 99.0, 52.0, 17.0, 90.0, 128.0, 120.0, 310.0, 40.0, 90.0, 100.0, 370.0, 98.0, 90.0, 380.0, 29.0, 80.0, 70.0, 30.0, 10.0, 97.0, 30.0, -38.0, 50.0, 70.0, 130.0, 50.0, 45.0, 48.0, -8.0, 68.0, 90.0, 152.0, 98.0, 60.0, 220.0, 115.0, 33.0, 32.0, 110.0, 157.0, 30.0, 130.0, 60.0, 70.0, 40.0, 40.0, 60.0, 109.0, 70.0, 100.0, 110.0, 90.0, 208.0, 350.0, 60.0, 90.0, 90.0, 80.0, 260.0, -10.0, 40.0, -30.0, 95.0, 160.0, 70.0, 100.0, 89.0, 60.0, 110.0, 100.0, 60.0, 100.0, 80.0, 150.0, 100.0, -30.0, 30.0, 50.0, 580.0, 80.0, 67.0, -30.0, 40.0, 60.0, 160.0, 95.0, 60.0, -5.0, 140.0, 41.0, 58.0, 60.0, 55.0, 80.0, 90.0, 60.0, 60.0, 50.0, 73.0, 110.0, 60.0, 59.0, 300.0, 104.0, 30.0, 160.0, 50.0, 21.0, 62.0, -4.0, 240.0, 50.0, 45.0, 70.0, 50.0, 140.0, -32.0, 60.0, 120.0, 50.0, 110.0, 159.0, 70.0, 31.0, 190.0, 153.0, 100.0, 120.0, 490.0, 100.0, 209.0, 178.0, 45.0, 48.0, 51.0, 198.0, 20.0, 80.0, 47.0, 58.0, 388.0, 50.0, 80.0, 60.0, 40.0, 60.0, 14.0, 130.0, 14.0, 60.0, 68.0, 120.0, 100.0, 30.0, 127.0, 22.0, 39.0, 20.0, 30.0, 50.0, 26.0, 80.0, 40.0, 80.0, 40.0, 478.0, 110.0, -50.0, 84.0, 10.0, 120.0, 80.0, 360.0, -20.0, 60.0, 500.0, 110.0, 89.0, 100.0, 85.0, 520.0, 74.0, 170.0, 100.0, 160.0, 76.0, 58.0, -5.0, 70.0, 510.0, 160.0, 45.0, -50.0, 130.0, 110.0, 40.0, 380.0, 80.0, 75.0, 150.0, 160.0, 100.0, 54.0, 210.0, -19.0, 150.0, 43.0, 55.0, 480.0, 66.0, -30.0, 176.0, 70.0, 118.0, 70.0, 190.0, 40.0, 23.0, -2.0, 59.0, 120.0, 54.0, 49.0, 100.0, 90.0, 80.0, 60.0, 90.0, 108.0, 70.0, 79.0, 59.0, 80.0, 120.0, 100.0, 40.0, 60.0, 40.0, 10.0, 50.0, 630.0, 169.0, 99.0, 50.0, -20.0, 306.0, 46.0, 50.0, 40.0, 270.0, -130.0, 110.0, 220.0, 35.0, -95.0, 175.0, 30.0, 169.0, 100.0, 8.0, 20.0, 25.0, 165.0, 263.0, -50.0, 100.0, 20.0, 110.0, 110.0, 150.0, 30.0, -21.0, 60.0, 80.0, 90.0, 90.0, 15.0, 20.0, 80.0, 110.0, 100.0, 80.0, 90.0, 13.0, 50.0, 36.0, 80.0, 50.0, 180.0, 80.0, 170.0, 90.0, 9.0, 50.0, 90.0, 215.0, 40.0, 68.0, 110.0, 50.0, 62.0, 50.0, 150.0, 120.0, 159.0, 99.0, 110.0, 120.0, 70.0, 17.0, 60.0, 123.0, 33.0, 39.0, 40.0, 50.0, 130.0, 60.0, 30.0, 70.0, 60.0, 100.0, 80.0, 110.0, 454.0, 58.0, 0.0, 45.0, 389.0, 80.0, 100.0, 78.0, 210.0, 20.0, 41.0, 58.0, 30.0, 40.0, 100.0, 230.0, 20.0, 230.0, 110.0, 73.0, 80.0, 127.0, 80.0, 147.0, 337.0, 306.0, 80.0, -5.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9299419355132017, "mean_inference_ms": 2.1810707694633127, "mean_action_processing_ms": 0.7420703332306036, "mean_env_wait_ms": 1.5242326567054745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06462478637695312, "StateBufferConnector_ms": 0.016036510467529297, "ViewRequirementAgentConnector_ms": 0.45203709602355957}, "num_episodes": 18, "episode_return_max": 1688.0, "episode_return_min": 217.0, "episode_return_mean": 898.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.83542356612847, "num_env_steps_trained_throughput_per_sec": 32.83542356612847, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 5040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5040000, "timers": {"training_iteration_time_ms": 123024.55, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123024.498, "sample_time_ms": 3431.667, "learn_time_ms": 119571.305, "learn_throughput": 33.453, "synch_weights_time_ms": 11.787}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "done": false, "training_iteration": 126, "trial_id": "6085c_00000", "date": "2024-07-02_03-15-58", "timestamp": 1719904558, "time_this_iter_s": 121.83221197128296, "time_total_s": 17403.74570584297, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138aa7940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17403.74570584297, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 20.41686046511628, "ram_util_percent": 79.08895348837208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.959307996457377, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.893607994796623, "policy_loss": -0.00707470794370511, "vf_loss": 7.899562681114839, "vf_explained_var": 5.531868360801754e-05, "kl": 0.007466860035686931, "entropy": 0.5240356694490383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1187835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "env_runners": {"episode_reward_max": 1724.0, "episode_reward_min": 217.0, "episode_reward_mean": 937.39, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -255.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 93.739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [629.0, 960.0, 641.0, 869.0, 1125.0, 764.0, 520.0, 217.0, 868.0, 702.0, 889.0, 637.0, 1081.0, 875.0, 749.0, 965.0, 746.0, 820.0, 1586.0, 1110.0, 569.0, 898.0, 1316.0, 780.0, 959.0, 431.0, 999.0, 893.0, 926.0, 921.0, 833.0, 630.0, 637.0, 1345.0, 1187.0, 916.0, 940.0, 452.0, 1192.0, 558.0, 1156.0, 875.0, 847.0, 1436.0, 738.0, 743.0, 947.0, 897.0, 1025.0, 929.0, 1037.0, 724.0, 942.0, 758.0, 797.0, 1616.0, 1020.0, 666.0, 464.0, 1312.0, 1688.0, 1124.0, 1279.0, 1201.0, 721.0, 816.0, 1318.0, 942.0, 632.0, 772.0, 755.0, 758.0, 885.0, 911.0, 659.0, 1524.0, 879.0, 1415.0, 1250.0, 817.0, 906.0, 1326.0, 959.0, 704.0, 590.0, 1190.0, 849.0, 737.0, 1464.0, 590.0, 998.0, 1201.0, 1093.0, 818.0, 687.0, 1724.0, 1355.0, 1142.0, 1103.0, 893.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 20.0, 140.0, 70.0, 56.0, 67.0, 30.0, 59.0, 67.0, 60.0, -10.0, 110.0, 30.0, 200.0, 120.0, 280.0, 40.0, 90.0, 20.0, 80.0, 50.0, 50.0, 16.0, 85.0, 30.0, 100.0, 50.0, 40.0, 100.0, 120.0, -55.0, 76.0, 130.0, 80.0, 100.0, 52.0, 200.0, 68.0, 178.0, 40.0, 120.0, 70.0, 70.0, 25.0, 140.0, 320.0, 130.0, 30.0, 130.0, 90.0, 60.0, 37.0, -7.0, 18.0, 204.0, 70.0, 140.0, -22.0, 224.0, 40.0, 100.0, 110.0, 60.0, 120.0, -255.0, 200.0, 50.0, 35.0, 30.0, 70.0, -28.0, -11.0, 14.0, 80.0, 0.0, 22.0, 33.0, 37.0, 20.0, 50.0, 120.0, 100.0, 60.0, 55.0, 120.0, 36.0, 7.0, 170.0, 100.0, 100.0, 51.0, 35.0, 50.0, 210.0, 50.0, 20.0, 96.0, 130.0, 60.0, 0.0, 60.0, -60.0, 130.0, 130.0, 170.0, 340.0, 44.0, -10.0, 60.0, 25.0, 0.0, 30.0, 13.0, 0.0, 150.0, 59.0, 270.0, 30.0, -5.0, 90.0, 330.0, 122.0, 50.0, 115.0, 30.0, 130.0, 35.0, 89.0, 90.0, 90.0, 90.0, 56.0, 370.0, 63.0, 64.0, 76.0, 6.0, 110.0, 40.0, 0.0, 80.0, 68.0, 84.0, 80.0, 23.0, 34.0, 90.0, 60.0, 130.0, 100.0, 70.0, 70.0, 60.0, 70.0, 200.0, 110.0, 130.0, 120.0, 85.0, 50.0, 80.0, 24.0, 50.0, 35.0, 80.0, 210.0, 70.0, 38.0, 69.0, 90.0, 80.0, 70.0, 30.0, 110.0, 400.0, 40.0, -240.0, 50.0, 110.0, 170.0, 90.0, 80.0, 130.0, 670.0, 26.0, 70.0, 190.0, 110.0, 120.0, 100.0, 460.0, 49.0, 230.0, 50.0, 100.0, -10.0, 64.0, 60.0, 55.0, 52.0, 125.0, 60.0, 9.0, -20.0, 50.0, 5.0, 18.0, 110.0, 27.0, 185.0, 70.0, 176.0, 80.0, 139.0, 90.0, 119.0, 39.0, 35.0, 100.0, 50.0, 90.0, 570.0, 26.0, 20.0, 20.0, 59.0, 320.0, 69.0, 170.0, -28.0, 30.0, 230.0, 70.0, 65.0, 100.0, -5.0, 90.0, 100.0, 70.0, 30.0, 80.0, 49.0, 14.0, 26.0, 190.0, 95.0, 95.0, 80.0, 190.0, 140.0, 70.0, 15.0, 7.0, 50.0, 46.0, 50.0, 10.0, 26.0, 100.0, 57.0, 40.0, 80.0, 160.0, 108.0, 260.0, 77.0, 180.0, 25.0, 0.0, 69.0, 70.0, 110.0, -15.0, 99.0, 80.0, 60.0, 69.0, 100.0, 200.0, 120.0, 70.0, 100.0, 2.0, 27.0, 120.0, 40.0, 260.0, 200.0, 27.0, 80.0, 10.0, 100.0, 60.0, 305.0, 70.0, 96.0, 70.0, 60.0, 80.0, 70.0, 30.0, 38.0, 110.0, 50.0, 80.0, 40.0, 60.0, 25.0, 80.0, 320.0, 120.0, 60.0, 110.0, 22.0, 45.0, 40.0, 0.0, 25.0, 70.0, 138.0, 49.0, 69.0, 80.0, 100.0, 70.0, 20.0, 50.0, 120.0, 59.0, 20.0, 70.0, 180.0, 140.0, 90.0, 80.0, 15.0, 450.0, 110.0, 150.0, 60.0, 350.0, 100.0, 130.0, 48.0, 79.0, 60.0, 100.0, 140.0, 110.0, 70.0, 40.0, 200.0, 150.0, 60.0, 40.0, -10.0, 319.0, 27.0, 80.0, 10.0, 160.0, 90.0, 110.0, 100.0, 50.0, 52.0, 110.0, -70.0, 158.0, 180.0, 35.0, 125.0, -1.0, 30.0, 80.0, 39.0, 70.0, 36.0, 8.0, 30.0, 275.0, 77.0, 120.0, 100.0, 120.0, 100.0, 50.0, 130.0, 120.0, 100.0, -19.0, 70.0, -30.0, 60.0, 89.0, 40.0, 98.0, 120.0, 30.0, 100.0, 77.0, 140.0, 96.0, 58.0, 90.0, 200.0, 88.0, 268.0, 50.0, 89.0, 60.0, 53.0, 75.0, 90.0, 74.0, 60.0, 100.0, 77.0, 76.0, 210.0, 80.0, 338.0, 39.0, 0.0, 82.0, 50.0, 90.0, 99.0, 52.0, 17.0, 90.0, 128.0, 120.0, 310.0, 40.0, 90.0, 100.0, 370.0, 98.0, 90.0, 380.0, 29.0, 80.0, 70.0, 30.0, 10.0, 97.0, 30.0, -38.0, 50.0, 70.0, 130.0, 50.0, 45.0, 48.0, -8.0, 68.0, 90.0, 152.0, 98.0, 60.0, 220.0, 115.0, 33.0, 32.0, 110.0, 157.0, 30.0, 130.0, 60.0, 70.0, 40.0, 40.0, 60.0, 109.0, 70.0, 100.0, 110.0, 90.0, 208.0, 350.0, 60.0, 90.0, 90.0, 80.0, 260.0, -10.0, 40.0, -30.0, 95.0, 160.0, 70.0, 100.0, 89.0, 60.0, 110.0, 100.0, 60.0, 100.0, 80.0, 150.0, 100.0, -30.0, 30.0, 50.0, 580.0, 80.0, 67.0, -30.0, 40.0, 60.0, 160.0, 95.0, 60.0, -5.0, 140.0, 41.0, 58.0, 60.0, 55.0, 80.0, 90.0, 60.0, 60.0, 50.0, 73.0, 110.0, 60.0, 59.0, 300.0, 104.0, 30.0, 160.0, 50.0, 21.0, 62.0, -4.0, 240.0, 50.0, 45.0, 70.0, 50.0, 140.0, -32.0, 60.0, 120.0, 50.0, 110.0, 159.0, 70.0, 31.0, 190.0, 153.0, 100.0, 120.0, 490.0, 100.0, 209.0, 178.0, 45.0, 48.0, 51.0, 198.0, 20.0, 80.0, 47.0, 58.0, 388.0, 50.0, 80.0, 60.0, 40.0, 60.0, 14.0, 130.0, 14.0, 60.0, 68.0, 120.0, 100.0, 30.0, 127.0, 22.0, 39.0, 20.0, 30.0, 50.0, 26.0, 80.0, 40.0, 80.0, 40.0, 478.0, 110.0, -50.0, 84.0, 10.0, 120.0, 80.0, 360.0, -20.0, 60.0, 500.0, 110.0, 89.0, 100.0, 85.0, 520.0, 74.0, 170.0, 100.0, 160.0, 76.0, 58.0, -5.0, 70.0, 510.0, 160.0, 45.0, -50.0, 130.0, 110.0, 40.0, 380.0, 80.0, 75.0, 150.0, 160.0, 100.0, 54.0, 210.0, -19.0, 150.0, 43.0, 55.0, 480.0, 66.0, -30.0, 176.0, 70.0, 118.0, 70.0, 190.0, 40.0, 23.0, -2.0, 59.0, 120.0, 54.0, 49.0, 100.0, 90.0, 80.0, 60.0, 90.0, 108.0, 70.0, 79.0, 59.0, 80.0, 120.0, 100.0, 40.0, 60.0, 40.0, 10.0, 50.0, 630.0, 169.0, 99.0, 50.0, -20.0, 306.0, 46.0, 50.0, 40.0, 270.0, -130.0, 110.0, 220.0, 35.0, -95.0, 175.0, 30.0, 169.0, 100.0, 8.0, 20.0, 25.0, 165.0, 263.0, -50.0, 100.0, 20.0, 110.0, 110.0, 150.0, 30.0, -21.0, 60.0, 80.0, 90.0, 90.0, 15.0, 20.0, 80.0, 110.0, 100.0, 80.0, 90.0, 13.0, 50.0, 36.0, 80.0, 50.0, 180.0, 80.0, 170.0, 90.0, 9.0, 50.0, 90.0, 215.0, 40.0, 68.0, 110.0, 50.0, 62.0, 50.0, 150.0, 120.0, 159.0, 99.0, 110.0, 120.0, 70.0, 17.0, 60.0, 123.0, 33.0, 39.0, 40.0, 50.0, 130.0, 60.0, 30.0, 70.0, 60.0, 100.0, 80.0, 110.0, 454.0, 58.0, 0.0, 45.0, 389.0, 80.0, 100.0, 78.0, 210.0, 20.0, 41.0, 58.0, 30.0, 40.0, 100.0, 230.0, 20.0, 230.0, 110.0, 73.0, 80.0, 127.0, 80.0, 147.0, 337.0, 306.0, 80.0, -5.0, 190.0, 90.0, 110.0, 100.0, 110.0, 40.0, 320.0, 300.0, 50.0, 30.0, 100.0, 100.0, 110.0, 31.0, 110.0, 70.0, 60.0, 110.0, 80.0, 76.0, 70.0, 110.0, 60.0, 70.0, 130.0, 50.0, 110.0, 52.0, 290.0, 9.0, 25.0, 70.0, 117.0, 90.0, 73.0, 87.0, 330.0, 220.0, 30.0, 320.0, -11.0, 19.0, 10.0, 60.0, 50.0, 70.0, 80.0, 530.0, -40.0, 90.0, 90.0, -50.0, 85.0, 140.0, 60.0, 89.0, 110.0, 40.0, 60.0, 110.0, 60.0, 60.0, 0.0, 20.0, 70.0, 90.0, 30.0, 60.0, 150.0, 70.0, 40.0, 360.0, 120.0, 140.0, 60.0, 70.0, 120.0, 80.0, 40.0, 120.0, 80.0, 109.0, 60.0, 180.0, 90.0, 100.0, 70.0, 166.0, 40.0, 18.0, 16.0, 50.0, 35.0, 80.0, 80.0, 120.0, 10.0, 87.0, 147.0, 30.0, 98.0, 115.0, 34.0, 470.0, 50.0, -11.0, 100.0, 70.0, 66.0, 270.0, 300.0, 24.0, 60.0, 30.0, 210.0, -6.0, -7.0, 50.0, 9.0, 140.0, 80.0, 100.0, 480.0, 60.0, 95.0, 110.0, 38.0, -65.0, 60.0, 40.0, 80.0, 520.0, 110.0, 250.0, 90.0, -58.0, 50.0, 100.0, 19.0, 90.0, 30.0, 89.0, 78.0, 102.0, 130.0, 140.0, 100.0, 100.0, 90.0, 44.0, 220.0, 248.0, 180.0, 50.0, 60.0, -4.0, 31.0, -11.0, 103.0, -25.0, 186.0, 70.0, 150.0, 60.0, 70.0, 18.0, -22.0, 21.0, 15.0, 120.0, 185.0, 620.0, 120.0, 370.0, 310.0, 120.0, 80.0, -45.0, 100.0, 90.0, -41.0, 70.0, 120.0, 80.0, 100.0, 50.0, 630.0, 90.0, 100.0, 60.0, 55.0, 510.0, 110.0, 44.0, 120.0, -16.0, 45.0, 90.0, 110.0, 80.0, 49.0, 80.0, 30.0, 103.0, 90.0, 80.0, 60.0, 410.0, 50.0, 110.0, 90.0, 48.0, 63.0, -50.0, -11.0, 130.0, 30.0, 303.0, 76.0, 60.0, 244.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9287910932813923, "mean_inference_ms": 2.1789271697191683, "mean_action_processing_ms": 0.7412994713919445, "mean_env_wait_ms": 1.522855682116424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0665140151977539, "StateBufferConnector_ms": 0.010123252868652344, "ViewRequirementAgentConnector_ms": 0.4515085220336914}, "num_episodes": 22, "episode_return_max": 1724.0, "episode_return_min": 217.0, "episode_return_mean": 937.39, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.17998685346404, "num_env_steps_trained_throughput_per_sec": 32.17998685346404, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 5080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5080000, "timers": {"training_iteration_time_ms": 123047.862, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123047.81, "sample_time_ms": 3422.081, "learn_time_ms": 119603.452, "learn_throughput": 33.444, "synch_weights_time_ms": 12.54}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "done": false, "training_iteration": 127, "trial_id": "6085c_00000", "date": "2024-07-02_03-18-02", "timestamp": 1719904682, "time_this_iter_s": 124.31865382194519, "time_total_s": 17528.064359664917, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c93430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17528.064359664917, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 22.243750000000002, "ram_util_percent": 81.01818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9353580479487316, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.7057052712344, "policy_loss": -0.0065022733249960425, "vf_loss": 7.711122605594964, "vf_explained_var": -0.000566930251634413, "kl": 0.007232874165458415, "entropy": 0.555817845574837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1197225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "env_runners": {"episode_reward_max": 1724.0, "episode_reward_min": 431.0, "episode_reward_mean": 954.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -220.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 95.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1586.0, 1110.0, 569.0, 898.0, 1316.0, 780.0, 959.0, 431.0, 999.0, 893.0, 926.0, 921.0, 833.0, 630.0, 637.0, 1345.0, 1187.0, 916.0, 940.0, 452.0, 1192.0, 558.0, 1156.0, 875.0, 847.0, 1436.0, 738.0, 743.0, 947.0, 897.0, 1025.0, 929.0, 1037.0, 724.0, 942.0, 758.0, 797.0, 1616.0, 1020.0, 666.0, 464.0, 1312.0, 1688.0, 1124.0, 1279.0, 1201.0, 721.0, 816.0, 1318.0, 942.0, 632.0, 772.0, 755.0, 758.0, 885.0, 911.0, 659.0, 1524.0, 879.0, 1415.0, 1250.0, 817.0, 906.0, 1326.0, 959.0, 704.0, 590.0, 1190.0, 849.0, 737.0, 1464.0, 590.0, 998.0, 1201.0, 1093.0, 818.0, 687.0, 1724.0, 1355.0, 1142.0, 1103.0, 893.0, 655.0, 1369.0, 1049.0, 649.0, 870.0, 803.0, 797.0, 491.0, 559.0, 857.0, 860.0, 1111.0, 579.0, 1085.0, 603.0, 1264.0, 1295.0, 857.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 80.0, 130.0, 670.0, 26.0, 70.0, 190.0, 110.0, 120.0, 100.0, 460.0, 49.0, 230.0, 50.0, 100.0, -10.0, 64.0, 60.0, 55.0, 52.0, 125.0, 60.0, 9.0, -20.0, 50.0, 5.0, 18.0, 110.0, 27.0, 185.0, 70.0, 176.0, 80.0, 139.0, 90.0, 119.0, 39.0, 35.0, 100.0, 50.0, 90.0, 570.0, 26.0, 20.0, 20.0, 59.0, 320.0, 69.0, 170.0, -28.0, 30.0, 230.0, 70.0, 65.0, 100.0, -5.0, 90.0, 100.0, 70.0, 30.0, 80.0, 49.0, 14.0, 26.0, 190.0, 95.0, 95.0, 80.0, 190.0, 140.0, 70.0, 15.0, 7.0, 50.0, 46.0, 50.0, 10.0, 26.0, 100.0, 57.0, 40.0, 80.0, 160.0, 108.0, 260.0, 77.0, 180.0, 25.0, 0.0, 69.0, 70.0, 110.0, -15.0, 99.0, 80.0, 60.0, 69.0, 100.0, 200.0, 120.0, 70.0, 100.0, 2.0, 27.0, 120.0, 40.0, 260.0, 200.0, 27.0, 80.0, 10.0, 100.0, 60.0, 305.0, 70.0, 96.0, 70.0, 60.0, 80.0, 70.0, 30.0, 38.0, 110.0, 50.0, 80.0, 40.0, 60.0, 25.0, 80.0, 320.0, 120.0, 60.0, 110.0, 22.0, 45.0, 40.0, 0.0, 25.0, 70.0, 138.0, 49.0, 69.0, 80.0, 100.0, 70.0, 20.0, 50.0, 120.0, 59.0, 20.0, 70.0, 180.0, 140.0, 90.0, 80.0, 15.0, 450.0, 110.0, 150.0, 60.0, 350.0, 100.0, 130.0, 48.0, 79.0, 60.0, 100.0, 140.0, 110.0, 70.0, 40.0, 200.0, 150.0, 60.0, 40.0, -10.0, 319.0, 27.0, 80.0, 10.0, 160.0, 90.0, 110.0, 100.0, 50.0, 52.0, 110.0, -70.0, 158.0, 180.0, 35.0, 125.0, -1.0, 30.0, 80.0, 39.0, 70.0, 36.0, 8.0, 30.0, 275.0, 77.0, 120.0, 100.0, 120.0, 100.0, 50.0, 130.0, 120.0, 100.0, -19.0, 70.0, -30.0, 60.0, 89.0, 40.0, 98.0, 120.0, 30.0, 100.0, 77.0, 140.0, 96.0, 58.0, 90.0, 200.0, 88.0, 268.0, 50.0, 89.0, 60.0, 53.0, 75.0, 90.0, 74.0, 60.0, 100.0, 77.0, 76.0, 210.0, 80.0, 338.0, 39.0, 0.0, 82.0, 50.0, 90.0, 99.0, 52.0, 17.0, 90.0, 128.0, 120.0, 310.0, 40.0, 90.0, 100.0, 370.0, 98.0, 90.0, 380.0, 29.0, 80.0, 70.0, 30.0, 10.0, 97.0, 30.0, -38.0, 50.0, 70.0, 130.0, 50.0, 45.0, 48.0, -8.0, 68.0, 90.0, 152.0, 98.0, 60.0, 220.0, 115.0, 33.0, 32.0, 110.0, 157.0, 30.0, 130.0, 60.0, 70.0, 40.0, 40.0, 60.0, 109.0, 70.0, 100.0, 110.0, 90.0, 208.0, 350.0, 60.0, 90.0, 90.0, 80.0, 260.0, -10.0, 40.0, -30.0, 95.0, 160.0, 70.0, 100.0, 89.0, 60.0, 110.0, 100.0, 60.0, 100.0, 80.0, 150.0, 100.0, -30.0, 30.0, 50.0, 580.0, 80.0, 67.0, -30.0, 40.0, 60.0, 160.0, 95.0, 60.0, -5.0, 140.0, 41.0, 58.0, 60.0, 55.0, 80.0, 90.0, 60.0, 60.0, 50.0, 73.0, 110.0, 60.0, 59.0, 300.0, 104.0, 30.0, 160.0, 50.0, 21.0, 62.0, -4.0, 240.0, 50.0, 45.0, 70.0, 50.0, 140.0, -32.0, 60.0, 120.0, 50.0, 110.0, 159.0, 70.0, 31.0, 190.0, 153.0, 100.0, 120.0, 490.0, 100.0, 209.0, 178.0, 45.0, 48.0, 51.0, 198.0, 20.0, 80.0, 47.0, 58.0, 388.0, 50.0, 80.0, 60.0, 40.0, 60.0, 14.0, 130.0, 14.0, 60.0, 68.0, 120.0, 100.0, 30.0, 127.0, 22.0, 39.0, 20.0, 30.0, 50.0, 26.0, 80.0, 40.0, 80.0, 40.0, 478.0, 110.0, -50.0, 84.0, 10.0, 120.0, 80.0, 360.0, -20.0, 60.0, 500.0, 110.0, 89.0, 100.0, 85.0, 520.0, 74.0, 170.0, 100.0, 160.0, 76.0, 58.0, -5.0, 70.0, 510.0, 160.0, 45.0, -50.0, 130.0, 110.0, 40.0, 380.0, 80.0, 75.0, 150.0, 160.0, 100.0, 54.0, 210.0, -19.0, 150.0, 43.0, 55.0, 480.0, 66.0, -30.0, 176.0, 70.0, 118.0, 70.0, 190.0, 40.0, 23.0, -2.0, 59.0, 120.0, 54.0, 49.0, 100.0, 90.0, 80.0, 60.0, 90.0, 108.0, 70.0, 79.0, 59.0, 80.0, 120.0, 100.0, 40.0, 60.0, 40.0, 10.0, 50.0, 630.0, 169.0, 99.0, 50.0, -20.0, 306.0, 46.0, 50.0, 40.0, 270.0, -130.0, 110.0, 220.0, 35.0, -95.0, 175.0, 30.0, 169.0, 100.0, 8.0, 20.0, 25.0, 165.0, 263.0, -50.0, 100.0, 20.0, 110.0, 110.0, 150.0, 30.0, -21.0, 60.0, 80.0, 90.0, 90.0, 15.0, 20.0, 80.0, 110.0, 100.0, 80.0, 90.0, 13.0, 50.0, 36.0, 80.0, 50.0, 180.0, 80.0, 170.0, 90.0, 9.0, 50.0, 90.0, 215.0, 40.0, 68.0, 110.0, 50.0, 62.0, 50.0, 150.0, 120.0, 159.0, 99.0, 110.0, 120.0, 70.0, 17.0, 60.0, 123.0, 33.0, 39.0, 40.0, 50.0, 130.0, 60.0, 30.0, 70.0, 60.0, 100.0, 80.0, 110.0, 454.0, 58.0, 0.0, 45.0, 389.0, 80.0, 100.0, 78.0, 210.0, 20.0, 41.0, 58.0, 30.0, 40.0, 100.0, 230.0, 20.0, 230.0, 110.0, 73.0, 80.0, 127.0, 80.0, 147.0, 337.0, 306.0, 80.0, -5.0, 190.0, 90.0, 110.0, 100.0, 110.0, 40.0, 320.0, 300.0, 50.0, 30.0, 100.0, 100.0, 110.0, 31.0, 110.0, 70.0, 60.0, 110.0, 80.0, 76.0, 70.0, 110.0, 60.0, 70.0, 130.0, 50.0, 110.0, 52.0, 290.0, 9.0, 25.0, 70.0, 117.0, 90.0, 73.0, 87.0, 330.0, 220.0, 30.0, 320.0, -11.0, 19.0, 10.0, 60.0, 50.0, 70.0, 80.0, 530.0, -40.0, 90.0, 90.0, -50.0, 85.0, 140.0, 60.0, 89.0, 110.0, 40.0, 60.0, 110.0, 60.0, 60.0, 0.0, 20.0, 70.0, 90.0, 30.0, 60.0, 150.0, 70.0, 40.0, 360.0, 120.0, 140.0, 60.0, 70.0, 120.0, 80.0, 40.0, 120.0, 80.0, 109.0, 60.0, 180.0, 90.0, 100.0, 70.0, 166.0, 40.0, 18.0, 16.0, 50.0, 35.0, 80.0, 80.0, 120.0, 10.0, 87.0, 147.0, 30.0, 98.0, 115.0, 34.0, 470.0, 50.0, -11.0, 100.0, 70.0, 66.0, 270.0, 300.0, 24.0, 60.0, 30.0, 210.0, -6.0, -7.0, 50.0, 9.0, 140.0, 80.0, 100.0, 480.0, 60.0, 95.0, 110.0, 38.0, -65.0, 60.0, 40.0, 80.0, 520.0, 110.0, 250.0, 90.0, -58.0, 50.0, 100.0, 19.0, 90.0, 30.0, 89.0, 78.0, 102.0, 130.0, 140.0, 100.0, 100.0, 90.0, 44.0, 220.0, 248.0, 180.0, 50.0, 60.0, -4.0, 31.0, -11.0, 103.0, -25.0, 186.0, 70.0, 150.0, 60.0, 70.0, 18.0, -22.0, 21.0, 15.0, 120.0, 185.0, 620.0, 120.0, 370.0, 310.0, 120.0, 80.0, -45.0, 100.0, 90.0, -41.0, 70.0, 120.0, 80.0, 100.0, 50.0, 630.0, 90.0, 100.0, 60.0, 55.0, 510.0, 110.0, 44.0, 120.0, -16.0, 45.0, 90.0, 110.0, 80.0, 49.0, 80.0, 30.0, 103.0, 90.0, 80.0, 60.0, 410.0, 50.0, 110.0, 90.0, 48.0, 63.0, -50.0, -11.0, 130.0, 30.0, 303.0, 76.0, 60.0, 244.0, 35.0, 128.0, 30.0, 48.0, 50.0, 79.0, 10.0, 80.0, 105.0, 90.0, 68.0, 48.0, 208.0, 9.0, 190.0, 110.0, 120.0, 420.0, 76.0, 120.0, 60.0, 100.0, 170.0, 70.0, 110.0, 100.0, 80.0, 180.0, 59.0, 120.0, 60.0, 70.0, 70.0, 90.0, -40.0, 59.0, 70.0, 70.0, 130.0, 70.0, -1.0, 261.0, 60.0, 48.0, 70.0, 62.0, 10.0, 80.0, 170.0, 110.0, 25.0, 60.0, 90.0, 51.0, 110.0, 77.0, 210.0, 100.0, 30.0, 50.0, 100.0, 100.0, 70.0, -220.0, -1.0, 79.0, 60.0, 59.0, 70.0, 480.0, 30.0, 67.0, 110.0, 80.0, -46.0, 44.0, 90.0, -44.0, 90.0, 70.0, 60.0, 72.0, 48.0, 80.0, 20.0, 50.0, 50.0, 20.0, 130.0, 29.0, 25.0, 57.0, 39.0, 150.0, 170.0, 28.0, 110.0, 150.0, 90.0, 38.0, 80.0, 40.0, 80.0, 120.0, 130.0, 30.0, 170.0, 70.0, 80.0, 60.0, 220.0, -139.0, 130.0, 130.0, 200.0, 80.0, 90.0, 90.0, 200.0, 110.0, 5.0, 100.0, 40.0, 80.0, 40.0, 30.0, -13.0, 37.0, 140.0, 120.0, 60.0, 70.0, 70.0, 40.0, 130.0, 310.0, 70.0, 21.0, 274.0, 40.0, -6.0, 70.0, 70.0, 19.0, 100.0, 50.0, 90.0, 60.0, 80.0, 70.0, 70.0, 70.0, 100.0, 100.0, 120.0, 73.0, 140.0, 421.0, 60.0, 110.0, 70.0, 97.0, 35.0, 68.0, 55.0, 110.0, 180.0, 60.0, 450.0, 170.0, 40.0, 55.0, 328.0, 50.0, 80.0, -1.0, 70.0, 65.0, 80.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9279630258498646, "mean_inference_ms": 2.177209187811659, "mean_action_processing_ms": 0.7406109763073598, "mean_env_wait_ms": 1.5217582898082915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06358122825622559, "StateBufferConnector_ms": 0.010111093521118164, "ViewRequirementAgentConnector_ms": 0.46280360221862793}, "num_episodes": 18, "episode_return_max": 1724.0, "episode_return_min": 431.0, "episode_return_mean": 954.35, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.44828627482742, "num_env_steps_trained_throughput_per_sec": 32.44828627482742, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 5120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5120000, "timers": {"training_iteration_time_ms": 123012.594, "restore_workers_time_ms": 0.013, "training_step_time_ms": 123012.542, "sample_time_ms": 3468.079, "learn_time_ms": 119522.225, "learn_throughput": 33.467, "synch_weights_time_ms": 12.554}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "done": false, "training_iteration": 128, "trial_id": "6085c_00000", "date": "2024-07-02_03-20-06", "timestamp": 1719904806, "time_this_iter_s": 123.28551077842712, "time_total_s": 17651.349870443344, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138aa7d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17651.349870443344, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 22.42816091954023, "ram_util_percent": 79.18448275862067}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8494073215257116, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.851205281023019, "policy_loss": -0.006948699120616122, "vf_loss": 7.85692811047815, "vf_explained_var": 0.0007353439435156516, "kl": 0.008172436582102698, "entropy": 0.5515680944703766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1206615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "env_runners": {"episode_reward_max": 1724.0, "episode_reward_min": 424.0, "episode_reward_mean": 957.98, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -231.0}, "policy_reward_max": {"policy_0": 725.0}, "policy_reward_mean": {"policy_0": 95.798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [940.0, 452.0, 1192.0, 558.0, 1156.0, 875.0, 847.0, 1436.0, 738.0, 743.0, 947.0, 897.0, 1025.0, 929.0, 1037.0, 724.0, 942.0, 758.0, 797.0, 1616.0, 1020.0, 666.0, 464.0, 1312.0, 1688.0, 1124.0, 1279.0, 1201.0, 721.0, 816.0, 1318.0, 942.0, 632.0, 772.0, 755.0, 758.0, 885.0, 911.0, 659.0, 1524.0, 879.0, 1415.0, 1250.0, 817.0, 906.0, 1326.0, 959.0, 704.0, 590.0, 1190.0, 849.0, 737.0, 1464.0, 590.0, 998.0, 1201.0, 1093.0, 818.0, 687.0, 1724.0, 1355.0, 1142.0, 1103.0, 893.0, 655.0, 1369.0, 1049.0, 649.0, 870.0, 803.0, 797.0, 491.0, 559.0, 857.0, 860.0, 1111.0, 579.0, 1085.0, 603.0, 1264.0, 1295.0, 857.0, 955.0, 1070.0, 757.0, 1242.0, 885.0, 1463.0, 737.0, 1026.0, 424.0, 909.0, 841.0, 883.0, 849.0, 1489.0, 719.0, 1124.0, 818.0, 1108.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [160.0, 90.0, 110.0, 100.0, 50.0, 52.0, 110.0, -70.0, 158.0, 180.0, 35.0, 125.0, -1.0, 30.0, 80.0, 39.0, 70.0, 36.0, 8.0, 30.0, 275.0, 77.0, 120.0, 100.0, 120.0, 100.0, 50.0, 130.0, 120.0, 100.0, -19.0, 70.0, -30.0, 60.0, 89.0, 40.0, 98.0, 120.0, 30.0, 100.0, 77.0, 140.0, 96.0, 58.0, 90.0, 200.0, 88.0, 268.0, 50.0, 89.0, 60.0, 53.0, 75.0, 90.0, 74.0, 60.0, 100.0, 77.0, 76.0, 210.0, 80.0, 338.0, 39.0, 0.0, 82.0, 50.0, 90.0, 99.0, 52.0, 17.0, 90.0, 128.0, 120.0, 310.0, 40.0, 90.0, 100.0, 370.0, 98.0, 90.0, 380.0, 29.0, 80.0, 70.0, 30.0, 10.0, 97.0, 30.0, -38.0, 50.0, 70.0, 130.0, 50.0, 45.0, 48.0, -8.0, 68.0, 90.0, 152.0, 98.0, 60.0, 220.0, 115.0, 33.0, 32.0, 110.0, 157.0, 30.0, 130.0, 60.0, 70.0, 40.0, 40.0, 60.0, 109.0, 70.0, 100.0, 110.0, 90.0, 208.0, 350.0, 60.0, 90.0, 90.0, 80.0, 260.0, -10.0, 40.0, -30.0, 95.0, 160.0, 70.0, 100.0, 89.0, 60.0, 110.0, 100.0, 60.0, 100.0, 80.0, 150.0, 100.0, -30.0, 30.0, 50.0, 580.0, 80.0, 67.0, -30.0, 40.0, 60.0, 160.0, 95.0, 60.0, -5.0, 140.0, 41.0, 58.0, 60.0, 55.0, 80.0, 90.0, 60.0, 60.0, 50.0, 73.0, 110.0, 60.0, 59.0, 300.0, 104.0, 30.0, 160.0, 50.0, 21.0, 62.0, -4.0, 240.0, 50.0, 45.0, 70.0, 50.0, 140.0, -32.0, 60.0, 120.0, 50.0, 110.0, 159.0, 70.0, 31.0, 190.0, 153.0, 100.0, 120.0, 490.0, 100.0, 209.0, 178.0, 45.0, 48.0, 51.0, 198.0, 20.0, 80.0, 47.0, 58.0, 388.0, 50.0, 80.0, 60.0, 40.0, 60.0, 14.0, 130.0, 14.0, 60.0, 68.0, 120.0, 100.0, 30.0, 127.0, 22.0, 39.0, 20.0, 30.0, 50.0, 26.0, 80.0, 40.0, 80.0, 40.0, 478.0, 110.0, -50.0, 84.0, 10.0, 120.0, 80.0, 360.0, -20.0, 60.0, 500.0, 110.0, 89.0, 100.0, 85.0, 520.0, 74.0, 170.0, 100.0, 160.0, 76.0, 58.0, -5.0, 70.0, 510.0, 160.0, 45.0, -50.0, 130.0, 110.0, 40.0, 380.0, 80.0, 75.0, 150.0, 160.0, 100.0, 54.0, 210.0, -19.0, 150.0, 43.0, 55.0, 480.0, 66.0, -30.0, 176.0, 70.0, 118.0, 70.0, 190.0, 40.0, 23.0, -2.0, 59.0, 120.0, 54.0, 49.0, 100.0, 90.0, 80.0, 60.0, 90.0, 108.0, 70.0, 79.0, 59.0, 80.0, 120.0, 100.0, 40.0, 60.0, 40.0, 10.0, 50.0, 630.0, 169.0, 99.0, 50.0, -20.0, 306.0, 46.0, 50.0, 40.0, 270.0, -130.0, 110.0, 220.0, 35.0, -95.0, 175.0, 30.0, 169.0, 100.0, 8.0, 20.0, 25.0, 165.0, 263.0, -50.0, 100.0, 20.0, 110.0, 110.0, 150.0, 30.0, -21.0, 60.0, 80.0, 90.0, 90.0, 15.0, 20.0, 80.0, 110.0, 100.0, 80.0, 90.0, 13.0, 50.0, 36.0, 80.0, 50.0, 180.0, 80.0, 170.0, 90.0, 9.0, 50.0, 90.0, 215.0, 40.0, 68.0, 110.0, 50.0, 62.0, 50.0, 150.0, 120.0, 159.0, 99.0, 110.0, 120.0, 70.0, 17.0, 60.0, 123.0, 33.0, 39.0, 40.0, 50.0, 130.0, 60.0, 30.0, 70.0, 60.0, 100.0, 80.0, 110.0, 454.0, 58.0, 0.0, 45.0, 389.0, 80.0, 100.0, 78.0, 210.0, 20.0, 41.0, 58.0, 30.0, 40.0, 100.0, 230.0, 20.0, 230.0, 110.0, 73.0, 80.0, 127.0, 80.0, 147.0, 337.0, 306.0, 80.0, -5.0, 190.0, 90.0, 110.0, 100.0, 110.0, 40.0, 320.0, 300.0, 50.0, 30.0, 100.0, 100.0, 110.0, 31.0, 110.0, 70.0, 60.0, 110.0, 80.0, 76.0, 70.0, 110.0, 60.0, 70.0, 130.0, 50.0, 110.0, 52.0, 290.0, 9.0, 25.0, 70.0, 117.0, 90.0, 73.0, 87.0, 330.0, 220.0, 30.0, 320.0, -11.0, 19.0, 10.0, 60.0, 50.0, 70.0, 80.0, 530.0, -40.0, 90.0, 90.0, -50.0, 85.0, 140.0, 60.0, 89.0, 110.0, 40.0, 60.0, 110.0, 60.0, 60.0, 0.0, 20.0, 70.0, 90.0, 30.0, 60.0, 150.0, 70.0, 40.0, 360.0, 120.0, 140.0, 60.0, 70.0, 120.0, 80.0, 40.0, 120.0, 80.0, 109.0, 60.0, 180.0, 90.0, 100.0, 70.0, 166.0, 40.0, 18.0, 16.0, 50.0, 35.0, 80.0, 80.0, 120.0, 10.0, 87.0, 147.0, 30.0, 98.0, 115.0, 34.0, 470.0, 50.0, -11.0, 100.0, 70.0, 66.0, 270.0, 300.0, 24.0, 60.0, 30.0, 210.0, -6.0, -7.0, 50.0, 9.0, 140.0, 80.0, 100.0, 480.0, 60.0, 95.0, 110.0, 38.0, -65.0, 60.0, 40.0, 80.0, 520.0, 110.0, 250.0, 90.0, -58.0, 50.0, 100.0, 19.0, 90.0, 30.0, 89.0, 78.0, 102.0, 130.0, 140.0, 100.0, 100.0, 90.0, 44.0, 220.0, 248.0, 180.0, 50.0, 60.0, -4.0, 31.0, -11.0, 103.0, -25.0, 186.0, 70.0, 150.0, 60.0, 70.0, 18.0, -22.0, 21.0, 15.0, 120.0, 185.0, 620.0, 120.0, 370.0, 310.0, 120.0, 80.0, -45.0, 100.0, 90.0, -41.0, 70.0, 120.0, 80.0, 100.0, 50.0, 630.0, 90.0, 100.0, 60.0, 55.0, 510.0, 110.0, 44.0, 120.0, -16.0, 45.0, 90.0, 110.0, 80.0, 49.0, 80.0, 30.0, 103.0, 90.0, 80.0, 60.0, 410.0, 50.0, 110.0, 90.0, 48.0, 63.0, -50.0, -11.0, 130.0, 30.0, 303.0, 76.0, 60.0, 244.0, 35.0, 128.0, 30.0, 48.0, 50.0, 79.0, 10.0, 80.0, 105.0, 90.0, 68.0, 48.0, 208.0, 9.0, 190.0, 110.0, 120.0, 420.0, 76.0, 120.0, 60.0, 100.0, 170.0, 70.0, 110.0, 100.0, 80.0, 180.0, 59.0, 120.0, 60.0, 70.0, 70.0, 90.0, -40.0, 59.0, 70.0, 70.0, 130.0, 70.0, -1.0, 261.0, 60.0, 48.0, 70.0, 62.0, 10.0, 80.0, 170.0, 110.0, 25.0, 60.0, 90.0, 51.0, 110.0, 77.0, 210.0, 100.0, 30.0, 50.0, 100.0, 100.0, 70.0, -220.0, -1.0, 79.0, 60.0, 59.0, 70.0, 480.0, 30.0, 67.0, 110.0, 80.0, -46.0, 44.0, 90.0, -44.0, 90.0, 70.0, 60.0, 72.0, 48.0, 80.0, 20.0, 50.0, 50.0, 20.0, 130.0, 29.0, 25.0, 57.0, 39.0, 150.0, 170.0, 28.0, 110.0, 150.0, 90.0, 38.0, 80.0, 40.0, 80.0, 120.0, 130.0, 30.0, 170.0, 70.0, 80.0, 60.0, 220.0, -139.0, 130.0, 130.0, 200.0, 80.0, 90.0, 90.0, 200.0, 110.0, 5.0, 100.0, 40.0, 80.0, 40.0, 30.0, -13.0, 37.0, 140.0, 120.0, 60.0, 70.0, 70.0, 40.0, 130.0, 310.0, 70.0, 21.0, 274.0, 40.0, -6.0, 70.0, 70.0, 19.0, 100.0, 50.0, 90.0, 60.0, 80.0, 70.0, 70.0, 70.0, 100.0, 100.0, 120.0, 73.0, 140.0, 421.0, 60.0, 110.0, 70.0, 97.0, 35.0, 68.0, 55.0, 110.0, 180.0, 60.0, 450.0, 170.0, 40.0, 55.0, 328.0, 50.0, 80.0, -1.0, 70.0, 65.0, 80.0, 90.0, 49.0, 100.0, 220.0, 110.0, 120.0, 90.0, 100.0, -10.0, 130.0, 46.0, 120.0, 107.0, 204.0, -60.0, 70.0, 190.0, 100.0, 70.0, 139.0, 130.0, 80.0, 60.0, 88.0, 80.0, 100.0, 110.0, 80.0, 61.0, 69.0, 29.0, 64.0, 55.0, 70.0, 40.0, 350.0, 120.0, 135.0, 240.0, 88.0, 80.0, 130.0, 70.0, 45.0, 180.0, 40.0, 0.0, 180.0, 70.0, 20.0, 150.0, 120.0, 90.0, 67.0, 118.0, 70.0, 190.0, 593.0, -13.0, 110.0, 118.0, 70.0, 60.0, 120.0, 80.0, 69.0, 60.0, 30.0, 8.0, 150.0, 90.0, 80.0, 100.0, 16.0, 18.0, 285.0, 120.0, 120.0, 60.0, 170.0, 57.0, 40.0, 80.0, 60.0, 70.0, 40.0, 9.0, 25.0, 70.0, 30.0, 0.0, 90.0, 180.0, 13.0, 150.0, 27.0, 99.0, 76.0, 130.0, 38.0, 106.0, 85.0, 50.0, 48.0, 179.0, 190.0, 30.0, 30.0, 59.0, 80.0, 90.0, 60.0, 94.0, 79.0, 106.0, 90.0, 190.0, 70.0, 60.0, 100.0, 34.0, 90.0, 40.0, 312.0, 50.0, 70.0, 60.0, 7.0, 70.0, 50.0, 100.0, 90.0, 630.0, 30.0, 230.0, 60.0, 160.0, 59.0, 60.0, 90.0, 80.0, 96.0, 70.0, 50.0, 110.0, 52.0, 40.0, 68.0, 52.0, 60.0, 121.0, 725.0, -60.0, 130.0, 0.0, -20.0, 80.0, -231.0, 50.0, 370.0, 80.0, 80.0, 100.0, 140.0, 78.0, 60.0, 40.0, 120.0, 100.0, 0.0, 100.0, 80.0, 50.0, 100.0, 300.0, 170.0, 80.0, 90.0, 90.0, 90.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9268823715878756, "mean_inference_ms": 2.1753807575108652, "mean_action_processing_ms": 0.739823509993139, "mean_env_wait_ms": 1.5203785403820314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06102442741394043, "StateBufferConnector_ms": 0.010401248931884766, "ViewRequirementAgentConnector_ms": 0.456939697265625}, "num_episodes": 18, "episode_return_max": 1724.0, "episode_return_min": 424.0, "episode_return_mean": 957.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.79820516112457, "num_env_steps_trained_throughput_per_sec": 32.79820516112457, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 5160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5160000, "timers": {"training_iteration_time_ms": 122879.132, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122879.078, "sample_time_ms": 3367.592, "learn_time_ms": 119488.972, "learn_throughput": 33.476, "synch_weights_time_ms": 12.575}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "done": false, "training_iteration": 129, "trial_id": "6085c_00000", "date": "2024-07-02_03-22-08", "timestamp": 1719904928, "time_this_iter_s": 121.9782509803772, "time_total_s": 17773.32812142372, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b3bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17773.32812142372, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 21.00635838150289, "ram_util_percent": 79.16878612716764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1864123541326186, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.773056475169108, "policy_loss": -0.008371320406619174, "vf_loss": 7.780235950380596, "vf_explained_var": 0.0013660280722271774, "kl": 0.007945603507921346, "entropy": 0.5260076457160476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1216005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "env_runners": {"episode_reward_max": 2325.0, "episode_reward_min": 315.0, "episode_reward_mean": 969.44, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -231.0}, "policy_reward_max": {"policy_0": 1350.0}, "policy_reward_mean": {"policy_0": 96.944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1312.0, 1688.0, 1124.0, 1279.0, 1201.0, 721.0, 816.0, 1318.0, 942.0, 632.0, 772.0, 755.0, 758.0, 885.0, 911.0, 659.0, 1524.0, 879.0, 1415.0, 1250.0, 817.0, 906.0, 1326.0, 959.0, 704.0, 590.0, 1190.0, 849.0, 737.0, 1464.0, 590.0, 998.0, 1201.0, 1093.0, 818.0, 687.0, 1724.0, 1355.0, 1142.0, 1103.0, 893.0, 655.0, 1369.0, 1049.0, 649.0, 870.0, 803.0, 797.0, 491.0, 559.0, 857.0, 860.0, 1111.0, 579.0, 1085.0, 603.0, 1264.0, 1295.0, 857.0, 955.0, 1070.0, 757.0, 1242.0, 885.0, 1463.0, 737.0, 1026.0, 424.0, 909.0, 841.0, 883.0, 849.0, 1489.0, 719.0, 1124.0, 818.0, 1108.0, 920.0, 989.0, 1005.0, 904.0, 1600.0, 797.0, 2325.0, 460.0, 810.0, 675.0, 667.0, 710.0, 808.0, 1485.0, 779.0, 781.0, 945.0, 315.0, 989.0, 1001.0, 1489.0, 771.0, 680.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 40.0, 478.0, 110.0, -50.0, 84.0, 10.0, 120.0, 80.0, 360.0, -20.0, 60.0, 500.0, 110.0, 89.0, 100.0, 85.0, 520.0, 74.0, 170.0, 100.0, 160.0, 76.0, 58.0, -5.0, 70.0, 510.0, 160.0, 45.0, -50.0, 130.0, 110.0, 40.0, 380.0, 80.0, 75.0, 150.0, 160.0, 100.0, 54.0, 210.0, -19.0, 150.0, 43.0, 55.0, 480.0, 66.0, -30.0, 176.0, 70.0, 118.0, 70.0, 190.0, 40.0, 23.0, -2.0, 59.0, 120.0, 54.0, 49.0, 100.0, 90.0, 80.0, 60.0, 90.0, 108.0, 70.0, 79.0, 59.0, 80.0, 120.0, 100.0, 40.0, 60.0, 40.0, 10.0, 50.0, 630.0, 169.0, 99.0, 50.0, -20.0, 306.0, 46.0, 50.0, 40.0, 270.0, -130.0, 110.0, 220.0, 35.0, -95.0, 175.0, 30.0, 169.0, 100.0, 8.0, 20.0, 25.0, 165.0, 263.0, -50.0, 100.0, 20.0, 110.0, 110.0, 150.0, 30.0, -21.0, 60.0, 80.0, 90.0, 90.0, 15.0, 20.0, 80.0, 110.0, 100.0, 80.0, 90.0, 13.0, 50.0, 36.0, 80.0, 50.0, 180.0, 80.0, 170.0, 90.0, 9.0, 50.0, 90.0, 215.0, 40.0, 68.0, 110.0, 50.0, 62.0, 50.0, 150.0, 120.0, 159.0, 99.0, 110.0, 120.0, 70.0, 17.0, 60.0, 123.0, 33.0, 39.0, 40.0, 50.0, 130.0, 60.0, 30.0, 70.0, 60.0, 100.0, 80.0, 110.0, 454.0, 58.0, 0.0, 45.0, 389.0, 80.0, 100.0, 78.0, 210.0, 20.0, 41.0, 58.0, 30.0, 40.0, 100.0, 230.0, 20.0, 230.0, 110.0, 73.0, 80.0, 127.0, 80.0, 147.0, 337.0, 306.0, 80.0, -5.0, 190.0, 90.0, 110.0, 100.0, 110.0, 40.0, 320.0, 300.0, 50.0, 30.0, 100.0, 100.0, 110.0, 31.0, 110.0, 70.0, 60.0, 110.0, 80.0, 76.0, 70.0, 110.0, 60.0, 70.0, 130.0, 50.0, 110.0, 52.0, 290.0, 9.0, 25.0, 70.0, 117.0, 90.0, 73.0, 87.0, 330.0, 220.0, 30.0, 320.0, -11.0, 19.0, 10.0, 60.0, 50.0, 70.0, 80.0, 530.0, -40.0, 90.0, 90.0, -50.0, 85.0, 140.0, 60.0, 89.0, 110.0, 40.0, 60.0, 110.0, 60.0, 60.0, 0.0, 20.0, 70.0, 90.0, 30.0, 60.0, 150.0, 70.0, 40.0, 360.0, 120.0, 140.0, 60.0, 70.0, 120.0, 80.0, 40.0, 120.0, 80.0, 109.0, 60.0, 180.0, 90.0, 100.0, 70.0, 166.0, 40.0, 18.0, 16.0, 50.0, 35.0, 80.0, 80.0, 120.0, 10.0, 87.0, 147.0, 30.0, 98.0, 115.0, 34.0, 470.0, 50.0, -11.0, 100.0, 70.0, 66.0, 270.0, 300.0, 24.0, 60.0, 30.0, 210.0, -6.0, -7.0, 50.0, 9.0, 140.0, 80.0, 100.0, 480.0, 60.0, 95.0, 110.0, 38.0, -65.0, 60.0, 40.0, 80.0, 520.0, 110.0, 250.0, 90.0, -58.0, 50.0, 100.0, 19.0, 90.0, 30.0, 89.0, 78.0, 102.0, 130.0, 140.0, 100.0, 100.0, 90.0, 44.0, 220.0, 248.0, 180.0, 50.0, 60.0, -4.0, 31.0, -11.0, 103.0, -25.0, 186.0, 70.0, 150.0, 60.0, 70.0, 18.0, -22.0, 21.0, 15.0, 120.0, 185.0, 620.0, 120.0, 370.0, 310.0, 120.0, 80.0, -45.0, 100.0, 90.0, -41.0, 70.0, 120.0, 80.0, 100.0, 50.0, 630.0, 90.0, 100.0, 60.0, 55.0, 510.0, 110.0, 44.0, 120.0, -16.0, 45.0, 90.0, 110.0, 80.0, 49.0, 80.0, 30.0, 103.0, 90.0, 80.0, 60.0, 410.0, 50.0, 110.0, 90.0, 48.0, 63.0, -50.0, -11.0, 130.0, 30.0, 303.0, 76.0, 60.0, 244.0, 35.0, 128.0, 30.0, 48.0, 50.0, 79.0, 10.0, 80.0, 105.0, 90.0, 68.0, 48.0, 208.0, 9.0, 190.0, 110.0, 120.0, 420.0, 76.0, 120.0, 60.0, 100.0, 170.0, 70.0, 110.0, 100.0, 80.0, 180.0, 59.0, 120.0, 60.0, 70.0, 70.0, 90.0, -40.0, 59.0, 70.0, 70.0, 130.0, 70.0, -1.0, 261.0, 60.0, 48.0, 70.0, 62.0, 10.0, 80.0, 170.0, 110.0, 25.0, 60.0, 90.0, 51.0, 110.0, 77.0, 210.0, 100.0, 30.0, 50.0, 100.0, 100.0, 70.0, -220.0, -1.0, 79.0, 60.0, 59.0, 70.0, 480.0, 30.0, 67.0, 110.0, 80.0, -46.0, 44.0, 90.0, -44.0, 90.0, 70.0, 60.0, 72.0, 48.0, 80.0, 20.0, 50.0, 50.0, 20.0, 130.0, 29.0, 25.0, 57.0, 39.0, 150.0, 170.0, 28.0, 110.0, 150.0, 90.0, 38.0, 80.0, 40.0, 80.0, 120.0, 130.0, 30.0, 170.0, 70.0, 80.0, 60.0, 220.0, -139.0, 130.0, 130.0, 200.0, 80.0, 90.0, 90.0, 200.0, 110.0, 5.0, 100.0, 40.0, 80.0, 40.0, 30.0, -13.0, 37.0, 140.0, 120.0, 60.0, 70.0, 70.0, 40.0, 130.0, 310.0, 70.0, 21.0, 274.0, 40.0, -6.0, 70.0, 70.0, 19.0, 100.0, 50.0, 90.0, 60.0, 80.0, 70.0, 70.0, 70.0, 100.0, 100.0, 120.0, 73.0, 140.0, 421.0, 60.0, 110.0, 70.0, 97.0, 35.0, 68.0, 55.0, 110.0, 180.0, 60.0, 450.0, 170.0, 40.0, 55.0, 328.0, 50.0, 80.0, -1.0, 70.0, 65.0, 80.0, 90.0, 49.0, 100.0, 220.0, 110.0, 120.0, 90.0, 100.0, -10.0, 130.0, 46.0, 120.0, 107.0, 204.0, -60.0, 70.0, 190.0, 100.0, 70.0, 139.0, 130.0, 80.0, 60.0, 88.0, 80.0, 100.0, 110.0, 80.0, 61.0, 69.0, 29.0, 64.0, 55.0, 70.0, 40.0, 350.0, 120.0, 135.0, 240.0, 88.0, 80.0, 130.0, 70.0, 45.0, 180.0, 40.0, 0.0, 180.0, 70.0, 20.0, 150.0, 120.0, 90.0, 67.0, 118.0, 70.0, 190.0, 593.0, -13.0, 110.0, 118.0, 70.0, 60.0, 120.0, 80.0, 69.0, 60.0, 30.0, 8.0, 150.0, 90.0, 80.0, 100.0, 16.0, 18.0, 285.0, 120.0, 120.0, 60.0, 170.0, 57.0, 40.0, 80.0, 60.0, 70.0, 40.0, 9.0, 25.0, 70.0, 30.0, 0.0, 90.0, 180.0, 13.0, 150.0, 27.0, 99.0, 76.0, 130.0, 38.0, 106.0, 85.0, 50.0, 48.0, 179.0, 190.0, 30.0, 30.0, 59.0, 80.0, 90.0, 60.0, 94.0, 79.0, 106.0, 90.0, 190.0, 70.0, 60.0, 100.0, 34.0, 90.0, 40.0, 312.0, 50.0, 70.0, 60.0, 7.0, 70.0, 50.0, 100.0, 90.0, 630.0, 30.0, 230.0, 60.0, 160.0, 59.0, 60.0, 90.0, 80.0, 96.0, 70.0, 50.0, 110.0, 52.0, 40.0, 68.0, 52.0, 60.0, 121.0, 725.0, -60.0, 130.0, 0.0, -20.0, 80.0, -231.0, 50.0, 370.0, 80.0, 80.0, 100.0, 140.0, 78.0, 60.0, 40.0, 120.0, 100.0, 0.0, 100.0, 80.0, 50.0, 100.0, 300.0, 170.0, 80.0, 90.0, 90.0, 90.0, 58.0, 66.0, 56.0, 50.0, 289.0, 110.0, 70.0, 40.0, 70.0, 110.0, 59.0, 226.0, 50.0, 26.0, 166.0, 50.0, 57.0, -6.0, 110.0, 120.0, 190.0, 50.0, 80.0, 89.0, 90.0, 90.0, 70.0, 90.0, 100.0, 210.0, 136.0, 341.0, 7.0, 120.0, 167.0, 70.0, 48.0, -8.0, 84.0, -15.0, 90.0, 393.0, 108.0, 280.0, 130.0, 130.0, 90.0, 230.0, 20.0, 110.0, 109.0, -5.0, 90.0, 139.0, 98.0, 109.0, 100.0, 119.0, 90.0, 87.0, -30.0, 140.0, 105.0, 1350.0, 80.0, 10.0, -65.0, 120.0, 50.0, 425.0, 110.0, 20.0, 26.0, 90.0, -65.0, 100.0, 80.0, 79.0, 60.0, 110.0, -40.0, 48.0, 90.0, 118.0, 20.0, 41.0, 70.0, 90.0, 13.0, 190.0, 130.0, 90.0, 70.0, 20.0, 40.0, 140.0, 99.0, 90.0, -64.0, 80.0, 110.0, 140.0, 108.0, 25.0, 70.0, 110.0, 50.0, 70.0, 20.0, 70.0, 4.0, 190.0, 65.0, 120.0, 25.0, 20.0, -20.0, 10.0, 120.0, 50.0, 130.0, 310.0, -30.0, 20.0, -25.0, 55.0, 110.0, 20.0, 19.0, 60.0, 269.0, 120.0, 100.0, 330.0, 100.0, 300.0, 320.0, 65.0, 40.0, 90.0, 20.0, 90.0, 55.0, 59.0, 60.0, 90.0, 100.0, 70.0, 100.0, 80.0, 75.0, 20.0, 190.0, -11.0, 126.0, 80.0, 46.0, 80.0, 70.0, 100.0, 80.0, 108.0, 122.0, 109.0, 90.0, 100.0, 112.0, 70.0, 70.0, 79.0, 85.0, 50.0, 38.0, 45.0, 37.0, -5.0, 30.0, -50.0, 10.0, 130.0, 30.0, 70.0, 50.0, 70.0, 60.0, 40.0, 100.0, 220.0, 90.0, 410.0, -121.0, 120.0, 200.0, 64.0, 210.0, 60.0, 99.0, 46.0, 100.0, 62.0, 40.0, 90.0, 80.0, 650.0, 60.0, 130.0, 130.0, 200.0, 49.0, 50.0, 50.0, 40.0, 129.0, 107.0, 18.0, 81.0, 21.0, 110.0, 131.0, 30.0, 104.0, 45.0, 100.0, 20.0, 60.0, 60.0, 100.0, 25.0, 90.0, 130.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9254657145722813, "mean_inference_ms": 2.172990438764377, "mean_action_processing_ms": 0.7387819589218306, "mean_env_wait_ms": 1.5185612150617573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06917333602905273, "StateBufferConnector_ms": 0.01557779312133789, "ViewRequirementAgentConnector_ms": 0.45734620094299316}, "num_episodes": 23, "episode_return_max": 2325.0, "episode_return_min": 315.0, "episode_return_mean": 969.44, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.99690812311249, "num_env_steps_trained_throughput_per_sec": 32.99690812311249, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 5200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5200000, "timers": {"training_iteration_time_ms": 122664.465, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122664.411, "sample_time_ms": 3304.978, "learn_time_ms": 119336.763, "learn_throughput": 33.519, "synch_weights_time_ms": 12.479}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "done": false, "training_iteration": 130, "trial_id": "6085c_00000", "date": "2024-07-02_03-24-09", "timestamp": 1719905049, "time_this_iter_s": 121.23623180389404, "time_total_s": 17894.564353227615, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b67a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17894.564353227615, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 20.766666666666666, "ram_util_percent": 78.5327485380117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0430885166088486, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.5998662823686205, "policy_loss": -0.007422302110706822, "vf_loss": 7.606134420360366, "vf_explained_var": 0.0008544709862738499, "kl": 0.0076945098366895375, "entropy": 0.5611861657093381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1225395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "env_runners": {"episode_reward_max": 2325.0, "episode_reward_min": 315.0, "episode_reward_mean": 952.49, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -231.0}, "policy_reward_max": {"policy_0": 1350.0}, "policy_reward_mean": {"policy_0": 95.249}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1326.0, 959.0, 704.0, 590.0, 1190.0, 849.0, 737.0, 1464.0, 590.0, 998.0, 1201.0, 1093.0, 818.0, 687.0, 1724.0, 1355.0, 1142.0, 1103.0, 893.0, 655.0, 1369.0, 1049.0, 649.0, 870.0, 803.0, 797.0, 491.0, 559.0, 857.0, 860.0, 1111.0, 579.0, 1085.0, 603.0, 1264.0, 1295.0, 857.0, 955.0, 1070.0, 757.0, 1242.0, 885.0, 1463.0, 737.0, 1026.0, 424.0, 909.0, 841.0, 883.0, 849.0, 1489.0, 719.0, 1124.0, 818.0, 1108.0, 920.0, 989.0, 1005.0, 904.0, 1600.0, 797.0, 2325.0, 460.0, 810.0, 675.0, 667.0, 710.0, 808.0, 1485.0, 779.0, 781.0, 945.0, 315.0, 989.0, 1001.0, 1489.0, 771.0, 680.0, 1030.0, 2064.0, 883.0, 1059.0, 1332.0, 1511.0, 804.0, 627.0, 1137.0, 1118.0, 1221.0, 468.0, 777.0, 628.0, 634.0, 615.0, 982.0, 1018.0, 814.0, 582.0, 779.0, 786.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 117.0, 90.0, 73.0, 87.0, 330.0, 220.0, 30.0, 320.0, -11.0, 19.0, 10.0, 60.0, 50.0, 70.0, 80.0, 530.0, -40.0, 90.0, 90.0, -50.0, 85.0, 140.0, 60.0, 89.0, 110.0, 40.0, 60.0, 110.0, 60.0, 60.0, 0.0, 20.0, 70.0, 90.0, 30.0, 60.0, 150.0, 70.0, 40.0, 360.0, 120.0, 140.0, 60.0, 70.0, 120.0, 80.0, 40.0, 120.0, 80.0, 109.0, 60.0, 180.0, 90.0, 100.0, 70.0, 166.0, 40.0, 18.0, 16.0, 50.0, 35.0, 80.0, 80.0, 120.0, 10.0, 87.0, 147.0, 30.0, 98.0, 115.0, 34.0, 470.0, 50.0, -11.0, 100.0, 70.0, 66.0, 270.0, 300.0, 24.0, 60.0, 30.0, 210.0, -6.0, -7.0, 50.0, 9.0, 140.0, 80.0, 100.0, 480.0, 60.0, 95.0, 110.0, 38.0, -65.0, 60.0, 40.0, 80.0, 520.0, 110.0, 250.0, 90.0, -58.0, 50.0, 100.0, 19.0, 90.0, 30.0, 89.0, 78.0, 102.0, 130.0, 140.0, 100.0, 100.0, 90.0, 44.0, 220.0, 248.0, 180.0, 50.0, 60.0, -4.0, 31.0, -11.0, 103.0, -25.0, 186.0, 70.0, 150.0, 60.0, 70.0, 18.0, -22.0, 21.0, 15.0, 120.0, 185.0, 620.0, 120.0, 370.0, 310.0, 120.0, 80.0, -45.0, 100.0, 90.0, -41.0, 70.0, 120.0, 80.0, 100.0, 50.0, 630.0, 90.0, 100.0, 60.0, 55.0, 510.0, 110.0, 44.0, 120.0, -16.0, 45.0, 90.0, 110.0, 80.0, 49.0, 80.0, 30.0, 103.0, 90.0, 80.0, 60.0, 410.0, 50.0, 110.0, 90.0, 48.0, 63.0, -50.0, -11.0, 130.0, 30.0, 303.0, 76.0, 60.0, 244.0, 35.0, 128.0, 30.0, 48.0, 50.0, 79.0, 10.0, 80.0, 105.0, 90.0, 68.0, 48.0, 208.0, 9.0, 190.0, 110.0, 120.0, 420.0, 76.0, 120.0, 60.0, 100.0, 170.0, 70.0, 110.0, 100.0, 80.0, 180.0, 59.0, 120.0, 60.0, 70.0, 70.0, 90.0, -40.0, 59.0, 70.0, 70.0, 130.0, 70.0, -1.0, 261.0, 60.0, 48.0, 70.0, 62.0, 10.0, 80.0, 170.0, 110.0, 25.0, 60.0, 90.0, 51.0, 110.0, 77.0, 210.0, 100.0, 30.0, 50.0, 100.0, 100.0, 70.0, -220.0, -1.0, 79.0, 60.0, 59.0, 70.0, 480.0, 30.0, 67.0, 110.0, 80.0, -46.0, 44.0, 90.0, -44.0, 90.0, 70.0, 60.0, 72.0, 48.0, 80.0, 20.0, 50.0, 50.0, 20.0, 130.0, 29.0, 25.0, 57.0, 39.0, 150.0, 170.0, 28.0, 110.0, 150.0, 90.0, 38.0, 80.0, 40.0, 80.0, 120.0, 130.0, 30.0, 170.0, 70.0, 80.0, 60.0, 220.0, -139.0, 130.0, 130.0, 200.0, 80.0, 90.0, 90.0, 200.0, 110.0, 5.0, 100.0, 40.0, 80.0, 40.0, 30.0, -13.0, 37.0, 140.0, 120.0, 60.0, 70.0, 70.0, 40.0, 130.0, 310.0, 70.0, 21.0, 274.0, 40.0, -6.0, 70.0, 70.0, 19.0, 100.0, 50.0, 90.0, 60.0, 80.0, 70.0, 70.0, 70.0, 100.0, 100.0, 120.0, 73.0, 140.0, 421.0, 60.0, 110.0, 70.0, 97.0, 35.0, 68.0, 55.0, 110.0, 180.0, 60.0, 450.0, 170.0, 40.0, 55.0, 328.0, 50.0, 80.0, -1.0, 70.0, 65.0, 80.0, 90.0, 49.0, 100.0, 220.0, 110.0, 120.0, 90.0, 100.0, -10.0, 130.0, 46.0, 120.0, 107.0, 204.0, -60.0, 70.0, 190.0, 100.0, 70.0, 139.0, 130.0, 80.0, 60.0, 88.0, 80.0, 100.0, 110.0, 80.0, 61.0, 69.0, 29.0, 64.0, 55.0, 70.0, 40.0, 350.0, 120.0, 135.0, 240.0, 88.0, 80.0, 130.0, 70.0, 45.0, 180.0, 40.0, 0.0, 180.0, 70.0, 20.0, 150.0, 120.0, 90.0, 67.0, 118.0, 70.0, 190.0, 593.0, -13.0, 110.0, 118.0, 70.0, 60.0, 120.0, 80.0, 69.0, 60.0, 30.0, 8.0, 150.0, 90.0, 80.0, 100.0, 16.0, 18.0, 285.0, 120.0, 120.0, 60.0, 170.0, 57.0, 40.0, 80.0, 60.0, 70.0, 40.0, 9.0, 25.0, 70.0, 30.0, 0.0, 90.0, 180.0, 13.0, 150.0, 27.0, 99.0, 76.0, 130.0, 38.0, 106.0, 85.0, 50.0, 48.0, 179.0, 190.0, 30.0, 30.0, 59.0, 80.0, 90.0, 60.0, 94.0, 79.0, 106.0, 90.0, 190.0, 70.0, 60.0, 100.0, 34.0, 90.0, 40.0, 312.0, 50.0, 70.0, 60.0, 7.0, 70.0, 50.0, 100.0, 90.0, 630.0, 30.0, 230.0, 60.0, 160.0, 59.0, 60.0, 90.0, 80.0, 96.0, 70.0, 50.0, 110.0, 52.0, 40.0, 68.0, 52.0, 60.0, 121.0, 725.0, -60.0, 130.0, 0.0, -20.0, 80.0, -231.0, 50.0, 370.0, 80.0, 80.0, 100.0, 140.0, 78.0, 60.0, 40.0, 120.0, 100.0, 0.0, 100.0, 80.0, 50.0, 100.0, 300.0, 170.0, 80.0, 90.0, 90.0, 90.0, 58.0, 66.0, 56.0, 50.0, 289.0, 110.0, 70.0, 40.0, 70.0, 110.0, 59.0, 226.0, 50.0, 26.0, 166.0, 50.0, 57.0, -6.0, 110.0, 120.0, 190.0, 50.0, 80.0, 89.0, 90.0, 90.0, 70.0, 90.0, 100.0, 210.0, 136.0, 341.0, 7.0, 120.0, 167.0, 70.0, 48.0, -8.0, 84.0, -15.0, 90.0, 393.0, 108.0, 280.0, 130.0, 130.0, 90.0, 230.0, 20.0, 110.0, 109.0, -5.0, 90.0, 139.0, 98.0, 109.0, 100.0, 119.0, 90.0, 87.0, -30.0, 140.0, 105.0, 1350.0, 80.0, 10.0, -65.0, 120.0, 50.0, 425.0, 110.0, 20.0, 26.0, 90.0, -65.0, 100.0, 80.0, 79.0, 60.0, 110.0, -40.0, 48.0, 90.0, 118.0, 20.0, 41.0, 70.0, 90.0, 13.0, 190.0, 130.0, 90.0, 70.0, 20.0, 40.0, 140.0, 99.0, 90.0, -64.0, 80.0, 110.0, 140.0, 108.0, 25.0, 70.0, 110.0, 50.0, 70.0, 20.0, 70.0, 4.0, 190.0, 65.0, 120.0, 25.0, 20.0, -20.0, 10.0, 120.0, 50.0, 130.0, 310.0, -30.0, 20.0, -25.0, 55.0, 110.0, 20.0, 19.0, 60.0, 269.0, 120.0, 100.0, 330.0, 100.0, 300.0, 320.0, 65.0, 40.0, 90.0, 20.0, 90.0, 55.0, 59.0, 60.0, 90.0, 100.0, 70.0, 100.0, 80.0, 75.0, 20.0, 190.0, -11.0, 126.0, 80.0, 46.0, 80.0, 70.0, 100.0, 80.0, 108.0, 122.0, 109.0, 90.0, 100.0, 112.0, 70.0, 70.0, 79.0, 85.0, 50.0, 38.0, 45.0, 37.0, -5.0, 30.0, -50.0, 10.0, 130.0, 30.0, 70.0, 50.0, 70.0, 60.0, 40.0, 100.0, 220.0, 90.0, 410.0, -121.0, 120.0, 200.0, 64.0, 210.0, 60.0, 99.0, 46.0, 100.0, 62.0, 40.0, 90.0, 80.0, 650.0, 60.0, 130.0, 130.0, 200.0, 49.0, 50.0, 50.0, 40.0, 129.0, 107.0, 18.0, 81.0, 21.0, 110.0, 131.0, 30.0, 104.0, 45.0, 100.0, 20.0, 60.0, 60.0, 100.0, 25.0, 90.0, 130.0, 50.0, 110.0, 95.0, 25.0, 110.0, 80.0, 70.0, 380.0, 50.0, -20.0, 130.0, 140.0, 189.0, 468.0, 120.0, 50.0, 60.0, 127.0, 90.0, 300.0, 520.0, 110.0, 69.0, 60.0, 66.0, 97.0, 110.0, 107.0, 59.0, 110.0, 95.0, 40.0, 90.0, 120.0, 110.0, 45.0, 65.0, 70.0, 110.0, 230.0, 179.0, 106.0, -54.0, 170.0, 80.0, 265.0, 70.0, 393.0, 190.0, -18.0, 130.0, 80.0, 110.0, 709.0, 21.0, 81.0, 100.0, 79.0, 200.0, 51.0, 80.0, 120.0, 110.0, 40.0, 80.0, 120.0, 150.0, 70.0, 77.0, 30.0, 7.0, 27.0, 65.0, 30.0, 130.0, 80.0, 56.0, 100.0, 20.0, 39.0, 80.0, -60.0, 430.0, 80.0, 60.0, 89.0, 120.0, 136.0, 100.0, 170.0, 12.0, 50.0, 180.0, 150.0, 90.0, 164.0, -10.0, 90.0, 50.0, 54.0, 300.0, 28.0, 40.0, 270.0, 57.0, 130.0, 75.0, 24.0, 80.0, 117.0, 400.0, -5.0, 50.0, 50.0, 90.0, 60.0, 60.0, 70.0, 50.0, 3.0, 40.0, 120.0, 110.0, 100.0, 72.0, 70.0, 60.0, 90.0, 70.0, 100.0, -15.0, 20.0, 30.0, 3.0, 40.0, 240.0, 9.0, 156.0, 50.0, 40.0, 40.0, 60.0, 80.0, 83.0, 100.0, 49.0, 100.0, 70.0, -50.0, 80.0, 62.0, 210.0, 70.0, -15.0, 100.0, 30.0, 60.0, 0.0, 60.0, 40.0, 60.0, 60.0, 50.0, 90.0, 90.0, 67.0, 88.0, 68.0, 60.0, 90.0, 319.0, 108.0, 30.0, 56.0, 530.0, 75.0, 22.0, 35.0, 70.0, 80.0, 12.0, 60.0, 80.0, 390.0, 100.0, 50.0, -80.0, 52.0, 60.0, 30.0, 72.0, 28.0, 67.0, 50.0, 42.0, 45.0, 100.0, 100.0, 30.0, 76.0, 44.0, 50.0, 120.0, 53.0, 34.0, 90.0, -13.0, 268.0, 27.0, 120.0, 30.0, 49.0, 42.0, 50.0, 180.0, 105.0, 30.0, 70.0, 130.0, 70.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9257653770628724, "mean_inference_ms": 2.173006392830988, "mean_action_processing_ms": 0.7369679937479228, "mean_env_wait_ms": 1.5178267333799094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06927490234375, "StateBufferConnector_ms": 0.015583992004394531, "ViewRequirementAgentConnector_ms": 0.4523775577545166}, "num_episodes": 22, "episode_return_max": 2325.0, "episode_return_min": 315.0, "episode_return_mean": 952.49, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.620762937149365, "num_env_steps_trained_throughput_per_sec": 32.620762937149365, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 5240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5240000, "timers": {"training_iteration_time_ms": 122550.328, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122550.277, "sample_time_ms": 3223.759, "learn_time_ms": 119303.377, "learn_throughput": 33.528, "synch_weights_time_ms": 12.762}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "done": false, "training_iteration": 131, "trial_id": "6085c_00000", "date": "2024-07-02_03-26-12", "timestamp": 1719905172, "time_this_iter_s": 122.64060997962952, "time_total_s": 18017.204963207245, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c933a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18017.204963207245, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 20.78965517241379, "ram_util_percent": 78.07931034482758}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7807397922133994, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.914775832798788, "policy_loss": -0.007341374597671869, "vf_loss": 7.921026879098342, "vf_explained_var": 0.0009567775601903979, "kl": 0.0072688472915286104, "entropy": 0.5173074066734161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1234785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "env_runners": {"episode_reward_max": 2325.0, "episode_reward_min": 315.0, "episode_reward_mean": 957.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -531.0}, "policy_reward_max": {"policy_0": 1350.0}, "policy_reward_mean": {"policy_0": 95.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [893.0, 655.0, 1369.0, 1049.0, 649.0, 870.0, 803.0, 797.0, 491.0, 559.0, 857.0, 860.0, 1111.0, 579.0, 1085.0, 603.0, 1264.0, 1295.0, 857.0, 955.0, 1070.0, 757.0, 1242.0, 885.0, 1463.0, 737.0, 1026.0, 424.0, 909.0, 841.0, 883.0, 849.0, 1489.0, 719.0, 1124.0, 818.0, 1108.0, 920.0, 989.0, 1005.0, 904.0, 1600.0, 797.0, 2325.0, 460.0, 810.0, 675.0, 667.0, 710.0, 808.0, 1485.0, 779.0, 781.0, 945.0, 315.0, 989.0, 1001.0, 1489.0, 771.0, 680.0, 1030.0, 2064.0, 883.0, 1059.0, 1332.0, 1511.0, 804.0, 627.0, 1137.0, 1118.0, 1221.0, 468.0, 777.0, 628.0, 634.0, 615.0, 982.0, 1018.0, 814.0, 582.0, 779.0, 786.0, 1019.0, 740.0, 1343.0, 911.0, 1124.0, 1997.0, 1102.0, 1005.0, 1018.0, 729.0, 811.0, 1411.0, 371.0, 1667.0, 825.0, 1003.0, 792.0, 1143.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [48.0, 63.0, -50.0, -11.0, 130.0, 30.0, 303.0, 76.0, 60.0, 244.0, 35.0, 128.0, 30.0, 48.0, 50.0, 79.0, 10.0, 80.0, 105.0, 90.0, 68.0, 48.0, 208.0, 9.0, 190.0, 110.0, 120.0, 420.0, 76.0, 120.0, 60.0, 100.0, 170.0, 70.0, 110.0, 100.0, 80.0, 180.0, 59.0, 120.0, 60.0, 70.0, 70.0, 90.0, -40.0, 59.0, 70.0, 70.0, 130.0, 70.0, -1.0, 261.0, 60.0, 48.0, 70.0, 62.0, 10.0, 80.0, 170.0, 110.0, 25.0, 60.0, 90.0, 51.0, 110.0, 77.0, 210.0, 100.0, 30.0, 50.0, 100.0, 100.0, 70.0, -220.0, -1.0, 79.0, 60.0, 59.0, 70.0, 480.0, 30.0, 67.0, 110.0, 80.0, -46.0, 44.0, 90.0, -44.0, 90.0, 70.0, 60.0, 72.0, 48.0, 80.0, 20.0, 50.0, 50.0, 20.0, 130.0, 29.0, 25.0, 57.0, 39.0, 150.0, 170.0, 28.0, 110.0, 150.0, 90.0, 38.0, 80.0, 40.0, 80.0, 120.0, 130.0, 30.0, 170.0, 70.0, 80.0, 60.0, 220.0, -139.0, 130.0, 130.0, 200.0, 80.0, 90.0, 90.0, 200.0, 110.0, 5.0, 100.0, 40.0, 80.0, 40.0, 30.0, -13.0, 37.0, 140.0, 120.0, 60.0, 70.0, 70.0, 40.0, 130.0, 310.0, 70.0, 21.0, 274.0, 40.0, -6.0, 70.0, 70.0, 19.0, 100.0, 50.0, 90.0, 60.0, 80.0, 70.0, 70.0, 70.0, 100.0, 100.0, 120.0, 73.0, 140.0, 421.0, 60.0, 110.0, 70.0, 97.0, 35.0, 68.0, 55.0, 110.0, 180.0, 60.0, 450.0, 170.0, 40.0, 55.0, 328.0, 50.0, 80.0, -1.0, 70.0, 65.0, 80.0, 90.0, 49.0, 100.0, 220.0, 110.0, 120.0, 90.0, 100.0, -10.0, 130.0, 46.0, 120.0, 107.0, 204.0, -60.0, 70.0, 190.0, 100.0, 70.0, 139.0, 130.0, 80.0, 60.0, 88.0, 80.0, 100.0, 110.0, 80.0, 61.0, 69.0, 29.0, 64.0, 55.0, 70.0, 40.0, 350.0, 120.0, 135.0, 240.0, 88.0, 80.0, 130.0, 70.0, 45.0, 180.0, 40.0, 0.0, 180.0, 70.0, 20.0, 150.0, 120.0, 90.0, 67.0, 118.0, 70.0, 190.0, 593.0, -13.0, 110.0, 118.0, 70.0, 60.0, 120.0, 80.0, 69.0, 60.0, 30.0, 8.0, 150.0, 90.0, 80.0, 100.0, 16.0, 18.0, 285.0, 120.0, 120.0, 60.0, 170.0, 57.0, 40.0, 80.0, 60.0, 70.0, 40.0, 9.0, 25.0, 70.0, 30.0, 0.0, 90.0, 180.0, 13.0, 150.0, 27.0, 99.0, 76.0, 130.0, 38.0, 106.0, 85.0, 50.0, 48.0, 179.0, 190.0, 30.0, 30.0, 59.0, 80.0, 90.0, 60.0, 94.0, 79.0, 106.0, 90.0, 190.0, 70.0, 60.0, 100.0, 34.0, 90.0, 40.0, 312.0, 50.0, 70.0, 60.0, 7.0, 70.0, 50.0, 100.0, 90.0, 630.0, 30.0, 230.0, 60.0, 160.0, 59.0, 60.0, 90.0, 80.0, 96.0, 70.0, 50.0, 110.0, 52.0, 40.0, 68.0, 52.0, 60.0, 121.0, 725.0, -60.0, 130.0, 0.0, -20.0, 80.0, -231.0, 50.0, 370.0, 80.0, 80.0, 100.0, 140.0, 78.0, 60.0, 40.0, 120.0, 100.0, 0.0, 100.0, 80.0, 50.0, 100.0, 300.0, 170.0, 80.0, 90.0, 90.0, 90.0, 58.0, 66.0, 56.0, 50.0, 289.0, 110.0, 70.0, 40.0, 70.0, 110.0, 59.0, 226.0, 50.0, 26.0, 166.0, 50.0, 57.0, -6.0, 110.0, 120.0, 190.0, 50.0, 80.0, 89.0, 90.0, 90.0, 70.0, 90.0, 100.0, 210.0, 136.0, 341.0, 7.0, 120.0, 167.0, 70.0, 48.0, -8.0, 84.0, -15.0, 90.0, 393.0, 108.0, 280.0, 130.0, 130.0, 90.0, 230.0, 20.0, 110.0, 109.0, -5.0, 90.0, 139.0, 98.0, 109.0, 100.0, 119.0, 90.0, 87.0, -30.0, 140.0, 105.0, 1350.0, 80.0, 10.0, -65.0, 120.0, 50.0, 425.0, 110.0, 20.0, 26.0, 90.0, -65.0, 100.0, 80.0, 79.0, 60.0, 110.0, -40.0, 48.0, 90.0, 118.0, 20.0, 41.0, 70.0, 90.0, 13.0, 190.0, 130.0, 90.0, 70.0, 20.0, 40.0, 140.0, 99.0, 90.0, -64.0, 80.0, 110.0, 140.0, 108.0, 25.0, 70.0, 110.0, 50.0, 70.0, 20.0, 70.0, 4.0, 190.0, 65.0, 120.0, 25.0, 20.0, -20.0, 10.0, 120.0, 50.0, 130.0, 310.0, -30.0, 20.0, -25.0, 55.0, 110.0, 20.0, 19.0, 60.0, 269.0, 120.0, 100.0, 330.0, 100.0, 300.0, 320.0, 65.0, 40.0, 90.0, 20.0, 90.0, 55.0, 59.0, 60.0, 90.0, 100.0, 70.0, 100.0, 80.0, 75.0, 20.0, 190.0, -11.0, 126.0, 80.0, 46.0, 80.0, 70.0, 100.0, 80.0, 108.0, 122.0, 109.0, 90.0, 100.0, 112.0, 70.0, 70.0, 79.0, 85.0, 50.0, 38.0, 45.0, 37.0, -5.0, 30.0, -50.0, 10.0, 130.0, 30.0, 70.0, 50.0, 70.0, 60.0, 40.0, 100.0, 220.0, 90.0, 410.0, -121.0, 120.0, 200.0, 64.0, 210.0, 60.0, 99.0, 46.0, 100.0, 62.0, 40.0, 90.0, 80.0, 650.0, 60.0, 130.0, 130.0, 200.0, 49.0, 50.0, 50.0, 40.0, 129.0, 107.0, 18.0, 81.0, 21.0, 110.0, 131.0, 30.0, 104.0, 45.0, 100.0, 20.0, 60.0, 60.0, 100.0, 25.0, 90.0, 130.0, 50.0, 110.0, 95.0, 25.0, 110.0, 80.0, 70.0, 380.0, 50.0, -20.0, 130.0, 140.0, 189.0, 468.0, 120.0, 50.0, 60.0, 127.0, 90.0, 300.0, 520.0, 110.0, 69.0, 60.0, 66.0, 97.0, 110.0, 107.0, 59.0, 110.0, 95.0, 40.0, 90.0, 120.0, 110.0, 45.0, 65.0, 70.0, 110.0, 230.0, 179.0, 106.0, -54.0, 170.0, 80.0, 265.0, 70.0, 393.0, 190.0, -18.0, 130.0, 80.0, 110.0, 709.0, 21.0, 81.0, 100.0, 79.0, 200.0, 51.0, 80.0, 120.0, 110.0, 40.0, 80.0, 120.0, 150.0, 70.0, 77.0, 30.0, 7.0, 27.0, 65.0, 30.0, 130.0, 80.0, 56.0, 100.0, 20.0, 39.0, 80.0, -60.0, 430.0, 80.0, 60.0, 89.0, 120.0, 136.0, 100.0, 170.0, 12.0, 50.0, 180.0, 150.0, 90.0, 164.0, -10.0, 90.0, 50.0, 54.0, 300.0, 28.0, 40.0, 270.0, 57.0, 130.0, 75.0, 24.0, 80.0, 117.0, 400.0, -5.0, 50.0, 50.0, 90.0, 60.0, 60.0, 70.0, 50.0, 3.0, 40.0, 120.0, 110.0, 100.0, 72.0, 70.0, 60.0, 90.0, 70.0, 100.0, -15.0, 20.0, 30.0, 3.0, 40.0, 240.0, 9.0, 156.0, 50.0, 40.0, 40.0, 60.0, 80.0, 83.0, 100.0, 49.0, 100.0, 70.0, -50.0, 80.0, 62.0, 210.0, 70.0, -15.0, 100.0, 30.0, 60.0, 0.0, 60.0, 40.0, 60.0, 60.0, 50.0, 90.0, 90.0, 67.0, 88.0, 68.0, 60.0, 90.0, 319.0, 108.0, 30.0, 56.0, 530.0, 75.0, 22.0, 35.0, 70.0, 80.0, 12.0, 60.0, 80.0, 390.0, 100.0, 50.0, -80.0, 52.0, 60.0, 30.0, 72.0, 28.0, 67.0, 50.0, 42.0, 45.0, 100.0, 100.0, 30.0, 76.0, 44.0, 50.0, 120.0, 53.0, 34.0, 90.0, -13.0, 268.0, 27.0, 120.0, 30.0, 49.0, 42.0, 50.0, 180.0, 105.0, 30.0, 70.0, 130.0, 70.0, 60.0, 90.0, 150.0, 140.0, 100.0, 59.0, 70.0, 40.0, 90.0, 160.0, 120.0, 50.0, 50.0, 40.0, 100.0, 110.0, 50.0, 120.0, 50.0, 100.0, 70.0, 80.0, 110.0, 100.0, 220.0, 130.0, 33.0, 29.0, 78.0, 503.0, 60.0, 110.0, 56.0, 119.0, 10.0, 290.0, 43.0, 96.0, 87.0, 60.0, 40.0, 410.0, 140.0, -531.0, 83.0, 157.0, 80.0, 335.0, 130.0, 210.0, 110.0, 30.0, 110.0, 68.0, -10.0, 200.0, 30.0, 190.0, 310.0, 50.0, 1019.0, 100.0, 149.0, 4.0, 380.0, 50.0, 130.0, 90.0, 59.0, 180.0, -40.0, 160.0, 100.0, 30.0, 60.0, 100.0, 150.0, 20.0, 210.0, 65.0, 110.0, 60.0, 120.0, 120.0, 110.0, 80.0, 89.0, 190.0, 60.0, 79.0, 110.0, 59.0, -20.0, 60.0, 70.0, 70.0, 60.0, 80.0, 90.0, 220.0, 40.0, 65.0, 120.0, 90.0, 50.0, -8.0, 120.0, 190.0, 100.0, 50.0, 34.0, 49.0, -20.0, -54.0, 370.0, 130.0, 310.0, 69.0, -40.0, 527.0, 70.0, -7.0, 26.0, 30.0, -10.0, 100.0, 30.0, 12.0, 100.0, 70.0, 20.0, 130.0, 150.0, 230.0, 550.0, 248.0, 60.0, 35.0, 90.0, 85.0, 89.0, 70.0, 140.0, 50.0, 109.0, 47.0, 55.0, 60.0, 120.0, 94.0, 80.0, 90.0, 70.0, 90.0, 128.0, 70.0, 130.0, 95.0, 40.0, 230.0, 60.0, 80.0, 40.0, 170.0, 170.0, 15.0, 30.0, 110.0, 30.0, 27.0, 120.0, 210.0, 10.0, 25.0, -48.0, 100.0, 130.0, 120.0, 120.0, 296.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9225926977827605, "mean_inference_ms": 2.168208882728312, "mean_action_processing_ms": 0.7369348841371397, "mean_env_wait_ms": 1.5149531848293707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06729364395141602, "StateBufferConnector_ms": 0.015372037887573242, "ViewRequirementAgentConnector_ms": 0.44371819496154785}, "num_episodes": 18, "episode_return_max": 2325.0, "episode_return_min": 315.0, "episode_return_mean": 957.3, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.579315684216816, "num_env_steps_trained_throughput_per_sec": 32.579315684216816, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 5280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5280000, "timers": {"training_iteration_time_ms": 122413.669, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122413.617, "sample_time_ms": 3159.811, "learn_time_ms": 119230.804, "learn_throughput": 33.548, "synch_weights_time_ms": 12.581}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "done": false, "training_iteration": 132, "trial_id": "6085c_00000", "date": "2024-07-02_03-28-14", "timestamp": 1719905294, "time_this_iter_s": 122.7901120185852, "time_total_s": 18139.99507522583, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138aa7dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18139.99507522583, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 20.88208092485549, "ram_util_percent": 78.6092485549133}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.567734201996725, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.741800494849111, "policy_loss": -0.007999733000739822, "vf_loss": 7.748546194497008, "vf_explained_var": 0.0007127515805034211, "kl": 0.008360221768503075, "entropy": 0.5334247359198631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1244175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "env_runners": {"episode_reward_max": 2325.0, "episode_reward_min": 315.0, "episode_reward_mean": 989.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -531.0}, "policy_reward_max": {"policy_0": 1350.0}, "policy_reward_mean": {"policy_0": 98.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [857.0, 955.0, 1070.0, 757.0, 1242.0, 885.0, 1463.0, 737.0, 1026.0, 424.0, 909.0, 841.0, 883.0, 849.0, 1489.0, 719.0, 1124.0, 818.0, 1108.0, 920.0, 989.0, 1005.0, 904.0, 1600.0, 797.0, 2325.0, 460.0, 810.0, 675.0, 667.0, 710.0, 808.0, 1485.0, 779.0, 781.0, 945.0, 315.0, 989.0, 1001.0, 1489.0, 771.0, 680.0, 1030.0, 2064.0, 883.0, 1059.0, 1332.0, 1511.0, 804.0, 627.0, 1137.0, 1118.0, 1221.0, 468.0, 777.0, 628.0, 634.0, 615.0, 982.0, 1018.0, 814.0, 582.0, 779.0, 786.0, 1019.0, 740.0, 1343.0, 911.0, 1124.0, 1997.0, 1102.0, 1005.0, 1018.0, 729.0, 811.0, 1411.0, 371.0, 1667.0, 825.0, 1003.0, 792.0, 1143.0, 624.0, 951.0, 1879.0, 1101.0, 1405.0, 684.0, 1698.0, 973.0, 828.0, 1108.0, 1254.0, 1161.0, 583.0, 673.0, 1199.0, 885.0, 1180.0, 833.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 55.0, 328.0, 50.0, 80.0, -1.0, 70.0, 65.0, 80.0, 90.0, 49.0, 100.0, 220.0, 110.0, 120.0, 90.0, 100.0, -10.0, 130.0, 46.0, 120.0, 107.0, 204.0, -60.0, 70.0, 190.0, 100.0, 70.0, 139.0, 130.0, 80.0, 60.0, 88.0, 80.0, 100.0, 110.0, 80.0, 61.0, 69.0, 29.0, 64.0, 55.0, 70.0, 40.0, 350.0, 120.0, 135.0, 240.0, 88.0, 80.0, 130.0, 70.0, 45.0, 180.0, 40.0, 0.0, 180.0, 70.0, 20.0, 150.0, 120.0, 90.0, 67.0, 118.0, 70.0, 190.0, 593.0, -13.0, 110.0, 118.0, 70.0, 60.0, 120.0, 80.0, 69.0, 60.0, 30.0, 8.0, 150.0, 90.0, 80.0, 100.0, 16.0, 18.0, 285.0, 120.0, 120.0, 60.0, 170.0, 57.0, 40.0, 80.0, 60.0, 70.0, 40.0, 9.0, 25.0, 70.0, 30.0, 0.0, 90.0, 180.0, 13.0, 150.0, 27.0, 99.0, 76.0, 130.0, 38.0, 106.0, 85.0, 50.0, 48.0, 179.0, 190.0, 30.0, 30.0, 59.0, 80.0, 90.0, 60.0, 94.0, 79.0, 106.0, 90.0, 190.0, 70.0, 60.0, 100.0, 34.0, 90.0, 40.0, 312.0, 50.0, 70.0, 60.0, 7.0, 70.0, 50.0, 100.0, 90.0, 630.0, 30.0, 230.0, 60.0, 160.0, 59.0, 60.0, 90.0, 80.0, 96.0, 70.0, 50.0, 110.0, 52.0, 40.0, 68.0, 52.0, 60.0, 121.0, 725.0, -60.0, 130.0, 0.0, -20.0, 80.0, -231.0, 50.0, 370.0, 80.0, 80.0, 100.0, 140.0, 78.0, 60.0, 40.0, 120.0, 100.0, 0.0, 100.0, 80.0, 50.0, 100.0, 300.0, 170.0, 80.0, 90.0, 90.0, 90.0, 58.0, 66.0, 56.0, 50.0, 289.0, 110.0, 70.0, 40.0, 70.0, 110.0, 59.0, 226.0, 50.0, 26.0, 166.0, 50.0, 57.0, -6.0, 110.0, 120.0, 190.0, 50.0, 80.0, 89.0, 90.0, 90.0, 70.0, 90.0, 100.0, 210.0, 136.0, 341.0, 7.0, 120.0, 167.0, 70.0, 48.0, -8.0, 84.0, -15.0, 90.0, 393.0, 108.0, 280.0, 130.0, 130.0, 90.0, 230.0, 20.0, 110.0, 109.0, -5.0, 90.0, 139.0, 98.0, 109.0, 100.0, 119.0, 90.0, 87.0, -30.0, 140.0, 105.0, 1350.0, 80.0, 10.0, -65.0, 120.0, 50.0, 425.0, 110.0, 20.0, 26.0, 90.0, -65.0, 100.0, 80.0, 79.0, 60.0, 110.0, -40.0, 48.0, 90.0, 118.0, 20.0, 41.0, 70.0, 90.0, 13.0, 190.0, 130.0, 90.0, 70.0, 20.0, 40.0, 140.0, 99.0, 90.0, -64.0, 80.0, 110.0, 140.0, 108.0, 25.0, 70.0, 110.0, 50.0, 70.0, 20.0, 70.0, 4.0, 190.0, 65.0, 120.0, 25.0, 20.0, -20.0, 10.0, 120.0, 50.0, 130.0, 310.0, -30.0, 20.0, -25.0, 55.0, 110.0, 20.0, 19.0, 60.0, 269.0, 120.0, 100.0, 330.0, 100.0, 300.0, 320.0, 65.0, 40.0, 90.0, 20.0, 90.0, 55.0, 59.0, 60.0, 90.0, 100.0, 70.0, 100.0, 80.0, 75.0, 20.0, 190.0, -11.0, 126.0, 80.0, 46.0, 80.0, 70.0, 100.0, 80.0, 108.0, 122.0, 109.0, 90.0, 100.0, 112.0, 70.0, 70.0, 79.0, 85.0, 50.0, 38.0, 45.0, 37.0, -5.0, 30.0, -50.0, 10.0, 130.0, 30.0, 70.0, 50.0, 70.0, 60.0, 40.0, 100.0, 220.0, 90.0, 410.0, -121.0, 120.0, 200.0, 64.0, 210.0, 60.0, 99.0, 46.0, 100.0, 62.0, 40.0, 90.0, 80.0, 650.0, 60.0, 130.0, 130.0, 200.0, 49.0, 50.0, 50.0, 40.0, 129.0, 107.0, 18.0, 81.0, 21.0, 110.0, 131.0, 30.0, 104.0, 45.0, 100.0, 20.0, 60.0, 60.0, 100.0, 25.0, 90.0, 130.0, 50.0, 110.0, 95.0, 25.0, 110.0, 80.0, 70.0, 380.0, 50.0, -20.0, 130.0, 140.0, 189.0, 468.0, 120.0, 50.0, 60.0, 127.0, 90.0, 300.0, 520.0, 110.0, 69.0, 60.0, 66.0, 97.0, 110.0, 107.0, 59.0, 110.0, 95.0, 40.0, 90.0, 120.0, 110.0, 45.0, 65.0, 70.0, 110.0, 230.0, 179.0, 106.0, -54.0, 170.0, 80.0, 265.0, 70.0, 393.0, 190.0, -18.0, 130.0, 80.0, 110.0, 709.0, 21.0, 81.0, 100.0, 79.0, 200.0, 51.0, 80.0, 120.0, 110.0, 40.0, 80.0, 120.0, 150.0, 70.0, 77.0, 30.0, 7.0, 27.0, 65.0, 30.0, 130.0, 80.0, 56.0, 100.0, 20.0, 39.0, 80.0, -60.0, 430.0, 80.0, 60.0, 89.0, 120.0, 136.0, 100.0, 170.0, 12.0, 50.0, 180.0, 150.0, 90.0, 164.0, -10.0, 90.0, 50.0, 54.0, 300.0, 28.0, 40.0, 270.0, 57.0, 130.0, 75.0, 24.0, 80.0, 117.0, 400.0, -5.0, 50.0, 50.0, 90.0, 60.0, 60.0, 70.0, 50.0, 3.0, 40.0, 120.0, 110.0, 100.0, 72.0, 70.0, 60.0, 90.0, 70.0, 100.0, -15.0, 20.0, 30.0, 3.0, 40.0, 240.0, 9.0, 156.0, 50.0, 40.0, 40.0, 60.0, 80.0, 83.0, 100.0, 49.0, 100.0, 70.0, -50.0, 80.0, 62.0, 210.0, 70.0, -15.0, 100.0, 30.0, 60.0, 0.0, 60.0, 40.0, 60.0, 60.0, 50.0, 90.0, 90.0, 67.0, 88.0, 68.0, 60.0, 90.0, 319.0, 108.0, 30.0, 56.0, 530.0, 75.0, 22.0, 35.0, 70.0, 80.0, 12.0, 60.0, 80.0, 390.0, 100.0, 50.0, -80.0, 52.0, 60.0, 30.0, 72.0, 28.0, 67.0, 50.0, 42.0, 45.0, 100.0, 100.0, 30.0, 76.0, 44.0, 50.0, 120.0, 53.0, 34.0, 90.0, -13.0, 268.0, 27.0, 120.0, 30.0, 49.0, 42.0, 50.0, 180.0, 105.0, 30.0, 70.0, 130.0, 70.0, 60.0, 90.0, 150.0, 140.0, 100.0, 59.0, 70.0, 40.0, 90.0, 160.0, 120.0, 50.0, 50.0, 40.0, 100.0, 110.0, 50.0, 120.0, 50.0, 100.0, 70.0, 80.0, 110.0, 100.0, 220.0, 130.0, 33.0, 29.0, 78.0, 503.0, 60.0, 110.0, 56.0, 119.0, 10.0, 290.0, 43.0, 96.0, 87.0, 60.0, 40.0, 410.0, 140.0, -531.0, 83.0, 157.0, 80.0, 335.0, 130.0, 210.0, 110.0, 30.0, 110.0, 68.0, -10.0, 200.0, 30.0, 190.0, 310.0, 50.0, 1019.0, 100.0, 149.0, 4.0, 380.0, 50.0, 130.0, 90.0, 59.0, 180.0, -40.0, 160.0, 100.0, 30.0, 60.0, 100.0, 150.0, 20.0, 210.0, 65.0, 110.0, 60.0, 120.0, 120.0, 110.0, 80.0, 89.0, 190.0, 60.0, 79.0, 110.0, 59.0, -20.0, 60.0, 70.0, 70.0, 60.0, 80.0, 90.0, 220.0, 40.0, 65.0, 120.0, 90.0, 50.0, -8.0, 120.0, 190.0, 100.0, 50.0, 34.0, 49.0, -20.0, -54.0, 370.0, 130.0, 310.0, 69.0, -40.0, 527.0, 70.0, -7.0, 26.0, 30.0, -10.0, 100.0, 30.0, 12.0, 100.0, 70.0, 20.0, 130.0, 150.0, 230.0, 550.0, 248.0, 60.0, 35.0, 90.0, 85.0, 89.0, 70.0, 140.0, 50.0, 109.0, 47.0, 55.0, 60.0, 120.0, 94.0, 80.0, 90.0, 70.0, 90.0, 128.0, 70.0, 130.0, 95.0, 40.0, 230.0, 60.0, 80.0, 40.0, 170.0, 170.0, 15.0, 30.0, 110.0, 30.0, 27.0, 120.0, 210.0, 10.0, 25.0, -48.0, 100.0, 130.0, 120.0, 120.0, 296.0, 180.0, 17.0, 27.0, 80.0, 130.0, -76.0, 17.0, 280.0, 29.0, 50.0, 70.0, 20.0, -55.0, 50.0, 90.0, 90.0, 29.0, 177.0, 310.0, 80.0, 160.0, 140.0, 340.0, 200.0, 130.0, 416.0, 10.0, 50.0, 70.0, 470.0, 53.0, 110.0, 109.0, 127.0, 40.0, 10.0, 455.0, 70.0, 10.0, 90.0, 80.0, 100.0, 100.0, 80.0, 70.0, 520.0, 110.0, 120.0, 90.0, 95.0, 120.0, 143.0, 45.0, 80.0, 100.0, 60.0, 160.0, 20.0, 50.0, 80.0, -54.0, 70.0, 90.0, 120.0, 80.0, 124.0, -35.0, 450.0, 640.0, 79.0, 80.0, 180.0, 100.0, 110.0, -15.0, 609.0, 60.0, 20.0, -250.0, 90.0, 69.0, 90.0, 40.0, 90.0, 30.0, 170.0, 70.0, 100.0, 50.0, 68.0, 120.0, 170.0, -25.0, 90.0, 40.0, 408.0, 120.0, 70.0, 88.0, 98.0, 49.0, 190.0, 120.0, 250.0, 100.0, 66.0, 100.0, 110.0, 130.0, 128.0, 60.0, 67.0, 70.0, 280.0, 29.0, 440.0, 110.0, 0.0, 70.0, 120.0, -25.0, 70.0, 60.0, 70.0, 60.0, 70.0, 90.0, 29.0, 15.0, 59.0, 60.0, 200.0, -5.0, 80.0, 60.0, 50.0, 100.0, 88.0, -20.0, 140.0, -20.0, 80.0, 306.0, 105.0, 100.0, 108.0, 70.0, 110.0, 190.0, 60.0, 70.0, 40.0, 156.0, 99.0, 100.0, 70.0, 120.0, 120.0, 120.0, -20.0, 80.0, 440.0, 70.0, 60.0, 80.0, 160.0, 100.0, 90.0, 10.0, 70.0, 100.0, 67.0, 56.0, 60.0, 90.0, 160.0, 40.0, 60.0, 50.0, 150.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9212228061988679, "mean_inference_ms": 2.1658339631602943, "mean_action_processing_ms": 0.7360316789180268, "mean_env_wait_ms": 1.5131279422444226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06805658340454102, "StateBufferConnector_ms": 0.015455245971679688, "ViewRequirementAgentConnector_ms": 0.4369847774505615}, "num_episodes": 18, "episode_return_max": 2325.0, "episode_return_min": 315.0, "episode_return_mean": 989.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.73608909053018, "num_env_steps_trained_throughput_per_sec": 32.73608909053018, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 5320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5320000, "timers": {"training_iteration_time_ms": 122383.189, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122383.134, "sample_time_ms": 3170.716, "learn_time_ms": 119188.372, "learn_throughput": 33.56, "synch_weights_time_ms": 12.864}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "done": false, "training_iteration": 133, "trial_id": "6085c_00000", "date": "2024-07-02_03-30-17", "timestamp": 1719905417, "time_this_iter_s": 122.20372819900513, "time_total_s": 18262.198803424835, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138bbd1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18262.198803424835, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 20.520809248554915, "ram_util_percent": 78.86647398843931}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6609813139398004, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.132113827023897, "policy_loss": -0.00774925411530077, "vf_loss": 8.138712774831266, "vf_explained_var": 0.0017037230304762705, "kl": 0.007668744582755324, "entropy": 0.5637282202323786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1253565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "env_runners": {"episode_reward_max": 2325.0, "episode_reward_min": 315.0, "episode_reward_mean": 1012.83, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -531.0}, "policy_reward_max": {"policy_0": 1350.0}, "policy_reward_mean": {"policy_0": 101.283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1600.0, 797.0, 2325.0, 460.0, 810.0, 675.0, 667.0, 710.0, 808.0, 1485.0, 779.0, 781.0, 945.0, 315.0, 989.0, 1001.0, 1489.0, 771.0, 680.0, 1030.0, 2064.0, 883.0, 1059.0, 1332.0, 1511.0, 804.0, 627.0, 1137.0, 1118.0, 1221.0, 468.0, 777.0, 628.0, 634.0, 615.0, 982.0, 1018.0, 814.0, 582.0, 779.0, 786.0, 1019.0, 740.0, 1343.0, 911.0, 1124.0, 1997.0, 1102.0, 1005.0, 1018.0, 729.0, 811.0, 1411.0, 371.0, 1667.0, 825.0, 1003.0, 792.0, 1143.0, 624.0, 951.0, 1879.0, 1101.0, 1405.0, 684.0, 1698.0, 973.0, 828.0, 1108.0, 1254.0, 1161.0, 583.0, 673.0, 1199.0, 885.0, 1180.0, 833.0, 1261.0, 1145.0, 699.0, 1046.0, 749.0, 1505.0, 1257.0, 960.0, 1365.0, 1124.0, 1508.0, 1239.0, 606.0, 1085.0, 1217.0, 817.0, 627.0, 1605.0, 1024.0, 507.0, 998.0, 682.0, 1271.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [393.0, 108.0, 280.0, 130.0, 130.0, 90.0, 230.0, 20.0, 110.0, 109.0, -5.0, 90.0, 139.0, 98.0, 109.0, 100.0, 119.0, 90.0, 87.0, -30.0, 140.0, 105.0, 1350.0, 80.0, 10.0, -65.0, 120.0, 50.0, 425.0, 110.0, 20.0, 26.0, 90.0, -65.0, 100.0, 80.0, 79.0, 60.0, 110.0, -40.0, 48.0, 90.0, 118.0, 20.0, 41.0, 70.0, 90.0, 13.0, 190.0, 130.0, 90.0, 70.0, 20.0, 40.0, 140.0, 99.0, 90.0, -64.0, 80.0, 110.0, 140.0, 108.0, 25.0, 70.0, 110.0, 50.0, 70.0, 20.0, 70.0, 4.0, 190.0, 65.0, 120.0, 25.0, 20.0, -20.0, 10.0, 120.0, 50.0, 130.0, 310.0, -30.0, 20.0, -25.0, 55.0, 110.0, 20.0, 19.0, 60.0, 269.0, 120.0, 100.0, 330.0, 100.0, 300.0, 320.0, 65.0, 40.0, 90.0, 20.0, 90.0, 55.0, 59.0, 60.0, 90.0, 100.0, 70.0, 100.0, 80.0, 75.0, 20.0, 190.0, -11.0, 126.0, 80.0, 46.0, 80.0, 70.0, 100.0, 80.0, 108.0, 122.0, 109.0, 90.0, 100.0, 112.0, 70.0, 70.0, 79.0, 85.0, 50.0, 38.0, 45.0, 37.0, -5.0, 30.0, -50.0, 10.0, 130.0, 30.0, 70.0, 50.0, 70.0, 60.0, 40.0, 100.0, 220.0, 90.0, 410.0, -121.0, 120.0, 200.0, 64.0, 210.0, 60.0, 99.0, 46.0, 100.0, 62.0, 40.0, 90.0, 80.0, 650.0, 60.0, 130.0, 130.0, 200.0, 49.0, 50.0, 50.0, 40.0, 129.0, 107.0, 18.0, 81.0, 21.0, 110.0, 131.0, 30.0, 104.0, 45.0, 100.0, 20.0, 60.0, 60.0, 100.0, 25.0, 90.0, 130.0, 50.0, 110.0, 95.0, 25.0, 110.0, 80.0, 70.0, 380.0, 50.0, -20.0, 130.0, 140.0, 189.0, 468.0, 120.0, 50.0, 60.0, 127.0, 90.0, 300.0, 520.0, 110.0, 69.0, 60.0, 66.0, 97.0, 110.0, 107.0, 59.0, 110.0, 95.0, 40.0, 90.0, 120.0, 110.0, 45.0, 65.0, 70.0, 110.0, 230.0, 179.0, 106.0, -54.0, 170.0, 80.0, 265.0, 70.0, 393.0, 190.0, -18.0, 130.0, 80.0, 110.0, 709.0, 21.0, 81.0, 100.0, 79.0, 200.0, 51.0, 80.0, 120.0, 110.0, 40.0, 80.0, 120.0, 150.0, 70.0, 77.0, 30.0, 7.0, 27.0, 65.0, 30.0, 130.0, 80.0, 56.0, 100.0, 20.0, 39.0, 80.0, -60.0, 430.0, 80.0, 60.0, 89.0, 120.0, 136.0, 100.0, 170.0, 12.0, 50.0, 180.0, 150.0, 90.0, 164.0, -10.0, 90.0, 50.0, 54.0, 300.0, 28.0, 40.0, 270.0, 57.0, 130.0, 75.0, 24.0, 80.0, 117.0, 400.0, -5.0, 50.0, 50.0, 90.0, 60.0, 60.0, 70.0, 50.0, 3.0, 40.0, 120.0, 110.0, 100.0, 72.0, 70.0, 60.0, 90.0, 70.0, 100.0, -15.0, 20.0, 30.0, 3.0, 40.0, 240.0, 9.0, 156.0, 50.0, 40.0, 40.0, 60.0, 80.0, 83.0, 100.0, 49.0, 100.0, 70.0, -50.0, 80.0, 62.0, 210.0, 70.0, -15.0, 100.0, 30.0, 60.0, 0.0, 60.0, 40.0, 60.0, 60.0, 50.0, 90.0, 90.0, 67.0, 88.0, 68.0, 60.0, 90.0, 319.0, 108.0, 30.0, 56.0, 530.0, 75.0, 22.0, 35.0, 70.0, 80.0, 12.0, 60.0, 80.0, 390.0, 100.0, 50.0, -80.0, 52.0, 60.0, 30.0, 72.0, 28.0, 67.0, 50.0, 42.0, 45.0, 100.0, 100.0, 30.0, 76.0, 44.0, 50.0, 120.0, 53.0, 34.0, 90.0, -13.0, 268.0, 27.0, 120.0, 30.0, 49.0, 42.0, 50.0, 180.0, 105.0, 30.0, 70.0, 130.0, 70.0, 60.0, 90.0, 150.0, 140.0, 100.0, 59.0, 70.0, 40.0, 90.0, 160.0, 120.0, 50.0, 50.0, 40.0, 100.0, 110.0, 50.0, 120.0, 50.0, 100.0, 70.0, 80.0, 110.0, 100.0, 220.0, 130.0, 33.0, 29.0, 78.0, 503.0, 60.0, 110.0, 56.0, 119.0, 10.0, 290.0, 43.0, 96.0, 87.0, 60.0, 40.0, 410.0, 140.0, -531.0, 83.0, 157.0, 80.0, 335.0, 130.0, 210.0, 110.0, 30.0, 110.0, 68.0, -10.0, 200.0, 30.0, 190.0, 310.0, 50.0, 1019.0, 100.0, 149.0, 4.0, 380.0, 50.0, 130.0, 90.0, 59.0, 180.0, -40.0, 160.0, 100.0, 30.0, 60.0, 100.0, 150.0, 20.0, 210.0, 65.0, 110.0, 60.0, 120.0, 120.0, 110.0, 80.0, 89.0, 190.0, 60.0, 79.0, 110.0, 59.0, -20.0, 60.0, 70.0, 70.0, 60.0, 80.0, 90.0, 220.0, 40.0, 65.0, 120.0, 90.0, 50.0, -8.0, 120.0, 190.0, 100.0, 50.0, 34.0, 49.0, -20.0, -54.0, 370.0, 130.0, 310.0, 69.0, -40.0, 527.0, 70.0, -7.0, 26.0, 30.0, -10.0, 100.0, 30.0, 12.0, 100.0, 70.0, 20.0, 130.0, 150.0, 230.0, 550.0, 248.0, 60.0, 35.0, 90.0, 85.0, 89.0, 70.0, 140.0, 50.0, 109.0, 47.0, 55.0, 60.0, 120.0, 94.0, 80.0, 90.0, 70.0, 90.0, 128.0, 70.0, 130.0, 95.0, 40.0, 230.0, 60.0, 80.0, 40.0, 170.0, 170.0, 15.0, 30.0, 110.0, 30.0, 27.0, 120.0, 210.0, 10.0, 25.0, -48.0, 100.0, 130.0, 120.0, 120.0, 296.0, 180.0, 17.0, 27.0, 80.0, 130.0, -76.0, 17.0, 280.0, 29.0, 50.0, 70.0, 20.0, -55.0, 50.0, 90.0, 90.0, 29.0, 177.0, 310.0, 80.0, 160.0, 140.0, 340.0, 200.0, 130.0, 416.0, 10.0, 50.0, 70.0, 470.0, 53.0, 110.0, 109.0, 127.0, 40.0, 10.0, 455.0, 70.0, 10.0, 90.0, 80.0, 100.0, 100.0, 80.0, 70.0, 520.0, 110.0, 120.0, 90.0, 95.0, 120.0, 143.0, 45.0, 80.0, 100.0, 60.0, 160.0, 20.0, 50.0, 80.0, -54.0, 70.0, 90.0, 120.0, 80.0, 124.0, -35.0, 450.0, 640.0, 79.0, 80.0, 180.0, 100.0, 110.0, -15.0, 609.0, 60.0, 20.0, -250.0, 90.0, 69.0, 90.0, 40.0, 90.0, 30.0, 170.0, 70.0, 100.0, 50.0, 68.0, 120.0, 170.0, -25.0, 90.0, 40.0, 408.0, 120.0, 70.0, 88.0, 98.0, 49.0, 190.0, 120.0, 250.0, 100.0, 66.0, 100.0, 110.0, 130.0, 128.0, 60.0, 67.0, 70.0, 280.0, 29.0, 440.0, 110.0, 0.0, 70.0, 120.0, -25.0, 70.0, 60.0, 70.0, 60.0, 70.0, 90.0, 29.0, 15.0, 59.0, 60.0, 200.0, -5.0, 80.0, 60.0, 50.0, 100.0, 88.0, -20.0, 140.0, -20.0, 80.0, 306.0, 105.0, 100.0, 108.0, 70.0, 110.0, 190.0, 60.0, 70.0, 40.0, 156.0, 99.0, 100.0, 70.0, 120.0, 120.0, 120.0, -20.0, 80.0, 440.0, 70.0, 60.0, 80.0, 160.0, 100.0, 90.0, 10.0, 70.0, 100.0, 67.0, 56.0, 60.0, 90.0, 160.0, 40.0, 60.0, 50.0, 150.0, 100.0, 70.0, 100.0, 40.0, 60.0, 59.0, 380.0, 95.0, 330.0, 80.0, 47.0, 98.0, 355.0, 86.0, 140.0, 75.0, 80.0, 130.0, 119.0, 60.0, 2.0, 64.0, 40.0, 83.0, 55.0, 80.0, 50.0, 50.0, 117.0, 70.0, 90.0, -30.0, 150.0, 639.0, 10.0, 50.0, 110.0, 40.0, -43.0, 50.0, 70.0, 33.0, 70.0, 100.0, 120.0, 70.0, 80.0, 85.0, 30.0, 139.0, 22.0, 120.0, 60.0, 450.0, 0.0, 100.0, 290.0, 10.0, -120.0, 555.0, 40.0, 130.0, 55.0, 460.0, 70.0, 40.0, 130.0, 70.0, 97.0, 95.0, 110.0, 110.0, 155.0, 160.0, 60.0, 30.0, -70.0, 60.0, 310.0, 45.0, 100.0, 180.0, 609.0, 110.0, 90.0, 80.0, -30.0, -20.0, 206.0, 80.0, 60.0, 60.0, 100.0, 110.0, 60.0, 69.0, 460.0, 45.0, 20.0, 90.0, 110.0, 120.0, 105.0, 80.0, 650.0, 100.0, 110.0, 90.0, 46.0, 138.0, 69.0, 148.0, 599.0, 262.0, 100.0, 100.0, 90.0, -112.0, -29.0, 41.0, 40.0, 96.0, 60.0, 70.0, 70.0, 80.0, -120.0, 110.0, 70.0, 100.0, 70.0, 60.0, 110.0, 90.0, 90.0, 140.0, 95.0, 120.0, 130.0, 140.0, 110.0, 170.0, 106.0, 130.0, 100.0, 100.0, 303.0, 40.0, 50.0, 80.0, 138.0, 140.0, 90.0, 170.0, 28.0, 46.0, 10.0, 120.0, 130.0, 60.0, 23.0, 150.0, 45.0, 40.0, 42.0, -25.0, 100.0, 70.0, 100.0, 55.0, 50.0, 80.0, 156.0, 42.0, 570.0, 88.0, 310.0, 110.0, 79.0, 80.0, 90.0, 106.0, 80.0, 80.0, 120.0, 99.0, 160.0, 180.0, 54.0, 85.0, 60.0, -5.0, 90.0, 60.0, 60.0, 60.0, 10.0, 180.0, -7.0, 70.0, -11.0, 80.0, 149.0, 90.0, 308.0, 25.0, 20.0, 130.0, 29.0, 90.0, 77.0, 140.0, 15.0, 100.0, 72.0, 120.0, 50.0, 26.0, 14.0, 45.0, 100.0, 140.0, 100.0, 60.0, 50.0, 249.0, 440.0, 30.0, 60.0, 55.0, 87.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9199561657428428, "mean_inference_ms": 2.1636554268389587, "mean_action_processing_ms": 0.7357233628426846, "mean_env_wait_ms": 1.511164531434451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06751894950866699, "StateBufferConnector_ms": 0.015125036239624023, "ViewRequirementAgentConnector_ms": 0.43307042121887207}, "num_episodes": 23, "episode_return_max": 2325.0, "episode_return_min": 315.0, "episode_return_mean": 1012.83, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.74811843820489, "num_env_steps_trained_throughput_per_sec": 32.74811843820489, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 5360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5360000, "timers": {"training_iteration_time_ms": 122366.553, "restore_workers_time_ms": 0.012, "training_step_time_ms": 122366.499, "sample_time_ms": 3100.816, "learn_time_ms": 119242.484, "learn_throughput": 33.545, "synch_weights_time_ms": 12.932}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "done": false, "training_iteration": 134, "trial_id": "6085c_00000", "date": "2024-07-02_03-32-19", "timestamp": 1719905539, "time_this_iter_s": 122.1588408946991, "time_total_s": 18384.357644319534, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b671f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18384.357644319534, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 20.527745664739886, "ram_util_percent": 79.07167630057802}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.380103506428746, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8719579370131, "policy_loss": -0.0075992294445860024, "vf_loss": 7.878433300816594, "vf_explained_var": 0.0016223703837369324, "kl": 0.007492419781548897, "entropy": 0.5584052506822367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1262955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "env_runners": {"episode_reward_max": 2064.0, "episode_reward_min": 371.0, "episode_reward_mean": 1022.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -531.0}, "policy_reward_max": {"policy_0": 1019.0}, "policy_reward_mean": {"policy_0": 102.215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [680.0, 1030.0, 2064.0, 883.0, 1059.0, 1332.0, 1511.0, 804.0, 627.0, 1137.0, 1118.0, 1221.0, 468.0, 777.0, 628.0, 634.0, 615.0, 982.0, 1018.0, 814.0, 582.0, 779.0, 786.0, 1019.0, 740.0, 1343.0, 911.0, 1124.0, 1997.0, 1102.0, 1005.0, 1018.0, 729.0, 811.0, 1411.0, 371.0, 1667.0, 825.0, 1003.0, 792.0, 1143.0, 624.0, 951.0, 1879.0, 1101.0, 1405.0, 684.0, 1698.0, 973.0, 828.0, 1108.0, 1254.0, 1161.0, 583.0, 673.0, 1199.0, 885.0, 1180.0, 833.0, 1261.0, 1145.0, 699.0, 1046.0, 749.0, 1505.0, 1257.0, 960.0, 1365.0, 1124.0, 1508.0, 1239.0, 606.0, 1085.0, 1217.0, 817.0, 627.0, 1605.0, 1024.0, 507.0, 998.0, 682.0, 1271.0, 574.0, 1097.0, 1055.0, 1236.0, 1060.0, 752.0, 682.0, 1001.0, 684.0, 914.0, 1100.0, 1507.0, 882.0, 923.0, 1876.0, 388.0, 1030.0, 1578.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [45.0, 100.0, 20.0, 60.0, 60.0, 100.0, 25.0, 90.0, 130.0, 50.0, 110.0, 95.0, 25.0, 110.0, 80.0, 70.0, 380.0, 50.0, -20.0, 130.0, 140.0, 189.0, 468.0, 120.0, 50.0, 60.0, 127.0, 90.0, 300.0, 520.0, 110.0, 69.0, 60.0, 66.0, 97.0, 110.0, 107.0, 59.0, 110.0, 95.0, 40.0, 90.0, 120.0, 110.0, 45.0, 65.0, 70.0, 110.0, 230.0, 179.0, 106.0, -54.0, 170.0, 80.0, 265.0, 70.0, 393.0, 190.0, -18.0, 130.0, 80.0, 110.0, 709.0, 21.0, 81.0, 100.0, 79.0, 200.0, 51.0, 80.0, 120.0, 110.0, 40.0, 80.0, 120.0, 150.0, 70.0, 77.0, 30.0, 7.0, 27.0, 65.0, 30.0, 130.0, 80.0, 56.0, 100.0, 20.0, 39.0, 80.0, -60.0, 430.0, 80.0, 60.0, 89.0, 120.0, 136.0, 100.0, 170.0, 12.0, 50.0, 180.0, 150.0, 90.0, 164.0, -10.0, 90.0, 50.0, 54.0, 300.0, 28.0, 40.0, 270.0, 57.0, 130.0, 75.0, 24.0, 80.0, 117.0, 400.0, -5.0, 50.0, 50.0, 90.0, 60.0, 60.0, 70.0, 50.0, 3.0, 40.0, 120.0, 110.0, 100.0, 72.0, 70.0, 60.0, 90.0, 70.0, 100.0, -15.0, 20.0, 30.0, 3.0, 40.0, 240.0, 9.0, 156.0, 50.0, 40.0, 40.0, 60.0, 80.0, 83.0, 100.0, 49.0, 100.0, 70.0, -50.0, 80.0, 62.0, 210.0, 70.0, -15.0, 100.0, 30.0, 60.0, 0.0, 60.0, 40.0, 60.0, 60.0, 50.0, 90.0, 90.0, 67.0, 88.0, 68.0, 60.0, 90.0, 319.0, 108.0, 30.0, 56.0, 530.0, 75.0, 22.0, 35.0, 70.0, 80.0, 12.0, 60.0, 80.0, 390.0, 100.0, 50.0, -80.0, 52.0, 60.0, 30.0, 72.0, 28.0, 67.0, 50.0, 42.0, 45.0, 100.0, 100.0, 30.0, 76.0, 44.0, 50.0, 120.0, 53.0, 34.0, 90.0, -13.0, 268.0, 27.0, 120.0, 30.0, 49.0, 42.0, 50.0, 180.0, 105.0, 30.0, 70.0, 130.0, 70.0, 60.0, 90.0, 150.0, 140.0, 100.0, 59.0, 70.0, 40.0, 90.0, 160.0, 120.0, 50.0, 50.0, 40.0, 100.0, 110.0, 50.0, 120.0, 50.0, 100.0, 70.0, 80.0, 110.0, 100.0, 220.0, 130.0, 33.0, 29.0, 78.0, 503.0, 60.0, 110.0, 56.0, 119.0, 10.0, 290.0, 43.0, 96.0, 87.0, 60.0, 40.0, 410.0, 140.0, -531.0, 83.0, 157.0, 80.0, 335.0, 130.0, 210.0, 110.0, 30.0, 110.0, 68.0, -10.0, 200.0, 30.0, 190.0, 310.0, 50.0, 1019.0, 100.0, 149.0, 4.0, 380.0, 50.0, 130.0, 90.0, 59.0, 180.0, -40.0, 160.0, 100.0, 30.0, 60.0, 100.0, 150.0, 20.0, 210.0, 65.0, 110.0, 60.0, 120.0, 120.0, 110.0, 80.0, 89.0, 190.0, 60.0, 79.0, 110.0, 59.0, -20.0, 60.0, 70.0, 70.0, 60.0, 80.0, 90.0, 220.0, 40.0, 65.0, 120.0, 90.0, 50.0, -8.0, 120.0, 190.0, 100.0, 50.0, 34.0, 49.0, -20.0, -54.0, 370.0, 130.0, 310.0, 69.0, -40.0, 527.0, 70.0, -7.0, 26.0, 30.0, -10.0, 100.0, 30.0, 12.0, 100.0, 70.0, 20.0, 130.0, 150.0, 230.0, 550.0, 248.0, 60.0, 35.0, 90.0, 85.0, 89.0, 70.0, 140.0, 50.0, 109.0, 47.0, 55.0, 60.0, 120.0, 94.0, 80.0, 90.0, 70.0, 90.0, 128.0, 70.0, 130.0, 95.0, 40.0, 230.0, 60.0, 80.0, 40.0, 170.0, 170.0, 15.0, 30.0, 110.0, 30.0, 27.0, 120.0, 210.0, 10.0, 25.0, -48.0, 100.0, 130.0, 120.0, 120.0, 296.0, 180.0, 17.0, 27.0, 80.0, 130.0, -76.0, 17.0, 280.0, 29.0, 50.0, 70.0, 20.0, -55.0, 50.0, 90.0, 90.0, 29.0, 177.0, 310.0, 80.0, 160.0, 140.0, 340.0, 200.0, 130.0, 416.0, 10.0, 50.0, 70.0, 470.0, 53.0, 110.0, 109.0, 127.0, 40.0, 10.0, 455.0, 70.0, 10.0, 90.0, 80.0, 100.0, 100.0, 80.0, 70.0, 520.0, 110.0, 120.0, 90.0, 95.0, 120.0, 143.0, 45.0, 80.0, 100.0, 60.0, 160.0, 20.0, 50.0, 80.0, -54.0, 70.0, 90.0, 120.0, 80.0, 124.0, -35.0, 450.0, 640.0, 79.0, 80.0, 180.0, 100.0, 110.0, -15.0, 609.0, 60.0, 20.0, -250.0, 90.0, 69.0, 90.0, 40.0, 90.0, 30.0, 170.0, 70.0, 100.0, 50.0, 68.0, 120.0, 170.0, -25.0, 90.0, 40.0, 408.0, 120.0, 70.0, 88.0, 98.0, 49.0, 190.0, 120.0, 250.0, 100.0, 66.0, 100.0, 110.0, 130.0, 128.0, 60.0, 67.0, 70.0, 280.0, 29.0, 440.0, 110.0, 0.0, 70.0, 120.0, -25.0, 70.0, 60.0, 70.0, 60.0, 70.0, 90.0, 29.0, 15.0, 59.0, 60.0, 200.0, -5.0, 80.0, 60.0, 50.0, 100.0, 88.0, -20.0, 140.0, -20.0, 80.0, 306.0, 105.0, 100.0, 108.0, 70.0, 110.0, 190.0, 60.0, 70.0, 40.0, 156.0, 99.0, 100.0, 70.0, 120.0, 120.0, 120.0, -20.0, 80.0, 440.0, 70.0, 60.0, 80.0, 160.0, 100.0, 90.0, 10.0, 70.0, 100.0, 67.0, 56.0, 60.0, 90.0, 160.0, 40.0, 60.0, 50.0, 150.0, 100.0, 70.0, 100.0, 40.0, 60.0, 59.0, 380.0, 95.0, 330.0, 80.0, 47.0, 98.0, 355.0, 86.0, 140.0, 75.0, 80.0, 130.0, 119.0, 60.0, 2.0, 64.0, 40.0, 83.0, 55.0, 80.0, 50.0, 50.0, 117.0, 70.0, 90.0, -30.0, 150.0, 639.0, 10.0, 50.0, 110.0, 40.0, -43.0, 50.0, 70.0, 33.0, 70.0, 100.0, 120.0, 70.0, 80.0, 85.0, 30.0, 139.0, 22.0, 120.0, 60.0, 450.0, 0.0, 100.0, 290.0, 10.0, -120.0, 555.0, 40.0, 130.0, 55.0, 460.0, 70.0, 40.0, 130.0, 70.0, 97.0, 95.0, 110.0, 110.0, 155.0, 160.0, 60.0, 30.0, -70.0, 60.0, 310.0, 45.0, 100.0, 180.0, 609.0, 110.0, 90.0, 80.0, -30.0, -20.0, 206.0, 80.0, 60.0, 60.0, 100.0, 110.0, 60.0, 69.0, 460.0, 45.0, 20.0, 90.0, 110.0, 120.0, 105.0, 80.0, 650.0, 100.0, 110.0, 90.0, 46.0, 138.0, 69.0, 148.0, 599.0, 262.0, 100.0, 100.0, 90.0, -112.0, -29.0, 41.0, 40.0, 96.0, 60.0, 70.0, 70.0, 80.0, -120.0, 110.0, 70.0, 100.0, 70.0, 60.0, 110.0, 90.0, 90.0, 140.0, 95.0, 120.0, 130.0, 140.0, 110.0, 170.0, 106.0, 130.0, 100.0, 100.0, 303.0, 40.0, 50.0, 80.0, 138.0, 140.0, 90.0, 170.0, 28.0, 46.0, 10.0, 120.0, 130.0, 60.0, 23.0, 150.0, 45.0, 40.0, 42.0, -25.0, 100.0, 70.0, 100.0, 55.0, 50.0, 80.0, 156.0, 42.0, 570.0, 88.0, 310.0, 110.0, 79.0, 80.0, 90.0, 106.0, 80.0, 80.0, 120.0, 99.0, 160.0, 180.0, 54.0, 85.0, 60.0, -5.0, 90.0, 60.0, 60.0, 60.0, 10.0, 180.0, -7.0, 70.0, -11.0, 80.0, 149.0, 90.0, 308.0, 25.0, 20.0, 130.0, 29.0, 90.0, 77.0, 140.0, 15.0, 100.0, 72.0, 120.0, 50.0, 26.0, 14.0, 45.0, 100.0, 140.0, 100.0, 60.0, 50.0, 249.0, 440.0, 30.0, 60.0, 55.0, 87.0, 20.0, 110.0, 30.0, 160.0, 60.0, 20.0, 160.0, 45.0, 10.0, -41.0, 100.0, 190.0, 27.0, 170.0, 60.0, 100.0, 70.0, 100.0, 30.0, 250.0, 206.0, 120.0, 45.0, 60.0, 90.0, 110.0, 220.0, 80.0, 44.0, 80.0, 109.0, 108.0, 140.0, 99.0, 80.0, 80.0, 150.0, 350.0, 50.0, 70.0, 90.0, 70.0, 230.0, 110.0, -10.0, -100.0, 210.0, 120.0, 80.0, 260.0, 100.0, 160.0, 110.0, 92.0, 50.0, 60.0, 40.0, 25.0, 45.0, 70.0, 19.0, -8.0, 356.0, 60.0, -340.0, 17.0, 116.0, 450.0, 0.0, 12.0, 16.0, 90.0, -12.0, 130.0, 90.0, 179.0, 18.0, 350.0, 70.0, 70.0, 90.0, 5.0, 60.0, 120.0, 40.0, 50.0, 60.0, 59.0, 60.0, 140.0, 50.0, 100.0, 118.0, 126.0, 20.0, 50.0, 160.0, 80.0, 150.0, 60.0, 240.0, 154.0, 72.0, 150.0, 60.0, 70.0, 40.0, 180.0, 65.0, 69.0, 120.0, 523.0, -28.0, 68.0, 370.0, 170.0, -97.0, 211.0, 60.0, 110.0, -20.0, 80.0, 70.0, 40.0, 40.0, 90.0, 70.0, 328.0, 60.0, 124.0, 109.0, 150.0, 80.0, 110.0, 139.0, 60.0, 55.0, 90.0, 40.0, 90.0, 80.0, 90.0, 110.0, 520.0, 149.0, 150.0, 77.0, 100.0, 485.0, 115.0, 10.0, 5.0, 190.0, 7.0, 0.0, 35.0, -30.0, 150.0, 15.0, 6.0, 149.0, -6.0, 40.0, 59.0, 70.0, 110.0, 60.0, 155.0, 150.0, 243.0, -40.0, 45.0, 120.0, 90.0, 60.0, 160.0, 60.0, 150.0, 865.0, 68.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9181349590431591, "mean_inference_ms": 2.160573982761816, "mean_action_processing_ms": 0.7340956237373795, "mean_env_wait_ms": 1.509126263588099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06480002403259277, "StateBufferConnector_ms": 0.014913797378540039, "ViewRequirementAgentConnector_ms": 0.4362778663635254}, "num_episodes": 18, "episode_return_max": 2064.0, "episode_return_min": 371.0, "episode_return_mean": 1022.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.50990091234954, "num_env_steps_trained_throughput_per_sec": 32.50990091234954, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 5400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5400000, "timers": {"training_iteration_time_ms": 122534.683, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122534.629, "sample_time_ms": 3037.067, "learn_time_ms": 119474.918, "learn_throughput": 33.48, "synch_weights_time_ms": 12.683}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "done": false, "training_iteration": 135, "trial_id": "6085c_00000", "date": "2024-07-02_03-34-22", "timestamp": 1719905662, "time_this_iter_s": 123.05361914634705, "time_total_s": 18507.41126346588, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13800fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18507.41126346588, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 21.32126436781609, "ram_util_percent": 79.54022988505747}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.440535253229233, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.733928770049058, "policy_loss": -0.007813764380313917, "vf_loss": 7.740549658662595, "vf_explained_var": 0.0017811629274528755, "kl": 0.007952466610297264, "entropy": 0.5422991102781539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1272345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "env_runners": {"episode_reward_max": 1997.0, "episode_reward_min": 371.0, "episode_reward_mean": 1019.46, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -531.0}, "policy_reward_max": {"policy_0": 1019.0}, "policy_reward_mean": {"policy_0": 101.946}, "custom_metrics": {}, "hist_stats": {"episode_reward": [786.0, 1019.0, 740.0, 1343.0, 911.0, 1124.0, 1997.0, 1102.0, 1005.0, 1018.0, 729.0, 811.0, 1411.0, 371.0, 1667.0, 825.0, 1003.0, 792.0, 1143.0, 624.0, 951.0, 1879.0, 1101.0, 1405.0, 684.0, 1698.0, 973.0, 828.0, 1108.0, 1254.0, 1161.0, 583.0, 673.0, 1199.0, 885.0, 1180.0, 833.0, 1261.0, 1145.0, 699.0, 1046.0, 749.0, 1505.0, 1257.0, 960.0, 1365.0, 1124.0, 1508.0, 1239.0, 606.0, 1085.0, 1217.0, 817.0, 627.0, 1605.0, 1024.0, 507.0, 998.0, 682.0, 1271.0, 574.0, 1097.0, 1055.0, 1236.0, 1060.0, 752.0, 682.0, 1001.0, 684.0, 914.0, 1100.0, 1507.0, 882.0, 923.0, 1876.0, 388.0, 1030.0, 1578.0, 702.0, 1128.0, 706.0, 909.0, 930.0, 855.0, 934.0, 674.0, 1231.0, 994.0, 975.0, 715.0, 1032.0, 1093.0, 691.0, 924.0, 1436.0, 877.0, 590.0, 1391.0, 825.0, 882.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [49.0, 42.0, 50.0, 180.0, 105.0, 30.0, 70.0, 130.0, 70.0, 60.0, 90.0, 150.0, 140.0, 100.0, 59.0, 70.0, 40.0, 90.0, 160.0, 120.0, 50.0, 50.0, 40.0, 100.0, 110.0, 50.0, 120.0, 50.0, 100.0, 70.0, 80.0, 110.0, 100.0, 220.0, 130.0, 33.0, 29.0, 78.0, 503.0, 60.0, 110.0, 56.0, 119.0, 10.0, 290.0, 43.0, 96.0, 87.0, 60.0, 40.0, 410.0, 140.0, -531.0, 83.0, 157.0, 80.0, 335.0, 130.0, 210.0, 110.0, 30.0, 110.0, 68.0, -10.0, 200.0, 30.0, 190.0, 310.0, 50.0, 1019.0, 100.0, 149.0, 4.0, 380.0, 50.0, 130.0, 90.0, 59.0, 180.0, -40.0, 160.0, 100.0, 30.0, 60.0, 100.0, 150.0, 20.0, 210.0, 65.0, 110.0, 60.0, 120.0, 120.0, 110.0, 80.0, 89.0, 190.0, 60.0, 79.0, 110.0, 59.0, -20.0, 60.0, 70.0, 70.0, 60.0, 80.0, 90.0, 220.0, 40.0, 65.0, 120.0, 90.0, 50.0, -8.0, 120.0, 190.0, 100.0, 50.0, 34.0, 49.0, -20.0, -54.0, 370.0, 130.0, 310.0, 69.0, -40.0, 527.0, 70.0, -7.0, 26.0, 30.0, -10.0, 100.0, 30.0, 12.0, 100.0, 70.0, 20.0, 130.0, 150.0, 230.0, 550.0, 248.0, 60.0, 35.0, 90.0, 85.0, 89.0, 70.0, 140.0, 50.0, 109.0, 47.0, 55.0, 60.0, 120.0, 94.0, 80.0, 90.0, 70.0, 90.0, 128.0, 70.0, 130.0, 95.0, 40.0, 230.0, 60.0, 80.0, 40.0, 170.0, 170.0, 15.0, 30.0, 110.0, 30.0, 27.0, 120.0, 210.0, 10.0, 25.0, -48.0, 100.0, 130.0, 120.0, 120.0, 296.0, 180.0, 17.0, 27.0, 80.0, 130.0, -76.0, 17.0, 280.0, 29.0, 50.0, 70.0, 20.0, -55.0, 50.0, 90.0, 90.0, 29.0, 177.0, 310.0, 80.0, 160.0, 140.0, 340.0, 200.0, 130.0, 416.0, 10.0, 50.0, 70.0, 470.0, 53.0, 110.0, 109.0, 127.0, 40.0, 10.0, 455.0, 70.0, 10.0, 90.0, 80.0, 100.0, 100.0, 80.0, 70.0, 520.0, 110.0, 120.0, 90.0, 95.0, 120.0, 143.0, 45.0, 80.0, 100.0, 60.0, 160.0, 20.0, 50.0, 80.0, -54.0, 70.0, 90.0, 120.0, 80.0, 124.0, -35.0, 450.0, 640.0, 79.0, 80.0, 180.0, 100.0, 110.0, -15.0, 609.0, 60.0, 20.0, -250.0, 90.0, 69.0, 90.0, 40.0, 90.0, 30.0, 170.0, 70.0, 100.0, 50.0, 68.0, 120.0, 170.0, -25.0, 90.0, 40.0, 408.0, 120.0, 70.0, 88.0, 98.0, 49.0, 190.0, 120.0, 250.0, 100.0, 66.0, 100.0, 110.0, 130.0, 128.0, 60.0, 67.0, 70.0, 280.0, 29.0, 440.0, 110.0, 0.0, 70.0, 120.0, -25.0, 70.0, 60.0, 70.0, 60.0, 70.0, 90.0, 29.0, 15.0, 59.0, 60.0, 200.0, -5.0, 80.0, 60.0, 50.0, 100.0, 88.0, -20.0, 140.0, -20.0, 80.0, 306.0, 105.0, 100.0, 108.0, 70.0, 110.0, 190.0, 60.0, 70.0, 40.0, 156.0, 99.0, 100.0, 70.0, 120.0, 120.0, 120.0, -20.0, 80.0, 440.0, 70.0, 60.0, 80.0, 160.0, 100.0, 90.0, 10.0, 70.0, 100.0, 67.0, 56.0, 60.0, 90.0, 160.0, 40.0, 60.0, 50.0, 150.0, 100.0, 70.0, 100.0, 40.0, 60.0, 59.0, 380.0, 95.0, 330.0, 80.0, 47.0, 98.0, 355.0, 86.0, 140.0, 75.0, 80.0, 130.0, 119.0, 60.0, 2.0, 64.0, 40.0, 83.0, 55.0, 80.0, 50.0, 50.0, 117.0, 70.0, 90.0, -30.0, 150.0, 639.0, 10.0, 50.0, 110.0, 40.0, -43.0, 50.0, 70.0, 33.0, 70.0, 100.0, 120.0, 70.0, 80.0, 85.0, 30.0, 139.0, 22.0, 120.0, 60.0, 450.0, 0.0, 100.0, 290.0, 10.0, -120.0, 555.0, 40.0, 130.0, 55.0, 460.0, 70.0, 40.0, 130.0, 70.0, 97.0, 95.0, 110.0, 110.0, 155.0, 160.0, 60.0, 30.0, -70.0, 60.0, 310.0, 45.0, 100.0, 180.0, 609.0, 110.0, 90.0, 80.0, -30.0, -20.0, 206.0, 80.0, 60.0, 60.0, 100.0, 110.0, 60.0, 69.0, 460.0, 45.0, 20.0, 90.0, 110.0, 120.0, 105.0, 80.0, 650.0, 100.0, 110.0, 90.0, 46.0, 138.0, 69.0, 148.0, 599.0, 262.0, 100.0, 100.0, 90.0, -112.0, -29.0, 41.0, 40.0, 96.0, 60.0, 70.0, 70.0, 80.0, -120.0, 110.0, 70.0, 100.0, 70.0, 60.0, 110.0, 90.0, 90.0, 140.0, 95.0, 120.0, 130.0, 140.0, 110.0, 170.0, 106.0, 130.0, 100.0, 100.0, 303.0, 40.0, 50.0, 80.0, 138.0, 140.0, 90.0, 170.0, 28.0, 46.0, 10.0, 120.0, 130.0, 60.0, 23.0, 150.0, 45.0, 40.0, 42.0, -25.0, 100.0, 70.0, 100.0, 55.0, 50.0, 80.0, 156.0, 42.0, 570.0, 88.0, 310.0, 110.0, 79.0, 80.0, 90.0, 106.0, 80.0, 80.0, 120.0, 99.0, 160.0, 180.0, 54.0, 85.0, 60.0, -5.0, 90.0, 60.0, 60.0, 60.0, 10.0, 180.0, -7.0, 70.0, -11.0, 80.0, 149.0, 90.0, 308.0, 25.0, 20.0, 130.0, 29.0, 90.0, 77.0, 140.0, 15.0, 100.0, 72.0, 120.0, 50.0, 26.0, 14.0, 45.0, 100.0, 140.0, 100.0, 60.0, 50.0, 249.0, 440.0, 30.0, 60.0, 55.0, 87.0, 20.0, 110.0, 30.0, 160.0, 60.0, 20.0, 160.0, 45.0, 10.0, -41.0, 100.0, 190.0, 27.0, 170.0, 60.0, 100.0, 70.0, 100.0, 30.0, 250.0, 206.0, 120.0, 45.0, 60.0, 90.0, 110.0, 220.0, 80.0, 44.0, 80.0, 109.0, 108.0, 140.0, 99.0, 80.0, 80.0, 150.0, 350.0, 50.0, 70.0, 90.0, 70.0, 230.0, 110.0, -10.0, -100.0, 210.0, 120.0, 80.0, 260.0, 100.0, 160.0, 110.0, 92.0, 50.0, 60.0, 40.0, 25.0, 45.0, 70.0, 19.0, -8.0, 356.0, 60.0, -340.0, 17.0, 116.0, 450.0, 0.0, 12.0, 16.0, 90.0, -12.0, 130.0, 90.0, 179.0, 18.0, 350.0, 70.0, 70.0, 90.0, 5.0, 60.0, 120.0, 40.0, 50.0, 60.0, 59.0, 60.0, 140.0, 50.0, 100.0, 118.0, 126.0, 20.0, 50.0, 160.0, 80.0, 150.0, 60.0, 240.0, 154.0, 72.0, 150.0, 60.0, 70.0, 40.0, 180.0, 65.0, 69.0, 120.0, 523.0, -28.0, 68.0, 370.0, 170.0, -97.0, 211.0, 60.0, 110.0, -20.0, 80.0, 70.0, 40.0, 40.0, 90.0, 70.0, 328.0, 60.0, 124.0, 109.0, 150.0, 80.0, 110.0, 139.0, 60.0, 55.0, 90.0, 40.0, 90.0, 80.0, 90.0, 110.0, 520.0, 149.0, 150.0, 77.0, 100.0, 485.0, 115.0, 10.0, 5.0, 190.0, 7.0, 0.0, 35.0, -30.0, 150.0, 15.0, 6.0, 149.0, -6.0, 40.0, 59.0, 70.0, 110.0, 60.0, 155.0, 150.0, 243.0, -40.0, 45.0, 120.0, 90.0, 60.0, 160.0, 60.0, 150.0, 865.0, 68.0, 130.0, 69.0, 366.0, -430.0, 60.0, 90.0, 70.0, 310.0, -33.0, 70.0, 92.0, 140.0, 289.0, 5.0, 95.0, 170.0, 80.0, 180.0, 17.0, 60.0, 70.0, 48.0, 60.0, 50.0, 120.0, 50.0, 51.0, 90.0, 110.0, 57.0, 10.0, 35.0, 50.0, 15.0, 90.0, -46.0, 180.0, 290.0, 40.0, 245.0, 80.0, 60.0, 160.0, 40.0, 50.0, 40.0, 60.0, 330.0, 90.0, 20.0, 20.0, 80.0, 50.0, 230.0, 120.0, 110.0, 15.0, 70.0, 90.0, 70.0, 109.0, -13.0, 20.0, -30.0, 69.0, 94.0, 30.0, 65.0, 60.0, 530.0, 70.0, 60.0, 49.0, 70.0, 60.0, 70.0, 150.0, 20.0, 65.0, 60.0, 100.0, 80.0, 70.0, 48.0, 25.0, 130.0, 68.0, 130.0, 130.0, 450.0, 88.0, 200.0, 58.0, 90.0, 80.0, 130.0, 68.0, 140.0, 60.0, 80.0, 20.0, -10.0, 130.0, 360.0, 140.0, 80.0, 25.0, 90.0, 90.0, 50.0, -20.0, 45.0, 47.0, 120.0, 110.0, 40.0, 60.0, 188.0, 35.0, 90.0, 140.0, 55.0, 90.0, 210.0, 132.0, -11.0, 70.0, 83.0, 73.0, 190.0, 510.0, 100.0, 60.0, -70.0, 60.0, 110.0, 57.0, 100.0, 90.0, 76.0, 68.0, 34.0, 69.0, 47.0, 200.0, 20.0, 37.0, 66.0, 110.0, 40.0, 260.0, 160.0, -101.0, 8.0, 200.0, 80.0, 70.0, 17.0, 0.0, 230.0, 250.0, 98.0, 89.0, 90.0, 80.0, 60.0, 99.0, 320.0, 220.0, 130.0, 47.0, 106.0, 118.0, 110.0, 80.0, 54.0, 120.0, 74.0, 61.0, 107.0, 40.0, 80.0, 180.0, 110.0, 30.0, 240.0, 40.0, -290.0, 80.0, 80.0, -44.0, 66.0, 275.0, 80.0, 80.0, 177.0, 120.0, 100.0, 490.0, 47.0, 56.0, 79.0, 304.0, 20.0, 90.0, 44.0, 70.0, 50.0, 10.0, 102.0, 19.0, 220.0, 29.0, 110.0, 120.0, -25.0, 50.0, 39.0, 320.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9164613590923159, "mean_inference_ms": 2.1578894338438426, "mean_action_processing_ms": 0.7330684153402238, "mean_env_wait_ms": 1.5070382681006855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05995774269104004, "StateBufferConnector_ms": 0.009700298309326172, "ViewRequirementAgentConnector_ms": 0.4329509735107422}, "num_episodes": 22, "episode_return_max": 1997.0, "episode_return_min": 371.0, "episode_return_mean": 1019.46, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.363570037646696, "num_env_steps_trained_throughput_per_sec": 32.363570037646696, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 5440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5440000, "timers": {"training_iteration_time_ms": 122712.293, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122712.24, "sample_time_ms": 3032.932, "learn_time_ms": 119656.57, "learn_throughput": 33.429, "synch_weights_time_ms": 12.818}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "done": false, "training_iteration": 136, "trial_id": "6085c_00000", "date": "2024-07-02_03-36-26", "timestamp": 1719905786, "time_this_iter_s": 123.60800909996033, "time_total_s": 18631.01927256584, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a744c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18631.01927256584, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 25.86285714285714, "ram_util_percent": 80.44114285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.443170935474138, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.310956456638372, "policy_loss": -0.007643552768565873, "vf_loss": 8.317380919725624, "vf_explained_var": 0.0018879120596173727, "kl": 0.008127295455340957, "entropy": 0.4907399681112129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1281735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "env_runners": {"episode_reward_max": 1879.0, "episode_reward_min": 388.0, "episode_reward_mean": 1023.82, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -430.0}, "policy_reward_max": {"policy_0": 865.0}, "policy_reward_mean": {"policy_0": 102.382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1143.0, 624.0, 951.0, 1879.0, 1101.0, 1405.0, 684.0, 1698.0, 973.0, 828.0, 1108.0, 1254.0, 1161.0, 583.0, 673.0, 1199.0, 885.0, 1180.0, 833.0, 1261.0, 1145.0, 699.0, 1046.0, 749.0, 1505.0, 1257.0, 960.0, 1365.0, 1124.0, 1508.0, 1239.0, 606.0, 1085.0, 1217.0, 817.0, 627.0, 1605.0, 1024.0, 507.0, 998.0, 682.0, 1271.0, 574.0, 1097.0, 1055.0, 1236.0, 1060.0, 752.0, 682.0, 1001.0, 684.0, 914.0, 1100.0, 1507.0, 882.0, 923.0, 1876.0, 388.0, 1030.0, 1578.0, 702.0, 1128.0, 706.0, 909.0, 930.0, 855.0, 934.0, 674.0, 1231.0, 994.0, 975.0, 715.0, 1032.0, 1093.0, 691.0, 924.0, 1436.0, 877.0, 590.0, 1391.0, 825.0, 882.0, 976.0, 926.0, 840.0, 909.0, 1328.0, 1012.0, 903.0, 1100.0, 895.0, 1110.0, 1184.0, 1607.0, 807.0, 1177.0, 1255.0, 1051.0, 1185.0, 825.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, 10.0, 25.0, -48.0, 100.0, 130.0, 120.0, 120.0, 296.0, 180.0, 17.0, 27.0, 80.0, 130.0, -76.0, 17.0, 280.0, 29.0, 50.0, 70.0, 20.0, -55.0, 50.0, 90.0, 90.0, 29.0, 177.0, 310.0, 80.0, 160.0, 140.0, 340.0, 200.0, 130.0, 416.0, 10.0, 50.0, 70.0, 470.0, 53.0, 110.0, 109.0, 127.0, 40.0, 10.0, 455.0, 70.0, 10.0, 90.0, 80.0, 100.0, 100.0, 80.0, 70.0, 520.0, 110.0, 120.0, 90.0, 95.0, 120.0, 143.0, 45.0, 80.0, 100.0, 60.0, 160.0, 20.0, 50.0, 80.0, -54.0, 70.0, 90.0, 120.0, 80.0, 124.0, -35.0, 450.0, 640.0, 79.0, 80.0, 180.0, 100.0, 110.0, -15.0, 609.0, 60.0, 20.0, -250.0, 90.0, 69.0, 90.0, 40.0, 90.0, 30.0, 170.0, 70.0, 100.0, 50.0, 68.0, 120.0, 170.0, -25.0, 90.0, 40.0, 408.0, 120.0, 70.0, 88.0, 98.0, 49.0, 190.0, 120.0, 250.0, 100.0, 66.0, 100.0, 110.0, 130.0, 128.0, 60.0, 67.0, 70.0, 280.0, 29.0, 440.0, 110.0, 0.0, 70.0, 120.0, -25.0, 70.0, 60.0, 70.0, 60.0, 70.0, 90.0, 29.0, 15.0, 59.0, 60.0, 200.0, -5.0, 80.0, 60.0, 50.0, 100.0, 88.0, -20.0, 140.0, -20.0, 80.0, 306.0, 105.0, 100.0, 108.0, 70.0, 110.0, 190.0, 60.0, 70.0, 40.0, 156.0, 99.0, 100.0, 70.0, 120.0, 120.0, 120.0, -20.0, 80.0, 440.0, 70.0, 60.0, 80.0, 160.0, 100.0, 90.0, 10.0, 70.0, 100.0, 67.0, 56.0, 60.0, 90.0, 160.0, 40.0, 60.0, 50.0, 150.0, 100.0, 70.0, 100.0, 40.0, 60.0, 59.0, 380.0, 95.0, 330.0, 80.0, 47.0, 98.0, 355.0, 86.0, 140.0, 75.0, 80.0, 130.0, 119.0, 60.0, 2.0, 64.0, 40.0, 83.0, 55.0, 80.0, 50.0, 50.0, 117.0, 70.0, 90.0, -30.0, 150.0, 639.0, 10.0, 50.0, 110.0, 40.0, -43.0, 50.0, 70.0, 33.0, 70.0, 100.0, 120.0, 70.0, 80.0, 85.0, 30.0, 139.0, 22.0, 120.0, 60.0, 450.0, 0.0, 100.0, 290.0, 10.0, -120.0, 555.0, 40.0, 130.0, 55.0, 460.0, 70.0, 40.0, 130.0, 70.0, 97.0, 95.0, 110.0, 110.0, 155.0, 160.0, 60.0, 30.0, -70.0, 60.0, 310.0, 45.0, 100.0, 180.0, 609.0, 110.0, 90.0, 80.0, -30.0, -20.0, 206.0, 80.0, 60.0, 60.0, 100.0, 110.0, 60.0, 69.0, 460.0, 45.0, 20.0, 90.0, 110.0, 120.0, 105.0, 80.0, 650.0, 100.0, 110.0, 90.0, 46.0, 138.0, 69.0, 148.0, 599.0, 262.0, 100.0, 100.0, 90.0, -112.0, -29.0, 41.0, 40.0, 96.0, 60.0, 70.0, 70.0, 80.0, -120.0, 110.0, 70.0, 100.0, 70.0, 60.0, 110.0, 90.0, 90.0, 140.0, 95.0, 120.0, 130.0, 140.0, 110.0, 170.0, 106.0, 130.0, 100.0, 100.0, 303.0, 40.0, 50.0, 80.0, 138.0, 140.0, 90.0, 170.0, 28.0, 46.0, 10.0, 120.0, 130.0, 60.0, 23.0, 150.0, 45.0, 40.0, 42.0, -25.0, 100.0, 70.0, 100.0, 55.0, 50.0, 80.0, 156.0, 42.0, 570.0, 88.0, 310.0, 110.0, 79.0, 80.0, 90.0, 106.0, 80.0, 80.0, 120.0, 99.0, 160.0, 180.0, 54.0, 85.0, 60.0, -5.0, 90.0, 60.0, 60.0, 60.0, 10.0, 180.0, -7.0, 70.0, -11.0, 80.0, 149.0, 90.0, 308.0, 25.0, 20.0, 130.0, 29.0, 90.0, 77.0, 140.0, 15.0, 100.0, 72.0, 120.0, 50.0, 26.0, 14.0, 45.0, 100.0, 140.0, 100.0, 60.0, 50.0, 249.0, 440.0, 30.0, 60.0, 55.0, 87.0, 20.0, 110.0, 30.0, 160.0, 60.0, 20.0, 160.0, 45.0, 10.0, -41.0, 100.0, 190.0, 27.0, 170.0, 60.0, 100.0, 70.0, 100.0, 30.0, 250.0, 206.0, 120.0, 45.0, 60.0, 90.0, 110.0, 220.0, 80.0, 44.0, 80.0, 109.0, 108.0, 140.0, 99.0, 80.0, 80.0, 150.0, 350.0, 50.0, 70.0, 90.0, 70.0, 230.0, 110.0, -10.0, -100.0, 210.0, 120.0, 80.0, 260.0, 100.0, 160.0, 110.0, 92.0, 50.0, 60.0, 40.0, 25.0, 45.0, 70.0, 19.0, -8.0, 356.0, 60.0, -340.0, 17.0, 116.0, 450.0, 0.0, 12.0, 16.0, 90.0, -12.0, 130.0, 90.0, 179.0, 18.0, 350.0, 70.0, 70.0, 90.0, 5.0, 60.0, 120.0, 40.0, 50.0, 60.0, 59.0, 60.0, 140.0, 50.0, 100.0, 118.0, 126.0, 20.0, 50.0, 160.0, 80.0, 150.0, 60.0, 240.0, 154.0, 72.0, 150.0, 60.0, 70.0, 40.0, 180.0, 65.0, 69.0, 120.0, 523.0, -28.0, 68.0, 370.0, 170.0, -97.0, 211.0, 60.0, 110.0, -20.0, 80.0, 70.0, 40.0, 40.0, 90.0, 70.0, 328.0, 60.0, 124.0, 109.0, 150.0, 80.0, 110.0, 139.0, 60.0, 55.0, 90.0, 40.0, 90.0, 80.0, 90.0, 110.0, 520.0, 149.0, 150.0, 77.0, 100.0, 485.0, 115.0, 10.0, 5.0, 190.0, 7.0, 0.0, 35.0, -30.0, 150.0, 15.0, 6.0, 149.0, -6.0, 40.0, 59.0, 70.0, 110.0, 60.0, 155.0, 150.0, 243.0, -40.0, 45.0, 120.0, 90.0, 60.0, 160.0, 60.0, 150.0, 865.0, 68.0, 130.0, 69.0, 366.0, -430.0, 60.0, 90.0, 70.0, 310.0, -33.0, 70.0, 92.0, 140.0, 289.0, 5.0, 95.0, 170.0, 80.0, 180.0, 17.0, 60.0, 70.0, 48.0, 60.0, 50.0, 120.0, 50.0, 51.0, 90.0, 110.0, 57.0, 10.0, 35.0, 50.0, 15.0, 90.0, -46.0, 180.0, 290.0, 40.0, 245.0, 80.0, 60.0, 160.0, 40.0, 50.0, 40.0, 60.0, 330.0, 90.0, 20.0, 20.0, 80.0, 50.0, 230.0, 120.0, 110.0, 15.0, 70.0, 90.0, 70.0, 109.0, -13.0, 20.0, -30.0, 69.0, 94.0, 30.0, 65.0, 60.0, 530.0, 70.0, 60.0, 49.0, 70.0, 60.0, 70.0, 150.0, 20.0, 65.0, 60.0, 100.0, 80.0, 70.0, 48.0, 25.0, 130.0, 68.0, 130.0, 130.0, 450.0, 88.0, 200.0, 58.0, 90.0, 80.0, 130.0, 68.0, 140.0, 60.0, 80.0, 20.0, -10.0, 130.0, 360.0, 140.0, 80.0, 25.0, 90.0, 90.0, 50.0, -20.0, 45.0, 47.0, 120.0, 110.0, 40.0, 60.0, 188.0, 35.0, 90.0, 140.0, 55.0, 90.0, 210.0, 132.0, -11.0, 70.0, 83.0, 73.0, 190.0, 510.0, 100.0, 60.0, -70.0, 60.0, 110.0, 57.0, 100.0, 90.0, 76.0, 68.0, 34.0, 69.0, 47.0, 200.0, 20.0, 37.0, 66.0, 110.0, 40.0, 260.0, 160.0, -101.0, 8.0, 200.0, 80.0, 70.0, 17.0, 0.0, 230.0, 250.0, 98.0, 89.0, 90.0, 80.0, 60.0, 99.0, 320.0, 220.0, 130.0, 47.0, 106.0, 118.0, 110.0, 80.0, 54.0, 120.0, 74.0, 61.0, 107.0, 40.0, 80.0, 180.0, 110.0, 30.0, 240.0, 40.0, -290.0, 80.0, 80.0, -44.0, 66.0, 275.0, 80.0, 80.0, 177.0, 120.0, 100.0, 490.0, 47.0, 56.0, 79.0, 304.0, 20.0, 90.0, 44.0, 70.0, 50.0, 10.0, 102.0, 19.0, 220.0, 29.0, 110.0, 120.0, -25.0, 50.0, 39.0, 320.0, 0.0, 99.0, 35.0, 170.0, 40.0, 130.0, 178.0, 99.0, 100.0, 80.0, 45.0, 90.0, 180.0, 170.0, 40.0, 90.0, 80.0, 90.0, 59.0, 37.0, 90.0, 80.0, 100.0, 170.0, 10.0, 60.0, 80.0, 30.0, 100.0, 90.0, 120.0, 470.0, -55.0, -26.0, 150.0, 60.0, 40.0, 100.0, 40.0, 0.0, 130.0, 120.0, 79.0, 57.0, 100.0, 80.0, 509.0, 110.0, 45.0, 188.0, 40.0, 90.0, 130.0, 150.0, 110.0, 80.0, 70.0, 100.0, 73.0, 60.0, 149.0, 54.0, 110.0, 100.0, 54.0, 400.0, 55.0, -30.0, 70.0, 50.0, 40.0, 170.0, 80.0, 150.0, 170.0, 90.0, 120.0, 90.0, 50.0, 90.0, 90.0, 40.0, 70.0, 60.0, 50.0, 180.0, 5.0, 150.0, 80.0, 120.0, 140.0, 165.0, 70.0, 150.0, 130.0, 50.0, 90.0, 229.0, 50.0, 38.0, 138.0, 60.0, 145.0, 306.0, 70.0, 110.0, -20.0, 146.0, 179.0, 108.0, 80.0, 60.0, 50.0, 99.0, -21.0, 70.0, 820.0, 154.0, 20.0, 45.0, 310.0, 69.0, 50.0, 90.0, 110.0, 35.0, 73.0, 80.0, 110.0, 110.0, 80.0, 410.0, 30.0, 30.0, 80.0, 59.0, 397.0, 69.0, 80.0, 89.0, -67.0, 90.0, 90.0, 30.0, 110.0, 130.0, 80.0, 390.0, 65.0, 130.0, 140.0, 66.0, 300.0, 101.0, 0.0, 110.0, 88.0, 50.0, 150.0, 78.0, 108.0, 160.0, 50.0, 0.0, 40.0, 250.0, 100.0, 85.0, 120.0, 60.0, 320.0, 40.0, 50.0, 200.0, 10.0, 70.0, 120.0, 80.0, 80.0, 120.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9156976230478722, "mean_inference_ms": 2.1560492455722575, "mean_action_processing_ms": 0.73230569634674, "mean_env_wait_ms": 1.5055064855666078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06877803802490234, "StateBufferConnector_ms": 0.009743213653564453, "ViewRequirementAgentConnector_ms": 0.44442224502563477}, "num_episodes": 18, "episode_return_max": 1879.0, "episode_return_min": 388.0, "episode_return_mean": 1023.82, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.52589161991322, "num_env_steps_trained_throughput_per_sec": 32.52589161991322, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 5480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5480000, "timers": {"training_iteration_time_ms": 122580.102, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122580.048, "sample_time_ms": 3128.722, "learn_time_ms": 119429.164, "learn_throughput": 33.493, "synch_weights_time_ms": 12.074}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "done": false, "training_iteration": 137, "trial_id": "6085c_00000", "date": "2024-07-02_03-38-29", "timestamp": 1719905909, "time_this_iter_s": 122.99131393432617, "time_total_s": 18754.010586500168, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b3b670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18754.010586500168, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 20.702312138728324, "ram_util_percent": 79.35664739884392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.444970861328042, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.365147445148553, "policy_loss": -0.0076761870774419635, "vf_loss": 7.371647795168355, "vf_explained_var": 0.0028683030567230126, "kl": 0.00783891819093282, "entropy": 0.5400055185007973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1291125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "env_runners": {"episode_reward_max": 1876.0, "episode_reward_min": 388.0, "episode_reward_mean": 1007.12, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -430.0}, "policy_reward_max": {"policy_0": 865.0}, "policy_reward_mean": {"policy_0": 100.712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [833.0, 1261.0, 1145.0, 699.0, 1046.0, 749.0, 1505.0, 1257.0, 960.0, 1365.0, 1124.0, 1508.0, 1239.0, 606.0, 1085.0, 1217.0, 817.0, 627.0, 1605.0, 1024.0, 507.0, 998.0, 682.0, 1271.0, 574.0, 1097.0, 1055.0, 1236.0, 1060.0, 752.0, 682.0, 1001.0, 684.0, 914.0, 1100.0, 1507.0, 882.0, 923.0, 1876.0, 388.0, 1030.0, 1578.0, 702.0, 1128.0, 706.0, 909.0, 930.0, 855.0, 934.0, 674.0, 1231.0, 994.0, 975.0, 715.0, 1032.0, 1093.0, 691.0, 924.0, 1436.0, 877.0, 590.0, 1391.0, 825.0, 882.0, 976.0, 926.0, 840.0, 909.0, 1328.0, 1012.0, 903.0, 1100.0, 895.0, 1110.0, 1184.0, 1607.0, 807.0, 1177.0, 1255.0, 1051.0, 1185.0, 825.0, 1317.0, 1030.0, 1093.0, 544.0, 794.0, 1294.0, 1488.0, 463.0, 959.0, 1303.0, 551.0, 875.0, 1027.0, 855.0, 814.0, 1093.0, 1044.0, 1115.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [67.0, 56.0, 60.0, 90.0, 160.0, 40.0, 60.0, 50.0, 150.0, 100.0, 70.0, 100.0, 40.0, 60.0, 59.0, 380.0, 95.0, 330.0, 80.0, 47.0, 98.0, 355.0, 86.0, 140.0, 75.0, 80.0, 130.0, 119.0, 60.0, 2.0, 64.0, 40.0, 83.0, 55.0, 80.0, 50.0, 50.0, 117.0, 70.0, 90.0, -30.0, 150.0, 639.0, 10.0, 50.0, 110.0, 40.0, -43.0, 50.0, 70.0, 33.0, 70.0, 100.0, 120.0, 70.0, 80.0, 85.0, 30.0, 139.0, 22.0, 120.0, 60.0, 450.0, 0.0, 100.0, 290.0, 10.0, -120.0, 555.0, 40.0, 130.0, 55.0, 460.0, 70.0, 40.0, 130.0, 70.0, 97.0, 95.0, 110.0, 110.0, 155.0, 160.0, 60.0, 30.0, -70.0, 60.0, 310.0, 45.0, 100.0, 180.0, 609.0, 110.0, 90.0, 80.0, -30.0, -20.0, 206.0, 80.0, 60.0, 60.0, 100.0, 110.0, 60.0, 69.0, 460.0, 45.0, 20.0, 90.0, 110.0, 120.0, 105.0, 80.0, 650.0, 100.0, 110.0, 90.0, 46.0, 138.0, 69.0, 148.0, 599.0, 262.0, 100.0, 100.0, 90.0, -112.0, -29.0, 41.0, 40.0, 96.0, 60.0, 70.0, 70.0, 80.0, -120.0, 110.0, 70.0, 100.0, 70.0, 60.0, 110.0, 90.0, 90.0, 140.0, 95.0, 120.0, 130.0, 140.0, 110.0, 170.0, 106.0, 130.0, 100.0, 100.0, 303.0, 40.0, 50.0, 80.0, 138.0, 140.0, 90.0, 170.0, 28.0, 46.0, 10.0, 120.0, 130.0, 60.0, 23.0, 150.0, 45.0, 40.0, 42.0, -25.0, 100.0, 70.0, 100.0, 55.0, 50.0, 80.0, 156.0, 42.0, 570.0, 88.0, 310.0, 110.0, 79.0, 80.0, 90.0, 106.0, 80.0, 80.0, 120.0, 99.0, 160.0, 180.0, 54.0, 85.0, 60.0, -5.0, 90.0, 60.0, 60.0, 60.0, 10.0, 180.0, -7.0, 70.0, -11.0, 80.0, 149.0, 90.0, 308.0, 25.0, 20.0, 130.0, 29.0, 90.0, 77.0, 140.0, 15.0, 100.0, 72.0, 120.0, 50.0, 26.0, 14.0, 45.0, 100.0, 140.0, 100.0, 60.0, 50.0, 249.0, 440.0, 30.0, 60.0, 55.0, 87.0, 20.0, 110.0, 30.0, 160.0, 60.0, 20.0, 160.0, 45.0, 10.0, -41.0, 100.0, 190.0, 27.0, 170.0, 60.0, 100.0, 70.0, 100.0, 30.0, 250.0, 206.0, 120.0, 45.0, 60.0, 90.0, 110.0, 220.0, 80.0, 44.0, 80.0, 109.0, 108.0, 140.0, 99.0, 80.0, 80.0, 150.0, 350.0, 50.0, 70.0, 90.0, 70.0, 230.0, 110.0, -10.0, -100.0, 210.0, 120.0, 80.0, 260.0, 100.0, 160.0, 110.0, 92.0, 50.0, 60.0, 40.0, 25.0, 45.0, 70.0, 19.0, -8.0, 356.0, 60.0, -340.0, 17.0, 116.0, 450.0, 0.0, 12.0, 16.0, 90.0, -12.0, 130.0, 90.0, 179.0, 18.0, 350.0, 70.0, 70.0, 90.0, 5.0, 60.0, 120.0, 40.0, 50.0, 60.0, 59.0, 60.0, 140.0, 50.0, 100.0, 118.0, 126.0, 20.0, 50.0, 160.0, 80.0, 150.0, 60.0, 240.0, 154.0, 72.0, 150.0, 60.0, 70.0, 40.0, 180.0, 65.0, 69.0, 120.0, 523.0, -28.0, 68.0, 370.0, 170.0, -97.0, 211.0, 60.0, 110.0, -20.0, 80.0, 70.0, 40.0, 40.0, 90.0, 70.0, 328.0, 60.0, 124.0, 109.0, 150.0, 80.0, 110.0, 139.0, 60.0, 55.0, 90.0, 40.0, 90.0, 80.0, 90.0, 110.0, 520.0, 149.0, 150.0, 77.0, 100.0, 485.0, 115.0, 10.0, 5.0, 190.0, 7.0, 0.0, 35.0, -30.0, 150.0, 15.0, 6.0, 149.0, -6.0, 40.0, 59.0, 70.0, 110.0, 60.0, 155.0, 150.0, 243.0, -40.0, 45.0, 120.0, 90.0, 60.0, 160.0, 60.0, 150.0, 865.0, 68.0, 130.0, 69.0, 366.0, -430.0, 60.0, 90.0, 70.0, 310.0, -33.0, 70.0, 92.0, 140.0, 289.0, 5.0, 95.0, 170.0, 80.0, 180.0, 17.0, 60.0, 70.0, 48.0, 60.0, 50.0, 120.0, 50.0, 51.0, 90.0, 110.0, 57.0, 10.0, 35.0, 50.0, 15.0, 90.0, -46.0, 180.0, 290.0, 40.0, 245.0, 80.0, 60.0, 160.0, 40.0, 50.0, 40.0, 60.0, 330.0, 90.0, 20.0, 20.0, 80.0, 50.0, 230.0, 120.0, 110.0, 15.0, 70.0, 90.0, 70.0, 109.0, -13.0, 20.0, -30.0, 69.0, 94.0, 30.0, 65.0, 60.0, 530.0, 70.0, 60.0, 49.0, 70.0, 60.0, 70.0, 150.0, 20.0, 65.0, 60.0, 100.0, 80.0, 70.0, 48.0, 25.0, 130.0, 68.0, 130.0, 130.0, 450.0, 88.0, 200.0, 58.0, 90.0, 80.0, 130.0, 68.0, 140.0, 60.0, 80.0, 20.0, -10.0, 130.0, 360.0, 140.0, 80.0, 25.0, 90.0, 90.0, 50.0, -20.0, 45.0, 47.0, 120.0, 110.0, 40.0, 60.0, 188.0, 35.0, 90.0, 140.0, 55.0, 90.0, 210.0, 132.0, -11.0, 70.0, 83.0, 73.0, 190.0, 510.0, 100.0, 60.0, -70.0, 60.0, 110.0, 57.0, 100.0, 90.0, 76.0, 68.0, 34.0, 69.0, 47.0, 200.0, 20.0, 37.0, 66.0, 110.0, 40.0, 260.0, 160.0, -101.0, 8.0, 200.0, 80.0, 70.0, 17.0, 0.0, 230.0, 250.0, 98.0, 89.0, 90.0, 80.0, 60.0, 99.0, 320.0, 220.0, 130.0, 47.0, 106.0, 118.0, 110.0, 80.0, 54.0, 120.0, 74.0, 61.0, 107.0, 40.0, 80.0, 180.0, 110.0, 30.0, 240.0, 40.0, -290.0, 80.0, 80.0, -44.0, 66.0, 275.0, 80.0, 80.0, 177.0, 120.0, 100.0, 490.0, 47.0, 56.0, 79.0, 304.0, 20.0, 90.0, 44.0, 70.0, 50.0, 10.0, 102.0, 19.0, 220.0, 29.0, 110.0, 120.0, -25.0, 50.0, 39.0, 320.0, 0.0, 99.0, 35.0, 170.0, 40.0, 130.0, 178.0, 99.0, 100.0, 80.0, 45.0, 90.0, 180.0, 170.0, 40.0, 90.0, 80.0, 90.0, 59.0, 37.0, 90.0, 80.0, 100.0, 170.0, 10.0, 60.0, 80.0, 30.0, 100.0, 90.0, 120.0, 470.0, -55.0, -26.0, 150.0, 60.0, 40.0, 100.0, 40.0, 0.0, 130.0, 120.0, 79.0, 57.0, 100.0, 80.0, 509.0, 110.0, 45.0, 188.0, 40.0, 90.0, 130.0, 150.0, 110.0, 80.0, 70.0, 100.0, 73.0, 60.0, 149.0, 54.0, 110.0, 100.0, 54.0, 400.0, 55.0, -30.0, 70.0, 50.0, 40.0, 170.0, 80.0, 150.0, 170.0, 90.0, 120.0, 90.0, 50.0, 90.0, 90.0, 40.0, 70.0, 60.0, 50.0, 180.0, 5.0, 150.0, 80.0, 120.0, 140.0, 165.0, 70.0, 150.0, 130.0, 50.0, 90.0, 229.0, 50.0, 38.0, 138.0, 60.0, 145.0, 306.0, 70.0, 110.0, -20.0, 146.0, 179.0, 108.0, 80.0, 60.0, 50.0, 99.0, -21.0, 70.0, 820.0, 154.0, 20.0, 45.0, 310.0, 69.0, 50.0, 90.0, 110.0, 35.0, 73.0, 80.0, 110.0, 110.0, 80.0, 410.0, 30.0, 30.0, 80.0, 59.0, 397.0, 69.0, 80.0, 89.0, -67.0, 90.0, 90.0, 30.0, 110.0, 130.0, 80.0, 390.0, 65.0, 130.0, 140.0, 66.0, 300.0, 101.0, 0.0, 110.0, 88.0, 50.0, 150.0, 78.0, 108.0, 160.0, 50.0, 0.0, 40.0, 250.0, 100.0, 85.0, 120.0, 60.0, 320.0, 40.0, 50.0, 200.0, 10.0, 70.0, 120.0, 80.0, 80.0, 120.0, 55.0, 25.0, 70.0, 166.0, 110.0, 66.0, 130.0, 580.0, 40.0, 70.0, 60.0, 80.0, 60.0, 230.0, 60.0, 90.0, 90.0, 100.0, 50.0, 190.0, 80.0, 190.0, 69.0, 180.0, 50.0, 80.0, 160.0, 105.0, 90.0, 89.0, 80.0, 19.0, -252.0, 19.0, 20.0, 390.0, 0.0, 110.0, -11.0, 220.0, 29.0, 60.0, 140.0, 57.0, 29.0, 70.0, 130.0, 80.0, 78.0, 80.0, 70.0, 160.0, -35.0, 40.0, 39.0, 40.0, 130.0, 90.0, 310.0, 230.0, 290.0, 190.0, 201.0, -40.0, -13.0, 805.0, 50.0, 25.0, 60.0, 60.0, 150.0, 29.0, 40.0, 110.0, 30.0, 38.0, 40.0, 90.0, 19.0, 17.0, 50.0, 80.0, 50.0, 60.0, 110.0, 129.0, 100.0, 50.0, 120.0, 110.0, 150.0, 16.0, 160.0, 98.0, 98.0, 80.0, 499.0, 70.0, 0.0, 52.0, 230.0, 0.0, -2.0, 100.0, 60.0, 3.0, 30.0, 100.0, 140.0, 60.0, 60.0, 87.0, 60.0, 260.0, 65.0, 104.0, 70.0, 56.0, -25.0, 98.0, 100.0, -56.0, 40.0, 320.0, 180.0, 130.0, 80.0, 120.0, 50.0, 105.0, 58.0, 70.0, 90.0, 22.0, 320.0, -40.0, 60.0, 133.0, 70.0, 80.0, 50.0, 40.0, 310.0, 120.0, 90.0, 120.0, 198.0, 50.0, 80.0, -264.0, 70.0, 70.0, 300.0, 100.0, 38.0, 127.0, 109.0, 80.0, 110.0, 99.0, 60.0, 420.0, 100.0, 60.0, 80.0, 20.0, 67.0, 70.0, 180.0, 20.0, 27.0, 25.0, 50.0, 133.0, 170.0, 232.0, 40.0, 90.0, 80.0, 100.0, 195.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9147736131303212, "mean_inference_ms": 2.154331424650792, "mean_action_processing_ms": 0.7315698277428644, "mean_env_wait_ms": 1.5040231504580404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06891417503356934, "StateBufferConnector_ms": 0.009766101837158203, "ViewRequirementAgentConnector_ms": 0.4513862133026123}, "num_episodes": 18, "episode_return_max": 1876.0, "episode_return_min": 388.0, "episode_return_mean": 1007.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.55620345647849, "num_env_steps_trained_throughput_per_sec": 32.55620345647849, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 5520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5520000, "timers": {"training_iteration_time_ms": 122539.24, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122539.185, "sample_time_ms": 3060.505, "learn_time_ms": 119456.426, "learn_throughput": 33.485, "synch_weights_time_ms": 12.036}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "done": false, "training_iteration": 138, "trial_id": "6085c_00000", "date": "2024-07-02_03-40-31", "timestamp": 1719906031, "time_this_iter_s": 122.88025903701782, "time_total_s": 18876.890845537186, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138a888b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18876.890845537186, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 20.563218390804597, "ram_util_percent": 79.13620689655173}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3049480365488093, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.425316218344674, "policy_loss": -0.00768872089506721, "vf_loss": 8.43192492333718, "vf_explained_var": 0.0011300508524028385, "kl": 0.007200083117164468, "entropy": 0.48562127774833236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1300515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "env_runners": {"episode_reward_max": 1978.0, "episode_reward_min": 388.0, "episode_reward_mean": 1028.81, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -430.0}, "policy_reward_max": {"policy_0": 1209.0}, "policy_reward_mean": {"policy_0": 102.881}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1271.0, 574.0, 1097.0, 1055.0, 1236.0, 1060.0, 752.0, 682.0, 1001.0, 684.0, 914.0, 1100.0, 1507.0, 882.0, 923.0, 1876.0, 388.0, 1030.0, 1578.0, 702.0, 1128.0, 706.0, 909.0, 930.0, 855.0, 934.0, 674.0, 1231.0, 994.0, 975.0, 715.0, 1032.0, 1093.0, 691.0, 924.0, 1436.0, 877.0, 590.0, 1391.0, 825.0, 882.0, 976.0, 926.0, 840.0, 909.0, 1328.0, 1012.0, 903.0, 1100.0, 895.0, 1110.0, 1184.0, 1607.0, 807.0, 1177.0, 1255.0, 1051.0, 1185.0, 825.0, 1317.0, 1030.0, 1093.0, 544.0, 794.0, 1294.0, 1488.0, 463.0, 959.0, 1303.0, 551.0, 875.0, 1027.0, 855.0, 814.0, 1093.0, 1044.0, 1115.0, 520.0, 1025.0, 490.0, 1110.0, 981.0, 1736.0, 1978.0, 1509.0, 749.0, 765.0, 923.0, 1014.0, 937.0, 1198.0, 1292.0, 977.0, 1895.0, 688.0, 1655.0, 1209.0, 1013.0, 1284.0, 1080.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 100.0, 60.0, 50.0, 249.0, 440.0, 30.0, 60.0, 55.0, 87.0, 20.0, 110.0, 30.0, 160.0, 60.0, 20.0, 160.0, 45.0, 10.0, -41.0, 100.0, 190.0, 27.0, 170.0, 60.0, 100.0, 70.0, 100.0, 30.0, 250.0, 206.0, 120.0, 45.0, 60.0, 90.0, 110.0, 220.0, 80.0, 44.0, 80.0, 109.0, 108.0, 140.0, 99.0, 80.0, 80.0, 150.0, 350.0, 50.0, 70.0, 90.0, 70.0, 230.0, 110.0, -10.0, -100.0, 210.0, 120.0, 80.0, 260.0, 100.0, 160.0, 110.0, 92.0, 50.0, 60.0, 40.0, 25.0, 45.0, 70.0, 19.0, -8.0, 356.0, 60.0, -340.0, 17.0, 116.0, 450.0, 0.0, 12.0, 16.0, 90.0, -12.0, 130.0, 90.0, 179.0, 18.0, 350.0, 70.0, 70.0, 90.0, 5.0, 60.0, 120.0, 40.0, 50.0, 60.0, 59.0, 60.0, 140.0, 50.0, 100.0, 118.0, 126.0, 20.0, 50.0, 160.0, 80.0, 150.0, 60.0, 240.0, 154.0, 72.0, 150.0, 60.0, 70.0, 40.0, 180.0, 65.0, 69.0, 120.0, 523.0, -28.0, 68.0, 370.0, 170.0, -97.0, 211.0, 60.0, 110.0, -20.0, 80.0, 70.0, 40.0, 40.0, 90.0, 70.0, 328.0, 60.0, 124.0, 109.0, 150.0, 80.0, 110.0, 139.0, 60.0, 55.0, 90.0, 40.0, 90.0, 80.0, 90.0, 110.0, 520.0, 149.0, 150.0, 77.0, 100.0, 485.0, 115.0, 10.0, 5.0, 190.0, 7.0, 0.0, 35.0, -30.0, 150.0, 15.0, 6.0, 149.0, -6.0, 40.0, 59.0, 70.0, 110.0, 60.0, 155.0, 150.0, 243.0, -40.0, 45.0, 120.0, 90.0, 60.0, 160.0, 60.0, 150.0, 865.0, 68.0, 130.0, 69.0, 366.0, -430.0, 60.0, 90.0, 70.0, 310.0, -33.0, 70.0, 92.0, 140.0, 289.0, 5.0, 95.0, 170.0, 80.0, 180.0, 17.0, 60.0, 70.0, 48.0, 60.0, 50.0, 120.0, 50.0, 51.0, 90.0, 110.0, 57.0, 10.0, 35.0, 50.0, 15.0, 90.0, -46.0, 180.0, 290.0, 40.0, 245.0, 80.0, 60.0, 160.0, 40.0, 50.0, 40.0, 60.0, 330.0, 90.0, 20.0, 20.0, 80.0, 50.0, 230.0, 120.0, 110.0, 15.0, 70.0, 90.0, 70.0, 109.0, -13.0, 20.0, -30.0, 69.0, 94.0, 30.0, 65.0, 60.0, 530.0, 70.0, 60.0, 49.0, 70.0, 60.0, 70.0, 150.0, 20.0, 65.0, 60.0, 100.0, 80.0, 70.0, 48.0, 25.0, 130.0, 68.0, 130.0, 130.0, 450.0, 88.0, 200.0, 58.0, 90.0, 80.0, 130.0, 68.0, 140.0, 60.0, 80.0, 20.0, -10.0, 130.0, 360.0, 140.0, 80.0, 25.0, 90.0, 90.0, 50.0, -20.0, 45.0, 47.0, 120.0, 110.0, 40.0, 60.0, 188.0, 35.0, 90.0, 140.0, 55.0, 90.0, 210.0, 132.0, -11.0, 70.0, 83.0, 73.0, 190.0, 510.0, 100.0, 60.0, -70.0, 60.0, 110.0, 57.0, 100.0, 90.0, 76.0, 68.0, 34.0, 69.0, 47.0, 200.0, 20.0, 37.0, 66.0, 110.0, 40.0, 260.0, 160.0, -101.0, 8.0, 200.0, 80.0, 70.0, 17.0, 0.0, 230.0, 250.0, 98.0, 89.0, 90.0, 80.0, 60.0, 99.0, 320.0, 220.0, 130.0, 47.0, 106.0, 118.0, 110.0, 80.0, 54.0, 120.0, 74.0, 61.0, 107.0, 40.0, 80.0, 180.0, 110.0, 30.0, 240.0, 40.0, -290.0, 80.0, 80.0, -44.0, 66.0, 275.0, 80.0, 80.0, 177.0, 120.0, 100.0, 490.0, 47.0, 56.0, 79.0, 304.0, 20.0, 90.0, 44.0, 70.0, 50.0, 10.0, 102.0, 19.0, 220.0, 29.0, 110.0, 120.0, -25.0, 50.0, 39.0, 320.0, 0.0, 99.0, 35.0, 170.0, 40.0, 130.0, 178.0, 99.0, 100.0, 80.0, 45.0, 90.0, 180.0, 170.0, 40.0, 90.0, 80.0, 90.0, 59.0, 37.0, 90.0, 80.0, 100.0, 170.0, 10.0, 60.0, 80.0, 30.0, 100.0, 90.0, 120.0, 470.0, -55.0, -26.0, 150.0, 60.0, 40.0, 100.0, 40.0, 0.0, 130.0, 120.0, 79.0, 57.0, 100.0, 80.0, 509.0, 110.0, 45.0, 188.0, 40.0, 90.0, 130.0, 150.0, 110.0, 80.0, 70.0, 100.0, 73.0, 60.0, 149.0, 54.0, 110.0, 100.0, 54.0, 400.0, 55.0, -30.0, 70.0, 50.0, 40.0, 170.0, 80.0, 150.0, 170.0, 90.0, 120.0, 90.0, 50.0, 90.0, 90.0, 40.0, 70.0, 60.0, 50.0, 180.0, 5.0, 150.0, 80.0, 120.0, 140.0, 165.0, 70.0, 150.0, 130.0, 50.0, 90.0, 229.0, 50.0, 38.0, 138.0, 60.0, 145.0, 306.0, 70.0, 110.0, -20.0, 146.0, 179.0, 108.0, 80.0, 60.0, 50.0, 99.0, -21.0, 70.0, 820.0, 154.0, 20.0, 45.0, 310.0, 69.0, 50.0, 90.0, 110.0, 35.0, 73.0, 80.0, 110.0, 110.0, 80.0, 410.0, 30.0, 30.0, 80.0, 59.0, 397.0, 69.0, 80.0, 89.0, -67.0, 90.0, 90.0, 30.0, 110.0, 130.0, 80.0, 390.0, 65.0, 130.0, 140.0, 66.0, 300.0, 101.0, 0.0, 110.0, 88.0, 50.0, 150.0, 78.0, 108.0, 160.0, 50.0, 0.0, 40.0, 250.0, 100.0, 85.0, 120.0, 60.0, 320.0, 40.0, 50.0, 200.0, 10.0, 70.0, 120.0, 80.0, 80.0, 120.0, 55.0, 25.0, 70.0, 166.0, 110.0, 66.0, 130.0, 580.0, 40.0, 70.0, 60.0, 80.0, 60.0, 230.0, 60.0, 90.0, 90.0, 100.0, 50.0, 190.0, 80.0, 190.0, 69.0, 180.0, 50.0, 80.0, 160.0, 105.0, 90.0, 89.0, 80.0, 19.0, -252.0, 19.0, 20.0, 390.0, 0.0, 110.0, -11.0, 220.0, 29.0, 60.0, 140.0, 57.0, 29.0, 70.0, 130.0, 80.0, 78.0, 80.0, 70.0, 160.0, -35.0, 40.0, 39.0, 40.0, 130.0, 90.0, 310.0, 230.0, 290.0, 190.0, 201.0, -40.0, -13.0, 805.0, 50.0, 25.0, 60.0, 60.0, 150.0, 29.0, 40.0, 110.0, 30.0, 38.0, 40.0, 90.0, 19.0, 17.0, 50.0, 80.0, 50.0, 60.0, 110.0, 129.0, 100.0, 50.0, 120.0, 110.0, 150.0, 16.0, 160.0, 98.0, 98.0, 80.0, 499.0, 70.0, 0.0, 52.0, 230.0, 0.0, -2.0, 100.0, 60.0, 3.0, 30.0, 100.0, 140.0, 60.0, 60.0, 87.0, 60.0, 260.0, 65.0, 104.0, 70.0, 56.0, -25.0, 98.0, 100.0, -56.0, 40.0, 320.0, 180.0, 130.0, 80.0, 120.0, 50.0, 105.0, 58.0, 70.0, 90.0, 22.0, 320.0, -40.0, 60.0, 133.0, 70.0, 80.0, 50.0, 40.0, 310.0, 120.0, 90.0, 120.0, 198.0, 50.0, 80.0, -264.0, 70.0, 70.0, 300.0, 100.0, 38.0, 127.0, 109.0, 80.0, 110.0, 99.0, 60.0, 420.0, 100.0, 60.0, 80.0, 20.0, 67.0, 70.0, 180.0, 20.0, 27.0, 25.0, 50.0, 133.0, 170.0, 232.0, 40.0, 90.0, 80.0, 100.0, 195.0, 60.0, 140.0, 10.0, 10.0, 30.0, 40.0, 130.0, 30.0, 40.0, 30.0, 35.0, 100.0, 90.0, 66.0, 90.0, 250.0, 130.0, 80.0, 79.0, 105.0, 30.0, 10.0, 25.0, 46.0, 130.0, 80.0, 19.0, 30.0, -20.0, 140.0, 60.0, 70.0, 70.0, 90.0, 100.0, 440.0, -30.0, 90.0, 110.0, 110.0, -10.0, 28.0, 140.0, 180.0, 30.0, 60.0, 40.0, 86.0, 330.0, 97.0, 80.0, 340.0, 140.0, -22.0, 70.0, 600.0, 100.0, 130.0, 78.0, 220.0, 118.0, 15.0, 90.0, -30.0, 1209.0, 90.0, 180.0, 138.0, 68.0, 100.0, 186.0, 177.0, 60.0, 100.0, 110.0, 407.0, 129.0, 170.0, 90.0, 80.0, 60.0, 78.0, 58.0, -12.0, 120.0, 110.0, 20.0, 115.0, 130.0, 70.0, 70.0, 70.0, 20.0, 90.0, 170.0, 25.0, 70.0, 150.0, 70.0, 30.0, 90.0, 100.0, 90.0, 71.0, 120.0, 89.0, 73.0, 120.0, 60.0, 110.0, 215.0, 56.0, 130.0, 106.0, 103.0, 43.0, 90.0, 120.0, 69.0, 82.0, 130.0, 69.0, 120.0, 60.0, 60.0, 68.0, 190.0, 70.0, 100.0, 70.0, 80.0, 150.0, 80.0, 160.0, 90.0, 47.0, 160.0, -14.0, 295.0, 150.0, 90.0, 170.0, 70.0, 110.0, 87.0, 69.0, 507.0, 100.0, 69.0, 20.0, 99.0, 100.0, 80.0, 150.0, 50.0, 88.0, 80.0, -80.0, 110.0, 300.0, 200.0, 15.0, 420.0, 230.0, 180.0, 120.0, 60.0, 90.0, 120.0, 460.0, 80.0, 19.0, 69.0, 80.0, 300.0, 15.0, 40.0, 37.0, 28.0, 20.0, 450.0, 550.0, 130.0, 110.0, -55.0, 140.0, -29.0, 200.0, -5.0, 164.0, 70.0, 70.0, 90.0, 84.0, 400.0, -80.0, 195.0, 50.0, 40.0, 290.0, 70.0, 200.0, 76.0, 180.0, 48.0, 80.0, 13.0, 140.0, 109.0, 97.0, 90.0, 560.0, 160.0, 106.0, 90.0, 150.0, 69.0, 0.0, 50.0, 9.0, 150.0, 46.0, 59.0, 310.0, 129.0, 70.0, 66.0, 130.0, 60.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9137107920262708, "mean_inference_ms": 2.152294678191899, "mean_action_processing_ms": 0.7306715416563168, "mean_env_wait_ms": 1.5022306579039577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07510757446289062, "StateBufferConnector_ms": 0.009756088256835938, "ViewRequirementAgentConnector_ms": 0.452195405960083}, "num_episodes": 23, "episode_return_max": 1978.0, "episode_return_min": 388.0, "episode_return_mean": 1028.81, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.5697762071683, "num_env_steps_trained_throughput_per_sec": 32.5697762071683, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 5560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5560000, "timers": {"training_iteration_time_ms": 122624.775, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122624.717, "sample_time_ms": 3054.321, "learn_time_ms": 119548.103, "learn_throughput": 33.459, "synch_weights_time_ms": 11.884}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "done": false, "training_iteration": 139, "trial_id": "6085c_00000", "date": "2024-07-02_03-42-34", "timestamp": 1719906154, "time_this_iter_s": 122.83144497871399, "time_total_s": 18999.7222905159, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c93f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18999.7222905159, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 21.539080459770116, "ram_util_percent": 79.32471264367815}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3773241675445953, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00768929432209232, "vf_loss": 8.189196086767764, "vf_explained_var": 0.00200573251651118, "kl": Infinity, "entropy": 0.44830079705506976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1309905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "env_runners": {"episode_reward_max": 1978.0, "episode_reward_min": 463.0, "episode_reward_mean": 1064.04, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -430.0}, "policy_reward_max": {"policy_0": 1209.0}, "policy_reward_mean": {"policy_0": 106.404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1578.0, 702.0, 1128.0, 706.0, 909.0, 930.0, 855.0, 934.0, 674.0, 1231.0, 994.0, 975.0, 715.0, 1032.0, 1093.0, 691.0, 924.0, 1436.0, 877.0, 590.0, 1391.0, 825.0, 882.0, 976.0, 926.0, 840.0, 909.0, 1328.0, 1012.0, 903.0, 1100.0, 895.0, 1110.0, 1184.0, 1607.0, 807.0, 1177.0, 1255.0, 1051.0, 1185.0, 825.0, 1317.0, 1030.0, 1093.0, 544.0, 794.0, 1294.0, 1488.0, 463.0, 959.0, 1303.0, 551.0, 875.0, 1027.0, 855.0, 814.0, 1093.0, 1044.0, 1115.0, 520.0, 1025.0, 490.0, 1110.0, 981.0, 1736.0, 1978.0, 1509.0, 749.0, 765.0, 923.0, 1014.0, 937.0, 1198.0, 1292.0, 977.0, 1895.0, 688.0, 1655.0, 1209.0, 1013.0, 1284.0, 1080.0, 960.0, 1310.0, 1039.0, 1166.0, 1788.0, 1012.0, 1038.0, 1042.0, 848.0, 1548.0, 1334.0, 857.0, 1728.0, 1900.0, 1203.0, 880.0, 895.0, 1007.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-40.0, 45.0, 120.0, 90.0, 60.0, 160.0, 60.0, 150.0, 865.0, 68.0, 130.0, 69.0, 366.0, -430.0, 60.0, 90.0, 70.0, 310.0, -33.0, 70.0, 92.0, 140.0, 289.0, 5.0, 95.0, 170.0, 80.0, 180.0, 17.0, 60.0, 70.0, 48.0, 60.0, 50.0, 120.0, 50.0, 51.0, 90.0, 110.0, 57.0, 10.0, 35.0, 50.0, 15.0, 90.0, -46.0, 180.0, 290.0, 40.0, 245.0, 80.0, 60.0, 160.0, 40.0, 50.0, 40.0, 60.0, 330.0, 90.0, 20.0, 20.0, 80.0, 50.0, 230.0, 120.0, 110.0, 15.0, 70.0, 90.0, 70.0, 109.0, -13.0, 20.0, -30.0, 69.0, 94.0, 30.0, 65.0, 60.0, 530.0, 70.0, 60.0, 49.0, 70.0, 60.0, 70.0, 150.0, 20.0, 65.0, 60.0, 100.0, 80.0, 70.0, 48.0, 25.0, 130.0, 68.0, 130.0, 130.0, 450.0, 88.0, 200.0, 58.0, 90.0, 80.0, 130.0, 68.0, 140.0, 60.0, 80.0, 20.0, -10.0, 130.0, 360.0, 140.0, 80.0, 25.0, 90.0, 90.0, 50.0, -20.0, 45.0, 47.0, 120.0, 110.0, 40.0, 60.0, 188.0, 35.0, 90.0, 140.0, 55.0, 90.0, 210.0, 132.0, -11.0, 70.0, 83.0, 73.0, 190.0, 510.0, 100.0, 60.0, -70.0, 60.0, 110.0, 57.0, 100.0, 90.0, 76.0, 68.0, 34.0, 69.0, 47.0, 200.0, 20.0, 37.0, 66.0, 110.0, 40.0, 260.0, 160.0, -101.0, 8.0, 200.0, 80.0, 70.0, 17.0, 0.0, 230.0, 250.0, 98.0, 89.0, 90.0, 80.0, 60.0, 99.0, 320.0, 220.0, 130.0, 47.0, 106.0, 118.0, 110.0, 80.0, 54.0, 120.0, 74.0, 61.0, 107.0, 40.0, 80.0, 180.0, 110.0, 30.0, 240.0, 40.0, -290.0, 80.0, 80.0, -44.0, 66.0, 275.0, 80.0, 80.0, 177.0, 120.0, 100.0, 490.0, 47.0, 56.0, 79.0, 304.0, 20.0, 90.0, 44.0, 70.0, 50.0, 10.0, 102.0, 19.0, 220.0, 29.0, 110.0, 120.0, -25.0, 50.0, 39.0, 320.0, 0.0, 99.0, 35.0, 170.0, 40.0, 130.0, 178.0, 99.0, 100.0, 80.0, 45.0, 90.0, 180.0, 170.0, 40.0, 90.0, 80.0, 90.0, 59.0, 37.0, 90.0, 80.0, 100.0, 170.0, 10.0, 60.0, 80.0, 30.0, 100.0, 90.0, 120.0, 470.0, -55.0, -26.0, 150.0, 60.0, 40.0, 100.0, 40.0, 0.0, 130.0, 120.0, 79.0, 57.0, 100.0, 80.0, 509.0, 110.0, 45.0, 188.0, 40.0, 90.0, 130.0, 150.0, 110.0, 80.0, 70.0, 100.0, 73.0, 60.0, 149.0, 54.0, 110.0, 100.0, 54.0, 400.0, 55.0, -30.0, 70.0, 50.0, 40.0, 170.0, 80.0, 150.0, 170.0, 90.0, 120.0, 90.0, 50.0, 90.0, 90.0, 40.0, 70.0, 60.0, 50.0, 180.0, 5.0, 150.0, 80.0, 120.0, 140.0, 165.0, 70.0, 150.0, 130.0, 50.0, 90.0, 229.0, 50.0, 38.0, 138.0, 60.0, 145.0, 306.0, 70.0, 110.0, -20.0, 146.0, 179.0, 108.0, 80.0, 60.0, 50.0, 99.0, -21.0, 70.0, 820.0, 154.0, 20.0, 45.0, 310.0, 69.0, 50.0, 90.0, 110.0, 35.0, 73.0, 80.0, 110.0, 110.0, 80.0, 410.0, 30.0, 30.0, 80.0, 59.0, 397.0, 69.0, 80.0, 89.0, -67.0, 90.0, 90.0, 30.0, 110.0, 130.0, 80.0, 390.0, 65.0, 130.0, 140.0, 66.0, 300.0, 101.0, 0.0, 110.0, 88.0, 50.0, 150.0, 78.0, 108.0, 160.0, 50.0, 0.0, 40.0, 250.0, 100.0, 85.0, 120.0, 60.0, 320.0, 40.0, 50.0, 200.0, 10.0, 70.0, 120.0, 80.0, 80.0, 120.0, 55.0, 25.0, 70.0, 166.0, 110.0, 66.0, 130.0, 580.0, 40.0, 70.0, 60.0, 80.0, 60.0, 230.0, 60.0, 90.0, 90.0, 100.0, 50.0, 190.0, 80.0, 190.0, 69.0, 180.0, 50.0, 80.0, 160.0, 105.0, 90.0, 89.0, 80.0, 19.0, -252.0, 19.0, 20.0, 390.0, 0.0, 110.0, -11.0, 220.0, 29.0, 60.0, 140.0, 57.0, 29.0, 70.0, 130.0, 80.0, 78.0, 80.0, 70.0, 160.0, -35.0, 40.0, 39.0, 40.0, 130.0, 90.0, 310.0, 230.0, 290.0, 190.0, 201.0, -40.0, -13.0, 805.0, 50.0, 25.0, 60.0, 60.0, 150.0, 29.0, 40.0, 110.0, 30.0, 38.0, 40.0, 90.0, 19.0, 17.0, 50.0, 80.0, 50.0, 60.0, 110.0, 129.0, 100.0, 50.0, 120.0, 110.0, 150.0, 16.0, 160.0, 98.0, 98.0, 80.0, 499.0, 70.0, 0.0, 52.0, 230.0, 0.0, -2.0, 100.0, 60.0, 3.0, 30.0, 100.0, 140.0, 60.0, 60.0, 87.0, 60.0, 260.0, 65.0, 104.0, 70.0, 56.0, -25.0, 98.0, 100.0, -56.0, 40.0, 320.0, 180.0, 130.0, 80.0, 120.0, 50.0, 105.0, 58.0, 70.0, 90.0, 22.0, 320.0, -40.0, 60.0, 133.0, 70.0, 80.0, 50.0, 40.0, 310.0, 120.0, 90.0, 120.0, 198.0, 50.0, 80.0, -264.0, 70.0, 70.0, 300.0, 100.0, 38.0, 127.0, 109.0, 80.0, 110.0, 99.0, 60.0, 420.0, 100.0, 60.0, 80.0, 20.0, 67.0, 70.0, 180.0, 20.0, 27.0, 25.0, 50.0, 133.0, 170.0, 232.0, 40.0, 90.0, 80.0, 100.0, 195.0, 60.0, 140.0, 10.0, 10.0, 30.0, 40.0, 130.0, 30.0, 40.0, 30.0, 35.0, 100.0, 90.0, 66.0, 90.0, 250.0, 130.0, 80.0, 79.0, 105.0, 30.0, 10.0, 25.0, 46.0, 130.0, 80.0, 19.0, 30.0, -20.0, 140.0, 60.0, 70.0, 70.0, 90.0, 100.0, 440.0, -30.0, 90.0, 110.0, 110.0, -10.0, 28.0, 140.0, 180.0, 30.0, 60.0, 40.0, 86.0, 330.0, 97.0, 80.0, 340.0, 140.0, -22.0, 70.0, 600.0, 100.0, 130.0, 78.0, 220.0, 118.0, 15.0, 90.0, -30.0, 1209.0, 90.0, 180.0, 138.0, 68.0, 100.0, 186.0, 177.0, 60.0, 100.0, 110.0, 407.0, 129.0, 170.0, 90.0, 80.0, 60.0, 78.0, 58.0, -12.0, 120.0, 110.0, 20.0, 115.0, 130.0, 70.0, 70.0, 70.0, 20.0, 90.0, 170.0, 25.0, 70.0, 150.0, 70.0, 30.0, 90.0, 100.0, 90.0, 71.0, 120.0, 89.0, 73.0, 120.0, 60.0, 110.0, 215.0, 56.0, 130.0, 106.0, 103.0, 43.0, 90.0, 120.0, 69.0, 82.0, 130.0, 69.0, 120.0, 60.0, 60.0, 68.0, 190.0, 70.0, 100.0, 70.0, 80.0, 150.0, 80.0, 160.0, 90.0, 47.0, 160.0, -14.0, 295.0, 150.0, 90.0, 170.0, 70.0, 110.0, 87.0, 69.0, 507.0, 100.0, 69.0, 20.0, 99.0, 100.0, 80.0, 150.0, 50.0, 88.0, 80.0, -80.0, 110.0, 300.0, 200.0, 15.0, 420.0, 230.0, 180.0, 120.0, 60.0, 90.0, 120.0, 460.0, 80.0, 19.0, 69.0, 80.0, 300.0, 15.0, 40.0, 37.0, 28.0, 20.0, 450.0, 550.0, 130.0, 110.0, -55.0, 140.0, -29.0, 200.0, -5.0, 164.0, 70.0, 70.0, 90.0, 84.0, 400.0, -80.0, 195.0, 50.0, 40.0, 290.0, 70.0, 200.0, 76.0, 180.0, 48.0, 80.0, 13.0, 140.0, 109.0, 97.0, 90.0, 560.0, 160.0, 106.0, 90.0, 150.0, 69.0, 0.0, 50.0, 9.0, 150.0, 46.0, 59.0, 310.0, 129.0, 70.0, 66.0, 130.0, 60.0, 60.0, 80.0, 100.0, 15.0, 110.0, 45.0, 200.0, 350.0, -30.0, 30.0, 60.0, 340.0, 40.0, 60.0, 70.0, 130.0, 90.0, 110.0, 60.0, 320.0, 90.0, -30.0, 69.0, 330.0, 30.0, 120.0, 130.0, 240.0, 50.0, 200.0, -100.0, 55.0, 194.0, 106.0, 359.0, -31.0, 99.0, 90.0, -2.0, -10.0, 306.0, 441.0, 140.0, 130.0, 90.0, 240.0, -50.0, 450.0, 249.0, 48.0, 50.0, 80.0, 70.0, 100.0, 160.0, 60.0, 164.0, 120.0, 93.0, 80.0, 85.0, 100.0, 110.0, 80.0, 100.0, 150.0, 60.0, 70.0, 280.0, 45.0, 43.0, 170.0, 150.0, 130.0, 40.0, 57.0, 120.0, 120.0, 117.0, 100.0, 38.0, 87.0, 100.0, 81.0, 80.0, 48.0, 130.0, 80.0, 100.0, 30.0, 112.0, 80.0, 99.0, 120.0, 120.0, 190.0, 59.0, 330.0, 330.0, 100.0, 120.0, 78.0, 80.0, 80.0, 100.0, 277.0, 160.0, 200.0, 80.0, 99.0, 180.0, 110.0, 50.0, 30.0, 146.0, 100.0, 155.0, 114.0, 50.0, 22.0, 80.0, 96.0, 90.0, 60.0, 80.0, 884.0, -50.0, 98.0, 120.0, 210.0, 140.0, 300.0, 130.0, 800.0, 60.0, 50.0, 54.0, -20.0, 110.0, 366.0, 50.0, 58.0, 3.0, 300.0, 20.0, 70.0, 160.0, 328.0, 48.0, 70.0, 146.0, 100.0, 70.0, 70.0, 110.0, 50.0, 70.0, 100.0, 70.0, 110.0, 130.0, 28.0, 100.0, 48.0, 20.0, 60.0, 216.0, 100.0, 180.0, 108.0, 35.0, 70.0, 59.0, 98.0, 48.0, 160.0, 79.0, 70.0, 100.0, 283.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9140548201629883, "mean_inference_ms": 2.151230751449841, "mean_action_processing_ms": 0.73012706084737, "mean_env_wait_ms": 1.5012851485058725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07626128196716309, "StateBufferConnector_ms": 0.009951114654541016, "ViewRequirementAgentConnector_ms": 0.4985837936401367}, "num_episodes": 18, "episode_return_max": 1978.0, "episode_return_min": 463.0, "episode_return_mean": 1064.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.82006897532766, "num_env_steps_trained_throughput_per_sec": 32.82006897532766, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 5600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5600000, "timers": {"training_iteration_time_ms": 122690.092, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122690.031, "sample_time_ms": 3124.705, "learn_time_ms": 119541.957, "learn_throughput": 33.461, "synch_weights_time_ms": 12.409}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "done": false, "training_iteration": 140, "trial_id": "6085c_00000", "date": "2024-07-02_03-44-36", "timestamp": 1719906276, "time_this_iter_s": 121.88947987556458, "time_total_s": 19121.611770391464, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b67ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19121.611770391464, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 20.926162790697674, "ram_util_percent": 78.40348837209302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7768798031619055, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.14966037458759, "policy_loss": -0.007486459576372053, "vf_loss": 8.15579404846167, "vf_explained_var": 0.0009675783407700837, "kl": 0.006012357599540527, "entropy": 0.4142263944188373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1319295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "env_runners": {"episode_reward_max": 2066.0, "episode_reward_min": 463.0, "episode_reward_mean": 1121.61, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -264.0}, "policy_reward_max": {"policy_0": 1209.0}, "policy_reward_mean": {"policy_0": 112.161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [882.0, 976.0, 926.0, 840.0, 909.0, 1328.0, 1012.0, 903.0, 1100.0, 895.0, 1110.0, 1184.0, 1607.0, 807.0, 1177.0, 1255.0, 1051.0, 1185.0, 825.0, 1317.0, 1030.0, 1093.0, 544.0, 794.0, 1294.0, 1488.0, 463.0, 959.0, 1303.0, 551.0, 875.0, 1027.0, 855.0, 814.0, 1093.0, 1044.0, 1115.0, 520.0, 1025.0, 490.0, 1110.0, 981.0, 1736.0, 1978.0, 1509.0, 749.0, 765.0, 923.0, 1014.0, 937.0, 1198.0, 1292.0, 977.0, 1895.0, 688.0, 1655.0, 1209.0, 1013.0, 1284.0, 1080.0, 960.0, 1310.0, 1039.0, 1166.0, 1788.0, 1012.0, 1038.0, 1042.0, 848.0, 1548.0, 1334.0, 857.0, 1728.0, 1900.0, 1203.0, 880.0, 895.0, 1007.0, 1073.0, 1322.0, 934.0, 949.0, 678.0, 1584.0, 1271.0, 900.0, 2066.0, 888.0, 1278.0, 1523.0, 1316.0, 1693.0, 1217.0, 1025.0, 1070.0, 1097.0, 2065.0, 980.0, 1167.0, 851.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [19.0, 220.0, 29.0, 110.0, 120.0, -25.0, 50.0, 39.0, 320.0, 0.0, 99.0, 35.0, 170.0, 40.0, 130.0, 178.0, 99.0, 100.0, 80.0, 45.0, 90.0, 180.0, 170.0, 40.0, 90.0, 80.0, 90.0, 59.0, 37.0, 90.0, 80.0, 100.0, 170.0, 10.0, 60.0, 80.0, 30.0, 100.0, 90.0, 120.0, 470.0, -55.0, -26.0, 150.0, 60.0, 40.0, 100.0, 40.0, 0.0, 130.0, 120.0, 79.0, 57.0, 100.0, 80.0, 509.0, 110.0, 45.0, 188.0, 40.0, 90.0, 130.0, 150.0, 110.0, 80.0, 70.0, 100.0, 73.0, 60.0, 149.0, 54.0, 110.0, 100.0, 54.0, 400.0, 55.0, -30.0, 70.0, 50.0, 40.0, 170.0, 80.0, 150.0, 170.0, 90.0, 120.0, 90.0, 50.0, 90.0, 90.0, 40.0, 70.0, 60.0, 50.0, 180.0, 5.0, 150.0, 80.0, 120.0, 140.0, 165.0, 70.0, 150.0, 130.0, 50.0, 90.0, 229.0, 50.0, 38.0, 138.0, 60.0, 145.0, 306.0, 70.0, 110.0, -20.0, 146.0, 179.0, 108.0, 80.0, 60.0, 50.0, 99.0, -21.0, 70.0, 820.0, 154.0, 20.0, 45.0, 310.0, 69.0, 50.0, 90.0, 110.0, 35.0, 73.0, 80.0, 110.0, 110.0, 80.0, 410.0, 30.0, 30.0, 80.0, 59.0, 397.0, 69.0, 80.0, 89.0, -67.0, 90.0, 90.0, 30.0, 110.0, 130.0, 80.0, 390.0, 65.0, 130.0, 140.0, 66.0, 300.0, 101.0, 0.0, 110.0, 88.0, 50.0, 150.0, 78.0, 108.0, 160.0, 50.0, 0.0, 40.0, 250.0, 100.0, 85.0, 120.0, 60.0, 320.0, 40.0, 50.0, 200.0, 10.0, 70.0, 120.0, 80.0, 80.0, 120.0, 55.0, 25.0, 70.0, 166.0, 110.0, 66.0, 130.0, 580.0, 40.0, 70.0, 60.0, 80.0, 60.0, 230.0, 60.0, 90.0, 90.0, 100.0, 50.0, 190.0, 80.0, 190.0, 69.0, 180.0, 50.0, 80.0, 160.0, 105.0, 90.0, 89.0, 80.0, 19.0, -252.0, 19.0, 20.0, 390.0, 0.0, 110.0, -11.0, 220.0, 29.0, 60.0, 140.0, 57.0, 29.0, 70.0, 130.0, 80.0, 78.0, 80.0, 70.0, 160.0, -35.0, 40.0, 39.0, 40.0, 130.0, 90.0, 310.0, 230.0, 290.0, 190.0, 201.0, -40.0, -13.0, 805.0, 50.0, 25.0, 60.0, 60.0, 150.0, 29.0, 40.0, 110.0, 30.0, 38.0, 40.0, 90.0, 19.0, 17.0, 50.0, 80.0, 50.0, 60.0, 110.0, 129.0, 100.0, 50.0, 120.0, 110.0, 150.0, 16.0, 160.0, 98.0, 98.0, 80.0, 499.0, 70.0, 0.0, 52.0, 230.0, 0.0, -2.0, 100.0, 60.0, 3.0, 30.0, 100.0, 140.0, 60.0, 60.0, 87.0, 60.0, 260.0, 65.0, 104.0, 70.0, 56.0, -25.0, 98.0, 100.0, -56.0, 40.0, 320.0, 180.0, 130.0, 80.0, 120.0, 50.0, 105.0, 58.0, 70.0, 90.0, 22.0, 320.0, -40.0, 60.0, 133.0, 70.0, 80.0, 50.0, 40.0, 310.0, 120.0, 90.0, 120.0, 198.0, 50.0, 80.0, -264.0, 70.0, 70.0, 300.0, 100.0, 38.0, 127.0, 109.0, 80.0, 110.0, 99.0, 60.0, 420.0, 100.0, 60.0, 80.0, 20.0, 67.0, 70.0, 180.0, 20.0, 27.0, 25.0, 50.0, 133.0, 170.0, 232.0, 40.0, 90.0, 80.0, 100.0, 195.0, 60.0, 140.0, 10.0, 10.0, 30.0, 40.0, 130.0, 30.0, 40.0, 30.0, 35.0, 100.0, 90.0, 66.0, 90.0, 250.0, 130.0, 80.0, 79.0, 105.0, 30.0, 10.0, 25.0, 46.0, 130.0, 80.0, 19.0, 30.0, -20.0, 140.0, 60.0, 70.0, 70.0, 90.0, 100.0, 440.0, -30.0, 90.0, 110.0, 110.0, -10.0, 28.0, 140.0, 180.0, 30.0, 60.0, 40.0, 86.0, 330.0, 97.0, 80.0, 340.0, 140.0, -22.0, 70.0, 600.0, 100.0, 130.0, 78.0, 220.0, 118.0, 15.0, 90.0, -30.0, 1209.0, 90.0, 180.0, 138.0, 68.0, 100.0, 186.0, 177.0, 60.0, 100.0, 110.0, 407.0, 129.0, 170.0, 90.0, 80.0, 60.0, 78.0, 58.0, -12.0, 120.0, 110.0, 20.0, 115.0, 130.0, 70.0, 70.0, 70.0, 20.0, 90.0, 170.0, 25.0, 70.0, 150.0, 70.0, 30.0, 90.0, 100.0, 90.0, 71.0, 120.0, 89.0, 73.0, 120.0, 60.0, 110.0, 215.0, 56.0, 130.0, 106.0, 103.0, 43.0, 90.0, 120.0, 69.0, 82.0, 130.0, 69.0, 120.0, 60.0, 60.0, 68.0, 190.0, 70.0, 100.0, 70.0, 80.0, 150.0, 80.0, 160.0, 90.0, 47.0, 160.0, -14.0, 295.0, 150.0, 90.0, 170.0, 70.0, 110.0, 87.0, 69.0, 507.0, 100.0, 69.0, 20.0, 99.0, 100.0, 80.0, 150.0, 50.0, 88.0, 80.0, -80.0, 110.0, 300.0, 200.0, 15.0, 420.0, 230.0, 180.0, 120.0, 60.0, 90.0, 120.0, 460.0, 80.0, 19.0, 69.0, 80.0, 300.0, 15.0, 40.0, 37.0, 28.0, 20.0, 450.0, 550.0, 130.0, 110.0, -55.0, 140.0, -29.0, 200.0, -5.0, 164.0, 70.0, 70.0, 90.0, 84.0, 400.0, -80.0, 195.0, 50.0, 40.0, 290.0, 70.0, 200.0, 76.0, 180.0, 48.0, 80.0, 13.0, 140.0, 109.0, 97.0, 90.0, 560.0, 160.0, 106.0, 90.0, 150.0, 69.0, 0.0, 50.0, 9.0, 150.0, 46.0, 59.0, 310.0, 129.0, 70.0, 66.0, 130.0, 60.0, 60.0, 80.0, 100.0, 15.0, 110.0, 45.0, 200.0, 350.0, -30.0, 30.0, 60.0, 340.0, 40.0, 60.0, 70.0, 130.0, 90.0, 110.0, 60.0, 320.0, 90.0, -30.0, 69.0, 330.0, 30.0, 120.0, 130.0, 240.0, 50.0, 200.0, -100.0, 55.0, 194.0, 106.0, 359.0, -31.0, 99.0, 90.0, -2.0, -10.0, 306.0, 441.0, 140.0, 130.0, 90.0, 240.0, -50.0, 450.0, 249.0, 48.0, 50.0, 80.0, 70.0, 100.0, 160.0, 60.0, 164.0, 120.0, 93.0, 80.0, 85.0, 100.0, 110.0, 80.0, 100.0, 150.0, 60.0, 70.0, 280.0, 45.0, 43.0, 170.0, 150.0, 130.0, 40.0, 57.0, 120.0, 120.0, 117.0, 100.0, 38.0, 87.0, 100.0, 81.0, 80.0, 48.0, 130.0, 80.0, 100.0, 30.0, 112.0, 80.0, 99.0, 120.0, 120.0, 190.0, 59.0, 330.0, 330.0, 100.0, 120.0, 78.0, 80.0, 80.0, 100.0, 277.0, 160.0, 200.0, 80.0, 99.0, 180.0, 110.0, 50.0, 30.0, 146.0, 100.0, 155.0, 114.0, 50.0, 22.0, 80.0, 96.0, 90.0, 60.0, 80.0, 884.0, -50.0, 98.0, 120.0, 210.0, 140.0, 300.0, 130.0, 800.0, 60.0, 50.0, 54.0, -20.0, 110.0, 366.0, 50.0, 58.0, 3.0, 300.0, 20.0, 70.0, 160.0, 328.0, 48.0, 70.0, 146.0, 100.0, 70.0, 70.0, 110.0, 50.0, 70.0, 100.0, 70.0, 110.0, 130.0, 28.0, 100.0, 48.0, 20.0, 60.0, 216.0, 100.0, 180.0, 108.0, 35.0, 70.0, 59.0, 98.0, 48.0, 160.0, 79.0, 70.0, 100.0, 283.0, 40.0, 180.0, 26.0, 310.0, 78.0, 8.0, 62.0, 110.0, 220.0, 60.0, 19.0, 110.0, 55.0, 80.0, 99.0, 510.0, 120.0, 180.0, 100.0, 88.0, -20.0, 100.0, 70.0, 85.0, 160.0, 70.0, 130.0, 80.0, 112.0, -43.0, 170.0, -5.0, 100.0, 90.0, 120.0, 69.0, 150.0, 57.0, 128.0, 100.0, 140.0, 60.0, 59.0, 90.0, 20.0, 80.0, 50.0, 60.0, 59.0, 100.0, 100.0, 126.0, 190.0, 120.0, 559.0, 70.0, 50.0, 70.0, 100.0, 310.0, -11.0, 70.0, 90.0, 120.0, 50.0, 46.0, 110.0, 30.0, 450.0, 250.0, 55.0, 90.0, 70.0, 70.0, 130.0, 70.0, 310.0, 60.0, 80.0, 50.0, -30.0, 1149.0, 110.0, -20.0, 0.0, 129.0, 90.0, 110.0, 80.0, 69.0, 349.0, 80.0, 0.0, 100.0, 140.0, 32.0, 50.0, -44.0, 530.0, -30.0, 30.0, 65.0, 90.0, 60.0, 72.0, 520.0, 58.0, 73.0, 130.0, 90.0, 120.0, 88.0, 440.0, 90.0, 129.0, 90.0, 70.0, 339.0, 110.0, 80.0, 87.0, 378.0, -41.0, 220.0, 110.0, 94.0, 160.0, 120.0, 150.0, 70.0, 55.0, 110.0, 75.0, 360.0, 400.0, 79.0, 110.0, 60.0, 69.0, 50.0, 380.0, 130.0, 250.0, 162.0, 26.0, 50.0, 70.0, 47.0, 212.0, 70.0, 200.0, 50.0, 0.0, 20.0, 50.0, 510.0, 148.0, 80.0, 60.0, 27.0, 80.0, 190.0, 70.0, 120.0, 80.0, 120.0, 100.0, 70.0, 180.0, 30.0, 110.0, 120.0, 55.0, 70.0, 88.0, 320.0, 38.0, 70.0, 85.0, 211.0, 40.0, 70.0, 150.0, 80.0, 147.0, 90.0, 180.0, 140.0, 350.0, 678.0, 180.0, 70.0, 90.0, 90.0, 106.0, 97.0, 97.0, 50.0, 70.0, 190.0, 120.0, 180.0, 186.0, 70.0, 190.0, 90.0, 107.0, 19.0, 38.0, 230.0, 57.0, 40.0, 210.0, 39.0, 69.0, 128.0, 30.0, 28.0, 77.0, 130.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9145289350380403, "mean_inference_ms": 2.150151313698114, "mean_action_processing_ms": 0.7295489614483163, "mean_env_wait_ms": 1.500388558667346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07920503616333008, "StateBufferConnector_ms": 0.01017904281616211, "ViewRequirementAgentConnector_ms": 0.5132813453674316}, "num_episodes": 22, "episode_return_max": 2066.0, "episode_return_min": 463.0, "episode_return_mean": 1121.61, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 33.02983257925571, "num_env_steps_trained_throughput_per_sec": 33.02983257925571, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 5640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5640000, "timers": {"training_iteration_time_ms": 122538.228, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122538.168, "sample_time_ms": 3156.436, "learn_time_ms": 119358.723, "learn_throughput": 33.512, "synch_weights_time_ms": 12.321}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "done": false, "training_iteration": 141, "trial_id": "6085c_00000", "date": "2024-07-02_03-46-37", "timestamp": 1719906397, "time_this_iter_s": 121.1382110118866, "time_total_s": 19242.74998140335, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c93430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19242.74998140335, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 20.375438596491225, "ram_util_percent": 78.15730994152047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.576463741083115, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.332119323955938, "policy_loss": -0.007522993277003582, "vf_loss": 8.338202973651175, "vf_explained_var": 0.001166843847471812, "kl": 0.006397087290754063, "entropy": 0.43801389038562777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1328685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "env_runners": {"episode_reward_max": 2066.0, "episode_reward_min": 463.0, "episode_reward_mean": 1130.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -264.0}, "policy_reward_max": {"policy_0": 1209.0}, "policy_reward_mean": {"policy_0": 113.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [825.0, 1317.0, 1030.0, 1093.0, 544.0, 794.0, 1294.0, 1488.0, 463.0, 959.0, 1303.0, 551.0, 875.0, 1027.0, 855.0, 814.0, 1093.0, 1044.0, 1115.0, 520.0, 1025.0, 490.0, 1110.0, 981.0, 1736.0, 1978.0, 1509.0, 749.0, 765.0, 923.0, 1014.0, 937.0, 1198.0, 1292.0, 977.0, 1895.0, 688.0, 1655.0, 1209.0, 1013.0, 1284.0, 1080.0, 960.0, 1310.0, 1039.0, 1166.0, 1788.0, 1012.0, 1038.0, 1042.0, 848.0, 1548.0, 1334.0, 857.0, 1728.0, 1900.0, 1203.0, 880.0, 895.0, 1007.0, 1073.0, 1322.0, 934.0, 949.0, 678.0, 1584.0, 1271.0, 900.0, 2066.0, 888.0, 1278.0, 1523.0, 1316.0, 1693.0, 1217.0, 1025.0, 1070.0, 1097.0, 2065.0, 980.0, 1167.0, 851.0, 919.0, 1374.0, 1377.0, 959.0, 1370.0, 768.0, 1069.0, 1428.0, 1296.0, 1353.0, 836.0, 1166.0, 1264.0, 1098.0, 789.0, 822.0, 988.0, 1140.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 50.0, 200.0, 10.0, 70.0, 120.0, 80.0, 80.0, 120.0, 55.0, 25.0, 70.0, 166.0, 110.0, 66.0, 130.0, 580.0, 40.0, 70.0, 60.0, 80.0, 60.0, 230.0, 60.0, 90.0, 90.0, 100.0, 50.0, 190.0, 80.0, 190.0, 69.0, 180.0, 50.0, 80.0, 160.0, 105.0, 90.0, 89.0, 80.0, 19.0, -252.0, 19.0, 20.0, 390.0, 0.0, 110.0, -11.0, 220.0, 29.0, 60.0, 140.0, 57.0, 29.0, 70.0, 130.0, 80.0, 78.0, 80.0, 70.0, 160.0, -35.0, 40.0, 39.0, 40.0, 130.0, 90.0, 310.0, 230.0, 290.0, 190.0, 201.0, -40.0, -13.0, 805.0, 50.0, 25.0, 60.0, 60.0, 150.0, 29.0, 40.0, 110.0, 30.0, 38.0, 40.0, 90.0, 19.0, 17.0, 50.0, 80.0, 50.0, 60.0, 110.0, 129.0, 100.0, 50.0, 120.0, 110.0, 150.0, 16.0, 160.0, 98.0, 98.0, 80.0, 499.0, 70.0, 0.0, 52.0, 230.0, 0.0, -2.0, 100.0, 60.0, 3.0, 30.0, 100.0, 140.0, 60.0, 60.0, 87.0, 60.0, 260.0, 65.0, 104.0, 70.0, 56.0, -25.0, 98.0, 100.0, -56.0, 40.0, 320.0, 180.0, 130.0, 80.0, 120.0, 50.0, 105.0, 58.0, 70.0, 90.0, 22.0, 320.0, -40.0, 60.0, 133.0, 70.0, 80.0, 50.0, 40.0, 310.0, 120.0, 90.0, 120.0, 198.0, 50.0, 80.0, -264.0, 70.0, 70.0, 300.0, 100.0, 38.0, 127.0, 109.0, 80.0, 110.0, 99.0, 60.0, 420.0, 100.0, 60.0, 80.0, 20.0, 67.0, 70.0, 180.0, 20.0, 27.0, 25.0, 50.0, 133.0, 170.0, 232.0, 40.0, 90.0, 80.0, 100.0, 195.0, 60.0, 140.0, 10.0, 10.0, 30.0, 40.0, 130.0, 30.0, 40.0, 30.0, 35.0, 100.0, 90.0, 66.0, 90.0, 250.0, 130.0, 80.0, 79.0, 105.0, 30.0, 10.0, 25.0, 46.0, 130.0, 80.0, 19.0, 30.0, -20.0, 140.0, 60.0, 70.0, 70.0, 90.0, 100.0, 440.0, -30.0, 90.0, 110.0, 110.0, -10.0, 28.0, 140.0, 180.0, 30.0, 60.0, 40.0, 86.0, 330.0, 97.0, 80.0, 340.0, 140.0, -22.0, 70.0, 600.0, 100.0, 130.0, 78.0, 220.0, 118.0, 15.0, 90.0, -30.0, 1209.0, 90.0, 180.0, 138.0, 68.0, 100.0, 186.0, 177.0, 60.0, 100.0, 110.0, 407.0, 129.0, 170.0, 90.0, 80.0, 60.0, 78.0, 58.0, -12.0, 120.0, 110.0, 20.0, 115.0, 130.0, 70.0, 70.0, 70.0, 20.0, 90.0, 170.0, 25.0, 70.0, 150.0, 70.0, 30.0, 90.0, 100.0, 90.0, 71.0, 120.0, 89.0, 73.0, 120.0, 60.0, 110.0, 215.0, 56.0, 130.0, 106.0, 103.0, 43.0, 90.0, 120.0, 69.0, 82.0, 130.0, 69.0, 120.0, 60.0, 60.0, 68.0, 190.0, 70.0, 100.0, 70.0, 80.0, 150.0, 80.0, 160.0, 90.0, 47.0, 160.0, -14.0, 295.0, 150.0, 90.0, 170.0, 70.0, 110.0, 87.0, 69.0, 507.0, 100.0, 69.0, 20.0, 99.0, 100.0, 80.0, 150.0, 50.0, 88.0, 80.0, -80.0, 110.0, 300.0, 200.0, 15.0, 420.0, 230.0, 180.0, 120.0, 60.0, 90.0, 120.0, 460.0, 80.0, 19.0, 69.0, 80.0, 300.0, 15.0, 40.0, 37.0, 28.0, 20.0, 450.0, 550.0, 130.0, 110.0, -55.0, 140.0, -29.0, 200.0, -5.0, 164.0, 70.0, 70.0, 90.0, 84.0, 400.0, -80.0, 195.0, 50.0, 40.0, 290.0, 70.0, 200.0, 76.0, 180.0, 48.0, 80.0, 13.0, 140.0, 109.0, 97.0, 90.0, 560.0, 160.0, 106.0, 90.0, 150.0, 69.0, 0.0, 50.0, 9.0, 150.0, 46.0, 59.0, 310.0, 129.0, 70.0, 66.0, 130.0, 60.0, 60.0, 80.0, 100.0, 15.0, 110.0, 45.0, 200.0, 350.0, -30.0, 30.0, 60.0, 340.0, 40.0, 60.0, 70.0, 130.0, 90.0, 110.0, 60.0, 320.0, 90.0, -30.0, 69.0, 330.0, 30.0, 120.0, 130.0, 240.0, 50.0, 200.0, -100.0, 55.0, 194.0, 106.0, 359.0, -31.0, 99.0, 90.0, -2.0, -10.0, 306.0, 441.0, 140.0, 130.0, 90.0, 240.0, -50.0, 450.0, 249.0, 48.0, 50.0, 80.0, 70.0, 100.0, 160.0, 60.0, 164.0, 120.0, 93.0, 80.0, 85.0, 100.0, 110.0, 80.0, 100.0, 150.0, 60.0, 70.0, 280.0, 45.0, 43.0, 170.0, 150.0, 130.0, 40.0, 57.0, 120.0, 120.0, 117.0, 100.0, 38.0, 87.0, 100.0, 81.0, 80.0, 48.0, 130.0, 80.0, 100.0, 30.0, 112.0, 80.0, 99.0, 120.0, 120.0, 190.0, 59.0, 330.0, 330.0, 100.0, 120.0, 78.0, 80.0, 80.0, 100.0, 277.0, 160.0, 200.0, 80.0, 99.0, 180.0, 110.0, 50.0, 30.0, 146.0, 100.0, 155.0, 114.0, 50.0, 22.0, 80.0, 96.0, 90.0, 60.0, 80.0, 884.0, -50.0, 98.0, 120.0, 210.0, 140.0, 300.0, 130.0, 800.0, 60.0, 50.0, 54.0, -20.0, 110.0, 366.0, 50.0, 58.0, 3.0, 300.0, 20.0, 70.0, 160.0, 328.0, 48.0, 70.0, 146.0, 100.0, 70.0, 70.0, 110.0, 50.0, 70.0, 100.0, 70.0, 110.0, 130.0, 28.0, 100.0, 48.0, 20.0, 60.0, 216.0, 100.0, 180.0, 108.0, 35.0, 70.0, 59.0, 98.0, 48.0, 160.0, 79.0, 70.0, 100.0, 283.0, 40.0, 180.0, 26.0, 310.0, 78.0, 8.0, 62.0, 110.0, 220.0, 60.0, 19.0, 110.0, 55.0, 80.0, 99.0, 510.0, 120.0, 180.0, 100.0, 88.0, -20.0, 100.0, 70.0, 85.0, 160.0, 70.0, 130.0, 80.0, 112.0, -43.0, 170.0, -5.0, 100.0, 90.0, 120.0, 69.0, 150.0, 57.0, 128.0, 100.0, 140.0, 60.0, 59.0, 90.0, 20.0, 80.0, 50.0, 60.0, 59.0, 100.0, 100.0, 126.0, 190.0, 120.0, 559.0, 70.0, 50.0, 70.0, 100.0, 310.0, -11.0, 70.0, 90.0, 120.0, 50.0, 46.0, 110.0, 30.0, 450.0, 250.0, 55.0, 90.0, 70.0, 70.0, 130.0, 70.0, 310.0, 60.0, 80.0, 50.0, -30.0, 1149.0, 110.0, -20.0, 0.0, 129.0, 90.0, 110.0, 80.0, 69.0, 349.0, 80.0, 0.0, 100.0, 140.0, 32.0, 50.0, -44.0, 530.0, -30.0, 30.0, 65.0, 90.0, 60.0, 72.0, 520.0, 58.0, 73.0, 130.0, 90.0, 120.0, 88.0, 440.0, 90.0, 129.0, 90.0, 70.0, 339.0, 110.0, 80.0, 87.0, 378.0, -41.0, 220.0, 110.0, 94.0, 160.0, 120.0, 150.0, 70.0, 55.0, 110.0, 75.0, 360.0, 400.0, 79.0, 110.0, 60.0, 69.0, 50.0, 380.0, 130.0, 250.0, 162.0, 26.0, 50.0, 70.0, 47.0, 212.0, 70.0, 200.0, 50.0, 0.0, 20.0, 50.0, 510.0, 148.0, 80.0, 60.0, 27.0, 80.0, 190.0, 70.0, 120.0, 80.0, 120.0, 100.0, 70.0, 180.0, 30.0, 110.0, 120.0, 55.0, 70.0, 88.0, 320.0, 38.0, 70.0, 85.0, 211.0, 40.0, 70.0, 150.0, 80.0, 147.0, 90.0, 180.0, 140.0, 350.0, 678.0, 180.0, 70.0, 90.0, 90.0, 106.0, 97.0, 97.0, 50.0, 70.0, 190.0, 120.0, 180.0, 186.0, 70.0, 190.0, 90.0, 107.0, 19.0, 38.0, 230.0, 57.0, 40.0, 210.0, 39.0, 69.0, 128.0, 30.0, 28.0, 77.0, 130.0, 100.0, 130.0, 110.0, 40.0, 110.0, 80.0, 49.0, 150.0, 60.0, 120.0, 70.0, 100.0, 70.0, 70.0, 69.0, 77.0, 370.0, 300.0, -30.0, 148.0, 200.0, 120.0, 500.0, 197.0, 110.0, 70.0, 40.0, 30.0, 10.0, 60.0, 240.0, 100.0, 132.0, -10.0, 256.0, -60.0, 180.0, -48.0, 60.0, 59.0, 290.0, 70.0, 210.0, 60.0, 150.0, 60.0, 200.0, -10.0, 20.0, 580.0, 30.0, 23.0, 165.0, 70.0, 100.0, 70.0, 80.0, -150.0, 173.0, 130.0, 107.0, 85.0, 80.0, 50.0, 190.0, 70.0, 250.0, 54.0, 90.0, 90.0, 110.0, 100.0, 520.0, 138.0, 79.0, 80.0, 130.0, 90.0, 94.0, 100.0, 97.0, 78.0, 60.0, 68.0, 50.0, 210.0, 250.0, 190.0, 120.0, 100.0, 170.0, 50.0, 67.0, 44.0, -43.0, 79.0, 110.0, 120.0, 896.0, -50.0, 80.0, 310.0, 90.0, 100.0, 36.0, 140.0, 90.0, 30.0, -75.0, 55.0, 60.0, 80.0, 120.0, 70.0, 320.0, 28.0, 220.0, 50.0, 60.0, 98.0, 120.0, 62.0, 113.0, 140.0, 350.0, 150.0, 20.0, 90.0, 100.0, 99.0, 140.0, 69.0, 79.0, 80.0, 170.0, 90.0, 110.0, 310.0, 50.0, 40.0, 100.0, 90.0, 60.0, 270.0, 50.0, 23.0, 120.0, -20.0, 0.0, 26.0, 170.0, 60.0, 100.0, 25.0, 109.0, 60.0, 40.0, 118.0, 60.0, 80.0, 170.0, 100.0, 60.0, 170.0, -20.0, 230.0, 78.0, 50.0, 190.0, 80.0, 50.0, 80.0, 195.0, 70.0, 50.0, 130.0, 150.0, 290.0, 80.0, 25.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9149462435821576, "mean_inference_ms": 2.149135143479134, "mean_action_processing_ms": 0.7291100908234185, "mean_env_wait_ms": 1.4996322939819424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0733485221862793, "StateBufferConnector_ms": 0.010219335556030273, "ViewRequirementAgentConnector_ms": 0.5321083068847656}, "num_episodes": 18, "episode_return_max": 2066.0, "episode_return_min": 463.0, "episode_return_mean": 1130.3, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.53785012638185, "num_env_steps_trained_throughput_per_sec": 32.53785012638185, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 5680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5680000, "timers": {"training_iteration_time_ms": 122553.874, "restore_workers_time_ms": 0.013, "training_step_time_ms": 122553.815, "sample_time_ms": 3194.13, "learn_time_ms": 119336.764, "learn_throughput": 33.519, "synch_weights_time_ms": 12.315}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "done": false, "training_iteration": 142, "trial_id": "6085c_00000", "date": "2024-07-02_03-48-40", "timestamp": 1719906520, "time_this_iter_s": 122.97554612159729, "time_total_s": 19365.725527524948, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13814b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19365.725527524948, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 21.743678160919536, "ram_util_percent": 80.36149425287356}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6164679811277582, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.14533016272881, "policy_loss": -0.007346159673327654, "vf_loss": 8.151260898466182, "vf_explained_var": 0.0012010863667732865, "kl": 0.006290777946247085, "entropy": 0.4570525794523085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1338075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "env_runners": {"episode_reward_max": 2066.0, "episode_reward_min": 490.0, "episode_reward_mean": 1155.69, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 1209.0}, "policy_reward_mean": {"policy_0": 115.569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1115.0, 520.0, 1025.0, 490.0, 1110.0, 981.0, 1736.0, 1978.0, 1509.0, 749.0, 765.0, 923.0, 1014.0, 937.0, 1198.0, 1292.0, 977.0, 1895.0, 688.0, 1655.0, 1209.0, 1013.0, 1284.0, 1080.0, 960.0, 1310.0, 1039.0, 1166.0, 1788.0, 1012.0, 1038.0, 1042.0, 848.0, 1548.0, 1334.0, 857.0, 1728.0, 1900.0, 1203.0, 880.0, 895.0, 1007.0, 1073.0, 1322.0, 934.0, 949.0, 678.0, 1584.0, 1271.0, 900.0, 2066.0, 888.0, 1278.0, 1523.0, 1316.0, 1693.0, 1217.0, 1025.0, 1070.0, 1097.0, 2065.0, 980.0, 1167.0, 851.0, 919.0, 1374.0, 1377.0, 959.0, 1370.0, 768.0, 1069.0, 1428.0, 1296.0, 1353.0, 836.0, 1166.0, 1264.0, 1098.0, 789.0, 822.0, 988.0, 1140.0, 766.0, 1120.0, 964.0, 836.0, 1293.0, 1157.0, 1158.0, 1461.0, 1166.0, 1175.0, 1173.0, 597.0, 1371.0, 924.0, 884.0, 802.0, 1596.0, 1465.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [25.0, 50.0, 133.0, 170.0, 232.0, 40.0, 90.0, 80.0, 100.0, 195.0, 60.0, 140.0, 10.0, 10.0, 30.0, 40.0, 130.0, 30.0, 40.0, 30.0, 35.0, 100.0, 90.0, 66.0, 90.0, 250.0, 130.0, 80.0, 79.0, 105.0, 30.0, 10.0, 25.0, 46.0, 130.0, 80.0, 19.0, 30.0, -20.0, 140.0, 60.0, 70.0, 70.0, 90.0, 100.0, 440.0, -30.0, 90.0, 110.0, 110.0, -10.0, 28.0, 140.0, 180.0, 30.0, 60.0, 40.0, 86.0, 330.0, 97.0, 80.0, 340.0, 140.0, -22.0, 70.0, 600.0, 100.0, 130.0, 78.0, 220.0, 118.0, 15.0, 90.0, -30.0, 1209.0, 90.0, 180.0, 138.0, 68.0, 100.0, 186.0, 177.0, 60.0, 100.0, 110.0, 407.0, 129.0, 170.0, 90.0, 80.0, 60.0, 78.0, 58.0, -12.0, 120.0, 110.0, 20.0, 115.0, 130.0, 70.0, 70.0, 70.0, 20.0, 90.0, 170.0, 25.0, 70.0, 150.0, 70.0, 30.0, 90.0, 100.0, 90.0, 71.0, 120.0, 89.0, 73.0, 120.0, 60.0, 110.0, 215.0, 56.0, 130.0, 106.0, 103.0, 43.0, 90.0, 120.0, 69.0, 82.0, 130.0, 69.0, 120.0, 60.0, 60.0, 68.0, 190.0, 70.0, 100.0, 70.0, 80.0, 150.0, 80.0, 160.0, 90.0, 47.0, 160.0, -14.0, 295.0, 150.0, 90.0, 170.0, 70.0, 110.0, 87.0, 69.0, 507.0, 100.0, 69.0, 20.0, 99.0, 100.0, 80.0, 150.0, 50.0, 88.0, 80.0, -80.0, 110.0, 300.0, 200.0, 15.0, 420.0, 230.0, 180.0, 120.0, 60.0, 90.0, 120.0, 460.0, 80.0, 19.0, 69.0, 80.0, 300.0, 15.0, 40.0, 37.0, 28.0, 20.0, 450.0, 550.0, 130.0, 110.0, -55.0, 140.0, -29.0, 200.0, -5.0, 164.0, 70.0, 70.0, 90.0, 84.0, 400.0, -80.0, 195.0, 50.0, 40.0, 290.0, 70.0, 200.0, 76.0, 180.0, 48.0, 80.0, 13.0, 140.0, 109.0, 97.0, 90.0, 560.0, 160.0, 106.0, 90.0, 150.0, 69.0, 0.0, 50.0, 9.0, 150.0, 46.0, 59.0, 310.0, 129.0, 70.0, 66.0, 130.0, 60.0, 60.0, 80.0, 100.0, 15.0, 110.0, 45.0, 200.0, 350.0, -30.0, 30.0, 60.0, 340.0, 40.0, 60.0, 70.0, 130.0, 90.0, 110.0, 60.0, 320.0, 90.0, -30.0, 69.0, 330.0, 30.0, 120.0, 130.0, 240.0, 50.0, 200.0, -100.0, 55.0, 194.0, 106.0, 359.0, -31.0, 99.0, 90.0, -2.0, -10.0, 306.0, 441.0, 140.0, 130.0, 90.0, 240.0, -50.0, 450.0, 249.0, 48.0, 50.0, 80.0, 70.0, 100.0, 160.0, 60.0, 164.0, 120.0, 93.0, 80.0, 85.0, 100.0, 110.0, 80.0, 100.0, 150.0, 60.0, 70.0, 280.0, 45.0, 43.0, 170.0, 150.0, 130.0, 40.0, 57.0, 120.0, 120.0, 117.0, 100.0, 38.0, 87.0, 100.0, 81.0, 80.0, 48.0, 130.0, 80.0, 100.0, 30.0, 112.0, 80.0, 99.0, 120.0, 120.0, 190.0, 59.0, 330.0, 330.0, 100.0, 120.0, 78.0, 80.0, 80.0, 100.0, 277.0, 160.0, 200.0, 80.0, 99.0, 180.0, 110.0, 50.0, 30.0, 146.0, 100.0, 155.0, 114.0, 50.0, 22.0, 80.0, 96.0, 90.0, 60.0, 80.0, 884.0, -50.0, 98.0, 120.0, 210.0, 140.0, 300.0, 130.0, 800.0, 60.0, 50.0, 54.0, -20.0, 110.0, 366.0, 50.0, 58.0, 3.0, 300.0, 20.0, 70.0, 160.0, 328.0, 48.0, 70.0, 146.0, 100.0, 70.0, 70.0, 110.0, 50.0, 70.0, 100.0, 70.0, 110.0, 130.0, 28.0, 100.0, 48.0, 20.0, 60.0, 216.0, 100.0, 180.0, 108.0, 35.0, 70.0, 59.0, 98.0, 48.0, 160.0, 79.0, 70.0, 100.0, 283.0, 40.0, 180.0, 26.0, 310.0, 78.0, 8.0, 62.0, 110.0, 220.0, 60.0, 19.0, 110.0, 55.0, 80.0, 99.0, 510.0, 120.0, 180.0, 100.0, 88.0, -20.0, 100.0, 70.0, 85.0, 160.0, 70.0, 130.0, 80.0, 112.0, -43.0, 170.0, -5.0, 100.0, 90.0, 120.0, 69.0, 150.0, 57.0, 128.0, 100.0, 140.0, 60.0, 59.0, 90.0, 20.0, 80.0, 50.0, 60.0, 59.0, 100.0, 100.0, 126.0, 190.0, 120.0, 559.0, 70.0, 50.0, 70.0, 100.0, 310.0, -11.0, 70.0, 90.0, 120.0, 50.0, 46.0, 110.0, 30.0, 450.0, 250.0, 55.0, 90.0, 70.0, 70.0, 130.0, 70.0, 310.0, 60.0, 80.0, 50.0, -30.0, 1149.0, 110.0, -20.0, 0.0, 129.0, 90.0, 110.0, 80.0, 69.0, 349.0, 80.0, 0.0, 100.0, 140.0, 32.0, 50.0, -44.0, 530.0, -30.0, 30.0, 65.0, 90.0, 60.0, 72.0, 520.0, 58.0, 73.0, 130.0, 90.0, 120.0, 88.0, 440.0, 90.0, 129.0, 90.0, 70.0, 339.0, 110.0, 80.0, 87.0, 378.0, -41.0, 220.0, 110.0, 94.0, 160.0, 120.0, 150.0, 70.0, 55.0, 110.0, 75.0, 360.0, 400.0, 79.0, 110.0, 60.0, 69.0, 50.0, 380.0, 130.0, 250.0, 162.0, 26.0, 50.0, 70.0, 47.0, 212.0, 70.0, 200.0, 50.0, 0.0, 20.0, 50.0, 510.0, 148.0, 80.0, 60.0, 27.0, 80.0, 190.0, 70.0, 120.0, 80.0, 120.0, 100.0, 70.0, 180.0, 30.0, 110.0, 120.0, 55.0, 70.0, 88.0, 320.0, 38.0, 70.0, 85.0, 211.0, 40.0, 70.0, 150.0, 80.0, 147.0, 90.0, 180.0, 140.0, 350.0, 678.0, 180.0, 70.0, 90.0, 90.0, 106.0, 97.0, 97.0, 50.0, 70.0, 190.0, 120.0, 180.0, 186.0, 70.0, 190.0, 90.0, 107.0, 19.0, 38.0, 230.0, 57.0, 40.0, 210.0, 39.0, 69.0, 128.0, 30.0, 28.0, 77.0, 130.0, 100.0, 130.0, 110.0, 40.0, 110.0, 80.0, 49.0, 150.0, 60.0, 120.0, 70.0, 100.0, 70.0, 70.0, 69.0, 77.0, 370.0, 300.0, -30.0, 148.0, 200.0, 120.0, 500.0, 197.0, 110.0, 70.0, 40.0, 30.0, 10.0, 60.0, 240.0, 100.0, 132.0, -10.0, 256.0, -60.0, 180.0, -48.0, 60.0, 59.0, 290.0, 70.0, 210.0, 60.0, 150.0, 60.0, 200.0, -10.0, 20.0, 580.0, 30.0, 23.0, 165.0, 70.0, 100.0, 70.0, 80.0, -150.0, 173.0, 130.0, 107.0, 85.0, 80.0, 50.0, 190.0, 70.0, 250.0, 54.0, 90.0, 90.0, 110.0, 100.0, 520.0, 138.0, 79.0, 80.0, 130.0, 90.0, 94.0, 100.0, 97.0, 78.0, 60.0, 68.0, 50.0, 210.0, 250.0, 190.0, 120.0, 100.0, 170.0, 50.0, 67.0, 44.0, -43.0, 79.0, 110.0, 120.0, 896.0, -50.0, 80.0, 310.0, 90.0, 100.0, 36.0, 140.0, 90.0, 30.0, -75.0, 55.0, 60.0, 80.0, 120.0, 70.0, 320.0, 28.0, 220.0, 50.0, 60.0, 98.0, 120.0, 62.0, 113.0, 140.0, 350.0, 150.0, 20.0, 90.0, 100.0, 99.0, 140.0, 69.0, 79.0, 80.0, 170.0, 90.0, 110.0, 310.0, 50.0, 40.0, 100.0, 90.0, 60.0, 270.0, 50.0, 23.0, 120.0, -20.0, 0.0, 26.0, 170.0, 60.0, 100.0, 25.0, 109.0, 60.0, 40.0, 118.0, 60.0, 80.0, 170.0, 100.0, 60.0, 170.0, -20.0, 230.0, 78.0, 50.0, 190.0, 80.0, 50.0, 80.0, 195.0, 70.0, 50.0, 130.0, 150.0, 290.0, 80.0, 25.0, 70.0, 168.0, 58.0, 120.0, 50.0, 18.0, 69.0, 70.0, 90.0, 5.0, 118.0, 130.0, 50.0, 100.0, 60.0, 320.0, 40.0, 140.0, 100.0, 80.0, 100.0, 110.0, 290.0, -14.0, 250.0, 90.0, 80.0, 120.0, 30.0, -120.0, 128.0, 50.0, 170.0, 30.0, 23.0, 240.0, 77.0, 67.0, 19.0, 60.0, 100.0, 90.0, 156.0, 236.0, 180.0, -35.0, 90.0, 220.0, 157.0, 90.0, 109.0, 103.0, 70.0, -10.0, 80.0, 70.0, 103.0, 405.0, 370.0, -20.0, -14.0, 53.0, 60.0, 55.0, 61.0, 80.0, 50.0, 120.0, 80.0, 540.0, 59.0, 163.0, 129.0, 95.0, 538.0, 110.0, -46.0, 160.0, 190.0, 140.0, -18.0, -11.0, 90.0, 140.0, 370.0, 130.0, 80.0, 120.0, 110.0, 78.0, 59.0, 100.0, 710.0, 40.0, 25.0, 81.0, 40.0, 90.0, 70.0, 120.0, -101.0, 100.0, 180.0, 0.0, 80.0, 228.0, 120.0, 75.0, 130.0, 160.0, 100.0, 32.0, 30.0, 99.0, 60.0, 60.0, 80.0, 110.0, 40.0, 19.0, 67.0, 130.0, 170.0, 110.0, 105.0, 586.0, -10.0, 40.0, 80.0, 60.0, 100.0, 58.0, 120.0, 70.0, 57.0, 119.0, 150.0, 60.0, 120.0, 50.0, 120.0, 130.0, 100.0, 119.0, 90.0, 70.0, 120.0, 58.0, 80.0, 59.0, 58.0, 70.0, 60.0, 190.0, 34.0, 90.0, 60.0, 110.0, 120.0, 0.0, 68.0, 88.0, 170.0, 320.0, 349.0, 99.0, 140.0, 120.0, 80.0, 130.0, 100.0, 210.0, 40.0, 170.0, 40.0, 45.0, 30.0, 30.0, 40.0, 720.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9153899131399794, "mean_inference_ms": 2.148578418660735, "mean_action_processing_ms": 0.7304016091046229, "mean_env_wait_ms": 1.499230264609409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08887386322021484, "StateBufferConnector_ms": 0.010218143463134766, "ViewRequirementAgentConnector_ms": 0.538060188293457}, "num_episodes": 18, "episode_return_max": 2066.0, "episode_return_min": 490.0, "episode_return_mean": 1155.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.94265352027777, "num_env_steps_trained_throughput_per_sec": 32.94265352027777, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 5720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5720000, "timers": {"training_iteration_time_ms": 122477.256, "restore_workers_time_ms": 0.014, "training_step_time_ms": 122477.198, "sample_time_ms": 3245.613, "learn_time_ms": 119209.256, "learn_throughput": 33.554, "synch_weights_time_ms": 12.313}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "done": false, "training_iteration": 143, "trial_id": "6085c_00000", "date": "2024-07-02_03-50-42", "timestamp": 1719906642, "time_this_iter_s": 121.43585300445557, "time_total_s": 19487.161380529404, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b84f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19487.161380529404, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 20.68197674418605, "ram_util_percent": 78.56511627906976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.64471908650967, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.123330995703911, "policy_loss": -0.007546858207661861, "vf_loss": 8.129532637662146, "vf_explained_var": 0.0012038183415405794, "kl": 0.005978733960033201, "entropy": 0.42403886269012325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1347465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "env_runners": {"episode_reward_max": 2095.0, "episode_reward_min": 597.0, "episode_reward_mean": 1167.68, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 1149.0}, "policy_reward_mean": {"policy_0": 116.768}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1080.0, 960.0, 1310.0, 1039.0, 1166.0, 1788.0, 1012.0, 1038.0, 1042.0, 848.0, 1548.0, 1334.0, 857.0, 1728.0, 1900.0, 1203.0, 880.0, 895.0, 1007.0, 1073.0, 1322.0, 934.0, 949.0, 678.0, 1584.0, 1271.0, 900.0, 2066.0, 888.0, 1278.0, 1523.0, 1316.0, 1693.0, 1217.0, 1025.0, 1070.0, 1097.0, 2065.0, 980.0, 1167.0, 851.0, 919.0, 1374.0, 1377.0, 959.0, 1370.0, 768.0, 1069.0, 1428.0, 1296.0, 1353.0, 836.0, 1166.0, 1264.0, 1098.0, 789.0, 822.0, 988.0, 1140.0, 766.0, 1120.0, 964.0, 836.0, 1293.0, 1157.0, 1158.0, 1461.0, 1166.0, 1175.0, 1173.0, 597.0, 1371.0, 924.0, 884.0, 802.0, 1596.0, 1465.0, 972.0, 1478.0, 940.0, 1034.0, 1093.0, 1285.0, 1129.0, 1267.0, 964.0, 754.0, 933.0, 1931.0, 850.0, 919.0, 2095.0, 744.0, 1500.0, 1316.0, 1311.0, 1355.0, 931.0, 1497.0, 964.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 46.0, 59.0, 310.0, 129.0, 70.0, 66.0, 130.0, 60.0, 60.0, 80.0, 100.0, 15.0, 110.0, 45.0, 200.0, 350.0, -30.0, 30.0, 60.0, 340.0, 40.0, 60.0, 70.0, 130.0, 90.0, 110.0, 60.0, 320.0, 90.0, -30.0, 69.0, 330.0, 30.0, 120.0, 130.0, 240.0, 50.0, 200.0, -100.0, 55.0, 194.0, 106.0, 359.0, -31.0, 99.0, 90.0, -2.0, -10.0, 306.0, 441.0, 140.0, 130.0, 90.0, 240.0, -50.0, 450.0, 249.0, 48.0, 50.0, 80.0, 70.0, 100.0, 160.0, 60.0, 164.0, 120.0, 93.0, 80.0, 85.0, 100.0, 110.0, 80.0, 100.0, 150.0, 60.0, 70.0, 280.0, 45.0, 43.0, 170.0, 150.0, 130.0, 40.0, 57.0, 120.0, 120.0, 117.0, 100.0, 38.0, 87.0, 100.0, 81.0, 80.0, 48.0, 130.0, 80.0, 100.0, 30.0, 112.0, 80.0, 99.0, 120.0, 120.0, 190.0, 59.0, 330.0, 330.0, 100.0, 120.0, 78.0, 80.0, 80.0, 100.0, 277.0, 160.0, 200.0, 80.0, 99.0, 180.0, 110.0, 50.0, 30.0, 146.0, 100.0, 155.0, 114.0, 50.0, 22.0, 80.0, 96.0, 90.0, 60.0, 80.0, 884.0, -50.0, 98.0, 120.0, 210.0, 140.0, 300.0, 130.0, 800.0, 60.0, 50.0, 54.0, -20.0, 110.0, 366.0, 50.0, 58.0, 3.0, 300.0, 20.0, 70.0, 160.0, 328.0, 48.0, 70.0, 146.0, 100.0, 70.0, 70.0, 110.0, 50.0, 70.0, 100.0, 70.0, 110.0, 130.0, 28.0, 100.0, 48.0, 20.0, 60.0, 216.0, 100.0, 180.0, 108.0, 35.0, 70.0, 59.0, 98.0, 48.0, 160.0, 79.0, 70.0, 100.0, 283.0, 40.0, 180.0, 26.0, 310.0, 78.0, 8.0, 62.0, 110.0, 220.0, 60.0, 19.0, 110.0, 55.0, 80.0, 99.0, 510.0, 120.0, 180.0, 100.0, 88.0, -20.0, 100.0, 70.0, 85.0, 160.0, 70.0, 130.0, 80.0, 112.0, -43.0, 170.0, -5.0, 100.0, 90.0, 120.0, 69.0, 150.0, 57.0, 128.0, 100.0, 140.0, 60.0, 59.0, 90.0, 20.0, 80.0, 50.0, 60.0, 59.0, 100.0, 100.0, 126.0, 190.0, 120.0, 559.0, 70.0, 50.0, 70.0, 100.0, 310.0, -11.0, 70.0, 90.0, 120.0, 50.0, 46.0, 110.0, 30.0, 450.0, 250.0, 55.0, 90.0, 70.0, 70.0, 130.0, 70.0, 310.0, 60.0, 80.0, 50.0, -30.0, 1149.0, 110.0, -20.0, 0.0, 129.0, 90.0, 110.0, 80.0, 69.0, 349.0, 80.0, 0.0, 100.0, 140.0, 32.0, 50.0, -44.0, 530.0, -30.0, 30.0, 65.0, 90.0, 60.0, 72.0, 520.0, 58.0, 73.0, 130.0, 90.0, 120.0, 88.0, 440.0, 90.0, 129.0, 90.0, 70.0, 339.0, 110.0, 80.0, 87.0, 378.0, -41.0, 220.0, 110.0, 94.0, 160.0, 120.0, 150.0, 70.0, 55.0, 110.0, 75.0, 360.0, 400.0, 79.0, 110.0, 60.0, 69.0, 50.0, 380.0, 130.0, 250.0, 162.0, 26.0, 50.0, 70.0, 47.0, 212.0, 70.0, 200.0, 50.0, 0.0, 20.0, 50.0, 510.0, 148.0, 80.0, 60.0, 27.0, 80.0, 190.0, 70.0, 120.0, 80.0, 120.0, 100.0, 70.0, 180.0, 30.0, 110.0, 120.0, 55.0, 70.0, 88.0, 320.0, 38.0, 70.0, 85.0, 211.0, 40.0, 70.0, 150.0, 80.0, 147.0, 90.0, 180.0, 140.0, 350.0, 678.0, 180.0, 70.0, 90.0, 90.0, 106.0, 97.0, 97.0, 50.0, 70.0, 190.0, 120.0, 180.0, 186.0, 70.0, 190.0, 90.0, 107.0, 19.0, 38.0, 230.0, 57.0, 40.0, 210.0, 39.0, 69.0, 128.0, 30.0, 28.0, 77.0, 130.0, 100.0, 130.0, 110.0, 40.0, 110.0, 80.0, 49.0, 150.0, 60.0, 120.0, 70.0, 100.0, 70.0, 70.0, 69.0, 77.0, 370.0, 300.0, -30.0, 148.0, 200.0, 120.0, 500.0, 197.0, 110.0, 70.0, 40.0, 30.0, 10.0, 60.0, 240.0, 100.0, 132.0, -10.0, 256.0, -60.0, 180.0, -48.0, 60.0, 59.0, 290.0, 70.0, 210.0, 60.0, 150.0, 60.0, 200.0, -10.0, 20.0, 580.0, 30.0, 23.0, 165.0, 70.0, 100.0, 70.0, 80.0, -150.0, 173.0, 130.0, 107.0, 85.0, 80.0, 50.0, 190.0, 70.0, 250.0, 54.0, 90.0, 90.0, 110.0, 100.0, 520.0, 138.0, 79.0, 80.0, 130.0, 90.0, 94.0, 100.0, 97.0, 78.0, 60.0, 68.0, 50.0, 210.0, 250.0, 190.0, 120.0, 100.0, 170.0, 50.0, 67.0, 44.0, -43.0, 79.0, 110.0, 120.0, 896.0, -50.0, 80.0, 310.0, 90.0, 100.0, 36.0, 140.0, 90.0, 30.0, -75.0, 55.0, 60.0, 80.0, 120.0, 70.0, 320.0, 28.0, 220.0, 50.0, 60.0, 98.0, 120.0, 62.0, 113.0, 140.0, 350.0, 150.0, 20.0, 90.0, 100.0, 99.0, 140.0, 69.0, 79.0, 80.0, 170.0, 90.0, 110.0, 310.0, 50.0, 40.0, 100.0, 90.0, 60.0, 270.0, 50.0, 23.0, 120.0, -20.0, 0.0, 26.0, 170.0, 60.0, 100.0, 25.0, 109.0, 60.0, 40.0, 118.0, 60.0, 80.0, 170.0, 100.0, 60.0, 170.0, -20.0, 230.0, 78.0, 50.0, 190.0, 80.0, 50.0, 80.0, 195.0, 70.0, 50.0, 130.0, 150.0, 290.0, 80.0, 25.0, 70.0, 168.0, 58.0, 120.0, 50.0, 18.0, 69.0, 70.0, 90.0, 5.0, 118.0, 130.0, 50.0, 100.0, 60.0, 320.0, 40.0, 140.0, 100.0, 80.0, 100.0, 110.0, 290.0, -14.0, 250.0, 90.0, 80.0, 120.0, 30.0, -120.0, 128.0, 50.0, 170.0, 30.0, 23.0, 240.0, 77.0, 67.0, 19.0, 60.0, 100.0, 90.0, 156.0, 236.0, 180.0, -35.0, 90.0, 220.0, 157.0, 90.0, 109.0, 103.0, 70.0, -10.0, 80.0, 70.0, 103.0, 405.0, 370.0, -20.0, -14.0, 53.0, 60.0, 55.0, 61.0, 80.0, 50.0, 120.0, 80.0, 540.0, 59.0, 163.0, 129.0, 95.0, 538.0, 110.0, -46.0, 160.0, 190.0, 140.0, -18.0, -11.0, 90.0, 140.0, 370.0, 130.0, 80.0, 120.0, 110.0, 78.0, 59.0, 100.0, 710.0, 40.0, 25.0, 81.0, 40.0, 90.0, 70.0, 120.0, -101.0, 100.0, 180.0, 0.0, 80.0, 228.0, 120.0, 75.0, 130.0, 160.0, 100.0, 32.0, 30.0, 99.0, 60.0, 60.0, 80.0, 110.0, 40.0, 19.0, 67.0, 130.0, 170.0, 110.0, 105.0, 586.0, -10.0, 40.0, 80.0, 60.0, 100.0, 58.0, 120.0, 70.0, 57.0, 119.0, 150.0, 60.0, 120.0, 50.0, 120.0, 130.0, 100.0, 119.0, 90.0, 70.0, 120.0, 58.0, 80.0, 59.0, 58.0, 70.0, 60.0, 190.0, 34.0, 90.0, 60.0, 110.0, 120.0, 0.0, 68.0, 88.0, 170.0, 320.0, 349.0, 99.0, 140.0, 120.0, 80.0, 130.0, 100.0, 210.0, 40.0, 170.0, 40.0, 45.0, 30.0, 30.0, 40.0, 720.0, 140.0, 70.0, 30.0, 30.0, 85.0, 140.0, 78.0, 90.0, 109.0, 210.0, 130.0, 190.0, 119.0, 30.0, 470.0, 80.0, 120.0, 39.0, 70.0, 270.0, 90.0, 170.0, 130.0, 50.0, 0.0, 60.0, 200.0, 80.0, 110.0, 30.0, 110.0, 87.0, 67.0, 130.0, 70.0, 80.0, 140.0, 170.0, 80.0, 120.0, 90.0, 100.0, -50.0, 90.0, 130.0, -30.0, 49.0, 110.0, 114.0, 500.0, 80.0, 198.0, 320.0, 100.0, 70.0, 44.0, 320.0, -34.0, 159.0, 57.0, 51.0, 60.0, 150.0, 38.0, 36.0, 220.0, 40.0, 140.0, 300.0, 90.0, 55.0, 61.0, 120.0, 100.0, 97.0, 350.0, -140.0, 330.0, 89.0, 210.0, 50.0, 74.0, 100.0, 170.0, -15.0, 70.0, 66.0, 150.0, 168.0, 60.0, 121.0, 60.0, 110.0, 90.0, 45.0, 30.0, 0.0, 50.0, 159.0, 20.0, 190.0, 50.0, 40.0, 34.0, 90.0, 110.0, 80.0, 59.0, 310.0, 90.0, 70.0, 570.0, 100.0, 100.0, 155.0, 60.0, 550.0, 79.0, 48.0, 160.0, 109.0, 60.0, 0.0, 35.0, 50.0, 50.0, 80.0, 190.0, 106.0, 209.0, 70.0, 130.0, 67.0, 46.0, 116.0, 80.0, 50.0, 50.0, 80.0, 140.0, 160.0, 37.0, 70.0, 1050.0, 60.0, 80.0, 150.0, 368.0, 140.0, 150.0, -10.0, 89.0, 100.0, 150.0, 69.0, 100.0, 80.0, 35.0, -25.0, 100.0, 46.0, 250.0, 80.0, 60.0, 80.0, 300.0, 90.0, 330.0, 70.0, 190.0, 50.0, 109.0, 96.0, 250.0, -20.0, 65.0, 58.0, 70.0, 78.0, 80.0, 530.0, 49.0, 90.0, 460.0, 78.0, 110.0, 65.0, 60.0, 130.0, -31.0, 300.0, 80.0, 170.0, 110.0, -15.0, 90.0, 290.0, 50.0, 470.0, 110.0, 0.0, 100.0, 60.0, 106.0, 20.0, 200.0, 89.0, 40.0, 96.0, 170.0, 50.0, 77.0, 70.0, 60.0, 690.0, 90.0, 90.0, 70.0, 100.0, 150.0, 100.0, 110.0, 130.0, 10.0, 90.0, -7.0, 90.0, 137.0, 160.0, 155.0, 89.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.916223906322641, "mean_inference_ms": 2.148148876162774, "mean_action_processing_ms": 0.7322739121079139, "mean_env_wait_ms": 1.4987494634321563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09932899475097656, "StateBufferConnector_ms": 0.010584354400634766, "ViewRequirementAgentConnector_ms": 0.5642354488372803}, "num_episodes": 23, "episode_return_max": 2095.0, "episode_return_min": 597.0, "episode_return_mean": 1167.68, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.40273729593474, "num_env_steps_trained_throughput_per_sec": 32.40273729593474, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 5760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5760000, "timers": {"training_iteration_time_ms": 122607.45, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122607.392, "sample_time_ms": 3277.341, "learn_time_ms": 119307.89, "learn_throughput": 33.527, "synch_weights_time_ms": 12.268}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "done": false, "training_iteration": 144, "trial_id": "6085c_00000", "date": "2024-07-02_03-52-45", "timestamp": 1719906765, "time_this_iter_s": 123.4598548412323, "time_total_s": 19610.621235370636, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b9128940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19610.621235370636, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 20.922857142857147, "ram_util_percent": 78.74228571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.839301095025354, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008652118148522191, "vf_loss": 8.10620166643486, "vf_explained_var": -0.00020759961348626053, "kl": Infinity, "entropy": 0.4493871020432859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1356855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "env_runners": {"episode_reward_max": 2095.0, "episode_reward_min": 158.0, "episode_reward_mean": 1144.28, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 1149.0}, "policy_reward_mean": {"policy_0": 114.428}, "custom_metrics": {}, "hist_stats": {"episode_reward": [949.0, 678.0, 1584.0, 1271.0, 900.0, 2066.0, 888.0, 1278.0, 1523.0, 1316.0, 1693.0, 1217.0, 1025.0, 1070.0, 1097.0, 2065.0, 980.0, 1167.0, 851.0, 919.0, 1374.0, 1377.0, 959.0, 1370.0, 768.0, 1069.0, 1428.0, 1296.0, 1353.0, 836.0, 1166.0, 1264.0, 1098.0, 789.0, 822.0, 988.0, 1140.0, 766.0, 1120.0, 964.0, 836.0, 1293.0, 1157.0, 1158.0, 1461.0, 1166.0, 1175.0, 1173.0, 597.0, 1371.0, 924.0, 884.0, 802.0, 1596.0, 1465.0, 972.0, 1478.0, 940.0, 1034.0, 1093.0, 1285.0, 1129.0, 1267.0, 964.0, 754.0, 933.0, 1931.0, 850.0, 919.0, 2095.0, 744.0, 1500.0, 1316.0, 1311.0, 1355.0, 931.0, 1497.0, 964.0, 1698.0, 1018.0, 764.0, 1257.0, 1080.0, 1281.0, 770.0, 1211.0, 810.0, 1630.0, 1480.0, 980.0, 902.0, 1053.0, 1416.0, 158.0, 908.0, 1245.0, 787.0, 1160.0, 1121.0, 895.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-5.0, 100.0, 90.0, 120.0, 69.0, 150.0, 57.0, 128.0, 100.0, 140.0, 60.0, 59.0, 90.0, 20.0, 80.0, 50.0, 60.0, 59.0, 100.0, 100.0, 126.0, 190.0, 120.0, 559.0, 70.0, 50.0, 70.0, 100.0, 310.0, -11.0, 70.0, 90.0, 120.0, 50.0, 46.0, 110.0, 30.0, 450.0, 250.0, 55.0, 90.0, 70.0, 70.0, 130.0, 70.0, 310.0, 60.0, 80.0, 50.0, -30.0, 1149.0, 110.0, -20.0, 0.0, 129.0, 90.0, 110.0, 80.0, 69.0, 349.0, 80.0, 0.0, 100.0, 140.0, 32.0, 50.0, -44.0, 530.0, -30.0, 30.0, 65.0, 90.0, 60.0, 72.0, 520.0, 58.0, 73.0, 130.0, 90.0, 120.0, 88.0, 440.0, 90.0, 129.0, 90.0, 70.0, 339.0, 110.0, 80.0, 87.0, 378.0, -41.0, 220.0, 110.0, 94.0, 160.0, 120.0, 150.0, 70.0, 55.0, 110.0, 75.0, 360.0, 400.0, 79.0, 110.0, 60.0, 69.0, 50.0, 380.0, 130.0, 250.0, 162.0, 26.0, 50.0, 70.0, 47.0, 212.0, 70.0, 200.0, 50.0, 0.0, 20.0, 50.0, 510.0, 148.0, 80.0, 60.0, 27.0, 80.0, 190.0, 70.0, 120.0, 80.0, 120.0, 100.0, 70.0, 180.0, 30.0, 110.0, 120.0, 55.0, 70.0, 88.0, 320.0, 38.0, 70.0, 85.0, 211.0, 40.0, 70.0, 150.0, 80.0, 147.0, 90.0, 180.0, 140.0, 350.0, 678.0, 180.0, 70.0, 90.0, 90.0, 106.0, 97.0, 97.0, 50.0, 70.0, 190.0, 120.0, 180.0, 186.0, 70.0, 190.0, 90.0, 107.0, 19.0, 38.0, 230.0, 57.0, 40.0, 210.0, 39.0, 69.0, 128.0, 30.0, 28.0, 77.0, 130.0, 100.0, 130.0, 110.0, 40.0, 110.0, 80.0, 49.0, 150.0, 60.0, 120.0, 70.0, 100.0, 70.0, 70.0, 69.0, 77.0, 370.0, 300.0, -30.0, 148.0, 200.0, 120.0, 500.0, 197.0, 110.0, 70.0, 40.0, 30.0, 10.0, 60.0, 240.0, 100.0, 132.0, -10.0, 256.0, -60.0, 180.0, -48.0, 60.0, 59.0, 290.0, 70.0, 210.0, 60.0, 150.0, 60.0, 200.0, -10.0, 20.0, 580.0, 30.0, 23.0, 165.0, 70.0, 100.0, 70.0, 80.0, -150.0, 173.0, 130.0, 107.0, 85.0, 80.0, 50.0, 190.0, 70.0, 250.0, 54.0, 90.0, 90.0, 110.0, 100.0, 520.0, 138.0, 79.0, 80.0, 130.0, 90.0, 94.0, 100.0, 97.0, 78.0, 60.0, 68.0, 50.0, 210.0, 250.0, 190.0, 120.0, 100.0, 170.0, 50.0, 67.0, 44.0, -43.0, 79.0, 110.0, 120.0, 896.0, -50.0, 80.0, 310.0, 90.0, 100.0, 36.0, 140.0, 90.0, 30.0, -75.0, 55.0, 60.0, 80.0, 120.0, 70.0, 320.0, 28.0, 220.0, 50.0, 60.0, 98.0, 120.0, 62.0, 113.0, 140.0, 350.0, 150.0, 20.0, 90.0, 100.0, 99.0, 140.0, 69.0, 79.0, 80.0, 170.0, 90.0, 110.0, 310.0, 50.0, 40.0, 100.0, 90.0, 60.0, 270.0, 50.0, 23.0, 120.0, -20.0, 0.0, 26.0, 170.0, 60.0, 100.0, 25.0, 109.0, 60.0, 40.0, 118.0, 60.0, 80.0, 170.0, 100.0, 60.0, 170.0, -20.0, 230.0, 78.0, 50.0, 190.0, 80.0, 50.0, 80.0, 195.0, 70.0, 50.0, 130.0, 150.0, 290.0, 80.0, 25.0, 70.0, 168.0, 58.0, 120.0, 50.0, 18.0, 69.0, 70.0, 90.0, 5.0, 118.0, 130.0, 50.0, 100.0, 60.0, 320.0, 40.0, 140.0, 100.0, 80.0, 100.0, 110.0, 290.0, -14.0, 250.0, 90.0, 80.0, 120.0, 30.0, -120.0, 128.0, 50.0, 170.0, 30.0, 23.0, 240.0, 77.0, 67.0, 19.0, 60.0, 100.0, 90.0, 156.0, 236.0, 180.0, -35.0, 90.0, 220.0, 157.0, 90.0, 109.0, 103.0, 70.0, -10.0, 80.0, 70.0, 103.0, 405.0, 370.0, -20.0, -14.0, 53.0, 60.0, 55.0, 61.0, 80.0, 50.0, 120.0, 80.0, 540.0, 59.0, 163.0, 129.0, 95.0, 538.0, 110.0, -46.0, 160.0, 190.0, 140.0, -18.0, -11.0, 90.0, 140.0, 370.0, 130.0, 80.0, 120.0, 110.0, 78.0, 59.0, 100.0, 710.0, 40.0, 25.0, 81.0, 40.0, 90.0, 70.0, 120.0, -101.0, 100.0, 180.0, 0.0, 80.0, 228.0, 120.0, 75.0, 130.0, 160.0, 100.0, 32.0, 30.0, 99.0, 60.0, 60.0, 80.0, 110.0, 40.0, 19.0, 67.0, 130.0, 170.0, 110.0, 105.0, 586.0, -10.0, 40.0, 80.0, 60.0, 100.0, 58.0, 120.0, 70.0, 57.0, 119.0, 150.0, 60.0, 120.0, 50.0, 120.0, 130.0, 100.0, 119.0, 90.0, 70.0, 120.0, 58.0, 80.0, 59.0, 58.0, 70.0, 60.0, 190.0, 34.0, 90.0, 60.0, 110.0, 120.0, 0.0, 68.0, 88.0, 170.0, 320.0, 349.0, 99.0, 140.0, 120.0, 80.0, 130.0, 100.0, 210.0, 40.0, 170.0, 40.0, 45.0, 30.0, 30.0, 40.0, 720.0, 140.0, 70.0, 30.0, 30.0, 85.0, 140.0, 78.0, 90.0, 109.0, 210.0, 130.0, 190.0, 119.0, 30.0, 470.0, 80.0, 120.0, 39.0, 70.0, 270.0, 90.0, 170.0, 130.0, 50.0, 0.0, 60.0, 200.0, 80.0, 110.0, 30.0, 110.0, 87.0, 67.0, 130.0, 70.0, 80.0, 140.0, 170.0, 80.0, 120.0, 90.0, 100.0, -50.0, 90.0, 130.0, -30.0, 49.0, 110.0, 114.0, 500.0, 80.0, 198.0, 320.0, 100.0, 70.0, 44.0, 320.0, -34.0, 159.0, 57.0, 51.0, 60.0, 150.0, 38.0, 36.0, 220.0, 40.0, 140.0, 300.0, 90.0, 55.0, 61.0, 120.0, 100.0, 97.0, 350.0, -140.0, 330.0, 89.0, 210.0, 50.0, 74.0, 100.0, 170.0, -15.0, 70.0, 66.0, 150.0, 168.0, 60.0, 121.0, 60.0, 110.0, 90.0, 45.0, 30.0, 0.0, 50.0, 159.0, 20.0, 190.0, 50.0, 40.0, 34.0, 90.0, 110.0, 80.0, 59.0, 310.0, 90.0, 70.0, 570.0, 100.0, 100.0, 155.0, 60.0, 550.0, 79.0, 48.0, 160.0, 109.0, 60.0, 0.0, 35.0, 50.0, 50.0, 80.0, 190.0, 106.0, 209.0, 70.0, 130.0, 67.0, 46.0, 116.0, 80.0, 50.0, 50.0, 80.0, 140.0, 160.0, 37.0, 70.0, 1050.0, 60.0, 80.0, 150.0, 368.0, 140.0, 150.0, -10.0, 89.0, 100.0, 150.0, 69.0, 100.0, 80.0, 35.0, -25.0, 100.0, 46.0, 250.0, 80.0, 60.0, 80.0, 300.0, 90.0, 330.0, 70.0, 190.0, 50.0, 109.0, 96.0, 250.0, -20.0, 65.0, 58.0, 70.0, 78.0, 80.0, 530.0, 49.0, 90.0, 460.0, 78.0, 110.0, 65.0, 60.0, 130.0, -31.0, 300.0, 80.0, 170.0, 110.0, -15.0, 90.0, 290.0, 50.0, 470.0, 110.0, 0.0, 100.0, 60.0, 106.0, 20.0, 200.0, 89.0, 40.0, 96.0, 170.0, 50.0, 77.0, 70.0, 60.0, 690.0, 90.0, 90.0, 70.0, 100.0, 150.0, 100.0, 110.0, 130.0, 10.0, 90.0, -7.0, 90.0, 137.0, 160.0, 155.0, 89.0, 750.0, 98.0, 130.0, 105.0, 100.0, 125.0, 70.0, 70.0, 170.0, 80.0, 130.0, 40.0, 120.0, 80.0, 110.0, 110.0, 70.0, 99.0, 89.0, 170.0, 90.0, 23.0, 70.0, 100.0, 70.0, 110.0, 70.0, 80.0, 41.0, 110.0, 200.0, 130.0, 61.0, 374.0, 330.0, 120.0, 80.0, -49.0, 48.0, -37.0, 120.0, -210.0, 400.0, 120.0, 30.0, 80.0, 110.0, 310.0, 30.0, 90.0, 138.0, 90.0, 386.0, 90.0, 60.0, 110.0, 200.0, 29.0, 118.0, 60.0, -10.0, 60.0, 40.0, 290.0, 90.0, 80.0, 40.0, 50.0, 70.0, 60.0, 90.0, 75.0, 70.0, 270.0, 120.0, 256.0, 60.0, 100.0, 70.0, 100.0, 0.0, 30.0, 120.0, 50.0, 540.0, -150.0, -200.0, 100.0, 220.0, 100.0, 310.0, 50.0, 60.0, 350.0, 90.0, 120.0, 110.0, 410.0, 90.0, 40.0, 110.0, 105.0, -80.0, 180.0, 670.0, 135.0, 90.0, 60.0, 180.0, 30.0, -132.0, 88.0, 110.0, 40.0, 315.0, 210.0, 80.0, 59.0, 160.0, 50.0, 50.0, 70.0, 48.0, 70.0, 170.0, 166.0, 69.0, 89.0, 70.0, 100.0, 160.0, 50.0, 65.0, 70.0, -7.0, 180.0, 90.0, 90.0, 185.0, 170.0, 520.0, 50.0, 98.0, 117.0, 80.0, 190.0, 170.0, 35.0, 60.0, 96.0, 63.0, -180.0, 0.0, 57.0, 179.0, 84.0, 50.0, 25.0, 120.0, -240.0, 45.0, 110.0, 180.0, 103.0, 70.0, 120.0, 80.0, 50.0, 100.0, 50.0, 43.0, 60.0, 40.0, 120.0, 470.0, 90.0, 30.0, 170.0, 52.0, 170.0, 50.0, 190.0, 40.0, 70.0, 40.0, 80.0, 2.0, 45.0, 200.0, 70.0, 310.0, 110.0, 60.0, 70.0, 300.0, -30.0, 32.0, 50.0, 160.0, 98.0, 60.0, 100.0, 90.0, 90.0, 208.0, 60.0, 330.0, 92.0, -18.0, 109.0, 100.0, 50.0, 90.0, 206.0, 159.0, 40.0, 70.0, 120.0, -30.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.917741770268034, "mean_inference_ms": 2.1500629746232653, "mean_action_processing_ms": 0.7328535466403869, "mean_env_wait_ms": 1.4992266362211535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10219335556030273, "StateBufferConnector_ms": 0.010773897171020508, "ViewRequirementAgentConnector_ms": 0.5457310676574707}, "num_episodes": 22, "episode_return_max": 2095.0, "episode_return_min": 158.0, "episode_return_mean": 1144.28, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.361745313253266, "num_env_steps_trained_throughput_per_sec": 32.361745313253266, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 5800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5800000, "timers": {"training_iteration_time_ms": 122663.779, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122663.721, "sample_time_ms": 3342.014, "learn_time_ms": 119299.025, "learn_throughput": 33.529, "synch_weights_time_ms": 12.76}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "done": false, "training_iteration": 145, "trial_id": "6085c_00000", "date": "2024-07-02_03-54-49", "timestamp": 1719906889, "time_this_iter_s": 123.65011811256409, "time_total_s": 19734.2713534832, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138bc13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19734.2713534832, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 21.690229885057473, "ram_util_percent": 79.75632183908046}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.91786226286167, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.01142875008182, "policy_loss": -0.00836757176922172, "vf_loss": 8.017749749052639, "vf_explained_var": 0.0004607371247995395, "kl": 0.006063929854319871, "entropy": 0.43895343013655264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1366245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "env_runners": {"episode_reward_max": 2095.0, "episode_reward_min": 158.0, "episode_reward_mean": 1108.51, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 110.851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [851.0, 919.0, 1374.0, 1377.0, 959.0, 1370.0, 768.0, 1069.0, 1428.0, 1296.0, 1353.0, 836.0, 1166.0, 1264.0, 1098.0, 789.0, 822.0, 988.0, 1140.0, 766.0, 1120.0, 964.0, 836.0, 1293.0, 1157.0, 1158.0, 1461.0, 1166.0, 1175.0, 1173.0, 597.0, 1371.0, 924.0, 884.0, 802.0, 1596.0, 1465.0, 972.0, 1478.0, 940.0, 1034.0, 1093.0, 1285.0, 1129.0, 1267.0, 964.0, 754.0, 933.0, 1931.0, 850.0, 919.0, 2095.0, 744.0, 1500.0, 1316.0, 1311.0, 1355.0, 931.0, 1497.0, 964.0, 1698.0, 1018.0, 764.0, 1257.0, 1080.0, 1281.0, 770.0, 1211.0, 810.0, 1630.0, 1480.0, 980.0, 902.0, 1053.0, 1416.0, 158.0, 908.0, 1245.0, 787.0, 1160.0, 1121.0, 895.0, 1256.0, 1047.0, 830.0, 850.0, 1027.0, 1218.0, 1111.0, 946.0, 990.0, 1389.0, 1089.0, 769.0, 1589.0, 1008.0, 859.0, 1455.0, 935.0, 822.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 210.0, 39.0, 69.0, 128.0, 30.0, 28.0, 77.0, 130.0, 100.0, 130.0, 110.0, 40.0, 110.0, 80.0, 49.0, 150.0, 60.0, 120.0, 70.0, 100.0, 70.0, 70.0, 69.0, 77.0, 370.0, 300.0, -30.0, 148.0, 200.0, 120.0, 500.0, 197.0, 110.0, 70.0, 40.0, 30.0, 10.0, 60.0, 240.0, 100.0, 132.0, -10.0, 256.0, -60.0, 180.0, -48.0, 60.0, 59.0, 290.0, 70.0, 210.0, 60.0, 150.0, 60.0, 200.0, -10.0, 20.0, 580.0, 30.0, 23.0, 165.0, 70.0, 100.0, 70.0, 80.0, -150.0, 173.0, 130.0, 107.0, 85.0, 80.0, 50.0, 190.0, 70.0, 250.0, 54.0, 90.0, 90.0, 110.0, 100.0, 520.0, 138.0, 79.0, 80.0, 130.0, 90.0, 94.0, 100.0, 97.0, 78.0, 60.0, 68.0, 50.0, 210.0, 250.0, 190.0, 120.0, 100.0, 170.0, 50.0, 67.0, 44.0, -43.0, 79.0, 110.0, 120.0, 896.0, -50.0, 80.0, 310.0, 90.0, 100.0, 36.0, 140.0, 90.0, 30.0, -75.0, 55.0, 60.0, 80.0, 120.0, 70.0, 320.0, 28.0, 220.0, 50.0, 60.0, 98.0, 120.0, 62.0, 113.0, 140.0, 350.0, 150.0, 20.0, 90.0, 100.0, 99.0, 140.0, 69.0, 79.0, 80.0, 170.0, 90.0, 110.0, 310.0, 50.0, 40.0, 100.0, 90.0, 60.0, 270.0, 50.0, 23.0, 120.0, -20.0, 0.0, 26.0, 170.0, 60.0, 100.0, 25.0, 109.0, 60.0, 40.0, 118.0, 60.0, 80.0, 170.0, 100.0, 60.0, 170.0, -20.0, 230.0, 78.0, 50.0, 190.0, 80.0, 50.0, 80.0, 195.0, 70.0, 50.0, 130.0, 150.0, 290.0, 80.0, 25.0, 70.0, 168.0, 58.0, 120.0, 50.0, 18.0, 69.0, 70.0, 90.0, 5.0, 118.0, 130.0, 50.0, 100.0, 60.0, 320.0, 40.0, 140.0, 100.0, 80.0, 100.0, 110.0, 290.0, -14.0, 250.0, 90.0, 80.0, 120.0, 30.0, -120.0, 128.0, 50.0, 170.0, 30.0, 23.0, 240.0, 77.0, 67.0, 19.0, 60.0, 100.0, 90.0, 156.0, 236.0, 180.0, -35.0, 90.0, 220.0, 157.0, 90.0, 109.0, 103.0, 70.0, -10.0, 80.0, 70.0, 103.0, 405.0, 370.0, -20.0, -14.0, 53.0, 60.0, 55.0, 61.0, 80.0, 50.0, 120.0, 80.0, 540.0, 59.0, 163.0, 129.0, 95.0, 538.0, 110.0, -46.0, 160.0, 190.0, 140.0, -18.0, -11.0, 90.0, 140.0, 370.0, 130.0, 80.0, 120.0, 110.0, 78.0, 59.0, 100.0, 710.0, 40.0, 25.0, 81.0, 40.0, 90.0, 70.0, 120.0, -101.0, 100.0, 180.0, 0.0, 80.0, 228.0, 120.0, 75.0, 130.0, 160.0, 100.0, 32.0, 30.0, 99.0, 60.0, 60.0, 80.0, 110.0, 40.0, 19.0, 67.0, 130.0, 170.0, 110.0, 105.0, 586.0, -10.0, 40.0, 80.0, 60.0, 100.0, 58.0, 120.0, 70.0, 57.0, 119.0, 150.0, 60.0, 120.0, 50.0, 120.0, 130.0, 100.0, 119.0, 90.0, 70.0, 120.0, 58.0, 80.0, 59.0, 58.0, 70.0, 60.0, 190.0, 34.0, 90.0, 60.0, 110.0, 120.0, 0.0, 68.0, 88.0, 170.0, 320.0, 349.0, 99.0, 140.0, 120.0, 80.0, 130.0, 100.0, 210.0, 40.0, 170.0, 40.0, 45.0, 30.0, 30.0, 40.0, 720.0, 140.0, 70.0, 30.0, 30.0, 85.0, 140.0, 78.0, 90.0, 109.0, 210.0, 130.0, 190.0, 119.0, 30.0, 470.0, 80.0, 120.0, 39.0, 70.0, 270.0, 90.0, 170.0, 130.0, 50.0, 0.0, 60.0, 200.0, 80.0, 110.0, 30.0, 110.0, 87.0, 67.0, 130.0, 70.0, 80.0, 140.0, 170.0, 80.0, 120.0, 90.0, 100.0, -50.0, 90.0, 130.0, -30.0, 49.0, 110.0, 114.0, 500.0, 80.0, 198.0, 320.0, 100.0, 70.0, 44.0, 320.0, -34.0, 159.0, 57.0, 51.0, 60.0, 150.0, 38.0, 36.0, 220.0, 40.0, 140.0, 300.0, 90.0, 55.0, 61.0, 120.0, 100.0, 97.0, 350.0, -140.0, 330.0, 89.0, 210.0, 50.0, 74.0, 100.0, 170.0, -15.0, 70.0, 66.0, 150.0, 168.0, 60.0, 121.0, 60.0, 110.0, 90.0, 45.0, 30.0, 0.0, 50.0, 159.0, 20.0, 190.0, 50.0, 40.0, 34.0, 90.0, 110.0, 80.0, 59.0, 310.0, 90.0, 70.0, 570.0, 100.0, 100.0, 155.0, 60.0, 550.0, 79.0, 48.0, 160.0, 109.0, 60.0, 0.0, 35.0, 50.0, 50.0, 80.0, 190.0, 106.0, 209.0, 70.0, 130.0, 67.0, 46.0, 116.0, 80.0, 50.0, 50.0, 80.0, 140.0, 160.0, 37.0, 70.0, 1050.0, 60.0, 80.0, 150.0, 368.0, 140.0, 150.0, -10.0, 89.0, 100.0, 150.0, 69.0, 100.0, 80.0, 35.0, -25.0, 100.0, 46.0, 250.0, 80.0, 60.0, 80.0, 300.0, 90.0, 330.0, 70.0, 190.0, 50.0, 109.0, 96.0, 250.0, -20.0, 65.0, 58.0, 70.0, 78.0, 80.0, 530.0, 49.0, 90.0, 460.0, 78.0, 110.0, 65.0, 60.0, 130.0, -31.0, 300.0, 80.0, 170.0, 110.0, -15.0, 90.0, 290.0, 50.0, 470.0, 110.0, 0.0, 100.0, 60.0, 106.0, 20.0, 200.0, 89.0, 40.0, 96.0, 170.0, 50.0, 77.0, 70.0, 60.0, 690.0, 90.0, 90.0, 70.0, 100.0, 150.0, 100.0, 110.0, 130.0, 10.0, 90.0, -7.0, 90.0, 137.0, 160.0, 155.0, 89.0, 750.0, 98.0, 130.0, 105.0, 100.0, 125.0, 70.0, 70.0, 170.0, 80.0, 130.0, 40.0, 120.0, 80.0, 110.0, 110.0, 70.0, 99.0, 89.0, 170.0, 90.0, 23.0, 70.0, 100.0, 70.0, 110.0, 70.0, 80.0, 41.0, 110.0, 200.0, 130.0, 61.0, 374.0, 330.0, 120.0, 80.0, -49.0, 48.0, -37.0, 120.0, -210.0, 400.0, 120.0, 30.0, 80.0, 110.0, 310.0, 30.0, 90.0, 138.0, 90.0, 386.0, 90.0, 60.0, 110.0, 200.0, 29.0, 118.0, 60.0, -10.0, 60.0, 40.0, 290.0, 90.0, 80.0, 40.0, 50.0, 70.0, 60.0, 90.0, 75.0, 70.0, 270.0, 120.0, 256.0, 60.0, 100.0, 70.0, 100.0, 0.0, 30.0, 120.0, 50.0, 540.0, -150.0, -200.0, 100.0, 220.0, 100.0, 310.0, 50.0, 60.0, 350.0, 90.0, 120.0, 110.0, 410.0, 90.0, 40.0, 110.0, 105.0, -80.0, 180.0, 670.0, 135.0, 90.0, 60.0, 180.0, 30.0, -132.0, 88.0, 110.0, 40.0, 315.0, 210.0, 80.0, 59.0, 160.0, 50.0, 50.0, 70.0, 48.0, 70.0, 170.0, 166.0, 69.0, 89.0, 70.0, 100.0, 160.0, 50.0, 65.0, 70.0, -7.0, 180.0, 90.0, 90.0, 185.0, 170.0, 520.0, 50.0, 98.0, 117.0, 80.0, 190.0, 170.0, 35.0, 60.0, 96.0, 63.0, -180.0, 0.0, 57.0, 179.0, 84.0, 50.0, 25.0, 120.0, -240.0, 45.0, 110.0, 180.0, 103.0, 70.0, 120.0, 80.0, 50.0, 100.0, 50.0, 43.0, 60.0, 40.0, 120.0, 470.0, 90.0, 30.0, 170.0, 52.0, 170.0, 50.0, 190.0, 40.0, 70.0, 40.0, 80.0, 2.0, 45.0, 200.0, 70.0, 310.0, 110.0, 60.0, 70.0, 300.0, -30.0, 32.0, 50.0, 160.0, 98.0, 60.0, 100.0, 90.0, 90.0, 208.0, 60.0, 330.0, 92.0, -18.0, 109.0, 100.0, 50.0, 90.0, 206.0, 159.0, 40.0, 70.0, 120.0, -30.0, 90.0, 349.0, 309.0, 8.0, 60.0, 100.0, 80.0, 70.0, 110.0, 90.0, 80.0, 50.0, 180.0, 50.0, 60.0, 60.0, 79.0, 319.0, 90.0, 119.0, 40.0, 10.0, 120.0, 60.0, 30.0, 300.0, 140.0, 60.0, 80.0, -30.0, 60.0, 45.0, 85.0, 70.0, 130.0, 100.0, 170.0, 30.0, 130.0, 30.0, 60.0, 76.0, 152.0, 41.0, 50.0, 45.0, 27.0, 150.0, 76.0, 340.0, 70.0, 70.0, 120.0, 120.0, 180.0, 299.0, 80.0, 100.0, 68.0, 108.0, 73.0, 70.0, 108.0, 448.0, 110.0, -20.0, 140.0, 120.0, 96.0, -40.0, 79.0, 150.0, 100.0, 48.0, 130.0, 320.0, -80.0, 10.0, 90.0, 48.0, 130.0, 190.0, 330.0, -40.0, 60.0, 30.0, 120.0, 50.0, 80.0, 50.0, 120.0, 160.0, 30.0, 130.0, 110.0, 56.0, 90.0, 130.0, 350.0, 290.0, 43.0, 80.0, 320.0, 68.0, -70.0, 60.0, 145.0, 130.0, 140.0, 140.0, 76.0, 310.0, 60.0, 50.0, 38.0, 80.0, 173.0, -42.0, 70.0, -10.0, 40.0, 120.0, 150.0, 140.0, 60.0, 740.0, 15.0, 55.0, 73.0, 66.0, 170.0, 190.0, 38.0, 60.0, 320.0, -80.0, 60.0, 7.0, 89.0, 75.0, 249.0, 0.0, 80.0, 99.0, 70.0, 195.0, 200.0, 80.0, 35.0, 70.0, 30.0, 130.0, 90.0, 90.0, 165.0, 190.0, 80.0, 90.0, 100.0, -80.0, 600.0, 190.0, 30.0, 70.0, 80.0, 80.0, 130.0, 130.0, 60.0, 85.0, 80.0, 43.0, 70.0, 120.0, 109.0, 80.0, 30.0, 90.0, 110.0, 90.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9160145514551608, "mean_inference_ms": 2.1470487765098825, "mean_action_processing_ms": 0.7348317583094388, "mean_env_wait_ms": 1.4976636588817511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0997161865234375, "StateBufferConnector_ms": 0.010573863983154297, "ViewRequirementAgentConnector_ms": 0.538712739944458}, "num_episodes": 18, "episode_return_max": 2095.0, "episode_return_min": 158.0, "episode_return_mean": 1108.51, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.41242844314888, "num_env_steps_trained_throughput_per_sec": 32.41242844314888, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 5840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5840000, "timers": {"training_iteration_time_ms": 122645.148, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122645.09, "sample_time_ms": 3407.872, "learn_time_ms": 119213.883, "learn_throughput": 33.553, "synch_weights_time_ms": 12.473}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "done": false, "training_iteration": 146, "trial_id": "6085c_00000", "date": "2024-07-02_03-56-52", "timestamp": 1719907012, "time_this_iter_s": 123.42485880851746, "time_total_s": 19857.696212291718, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x13814b8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19857.696212291718, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 23.830285714285715, "ram_util_percent": 79.232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8826848700277594, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.089833749876744, "policy_loss": -0.007732121460958006, "vf_loss": 8.09567836024129, "vf_explained_var": 0.0025461607593824814, "kl": 0.005592605903509123, "entropy": 0.46219390221614554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1375635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "env_runners": {"episode_reward_max": 2095.0, "episode_reward_min": 158.0, "episode_reward_mean": 1088.83, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 108.883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1140.0, 766.0, 1120.0, 964.0, 836.0, 1293.0, 1157.0, 1158.0, 1461.0, 1166.0, 1175.0, 1173.0, 597.0, 1371.0, 924.0, 884.0, 802.0, 1596.0, 1465.0, 972.0, 1478.0, 940.0, 1034.0, 1093.0, 1285.0, 1129.0, 1267.0, 964.0, 754.0, 933.0, 1931.0, 850.0, 919.0, 2095.0, 744.0, 1500.0, 1316.0, 1311.0, 1355.0, 931.0, 1497.0, 964.0, 1698.0, 1018.0, 764.0, 1257.0, 1080.0, 1281.0, 770.0, 1211.0, 810.0, 1630.0, 1480.0, 980.0, 902.0, 1053.0, 1416.0, 158.0, 908.0, 1245.0, 787.0, 1160.0, 1121.0, 895.0, 1256.0, 1047.0, 830.0, 850.0, 1027.0, 1218.0, 1111.0, 946.0, 990.0, 1389.0, 1089.0, 769.0, 1589.0, 1008.0, 859.0, 1455.0, 935.0, 822.0, 785.0, 1179.0, 1099.0, 787.0, 1031.0, 1798.0, 1210.0, 795.0, 874.0, 878.0, 634.0, 903.0, 851.0, 945.0, 818.0, 944.0, 1037.0, 1191.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 195.0, 70.0, 50.0, 130.0, 150.0, 290.0, 80.0, 25.0, 70.0, 168.0, 58.0, 120.0, 50.0, 18.0, 69.0, 70.0, 90.0, 5.0, 118.0, 130.0, 50.0, 100.0, 60.0, 320.0, 40.0, 140.0, 100.0, 80.0, 100.0, 110.0, 290.0, -14.0, 250.0, 90.0, 80.0, 120.0, 30.0, -120.0, 128.0, 50.0, 170.0, 30.0, 23.0, 240.0, 77.0, 67.0, 19.0, 60.0, 100.0, 90.0, 156.0, 236.0, 180.0, -35.0, 90.0, 220.0, 157.0, 90.0, 109.0, 103.0, 70.0, -10.0, 80.0, 70.0, 103.0, 405.0, 370.0, -20.0, -14.0, 53.0, 60.0, 55.0, 61.0, 80.0, 50.0, 120.0, 80.0, 540.0, 59.0, 163.0, 129.0, 95.0, 538.0, 110.0, -46.0, 160.0, 190.0, 140.0, -18.0, -11.0, 90.0, 140.0, 370.0, 130.0, 80.0, 120.0, 110.0, 78.0, 59.0, 100.0, 710.0, 40.0, 25.0, 81.0, 40.0, 90.0, 70.0, 120.0, -101.0, 100.0, 180.0, 0.0, 80.0, 228.0, 120.0, 75.0, 130.0, 160.0, 100.0, 32.0, 30.0, 99.0, 60.0, 60.0, 80.0, 110.0, 40.0, 19.0, 67.0, 130.0, 170.0, 110.0, 105.0, 586.0, -10.0, 40.0, 80.0, 60.0, 100.0, 58.0, 120.0, 70.0, 57.0, 119.0, 150.0, 60.0, 120.0, 50.0, 120.0, 130.0, 100.0, 119.0, 90.0, 70.0, 120.0, 58.0, 80.0, 59.0, 58.0, 70.0, 60.0, 190.0, 34.0, 90.0, 60.0, 110.0, 120.0, 0.0, 68.0, 88.0, 170.0, 320.0, 349.0, 99.0, 140.0, 120.0, 80.0, 130.0, 100.0, 210.0, 40.0, 170.0, 40.0, 45.0, 30.0, 30.0, 40.0, 720.0, 140.0, 70.0, 30.0, 30.0, 85.0, 140.0, 78.0, 90.0, 109.0, 210.0, 130.0, 190.0, 119.0, 30.0, 470.0, 80.0, 120.0, 39.0, 70.0, 270.0, 90.0, 170.0, 130.0, 50.0, 0.0, 60.0, 200.0, 80.0, 110.0, 30.0, 110.0, 87.0, 67.0, 130.0, 70.0, 80.0, 140.0, 170.0, 80.0, 120.0, 90.0, 100.0, -50.0, 90.0, 130.0, -30.0, 49.0, 110.0, 114.0, 500.0, 80.0, 198.0, 320.0, 100.0, 70.0, 44.0, 320.0, -34.0, 159.0, 57.0, 51.0, 60.0, 150.0, 38.0, 36.0, 220.0, 40.0, 140.0, 300.0, 90.0, 55.0, 61.0, 120.0, 100.0, 97.0, 350.0, -140.0, 330.0, 89.0, 210.0, 50.0, 74.0, 100.0, 170.0, -15.0, 70.0, 66.0, 150.0, 168.0, 60.0, 121.0, 60.0, 110.0, 90.0, 45.0, 30.0, 0.0, 50.0, 159.0, 20.0, 190.0, 50.0, 40.0, 34.0, 90.0, 110.0, 80.0, 59.0, 310.0, 90.0, 70.0, 570.0, 100.0, 100.0, 155.0, 60.0, 550.0, 79.0, 48.0, 160.0, 109.0, 60.0, 0.0, 35.0, 50.0, 50.0, 80.0, 190.0, 106.0, 209.0, 70.0, 130.0, 67.0, 46.0, 116.0, 80.0, 50.0, 50.0, 80.0, 140.0, 160.0, 37.0, 70.0, 1050.0, 60.0, 80.0, 150.0, 368.0, 140.0, 150.0, -10.0, 89.0, 100.0, 150.0, 69.0, 100.0, 80.0, 35.0, -25.0, 100.0, 46.0, 250.0, 80.0, 60.0, 80.0, 300.0, 90.0, 330.0, 70.0, 190.0, 50.0, 109.0, 96.0, 250.0, -20.0, 65.0, 58.0, 70.0, 78.0, 80.0, 530.0, 49.0, 90.0, 460.0, 78.0, 110.0, 65.0, 60.0, 130.0, -31.0, 300.0, 80.0, 170.0, 110.0, -15.0, 90.0, 290.0, 50.0, 470.0, 110.0, 0.0, 100.0, 60.0, 106.0, 20.0, 200.0, 89.0, 40.0, 96.0, 170.0, 50.0, 77.0, 70.0, 60.0, 690.0, 90.0, 90.0, 70.0, 100.0, 150.0, 100.0, 110.0, 130.0, 10.0, 90.0, -7.0, 90.0, 137.0, 160.0, 155.0, 89.0, 750.0, 98.0, 130.0, 105.0, 100.0, 125.0, 70.0, 70.0, 170.0, 80.0, 130.0, 40.0, 120.0, 80.0, 110.0, 110.0, 70.0, 99.0, 89.0, 170.0, 90.0, 23.0, 70.0, 100.0, 70.0, 110.0, 70.0, 80.0, 41.0, 110.0, 200.0, 130.0, 61.0, 374.0, 330.0, 120.0, 80.0, -49.0, 48.0, -37.0, 120.0, -210.0, 400.0, 120.0, 30.0, 80.0, 110.0, 310.0, 30.0, 90.0, 138.0, 90.0, 386.0, 90.0, 60.0, 110.0, 200.0, 29.0, 118.0, 60.0, -10.0, 60.0, 40.0, 290.0, 90.0, 80.0, 40.0, 50.0, 70.0, 60.0, 90.0, 75.0, 70.0, 270.0, 120.0, 256.0, 60.0, 100.0, 70.0, 100.0, 0.0, 30.0, 120.0, 50.0, 540.0, -150.0, -200.0, 100.0, 220.0, 100.0, 310.0, 50.0, 60.0, 350.0, 90.0, 120.0, 110.0, 410.0, 90.0, 40.0, 110.0, 105.0, -80.0, 180.0, 670.0, 135.0, 90.0, 60.0, 180.0, 30.0, -132.0, 88.0, 110.0, 40.0, 315.0, 210.0, 80.0, 59.0, 160.0, 50.0, 50.0, 70.0, 48.0, 70.0, 170.0, 166.0, 69.0, 89.0, 70.0, 100.0, 160.0, 50.0, 65.0, 70.0, -7.0, 180.0, 90.0, 90.0, 185.0, 170.0, 520.0, 50.0, 98.0, 117.0, 80.0, 190.0, 170.0, 35.0, 60.0, 96.0, 63.0, -180.0, 0.0, 57.0, 179.0, 84.0, 50.0, 25.0, 120.0, -240.0, 45.0, 110.0, 180.0, 103.0, 70.0, 120.0, 80.0, 50.0, 100.0, 50.0, 43.0, 60.0, 40.0, 120.0, 470.0, 90.0, 30.0, 170.0, 52.0, 170.0, 50.0, 190.0, 40.0, 70.0, 40.0, 80.0, 2.0, 45.0, 200.0, 70.0, 310.0, 110.0, 60.0, 70.0, 300.0, -30.0, 32.0, 50.0, 160.0, 98.0, 60.0, 100.0, 90.0, 90.0, 208.0, 60.0, 330.0, 92.0, -18.0, 109.0, 100.0, 50.0, 90.0, 206.0, 159.0, 40.0, 70.0, 120.0, -30.0, 90.0, 349.0, 309.0, 8.0, 60.0, 100.0, 80.0, 70.0, 110.0, 90.0, 80.0, 50.0, 180.0, 50.0, 60.0, 60.0, 79.0, 319.0, 90.0, 119.0, 40.0, 10.0, 120.0, 60.0, 30.0, 300.0, 140.0, 60.0, 80.0, -30.0, 60.0, 45.0, 85.0, 70.0, 130.0, 100.0, 170.0, 30.0, 130.0, 30.0, 60.0, 76.0, 152.0, 41.0, 50.0, 45.0, 27.0, 150.0, 76.0, 340.0, 70.0, 70.0, 120.0, 120.0, 180.0, 299.0, 80.0, 100.0, 68.0, 108.0, 73.0, 70.0, 108.0, 448.0, 110.0, -20.0, 140.0, 120.0, 96.0, -40.0, 79.0, 150.0, 100.0, 48.0, 130.0, 320.0, -80.0, 10.0, 90.0, 48.0, 130.0, 190.0, 330.0, -40.0, 60.0, 30.0, 120.0, 50.0, 80.0, 50.0, 120.0, 160.0, 30.0, 130.0, 110.0, 56.0, 90.0, 130.0, 350.0, 290.0, 43.0, 80.0, 320.0, 68.0, -70.0, 60.0, 145.0, 130.0, 140.0, 140.0, 76.0, 310.0, 60.0, 50.0, 38.0, 80.0, 173.0, -42.0, 70.0, -10.0, 40.0, 120.0, 150.0, 140.0, 60.0, 740.0, 15.0, 55.0, 73.0, 66.0, 170.0, 190.0, 38.0, 60.0, 320.0, -80.0, 60.0, 7.0, 89.0, 75.0, 249.0, 0.0, 80.0, 99.0, 70.0, 195.0, 200.0, 80.0, 35.0, 70.0, 30.0, 130.0, 90.0, 90.0, 165.0, 190.0, 80.0, 90.0, 100.0, -80.0, 600.0, 190.0, 30.0, 70.0, 80.0, 80.0, 130.0, 130.0, 60.0, 85.0, 80.0, 43.0, 70.0, 120.0, 109.0, 80.0, 30.0, 90.0, 110.0, 90.0, 80.0, 0.0, 100.0, 160.0, 80.0, 110.0, -52.0, 79.0, 30.0, 210.0, 68.0, 160.0, 51.0, 24.0, -26.0, 490.0, 90.0, 90.0, 50.0, 120.0, 130.0, 70.0, 109.0, 110.0, 90.0, 300.0, 80.0, 60.0, 80.0, 70.0, 130.0, -35.0, 27.0, 50.0, 127.0, 30.0, 80.0, 170.0, 110.0, 104.0, 124.0, 100.0, 110.0, 310.0, 104.0, 50.0, 80.0, 210.0, 60.0, 90.0, -83.0, 90.0, 620.0, 149.0, 130.0, 220.0, 90.0, 89.0, 220.0, 130.0, 60.0, 78.0, 320.0, -10.0, 210.0, 120.0, 190.0, 55.0, 150.0, 40.0, 57.0, 120.0, 99.0, 68.0, 90.0, -32.0, 50.0, 110.0, 100.0, 120.0, 70.0, 120.0, 5.0, 100.0, 120.0, 150.0, 70.0, 80.0, -21.0, 130.0, 120.0, 80.0, 60.0, 50.0, 369.0, 80.0, 20.0, -21.0, 80.0, 70.0, 90.0, 19.0, 80.0, 70.0, 80.0, 70.0, 110.0, 60.0, 5.0, 80.0, 60.0, 57.0, 120.0, 99.0, 0.0, 147.0, 108.0, 128.0, 70.0, 129.0, 45.0, 70.0, 30.0, 130.0, 80.0, 66.0, 55.0, 110.0, 120.0, 70.0, 120.0, 40.0, 190.0, 90.0, 100.0, 73.0, 87.0, 25.0, 70.0, 200.0, 70.0, 90.0, 64.0, 76.0, 90.0, 99.0, 160.0, 0.0, 100.0, 89.0, 50.0, 60.0, 93.0, 50.0, 110.0, 60.0, 90.0, 51.0, 300.0, 90.0, 40.0, 170.0, 70.0, 390.0, 70.0, 10.0, 59.0, 10.0, 80.0, 59.0, 119.0, 157.0, 50.0, 50.0, 79.0, 39.0, 86.0, 330.0, 28.0, 290.0, 82.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9156732007530162, "mean_inference_ms": 2.1463350837406523, "mean_action_processing_ms": 0.7360336369914938, "mean_env_wait_ms": 1.497061094390168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09701180458068848, "StateBufferConnector_ms": 0.01042032241821289, "ViewRequirementAgentConnector_ms": 0.5126368999481201}, "num_episodes": 18, "episode_return_max": 2095.0, "episode_return_min": 158.0, "episode_return_mean": 1088.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.417538925288156, "num_env_steps_trained_throughput_per_sec": 32.417538925288156, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 5880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5880000, "timers": {"training_iteration_time_ms": 122686.253, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122686.194, "sample_time_ms": 3322.595, "learn_time_ms": 119340.333, "learn_throughput": 33.518, "synch_weights_time_ms": 12.347}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "done": false, "training_iteration": 147, "trial_id": "6085c_00000", "date": "2024-07-02_03-58-56", "timestamp": 1719907136, "time_this_iter_s": 123.40641689300537, "time_total_s": 19981.102629184723, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b3bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19981.102629184723, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 20.813218390804597, "ram_util_percent": 79.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6000802348343073, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006691675568078828, "vf_loss": 8.010031295508242, "vf_explained_var": 0.0003797465810379662, "kl": Infinity, "entropy": 0.46751787778033743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1385025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "env_runners": {"episode_reward_max": 2095.0, "episode_reward_min": 158.0, "episode_reward_mean": 1111.86, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 111.186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1465.0, 972.0, 1478.0, 940.0, 1034.0, 1093.0, 1285.0, 1129.0, 1267.0, 964.0, 754.0, 933.0, 1931.0, 850.0, 919.0, 2095.0, 744.0, 1500.0, 1316.0, 1311.0, 1355.0, 931.0, 1497.0, 964.0, 1698.0, 1018.0, 764.0, 1257.0, 1080.0, 1281.0, 770.0, 1211.0, 810.0, 1630.0, 1480.0, 980.0, 902.0, 1053.0, 1416.0, 158.0, 908.0, 1245.0, 787.0, 1160.0, 1121.0, 895.0, 1256.0, 1047.0, 830.0, 850.0, 1027.0, 1218.0, 1111.0, 946.0, 990.0, 1389.0, 1089.0, 769.0, 1589.0, 1008.0, 859.0, 1455.0, 935.0, 822.0, 785.0, 1179.0, 1099.0, 787.0, 1031.0, 1798.0, 1210.0, 795.0, 874.0, 878.0, 634.0, 903.0, 851.0, 945.0, 818.0, 944.0, 1037.0, 1191.0, 1130.0, 991.0, 1591.0, 1035.0, 1057.0, 786.0, 1263.0, 1360.0, 1305.0, 1124.0, 1095.0, 1860.0, 1103.0, 770.0, 1682.0, 1534.0, 1298.0, 902.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, 40.0, 170.0, 40.0, 45.0, 30.0, 30.0, 40.0, 720.0, 140.0, 70.0, 30.0, 30.0, 85.0, 140.0, 78.0, 90.0, 109.0, 210.0, 130.0, 190.0, 119.0, 30.0, 470.0, 80.0, 120.0, 39.0, 70.0, 270.0, 90.0, 170.0, 130.0, 50.0, 0.0, 60.0, 200.0, 80.0, 110.0, 30.0, 110.0, 87.0, 67.0, 130.0, 70.0, 80.0, 140.0, 170.0, 80.0, 120.0, 90.0, 100.0, -50.0, 90.0, 130.0, -30.0, 49.0, 110.0, 114.0, 500.0, 80.0, 198.0, 320.0, 100.0, 70.0, 44.0, 320.0, -34.0, 159.0, 57.0, 51.0, 60.0, 150.0, 38.0, 36.0, 220.0, 40.0, 140.0, 300.0, 90.0, 55.0, 61.0, 120.0, 100.0, 97.0, 350.0, -140.0, 330.0, 89.0, 210.0, 50.0, 74.0, 100.0, 170.0, -15.0, 70.0, 66.0, 150.0, 168.0, 60.0, 121.0, 60.0, 110.0, 90.0, 45.0, 30.0, 0.0, 50.0, 159.0, 20.0, 190.0, 50.0, 40.0, 34.0, 90.0, 110.0, 80.0, 59.0, 310.0, 90.0, 70.0, 570.0, 100.0, 100.0, 155.0, 60.0, 550.0, 79.0, 48.0, 160.0, 109.0, 60.0, 0.0, 35.0, 50.0, 50.0, 80.0, 190.0, 106.0, 209.0, 70.0, 130.0, 67.0, 46.0, 116.0, 80.0, 50.0, 50.0, 80.0, 140.0, 160.0, 37.0, 70.0, 1050.0, 60.0, 80.0, 150.0, 368.0, 140.0, 150.0, -10.0, 89.0, 100.0, 150.0, 69.0, 100.0, 80.0, 35.0, -25.0, 100.0, 46.0, 250.0, 80.0, 60.0, 80.0, 300.0, 90.0, 330.0, 70.0, 190.0, 50.0, 109.0, 96.0, 250.0, -20.0, 65.0, 58.0, 70.0, 78.0, 80.0, 530.0, 49.0, 90.0, 460.0, 78.0, 110.0, 65.0, 60.0, 130.0, -31.0, 300.0, 80.0, 170.0, 110.0, -15.0, 90.0, 290.0, 50.0, 470.0, 110.0, 0.0, 100.0, 60.0, 106.0, 20.0, 200.0, 89.0, 40.0, 96.0, 170.0, 50.0, 77.0, 70.0, 60.0, 690.0, 90.0, 90.0, 70.0, 100.0, 150.0, 100.0, 110.0, 130.0, 10.0, 90.0, -7.0, 90.0, 137.0, 160.0, 155.0, 89.0, 750.0, 98.0, 130.0, 105.0, 100.0, 125.0, 70.0, 70.0, 170.0, 80.0, 130.0, 40.0, 120.0, 80.0, 110.0, 110.0, 70.0, 99.0, 89.0, 170.0, 90.0, 23.0, 70.0, 100.0, 70.0, 110.0, 70.0, 80.0, 41.0, 110.0, 200.0, 130.0, 61.0, 374.0, 330.0, 120.0, 80.0, -49.0, 48.0, -37.0, 120.0, -210.0, 400.0, 120.0, 30.0, 80.0, 110.0, 310.0, 30.0, 90.0, 138.0, 90.0, 386.0, 90.0, 60.0, 110.0, 200.0, 29.0, 118.0, 60.0, -10.0, 60.0, 40.0, 290.0, 90.0, 80.0, 40.0, 50.0, 70.0, 60.0, 90.0, 75.0, 70.0, 270.0, 120.0, 256.0, 60.0, 100.0, 70.0, 100.0, 0.0, 30.0, 120.0, 50.0, 540.0, -150.0, -200.0, 100.0, 220.0, 100.0, 310.0, 50.0, 60.0, 350.0, 90.0, 120.0, 110.0, 410.0, 90.0, 40.0, 110.0, 105.0, -80.0, 180.0, 670.0, 135.0, 90.0, 60.0, 180.0, 30.0, -132.0, 88.0, 110.0, 40.0, 315.0, 210.0, 80.0, 59.0, 160.0, 50.0, 50.0, 70.0, 48.0, 70.0, 170.0, 166.0, 69.0, 89.0, 70.0, 100.0, 160.0, 50.0, 65.0, 70.0, -7.0, 180.0, 90.0, 90.0, 185.0, 170.0, 520.0, 50.0, 98.0, 117.0, 80.0, 190.0, 170.0, 35.0, 60.0, 96.0, 63.0, -180.0, 0.0, 57.0, 179.0, 84.0, 50.0, 25.0, 120.0, -240.0, 45.0, 110.0, 180.0, 103.0, 70.0, 120.0, 80.0, 50.0, 100.0, 50.0, 43.0, 60.0, 40.0, 120.0, 470.0, 90.0, 30.0, 170.0, 52.0, 170.0, 50.0, 190.0, 40.0, 70.0, 40.0, 80.0, 2.0, 45.0, 200.0, 70.0, 310.0, 110.0, 60.0, 70.0, 300.0, -30.0, 32.0, 50.0, 160.0, 98.0, 60.0, 100.0, 90.0, 90.0, 208.0, 60.0, 330.0, 92.0, -18.0, 109.0, 100.0, 50.0, 90.0, 206.0, 159.0, 40.0, 70.0, 120.0, -30.0, 90.0, 349.0, 309.0, 8.0, 60.0, 100.0, 80.0, 70.0, 110.0, 90.0, 80.0, 50.0, 180.0, 50.0, 60.0, 60.0, 79.0, 319.0, 90.0, 119.0, 40.0, 10.0, 120.0, 60.0, 30.0, 300.0, 140.0, 60.0, 80.0, -30.0, 60.0, 45.0, 85.0, 70.0, 130.0, 100.0, 170.0, 30.0, 130.0, 30.0, 60.0, 76.0, 152.0, 41.0, 50.0, 45.0, 27.0, 150.0, 76.0, 340.0, 70.0, 70.0, 120.0, 120.0, 180.0, 299.0, 80.0, 100.0, 68.0, 108.0, 73.0, 70.0, 108.0, 448.0, 110.0, -20.0, 140.0, 120.0, 96.0, -40.0, 79.0, 150.0, 100.0, 48.0, 130.0, 320.0, -80.0, 10.0, 90.0, 48.0, 130.0, 190.0, 330.0, -40.0, 60.0, 30.0, 120.0, 50.0, 80.0, 50.0, 120.0, 160.0, 30.0, 130.0, 110.0, 56.0, 90.0, 130.0, 350.0, 290.0, 43.0, 80.0, 320.0, 68.0, -70.0, 60.0, 145.0, 130.0, 140.0, 140.0, 76.0, 310.0, 60.0, 50.0, 38.0, 80.0, 173.0, -42.0, 70.0, -10.0, 40.0, 120.0, 150.0, 140.0, 60.0, 740.0, 15.0, 55.0, 73.0, 66.0, 170.0, 190.0, 38.0, 60.0, 320.0, -80.0, 60.0, 7.0, 89.0, 75.0, 249.0, 0.0, 80.0, 99.0, 70.0, 195.0, 200.0, 80.0, 35.0, 70.0, 30.0, 130.0, 90.0, 90.0, 165.0, 190.0, 80.0, 90.0, 100.0, -80.0, 600.0, 190.0, 30.0, 70.0, 80.0, 80.0, 130.0, 130.0, 60.0, 85.0, 80.0, 43.0, 70.0, 120.0, 109.0, 80.0, 30.0, 90.0, 110.0, 90.0, 80.0, 0.0, 100.0, 160.0, 80.0, 110.0, -52.0, 79.0, 30.0, 210.0, 68.0, 160.0, 51.0, 24.0, -26.0, 490.0, 90.0, 90.0, 50.0, 120.0, 130.0, 70.0, 109.0, 110.0, 90.0, 300.0, 80.0, 60.0, 80.0, 70.0, 130.0, -35.0, 27.0, 50.0, 127.0, 30.0, 80.0, 170.0, 110.0, 104.0, 124.0, 100.0, 110.0, 310.0, 104.0, 50.0, 80.0, 210.0, 60.0, 90.0, -83.0, 90.0, 620.0, 149.0, 130.0, 220.0, 90.0, 89.0, 220.0, 130.0, 60.0, 78.0, 320.0, -10.0, 210.0, 120.0, 190.0, 55.0, 150.0, 40.0, 57.0, 120.0, 99.0, 68.0, 90.0, -32.0, 50.0, 110.0, 100.0, 120.0, 70.0, 120.0, 5.0, 100.0, 120.0, 150.0, 70.0, 80.0, -21.0, 130.0, 120.0, 80.0, 60.0, 50.0, 369.0, 80.0, 20.0, -21.0, 80.0, 70.0, 90.0, 19.0, 80.0, 70.0, 80.0, 70.0, 110.0, 60.0, 5.0, 80.0, 60.0, 57.0, 120.0, 99.0, 0.0, 147.0, 108.0, 128.0, 70.0, 129.0, 45.0, 70.0, 30.0, 130.0, 80.0, 66.0, 55.0, 110.0, 120.0, 70.0, 120.0, 40.0, 190.0, 90.0, 100.0, 73.0, 87.0, 25.0, 70.0, 200.0, 70.0, 90.0, 64.0, 76.0, 90.0, 99.0, 160.0, 0.0, 100.0, 89.0, 50.0, 60.0, 93.0, 50.0, 110.0, 60.0, 90.0, 51.0, 300.0, 90.0, 40.0, 170.0, 70.0, 390.0, 70.0, 10.0, 59.0, 10.0, 80.0, 59.0, 119.0, 157.0, 50.0, 50.0, 79.0, 39.0, 86.0, 330.0, 28.0, 290.0, 82.0, 35.0, 210.0, 340.0, 90.0, 70.0, 35.0, 130.0, 80.0, 80.0, 60.0, 49.0, 42.0, 60.0, 100.0, 70.0, 70.0, 70.0, 100.0, 310.0, 120.0, 68.0, 139.0, 90.0, 210.0, 310.0, 130.0, 35.0, 119.0, 360.0, 130.0, 80.0, -30.0, 70.0, 170.0, 400.0, 70.0, 90.0, 65.0, 60.0, 60.0, 100.0, 110.0, 120.0, 100.0, 110.0, 160.0, 97.0, 75.0, 105.0, 80.0, 80.0, 60.0, 100.0, 79.0, 90.0, 80.0, 130.0, 87.0, 90.0, -10.0, 90.0, 70.0, 120.0, 14.0, 74.0, 290.0, 140.0, 35.0, 320.0, 110.0, 80.0, 80.0, 34.0, 130.0, 300.0, 50.0, 110.0, 66.0, 270.0, 240.0, 160.0, 77.0, 439.0, 80.0, -7.0, 80.0, 166.0, 40.0, 100.0, 170.0, 330.0, 20.0, 118.0, 98.0, 120.0, 125.0, 46.0, -40.0, 90.0, 217.0, 349.0, 40.0, 100.0, 80.0, 70.0, 86.0, 50.0, 70.0, 20.0, 230.0, 140.0, 80.0, 80.0, 0.0, 150.0, 190.0, 110.0, 950.0, 84.0, 76.0, 90.0, 30.0, 60.0, 240.0, 98.0, 80.0, 170.0, 70.0, 120.0, 145.0, 60.0, 90.0, 60.0, 120.0, 100.0, 120.0, 50.0, 30.0, 100.0, 40.0, 80.0, 8.0, 120.0, 78.0, 90.0, 800.0, 236.0, 80.0, 100.0, 90.0, -40.0, -20.0, 98.0, 86.0, 60.0, 50.0, 100.0, -40.0, 100.0, 1140.0, 60.0, 440.0, 46.0, 119.0, 139.0, 140.0, 110.0, 30.0, 94.0, 120.0, 70.0, 310.0, 119.0, -25.0, -30.0, 54.0, 150.0, 120.0, 70.0, 64.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9152836343893012, "mean_inference_ms": 2.145123943558679, "mean_action_processing_ms": 0.7356470727719073, "mean_env_wait_ms": 1.4961441517290401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08095288276672363, "StateBufferConnector_ms": 0.010502099990844727, "ViewRequirementAgentConnector_ms": 0.5039825439453125}, "num_episodes": 18, "episode_return_max": 2095.0, "episode_return_min": 158.0, "episode_return_mean": 1111.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.75901539215154, "num_env_steps_trained_throughput_per_sec": 32.75901539215154, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 5920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5920000, "timers": {"training_iteration_time_ms": 122610.187, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122610.129, "sample_time_ms": 3341.084, "learn_time_ms": 119245.273, "learn_throughput": 33.544, "synch_weights_time_ms": 12.208}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "done": false, "training_iteration": 148, "trial_id": "6085c_00000", "date": "2024-07-02_04-00-58", "timestamp": 1719907258, "time_this_iter_s": 122.12220597267151, "time_total_s": 20103.224835157394, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b67b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20103.224835157394, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 20.26127167630058, "ram_util_percent": 79.18901734104047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.766815930985795, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.128828251425324, "policy_loss": -0.007212355441532343, "vf_loss": 8.133852290294676, "vf_explained_var": 0.0004321848749479674, "kl": 0.004322586176796075, "entropy": 0.47185513639665894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1394415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "env_runners": {"episode_reward_max": 1860.0, "episode_reward_min": 158.0, "episode_reward_mean": 1096.87, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 109.687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [964.0, 1698.0, 1018.0, 764.0, 1257.0, 1080.0, 1281.0, 770.0, 1211.0, 810.0, 1630.0, 1480.0, 980.0, 902.0, 1053.0, 1416.0, 158.0, 908.0, 1245.0, 787.0, 1160.0, 1121.0, 895.0, 1256.0, 1047.0, 830.0, 850.0, 1027.0, 1218.0, 1111.0, 946.0, 990.0, 1389.0, 1089.0, 769.0, 1589.0, 1008.0, 859.0, 1455.0, 935.0, 822.0, 785.0, 1179.0, 1099.0, 787.0, 1031.0, 1798.0, 1210.0, 795.0, 874.0, 878.0, 634.0, 903.0, 851.0, 945.0, 818.0, 944.0, 1037.0, 1191.0, 1130.0, 991.0, 1591.0, 1035.0, 1057.0, 786.0, 1263.0, 1360.0, 1305.0, 1124.0, 1095.0, 1860.0, 1103.0, 770.0, 1682.0, 1534.0, 1298.0, 902.0, 1010.0, 1236.0, 1024.0, 1108.0, 1640.0, 625.0, 1212.0, 1050.0, 1568.0, 908.0, 1690.0, 910.0, 1269.0, 800.0, 1000.0, 1014.0, 1462.0, 1740.0, 866.0, 1359.0, 969.0, 1174.0, 630.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 130.0, 10.0, 90.0, -7.0, 90.0, 137.0, 160.0, 155.0, 89.0, 750.0, 98.0, 130.0, 105.0, 100.0, 125.0, 70.0, 70.0, 170.0, 80.0, 130.0, 40.0, 120.0, 80.0, 110.0, 110.0, 70.0, 99.0, 89.0, 170.0, 90.0, 23.0, 70.0, 100.0, 70.0, 110.0, 70.0, 80.0, 41.0, 110.0, 200.0, 130.0, 61.0, 374.0, 330.0, 120.0, 80.0, -49.0, 48.0, -37.0, 120.0, -210.0, 400.0, 120.0, 30.0, 80.0, 110.0, 310.0, 30.0, 90.0, 138.0, 90.0, 386.0, 90.0, 60.0, 110.0, 200.0, 29.0, 118.0, 60.0, -10.0, 60.0, 40.0, 290.0, 90.0, 80.0, 40.0, 50.0, 70.0, 60.0, 90.0, 75.0, 70.0, 270.0, 120.0, 256.0, 60.0, 100.0, 70.0, 100.0, 0.0, 30.0, 120.0, 50.0, 540.0, -150.0, -200.0, 100.0, 220.0, 100.0, 310.0, 50.0, 60.0, 350.0, 90.0, 120.0, 110.0, 410.0, 90.0, 40.0, 110.0, 105.0, -80.0, 180.0, 670.0, 135.0, 90.0, 60.0, 180.0, 30.0, -132.0, 88.0, 110.0, 40.0, 315.0, 210.0, 80.0, 59.0, 160.0, 50.0, 50.0, 70.0, 48.0, 70.0, 170.0, 166.0, 69.0, 89.0, 70.0, 100.0, 160.0, 50.0, 65.0, 70.0, -7.0, 180.0, 90.0, 90.0, 185.0, 170.0, 520.0, 50.0, 98.0, 117.0, 80.0, 190.0, 170.0, 35.0, 60.0, 96.0, 63.0, -180.0, 0.0, 57.0, 179.0, 84.0, 50.0, 25.0, 120.0, -240.0, 45.0, 110.0, 180.0, 103.0, 70.0, 120.0, 80.0, 50.0, 100.0, 50.0, 43.0, 60.0, 40.0, 120.0, 470.0, 90.0, 30.0, 170.0, 52.0, 170.0, 50.0, 190.0, 40.0, 70.0, 40.0, 80.0, 2.0, 45.0, 200.0, 70.0, 310.0, 110.0, 60.0, 70.0, 300.0, -30.0, 32.0, 50.0, 160.0, 98.0, 60.0, 100.0, 90.0, 90.0, 208.0, 60.0, 330.0, 92.0, -18.0, 109.0, 100.0, 50.0, 90.0, 206.0, 159.0, 40.0, 70.0, 120.0, -30.0, 90.0, 349.0, 309.0, 8.0, 60.0, 100.0, 80.0, 70.0, 110.0, 90.0, 80.0, 50.0, 180.0, 50.0, 60.0, 60.0, 79.0, 319.0, 90.0, 119.0, 40.0, 10.0, 120.0, 60.0, 30.0, 300.0, 140.0, 60.0, 80.0, -30.0, 60.0, 45.0, 85.0, 70.0, 130.0, 100.0, 170.0, 30.0, 130.0, 30.0, 60.0, 76.0, 152.0, 41.0, 50.0, 45.0, 27.0, 150.0, 76.0, 340.0, 70.0, 70.0, 120.0, 120.0, 180.0, 299.0, 80.0, 100.0, 68.0, 108.0, 73.0, 70.0, 108.0, 448.0, 110.0, -20.0, 140.0, 120.0, 96.0, -40.0, 79.0, 150.0, 100.0, 48.0, 130.0, 320.0, -80.0, 10.0, 90.0, 48.0, 130.0, 190.0, 330.0, -40.0, 60.0, 30.0, 120.0, 50.0, 80.0, 50.0, 120.0, 160.0, 30.0, 130.0, 110.0, 56.0, 90.0, 130.0, 350.0, 290.0, 43.0, 80.0, 320.0, 68.0, -70.0, 60.0, 145.0, 130.0, 140.0, 140.0, 76.0, 310.0, 60.0, 50.0, 38.0, 80.0, 173.0, -42.0, 70.0, -10.0, 40.0, 120.0, 150.0, 140.0, 60.0, 740.0, 15.0, 55.0, 73.0, 66.0, 170.0, 190.0, 38.0, 60.0, 320.0, -80.0, 60.0, 7.0, 89.0, 75.0, 249.0, 0.0, 80.0, 99.0, 70.0, 195.0, 200.0, 80.0, 35.0, 70.0, 30.0, 130.0, 90.0, 90.0, 165.0, 190.0, 80.0, 90.0, 100.0, -80.0, 600.0, 190.0, 30.0, 70.0, 80.0, 80.0, 130.0, 130.0, 60.0, 85.0, 80.0, 43.0, 70.0, 120.0, 109.0, 80.0, 30.0, 90.0, 110.0, 90.0, 80.0, 0.0, 100.0, 160.0, 80.0, 110.0, -52.0, 79.0, 30.0, 210.0, 68.0, 160.0, 51.0, 24.0, -26.0, 490.0, 90.0, 90.0, 50.0, 120.0, 130.0, 70.0, 109.0, 110.0, 90.0, 300.0, 80.0, 60.0, 80.0, 70.0, 130.0, -35.0, 27.0, 50.0, 127.0, 30.0, 80.0, 170.0, 110.0, 104.0, 124.0, 100.0, 110.0, 310.0, 104.0, 50.0, 80.0, 210.0, 60.0, 90.0, -83.0, 90.0, 620.0, 149.0, 130.0, 220.0, 90.0, 89.0, 220.0, 130.0, 60.0, 78.0, 320.0, -10.0, 210.0, 120.0, 190.0, 55.0, 150.0, 40.0, 57.0, 120.0, 99.0, 68.0, 90.0, -32.0, 50.0, 110.0, 100.0, 120.0, 70.0, 120.0, 5.0, 100.0, 120.0, 150.0, 70.0, 80.0, -21.0, 130.0, 120.0, 80.0, 60.0, 50.0, 369.0, 80.0, 20.0, -21.0, 80.0, 70.0, 90.0, 19.0, 80.0, 70.0, 80.0, 70.0, 110.0, 60.0, 5.0, 80.0, 60.0, 57.0, 120.0, 99.0, 0.0, 147.0, 108.0, 128.0, 70.0, 129.0, 45.0, 70.0, 30.0, 130.0, 80.0, 66.0, 55.0, 110.0, 120.0, 70.0, 120.0, 40.0, 190.0, 90.0, 100.0, 73.0, 87.0, 25.0, 70.0, 200.0, 70.0, 90.0, 64.0, 76.0, 90.0, 99.0, 160.0, 0.0, 100.0, 89.0, 50.0, 60.0, 93.0, 50.0, 110.0, 60.0, 90.0, 51.0, 300.0, 90.0, 40.0, 170.0, 70.0, 390.0, 70.0, 10.0, 59.0, 10.0, 80.0, 59.0, 119.0, 157.0, 50.0, 50.0, 79.0, 39.0, 86.0, 330.0, 28.0, 290.0, 82.0, 35.0, 210.0, 340.0, 90.0, 70.0, 35.0, 130.0, 80.0, 80.0, 60.0, 49.0, 42.0, 60.0, 100.0, 70.0, 70.0, 70.0, 100.0, 310.0, 120.0, 68.0, 139.0, 90.0, 210.0, 310.0, 130.0, 35.0, 119.0, 360.0, 130.0, 80.0, -30.0, 70.0, 170.0, 400.0, 70.0, 90.0, 65.0, 60.0, 60.0, 100.0, 110.0, 120.0, 100.0, 110.0, 160.0, 97.0, 75.0, 105.0, 80.0, 80.0, 60.0, 100.0, 79.0, 90.0, 80.0, 130.0, 87.0, 90.0, -10.0, 90.0, 70.0, 120.0, 14.0, 74.0, 290.0, 140.0, 35.0, 320.0, 110.0, 80.0, 80.0, 34.0, 130.0, 300.0, 50.0, 110.0, 66.0, 270.0, 240.0, 160.0, 77.0, 439.0, 80.0, -7.0, 80.0, 166.0, 40.0, 100.0, 170.0, 330.0, 20.0, 118.0, 98.0, 120.0, 125.0, 46.0, -40.0, 90.0, 217.0, 349.0, 40.0, 100.0, 80.0, 70.0, 86.0, 50.0, 70.0, 20.0, 230.0, 140.0, 80.0, 80.0, 0.0, 150.0, 190.0, 110.0, 950.0, 84.0, 76.0, 90.0, 30.0, 60.0, 240.0, 98.0, 80.0, 170.0, 70.0, 120.0, 145.0, 60.0, 90.0, 60.0, 120.0, 100.0, 120.0, 50.0, 30.0, 100.0, 40.0, 80.0, 8.0, 120.0, 78.0, 90.0, 800.0, 236.0, 80.0, 100.0, 90.0, -40.0, -20.0, 98.0, 86.0, 60.0, 50.0, 100.0, -40.0, 100.0, 1140.0, 60.0, 440.0, 46.0, 119.0, 139.0, 140.0, 110.0, 30.0, 94.0, 120.0, 70.0, 310.0, 119.0, -25.0, -30.0, 54.0, 150.0, 120.0, 70.0, 64.0, 40.0, 60.0, 90.0, 70.0, 90.0, 60.0, 70.0, 50.0, 100.0, 380.0, 340.0, 77.0, 140.0, 80.0, 140.0, 90.0, 140.0, 60.0, 69.0, 100.0, 70.0, 30.0, 50.0, 73.0, 170.0, 40.0, 60.0, 191.0, -30.0, 370.0, 90.0, 110.0, 30.0, 180.0, -40.0, 150.0, -47.0, 80.0, 376.0, 179.0, 40.0, 60.0, 60.0, 165.0, 190.0, 40.0, -10.0, -40.0, 1035.0, 100.0, 100.0, 35.0, 40.0, 70.0, 40.0, -20.0, -10.0, 140.0, 40.0, 190.0, 140.0, 100.0, 100.0, 50.0, 530.0, 80.0, 25.0, 17.0, 80.0, 90.0, 90.0, 110.0, 70.0, 119.0, 256.0, 99.0, 70.0, 89.0, 72.0, 75.0, 130.0, 130.0, 110.0, 120.0, 110.0, 48.0, 140.0, 630.0, 50.0, 100.0, 100.0, 170.0, 40.0, 120.0, 110.0, 120.0, 50.0, 80.0, 58.0, 60.0, 89.0, 76.0, 3.0, 290.0, 60.0, 460.0, 80.0, 370.0, 92.0, 170.0, 140.0, 40.0, 70.0, 90.0, 110.0, 120.0, 210.0, -8.0, 38.0, 100.0, 90.0, 392.0, 140.0, 57.0, 110.0, 60.0, 110.0, 80.0, 160.0, 70.0, 120.0, 170.0, 30.0, 60.0, 50.0, 100.0, 60.0, 40.0, 100.0, 70.0, 90.0, 70.0, 90.0, 160.0, 100.0, 60.0, 110.0, 150.0, 90.0, 80.0, 130.0, -5.0, 120.0, 40.0, 110.0, 170.0, 70.0, 40.0, 179.0, 160.0, 415.0, 110.0, 70.0, 40.0, -10.0, -1.0, 390.0, 390.0, 61.0, -3.0, -100.0, 90.0, 60.0, 180.0, 670.0, 460.0, 290.0, -20.0, 40.0, 70.0, 80.0, 64.0, 20.0, 55.0, 190.0, 90.0, 80.0, 127.0, 52.0, 108.0, -50.0, 110.0, 100.0, -10.0, 100.0, 110.0, 159.0, 670.0, 100.0, 70.0, 70.0, 90.0, 100.0, 120.0, 120.0, 300.0, 50.0, 40.0, 49.0, 30.0, 129.0, 80.0, 15.0, 80.0, 120.0, 90.0, 130.0, 100.0, 270.0, 160.0, 50.0, 190.0, -15.0, 77.0, 68.0, 60.0, 40.0, 30.0, 30.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9147157614451265, "mean_inference_ms": 2.14374091421317, "mean_action_processing_ms": 0.7350282559795884, "mean_env_wait_ms": 1.4950761432584982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07596492767333984, "StateBufferConnector_ms": 0.01085042953491211, "ViewRequirementAgentConnector_ms": 0.49559497833251953}, "num_episodes": 23, "episode_return_max": 1860.0, "episode_return_min": 158.0, "episode_return_mean": 1096.87, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.27325919397233, "num_env_steps_trained_throughput_per_sec": 32.27325919397233, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 5960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5960000, "timers": {"training_iteration_time_ms": 122723.024, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122722.969, "sample_time_ms": 3392.543, "learn_time_ms": 119306.693, "learn_throughput": 33.527, "synch_weights_time_ms": 12.277}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "done": false, "training_iteration": 149, "trial_id": "6085c_00000", "date": "2024-07-02_04-03-02", "timestamp": 1719907382, "time_this_iter_s": 123.95321273803711, "time_total_s": 20227.17804789543, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138c86280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20227.17804789543, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 21.324571428571428, "ram_util_percent": 80.02514285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6808049787855506, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.037269193702105, "policy_loss": -0.007061859275461338, "vf_loss": 8.042877248707162, "vf_explained_var": 0.0011420633338383847, "kl": 0.0057434486892812215, "entropy": 0.47389468721117073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1403805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "env_runners": {"episode_reward_max": 1860.0, "episode_reward_min": 564.0, "episode_reward_mean": 1100.83, "episode_len_mean": 201.0, "episode_media": {}, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -195.0}, "policy_reward_max": {"policy_0": 1140.0}, "policy_reward_mean": {"policy_0": 110.083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [895.0, 1256.0, 1047.0, 830.0, 850.0, 1027.0, 1218.0, 1111.0, 946.0, 990.0, 1389.0, 1089.0, 769.0, 1589.0, 1008.0, 859.0, 1455.0, 935.0, 822.0, 785.0, 1179.0, 1099.0, 787.0, 1031.0, 1798.0, 1210.0, 795.0, 874.0, 878.0, 634.0, 903.0, 851.0, 945.0, 818.0, 944.0, 1037.0, 1191.0, 1130.0, 991.0, 1591.0, 1035.0, 1057.0, 786.0, 1263.0, 1360.0, 1305.0, 1124.0, 1095.0, 1860.0, 1103.0, 770.0, 1682.0, 1534.0, 1298.0, 902.0, 1010.0, 1236.0, 1024.0, 1108.0, 1640.0, 625.0, 1212.0, 1050.0, 1568.0, 908.0, 1690.0, 910.0, 1269.0, 800.0, 1000.0, 1014.0, 1462.0, 1740.0, 866.0, 1359.0, 969.0, 1174.0, 630.0, 718.0, 1121.0, 1745.0, 1120.0, 1660.0, 1199.0, 853.0, 962.0, 1478.0, 1107.0, 775.0, 690.0, 1032.0, 1204.0, 1137.0, 870.0, 1789.0, 955.0, 1023.0, 729.0, 1358.0, 564.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 50.0, 90.0, 206.0, 159.0, 40.0, 70.0, 120.0, -30.0, 90.0, 349.0, 309.0, 8.0, 60.0, 100.0, 80.0, 70.0, 110.0, 90.0, 80.0, 50.0, 180.0, 50.0, 60.0, 60.0, 79.0, 319.0, 90.0, 119.0, 40.0, 10.0, 120.0, 60.0, 30.0, 300.0, 140.0, 60.0, 80.0, -30.0, 60.0, 45.0, 85.0, 70.0, 130.0, 100.0, 170.0, 30.0, 130.0, 30.0, 60.0, 76.0, 152.0, 41.0, 50.0, 45.0, 27.0, 150.0, 76.0, 340.0, 70.0, 70.0, 120.0, 120.0, 180.0, 299.0, 80.0, 100.0, 68.0, 108.0, 73.0, 70.0, 108.0, 448.0, 110.0, -20.0, 140.0, 120.0, 96.0, -40.0, 79.0, 150.0, 100.0, 48.0, 130.0, 320.0, -80.0, 10.0, 90.0, 48.0, 130.0, 190.0, 330.0, -40.0, 60.0, 30.0, 120.0, 50.0, 80.0, 50.0, 120.0, 160.0, 30.0, 130.0, 110.0, 56.0, 90.0, 130.0, 350.0, 290.0, 43.0, 80.0, 320.0, 68.0, -70.0, 60.0, 145.0, 130.0, 140.0, 140.0, 76.0, 310.0, 60.0, 50.0, 38.0, 80.0, 173.0, -42.0, 70.0, -10.0, 40.0, 120.0, 150.0, 140.0, 60.0, 740.0, 15.0, 55.0, 73.0, 66.0, 170.0, 190.0, 38.0, 60.0, 320.0, -80.0, 60.0, 7.0, 89.0, 75.0, 249.0, 0.0, 80.0, 99.0, 70.0, 195.0, 200.0, 80.0, 35.0, 70.0, 30.0, 130.0, 90.0, 90.0, 165.0, 190.0, 80.0, 90.0, 100.0, -80.0, 600.0, 190.0, 30.0, 70.0, 80.0, 80.0, 130.0, 130.0, 60.0, 85.0, 80.0, 43.0, 70.0, 120.0, 109.0, 80.0, 30.0, 90.0, 110.0, 90.0, 80.0, 0.0, 100.0, 160.0, 80.0, 110.0, -52.0, 79.0, 30.0, 210.0, 68.0, 160.0, 51.0, 24.0, -26.0, 490.0, 90.0, 90.0, 50.0, 120.0, 130.0, 70.0, 109.0, 110.0, 90.0, 300.0, 80.0, 60.0, 80.0, 70.0, 130.0, -35.0, 27.0, 50.0, 127.0, 30.0, 80.0, 170.0, 110.0, 104.0, 124.0, 100.0, 110.0, 310.0, 104.0, 50.0, 80.0, 210.0, 60.0, 90.0, -83.0, 90.0, 620.0, 149.0, 130.0, 220.0, 90.0, 89.0, 220.0, 130.0, 60.0, 78.0, 320.0, -10.0, 210.0, 120.0, 190.0, 55.0, 150.0, 40.0, 57.0, 120.0, 99.0, 68.0, 90.0, -32.0, 50.0, 110.0, 100.0, 120.0, 70.0, 120.0, 5.0, 100.0, 120.0, 150.0, 70.0, 80.0, -21.0, 130.0, 120.0, 80.0, 60.0, 50.0, 369.0, 80.0, 20.0, -21.0, 80.0, 70.0, 90.0, 19.0, 80.0, 70.0, 80.0, 70.0, 110.0, 60.0, 5.0, 80.0, 60.0, 57.0, 120.0, 99.0, 0.0, 147.0, 108.0, 128.0, 70.0, 129.0, 45.0, 70.0, 30.0, 130.0, 80.0, 66.0, 55.0, 110.0, 120.0, 70.0, 120.0, 40.0, 190.0, 90.0, 100.0, 73.0, 87.0, 25.0, 70.0, 200.0, 70.0, 90.0, 64.0, 76.0, 90.0, 99.0, 160.0, 0.0, 100.0, 89.0, 50.0, 60.0, 93.0, 50.0, 110.0, 60.0, 90.0, 51.0, 300.0, 90.0, 40.0, 170.0, 70.0, 390.0, 70.0, 10.0, 59.0, 10.0, 80.0, 59.0, 119.0, 157.0, 50.0, 50.0, 79.0, 39.0, 86.0, 330.0, 28.0, 290.0, 82.0, 35.0, 210.0, 340.0, 90.0, 70.0, 35.0, 130.0, 80.0, 80.0, 60.0, 49.0, 42.0, 60.0, 100.0, 70.0, 70.0, 70.0, 100.0, 310.0, 120.0, 68.0, 139.0, 90.0, 210.0, 310.0, 130.0, 35.0, 119.0, 360.0, 130.0, 80.0, -30.0, 70.0, 170.0, 400.0, 70.0, 90.0, 65.0, 60.0, 60.0, 100.0, 110.0, 120.0, 100.0, 110.0, 160.0, 97.0, 75.0, 105.0, 80.0, 80.0, 60.0, 100.0, 79.0, 90.0, 80.0, 130.0, 87.0, 90.0, -10.0, 90.0, 70.0, 120.0, 14.0, 74.0, 290.0, 140.0, 35.0, 320.0, 110.0, 80.0, 80.0, 34.0, 130.0, 300.0, 50.0, 110.0, 66.0, 270.0, 240.0, 160.0, 77.0, 439.0, 80.0, -7.0, 80.0, 166.0, 40.0, 100.0, 170.0, 330.0, 20.0, 118.0, 98.0, 120.0, 125.0, 46.0, -40.0, 90.0, 217.0, 349.0, 40.0, 100.0, 80.0, 70.0, 86.0, 50.0, 70.0, 20.0, 230.0, 140.0, 80.0, 80.0, 0.0, 150.0, 190.0, 110.0, 950.0, 84.0, 76.0, 90.0, 30.0, 60.0, 240.0, 98.0, 80.0, 170.0, 70.0, 120.0, 145.0, 60.0, 90.0, 60.0, 120.0, 100.0, 120.0, 50.0, 30.0, 100.0, 40.0, 80.0, 8.0, 120.0, 78.0, 90.0, 800.0, 236.0, 80.0, 100.0, 90.0, -40.0, -20.0, 98.0, 86.0, 60.0, 50.0, 100.0, -40.0, 100.0, 1140.0, 60.0, 440.0, 46.0, 119.0, 139.0, 140.0, 110.0, 30.0, 94.0, 120.0, 70.0, 310.0, 119.0, -25.0, -30.0, 54.0, 150.0, 120.0, 70.0, 64.0, 40.0, 60.0, 90.0, 70.0, 90.0, 60.0, 70.0, 50.0, 100.0, 380.0, 340.0, 77.0, 140.0, 80.0, 140.0, 90.0, 140.0, 60.0, 69.0, 100.0, 70.0, 30.0, 50.0, 73.0, 170.0, 40.0, 60.0, 191.0, -30.0, 370.0, 90.0, 110.0, 30.0, 180.0, -40.0, 150.0, -47.0, 80.0, 376.0, 179.0, 40.0, 60.0, 60.0, 165.0, 190.0, 40.0, -10.0, -40.0, 1035.0, 100.0, 100.0, 35.0, 40.0, 70.0, 40.0, -20.0, -10.0, 140.0, 40.0, 190.0, 140.0, 100.0, 100.0, 50.0, 530.0, 80.0, 25.0, 17.0, 80.0, 90.0, 90.0, 110.0, 70.0, 119.0, 256.0, 99.0, 70.0, 89.0, 72.0, 75.0, 130.0, 130.0, 110.0, 120.0, 110.0, 48.0, 140.0, 630.0, 50.0, 100.0, 100.0, 170.0, 40.0, 120.0, 110.0, 120.0, 50.0, 80.0, 58.0, 60.0, 89.0, 76.0, 3.0, 290.0, 60.0, 460.0, 80.0, 370.0, 92.0, 170.0, 140.0, 40.0, 70.0, 90.0, 110.0, 120.0, 210.0, -8.0, 38.0, 100.0, 90.0, 392.0, 140.0, 57.0, 110.0, 60.0, 110.0, 80.0, 160.0, 70.0, 120.0, 170.0, 30.0, 60.0, 50.0, 100.0, 60.0, 40.0, 100.0, 70.0, 90.0, 70.0, 90.0, 160.0, 100.0, 60.0, 110.0, 150.0, 90.0, 80.0, 130.0, -5.0, 120.0, 40.0, 110.0, 170.0, 70.0, 40.0, 179.0, 160.0, 415.0, 110.0, 70.0, 40.0, -10.0, -1.0, 390.0, 390.0, 61.0, -3.0, -100.0, 90.0, 60.0, 180.0, 670.0, 460.0, 290.0, -20.0, 40.0, 70.0, 80.0, 64.0, 20.0, 55.0, 190.0, 90.0, 80.0, 127.0, 52.0, 108.0, -50.0, 110.0, 100.0, -10.0, 100.0, 110.0, 159.0, 670.0, 100.0, 70.0, 70.0, 90.0, 100.0, 120.0, 120.0, 300.0, 50.0, 40.0, 49.0, 30.0, 129.0, 80.0, 15.0, 80.0, 120.0, 90.0, 130.0, 100.0, 270.0, 160.0, 50.0, 190.0, -15.0, 77.0, 68.0, 60.0, 40.0, 30.0, 30.0, 100.0, 55.0, 25.0, 70.0, 110.0, 38.0, 60.0, 90.0, 40.0, 150.0, 80.0, 100.0, 50.0, 310.0, 55.0, 120.0, 60.0, 0.0, 86.0, 50.0, 290.0, 30.0, 130.0, 170.0, 913.0, 120.0, 20.0, 140.0, 130.0, 13.0, 79.0, 130.0, 110.0, 60.0, 60.0, 140.0, -100.0, 70.0, 80.0, 450.0, 120.0, 150.0, 75.0, 100.0, 160.0, 180.0, 130.0, 120.0, 139.0, 510.0, 96.0, 100.0, 69.0, 90.0, 70.0, 110.0, 50.0, 60.0, 230.0, 390.0, 30.0, 50.0, -20.0, 64.0, 55.0, 88.0, 120.0, 27.0, 109.0, 60.0, 300.0, 100.0, 8.0, 110.0, 130.0, 130.0, 150.0, 100.0, 120.0, 35.0, 79.0, 140.0, 620.0, 110.0, 120.0, 90.0, 99.0, 90.0, 99.0, 50.0, 60.0, 123.0, 120.0, 8.0, 137.0, 90.0, 104.0, 50.0, 160.0, 117.0, 198.0, 110.0, 60.0, 80.0, 60.0, -25.0, 90.0, 60.0, 110.0, 110.0, 120.0, 70.0, 34.0, 53.0, 82.0, 310.0, 30.0, -40.0, 61.0, 90.0, 0.0, 100.0, 100.0, 200.0, 77.0, 110.0, -136.0, 160.0, 330.0, 21.0, 70.0, 79.0, 70.0, 170.0, 80.0, 25.0, 310.0, 110.0, 160.0, 100.0, 100.0, 70.0, 118.0, 70.0, 30.0, 65.0, 80.0, 130.0, 188.0, 146.0, 240.0, 110.0, 120.0, 160.0, 106.0, 60.0, 110.0, 50.0, 70.0, 30.0, 54.0, 100.0, 110.0, 95.0, 90.0, 540.0, 64.0, 150.0, 330.0, 230.0, 80.0, 350.0, 50.0, 50.0, 10.0, 20.0, 50.0, 90.0, 30.0, 220.0, 85.0, 110.0, 170.0, 110.0, 140.0, 52.0, 120.0, 100.0, 54.0, 67.0, 100.0, 80.0, 38.0, 70.0, 145.0, 60.0, 24.0, 45.0, 27.0, 180.0, 60.0, 60.0, 50.0, 50.0, 60.0, 40.0, 90.0, 80.0, 629.0, 49.0, 250.0, 100.0, 100.0, 50.0, 29.0, 40.0, 90.0, -195.0, 160.0, 30.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9136708570616896, "mean_inference_ms": 2.1418368867089037, "mean_action_processing_ms": 0.7343416017402599, "mean_env_wait_ms": 1.4937380978647425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07252216339111328, "StateBufferConnector_ms": 0.01053309440612793, "ViewRequirementAgentConnector_ms": 0.46352338790893555}, "num_episodes": 22, "episode_return_max": 1860.0, "episode_return_min": 564.0, "episode_return_mean": 1100.83, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.41273283494667, "num_env_steps_trained_throughput_per_sec": 32.41273283494667, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 6000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 6000000, "timers": {"training_iteration_time_ms": 122876.188, "restore_workers_time_ms": 0.015, "training_step_time_ms": 122876.136, "sample_time_ms": 3337.207, "learn_time_ms": 119515.634, "learn_throughput": 33.468, "synch_weights_time_ms": 12.208}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "done": true, "training_iteration": 150, "trial_id": "6085c_00000", "date": "2024-07-02_04-05-05", "timestamp": 1719907505, "time_this_iter_s": 123.42081785202026, "time_total_s": 20350.59886574745, "pid": 51117, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x138b67f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Tuple(Discrete(5), Discrete(2))", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20350.59886574745, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 21.796, "ram_util_percent": 79.85714285714286}}
