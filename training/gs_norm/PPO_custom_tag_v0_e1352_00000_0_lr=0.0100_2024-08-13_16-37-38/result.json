{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3038238997024203, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 3.9004518410516162, "policy_loss": -0.0012023296030410737, "vf_loss": 3.8995069224998433, "vf_explained_var": -0.0027246306812952433, "kl": 0.010736282327647867, "entropy": 1.598899023116581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0074413847631563, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 6.547622054720682, "policy_loss": 0.0011106657026897348, "vf_loss": 6.544503842712079, "vf_explained_var": 0.00834476771178069, "kl": 0.010037711745341866, "entropy": 1.5995544304292668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 183.0, "episode_reward_min": -104.0, "episode_reward_mean": 29.055555555555557, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -241.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.0, "predator_policy": 124.0}, "policy_reward_mean": {"prey_policy": -15.222222222222221, "predator_policy": 29.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.0, 31.0, 180.0, -63.0, -33.0, 183.0, 66.0, -35.0, 87.0, -31.0, 29.0, -40.0, 29.0, 41.0, 2.0, 52.0, -1.0, 130.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-241.0, 13.0, 12.0, 15.0, 171.0, 0.0, -163.0, 0.0, 16.0, -117.0, 110.0, 37.0, 103.0, -101.0, -60.0, -22.0, -81.0, 83.0, 0.0, -86.0, -95.0, 54.0, -78.0, -2.0, -180.0, 119.0, -157.0, 69.0, 0.0, 2.0, -5.0, 7.0, 6.0, -92.0, -26.0, 141.0], "policy_predator_policy_reward": [124.0, 0.0, 4.0, 0.0, 0.0, 9.0, 0.0, 100.0, 68.0, 0.0, 4.0, 32.0, 0.0, 64.0, 40.0, 7.0, 7.0, 78.0, 53.0, 2.0, 70.0, 0.0, 37.0, 3.0, 0.0, 90.0, 48.0, 81.0, 0.0, 0.0, 48.0, 2.0, 16.0, 69.0, 0.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8216199589880281, "mean_inference_ms": 2.2629369152310823, "mean_action_processing_ms": 0.3812724491131622, "mean_env_wait_ms": 0.3071362397926259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008584393395317925, "StateBufferConnector_ms": 0.0035789277818467882, "ViewRequirementAgentConnector_ms": 0.15172759691874185}, "num_episodes": 18, "episode_return_max": 183.0, "episode_return_min": -104.0, "episode_return_mean": 29.055555555555557, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.85749453822896, "num_env_steps_trained_throughput_per_sec": 251.85749453822896, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 15882.005, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15881.948, "sample_time_ms": 1829.066, "learn_time_ms": 14016.148, "learn_throughput": 285.385, "synch_weights_time_ms": 34.667}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "e1352_00000", "date": "2024-08-13_16-38-08", "timestamp": 1723581488, "time_this_iter_s": 15.969891786575317, "time_total_s": 15.969891786575317, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af011280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.969891786575317, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 73.24347826086957, "ram_util_percent": 85.75652173913043}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.26982153184002355, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 3.3143187189859056, "policy_loss": 0.0012157102029218719, "vf_loss": 3.3107034014646337, "vf_explained_var": 0.0008019088121949049, "kl": 0.01199803387731552, "entropy": 1.5842328220448165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.126979793024757, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 4.65623898531394, "policy_loss": 0.002059947171682127, "vf_loss": 4.651130797497179, "vf_explained_var": 0.010460340945178238, "kl": 0.015241221475984595, "entropy": 1.589189181125984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -160.0, "episode_reward_mean": 7.055555555555555, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -312.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 156.0}, "policy_reward_mean": {"prey_policy": -29.541666666666668, "predator_policy": 33.06944444444444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.0, 31.0, 180.0, -63.0, -33.0, 183.0, 66.0, -35.0, 87.0, -31.0, 29.0, -40.0, 29.0, 41.0, 2.0, 52.0, -1.0, 130.0, 2.0, 0.0, -112.0, 0.0, 200.0, -160.0, -118.0, 159.0, -50.0, -133.0, 11.0, -11.0, 98.0, -1.0, -35.0, 19.0, -22.0, -116.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-241.0, 13.0, 12.0, 15.0, 171.0, 0.0, -163.0, 0.0, 16.0, -117.0, 110.0, 37.0, 103.0, -101.0, -60.0, -22.0, -81.0, 83.0, 0.0, -86.0, -95.0, 54.0, -78.0, -2.0, -180.0, 119.0, -157.0, 69.0, 0.0, 2.0, -5.0, 7.0, 6.0, -92.0, -26.0, 141.0, 0.0, 2.0, 0.0, 0.0, -78.0, -181.0, 0.0, 0.0, 200.0, 0.0, -77.0, -312.0, -226.0, -75.0, 127.0, 32.0, -36.0, -66.0, -137.0, -98.0, -9.0, 0.0, -24.0, 1.0, 37.0, 43.0, -75.0, 15.0, -56.0, -179.0, -40.0, -38.0, -48.0, 0.0, -151.0, -130.0], "policy_predator_policy_reward": [124.0, 0.0, 4.0, 0.0, 0.0, 9.0, 0.0, 100.0, 68.0, 0.0, 4.0, 32.0, 0.0, 64.0, 40.0, 7.0, 7.0, 78.0, 53.0, 2.0, 70.0, 0.0, 37.0, 3.0, 0.0, 90.0, 48.0, 81.0, 0.0, 0.0, 48.0, 2.0, 16.0, 69.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 115.0, 32.0, 0.0, 0.0, 0.0, 0.0, 156.0, 73.0, 66.0, 117.0, 0.0, 0.0, 33.0, 19.0, 0.0, 102.0, 20.0, 0.0, 0.0, 12.0, 2.0, 16.0, 6.0, 53.0, 131.0, 69.0, 60.0, 37.0, 26.0, 0.0, 114.0, 51.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0299536643744092, "mean_inference_ms": 2.675311709085598, "mean_action_processing_ms": 0.4397273021915098, "mean_env_wait_ms": 0.35204903895072015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008054574330647787, "StateBufferConnector_ms": 0.003815028402540419, "ViewRequirementAgentConnector_ms": 0.31738943523830837}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -160.0, "episode_return_mean": 7.055555555555555, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.51656011634955, "num_env_steps_trained_throughput_per_sec": 195.51656011634955, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 18170.397, "restore_workers_time_ms": 0.215, "training_step_time_ms": 18170.009, "sample_time_ms": 2616.156, "learn_time_ms": 15524.784, "learn_throughput": 257.653, "synch_weights_time_ms": 27.375}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "e1352_00000", "date": "2024-08-13_16-38-33", "timestamp": 1723581513, "time_this_iter_s": 20.632029056549072, "time_total_s": 36.60192084312439, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d5ed3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.60192084312439, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 90.25999999999999, "ram_util_percent": 85.20285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38380444788980106, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 2.626947958948751, "policy_loss": -0.0008399499075181743, "vf_loss": 2.6251260623099313, "vf_explained_var": 0.0027557955217109155, "kl": 0.013309256395359867, "entropy": 1.5819170645935825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7187523139453439, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 3.595646820812629, "policy_loss": 6.835273880925443e-05, "vf_loss": 3.591787807146708, "vf_explained_var": 0.01549237398874192, "kl": 0.018953278531538418, "entropy": 1.5727767893876978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -160.0, "episode_reward_mean": -0.7037037037037037, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -312.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 156.0}, "policy_reward_mean": {"prey_policy": -29.25925925925926, "predator_policy": 28.90740740740741}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.0, 31.0, 180.0, -63.0, -33.0, 183.0, 66.0, -35.0, 87.0, -31.0, 29.0, -40.0, 29.0, 41.0, 2.0, 52.0, -1.0, 130.0, 2.0, 0.0, -112.0, 0.0, 200.0, -160.0, -118.0, 159.0, -50.0, -133.0, 11.0, -11.0, 98.0, -1.0, -35.0, 19.0, -22.0, -116.0, -32.0, 61.0, 55.0, 0.0, -21.0, 0.0, -3.0, -36.0, -113.0, 11.0, 17.0, -23.0, -101.0, 13.0, 84.0, -31.0, -136.0, -37.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-241.0, 13.0, 12.0, 15.0, 171.0, 0.0, -163.0, 0.0, 16.0, -117.0, 110.0, 37.0, 103.0, -101.0, -60.0, -22.0, -81.0, 83.0, 0.0, -86.0, -95.0, 54.0, -78.0, -2.0, -180.0, 119.0, -157.0, 69.0, 0.0, 2.0, -5.0, 7.0, 6.0, -92.0, -26.0, 141.0, 0.0, 2.0, 0.0, 0.0, -78.0, -181.0, 0.0, 0.0, 200.0, 0.0, -77.0, -312.0, -226.0, -75.0, 127.0, 32.0, -36.0, -66.0, -137.0, -98.0, -9.0, 0.0, -24.0, 1.0, 37.0, 43.0, -75.0, 15.0, -56.0, -179.0, -40.0, -38.0, -48.0, 0.0, -151.0, -130.0, 0.0, -65.0, 35.0, 23.0, 60.0, -10.0, 0.0, 0.0, 0.0, -42.0, 0.0, 0.0, 0.0, -6.0, 0.0, -72.0, -62.0, -110.0, 28.0, -68.0, -31.0, -36.0, 0.0, -46.0, -101.0, -164.0, 6.0, 0.0, -7.0, 32.0, -70.0, 0.0, -190.0, -60.0, -3.0, -74.0], "policy_predator_policy_reward": [124.0, 0.0, 4.0, 0.0, 0.0, 9.0, 0.0, 100.0, 68.0, 0.0, 4.0, 32.0, 0.0, 64.0, 40.0, 7.0, 7.0, 78.0, 53.0, 2.0, 70.0, 0.0, 37.0, 3.0, 0.0, 90.0, 48.0, 81.0, 0.0, 0.0, 48.0, 2.0, 16.0, 69.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 115.0, 32.0, 0.0, 0.0, 0.0, 0.0, 156.0, 73.0, 66.0, 117.0, 0.0, 0.0, 33.0, 19.0, 0.0, 102.0, 20.0, 0.0, 0.0, 12.0, 2.0, 16.0, 6.0, 53.0, 131.0, 69.0, 60.0, 37.0, 26.0, 0.0, 114.0, 51.0, 0.0, 33.0, 3.0, 0.0, 5.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 3.0, 36.0, 0.0, 59.0, 0.0, 17.0, 34.0, 70.0, 14.0, 0.0, 23.0, 144.0, 20.0, 7.0, 0.0, 22.0, 37.0, 0.0, 39.0, 0.0, 114.0, 3.0, 37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1213709036094643, "mean_inference_ms": 2.89103079054666, "mean_action_processing_ms": 0.4595716725367442, "mean_env_wait_ms": 0.384423198314047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010336107677883573, "StateBufferConnector_ms": 0.004524654812282986, "ViewRequirementAgentConnector_ms": 0.331864975116871}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -160.0, "episode_return_mean": -0.7037037037037037, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.43117370838627, "num_env_steps_trained_throughput_per_sec": 248.43117370838627, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 17480.615, "restore_workers_time_ms": 0.152, "training_step_time_ms": 17480.334, "sample_time_ms": 2698.656, "learn_time_ms": 14756.08, "learn_throughput": 271.075, "synch_weights_time_ms": 23.3}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "e1352_00000", "date": "2024-08-13_16-38-49", "timestamp": 1723581529, "time_this_iter_s": 16.188283681869507, "time_total_s": 52.7902045249939, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af032820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.7902045249939, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 83.0391304347826, "ram_util_percent": 84.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47679159378721603, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 3.7216939507338105, "policy_loss": -0.0013367269929774382, "vf_loss": 3.720007553807011, "vf_explained_var": 0.0028001354484961777, "kl": 0.015115650508903655, "entropy": 1.578830049340687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8738700316460044, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 5.649532988714793, "policy_loss": 0.0027380154140431573, "vf_loss": 5.641772702762059, "vf_explained_var": 0.016085523619222893, "kl": 0.025111337277103567, "entropy": 1.5543633697524903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 231.0, "episode_reward_min": -247.0, "episode_reward_mean": 6.861111111111111, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 164.0}, "policy_reward_mean": {"prey_policy": -25.208333333333332, "predator_policy": 28.63888888888889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.0, 31.0, 180.0, -63.0, -33.0, 183.0, 66.0, -35.0, 87.0, -31.0, 29.0, -40.0, 29.0, 41.0, 2.0, 52.0, -1.0, 130.0, 2.0, 0.0, -112.0, 0.0, 200.0, -160.0, -118.0, 159.0, -50.0, -133.0, 11.0, -11.0, 98.0, -1.0, -35.0, 19.0, -22.0, -116.0, -32.0, 61.0, 55.0, 0.0, -21.0, 0.0, -3.0, -36.0, -113.0, 11.0, 17.0, -23.0, -101.0, 13.0, 84.0, -31.0, -136.0, -37.0, -247.0, 169.0, -139.0, 93.0, 5.0, -26.0, 3.0, -61.0, -6.0, 110.0, -10.0, 231.0, 0.0, 56.0, 225.0, -48.0, 0.0, 177.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-241.0, 13.0, 12.0, 15.0, 171.0, 0.0, -163.0, 0.0, 16.0, -117.0, 110.0, 37.0, 103.0, -101.0, -60.0, -22.0, -81.0, 83.0, 0.0, -86.0, -95.0, 54.0, -78.0, -2.0, -180.0, 119.0, -157.0, 69.0, 0.0, 2.0, -5.0, 7.0, 6.0, -92.0, -26.0, 141.0, 0.0, 2.0, 0.0, 0.0, -78.0, -181.0, 0.0, 0.0, 200.0, 0.0, -77.0, -312.0, -226.0, -75.0, 127.0, 32.0, -36.0, -66.0, -137.0, -98.0, -9.0, 0.0, -24.0, 1.0, 37.0, 43.0, -75.0, 15.0, -56.0, -179.0, -40.0, -38.0, -48.0, 0.0, -151.0, -130.0, 0.0, -65.0, 35.0, 23.0, 60.0, -10.0, 0.0, 0.0, 0.0, -42.0, 0.0, 0.0, 0.0, -6.0, 0.0, -72.0, -62.0, -110.0, 28.0, -68.0, -31.0, -36.0, 0.0, -46.0, -101.0, -164.0, 6.0, 0.0, -7.0, 32.0, -70.0, 0.0, -190.0, -60.0, -3.0, -74.0, -260.0, -144.0, 14.0, 155.0, 0.0, -318.0, -97.0, 105.0, 0.0, -25.0, -137.0, 2.0, 1.0, 2.0, 0.0, -132.0, 0.0, -12.0, -9.0, -1.0, -20.0, 0.0, 82.0, 122.0, 31.0, -97.0, 4.0, 2.0, 161.0, 64.0, -86.0, -53.0, 0.0, 0.0, 92.0, 84.0], "policy_predator_policy_reward": [124.0, 0.0, 4.0, 0.0, 0.0, 9.0, 0.0, 100.0, 68.0, 0.0, 4.0, 32.0, 0.0, 64.0, 40.0, 7.0, 7.0, 78.0, 53.0, 2.0, 70.0, 0.0, 37.0, 3.0, 0.0, 90.0, 48.0, 81.0, 0.0, 0.0, 48.0, 2.0, 16.0, 69.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 115.0, 32.0, 0.0, 0.0, 0.0, 0.0, 156.0, 73.0, 66.0, 117.0, 0.0, 0.0, 33.0, 19.0, 0.0, 102.0, 20.0, 0.0, 0.0, 12.0, 2.0, 16.0, 6.0, 53.0, 131.0, 69.0, 60.0, 37.0, 26.0, 0.0, 114.0, 51.0, 0.0, 33.0, 3.0, 0.0, 5.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 3.0, 36.0, 0.0, 59.0, 0.0, 17.0, 34.0, 70.0, 14.0, 0.0, 23.0, 144.0, 20.0, 7.0, 0.0, 22.0, 37.0, 0.0, 39.0, 0.0, 114.0, 3.0, 37.0, 157.0, 0.0, 0.0, 0.0, 164.0, 15.0, 0.0, 85.0, 30.0, 0.0, 65.0, 44.0, 0.0, 0.0, 71.0, 0.0, 6.0, 0.0, 90.0, 30.0, 10.0, 0.0, 24.0, 3.0, 66.0, 0.0, 37.0, 13.0, 0.0, 0.0, 27.0, 64.0, 0.0, 0.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1411885116778508, "mean_inference_ms": 2.9391223907369244, "mean_action_processing_ms": 0.45915457465630855, "mean_env_wait_ms": 0.3929546740246856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014793044990963407, "StateBufferConnector_ms": 0.005541410711076524, "ViewRequirementAgentConnector_ms": 0.2963066101074219}, "num_episodes": 18, "episode_return_max": 231.0, "episode_return_min": -247.0, "episode_return_mean": 6.861111111111111, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.687657613818, "num_env_steps_trained_throughput_per_sec": 261.687657613818, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 16931.812, "restore_workers_time_ms": 0.118, "training_step_time_ms": 16931.588, "sample_time_ms": 2486.87, "learn_time_ms": 14416.698, "learn_throughput": 277.456, "synch_weights_time_ms": 25.865}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "e1352_00000", "date": "2024-08-13_16-39-05", "timestamp": 1723581545, "time_this_iter_s": 15.358069896697998, "time_total_s": 68.1482744216919, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af032af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.1482744216919, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 82.27727272727272, "ram_util_percent": 85.22272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.593908107162468, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 2.924067636204775, "policy_loss": -0.003996959115777697, "vf_loss": 2.924714335751912, "vf_explained_var": 0.009525564707145488, "kl": 0.01675127879619962, "entropy": 1.5445875078282028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1202909620666, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 6.1998305643677085, "policy_loss": 0.005337789585005749, "vf_loss": 6.186328834200662, "vf_explained_var": 0.042629341789023584, "kl": 0.02721309837753599, "entropy": 1.540663964092416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 258.0, "episode_reward_min": -247.0, "episode_reward_mean": 19.747474747474747, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 164.0}, "policy_reward_mean": {"prey_policy": -17.207070707070706, "predator_policy": 27.08080808080808}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.0, 31.0, 180.0, -63.0, -33.0, 183.0, 66.0, -35.0, 87.0, -31.0, 29.0, -40.0, 29.0, 41.0, 2.0, 52.0, -1.0, 130.0, 2.0, 0.0, -112.0, 0.0, 200.0, -160.0, -118.0, 159.0, -50.0, -133.0, 11.0, -11.0, 98.0, -1.0, -35.0, 19.0, -22.0, -116.0, -32.0, 61.0, 55.0, 0.0, -21.0, 0.0, -3.0, -36.0, -113.0, 11.0, 17.0, -23.0, -101.0, 13.0, 84.0, -31.0, -136.0, -37.0, -247.0, 169.0, -139.0, 93.0, 5.0, -26.0, 3.0, -61.0, -6.0, 110.0, -10.0, 231.0, 0.0, 56.0, 225.0, -48.0, 0.0, 177.0, 34.0, 67.0, 79.0, 0.0, 167.0, 233.0, 258.0, -52.0, 1.0, -5.0, 71.0, -67.0, 7.0, 211.0, 154.0, -11.0, 84.0, 148.0, -25.0, 61.0, -122.0, 74.0, 0.0, 23.0, -97.0, -8.0, 176.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-241.0, 13.0, 12.0, 15.0, 171.0, 0.0, -163.0, 0.0, 16.0, -117.0, 110.0, 37.0, 103.0, -101.0, -60.0, -22.0, -81.0, 83.0, 0.0, -86.0, -95.0, 54.0, -78.0, -2.0, -180.0, 119.0, -157.0, 69.0, 0.0, 2.0, -5.0, 7.0, 6.0, -92.0, -26.0, 141.0, 0.0, 2.0, 0.0, 0.0, -78.0, -181.0, 0.0, 0.0, 200.0, 0.0, -77.0, -312.0, -226.0, -75.0, 127.0, 32.0, -36.0, -66.0, -137.0, -98.0, -9.0, 0.0, -24.0, 1.0, 37.0, 43.0, -75.0, 15.0, -56.0, -179.0, -40.0, -38.0, -48.0, 0.0, -151.0, -130.0, 0.0, -65.0, 35.0, 23.0, 60.0, -10.0, 0.0, 0.0, 0.0, -42.0, 0.0, 0.0, 0.0, -6.0, 0.0, -72.0, -62.0, -110.0, 28.0, -68.0, -31.0, -36.0, 0.0, -46.0, -101.0, -164.0, 6.0, 0.0, -7.0, 32.0, -70.0, 0.0, -190.0, -60.0, -3.0, -74.0, -260.0, -144.0, 14.0, 155.0, 0.0, -318.0, -97.0, 105.0, 0.0, -25.0, -137.0, 2.0, 1.0, 2.0, 0.0, -132.0, 0.0, -12.0, -9.0, -1.0, -20.0, 0.0, 82.0, 122.0, 31.0, -97.0, 4.0, 2.0, 161.0, 64.0, -86.0, -53.0, 0.0, 0.0, 92.0, 84.0, -31.0, 0.0, 0.0, 25.0, 0.0, 55.0, 0.0, 0.0, 1.0, 166.0, 126.0, 106.0, 121.0, 106.0, -34.0, -91.0, 1.0, 0.0, 0.0, -10.0, 47.0, -63.0, -189.0, 0.0, -25.0, -7.0, 130.0, 73.0, 123.0, -2.0, -14.0, -126.0, 15.0, 48.0, 73.0, 75.0, 0.0, -50.0, 0.0, 45.0, -8.0, -313.0, 0.0, 74.0, 0.0, 0.0, 0.0, 23.0, -144.0, -126.0, -93.0, -44.0, 158.0, 2.0], "policy_predator_policy_reward": [124.0, 0.0, 4.0, 0.0, 0.0, 9.0, 0.0, 100.0, 68.0, 0.0, 4.0, 32.0, 0.0, 64.0, 40.0, 7.0, 7.0, 78.0, 53.0, 2.0, 70.0, 0.0, 37.0, 3.0, 0.0, 90.0, 48.0, 81.0, 0.0, 0.0, 48.0, 2.0, 16.0, 69.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 115.0, 32.0, 0.0, 0.0, 0.0, 0.0, 156.0, 73.0, 66.0, 117.0, 0.0, 0.0, 33.0, 19.0, 0.0, 102.0, 20.0, 0.0, 0.0, 12.0, 2.0, 16.0, 6.0, 53.0, 131.0, 69.0, 60.0, 37.0, 26.0, 0.0, 114.0, 51.0, 0.0, 33.0, 3.0, 0.0, 5.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 3.0, 36.0, 0.0, 59.0, 0.0, 17.0, 34.0, 70.0, 14.0, 0.0, 23.0, 144.0, 20.0, 7.0, 0.0, 22.0, 37.0, 0.0, 39.0, 0.0, 114.0, 3.0, 37.0, 157.0, 0.0, 0.0, 0.0, 164.0, 15.0, 0.0, 85.0, 30.0, 0.0, 65.0, 44.0, 0.0, 0.0, 71.0, 0.0, 6.0, 0.0, 90.0, 30.0, 10.0, 0.0, 24.0, 3.0, 66.0, 0.0, 37.0, 13.0, 0.0, 0.0, 27.0, 64.0, 0.0, 0.0, 0.0, 1.0, 58.0, 7.0, 41.0, 1.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 31.0, 0.0, 21.0, 52.0, 0.0, 0.0, 5.0, 0.0, 87.0, 0.0, 46.0, 76.0, 32.0, 7.0, 7.0, 1.0, 30.0, 3.0, 63.0, 66.0, 21.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 16.0, 152.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 72.0, 101.0, 122.0, 7.0, 10.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.136515748990704, "mean_inference_ms": 2.9231826766124596, "mean_action_processing_ms": 0.4518619034087588, "mean_env_wait_ms": 0.39307701691586616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0152715528854216, "StateBufferConnector_ms": 0.005774305324361782, "ViewRequirementAgentConnector_ms": 0.2502135556153577}, "num_episodes": 27, "episode_return_max": 258.0, "episode_return_min": -247.0, "episode_return_mean": 19.747474747474747, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.02865664651196, "num_env_steps_trained_throughput_per_sec": 255.02865664651196, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 16682.354, "restore_workers_time_ms": 0.098, "training_step_time_ms": 16682.164, "sample_time_ms": 2324.576, "learn_time_ms": 14332.26, "learn_throughput": 279.091, "synch_weights_time_ms": 23.286}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "e1352_00000", "date": "2024-08-13_16-39-21", "timestamp": 1723581561, "time_this_iter_s": 15.706953048706055, "time_total_s": 83.85522747039795, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d65fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 83.85522747039795, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 84.93181818181816, "ram_util_percent": 86.0909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7983384517529023, "cur_kl_coeff": 0.2, "cur_lr": 0.009999999999999998, "total_loss": 2.3980243872082423, "policy_loss": 0.00027523285576275415, "vf_loss": 2.39365133936443, "vf_explained_var": 0.012317715372358049, "kl": 0.020489091773021918, "entropy": 1.5399397521422653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5329329803507163, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 6.998758232530463, "policy_loss": 0.0029978888774556773, "vf_loss": 6.986264684969786, "vf_explained_var": 0.09708561200313467, "kl": 0.021101476539784003, "entropy": 1.5304388811348608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 258.0, "episode_reward_min": -247.0, "episode_reward_mean": 28.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 164.0}, "policy_reward_mean": {"prey_policy": -11.62, "predator_policy": 25.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0, 2.0, 0.0, -112.0, 0.0, 200.0, -160.0, -118.0, 159.0, -50.0, -133.0, 11.0, -11.0, 98.0, -1.0, -35.0, 19.0, -22.0, -116.0, -32.0, 61.0, 55.0, 0.0, -21.0, 0.0, -3.0, -36.0, -113.0, 11.0, 17.0, -23.0, -101.0, 13.0, 84.0, -31.0, -136.0, -37.0, -247.0, 169.0, -139.0, 93.0, 5.0, -26.0, 3.0, -61.0, -6.0, 110.0, -10.0, 231.0, 0.0, 56.0, 225.0, -48.0, 0.0, 177.0, 34.0, 67.0, 79.0, 0.0, 167.0, 233.0, 258.0, -52.0, 1.0, -5.0, 71.0, -67.0, 7.0, 211.0, 154.0, -11.0, 84.0, 148.0, -25.0, 61.0, -122.0, 74.0, 0.0, 23.0, -97.0, -8.0, 176.0, -17.0, -75.0, 200.0, 60.0, 48.0, 14.0, 176.0, 50.0, 151.0, 215.0, 0.0, 109.0, 22.0, 91.0, 110.0, 111.0, 38.0, -30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.0, 141.0, 0.0, 2.0, 0.0, 0.0, -78.0, -181.0, 0.0, 0.0, 200.0, 0.0, -77.0, -312.0, -226.0, -75.0, 127.0, 32.0, -36.0, -66.0, -137.0, -98.0, -9.0, 0.0, -24.0, 1.0, 37.0, 43.0, -75.0, 15.0, -56.0, -179.0, -40.0, -38.0, -48.0, 0.0, -151.0, -130.0, 0.0, -65.0, 35.0, 23.0, 60.0, -10.0, 0.0, 0.0, 0.0, -42.0, 0.0, 0.0, 0.0, -6.0, 0.0, -72.0, -62.0, -110.0, 28.0, -68.0, -31.0, -36.0, 0.0, -46.0, -101.0, -164.0, 6.0, 0.0, -7.0, 32.0, -70.0, 0.0, -190.0, -60.0, -3.0, -74.0, -260.0, -144.0, 14.0, 155.0, 0.0, -318.0, -97.0, 105.0, 0.0, -25.0, -137.0, 2.0, 1.0, 2.0, 0.0, -132.0, 0.0, -12.0, -9.0, -1.0, -20.0, 0.0, 82.0, 122.0, 31.0, -97.0, 4.0, 2.0, 161.0, 64.0, -86.0, -53.0, 0.0, 0.0, 92.0, 84.0, -31.0, 0.0, 0.0, 25.0, 0.0, 55.0, 0.0, 0.0, 1.0, 166.0, 126.0, 106.0, 121.0, 106.0, -34.0, -91.0, 1.0, 0.0, 0.0, -10.0, 47.0, -63.0, -189.0, 0.0, -25.0, -7.0, 130.0, 73.0, 123.0, -2.0, -14.0, -126.0, 15.0, 48.0, 73.0, 75.0, 0.0, -50.0, 0.0, 45.0, -8.0, -313.0, 0.0, 74.0, 0.0, 0.0, 0.0, 23.0, -144.0, -126.0, -93.0, -44.0, 158.0, 2.0, -2.0, -50.0, -37.0, -85.0, 24.0, 137.0, 63.0, -18.0, 21.0, -19.0, -68.0, -6.0, 45.0, 99.0, -62.0, 34.0, 42.0, 85.0, 101.0, 100.0, -21.0, -16.0, 22.0, 82.0, -134.0, 54.0, 69.0, -49.0, 0.0, 103.0, -158.0, 167.0, 3.0, 2.0, -156.0, 48.0], "policy_predator_policy_reward": [0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 115.0, 32.0, 0.0, 0.0, 0.0, 0.0, 156.0, 73.0, 66.0, 117.0, 0.0, 0.0, 33.0, 19.0, 0.0, 102.0, 20.0, 0.0, 0.0, 12.0, 2.0, 16.0, 6.0, 53.0, 131.0, 69.0, 60.0, 37.0, 26.0, 0.0, 114.0, 51.0, 0.0, 33.0, 3.0, 0.0, 5.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 3.0, 36.0, 0.0, 59.0, 0.0, 17.0, 34.0, 70.0, 14.0, 0.0, 23.0, 144.0, 20.0, 7.0, 0.0, 22.0, 37.0, 0.0, 39.0, 0.0, 114.0, 3.0, 37.0, 157.0, 0.0, 0.0, 0.0, 164.0, 15.0, 0.0, 85.0, 30.0, 0.0, 65.0, 44.0, 0.0, 0.0, 71.0, 0.0, 6.0, 0.0, 90.0, 30.0, 10.0, 0.0, 24.0, 3.0, 66.0, 0.0, 37.0, 13.0, 0.0, 0.0, 27.0, 64.0, 0.0, 0.0, 0.0, 1.0, 58.0, 7.0, 41.0, 1.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 31.0, 0.0, 21.0, 52.0, 0.0, 0.0, 5.0, 0.0, 87.0, 0.0, 46.0, 76.0, 32.0, 7.0, 7.0, 1.0, 30.0, 3.0, 63.0, 66.0, 21.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 16.0, 152.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 72.0, 101.0, 122.0, 7.0, 10.0, 6.0, 35.0, 0.0, 47.0, 0.0, 0.0, 39.0, 15.0, 0.0, 46.0, 0.0, 11.0, 77.0, 7.0, 25.0, 3.0, 75.0, 19.0, 5.0, 3.0, 11.0, 29.0, 8.0, 0.0, 5.0, 4.0, 98.0, 31.0, 40.0, 0.0, 7.0, 102.0, 0.0, 23.0, 10.0, 0.0, 78.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1751027478177232, "mean_inference_ms": 2.997450972973877, "mean_action_processing_ms": 0.4579223382453875, "mean_env_wait_ms": 0.4038820365897976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014578819274902344, "StateBufferConnector_ms": 0.0057021379470825195, "ViewRequirementAgentConnector_ms": 0.2478640079498291}, "num_episodes": 18, "episode_return_max": 258.0, "episode_return_min": -247.0, "episode_return_mean": 28.35, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.10887064633815, "num_env_steps_trained_throughput_per_sec": 255.10887064633815, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 16515.226, "restore_workers_time_ms": 0.084, "training_step_time_ms": 16515.061, "sample_time_ms": 2191.851, "learn_time_ms": 14298.944, "learn_throughput": 279.741, "synch_weights_time_ms": 22.402}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "e1352_00000", "date": "2024-08-13_16-39-36", "timestamp": 1723581576, "time_this_iter_s": 15.708791017532349, "time_total_s": 99.5640184879303, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15c2790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 99.5640184879303, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 83.03478260869565, "ram_util_percent": 85.32173913043479}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8843394316929989, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 3.8044997133275187, "policy_loss": -0.0009940839885049081, "vf_loss": 3.799918207037386, "vf_explained_var": 0.12036690743511946, "kl": 0.01858528398367559, "entropy": 1.5477246931621007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7088039742733436, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 6.565050174319555, "policy_loss": 0.003491170786902624, "vf_loss": 6.547655074810856, "vf_explained_var": -0.02395740028411623, "kl": 0.02059840324915646, "entropy": 1.4903720171363266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 258.0, "episode_reward_min": -247.0, "episode_reward_mean": 40.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 167.0, "predator_policy": 164.0}, "policy_reward_mean": {"prey_policy": -5.3, "predator_policy": 25.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.0, -32.0, 61.0, 55.0, 0.0, -21.0, 0.0, -3.0, -36.0, -113.0, 11.0, 17.0, -23.0, -101.0, 13.0, 84.0, -31.0, -136.0, -37.0, -247.0, 169.0, -139.0, 93.0, 5.0, -26.0, 3.0, -61.0, -6.0, 110.0, -10.0, 231.0, 0.0, 56.0, 225.0, -48.0, 0.0, 177.0, 34.0, 67.0, 79.0, 0.0, 167.0, 233.0, 258.0, -52.0, 1.0, -5.0, 71.0, -67.0, 7.0, 211.0, 154.0, -11.0, 84.0, 148.0, -25.0, 61.0, -122.0, 74.0, 0.0, 23.0, -97.0, -8.0, 176.0, -17.0, -75.0, 200.0, 60.0, 48.0, 14.0, 176.0, 50.0, 151.0, 215.0, 0.0, 109.0, 22.0, 91.0, 110.0, 111.0, 38.0, -30.0, 90.0, 94.0, 46.0, 137.0, 80.0, -53.0, 107.0, 138.0, 239.0, 18.0, 56.0, 12.0, -45.0, 47.0, 38.0, 35.0, 114.0, 20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-151.0, -130.0, 0.0, -65.0, 35.0, 23.0, 60.0, -10.0, 0.0, 0.0, 0.0, -42.0, 0.0, 0.0, 0.0, -6.0, 0.0, -72.0, -62.0, -110.0, 28.0, -68.0, -31.0, -36.0, 0.0, -46.0, -101.0, -164.0, 6.0, 0.0, -7.0, 32.0, -70.0, 0.0, -190.0, -60.0, -3.0, -74.0, -260.0, -144.0, 14.0, 155.0, 0.0, -318.0, -97.0, 105.0, 0.0, -25.0, -137.0, 2.0, 1.0, 2.0, 0.0, -132.0, 0.0, -12.0, -9.0, -1.0, -20.0, 0.0, 82.0, 122.0, 31.0, -97.0, 4.0, 2.0, 161.0, 64.0, -86.0, -53.0, 0.0, 0.0, 92.0, 84.0, -31.0, 0.0, 0.0, 25.0, 0.0, 55.0, 0.0, 0.0, 1.0, 166.0, 126.0, 106.0, 121.0, 106.0, -34.0, -91.0, 1.0, 0.0, 0.0, -10.0, 47.0, -63.0, -189.0, 0.0, -25.0, -7.0, 130.0, 73.0, 123.0, -2.0, -14.0, -126.0, 15.0, 48.0, 73.0, 75.0, 0.0, -50.0, 0.0, 45.0, -8.0, -313.0, 0.0, 74.0, 0.0, 0.0, 0.0, 23.0, -144.0, -126.0, -93.0, -44.0, 158.0, 2.0, -2.0, -50.0, -37.0, -85.0, 24.0, 137.0, 63.0, -18.0, 21.0, -19.0, -68.0, -6.0, 45.0, 99.0, -62.0, 34.0, 42.0, 85.0, 101.0, 100.0, -21.0, -16.0, 22.0, 82.0, -134.0, 54.0, 69.0, -49.0, 0.0, 103.0, -158.0, 167.0, 3.0, 2.0, -156.0, 48.0, 35.0, 27.0, 3.0, 0.0, 2.0, 33.0, 121.0, 7.0, 0.0, 80.0, -155.0, 0.0, -58.0, 130.0, 26.0, 79.0, 83.0, 156.0, -88.0, -14.0, 13.0, 3.0, -103.0, -34.0, -115.0, -100.0, 47.0, 0.0, -12.0, 0.0, -45.0, 13.0, -79.0, 92.0, -72.0, 6.0], "policy_predator_policy_reward": [114.0, 51.0, 0.0, 33.0, 3.0, 0.0, 5.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 3.0, 36.0, 0.0, 59.0, 0.0, 17.0, 34.0, 70.0, 14.0, 0.0, 23.0, 144.0, 20.0, 7.0, 0.0, 22.0, 37.0, 0.0, 39.0, 0.0, 114.0, 3.0, 37.0, 157.0, 0.0, 0.0, 0.0, 164.0, 15.0, 0.0, 85.0, 30.0, 0.0, 65.0, 44.0, 0.0, 0.0, 71.0, 0.0, 6.0, 0.0, 90.0, 30.0, 10.0, 0.0, 24.0, 3.0, 66.0, 0.0, 37.0, 13.0, 0.0, 0.0, 27.0, 64.0, 0.0, 0.0, 0.0, 1.0, 58.0, 7.0, 41.0, 1.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 31.0, 0.0, 21.0, 52.0, 0.0, 0.0, 5.0, 0.0, 87.0, 0.0, 46.0, 76.0, 32.0, 7.0, 7.0, 1.0, 30.0, 3.0, 63.0, 66.0, 21.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 16.0, 152.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 72.0, 101.0, 122.0, 7.0, 10.0, 6.0, 35.0, 0.0, 47.0, 0.0, 0.0, 39.0, 15.0, 0.0, 46.0, 0.0, 11.0, 77.0, 7.0, 25.0, 3.0, 75.0, 19.0, 5.0, 3.0, 11.0, 29.0, 8.0, 0.0, 5.0, 4.0, 98.0, 31.0, 40.0, 0.0, 7.0, 102.0, 0.0, 23.0, 10.0, 0.0, 78.0, 25.0, 3.0, 77.0, 14.0, 0.0, 11.0, 0.0, 9.0, 0.0, 0.0, 78.0, 24.0, 29.0, 6.0, 0.0, 33.0, 0.0, 0.0, 50.0, 70.0, 0.0, 40.0, 120.0, 29.0, 81.0, 89.0, 0.0, 0.0, 50.0, 0.0, 47.0, 20.0, 18.0, 83.0, 10.0, 76.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1393012054521157, "mean_inference_ms": 2.9177359961424294, "mean_action_processing_ms": 0.4393469807793224, "mean_env_wait_ms": 0.3974240152621749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013761520385742188, "StateBufferConnector_ms": 0.005487203598022461, "ViewRequirementAgentConnector_ms": 0.17610704898834229}, "num_episodes": 18, "episode_return_max": 258.0, "episode_return_min": -247.0, "episode_return_mean": 40.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.71344355127997, "num_env_steps_trained_throughput_per_sec": 267.71344355127997, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 16290.387, "restore_workers_time_ms": 0.075, "training_step_time_ms": 16290.237, "sample_time_ms": 2091.442, "learn_time_ms": 14174.147, "learn_throughput": 282.204, "synch_weights_time_ms": 22.711}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "e1352_00000", "date": "2024-08-13_16-39-51", "timestamp": 1723581591, "time_this_iter_s": 15.01614499092102, "time_total_s": 114.58016347885132, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15c2820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 114.58016347885132, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 79.26190476190476, "ram_util_percent": 82.73809523809526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4555252364309377, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 2.0996475012214098, "policy_loss": -0.0023732177836810627, "vf_loss": 2.096710608844404, "vf_explained_var": 0.0144404807734111, "kl": 0.017700365041655296, "entropy": 1.5314481033219232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8016337166545253, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 6.432623359892103, "policy_loss": 0.0024170044245365907, "vf_loss": 6.411593259831585, "vf_explained_var": 0.051169323069708686, "kl": 0.018383311740994137, "entropy": 1.4764431754748026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 286.0, "episode_reward_min": -247.0, "episode_reward_mean": 58.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 167.0, "predator_policy": 164.0}, "policy_reward_mean": {"prey_policy": 3.915, "predator_policy": 25.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.0, -247.0, 169.0, -139.0, 93.0, 5.0, -26.0, 3.0, -61.0, -6.0, 110.0, -10.0, 231.0, 0.0, 56.0, 225.0, -48.0, 0.0, 177.0, 34.0, 67.0, 79.0, 0.0, 167.0, 233.0, 258.0, -52.0, 1.0, -5.0, 71.0, -67.0, 7.0, 211.0, 154.0, -11.0, 84.0, 148.0, -25.0, 61.0, -122.0, 74.0, 0.0, 23.0, -97.0, -8.0, 176.0, -17.0, -75.0, 200.0, 60.0, 48.0, 14.0, 176.0, 50.0, 151.0, 215.0, 0.0, 109.0, 22.0, 91.0, 110.0, 111.0, 38.0, -30.0, 90.0, 94.0, 46.0, 137.0, 80.0, -53.0, 107.0, 138.0, 239.0, 18.0, 56.0, 12.0, -45.0, 47.0, 38.0, 35.0, 114.0, 20.0, 123.0, -8.0, 141.0, 92.0, 55.0, 100.0, -147.0, 106.0, 286.0, 163.0, 58.0, 40.0, 115.0, 55.0, 7.0, 193.0, 11.0, 44.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0, -74.0, -260.0, -144.0, 14.0, 155.0, 0.0, -318.0, -97.0, 105.0, 0.0, -25.0, -137.0, 2.0, 1.0, 2.0, 0.0, -132.0, 0.0, -12.0, -9.0, -1.0, -20.0, 0.0, 82.0, 122.0, 31.0, -97.0, 4.0, 2.0, 161.0, 64.0, -86.0, -53.0, 0.0, 0.0, 92.0, 84.0, -31.0, 0.0, 0.0, 25.0, 0.0, 55.0, 0.0, 0.0, 1.0, 166.0, 126.0, 106.0, 121.0, 106.0, -34.0, -91.0, 1.0, 0.0, 0.0, -10.0, 47.0, -63.0, -189.0, 0.0, -25.0, -7.0, 130.0, 73.0, 123.0, -2.0, -14.0, -126.0, 15.0, 48.0, 73.0, 75.0, 0.0, -50.0, 0.0, 45.0, -8.0, -313.0, 0.0, 74.0, 0.0, 0.0, 0.0, 23.0, -144.0, -126.0, -93.0, -44.0, 158.0, 2.0, -2.0, -50.0, -37.0, -85.0, 24.0, 137.0, 63.0, -18.0, 21.0, -19.0, -68.0, -6.0, 45.0, 99.0, -62.0, 34.0, 42.0, 85.0, 101.0, 100.0, -21.0, -16.0, 22.0, 82.0, -134.0, 54.0, 69.0, -49.0, 0.0, 103.0, -158.0, 167.0, 3.0, 2.0, -156.0, 48.0, 35.0, 27.0, 3.0, 0.0, 2.0, 33.0, 121.0, 7.0, 0.0, 80.0, -155.0, 0.0, -58.0, 130.0, 26.0, 79.0, 83.0, 156.0, -88.0, -14.0, 13.0, 3.0, -103.0, -34.0, -115.0, -100.0, 47.0, 0.0, -12.0, 0.0, -45.0, 13.0, -79.0, 92.0, -72.0, 6.0, 42.0, 13.0, -44.0, -14.0, 110.0, 1.0, -138.0, 112.0, -22.0, 11.0, 70.0, 22.0, -80.0, -219.0, 80.0, -5.0, 165.0, 121.0, 37.0, 102.0, 75.0, -79.0, 20.0, -27.0, -19.0, 109.0, 0.0, 33.0, -67.0, 0.0, 115.0, 78.0, -9.0, 0.0, 75.0, -62.0], "policy_predator_policy_reward": [3.0, 37.0, 157.0, 0.0, 0.0, 0.0, 164.0, 15.0, 0.0, 85.0, 30.0, 0.0, 65.0, 44.0, 0.0, 0.0, 71.0, 0.0, 6.0, 0.0, 90.0, 30.0, 10.0, 0.0, 24.0, 3.0, 66.0, 0.0, 37.0, 13.0, 0.0, 0.0, 27.0, 64.0, 0.0, 0.0, 0.0, 1.0, 58.0, 7.0, 41.0, 1.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 31.0, 0.0, 21.0, 52.0, 0.0, 0.0, 5.0, 0.0, 87.0, 0.0, 46.0, 76.0, 32.0, 7.0, 7.0, 1.0, 30.0, 3.0, 63.0, 66.0, 21.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 16.0, 152.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 72.0, 101.0, 122.0, 7.0, 10.0, 6.0, 35.0, 0.0, 47.0, 0.0, 0.0, 39.0, 15.0, 0.0, 46.0, 0.0, 11.0, 77.0, 7.0, 25.0, 3.0, 75.0, 19.0, 5.0, 3.0, 11.0, 29.0, 8.0, 0.0, 5.0, 4.0, 98.0, 31.0, 40.0, 0.0, 7.0, 102.0, 0.0, 23.0, 10.0, 0.0, 78.0, 25.0, 3.0, 77.0, 14.0, 0.0, 11.0, 0.0, 9.0, 0.0, 0.0, 78.0, 24.0, 29.0, 6.0, 0.0, 33.0, 0.0, 0.0, 50.0, 70.0, 0.0, 40.0, 120.0, 29.0, 81.0, 89.0, 0.0, 0.0, 50.0, 0.0, 47.0, 20.0, 18.0, 83.0, 10.0, 76.0, 5.0, 63.0, 0.0, 50.0, 7.0, 23.0, 16.0, 102.0, 66.0, 0.0, 8.0, 0.0, 40.0, 112.0, 0.0, 31.0, 0.0, 0.0, 0.0, 24.0, 8.0, 54.0, 0.0, 47.0, 11.0, 14.0, 22.0, 0.0, 61.0, 13.0, 0.0, 0.0, 1.0, 19.0, 0.0, 31.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.08281938115156, "mean_inference_ms": 2.774327025734865, "mean_action_processing_ms": 0.4180451333174291, "mean_env_wait_ms": 0.380281673184855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0120011568069458, "StateBufferConnector_ms": 0.006115913391113281, "ViewRequirementAgentConnector_ms": 0.14329516887664795}, "num_episodes": 18, "episode_return_max": 286.0, "episode_return_min": -247.0, "episode_return_mean": 58.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.63054107224286, "num_env_steps_trained_throughput_per_sec": 259.63054107224286, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 16179.904, "restore_workers_time_ms": 0.067, "training_step_time_ms": 16179.765, "sample_time_ms": 2025.842, "learn_time_ms": 14126.694, "learn_throughput": 283.152, "synch_weights_time_ms": 25.345}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "e1352_00000", "date": "2024-08-13_16-40-07", "timestamp": 1723581607, "time_this_iter_s": 15.442355871200562, "time_total_s": 130.02251935005188, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15c24c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 130.02251935005188, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 85.78181818181818, "ram_util_percent": 84.1590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5220041530472892, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 2.1127396261881266, "policy_loss": -0.000983620397303076, "vf_loss": 2.1082199436331552, "vf_explained_var": 0.0261975349887969, "kl": 0.01834435488893028, "entropy": 1.4865822744117212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.040677467303932, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 5.654812835007117, "policy_loss": -9.077558695540699e-05, "vf_loss": 5.639752138480938, "vf_explained_var": 0.056398729388675996, "kl": 0.014964423323927594, "entropy": 1.4547372182841023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 316.0, "episode_reward_min": -147.0, "episode_reward_mean": 63.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -313.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 152.0}, "policy_reward_mean": {"prey_policy": 5.885, "predator_policy": 25.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 167.0, 233.0, 258.0, -52.0, 1.0, -5.0, 71.0, -67.0, 7.0, 211.0, 154.0, -11.0, 84.0, 148.0, -25.0, 61.0, -122.0, 74.0, 0.0, 23.0, -97.0, -8.0, 176.0, -17.0, -75.0, 200.0, 60.0, 48.0, 14.0, 176.0, 50.0, 151.0, 215.0, 0.0, 109.0, 22.0, 91.0, 110.0, 111.0, 38.0, -30.0, 90.0, 94.0, 46.0, 137.0, 80.0, -53.0, 107.0, 138.0, 239.0, 18.0, 56.0, 12.0, -45.0, 47.0, 38.0, 35.0, 114.0, 20.0, 123.0, -8.0, 141.0, 92.0, 55.0, 100.0, -147.0, 106.0, 286.0, 163.0, 58.0, 40.0, 115.0, 55.0, 7.0, 193.0, 11.0, 44.0, 6.0, -43.0, 121.0, 43.0, 316.0, -142.0, 145.0, 111.0, -110.0, -41.0, 88.0, 211.0, 7.0, -85.0, 1.0, 0.0, -60.0, 137.0, 221.0, 85.0, 120.0, 28.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 1.0, 166.0, 126.0, 106.0, 121.0, 106.0, -34.0, -91.0, 1.0, 0.0, 0.0, -10.0, 47.0, -63.0, -189.0, 0.0, -25.0, -7.0, 130.0, 73.0, 123.0, -2.0, -14.0, -126.0, 15.0, 48.0, 73.0, 75.0, 0.0, -50.0, 0.0, 45.0, -8.0, -313.0, 0.0, 74.0, 0.0, 0.0, 0.0, 23.0, -144.0, -126.0, -93.0, -44.0, 158.0, 2.0, -2.0, -50.0, -37.0, -85.0, 24.0, 137.0, 63.0, -18.0, 21.0, -19.0, -68.0, -6.0, 45.0, 99.0, -62.0, 34.0, 42.0, 85.0, 101.0, 100.0, -21.0, -16.0, 22.0, 82.0, -134.0, 54.0, 69.0, -49.0, 0.0, 103.0, -158.0, 167.0, 3.0, 2.0, -156.0, 48.0, 35.0, 27.0, 3.0, 0.0, 2.0, 33.0, 121.0, 7.0, 0.0, 80.0, -155.0, 0.0, -58.0, 130.0, 26.0, 79.0, 83.0, 156.0, -88.0, -14.0, 13.0, 3.0, -103.0, -34.0, -115.0, -100.0, 47.0, 0.0, -12.0, 0.0, -45.0, 13.0, -79.0, 92.0, -72.0, 6.0, 42.0, 13.0, -44.0, -14.0, 110.0, 1.0, -138.0, 112.0, -22.0, 11.0, 70.0, 22.0, -80.0, -219.0, 80.0, -5.0, 165.0, 121.0, 37.0, 102.0, 75.0, -79.0, 20.0, -27.0, -19.0, 109.0, 0.0, 33.0, -67.0, 0.0, 115.0, 78.0, -9.0, 0.0, 75.0, -62.0, 6.0, 0.0, -8.0, -70.0, -26.0, 75.0, 28.0, -65.0, 155.0, 161.0, -66.0, -240.0, -1.0, 66.0, 0.0, 68.0, -71.0, -196.0, -68.0, -14.0, 0.0, 83.0, 113.0, 62.0, -138.0, 74.0, -103.0, -97.0, -23.0, -29.0, 0.0, 0.0, -90.0, -110.0, -2.0, 126.0, 113.0, 99.0, -216.0, 193.0, 87.0, 15.0, 47.0, -42.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 31.0, 0.0, 21.0, 52.0, 0.0, 0.0, 5.0, 0.0, 87.0, 0.0, 46.0, 76.0, 32.0, 7.0, 7.0, 1.0, 30.0, 3.0, 63.0, 66.0, 21.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 16.0, 152.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 72.0, 101.0, 122.0, 7.0, 10.0, 6.0, 35.0, 0.0, 47.0, 0.0, 0.0, 39.0, 15.0, 0.0, 46.0, 0.0, 11.0, 77.0, 7.0, 25.0, 3.0, 75.0, 19.0, 5.0, 3.0, 11.0, 29.0, 8.0, 0.0, 5.0, 4.0, 98.0, 31.0, 40.0, 0.0, 7.0, 102.0, 0.0, 23.0, 10.0, 0.0, 78.0, 25.0, 3.0, 77.0, 14.0, 0.0, 11.0, 0.0, 9.0, 0.0, 0.0, 78.0, 24.0, 29.0, 6.0, 0.0, 33.0, 0.0, 0.0, 50.0, 70.0, 0.0, 40.0, 120.0, 29.0, 81.0, 89.0, 0.0, 0.0, 50.0, 0.0, 47.0, 20.0, 18.0, 83.0, 10.0, 76.0, 5.0, 63.0, 0.0, 50.0, 7.0, 23.0, 16.0, 102.0, 66.0, 0.0, 8.0, 0.0, 40.0, 112.0, 0.0, 31.0, 0.0, 0.0, 0.0, 24.0, 8.0, 54.0, 0.0, 47.0, 11.0, 14.0, 22.0, 0.0, 61.0, 13.0, 0.0, 0.0, 1.0, 19.0, 0.0, 31.0, 0.0, 0.0, 35.0, 0.0, 34.0, 38.0, 61.0, 19.0, 0.0, 0.0, 34.0, 130.0, 33.0, 47.0, 26.0, 17.0, 98.0, 59.0, 26.0, 15.0, 0.0, 5.0, 36.0, 0.0, 69.0, 2.0, 51.0, 64.0, 0.0, 53.0, 0.0, 0.0, 74.0, 66.0, 1.0, 12.0, 3.0, 6.0, 0.0, 108.0, 18.0, 0.0, 0.0, 23.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0303609026227698, "mean_inference_ms": 2.647737788741408, "mean_action_processing_ms": 0.3990858989619836, "mean_env_wait_ms": 0.3628194974181072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010320186614990234, "StateBufferConnector_ms": 0.004341006278991699, "ViewRequirementAgentConnector_ms": 0.12736976146697998}, "num_episodes": 22, "episode_return_max": 316.0, "episode_return_min": -147.0, "episode_return_mean": 63.2, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.9154986813639, "num_env_steps_trained_throughput_per_sec": 275.9154986813639, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 15992.937, "restore_workers_time_ms": 0.062, "training_step_time_ms": 15992.808, "sample_time_ms": 1985.221, "learn_time_ms": 13977.422, "learn_throughput": 286.176, "synch_weights_time_ms": 28.307}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "e1352_00000", "date": "2024-08-13_16-40-22", "timestamp": 1723581622, "time_this_iter_s": 14.564823865890503, "time_total_s": 144.58734321594238, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15cec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 144.58734321594238, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 83.35714285714286, "ram_util_percent": 82.84761904761903}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7029737934549019, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 2.014036904377912, "policy_loss": 0.0009152337780626362, "vf_loss": 2.007619234619948, "vf_explained_var": 0.04423049953248766, "kl": 0.018341435599479386, "entropy": 1.4254302781725687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1422191614196413, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 7.571758911597035, "policy_loss": 0.001028934813464287, "vf_loss": 7.553217029823828, "vf_explained_var": 0.05834247728504201, "kl": 0.01729674062800345, "entropy": 1.4540387397089962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 316.0, "episode_reward_min": -181.0, "episode_reward_mean": 77.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -240.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 145.0}, "policy_reward_mean": {"prey_policy": 13.775, "predator_policy": 24.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.0, -17.0, -75.0, 200.0, 60.0, 48.0, 14.0, 176.0, 50.0, 151.0, 215.0, 0.0, 109.0, 22.0, 91.0, 110.0, 111.0, 38.0, -30.0, 90.0, 94.0, 46.0, 137.0, 80.0, -53.0, 107.0, 138.0, 239.0, 18.0, 56.0, 12.0, -45.0, 47.0, 38.0, 35.0, 114.0, 20.0, 123.0, -8.0, 141.0, 92.0, 55.0, 100.0, -147.0, 106.0, 286.0, 163.0, 58.0, 40.0, 115.0, 55.0, 7.0, 193.0, 11.0, 44.0, 6.0, -43.0, 121.0, 43.0, 316.0, -142.0, 145.0, 111.0, -110.0, -41.0, 88.0, 211.0, 7.0, -85.0, 1.0, 0.0, -60.0, 137.0, 221.0, 85.0, 120.0, 28.0, 167.0, 15.0, 157.0, 145.0, 32.0, 101.0, -119.0, 161.0, 121.0, 32.0, 100.0, 291.0, 214.0, 122.0, 1.0, 187.0, 259.0, -21.0, -181.0, 207.0, 152.0, 262.0, 81.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [158.0, 2.0, -2.0, -50.0, -37.0, -85.0, 24.0, 137.0, 63.0, -18.0, 21.0, -19.0, -68.0, -6.0, 45.0, 99.0, -62.0, 34.0, 42.0, 85.0, 101.0, 100.0, -21.0, -16.0, 22.0, 82.0, -134.0, 54.0, 69.0, -49.0, 0.0, 103.0, -158.0, 167.0, 3.0, 2.0, -156.0, 48.0, 35.0, 27.0, 3.0, 0.0, 2.0, 33.0, 121.0, 7.0, 0.0, 80.0, -155.0, 0.0, -58.0, 130.0, 26.0, 79.0, 83.0, 156.0, -88.0, -14.0, 13.0, 3.0, -103.0, -34.0, -115.0, -100.0, 47.0, 0.0, -12.0, 0.0, -45.0, 13.0, -79.0, 92.0, -72.0, 6.0, 42.0, 13.0, -44.0, -14.0, 110.0, 1.0, -138.0, 112.0, -22.0, 11.0, 70.0, 22.0, -80.0, -219.0, 80.0, -5.0, 165.0, 121.0, 37.0, 102.0, 75.0, -79.0, 20.0, -27.0, -19.0, 109.0, 0.0, 33.0, -67.0, 0.0, 115.0, 78.0, -9.0, 0.0, 75.0, -62.0, 6.0, 0.0, -8.0, -70.0, -26.0, 75.0, 28.0, -65.0, 155.0, 161.0, -66.0, -240.0, -1.0, 66.0, 0.0, 68.0, -71.0, -196.0, -68.0, -14.0, 0.0, 83.0, 113.0, 62.0, -138.0, 74.0, -103.0, -97.0, -23.0, -29.0, 0.0, 0.0, -90.0, -110.0, -2.0, 126.0, 113.0, 99.0, -216.0, 193.0, 87.0, 15.0, 47.0, -42.0, 0.0, 167.0, -46.0, -34.0, 96.0, 59.0, 92.0, 48.0, 29.0, 3.0, 0.0, 92.0, -195.0, -49.0, 57.0, 97.0, 0.0, 121.0, 0.0, -11.0, 101.0, -55.0, 156.0, 131.0, 87.0, 125.0, -59.0, 101.0, -74.0, 9.0, 127.0, 39.0, 56.0, 164.0, -80.0, -10.0, -161.0, -165.0, 129.0, 72.0, 45.0, 54.0, 84.0, 178.0, -50.0, 62.0], "policy_predator_policy_reward": [10.0, 6.0, 35.0, 0.0, 47.0, 0.0, 0.0, 39.0, 15.0, 0.0, 46.0, 0.0, 11.0, 77.0, 7.0, 25.0, 3.0, 75.0, 19.0, 5.0, 3.0, 11.0, 29.0, 8.0, 0.0, 5.0, 4.0, 98.0, 31.0, 40.0, 0.0, 7.0, 102.0, 0.0, 23.0, 10.0, 0.0, 78.0, 25.0, 3.0, 77.0, 14.0, 0.0, 11.0, 0.0, 9.0, 0.0, 0.0, 78.0, 24.0, 29.0, 6.0, 0.0, 33.0, 0.0, 0.0, 50.0, 70.0, 0.0, 40.0, 120.0, 29.0, 81.0, 89.0, 0.0, 0.0, 50.0, 0.0, 47.0, 20.0, 18.0, 83.0, 10.0, 76.0, 5.0, 63.0, 0.0, 50.0, 7.0, 23.0, 16.0, 102.0, 66.0, 0.0, 8.0, 0.0, 40.0, 112.0, 0.0, 31.0, 0.0, 0.0, 0.0, 24.0, 8.0, 54.0, 0.0, 47.0, 11.0, 14.0, 22.0, 0.0, 61.0, 13.0, 0.0, 0.0, 1.0, 19.0, 0.0, 31.0, 0.0, 0.0, 35.0, 0.0, 34.0, 38.0, 61.0, 19.0, 0.0, 0.0, 34.0, 130.0, 33.0, 47.0, 26.0, 17.0, 98.0, 59.0, 26.0, 15.0, 0.0, 5.0, 36.0, 0.0, 69.0, 2.0, 51.0, 64.0, 0.0, 53.0, 0.0, 0.0, 74.0, 66.0, 1.0, 12.0, 3.0, 6.0, 0.0, 108.0, 18.0, 0.0, 0.0, 23.0, 0.0, 0.0, 50.0, 45.0, 0.0, 2.0, 4.0, 1.0, 0.0, 0.0, 0.0, 9.0, 125.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 43.0, 37.0, 17.0, 0.0, 4.0, 2.0, 0.0, 46.0, 34.0, 66.0, 0.0, 0.0, 21.0, 6.0, 33.0, 40.0, 29.0, 145.0, 0.0, 3.0, 3.0, 0.0, 53.0, 0.0, 0.0, 0.0, 69.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0011163065136788, "mean_inference_ms": 2.5667006140584636, "mean_action_processing_ms": 0.389669562345755, "mean_env_wait_ms": 0.35334640228183817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007297635078430176, "StateBufferConnector_ms": 0.005254983901977539, "ViewRequirementAgentConnector_ms": 0.15640199184417725}, "num_episodes": 23, "episode_return_max": 316.0, "episode_return_min": -181.0, "episode_return_mean": 77.01, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.20293662649084, "num_env_steps_trained_throughput_per_sec": 276.20293662649084, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 15841.854, "restore_workers_time_ms": 0.057, "training_step_time_ms": 15841.733, "sample_time_ms": 2042.773, "learn_time_ms": 13768.714, "learn_throughput": 290.514, "synch_weights_time_ms": 28.309}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "e1352_00000", "date": "2024-08-13_16-40-36", "timestamp": 1723581636, "time_this_iter_s": 14.566200017929077, "time_total_s": 159.15354323387146, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ceca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 159.15354323387146, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 76.65, "ram_util_percent": 84.545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6216793018831778, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 1.5659981897583715, "policy_loss": -0.0023384365494604465, "vf_loss": 1.563077449798584, "vf_explained_var": 0.03995190076727085, "kl": 0.017530598052004707, "entropy": 1.4100303415898923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3233907035103551, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 5.823538723698369, "policy_loss": 0.002991500570039664, "vf_loss": 5.803115703441478, "vf_explained_var": 0.08604713063391428, "kl": 0.01721632270661647, "entropy": 1.4593802447041506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 316.0, "episode_reward_min": -197.0, "episode_reward_mean": 74.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -240.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": 13.65, "predator_policy": 23.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, 90.0, 94.0, 46.0, 137.0, 80.0, -53.0, 107.0, 138.0, 239.0, 18.0, 56.0, 12.0, -45.0, 47.0, 38.0, 35.0, 114.0, 20.0, 123.0, -8.0, 141.0, 92.0, 55.0, 100.0, -147.0, 106.0, 286.0, 163.0, 58.0, 40.0, 115.0, 55.0, 7.0, 193.0, 11.0, 44.0, 6.0, -43.0, 121.0, 43.0, 316.0, -142.0, 145.0, 111.0, -110.0, -41.0, 88.0, 211.0, 7.0, -85.0, 1.0, 0.0, -60.0, 137.0, 221.0, 85.0, 120.0, 28.0, 167.0, 15.0, 157.0, 145.0, 32.0, 101.0, -119.0, 161.0, 121.0, 32.0, 100.0, 291.0, 214.0, 122.0, 1.0, 187.0, 259.0, -21.0, -181.0, 207.0, 152.0, 262.0, 81.0, 171.0, 7.0, 275.0, 313.0, 110.0, -108.0, 32.0, 84.0, 121.0, 112.0, 126.0, 241.0, -52.0, -65.0, -197.0, -4.0, 145.0, -39.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-156.0, 48.0, 35.0, 27.0, 3.0, 0.0, 2.0, 33.0, 121.0, 7.0, 0.0, 80.0, -155.0, 0.0, -58.0, 130.0, 26.0, 79.0, 83.0, 156.0, -88.0, -14.0, 13.0, 3.0, -103.0, -34.0, -115.0, -100.0, 47.0, 0.0, -12.0, 0.0, -45.0, 13.0, -79.0, 92.0, -72.0, 6.0, 42.0, 13.0, -44.0, -14.0, 110.0, 1.0, -138.0, 112.0, -22.0, 11.0, 70.0, 22.0, -80.0, -219.0, 80.0, -5.0, 165.0, 121.0, 37.0, 102.0, 75.0, -79.0, 20.0, -27.0, -19.0, 109.0, 0.0, 33.0, -67.0, 0.0, 115.0, 78.0, -9.0, 0.0, 75.0, -62.0, 6.0, 0.0, -8.0, -70.0, -26.0, 75.0, 28.0, -65.0, 155.0, 161.0, -66.0, -240.0, -1.0, 66.0, 0.0, 68.0, -71.0, -196.0, -68.0, -14.0, 0.0, 83.0, 113.0, 62.0, -138.0, 74.0, -103.0, -97.0, -23.0, -29.0, 0.0, 0.0, -90.0, -110.0, -2.0, 126.0, 113.0, 99.0, -216.0, 193.0, 87.0, 15.0, 47.0, -42.0, 0.0, 167.0, -46.0, -34.0, 96.0, 59.0, 92.0, 48.0, 29.0, 3.0, 0.0, 92.0, -195.0, -49.0, 57.0, 97.0, 0.0, 121.0, 0.0, -11.0, 101.0, -55.0, 156.0, 131.0, 87.0, 125.0, -59.0, 101.0, -74.0, 9.0, 127.0, 39.0, 56.0, 164.0, -80.0, -10.0, -161.0, -165.0, 129.0, 72.0, 45.0, 54.0, 84.0, 178.0, -50.0, 62.0, 4.0, 167.0, -21.0, -74.0, 168.0, 107.0, 152.0, 161.0, 78.0, -10.0, -151.0, -73.0, 19.0, 0.0, 0.0, 84.0, 66.0, 54.0, 0.0, 97.0, 0.0, 126.0, 98.0, 143.0, -79.0, -20.0, 24.0, -182.0, -134.0, -220.0, 0.0, -8.0, 0.0, 145.0, -26.0, -32.0], "policy_predator_policy_reward": [0.0, 78.0, 25.0, 3.0, 77.0, 14.0, 0.0, 11.0, 0.0, 9.0, 0.0, 0.0, 78.0, 24.0, 29.0, 6.0, 0.0, 33.0, 0.0, 0.0, 50.0, 70.0, 0.0, 40.0, 120.0, 29.0, 81.0, 89.0, 0.0, 0.0, 50.0, 0.0, 47.0, 20.0, 18.0, 83.0, 10.0, 76.0, 5.0, 63.0, 0.0, 50.0, 7.0, 23.0, 16.0, 102.0, 66.0, 0.0, 8.0, 0.0, 40.0, 112.0, 0.0, 31.0, 0.0, 0.0, 0.0, 24.0, 8.0, 54.0, 0.0, 47.0, 11.0, 14.0, 22.0, 0.0, 61.0, 13.0, 0.0, 0.0, 1.0, 19.0, 0.0, 31.0, 0.0, 0.0, 35.0, 0.0, 34.0, 38.0, 61.0, 19.0, 0.0, 0.0, 34.0, 130.0, 33.0, 47.0, 26.0, 17.0, 98.0, 59.0, 26.0, 15.0, 0.0, 5.0, 36.0, 0.0, 69.0, 2.0, 51.0, 64.0, 0.0, 53.0, 0.0, 0.0, 74.0, 66.0, 1.0, 12.0, 3.0, 6.0, 0.0, 108.0, 18.0, 0.0, 0.0, 23.0, 0.0, 0.0, 50.0, 45.0, 0.0, 2.0, 4.0, 1.0, 0.0, 0.0, 0.0, 9.0, 125.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 43.0, 37.0, 17.0, 0.0, 4.0, 2.0, 0.0, 46.0, 34.0, 66.0, 0.0, 0.0, 21.0, 6.0, 33.0, 40.0, 29.0, 145.0, 0.0, 3.0, 3.0, 0.0, 53.0, 0.0, 0.0, 0.0, 69.0, 0.0, 0.0, 0.0, 102.0, 0.0, 0.0, 0.0, 0.0, 28.0, 14.0, 40.0, 76.0, 12.0, 1.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 93.0, 151.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0041467855328083, "mean_inference_ms": 2.574125889383647, "mean_action_processing_ms": 0.3891987982251495, "mean_env_wait_ms": 0.35352040147113456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007147550582885742, "StateBufferConnector_ms": 0.0052373409271240234, "ViewRequirementAgentConnector_ms": 0.17055439949035645}, "num_episodes": 18, "episode_return_max": 316.0, "episode_return_min": -197.0, "episode_return_mean": 74.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.15586798661846, "num_env_steps_trained_throughput_per_sec": 251.15586798661846, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 15846.291, "restore_workers_time_ms": 0.057, "training_step_time_ms": 15846.168, "sample_time_ms": 2247.831, "learn_time_ms": 13569.536, "learn_throughput": 294.778, "synch_weights_time_ms": 26.416}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "e1352_00000", "date": "2024-08-13_16-40-52", "timestamp": 1723581652, "time_this_iter_s": 15.986111164093018, "time_total_s": 175.13965439796448, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af0fe310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 175.13965439796448, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 79.26521739130433, "ram_util_percent": 85.00434782608697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7104394058780695, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.009999999999999998, "total_loss": 2.292692354179564, "policy_loss": 0.0017902923876015598, "vf_loss": 2.284592062834079, "vf_explained_var": 0.024932893274953127, "kl": 0.021033343159606123, "entropy": 1.425241167141647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4300791218324944, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 5.498108757109869, "policy_loss": 0.0026896000462805943, "vf_loss": 5.478116236792671, "vf_explained_var": 0.05518881905646551, "kl": 0.017089298371498397, "entropy": 1.4428170954739605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 336.0, "episode_reward_min": -197.0, "episode_reward_mean": 78.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -240.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": 17.34, "predator_policy": 21.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 123.0, -8.0, 141.0, 92.0, 55.0, 100.0, -147.0, 106.0, 286.0, 163.0, 58.0, 40.0, 115.0, 55.0, 7.0, 193.0, 11.0, 44.0, 6.0, -43.0, 121.0, 43.0, 316.0, -142.0, 145.0, 111.0, -110.0, -41.0, 88.0, 211.0, 7.0, -85.0, 1.0, 0.0, -60.0, 137.0, 221.0, 85.0, 120.0, 28.0, 167.0, 15.0, 157.0, 145.0, 32.0, 101.0, -119.0, 161.0, 121.0, 32.0, 100.0, 291.0, 214.0, 122.0, 1.0, 187.0, 259.0, -21.0, -181.0, 207.0, 152.0, 262.0, 81.0, 171.0, 7.0, 275.0, 313.0, 110.0, -108.0, 32.0, 84.0, 121.0, 112.0, 126.0, 241.0, -52.0, -65.0, -197.0, -4.0, 145.0, -39.0, 131.0, 202.0, 246.0, 140.0, -44.0, -157.0, 336.0, 52.0, 221.0, 120.0, 77.0, -100.0, -43.0, 43.0, 144.0, 111.0, -16.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-72.0, 6.0, 42.0, 13.0, -44.0, -14.0, 110.0, 1.0, -138.0, 112.0, -22.0, 11.0, 70.0, 22.0, -80.0, -219.0, 80.0, -5.0, 165.0, 121.0, 37.0, 102.0, 75.0, -79.0, 20.0, -27.0, -19.0, 109.0, 0.0, 33.0, -67.0, 0.0, 115.0, 78.0, -9.0, 0.0, 75.0, -62.0, 6.0, 0.0, -8.0, -70.0, -26.0, 75.0, 28.0, -65.0, 155.0, 161.0, -66.0, -240.0, -1.0, 66.0, 0.0, 68.0, -71.0, -196.0, -68.0, -14.0, 0.0, 83.0, 113.0, 62.0, -138.0, 74.0, -103.0, -97.0, -23.0, -29.0, 0.0, 0.0, -90.0, -110.0, -2.0, 126.0, 113.0, 99.0, -216.0, 193.0, 87.0, 15.0, 47.0, -42.0, 0.0, 167.0, -46.0, -34.0, 96.0, 59.0, 92.0, 48.0, 29.0, 3.0, 0.0, 92.0, -195.0, -49.0, 57.0, 97.0, 0.0, 121.0, 0.0, -11.0, 101.0, -55.0, 156.0, 131.0, 87.0, 125.0, -59.0, 101.0, -74.0, 9.0, 127.0, 39.0, 56.0, 164.0, -80.0, -10.0, -161.0, -165.0, 129.0, 72.0, 45.0, 54.0, 84.0, 178.0, -50.0, 62.0, 4.0, 167.0, -21.0, -74.0, 168.0, 107.0, 152.0, 161.0, 78.0, -10.0, -151.0, -73.0, 19.0, 0.0, 0.0, 84.0, 66.0, 54.0, 0.0, 97.0, 0.0, 126.0, 98.0, 143.0, -79.0, -20.0, 24.0, -182.0, -134.0, -220.0, 0.0, -8.0, 0.0, 145.0, -26.0, -32.0, 55.0, 61.0, 104.0, 91.0, 105.0, 118.0, 0.0, 133.0, 0.0, -88.0, -150.0, -132.0, 184.0, 151.0, 29.0, 23.0, 105.0, 116.0, 96.0, -14.0, 70.0, 0.0, -34.0, -136.0, -126.0, 0.0, 0.0, 2.0, 160.0, -52.0, 85.0, 0.0, 60.0, -162.0, -6.0, -71.0], "policy_predator_policy_reward": [10.0, 76.0, 5.0, 63.0, 0.0, 50.0, 7.0, 23.0, 16.0, 102.0, 66.0, 0.0, 8.0, 0.0, 40.0, 112.0, 0.0, 31.0, 0.0, 0.0, 0.0, 24.0, 8.0, 54.0, 0.0, 47.0, 11.0, 14.0, 22.0, 0.0, 61.0, 13.0, 0.0, 0.0, 1.0, 19.0, 0.0, 31.0, 0.0, 0.0, 35.0, 0.0, 34.0, 38.0, 61.0, 19.0, 0.0, 0.0, 34.0, 130.0, 33.0, 47.0, 26.0, 17.0, 98.0, 59.0, 26.0, 15.0, 0.0, 5.0, 36.0, 0.0, 69.0, 2.0, 51.0, 64.0, 0.0, 53.0, 0.0, 0.0, 74.0, 66.0, 1.0, 12.0, 3.0, 6.0, 0.0, 108.0, 18.0, 0.0, 0.0, 23.0, 0.0, 0.0, 50.0, 45.0, 0.0, 2.0, 4.0, 1.0, 0.0, 0.0, 0.0, 9.0, 125.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 43.0, 37.0, 17.0, 0.0, 4.0, 2.0, 0.0, 46.0, 34.0, 66.0, 0.0, 0.0, 21.0, 6.0, 33.0, 40.0, 29.0, 145.0, 0.0, 3.0, 3.0, 0.0, 53.0, 0.0, 0.0, 0.0, 69.0, 0.0, 0.0, 0.0, 102.0, 0.0, 0.0, 0.0, 0.0, 28.0, 14.0, 40.0, 76.0, 12.0, 1.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 93.0, 151.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, 19.0, 11.0, 4.0, 3.0, 4.0, 23.0, 0.0, 7.0, 0.0, 0.0, 44.0, 0.0, 125.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 16.0, 2.0, 5.0, 70.0, 0.0, 0.0, 83.0, 19.0, 22.0, 26.0, 10.0, 26.0, 0.0, 8.0, 78.0, 6.0, 76.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0222756193803897, "mean_inference_ms": 2.62690465256074, "mean_action_processing_ms": 0.39537397467695895, "mean_env_wait_ms": 0.3604735774859656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009681344032287598, "StateBufferConnector_ms": 0.006650686264038086, "ViewRequirementAgentConnector_ms": 0.22320115566253662}, "num_episodes": 18, "episode_return_max": 336.0, "episode_return_min": -197.0, "episode_return_mean": 78.39, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.82636918637087, "num_env_steps_trained_throughput_per_sec": 266.82636918637087, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 15299.515, "restore_workers_time_ms": 0.022, "training_step_time_ms": 15299.445, "sample_time_ms": 2235.159, "learn_time_ms": 13035.937, "learn_throughput": 306.844, "synch_weights_time_ms": 25.635}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "e1352_00000", "date": "2024-08-13_16-41-07", "timestamp": 1723581667, "time_this_iter_s": 15.078913927078247, "time_total_s": 190.21856832504272, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af0fe550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 190.21856832504272, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 75.43636363636364, "ram_util_percent": 84.75454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7043642081832759, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 3.253809311717906, "policy_loss": 7.425665402065509e-05, "vf_loss": 3.246226472387869, "vf_explained_var": 0.04317909412913852, "kl": 0.01668576078626511, "entropy": 1.3898787443600005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.406405406228449, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 5.522738582873471, "policy_loss": 0.0028801971299958133, "vf_loss": 5.499963012574211, "vf_explained_var": 0.022276263829892274, "kl": 0.01964976558381217, "entropy": 1.4258639757595366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 336.0, "episode_reward_min": -197.0, "episode_reward_mean": 72.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -240.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": 13.29, "predator_policy": 22.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 6.0, -43.0, 121.0, 43.0, 316.0, -142.0, 145.0, 111.0, -110.0, -41.0, 88.0, 211.0, 7.0, -85.0, 1.0, 0.0, -60.0, 137.0, 221.0, 85.0, 120.0, 28.0, 167.0, 15.0, 157.0, 145.0, 32.0, 101.0, -119.0, 161.0, 121.0, 32.0, 100.0, 291.0, 214.0, 122.0, 1.0, 187.0, 259.0, -21.0, -181.0, 207.0, 152.0, 262.0, 81.0, 171.0, 7.0, 275.0, 313.0, 110.0, -108.0, 32.0, 84.0, 121.0, 112.0, 126.0, 241.0, -52.0, -65.0, -197.0, -4.0, 145.0, -39.0, 131.0, 202.0, 246.0, 140.0, -44.0, -157.0, 336.0, 52.0, 221.0, 120.0, 77.0, -100.0, -43.0, 43.0, 144.0, 111.0, -16.0, 5.0, 203.0, 0.0, 197.0, 78.0, 82.0, 24.0, 9.0, 158.0, -54.0, -4.0, 186.0, 161.0, -31.0, -4.0, -91.0, 31.0, -85.0, -37.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [75.0, -62.0, 6.0, 0.0, -8.0, -70.0, -26.0, 75.0, 28.0, -65.0, 155.0, 161.0, -66.0, -240.0, -1.0, 66.0, 0.0, 68.0, -71.0, -196.0, -68.0, -14.0, 0.0, 83.0, 113.0, 62.0, -138.0, 74.0, -103.0, -97.0, -23.0, -29.0, 0.0, 0.0, -90.0, -110.0, -2.0, 126.0, 113.0, 99.0, -216.0, 193.0, 87.0, 15.0, 47.0, -42.0, 0.0, 167.0, -46.0, -34.0, 96.0, 59.0, 92.0, 48.0, 29.0, 3.0, 0.0, 92.0, -195.0, -49.0, 57.0, 97.0, 0.0, 121.0, 0.0, -11.0, 101.0, -55.0, 156.0, 131.0, 87.0, 125.0, -59.0, 101.0, -74.0, 9.0, 127.0, 39.0, 56.0, 164.0, -80.0, -10.0, -161.0, -165.0, 129.0, 72.0, 45.0, 54.0, 84.0, 178.0, -50.0, 62.0, 4.0, 167.0, -21.0, -74.0, 168.0, 107.0, 152.0, 161.0, 78.0, -10.0, -151.0, -73.0, 19.0, 0.0, 0.0, 84.0, 66.0, 54.0, 0.0, 97.0, 0.0, 126.0, 98.0, 143.0, -79.0, -20.0, 24.0, -182.0, -134.0, -220.0, 0.0, -8.0, 0.0, 145.0, -26.0, -32.0, 55.0, 61.0, 104.0, 91.0, 105.0, 118.0, 0.0, 133.0, 0.0, -88.0, -150.0, -132.0, 184.0, 151.0, 29.0, 23.0, 105.0, 116.0, 96.0, -14.0, 70.0, 0.0, -34.0, -136.0, -126.0, 0.0, 0.0, 2.0, 160.0, -52.0, 85.0, 0.0, 60.0, -162.0, -6.0, -71.0, 111.0, 87.0, 0.0, 0.0, 78.0, 101.0, 78.0, 0.0, 53.0, -20.0, 5.0, -24.0, -12.0, 0.0, -47.0, 152.0, 0.0, -141.0, -28.0, -8.0, 53.0, 133.0, 93.0, 67.0, -34.0, -28.0, -40.0, -68.0, -162.0, -187.0, -215.0, 41.0, -183.0, 0.0, -15.0, -123.0], "policy_predator_policy_reward": [0.0, 31.0, 0.0, 0.0, 35.0, 0.0, 34.0, 38.0, 61.0, 19.0, 0.0, 0.0, 34.0, 130.0, 33.0, 47.0, 26.0, 17.0, 98.0, 59.0, 26.0, 15.0, 0.0, 5.0, 36.0, 0.0, 69.0, 2.0, 51.0, 64.0, 0.0, 53.0, 0.0, 0.0, 74.0, 66.0, 1.0, 12.0, 3.0, 6.0, 0.0, 108.0, 18.0, 0.0, 0.0, 23.0, 0.0, 0.0, 50.0, 45.0, 0.0, 2.0, 4.0, 1.0, 0.0, 0.0, 0.0, 9.0, 125.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 43.0, 37.0, 17.0, 0.0, 4.0, 2.0, 0.0, 46.0, 34.0, 66.0, 0.0, 0.0, 21.0, 6.0, 33.0, 40.0, 29.0, 145.0, 0.0, 3.0, 3.0, 0.0, 53.0, 0.0, 0.0, 0.0, 69.0, 0.0, 0.0, 0.0, 102.0, 0.0, 0.0, 0.0, 0.0, 28.0, 14.0, 40.0, 76.0, 12.0, 1.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 93.0, 151.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, 19.0, 11.0, 4.0, 3.0, 4.0, 23.0, 0.0, 7.0, 0.0, 0.0, 44.0, 0.0, 125.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 16.0, 2.0, 5.0, 70.0, 0.0, 0.0, 83.0, 19.0, 22.0, 26.0, 10.0, 26.0, 0.0, 8.0, 78.0, 6.0, 76.0, 5.0, 0.0, 0.0, 0.0, 5.0, 13.0, 0.0, 0.0, 0.0, 49.0, 24.0, 19.0, 0.0, 21.0, 53.0, 0.0, 0.0, 87.0, 0.0, 32.0, 0.0, 0.0, 0.0, 1.0, 17.0, 14.0, 2.0, 102.0, 138.0, 120.0, 82.0, 123.0, 0.0, 98.0, 101.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.05267649877915, "mean_inference_ms": 2.717060524628473, "mean_action_processing_ms": 0.406364371268142, "mean_env_wait_ms": 0.3707566433310612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009863734245300293, "StateBufferConnector_ms": 0.014048576354980469, "ViewRequirementAgentConnector_ms": 0.21867311000823975}, "num_episodes": 18, "episode_return_max": 336.0, "episode_return_min": -197.0, "episode_return_mean": 72.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.59247877498194, "num_env_steps_trained_throughput_per_sec": 258.59247877498194, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 15236.247, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15236.175, "sample_time_ms": 2296.349, "learn_time_ms": 12911.431, "learn_throughput": 309.803, "synch_weights_time_ms": 25.397}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "e1352_00000", "date": "2024-08-13_16-41-23", "timestamp": 1723581683, "time_this_iter_s": 15.529813051223755, "time_total_s": 205.74838137626648, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af103c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 205.74838137626648, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 75.36363636363636, "ram_util_percent": 85.10909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7892616247452756, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 2.575928496936011, "policy_loss": -0.0015340979879958526, "vf_loss": 2.5691756076282926, "vf_explained_var": 0.06057984778490016, "kl": 0.018415514450091344, "entropy": 1.406357370608698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0072183737048395, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 4.487605483065207, "policy_loss": 0.013446815501868962, "vf_loss": 4.403916837298681, "vf_explained_var": -0.10397047088259742, "kl": 0.06937463789188635, "entropy": 1.3044090598222933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 336.0, "episode_reward_min": -197.0, "episode_reward_mean": 61.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -241.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": 7.58, "predator_policy": 22.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 101.0, -119.0, 161.0, 121.0, 32.0, 100.0, 291.0, 214.0, 122.0, 1.0, 187.0, 259.0, -21.0, -181.0, 207.0, 152.0, 262.0, 81.0, 171.0, 7.0, 275.0, 313.0, 110.0, -108.0, 32.0, 84.0, 121.0, 112.0, 126.0, 241.0, -52.0, -65.0, -197.0, -4.0, 145.0, -39.0, 131.0, 202.0, 246.0, 140.0, -44.0, -157.0, 336.0, 52.0, 221.0, 120.0, 77.0, -100.0, -43.0, 43.0, 144.0, 111.0, -16.0, 5.0, 203.0, 0.0, 197.0, 78.0, 82.0, 24.0, 9.0, 158.0, -54.0, -4.0, 186.0, 161.0, -31.0, -4.0, -91.0, 31.0, -85.0, -37.0, 62.0, -35.0, 54.0, -107.0, -15.0, 126.0, -24.0, 7.0, 15.0, 44.0, -48.0, 10.0, 4.0, 58.0, 103.0, 152.0, 28.0, 72.0, 82.0, 39.0, 28.0, 22.0, -11.0, -141.0, -48.0, -80.0, 141.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [29.0, 3.0, 0.0, 92.0, -195.0, -49.0, 57.0, 97.0, 0.0, 121.0, 0.0, -11.0, 101.0, -55.0, 156.0, 131.0, 87.0, 125.0, -59.0, 101.0, -74.0, 9.0, 127.0, 39.0, 56.0, 164.0, -80.0, -10.0, -161.0, -165.0, 129.0, 72.0, 45.0, 54.0, 84.0, 178.0, -50.0, 62.0, 4.0, 167.0, -21.0, -74.0, 168.0, 107.0, 152.0, 161.0, 78.0, -10.0, -151.0, -73.0, 19.0, 0.0, 0.0, 84.0, 66.0, 54.0, 0.0, 97.0, 0.0, 126.0, 98.0, 143.0, -79.0, -20.0, 24.0, -182.0, -134.0, -220.0, 0.0, -8.0, 0.0, 145.0, -26.0, -32.0, 55.0, 61.0, 104.0, 91.0, 105.0, 118.0, 0.0, 133.0, 0.0, -88.0, -150.0, -132.0, 184.0, 151.0, 29.0, 23.0, 105.0, 116.0, 96.0, -14.0, 70.0, 0.0, -34.0, -136.0, -126.0, 0.0, 0.0, 2.0, 160.0, -52.0, 85.0, 0.0, 60.0, -162.0, -6.0, -71.0, 111.0, 87.0, 0.0, 0.0, 78.0, 101.0, 78.0, 0.0, 53.0, -20.0, 5.0, -24.0, -12.0, 0.0, -47.0, 152.0, 0.0, -141.0, -28.0, -8.0, 53.0, 133.0, 93.0, 67.0, -34.0, -28.0, -40.0, -68.0, -162.0, -187.0, -215.0, 41.0, -183.0, 0.0, -15.0, -123.0, 80.0, -36.0, -2.0, -66.0, 34.0, 0.0, -84.0, -133.0, -30.0, 0.0, 97.0, -11.0, -26.0, -51.0, 0.0, 2.0, 13.0, -34.0, 41.0, -34.0, 0.0, -116.0, -50.0, 22.0, 18.0, -28.0, 0.0, 58.0, 55.0, 40.0, 48.0, 30.0, 0.0, -7.0, 0.0, 53.0, -23.0, 26.0, 18.0, 2.0, 30.0, -27.0, -20.0, -25.0, -109.0, 0.0, -241.0, -69.0, -91.0, -120.0, 7.0, -220.0, 128.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 9.0, 125.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 43.0, 37.0, 17.0, 0.0, 4.0, 2.0, 0.0, 46.0, 34.0, 66.0, 0.0, 0.0, 21.0, 6.0, 33.0, 40.0, 29.0, 145.0, 0.0, 3.0, 3.0, 0.0, 53.0, 0.0, 0.0, 0.0, 69.0, 0.0, 0.0, 0.0, 102.0, 0.0, 0.0, 0.0, 0.0, 28.0, 14.0, 40.0, 76.0, 12.0, 1.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 93.0, 151.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, 19.0, 11.0, 4.0, 3.0, 4.0, 23.0, 0.0, 7.0, 0.0, 0.0, 44.0, 0.0, 125.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 16.0, 2.0, 5.0, 70.0, 0.0, 0.0, 83.0, 19.0, 22.0, 26.0, 10.0, 26.0, 0.0, 8.0, 78.0, 6.0, 76.0, 5.0, 0.0, 0.0, 0.0, 5.0, 13.0, 0.0, 0.0, 0.0, 49.0, 24.0, 19.0, 0.0, 21.0, 53.0, 0.0, 0.0, 87.0, 0.0, 32.0, 0.0, 0.0, 0.0, 1.0, 17.0, 14.0, 2.0, 102.0, 138.0, 120.0, 82.0, 123.0, 0.0, 98.0, 101.0, 0.0, 0.0, 18.0, 33.0, 0.0, 20.0, 0.0, 110.0, 0.0, 15.0, 0.0, 40.0, 0.0, 37.0, 16.0, 0.0, 5.0, 21.0, 15.0, 26.0, 11.0, 68.0, 0.0, 0.0, 38.0, 14.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 74.0, 35.0, 0.0, 9.0, 10.0, 0.0, 79.0, 0.0, 19.0, 14.0, 11.0, 67.0, 0.0, 61.0, 37.0, 83.0, 86.0, 110.0, 53.0, 133.0, 0.0, 13.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1175286405903313, "mean_inference_ms": 2.9083609777848562, "mean_action_processing_ms": 0.43257535778941786, "mean_env_wait_ms": 0.39534381041107886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007025003433227539, "StateBufferConnector_ms": 0.014092564582824707, "ViewRequirementAgentConnector_ms": 0.23205924034118652}, "num_episodes": 27, "episode_return_max": 336.0, "episode_return_min": -197.0, "episode_return_mean": 61.03, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.71434203080725, "num_env_steps_trained_throughput_per_sec": 219.71434203080725, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 15528.253, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15528.181, "sample_time_ms": 2523.497, "learn_time_ms": 12976.314, "learn_throughput": 308.254, "synch_weights_time_ms": 24.425}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "e1352_00000", "date": "2024-08-13_16-41-41", "timestamp": 1723581701, "time_this_iter_s": 18.312177896499634, "time_total_s": 224.0605592727661, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15cea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 224.0605592727661, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 79.63600000000001, "ram_util_percent": 85.02000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7589050810803812, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 1.4248182351311678, "policy_loss": -0.0010791034102636985, "vf_loss": 1.4177129639519586, "vf_explained_var": 0.0407054342920818, "kl": 0.018187494064775753, "entropy": 1.4060721771426932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.113414671354824, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.009999999999999998, "total_loss": 2.16873403806535, "policy_loss": 0.009186873532752826, "vf_loss": 2.1192534167299826, "vf_explained_var": -0.017671928235462733, "kl": 0.026530866534955386, "entropy": 0.975112958181472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 336.0, "episode_reward_min": -197.0, "episode_reward_mean": 40.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -241.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": -1.365, "predator_policy": 21.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [81.0, 171.0, 7.0, 275.0, 313.0, 110.0, -108.0, 32.0, 84.0, 121.0, 112.0, 126.0, 241.0, -52.0, -65.0, -197.0, -4.0, 145.0, -39.0, 131.0, 202.0, 246.0, 140.0, -44.0, -157.0, 336.0, 52.0, 221.0, 120.0, 77.0, -100.0, -43.0, 43.0, 144.0, 111.0, -16.0, 5.0, 203.0, 0.0, 197.0, 78.0, 82.0, 24.0, 9.0, 158.0, -54.0, -4.0, 186.0, 161.0, -31.0, -4.0, -91.0, 31.0, -85.0, -37.0, 62.0, -35.0, 54.0, -107.0, -15.0, 126.0, -24.0, 7.0, 15.0, 44.0, -48.0, 10.0, 4.0, 58.0, 103.0, 152.0, 28.0, 72.0, 82.0, 39.0, 28.0, 22.0, -11.0, -141.0, -48.0, -80.0, 141.0, -17.0, 19.0, -17.0, 0.0, -43.0, -14.0, -4.0, -1.0, -26.0, -34.0, 15.0, 33.0, 22.0, 0.0, -1.0, 55.0, -177.0, 36.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-50.0, 62.0, 4.0, 167.0, -21.0, -74.0, 168.0, 107.0, 152.0, 161.0, 78.0, -10.0, -151.0, -73.0, 19.0, 0.0, 0.0, 84.0, 66.0, 54.0, 0.0, 97.0, 0.0, 126.0, 98.0, 143.0, -79.0, -20.0, 24.0, -182.0, -134.0, -220.0, 0.0, -8.0, 0.0, 145.0, -26.0, -32.0, 55.0, 61.0, 104.0, 91.0, 105.0, 118.0, 0.0, 133.0, 0.0, -88.0, -150.0, -132.0, 184.0, 151.0, 29.0, 23.0, 105.0, 116.0, 96.0, -14.0, 70.0, 0.0, -34.0, -136.0, -126.0, 0.0, 0.0, 2.0, 160.0, -52.0, 85.0, 0.0, 60.0, -162.0, -6.0, -71.0, 111.0, 87.0, 0.0, 0.0, 78.0, 101.0, 78.0, 0.0, 53.0, -20.0, 5.0, -24.0, -12.0, 0.0, -47.0, 152.0, 0.0, -141.0, -28.0, -8.0, 53.0, 133.0, 93.0, 67.0, -34.0, -28.0, -40.0, -68.0, -162.0, -187.0, -215.0, 41.0, -183.0, 0.0, -15.0, -123.0, 80.0, -36.0, -2.0, -66.0, 34.0, 0.0, -84.0, -133.0, -30.0, 0.0, 97.0, -11.0, -26.0, -51.0, 0.0, 2.0, 13.0, -34.0, 41.0, -34.0, 0.0, -116.0, -50.0, 22.0, 18.0, -28.0, 0.0, 58.0, 55.0, 40.0, 48.0, 30.0, 0.0, -7.0, 0.0, 53.0, -23.0, 26.0, 18.0, 2.0, 30.0, -27.0, -20.0, -25.0, -109.0, 0.0, -241.0, -69.0, -91.0, -120.0, 7.0, -220.0, 128.0, 0.0, 0.0, -34.0, 2.0, 17.0, -89.0, -12.0, 0.0, 0.0, -82.0, -2.0, -12.0, -25.0, -13.0, 0.0, 0.0, -2.0, -88.0, -41.0, -33.0, -18.0, -2.0, 16.0, 0.0, 33.0, 0.0, 16.0, -22.0, 0.0, 10.0, -42.0, 55.0, 0.0, -104.0, -150.0, 0.0, 31.0], "policy_predator_policy_reward": [0.0, 69.0, 0.0, 0.0, 0.0, 102.0, 0.0, 0.0, 0.0, 0.0, 28.0, 14.0, 40.0, 76.0, 12.0, 1.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 93.0, 151.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, 19.0, 11.0, 4.0, 3.0, 4.0, 23.0, 0.0, 7.0, 0.0, 0.0, 44.0, 0.0, 125.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 16.0, 2.0, 5.0, 70.0, 0.0, 0.0, 83.0, 19.0, 22.0, 26.0, 10.0, 26.0, 0.0, 8.0, 78.0, 6.0, 76.0, 5.0, 0.0, 0.0, 0.0, 5.0, 13.0, 0.0, 0.0, 0.0, 49.0, 24.0, 19.0, 0.0, 21.0, 53.0, 0.0, 0.0, 87.0, 0.0, 32.0, 0.0, 0.0, 0.0, 1.0, 17.0, 14.0, 2.0, 102.0, 138.0, 120.0, 82.0, 123.0, 0.0, 98.0, 101.0, 0.0, 0.0, 18.0, 33.0, 0.0, 20.0, 0.0, 110.0, 0.0, 15.0, 0.0, 40.0, 0.0, 37.0, 16.0, 0.0, 5.0, 21.0, 15.0, 26.0, 11.0, 68.0, 0.0, 0.0, 38.0, 14.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 74.0, 35.0, 0.0, 9.0, 10.0, 0.0, 79.0, 0.0, 19.0, 14.0, 11.0, 67.0, 0.0, 61.0, 37.0, 83.0, 86.0, 110.0, 53.0, 133.0, 0.0, 13.0, 0.0, 0.0, 17.0, 0.0, 0.0, 32.0, 52.0, 0.0, 0.0, 41.0, 0.0, 6.0, 17.0, 0.0, 9.0, 0.0, 1.0, 48.0, 55.0, 0.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 22.0, 0.0, 25.0, 6.0, 0.0, 0.0, 76.0, 1.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1570914905208818, "mean_inference_ms": 3.0303547241500985, "mean_action_processing_ms": 0.4486913523365142, "mean_env_wait_ms": 0.4116752434477746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068274736404418945, "StateBufferConnector_ms": 0.013086915016174316, "ViewRequirementAgentConnector_ms": 0.22257399559020996}, "num_episodes": 18, "episode_return_max": 336.0, "episode_return_min": -197.0, "episode_return_mean": 40.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.2174836260217, "num_env_steps_trained_throughput_per_sec": 246.2174836260217, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 15584.382, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15584.31, "sample_time_ms": 2654.255, "learn_time_ms": 12899.592, "learn_throughput": 310.087, "synch_weights_time_ms": 26.462}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "e1352_00000", "date": "2024-08-13_16-41-58", "timestamp": 1723581718, "time_this_iter_s": 16.310978889465332, "time_total_s": 240.37153816223145, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15d28b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 240.37153816223145, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 82.5521739130435, "ram_util_percent": 84.67391304347827}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8234040793839585, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 0.7043495259745411, "policy_loss": -0.0054215334666272005, "vf_loss": 0.7019277331650888, "vf_explained_var": 0.12898996664733484, "kl": 0.017429610881940574, "entropy": 1.3012148440830291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.9689314733579675, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.216128672020776, "policy_loss": 0.0032815744538628867, "vf_loss": 1.1736820502729013, "vf_explained_var": 0.005090056115357333, "kl": 0.01719178952164672, "entropy": 0.9797106244261302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 336.0, "episode_reward_min": -177.0, "episode_reward_mean": 25.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -241.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 138.0}, "policy_reward_mean": {"prey_policy": -7.475, "predator_policy": 20.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.0, 131.0, 202.0, 246.0, 140.0, -44.0, -157.0, 336.0, 52.0, 221.0, 120.0, 77.0, -100.0, -43.0, 43.0, 144.0, 111.0, -16.0, 5.0, 203.0, 0.0, 197.0, 78.0, 82.0, 24.0, 9.0, 158.0, -54.0, -4.0, 186.0, 161.0, -31.0, -4.0, -91.0, 31.0, -85.0, -37.0, 62.0, -35.0, 54.0, -107.0, -15.0, 126.0, -24.0, 7.0, 15.0, 44.0, -48.0, 10.0, 4.0, 58.0, 103.0, 152.0, 28.0, 72.0, 82.0, 39.0, 28.0, 22.0, -11.0, -141.0, -48.0, -80.0, 141.0, -17.0, 19.0, -17.0, 0.0, -43.0, -14.0, -4.0, -1.0, -26.0, -34.0, 15.0, 33.0, 22.0, 0.0, -1.0, 55.0, -177.0, 36.0, -23.0, 1.0, 62.0, 0.0, -31.0, 44.0, -26.0, -91.0, -9.0, 36.0, 17.0, -10.0, -24.0, -11.0, -34.0, -74.0, 22.0, 21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.0, -32.0, 55.0, 61.0, 104.0, 91.0, 105.0, 118.0, 0.0, 133.0, 0.0, -88.0, -150.0, -132.0, 184.0, 151.0, 29.0, 23.0, 105.0, 116.0, 96.0, -14.0, 70.0, 0.0, -34.0, -136.0, -126.0, 0.0, 0.0, 2.0, 160.0, -52.0, 85.0, 0.0, 60.0, -162.0, -6.0, -71.0, 111.0, 87.0, 0.0, 0.0, 78.0, 101.0, 78.0, 0.0, 53.0, -20.0, 5.0, -24.0, -12.0, 0.0, -47.0, 152.0, 0.0, -141.0, -28.0, -8.0, 53.0, 133.0, 93.0, 67.0, -34.0, -28.0, -40.0, -68.0, -162.0, -187.0, -215.0, 41.0, -183.0, 0.0, -15.0, -123.0, 80.0, -36.0, -2.0, -66.0, 34.0, 0.0, -84.0, -133.0, -30.0, 0.0, 97.0, -11.0, -26.0, -51.0, 0.0, 2.0, 13.0, -34.0, 41.0, -34.0, 0.0, -116.0, -50.0, 22.0, 18.0, -28.0, 0.0, 58.0, 55.0, 40.0, 48.0, 30.0, 0.0, -7.0, 0.0, 53.0, -23.0, 26.0, 18.0, 2.0, 30.0, -27.0, -20.0, -25.0, -109.0, 0.0, -241.0, -69.0, -91.0, -120.0, 7.0, -220.0, 128.0, 0.0, 0.0, -34.0, 2.0, 17.0, -89.0, -12.0, 0.0, 0.0, -82.0, -2.0, -12.0, -25.0, -13.0, 0.0, 0.0, -2.0, -88.0, -41.0, -33.0, -18.0, -2.0, 16.0, 0.0, 33.0, 0.0, 16.0, -22.0, 0.0, 10.0, -42.0, 55.0, 0.0, -104.0, -150.0, 0.0, 31.0, 0.0, -46.0, 0.0, 1.0, 16.0, 46.0, 0.0, 0.0, -62.0, 0.0, 31.0, 13.0, -52.0, 0.0, -76.0, -90.0, -14.0, -24.0, 1.0, 34.0, 14.0, -20.0, -12.0, -4.0, 0.0, -48.0, -22.0, 0.0, -32.0, -59.0, -52.0, -66.0, 0.0, 13.0, 21.0, 0.0], "policy_predator_policy_reward": [0.0, 19.0, 11.0, 4.0, 3.0, 4.0, 23.0, 0.0, 7.0, 0.0, 0.0, 44.0, 0.0, 125.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 22.0, 16.0, 2.0, 5.0, 70.0, 0.0, 0.0, 83.0, 19.0, 22.0, 26.0, 10.0, 26.0, 0.0, 8.0, 78.0, 6.0, 76.0, 5.0, 0.0, 0.0, 0.0, 5.0, 13.0, 0.0, 0.0, 0.0, 49.0, 24.0, 19.0, 0.0, 21.0, 53.0, 0.0, 0.0, 87.0, 0.0, 32.0, 0.0, 0.0, 0.0, 1.0, 17.0, 14.0, 2.0, 102.0, 138.0, 120.0, 82.0, 123.0, 0.0, 98.0, 101.0, 0.0, 0.0, 18.0, 33.0, 0.0, 20.0, 0.0, 110.0, 0.0, 15.0, 0.0, 40.0, 0.0, 37.0, 16.0, 0.0, 5.0, 21.0, 15.0, 26.0, 11.0, 68.0, 0.0, 0.0, 38.0, 14.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 74.0, 35.0, 0.0, 9.0, 10.0, 0.0, 79.0, 0.0, 19.0, 14.0, 11.0, 67.0, 0.0, 61.0, 37.0, 83.0, 86.0, 110.0, 53.0, 133.0, 0.0, 13.0, 0.0, 0.0, 17.0, 0.0, 0.0, 32.0, 52.0, 0.0, 0.0, 41.0, 0.0, 6.0, 17.0, 0.0, 9.0, 0.0, 1.0, 48.0, 55.0, 0.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 22.0, 0.0, 25.0, 6.0, 0.0, 0.0, 76.0, 1.0, 0.0, 5.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 0.0, 0.0, 0.0, 0.0, 26.0, 50.0, 25.0, 29.0, 0.0, 1.0, 0.0, 4.0, 19.0, 0.0, 6.0, 9.0, 15.0, 2.0, 9.0, 31.0, 26.0, 28.0, 16.0, 0.0, 9.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1800300716025602, "mean_inference_ms": 3.105690836396974, "mean_action_processing_ms": 0.45996675209037347, "mean_env_wait_ms": 0.4226732391155405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00892496109008789, "StateBufferConnector_ms": 0.01307976245880127, "ViewRequirementAgentConnector_ms": 0.2038252353668213}, "num_episodes": 18, "episode_return_max": 336.0, "episode_return_min": -177.0, "episode_return_mean": 25.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.35956025106174, "num_env_steps_trained_throughput_per_sec": 272.35956025106174, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 15485.071, "restore_workers_time_ms": 0.022, "training_step_time_ms": 15484.995, "sample_time_ms": 2687.046, "learn_time_ms": 12764.894, "learn_throughput": 313.359, "synch_weights_time_ms": 29.028}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "e1352_00000", "date": "2024-08-13_16-42-13", "timestamp": 1723581733, "time_this_iter_s": 14.747710227966309, "time_total_s": 255.11924839019775, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ad280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 255.11924839019775, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 76.92380952380952, "ram_util_percent": 85.35238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7797371205908281, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 1.261564466309926, "policy_loss": -0.004436481954707276, "vf_loss": 1.2575303660498725, "vf_explained_var": 0.13758931141051034, "kl": 0.01882351513212714, "entropy": 1.2443541010220847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.597826543355745, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.3148058912110705, "policy_loss": 0.003882680941131656, "vf_loss": 2.270622341941904, "vf_explained_var": -0.014025232337770008, "kl": 0.01769036606200783, "entropy": 1.0227911652711335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 203.0, "episode_reward_min": -177.0, "episode_reward_mean": 8.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -241.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 152.0, "predator_policy": 138.0}, "policy_reward_mean": {"prey_policy": -14.285, "predator_policy": 18.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 203.0, 0.0, 197.0, 78.0, 82.0, 24.0, 9.0, 158.0, -54.0, -4.0, 186.0, 161.0, -31.0, -4.0, -91.0, 31.0, -85.0, -37.0, 62.0, -35.0, 54.0, -107.0, -15.0, 126.0, -24.0, 7.0, 15.0, 44.0, -48.0, 10.0, 4.0, 58.0, 103.0, 152.0, 28.0, 72.0, 82.0, 39.0, 28.0, 22.0, -11.0, -141.0, -48.0, -80.0, 141.0, -17.0, 19.0, -17.0, 0.0, -43.0, -14.0, -4.0, -1.0, -26.0, -34.0, 15.0, 33.0, 22.0, 0.0, -1.0, 55.0, -177.0, 36.0, -23.0, 1.0, 62.0, 0.0, -31.0, 44.0, -26.0, -91.0, -9.0, 36.0, 17.0, -10.0, -24.0, -11.0, -34.0, -74.0, 22.0, 21.0, 28.0, -112.0, 9.0, -1.0, -22.0, 3.0, 10.0, -42.0, -124.0, 80.0, -4.0, -26.0, 2.0, -30.0, -9.0, 0.0, 13.0, 21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -71.0, 111.0, 87.0, 0.0, 0.0, 78.0, 101.0, 78.0, 0.0, 53.0, -20.0, 5.0, -24.0, -12.0, 0.0, -47.0, 152.0, 0.0, -141.0, -28.0, -8.0, 53.0, 133.0, 93.0, 67.0, -34.0, -28.0, -40.0, -68.0, -162.0, -187.0, -215.0, 41.0, -183.0, 0.0, -15.0, -123.0, 80.0, -36.0, -2.0, -66.0, 34.0, 0.0, -84.0, -133.0, -30.0, 0.0, 97.0, -11.0, -26.0, -51.0, 0.0, 2.0, 13.0, -34.0, 41.0, -34.0, 0.0, -116.0, -50.0, 22.0, 18.0, -28.0, 0.0, 58.0, 55.0, 40.0, 48.0, 30.0, 0.0, -7.0, 0.0, 53.0, -23.0, 26.0, 18.0, 2.0, 30.0, -27.0, -20.0, -25.0, -109.0, 0.0, -241.0, -69.0, -91.0, -120.0, 7.0, -220.0, 128.0, 0.0, 0.0, -34.0, 2.0, 17.0, -89.0, -12.0, 0.0, 0.0, -82.0, -2.0, -12.0, -25.0, -13.0, 0.0, 0.0, -2.0, -88.0, -41.0, -33.0, -18.0, -2.0, 16.0, 0.0, 33.0, 0.0, 16.0, -22.0, 0.0, 10.0, -42.0, 55.0, 0.0, -104.0, -150.0, 0.0, 31.0, 0.0, -46.0, 0.0, 1.0, 16.0, 46.0, 0.0, 0.0, -62.0, 0.0, 31.0, 13.0, -52.0, 0.0, -76.0, -90.0, -14.0, -24.0, 1.0, 34.0, 14.0, -20.0, -12.0, -4.0, 0.0, -48.0, -22.0, 0.0, -32.0, -59.0, -52.0, -66.0, 0.0, 13.0, 21.0, 0.0, 0.0, 28.0, -55.0, -152.0, 6.0, 0.0, -4.0, 0.0, 0.0, -44.0, 0.0, 0.0, 0.0, -4.0, -44.0, -40.0, -84.0, -104.0, 37.0, 43.0, -8.0, -10.0, -28.0, -24.0, -3.0, 0.0, -35.0, -40.0, 0.0, -18.0, 0.0, 0.0, 13.0, 0.0, -34.0, 38.0], "policy_predator_policy_reward": [6.0, 76.0, 5.0, 0.0, 0.0, 0.0, 5.0, 13.0, 0.0, 0.0, 0.0, 49.0, 24.0, 19.0, 0.0, 21.0, 53.0, 0.0, 0.0, 87.0, 0.0, 32.0, 0.0, 0.0, 0.0, 1.0, 17.0, 14.0, 2.0, 102.0, 138.0, 120.0, 82.0, 123.0, 0.0, 98.0, 101.0, 0.0, 0.0, 18.0, 33.0, 0.0, 20.0, 0.0, 110.0, 0.0, 15.0, 0.0, 40.0, 0.0, 37.0, 16.0, 0.0, 5.0, 21.0, 15.0, 26.0, 11.0, 68.0, 0.0, 0.0, 38.0, 14.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 74.0, 35.0, 0.0, 9.0, 10.0, 0.0, 79.0, 0.0, 19.0, 14.0, 11.0, 67.0, 0.0, 61.0, 37.0, 83.0, 86.0, 110.0, 53.0, 133.0, 0.0, 13.0, 0.0, 0.0, 17.0, 0.0, 0.0, 32.0, 52.0, 0.0, 0.0, 41.0, 0.0, 6.0, 17.0, 0.0, 9.0, 0.0, 1.0, 48.0, 55.0, 0.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 22.0, 0.0, 25.0, 6.0, 0.0, 0.0, 76.0, 1.0, 0.0, 5.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 0.0, 0.0, 0.0, 0.0, 26.0, 50.0, 25.0, 29.0, 0.0, 1.0, 0.0, 4.0, 19.0, 0.0, 6.0, 9.0, 15.0, 2.0, 9.0, 31.0, 26.0, 28.0, 16.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 78.0, 17.0, 0.0, 3.0, 1.0, 2.0, 22.0, 0.0, 0.0, 3.0, 7.0, 7.0, 0.0, 42.0, 64.0, 0.0, 0.0, 0.0, 0.0, 14.0, 14.0, 12.0, 2.0, 3.0, 38.0, 7.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 3.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1942928766012142, "mean_inference_ms": 3.1541780383392473, "mean_action_processing_ms": 0.46725380391336097, "mean_env_wait_ms": 0.429912824566853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00684809684753418, "StateBufferConnector_ms": 0.011976122856140137, "ViewRequirementAgentConnector_ms": 0.17411792278289795}, "num_episodes": 18, "episode_return_max": 203.0, "episode_return_min": -177.0, "episode_return_mean": 8.78, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.14779755634552, "num_env_steps_trained_throughput_per_sec": 252.14779755634552, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 15577.308, "restore_workers_time_ms": 0.022, "training_step_time_ms": 15577.232, "sample_time_ms": 2766.12, "learn_time_ms": 12778.88, "learn_throughput": 313.016, "synch_weights_time_ms": 27.81}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "e1352_00000", "date": "2024-08-13_16-42-29", "timestamp": 1723581749, "time_this_iter_s": 15.904227256774902, "time_total_s": 271.02347564697266, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ad310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 271.02347564697266, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 79.16818181818181, "ram_util_percent": 86.35909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.80435795524606, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 0.9566226269359942, "policy_loss": 7.949511461432963e-05, "vf_loss": 0.9483625846880454, "vf_explained_var": 0.10994178845138146, "kl": 0.01817899689064241, "entropy": 1.1979390307078286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.957624624393604, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.6299708342426038, "policy_loss": 0.002538476993019382, "vf_loss": 1.5881386517532288, "vf_explained_var": 0.00819142322060923, "kl": 0.017248267158971688, "entropy": 1.0219852251035195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 152.0, "episode_reward_min": -177.0, "episode_reward_mean": -2.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -241.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 128.0, "predator_policy": 133.0}, "policy_reward_mean": {"prey_policy": -15.975, "predator_policy": 14.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.0, -15.0, 126.0, -24.0, 7.0, 15.0, 44.0, -48.0, 10.0, 4.0, 58.0, 103.0, 152.0, 28.0, 72.0, 82.0, 39.0, 28.0, 22.0, -11.0, -141.0, -48.0, -80.0, 141.0, -17.0, 19.0, -17.0, 0.0, -43.0, -14.0, -4.0, -1.0, -26.0, -34.0, 15.0, 33.0, 22.0, 0.0, -1.0, 55.0, -177.0, 36.0, -23.0, 1.0, 62.0, 0.0, -31.0, 44.0, -26.0, -91.0, -9.0, 36.0, 17.0, -10.0, -24.0, -11.0, -34.0, -74.0, 22.0, 21.0, 28.0, -112.0, 9.0, -1.0, -22.0, 3.0, 10.0, -42.0, -124.0, 80.0, -4.0, -26.0, 2.0, -30.0, -9.0, 0.0, 13.0, 21.0, -7.0, 3.0, -9.0, -15.0, -6.0, 2.0, 35.0, 0.0, 0.0, 7.0, 60.0, -50.0, 1.0, -87.0, -11.0, -16.0, -21.0, 0.0, -75.0, -19.0, -1.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-84.0, -133.0, -30.0, 0.0, 97.0, -11.0, -26.0, -51.0, 0.0, 2.0, 13.0, -34.0, 41.0, -34.0, 0.0, -116.0, -50.0, 22.0, 18.0, -28.0, 0.0, 58.0, 55.0, 40.0, 48.0, 30.0, 0.0, -7.0, 0.0, 53.0, -23.0, 26.0, 18.0, 2.0, 30.0, -27.0, -20.0, -25.0, -109.0, 0.0, -241.0, -69.0, -91.0, -120.0, 7.0, -220.0, 128.0, 0.0, 0.0, -34.0, 2.0, 17.0, -89.0, -12.0, 0.0, 0.0, -82.0, -2.0, -12.0, -25.0, -13.0, 0.0, 0.0, -2.0, -88.0, -41.0, -33.0, -18.0, -2.0, 16.0, 0.0, 33.0, 0.0, 16.0, -22.0, 0.0, 10.0, -42.0, 55.0, 0.0, -104.0, -150.0, 0.0, 31.0, 0.0, -46.0, 0.0, 1.0, 16.0, 46.0, 0.0, 0.0, -62.0, 0.0, 31.0, 13.0, -52.0, 0.0, -76.0, -90.0, -14.0, -24.0, 1.0, 34.0, 14.0, -20.0, -12.0, -4.0, 0.0, -48.0, -22.0, 0.0, -32.0, -59.0, -52.0, -66.0, 0.0, 13.0, 21.0, 0.0, 0.0, 28.0, -55.0, -152.0, 6.0, 0.0, -4.0, 0.0, 0.0, -44.0, 0.0, 0.0, 0.0, -4.0, -44.0, -40.0, -84.0, -104.0, 37.0, 43.0, -8.0, -10.0, -28.0, -24.0, -3.0, 0.0, -35.0, -40.0, 0.0, -18.0, 0.0, 0.0, 13.0, 0.0, -34.0, 38.0, -5.0, -28.0, -15.0, -1.0, -14.0, -22.0, -30.0, 0.0, -6.0, -6.0, 0.0, 2.0, -22.0, 36.0, 0.0, 0.0, -4.0, 2.0, 7.0, 0.0, 30.0, 28.0, -58.0, -22.0, 0.0, 0.0, -42.0, -132.0, -29.0, 0.0, -28.0, -14.0, -34.0, -8.0, 0.0, 0.0, -72.0, -88.0, -4.0, -34.0, -2.0, 0.0, -59.0, -14.0], "policy_predator_policy_reward": [110.0, 0.0, 15.0, 0.0, 40.0, 0.0, 37.0, 16.0, 0.0, 5.0, 21.0, 15.0, 26.0, 11.0, 68.0, 0.0, 0.0, 38.0, 14.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 74.0, 35.0, 0.0, 9.0, 10.0, 0.0, 79.0, 0.0, 19.0, 14.0, 11.0, 67.0, 0.0, 61.0, 37.0, 83.0, 86.0, 110.0, 53.0, 133.0, 0.0, 13.0, 0.0, 0.0, 17.0, 0.0, 0.0, 32.0, 52.0, 0.0, 0.0, 41.0, 0.0, 6.0, 17.0, 0.0, 9.0, 0.0, 1.0, 48.0, 55.0, 0.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 22.0, 0.0, 25.0, 6.0, 0.0, 0.0, 76.0, 1.0, 0.0, 5.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 0.0, 0.0, 0.0, 0.0, 26.0, 50.0, 25.0, 29.0, 0.0, 1.0, 0.0, 4.0, 19.0, 0.0, 6.0, 9.0, 15.0, 2.0, 9.0, 31.0, 26.0, 28.0, 16.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 78.0, 17.0, 0.0, 3.0, 1.0, 2.0, 22.0, 0.0, 0.0, 3.0, 7.0, 7.0, 0.0, 42.0, 64.0, 0.0, 0.0, 0.0, 0.0, 14.0, 14.0, 12.0, 2.0, 3.0, 38.0, 7.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 3.0, 14.0, 3.0, 23.0, 19.0, 0.0, 16.0, 11.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 20.0, 0.0, 1.0, 66.0, 21.0, 14.0, 4.0, 0.0, 26.0, 17.0, 4.0, 0.0, 0.0, 45.0, 40.0, 19.0, 0.0, 1.0, 0.0, 40.0, 24.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1984662191418247, "mean_inference_ms": 3.169190669162962, "mean_action_processing_ms": 0.4705243267816918, "mean_env_wait_ms": 0.43427380974245094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006544947624206543, "StateBufferConnector_ms": 0.003466486930847168, "ViewRequirementAgentConnector_ms": 0.1619565486907959}, "num_episodes": 22, "episode_return_max": 152.0, "episode_return_min": -177.0, "episode_return_mean": -2.49, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.96708668196135, "num_env_steps_trained_throughput_per_sec": 250.96708668196135, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 15630.492, "restore_workers_time_ms": 0.022, "training_step_time_ms": 15630.416, "sample_time_ms": 2781.801, "learn_time_ms": 12819.43, "learn_throughput": 312.026, "synch_weights_time_ms": 24.778}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "e1352_00000", "date": "2024-08-13_16-42-45", "timestamp": 1723581765, "time_this_iter_s": 15.961575269699097, "time_total_s": 286.98505091667175, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15cea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 286.98505091667175, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 80.31739130434782, "ram_util_percent": 86.31739130434784}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6028540079003919, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 0.5356458129390838, "policy_loss": -0.004426670447977447, "vf_loss": 0.5323298893691528, "vf_explained_var": 0.1041842362237355, "kl": 0.017205762812349597, "entropy": 1.161488529803261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.178238832666761, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 0.9431370684354708, "policy_loss": 0.0027574372310289947, "vf_loss": 0.9040288347888876, "vf_explained_var": -0.03428467322909643, "kl": 0.01595645265209386, "entropy": 0.9679700028959406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 141.0, "episode_reward_min": -177.0, "episode_reward_mean": -3.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -152.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 128.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": -10.87, "predator_policy": 9.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, -17.0, 19.0, -17.0, 0.0, -43.0, -14.0, -4.0, -1.0, -26.0, -34.0, 15.0, 33.0, 22.0, 0.0, -1.0, 55.0, -177.0, 36.0, -23.0, 1.0, 62.0, 0.0, -31.0, 44.0, -26.0, -91.0, -9.0, 36.0, 17.0, -10.0, -24.0, -11.0, -34.0, -74.0, 22.0, 21.0, 28.0, -112.0, 9.0, -1.0, -22.0, 3.0, 10.0, -42.0, -124.0, 80.0, -4.0, -26.0, 2.0, -30.0, -9.0, 0.0, 13.0, 21.0, -7.0, 3.0, -9.0, -15.0, -6.0, 2.0, 35.0, 0.0, 0.0, 7.0, 60.0, -50.0, 1.0, -87.0, -11.0, -16.0, -21.0, 0.0, -75.0, -19.0, -1.0, -9.0, 31.0, 18.0, 4.0, 0.0, -6.0, -4.0, -3.0, 5.0, -1.0, 14.0, 43.0, 22.0, 22.0, 1.0, -2.0, 20.0, -27.0, 42.0, 25.0, 8.0, 15.0, 27.0, -25.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.0, 0.0, 0.0, -34.0, 2.0, 17.0, -89.0, -12.0, 0.0, 0.0, -82.0, -2.0, -12.0, -25.0, -13.0, 0.0, 0.0, -2.0, -88.0, -41.0, -33.0, -18.0, -2.0, 16.0, 0.0, 33.0, 0.0, 16.0, -22.0, 0.0, 10.0, -42.0, 55.0, 0.0, -104.0, -150.0, 0.0, 31.0, 0.0, -46.0, 0.0, 1.0, 16.0, 46.0, 0.0, 0.0, -62.0, 0.0, 31.0, 13.0, -52.0, 0.0, -76.0, -90.0, -14.0, -24.0, 1.0, 34.0, 14.0, -20.0, -12.0, -4.0, 0.0, -48.0, -22.0, 0.0, -32.0, -59.0, -52.0, -66.0, 0.0, 13.0, 21.0, 0.0, 0.0, 28.0, -55.0, -152.0, 6.0, 0.0, -4.0, 0.0, 0.0, -44.0, 0.0, 0.0, 0.0, -4.0, -44.0, -40.0, -84.0, -104.0, 37.0, 43.0, -8.0, -10.0, -28.0, -24.0, -3.0, 0.0, -35.0, -40.0, 0.0, -18.0, 0.0, 0.0, 13.0, 0.0, -34.0, 38.0, -5.0, -28.0, -15.0, -1.0, -14.0, -22.0, -30.0, 0.0, -6.0, -6.0, 0.0, 2.0, -22.0, 36.0, 0.0, 0.0, -4.0, 2.0, 7.0, 0.0, 30.0, 28.0, -58.0, -22.0, 0.0, 0.0, -42.0, -132.0, -29.0, 0.0, -28.0, -14.0, -34.0, -8.0, 0.0, 0.0, -72.0, -88.0, -4.0, -34.0, -2.0, 0.0, -59.0, -14.0, 31.0, 0.0, -24.0, 29.0, 4.0, 0.0, 0.0, -14.0, -22.0, -10.0, 0.0, -8.0, -21.0, 6.0, -11.0, -2.0, -2.0, 0.0, 9.0, 3.0, 9.0, 34.0, 10.0, 3.0, -16.0, 28.0, 0.0, -19.0, 0.0, -4.0, -6.0, 23.0, -68.0, 6.0, 24.0, 18.0, 18.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 26.0, -26.0, -14.0], "policy_predator_policy_reward": [13.0, 0.0, 0.0, 17.0, 0.0, 0.0, 32.0, 52.0, 0.0, 0.0, 41.0, 0.0, 6.0, 17.0, 0.0, 9.0, 0.0, 1.0, 48.0, 55.0, 0.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 22.0, 0.0, 25.0, 6.0, 0.0, 0.0, 76.0, 1.0, 0.0, 5.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 0.0, 0.0, 0.0, 0.0, 26.0, 50.0, 25.0, 29.0, 0.0, 1.0, 0.0, 4.0, 19.0, 0.0, 6.0, 9.0, 15.0, 2.0, 9.0, 31.0, 26.0, 28.0, 16.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 78.0, 17.0, 0.0, 3.0, 1.0, 2.0, 22.0, 0.0, 0.0, 3.0, 7.0, 7.0, 0.0, 42.0, 64.0, 0.0, 0.0, 0.0, 0.0, 14.0, 14.0, 12.0, 2.0, 3.0, 38.0, 7.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 3.0, 14.0, 3.0, 23.0, 19.0, 0.0, 16.0, 11.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 20.0, 0.0, 1.0, 66.0, 21.0, 14.0, 4.0, 0.0, 26.0, 17.0, 4.0, 0.0, 0.0, 45.0, 40.0, 19.0, 0.0, 1.0, 0.0, 40.0, 24.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 26.0, 4.0, 0.0, 0.0, 12.0, 18.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 6.0, 3.0, 10.0, 0.0, 0.0, 20.0, 0.0, 2.0, 0.0, 3.0, 21.0, 14.0, 0.0, 0.0, 0.0, 7.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1890879446474634, "mean_inference_ms": 3.149659694481538, "mean_action_processing_ms": 0.4678410990027331, "mean_env_wait_ms": 0.43359354444549436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007199883460998535, "StateBufferConnector_ms": 0.004429221153259277, "ViewRequirementAgentConnector_ms": 0.15024566650390625}, "num_episodes": 23, "episode_return_max": 141.0, "episode_return_min": -177.0, "episode_return_mean": -3.36, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.2524078098077, "num_env_steps_trained_throughput_per_sec": 263.2524078098077, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 15700.227, "restore_workers_time_ms": 0.022, "training_step_time_ms": 15700.152, "sample_time_ms": 2855.114, "learn_time_ms": 12819.67, "learn_throughput": 312.021, "synch_weights_time_ms": 20.941}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "e1352_00000", "date": "2024-08-13_16-43-00", "timestamp": 1723581780, "time_this_iter_s": 15.25972604751587, "time_total_s": 302.2447769641876, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d5ed3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 302.2447769641876, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 78.09545454545456, "ram_util_percent": 86.26818181818179}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7926976521731054, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 0.626424250684718, "policy_loss": -0.006138673925368244, "vf_loss": 0.6241036161740936, "vf_explained_var": 0.19940594040527546, "kl": 0.018798460025829102, "entropy": 1.1238300358176863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.916668064774028, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.2108343962323729, "policy_loss": 0.002653600855745257, "vf_loss": 1.1699485791738702, "vf_explained_var": 0.053631859797018545, "kl": 0.01678231474984398, "entropy": 0.9317906330186854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 80.0, "episode_reward_min": -124.0, "episode_reward_mean": -4.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -152.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 46.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": -10.17, "predator_policy": 7.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0, -23.0, 1.0, 62.0, 0.0, -31.0, 44.0, -26.0, -91.0, -9.0, 36.0, 17.0, -10.0, -24.0, -11.0, -34.0, -74.0, 22.0, 21.0, 28.0, -112.0, 9.0, -1.0, -22.0, 3.0, 10.0, -42.0, -124.0, 80.0, -4.0, -26.0, 2.0, -30.0, -9.0, 0.0, 13.0, 21.0, -7.0, 3.0, -9.0, -15.0, -6.0, 2.0, 35.0, 0.0, 0.0, 7.0, 60.0, -50.0, 1.0, -87.0, -11.0, -16.0, -21.0, 0.0, -75.0, -19.0, -1.0, -9.0, 31.0, 18.0, 4.0, 0.0, -6.0, -4.0, -3.0, 5.0, -1.0, 14.0, 43.0, 22.0, 22.0, 1.0, -2.0, 20.0, -27.0, 42.0, 25.0, 8.0, 15.0, 27.0, -25.0, -12.0, 8.0, -46.0, -39.0, 3.0, 18.0, -41.0, 0.0, -30.0, -12.0, 7.0, -2.0, -5.0, -17.0, 2.0, -1.0, 0.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 31.0, 0.0, -46.0, 0.0, 1.0, 16.0, 46.0, 0.0, 0.0, -62.0, 0.0, 31.0, 13.0, -52.0, 0.0, -76.0, -90.0, -14.0, -24.0, 1.0, 34.0, 14.0, -20.0, -12.0, -4.0, 0.0, -48.0, -22.0, 0.0, -32.0, -59.0, -52.0, -66.0, 0.0, 13.0, 21.0, 0.0, 0.0, 28.0, -55.0, -152.0, 6.0, 0.0, -4.0, 0.0, 0.0, -44.0, 0.0, 0.0, 0.0, -4.0, -44.0, -40.0, -84.0, -104.0, 37.0, 43.0, -8.0, -10.0, -28.0, -24.0, -3.0, 0.0, -35.0, -40.0, 0.0, -18.0, 0.0, 0.0, 13.0, 0.0, -34.0, 38.0, -5.0, -28.0, -15.0, -1.0, -14.0, -22.0, -30.0, 0.0, -6.0, -6.0, 0.0, 2.0, -22.0, 36.0, 0.0, 0.0, -4.0, 2.0, 7.0, 0.0, 30.0, 28.0, -58.0, -22.0, 0.0, 0.0, -42.0, -132.0, -29.0, 0.0, -28.0, -14.0, -34.0, -8.0, 0.0, 0.0, -72.0, -88.0, -4.0, -34.0, -2.0, 0.0, -59.0, -14.0, 31.0, 0.0, -24.0, 29.0, 4.0, 0.0, 0.0, -14.0, -22.0, -10.0, 0.0, -8.0, -21.0, 6.0, -11.0, -2.0, -2.0, 0.0, 9.0, 3.0, 9.0, 34.0, 10.0, 3.0, -16.0, 28.0, 0.0, -19.0, 0.0, -4.0, -6.0, 23.0, -68.0, 6.0, 24.0, 18.0, 18.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 26.0, -26.0, -14.0, -24.0, 0.0, 0.0, 8.0, -54.0, -38.0, -26.0, -28.0, 0.0, 3.0, 0.0, 18.0, -22.0, -38.0, 0.0, 0.0, -34.0, -26.0, -14.0, -7.0, 0.0, 7.0, 0.0, -4.0, -6.0, -22.0, -10.0, -27.0, 0.0, -11.0, 0.0, -2.0, 0.0, 0.0, 0.0, 3.0], "policy_predator_policy_reward": [0.0, 5.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 0.0, 0.0, 0.0, 0.0, 26.0, 50.0, 25.0, 29.0, 0.0, 1.0, 0.0, 4.0, 19.0, 0.0, 6.0, 9.0, 15.0, 2.0, 9.0, 31.0, 26.0, 28.0, 16.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 78.0, 17.0, 0.0, 3.0, 1.0, 2.0, 22.0, 0.0, 0.0, 3.0, 7.0, 7.0, 0.0, 42.0, 64.0, 0.0, 0.0, 0.0, 0.0, 14.0, 14.0, 12.0, 2.0, 3.0, 38.0, 7.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 3.0, 14.0, 3.0, 23.0, 19.0, 0.0, 16.0, 11.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 20.0, 0.0, 1.0, 66.0, 21.0, 14.0, 4.0, 0.0, 26.0, 17.0, 4.0, 0.0, 0.0, 45.0, 40.0, 19.0, 0.0, 1.0, 0.0, 40.0, 24.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 26.0, 4.0, 0.0, 0.0, 12.0, 18.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 6.0, 3.0, 10.0, 0.0, 0.0, 20.0, 0.0, 2.0, 0.0, 3.0, 21.0, 14.0, 0.0, 0.0, 0.0, 7.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 15.0, 7.0, 5.0, 0.0, 0.0, 36.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 17.0, 13.0, 8.0, 1.0, 0.0, 0.0, 2.0, 0.0, 3.0, 20.0, 5.0, 15.0, 7.0, 6.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1764249530591357, "mean_inference_ms": 3.1201830742798284, "mean_action_processing_ms": 0.4635321533326836, "mean_env_wait_ms": 0.43010650419880664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007415175437927246, "StateBufferConnector_ms": 0.00443112850189209, "ViewRequirementAgentConnector_ms": 0.1395728588104248}, "num_episodes": 18, "episode_return_max": 80.0, "episode_return_min": -124.0, "episode_return_mean": -4.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.09282846009194, "num_env_steps_trained_throughput_per_sec": 274.09282846009194, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 15711.376, "restore_workers_time_ms": 0.022, "training_step_time_ms": 15711.301, "sample_time_ms": 2774.163, "learn_time_ms": 12913.399, "learn_throughput": 309.756, "synch_weights_time_ms": 19.415}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "e1352_00000", "date": "2024-08-13_16-43-15", "timestamp": 1723581795, "time_this_iter_s": 14.67930293083191, "time_total_s": 316.92407989501953, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af0fef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 316.92407989501953, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 76.58095238095238, "ram_util_percent": 86.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8817436595363591, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 0.5721430938552927, "policy_loss": -0.0026221243327079467, "vf_loss": 0.5660069661382487, "vf_explained_var": 0.12772095477770246, "kl": 0.019462779841159468, "entropy": 1.1305964094621164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.3216979478086746, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 1.2296882747184663, "policy_loss": 0.001624970972690751, "vf_loss": 1.1901471415367075, "vf_explained_var": -0.03355734433446612, "kl": 0.016643582851502445, "entropy": 0.9929466421326633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 80.0, "episode_reward_min": -124.0, "episode_reward_mean": -3.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -152.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": -9.38, "predator_policy": 7.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 28.0, -112.0, 9.0, -1.0, -22.0, 3.0, 10.0, -42.0, -124.0, 80.0, -4.0, -26.0, 2.0, -30.0, -9.0, 0.0, 13.0, 21.0, -7.0, 3.0, -9.0, -15.0, -6.0, 2.0, 35.0, 0.0, 0.0, 7.0, 60.0, -50.0, 1.0, -87.0, -11.0, -16.0, -21.0, 0.0, -75.0, -19.0, -1.0, -9.0, 31.0, 18.0, 4.0, 0.0, -6.0, -4.0, -3.0, 5.0, -1.0, 14.0, 43.0, 22.0, 22.0, 1.0, -2.0, 20.0, -27.0, 42.0, 25.0, 8.0, 15.0, 27.0, -25.0, -12.0, 8.0, -46.0, -39.0, 3.0, 18.0, -41.0, 0.0, -30.0, -12.0, 7.0, -2.0, -5.0, -17.0, 2.0, -1.0, 0.0, 12.0, 8.0, -28.0, 22.0, 18.0, -7.0, 12.0, -119.0, -19.0, -28.0, 0.0, 25.0, 37.0, 11.0, -8.0, -2.0, -21.0, 17.0, 13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [21.0, 0.0, 0.0, 28.0, -55.0, -152.0, 6.0, 0.0, -4.0, 0.0, 0.0, -44.0, 0.0, 0.0, 0.0, -4.0, -44.0, -40.0, -84.0, -104.0, 37.0, 43.0, -8.0, -10.0, -28.0, -24.0, -3.0, 0.0, -35.0, -40.0, 0.0, -18.0, 0.0, 0.0, 13.0, 0.0, -34.0, 38.0, -5.0, -28.0, -15.0, -1.0, -14.0, -22.0, -30.0, 0.0, -6.0, -6.0, 0.0, 2.0, -22.0, 36.0, 0.0, 0.0, -4.0, 2.0, 7.0, 0.0, 30.0, 28.0, -58.0, -22.0, 0.0, 0.0, -42.0, -132.0, -29.0, 0.0, -28.0, -14.0, -34.0, -8.0, 0.0, 0.0, -72.0, -88.0, -4.0, -34.0, -2.0, 0.0, -59.0, -14.0, 31.0, 0.0, -24.0, 29.0, 4.0, 0.0, 0.0, -14.0, -22.0, -10.0, 0.0, -8.0, -21.0, 6.0, -11.0, -2.0, -2.0, 0.0, 9.0, 3.0, 9.0, 34.0, 10.0, 3.0, -16.0, 28.0, 0.0, -19.0, 0.0, -4.0, -6.0, 23.0, -68.0, 6.0, 24.0, 18.0, 18.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 26.0, -26.0, -14.0, -24.0, 0.0, 0.0, 8.0, -54.0, -38.0, -26.0, -28.0, 0.0, 3.0, 0.0, 18.0, -22.0, -38.0, 0.0, 0.0, -34.0, -26.0, -14.0, -7.0, 0.0, 7.0, 0.0, -4.0, -6.0, -22.0, -10.0, -27.0, 0.0, -11.0, 0.0, -2.0, 0.0, 0.0, 0.0, 3.0, 12.0, -16.0, -2.0, -72.0, -14.0, 29.0, 18.0, 0.0, -26.0, 4.0, -16.0, 20.0, -100.0, -78.0, -40.0, 1.0, -24.0, -26.0, 0.0, 0.0, 0.0, 21.0, 8.0, 29.0, -5.0, 4.0, -12.0, -4.0, -2.0, -2.0, 7.0, -56.0, 0.0, 10.0, 11.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 78.0, 17.0, 0.0, 3.0, 1.0, 2.0, 22.0, 0.0, 0.0, 3.0, 7.0, 7.0, 0.0, 42.0, 64.0, 0.0, 0.0, 0.0, 0.0, 14.0, 14.0, 12.0, 2.0, 3.0, 38.0, 7.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 3.0, 14.0, 3.0, 23.0, 19.0, 0.0, 16.0, 11.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 20.0, 0.0, 1.0, 66.0, 21.0, 14.0, 4.0, 0.0, 26.0, 17.0, 4.0, 0.0, 0.0, 45.0, 40.0, 19.0, 0.0, 1.0, 0.0, 40.0, 24.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 26.0, 4.0, 0.0, 0.0, 12.0, 18.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 6.0, 3.0, 10.0, 0.0, 0.0, 20.0, 0.0, 2.0, 0.0, 3.0, 21.0, 14.0, 0.0, 0.0, 0.0, 7.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 15.0, 7.0, 5.0, 0.0, 0.0, 36.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 17.0, 13.0, 8.0, 1.0, 0.0, 0.0, 2.0, 0.0, 3.0, 20.0, 5.0, 15.0, 7.0, 6.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 4.0, 10.0, 36.0, 7.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 8.0, 14.0, 45.0, 0.0, 20.0, 22.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 2.0, 0.0, 17.0, 11.0, 0.0, 7.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1648179086129349, "mean_inference_ms": 3.093989573334596, "mean_action_processing_ms": 0.4598306221791876, "mean_env_wait_ms": 0.42673673133442863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005805492401123047, "StateBufferConnector_ms": 0.004713892936706543, "ViewRequirementAgentConnector_ms": 0.14562630653381348}, "num_episodes": 18, "episode_return_max": 80.0, "episode_return_min": -124.0, "episode_return_mean": -3.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.4622470241312, "num_env_steps_trained_throughput_per_sec": 271.4622470241312, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 15592.241, "restore_workers_time_ms": 0.022, "training_step_time_ms": 15592.169, "sample_time_ms": 2575.33, "learn_time_ms": 12993.692, "learn_throughput": 307.842, "synch_weights_time_ms": 19.332}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "e1352_00000", "date": "2024-08-13_16-43-29", "timestamp": 1723581809, "time_this_iter_s": 14.846899032592773, "time_total_s": 331.7709789276123, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af0feee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 331.7709789276123, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 76.01904761904763, "ram_util_percent": 86.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7351507536002568, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 1.2708101379492927, "policy_loss": -0.0013172120898075046, "vf_loss": 1.2643506524897126, "vf_explained_var": 0.08864532081538408, "kl": 0.017281548729814373, "entropy": 1.0863689156751783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.426899192273302, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 2.433340969760582, "policy_loss": 0.0043449687596568195, "vf_loss": 2.3855029752014807, "vf_explained_var": -0.019792295196068982, "kl": 0.01909158966948964, "entropy": 1.0047783166643174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -175.0, "episode_reward_mean": -7.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -139.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.0, "predator_policy": 85.0}, "policy_reward_mean": {"prey_policy": -11.075, "predator_policy": 7.565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -7.0, 3.0, -9.0, -15.0, -6.0, 2.0, 35.0, 0.0, 0.0, 7.0, 60.0, -50.0, 1.0, -87.0, -11.0, -16.0, -21.0, 0.0, -75.0, -19.0, -1.0, -9.0, 31.0, 18.0, 4.0, 0.0, -6.0, -4.0, -3.0, 5.0, -1.0, 14.0, 43.0, 22.0, 22.0, 1.0, -2.0, 20.0, -27.0, 42.0, 25.0, 8.0, 15.0, 27.0, -25.0, -12.0, 8.0, -46.0, -39.0, 3.0, 18.0, -41.0, 0.0, -30.0, -12.0, 7.0, -2.0, -5.0, -17.0, 2.0, -1.0, 0.0, 12.0, 8.0, -28.0, 22.0, 18.0, -7.0, 12.0, -119.0, -19.0, -28.0, 0.0, 25.0, 37.0, 11.0, -8.0, -2.0, -21.0, 17.0, 13.0, 8.0, 13.0, 12.0, 0.0, -4.0, -89.0, 4.0, -31.0, -2.0, -88.0, 0.0, -14.0, 9.0, -36.0, -130.0, 0.0, 13.0, -175.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.0, 38.0, -5.0, -28.0, -15.0, -1.0, -14.0, -22.0, -30.0, 0.0, -6.0, -6.0, 0.0, 2.0, -22.0, 36.0, 0.0, 0.0, -4.0, 2.0, 7.0, 0.0, 30.0, 28.0, -58.0, -22.0, 0.0, 0.0, -42.0, -132.0, -29.0, 0.0, -28.0, -14.0, -34.0, -8.0, 0.0, 0.0, -72.0, -88.0, -4.0, -34.0, -2.0, 0.0, -59.0, -14.0, 31.0, 0.0, -24.0, 29.0, 4.0, 0.0, 0.0, -14.0, -22.0, -10.0, 0.0, -8.0, -21.0, 6.0, -11.0, -2.0, -2.0, 0.0, 9.0, 3.0, 9.0, 34.0, 10.0, 3.0, -16.0, 28.0, 0.0, -19.0, 0.0, -4.0, -6.0, 23.0, -68.0, 6.0, 24.0, 18.0, 18.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 26.0, -26.0, -14.0, -24.0, 0.0, 0.0, 8.0, -54.0, -38.0, -26.0, -28.0, 0.0, 3.0, 0.0, 18.0, -22.0, -38.0, 0.0, 0.0, -34.0, -26.0, -14.0, -7.0, 0.0, 7.0, 0.0, -4.0, -6.0, -22.0, -10.0, -27.0, 0.0, -11.0, 0.0, -2.0, 0.0, 0.0, 0.0, 3.0, 12.0, -16.0, -2.0, -72.0, -14.0, 29.0, 18.0, 0.0, -26.0, 4.0, -16.0, 20.0, -100.0, -78.0, -40.0, 1.0, -24.0, -26.0, 0.0, 0.0, 0.0, 21.0, 8.0, 29.0, -5.0, 4.0, -12.0, -4.0, -2.0, -2.0, 7.0, -56.0, 0.0, 10.0, 11.0, 0.0, 0.0, -1.0, 0.0, 12.0, 12.0, 0.0, 0.0, 0.0, 2.0, -12.0, -128.0, -25.0, -2.0, 0.0, -10.0, -44.0, -4.0, 0.0, -60.0, -58.0, 0.0, 0.0, -17.0, -24.0, -12.0, 15.0, -65.0, -11.0, -127.0, -74.0, 0.0, 0.0, 0.0, 13.0, -139.0, -129.0], "policy_predator_policy_reward": [3.0, 14.0, 3.0, 23.0, 19.0, 0.0, 16.0, 11.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 20.0, 0.0, 1.0, 66.0, 21.0, 14.0, 4.0, 0.0, 26.0, 17.0, 4.0, 0.0, 0.0, 45.0, 40.0, 19.0, 0.0, 1.0, 0.0, 40.0, 24.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 26.0, 4.0, 0.0, 0.0, 12.0, 18.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 6.0, 3.0, 10.0, 0.0, 0.0, 20.0, 0.0, 2.0, 0.0, 3.0, 21.0, 14.0, 0.0, 0.0, 0.0, 7.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 15.0, 7.0, 5.0, 0.0, 0.0, 36.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 17.0, 13.0, 8.0, 1.0, 0.0, 0.0, 2.0, 0.0, 3.0, 20.0, 5.0, 15.0, 7.0, 6.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 4.0, 10.0, 36.0, 7.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 8.0, 14.0, 45.0, 0.0, 20.0, 22.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 2.0, 0.0, 17.0, 11.0, 0.0, 7.0, 0.0, 2.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 64.0, 0.0, 2.0, 4.0, 23.0, 0.0, 2.0, 0.0, 0.0, 30.0, 0.0, 0.0, 27.0, 0.0, 0.0, 6.0, 39.0, 1.0, 71.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1526886285658362, "mean_inference_ms": 3.0659624718320093, "mean_action_processing_ms": 0.4562789067122196, "mean_env_wait_ms": 0.42332914138831584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054531097412109375, "StateBufferConnector_ms": 0.0044716596603393555, "ViewRequirementAgentConnector_ms": 0.12406718730926514}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -175.0, "episode_return_mean": -7.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.7224549701727, "num_env_steps_trained_throughput_per_sec": 256.7224549701727, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 15651.242, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15651.175, "sample_time_ms": 2437.932, "learn_time_ms": 13189.728, "learn_throughput": 303.266, "synch_weights_time_ms": 19.832}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "e1352_00000", "date": "2024-08-13_16-43-45", "timestamp": 1723581825, "time_this_iter_s": 15.637436866760254, "time_total_s": 347.40841579437256, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1608700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 347.40841579437256, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 79.63181818181819, "ram_util_percent": 86.51363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0594349384859756, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.009999999999999998, "total_loss": 2.7185110295260393, "policy_loss": 0.003907190414303273, "vf_loss": 2.7041826742036004, "vf_explained_var": 0.12820567435057706, "kl": 0.023158143007142744, "entropy": 0.961265618870498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.576413025616338, "cur_kl_coeff": 2.278124999999999, "cur_lr": 0.009999999999999998, "total_loss": 4.613775005542412, "policy_loss": 0.006742487757382964, "vf_loss": 4.559438541452721, "vf_explained_var": -0.0001832390273058856, "kl": 0.02089172679397172, "entropy": 1.0208928165927766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 43.0, "episode_reward_min": -525.0, "episode_reward_mean": -40.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -362.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 34.0, "predator_policy": 181.0}, "policy_reward_mean": {"prey_policy": -34.42, "predator_policy": 14.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -4.0, -3.0, 5.0, -1.0, 14.0, 43.0, 22.0, 22.0, 1.0, -2.0, 20.0, -27.0, 42.0, 25.0, 8.0, 15.0, 27.0, -25.0, -12.0, 8.0, -46.0, -39.0, 3.0, 18.0, -41.0, 0.0, -30.0, -12.0, 7.0, -2.0, -5.0, -17.0, 2.0, -1.0, 0.0, 12.0, 8.0, -28.0, 22.0, 18.0, -7.0, 12.0, -119.0, -19.0, -28.0, 0.0, 25.0, 37.0, 11.0, -8.0, -2.0, -21.0, 17.0, 13.0, 8.0, 13.0, 12.0, 0.0, -4.0, -89.0, 4.0, -31.0, -2.0, -88.0, 0.0, -14.0, 9.0, -36.0, -130.0, 0.0, 13.0, -175.0, -143.0, -212.0, 28.0, 0.0, -256.0, -300.0, -5.0, -299.0, -192.0, 0.0, 3.0, 36.0, -23.0, -458.0, -227.0, -95.0, 0.0, 15.0, -31.0, 4.0, -311.0, -13.0, -480.0, 0.0, -16.0, -6.0, -525.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.0, -10.0, 0.0, -8.0, -21.0, 6.0, -11.0, -2.0, -2.0, 0.0, 9.0, 3.0, 9.0, 34.0, 10.0, 3.0, -16.0, 28.0, 0.0, -19.0, 0.0, -4.0, -6.0, 23.0, -68.0, 6.0, 24.0, 18.0, 18.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 26.0, -26.0, -14.0, -24.0, 0.0, 0.0, 8.0, -54.0, -38.0, -26.0, -28.0, 0.0, 3.0, 0.0, 18.0, -22.0, -38.0, 0.0, 0.0, -34.0, -26.0, -14.0, -7.0, 0.0, 7.0, 0.0, -4.0, -6.0, -22.0, -10.0, -27.0, 0.0, -11.0, 0.0, -2.0, 0.0, 0.0, 0.0, 3.0, 12.0, -16.0, -2.0, -72.0, -14.0, 29.0, 18.0, 0.0, -26.0, 4.0, -16.0, 20.0, -100.0, -78.0, -40.0, 1.0, -24.0, -26.0, 0.0, 0.0, 0.0, 21.0, 8.0, 29.0, -5.0, 4.0, -12.0, -4.0, -2.0, -2.0, 7.0, -56.0, 0.0, 10.0, 11.0, 0.0, 0.0, -1.0, 0.0, 12.0, 12.0, 0.0, 0.0, 0.0, 2.0, -12.0, -128.0, -25.0, -2.0, 0.0, -10.0, -44.0, -4.0, 0.0, -60.0, -58.0, 0.0, 0.0, -17.0, -24.0, -12.0, 15.0, -65.0, -11.0, -127.0, -74.0, 0.0, 0.0, 0.0, 13.0, -139.0, -129.0, -120.0, -83.0, -145.0, -155.0, 21.0, 7.0, 0.0, 0.0, -182.0, -183.0, -196.0, -245.0, -28.0, 9.0, -193.0, -245.0, -144.0, -122.0, 0.0, 0.0, 3.0, 0.0, 10.0, 23.0, -18.0, -28.0, -352.0, -296.0, -196.0, -142.0, -68.0, -63.0, 0.0, 0.0, 15.0, 0.0, 5.0, -88.0, 5.0, -58.0, -308.0, -279.0, 0.0, -26.0, -328.0, -331.0, 0.0, 0.0, -50.0, -8.0, -46.0, 7.0, -344.0, -362.0], "policy_predator_policy_reward": [0.0, 26.0, 4.0, 0.0, 0.0, 12.0, 18.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 6.0, 3.0, 10.0, 0.0, 0.0, 20.0, 0.0, 2.0, 0.0, 3.0, 21.0, 14.0, 0.0, 0.0, 0.0, 7.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 15.0, 7.0, 5.0, 0.0, 0.0, 36.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 17.0, 13.0, 8.0, 1.0, 0.0, 0.0, 2.0, 0.0, 3.0, 20.0, 5.0, 15.0, 7.0, 6.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 4.0, 10.0, 36.0, 7.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 8.0, 14.0, 45.0, 0.0, 20.0, 22.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 2.0, 0.0, 17.0, 11.0, 0.0, 7.0, 0.0, 2.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 64.0, 0.0, 2.0, 4.0, 23.0, 0.0, 2.0, 0.0, 0.0, 30.0, 0.0, 0.0, 27.0, 0.0, 0.0, 6.0, 39.0, 1.0, 71.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 8.0, 60.0, 0.0, 0.0, 88.0, 0.0, 0.0, 0.0, 0.0, 109.0, 0.0, 53.0, 88.0, 1.0, 13.0, 0.0, 139.0, 74.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 23.0, 0.0, 176.0, 14.0, 7.0, 104.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 39.0, 28.0, 29.0, 172.0, 104.0, 13.0, 0.0, 174.0, 5.0, 0.0, 0.0, 37.0, 5.0, 11.0, 22.0, 181.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1412730356441563, "mean_inference_ms": 3.028097525339541, "mean_action_processing_ms": 0.4510364353740814, "mean_env_wait_ms": 0.4192270614775974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016071081161499023, "StateBufferConnector_ms": 0.0057898759841918945, "ViewRequirementAgentConnector_ms": 0.1746826171875}, "num_episodes": 27, "episode_return_max": 43.0, "episode_return_min": -525.0, "episode_return_mean": -40.64, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.6249077952852, "num_env_steps_trained_throughput_per_sec": 273.6249077952852, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 15566.261, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15566.197, "sample_time_ms": 2283.894, "learn_time_ms": 13259.299, "learn_throughput": 301.675, "synch_weights_time_ms": 19.817}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "e1352_00000", "date": "2024-08-13_16-44-00", "timestamp": 1723581840, "time_this_iter_s": 14.668468952178955, "time_total_s": 362.0768847465515, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15adee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 362.0768847465515, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 78.68571428571428, "ram_util_percent": 86.42380952380952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0130675362452628, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 3.366457351301082, "policy_loss": -0.0017436339367161353, "vf_loss": 3.3573688196757483, "vf_explained_var": 0.20023436552633053, "kl": 0.01604766104734909, "entropy": 0.984846732761494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.808522111429739, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 6.0664774147921765, "policy_loss": 0.0011152018861914123, "vf_loss": 6.025787257139014, "vf_explained_var": -5.9920013266265704e-09, "kl": 0.011581148062706683, "entropy": 1.0047711548666474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": -525.0, "episode_reward_mean": -71.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -362.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 29.0, "predator_policy": 181.0}, "policy_reward_mean": {"prey_policy": -55.89, "predator_policy": 20.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.0, -12.0, 8.0, -46.0, -39.0, 3.0, 18.0, -41.0, 0.0, -30.0, -12.0, 7.0, -2.0, -5.0, -17.0, 2.0, -1.0, 0.0, 12.0, 8.0, -28.0, 22.0, 18.0, -7.0, 12.0, -119.0, -19.0, -28.0, 0.0, 25.0, 37.0, 11.0, -8.0, -2.0, -21.0, 17.0, 13.0, 8.0, 13.0, 12.0, 0.0, -4.0, -89.0, 4.0, -31.0, -2.0, -88.0, 0.0, -14.0, 9.0, -36.0, -130.0, 0.0, 13.0, -175.0, -143.0, -212.0, 28.0, 0.0, -256.0, -300.0, -5.0, -299.0, -192.0, 0.0, 3.0, 36.0, -23.0, -458.0, -227.0, -95.0, 0.0, 15.0, -31.0, 4.0, -311.0, -13.0, -480.0, 0.0, -16.0, -6.0, -525.0, -4.0, -307.0, -370.0, -155.0, -438.0, -113.0, -349.0, -220.0, -299.0, 0.0, -494.0, -2.0, 6.0, -78.0, 0.0, -110.0, 26.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.0, -14.0, -24.0, 0.0, 0.0, 8.0, -54.0, -38.0, -26.0, -28.0, 0.0, 3.0, 0.0, 18.0, -22.0, -38.0, 0.0, 0.0, -34.0, -26.0, -14.0, -7.0, 0.0, 7.0, 0.0, -4.0, -6.0, -22.0, -10.0, -27.0, 0.0, -11.0, 0.0, -2.0, 0.0, 0.0, 0.0, 3.0, 12.0, -16.0, -2.0, -72.0, -14.0, 29.0, 18.0, 0.0, -26.0, 4.0, -16.0, 20.0, -100.0, -78.0, -40.0, 1.0, -24.0, -26.0, 0.0, 0.0, 0.0, 21.0, 8.0, 29.0, -5.0, 4.0, -12.0, -4.0, -2.0, -2.0, 7.0, -56.0, 0.0, 10.0, 11.0, 0.0, 0.0, -1.0, 0.0, 12.0, 12.0, 0.0, 0.0, 0.0, 2.0, -12.0, -128.0, -25.0, -2.0, 0.0, -10.0, -44.0, -4.0, 0.0, -60.0, -58.0, 0.0, 0.0, -17.0, -24.0, -12.0, 15.0, -65.0, -11.0, -127.0, -74.0, 0.0, 0.0, 0.0, 13.0, -139.0, -129.0, -120.0, -83.0, -145.0, -155.0, 21.0, 7.0, 0.0, 0.0, -182.0, -183.0, -196.0, -245.0, -28.0, 9.0, -193.0, -245.0, -144.0, -122.0, 0.0, 0.0, 3.0, 0.0, 10.0, 23.0, -18.0, -28.0, -352.0, -296.0, -196.0, -142.0, -68.0, -63.0, 0.0, 0.0, 15.0, 0.0, 5.0, -88.0, 5.0, -58.0, -308.0, -279.0, 0.0, -26.0, -328.0, -331.0, 0.0, 0.0, -50.0, -8.0, -46.0, 7.0, -344.0, -362.0, 0.0, -23.0, -318.0, -204.0, -265.0, -242.0, -161.0, -97.0, -292.0, -310.0, -116.0, -58.0, -232.0, -246.0, -159.0, -152.0, -222.0, -206.0, 0.0, 0.0, -336.0, -326.0, 1.0, -17.0, 0.0, 6.0, -56.0, -65.0, 0.0, -1.0, -110.0, -65.0, 24.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 15.0, 7.0, 5.0, 0.0, 0.0, 36.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 17.0, 13.0, 8.0, 1.0, 0.0, 0.0, 2.0, 0.0, 3.0, 20.0, 5.0, 15.0, 7.0, 6.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 4.0, 10.0, 36.0, 7.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 8.0, 14.0, 45.0, 0.0, 20.0, 22.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 2.0, 0.0, 17.0, 11.0, 0.0, 7.0, 0.0, 2.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 64.0, 0.0, 2.0, 4.0, 23.0, 0.0, 2.0, 0.0, 0.0, 30.0, 0.0, 0.0, 27.0, 0.0, 0.0, 6.0, 39.0, 1.0, 71.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 8.0, 60.0, 0.0, 0.0, 88.0, 0.0, 0.0, 0.0, 0.0, 109.0, 0.0, 53.0, 88.0, 1.0, 13.0, 0.0, 139.0, 74.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 23.0, 0.0, 176.0, 14.0, 7.0, 104.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 39.0, 28.0, 29.0, 172.0, 104.0, 13.0, 0.0, 174.0, 5.0, 0.0, 0.0, 37.0, 5.0, 11.0, 22.0, 181.0, 0.0, 9.0, 10.0, 56.0, 159.0, 18.0, 119.0, 74.0, 29.0, 164.0, 0.0, 2.0, 59.0, 124.0, 5.0, 90.0, 1.0, 8.0, 121.0, 0.0, 0.0, 168.0, 0.0, 13.0, 1.0, 0.0, 0.0, 0.0, 43.0, 1.0, 0.0, 0.0, 65.0, 0.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1295812273618742, "mean_inference_ms": 3.001348971501648, "mean_action_processing_ms": 0.44759445791420643, "mean_env_wait_ms": 0.4153198119243062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016178131103515625, "StateBufferConnector_ms": 0.0048449039459228516, "ViewRequirementAgentConnector_ms": 0.17078053951263428}, "num_episodes": 18, "episode_return_max": 37.0, "episode_return_min": -525.0, "episode_return_mean": -71.72, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.695493273198, "num_env_steps_trained_throughput_per_sec": 271.695493273198, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 15217.952, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15217.889, "sample_time_ms": 2055.862, "learn_time_ms": 13140.328, "learn_throughput": 304.406, "synch_weights_time_ms": 18.988}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "e1352_00000", "date": "2024-08-13_16-44-15", "timestamp": 1723581855, "time_this_iter_s": 14.796891927719116, "time_total_s": 376.87377667427063, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af103a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 376.87377667427063, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 78.41499999999999, "ram_util_percent": 86.39500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8587076068003342, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 3.5762015531933495, "policy_loss": 0.0024167739953747185, "vf_loss": 3.56329274820903, "vf_explained_var": 0.2673661721761895, "kl": 0.015543730189673529, "entropy": 0.8972321600194961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.556268289322576, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 6.40907721141028, "policy_loss": 0.0023401616242216534, "vf_loss": 6.3672866248579885, "vf_explained_var": -7.82113857370205e-09, "kl": 0.011544706989748408, "entropy": 1.0059210805981247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 37.0, "episode_reward_min": -588.0, "episode_reward_mean": -119.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 29.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -89.065, "predator_policy": 29.305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 8.0, -28.0, 22.0, 18.0, -7.0, 12.0, -119.0, -19.0, -28.0, 0.0, 25.0, 37.0, 11.0, -8.0, -2.0, -21.0, 17.0, 13.0, 8.0, 13.0, 12.0, 0.0, -4.0, -89.0, 4.0, -31.0, -2.0, -88.0, 0.0, -14.0, 9.0, -36.0, -130.0, 0.0, 13.0, -175.0, -143.0, -212.0, 28.0, 0.0, -256.0, -300.0, -5.0, -299.0, -192.0, 0.0, 3.0, 36.0, -23.0, -458.0, -227.0, -95.0, 0.0, 15.0, -31.0, 4.0, -311.0, -13.0, -480.0, 0.0, -16.0, -6.0, -525.0, -4.0, -307.0, -370.0, -155.0, -438.0, -113.0, -349.0, -220.0, -299.0, 0.0, -494.0, -2.0, 6.0, -78.0, 0.0, -110.0, 26.0, 0.0, -300.0, -150.0, -421.0, 15.0, -67.0, -378.0, -335.0, -291.0, -371.0, -13.0, -453.0, 21.0, -224.0, -477.0, 0.0, -506.0, -434.0, -588.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 3.0, 12.0, -16.0, -2.0, -72.0, -14.0, 29.0, 18.0, 0.0, -26.0, 4.0, -16.0, 20.0, -100.0, -78.0, -40.0, 1.0, -24.0, -26.0, 0.0, 0.0, 0.0, 21.0, 8.0, 29.0, -5.0, 4.0, -12.0, -4.0, -2.0, -2.0, 7.0, -56.0, 0.0, 10.0, 11.0, 0.0, 0.0, -1.0, 0.0, 12.0, 12.0, 0.0, 0.0, 0.0, 2.0, -12.0, -128.0, -25.0, -2.0, 0.0, -10.0, -44.0, -4.0, 0.0, -60.0, -58.0, 0.0, 0.0, -17.0, -24.0, -12.0, 15.0, -65.0, -11.0, -127.0, -74.0, 0.0, 0.0, 0.0, 13.0, -139.0, -129.0, -120.0, -83.0, -145.0, -155.0, 21.0, 7.0, 0.0, 0.0, -182.0, -183.0, -196.0, -245.0, -28.0, 9.0, -193.0, -245.0, -144.0, -122.0, 0.0, 0.0, 3.0, 0.0, 10.0, 23.0, -18.0, -28.0, -352.0, -296.0, -196.0, -142.0, -68.0, -63.0, 0.0, 0.0, 15.0, 0.0, 5.0, -88.0, 5.0, -58.0, -308.0, -279.0, 0.0, -26.0, -328.0, -331.0, 0.0, 0.0, -50.0, -8.0, -46.0, 7.0, -344.0, -362.0, 0.0, -23.0, -318.0, -204.0, -265.0, -242.0, -161.0, -97.0, -292.0, -310.0, -116.0, -58.0, -232.0, -246.0, -159.0, -152.0, -222.0, -206.0, 0.0, 0.0, -336.0, -326.0, 1.0, -17.0, 0.0, 6.0, -56.0, -65.0, 0.0, -1.0, -110.0, -65.0, 24.0, 0.0, 0.0, 0.0, -210.0, -198.0, -132.0, -86.0, -269.0, -310.0, 9.0, 6.0, -98.0, -18.0, -354.0, -230.0, -232.0, -230.0, -207.0, -221.0, -280.0, -241.0, 0.0, -26.0, -342.0, -351.0, 18.0, 3.0, -134.0, -187.0, -320.0, -318.0, 0.0, 0.0, -330.0, -352.0, -288.0, -316.0, -400.0, -388.0], "policy_predator_policy_reward": [9.0, 0.0, 8.0, 4.0, 10.0, 36.0, 7.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 8.0, 14.0, 45.0, 0.0, 20.0, 22.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 2.0, 0.0, 17.0, 11.0, 0.0, 7.0, 0.0, 2.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 64.0, 0.0, 2.0, 4.0, 23.0, 0.0, 2.0, 0.0, 0.0, 30.0, 0.0, 0.0, 27.0, 0.0, 0.0, 6.0, 39.0, 1.0, 71.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 8.0, 60.0, 0.0, 0.0, 88.0, 0.0, 0.0, 0.0, 0.0, 109.0, 0.0, 53.0, 88.0, 1.0, 13.0, 0.0, 139.0, 74.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 23.0, 0.0, 176.0, 14.0, 7.0, 104.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 39.0, 28.0, 29.0, 172.0, 104.0, 13.0, 0.0, 174.0, 5.0, 0.0, 0.0, 37.0, 5.0, 11.0, 22.0, 181.0, 0.0, 9.0, 10.0, 56.0, 159.0, 18.0, 119.0, 74.0, 29.0, 164.0, 0.0, 2.0, 59.0, 124.0, 5.0, 90.0, 1.0, 8.0, 121.0, 0.0, 0.0, 168.0, 0.0, 13.0, 1.0, 0.0, 0.0, 0.0, 43.0, 1.0, 0.0, 0.0, 65.0, 0.0, 2.0, 0.0, 0.0, 107.0, 1.0, 25.0, 43.0, 158.0, 0.0, 0.0, 0.0, 49.0, 0.0, 130.0, 76.0, 0.0, 127.0, 128.0, 9.0, 0.0, 150.0, 0.0, 13.0, 69.0, 171.0, 0.0, 0.0, 95.0, 2.0, 0.0, 161.0, 0.0, 0.0, 0.0, 176.0, 163.0, 7.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.12067963248796, "mean_inference_ms": 2.9744469159787044, "mean_action_processing_ms": 0.4822512609225156, "mean_env_wait_ms": 0.41190202119127034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0192948579788208, "StateBufferConnector_ms": 0.004906654357910156, "ViewRequirementAgentConnector_ms": 0.1787015199661255}, "num_episodes": 18, "episode_return_max": 37.0, "episode_return_min": -588.0, "episode_return_mean": -119.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.95128481907847, "num_env_steps_trained_throughput_per_sec": 217.95128481907847, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 15428.644, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15428.581, "sample_time_ms": 2172.647, "learn_time_ms": 13235.414, "learn_throughput": 302.219, "synch_weights_time_ms": 17.487}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "e1352_00000", "date": "2024-08-13_16-44-33", "timestamp": 1723581873, "time_this_iter_s": 18.44796395301819, "time_total_s": 395.3217406272888, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15afaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 395.3217406272888, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 78.95555555555556, "ram_util_percent": 84.82962962962964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7197929231341553, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.1021483105957195, "policy_loss": -0.000938352048963742, "vf_loss": 2.0932518490407834, "vf_explained_var": 0.2849407346791061, "kl": 0.014570096727988053, "entropy": 0.9300675067636702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.912993062614764, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.764546178131507, "policy_loss": 0.002360924677652302, "vf_loss": 3.7238668092344174, "vf_explained_var": -8.514949253627232e-09, "kl": 0.011213446518770922, "entropy": 0.9027004067859953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 36.0, "episode_reward_min": -588.0, "episode_reward_mean": -146.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 24.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -107.64, "predator_policy": 34.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0, 8.0, 13.0, 12.0, 0.0, -4.0, -89.0, 4.0, -31.0, -2.0, -88.0, 0.0, -14.0, 9.0, -36.0, -130.0, 0.0, 13.0, -175.0, -143.0, -212.0, 28.0, 0.0, -256.0, -300.0, -5.0, -299.0, -192.0, 0.0, 3.0, 36.0, -23.0, -458.0, -227.0, -95.0, 0.0, 15.0, -31.0, 4.0, -311.0, -13.0, -480.0, 0.0, -16.0, -6.0, -525.0, -4.0, -307.0, -370.0, -155.0, -438.0, -113.0, -349.0, -220.0, -299.0, 0.0, -494.0, -2.0, 6.0, -78.0, 0.0, -110.0, 26.0, 0.0, -300.0, -150.0, -421.0, 15.0, -67.0, -378.0, -335.0, -291.0, -371.0, -13.0, -453.0, 21.0, -224.0, -477.0, 0.0, -506.0, -434.0, -588.0, -12.0, -206.0, -46.0, 36.0, -318.0, -151.0, -437.0, -383.0, 0.0, -7.0, -3.0, 23.0, 20.0, -426.0, -530.0, 0.0, -300.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [11.0, 0.0, 0.0, -1.0, 0.0, 12.0, 12.0, 0.0, 0.0, 0.0, 2.0, -12.0, -128.0, -25.0, -2.0, 0.0, -10.0, -44.0, -4.0, 0.0, -60.0, -58.0, 0.0, 0.0, -17.0, -24.0, -12.0, 15.0, -65.0, -11.0, -127.0, -74.0, 0.0, 0.0, 0.0, 13.0, -139.0, -129.0, -120.0, -83.0, -145.0, -155.0, 21.0, 7.0, 0.0, 0.0, -182.0, -183.0, -196.0, -245.0, -28.0, 9.0, -193.0, -245.0, -144.0, -122.0, 0.0, 0.0, 3.0, 0.0, 10.0, 23.0, -18.0, -28.0, -352.0, -296.0, -196.0, -142.0, -68.0, -63.0, 0.0, 0.0, 15.0, 0.0, 5.0, -88.0, 5.0, -58.0, -308.0, -279.0, 0.0, -26.0, -328.0, -331.0, 0.0, 0.0, -50.0, -8.0, -46.0, 7.0, -344.0, -362.0, 0.0, -23.0, -318.0, -204.0, -265.0, -242.0, -161.0, -97.0, -292.0, -310.0, -116.0, -58.0, -232.0, -246.0, -159.0, -152.0, -222.0, -206.0, 0.0, 0.0, -336.0, -326.0, 1.0, -17.0, 0.0, 6.0, -56.0, -65.0, 0.0, -1.0, -110.0, -65.0, 24.0, 0.0, 0.0, 0.0, -210.0, -198.0, -132.0, -86.0, -269.0, -310.0, 9.0, 6.0, -98.0, -18.0, -354.0, -230.0, -232.0, -230.0, -207.0, -221.0, -280.0, -241.0, 0.0, -26.0, -342.0, -351.0, 18.0, 3.0, -134.0, -187.0, -320.0, -318.0, 0.0, 0.0, -330.0, -352.0, -288.0, -316.0, -400.0, -388.0, 0.0, -24.0, -126.0, -176.0, -92.0, 0.0, 14.0, 22.0, -216.0, -212.0, -100.0, -102.0, -290.0, -298.0, -258.0, -272.0, 0.0, 0.0, -14.0, -6.0, -6.0, 0.0, 23.0, 0.0, 20.0, 0.0, -272.0, -308.0, -400.0, -330.0, 0.0, 0.0, -301.0, -320.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 2.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 64.0, 0.0, 2.0, 4.0, 23.0, 0.0, 2.0, 0.0, 0.0, 30.0, 0.0, 0.0, 27.0, 0.0, 0.0, 6.0, 39.0, 1.0, 71.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 8.0, 60.0, 0.0, 0.0, 88.0, 0.0, 0.0, 0.0, 0.0, 109.0, 0.0, 53.0, 88.0, 1.0, 13.0, 0.0, 139.0, 74.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 23.0, 0.0, 176.0, 14.0, 7.0, 104.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 39.0, 28.0, 29.0, 172.0, 104.0, 13.0, 0.0, 174.0, 5.0, 0.0, 0.0, 37.0, 5.0, 11.0, 22.0, 181.0, 0.0, 9.0, 10.0, 56.0, 159.0, 18.0, 119.0, 74.0, 29.0, 164.0, 0.0, 2.0, 59.0, 124.0, 5.0, 90.0, 1.0, 8.0, 121.0, 0.0, 0.0, 168.0, 0.0, 13.0, 1.0, 0.0, 0.0, 0.0, 43.0, 1.0, 0.0, 0.0, 65.0, 0.0, 2.0, 0.0, 0.0, 107.0, 1.0, 25.0, 43.0, 158.0, 0.0, 0.0, 0.0, 49.0, 0.0, 130.0, 76.0, 0.0, 127.0, 128.0, 9.0, 0.0, 150.0, 0.0, 13.0, 69.0, 171.0, 0.0, 0.0, 95.0, 2.0, 0.0, 161.0, 0.0, 0.0, 0.0, 176.0, 163.0, 7.0, 0.0, 200.0, 0.0, 12.0, 0.0, 96.0, 28.0, 18.0, 0.0, 0.0, 110.0, 0.0, 51.0, 0.0, 151.0, 0.0, 147.0, 0.0, 0.0, 0.0, 10.0, 3.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 154.0, 0.0, 0.0, 200.0, 0.0, 0.0, 165.0, 156.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.113795078212145, "mean_inference_ms": 2.957529819514699, "mean_action_processing_ms": 0.5168382889997861, "mean_env_wait_ms": 0.40960279431555635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02468240261077881, "StateBufferConnector_ms": 0.007568240165710449, "ViewRequirementAgentConnector_ms": 0.1896911859512329}, "num_episodes": 18, "episode_return_max": 36.0, "episode_return_min": -588.0, "episode_return_mean": -146.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.36422148564685, "num_env_steps_trained_throughput_per_sec": 246.36422148564685, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 15583.609, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15583.548, "sample_time_ms": 2245.861, "learn_time_ms": 13319.851, "learn_throughput": 300.304, "synch_weights_time_ms": 14.627}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "e1352_00000", "date": "2024-08-13_16-44-50", "timestamp": 1723581890, "time_this_iter_s": 16.316254377365112, "time_total_s": 411.63799500465393, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15c24c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 411.63799500465393, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 79.88260869565218, "ram_util_percent": 85.85652173913041}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6785759312923623, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.052361355887519, "policy_loss": 0.0003599693565062745, "vf_loss": 2.043417443169488, "vf_explained_var": 0.33184841518048885, "kl": 0.012716953110536373, "entropy": 0.9816676757953785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.845612359819589, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.9927579033311713, "policy_loss": 0.0028414658408749986, "vf_loss": 3.95117763766536, "vf_explained_var": -4.068253532288566e-09, "kl": 0.011336457427739111, "entropy": 0.9399354817690673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 36.0, "episode_reward_min": -588.0, "episode_reward_mean": -164.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 24.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -119.975, "predator_policy": 37.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -256.0, -300.0, -5.0, -299.0, -192.0, 0.0, 3.0, 36.0, -23.0, -458.0, -227.0, -95.0, 0.0, 15.0, -31.0, 4.0, -311.0, -13.0, -480.0, 0.0, -16.0, -6.0, -525.0, -4.0, -307.0, -370.0, -155.0, -438.0, -113.0, -349.0, -220.0, -299.0, 0.0, -494.0, -2.0, 6.0, -78.0, 0.0, -110.0, 26.0, 0.0, -300.0, -150.0, -421.0, 15.0, -67.0, -378.0, -335.0, -291.0, -371.0, -13.0, -453.0, 21.0, -224.0, -477.0, 0.0, -506.0, -434.0, -588.0, -12.0, -206.0, -46.0, 36.0, -318.0, -151.0, -437.0, -383.0, 0.0, -7.0, -3.0, 23.0, 20.0, -426.0, -530.0, 0.0, -300.0, 0.0, -14.0, -236.0, 2.0, -36.0, -510.0, -5.0, -25.0, -335.0, 0.0, -374.0, 4.0, -4.0, 0.0, 0.0, -6.0, -3.0, -9.0, -13.0, -30.0, -522.0, -199.0, -321.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -182.0, -183.0, -196.0, -245.0, -28.0, 9.0, -193.0, -245.0, -144.0, -122.0, 0.0, 0.0, 3.0, 0.0, 10.0, 23.0, -18.0, -28.0, -352.0, -296.0, -196.0, -142.0, -68.0, -63.0, 0.0, 0.0, 15.0, 0.0, 5.0, -88.0, 5.0, -58.0, -308.0, -279.0, 0.0, -26.0, -328.0, -331.0, 0.0, 0.0, -50.0, -8.0, -46.0, 7.0, -344.0, -362.0, 0.0, -23.0, -318.0, -204.0, -265.0, -242.0, -161.0, -97.0, -292.0, -310.0, -116.0, -58.0, -232.0, -246.0, -159.0, -152.0, -222.0, -206.0, 0.0, 0.0, -336.0, -326.0, 1.0, -17.0, 0.0, 6.0, -56.0, -65.0, 0.0, -1.0, -110.0, -65.0, 24.0, 0.0, 0.0, 0.0, -210.0, -198.0, -132.0, -86.0, -269.0, -310.0, 9.0, 6.0, -98.0, -18.0, -354.0, -230.0, -232.0, -230.0, -207.0, -221.0, -280.0, -241.0, 0.0, -26.0, -342.0, -351.0, 18.0, 3.0, -134.0, -187.0, -320.0, -318.0, 0.0, 0.0, -330.0, -352.0, -288.0, -316.0, -400.0, -388.0, 0.0, -24.0, -126.0, -176.0, -92.0, 0.0, 14.0, 22.0, -216.0, -212.0, -100.0, -102.0, -290.0, -298.0, -258.0, -272.0, 0.0, 0.0, -14.0, -6.0, -6.0, 0.0, 23.0, 0.0, 20.0, 0.0, -272.0, -308.0, -400.0, -330.0, 0.0, 0.0, -301.0, -320.0, 0.0, 0.0, -29.0, 0.0, -157.0, -176.0, 2.0, 0.0, -36.0, -36.0, -368.0, -330.0, 0.0, -10.0, -37.0, -14.0, -235.0, -230.0, 0.0, 0.0, -292.0, -233.0, 3.0, 0.0, 3.0, -14.0, 0.0, 0.0, 0.0, 0.0, -21.0, 2.0, 13.0, -32.0, -8.0, -13.0, -15.0, -39.0, -84.0, -12.0, -349.0, -348.0, -131.0, -146.0, -195.0, -252.0], "policy_predator_policy_reward": [0.0, 0.0, 109.0, 0.0, 53.0, 88.0, 1.0, 13.0, 0.0, 139.0, 74.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 23.0, 0.0, 176.0, 14.0, 7.0, 104.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 39.0, 28.0, 29.0, 172.0, 104.0, 13.0, 0.0, 174.0, 5.0, 0.0, 0.0, 37.0, 5.0, 11.0, 22.0, 181.0, 0.0, 9.0, 10.0, 56.0, 159.0, 18.0, 119.0, 74.0, 29.0, 164.0, 0.0, 2.0, 59.0, 124.0, 5.0, 90.0, 1.0, 8.0, 121.0, 0.0, 0.0, 168.0, 0.0, 13.0, 1.0, 0.0, 0.0, 0.0, 43.0, 1.0, 0.0, 0.0, 65.0, 0.0, 2.0, 0.0, 0.0, 107.0, 1.0, 25.0, 43.0, 158.0, 0.0, 0.0, 0.0, 49.0, 0.0, 130.0, 76.0, 0.0, 127.0, 128.0, 9.0, 0.0, 150.0, 0.0, 13.0, 69.0, 171.0, 0.0, 0.0, 95.0, 2.0, 0.0, 161.0, 0.0, 0.0, 0.0, 176.0, 163.0, 7.0, 0.0, 200.0, 0.0, 12.0, 0.0, 96.0, 28.0, 18.0, 0.0, 0.0, 110.0, 0.0, 51.0, 0.0, 151.0, 0.0, 147.0, 0.0, 0.0, 0.0, 10.0, 3.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 154.0, 0.0, 0.0, 200.0, 0.0, 0.0, 165.0, 156.0, 0.0, 0.0, 7.0, 8.0, 6.0, 91.0, 0.0, 0.0, 0.0, 36.0, 14.0, 174.0, 5.0, 0.0, 0.0, 26.0, 11.0, 119.0, 0.0, 0.0, 22.0, 129.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 16.0, 0.0, 12.0, 0.0, 28.0, 13.0, 24.0, 42.0, 0.0, 175.0, 78.0, 0.0, 0.0, 126.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1070456802583712, "mean_inference_ms": 2.9387414116118094, "mean_action_processing_ms": 0.556632554791674, "mean_env_wait_ms": 0.4061796243756046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0271073579788208, "StateBufferConnector_ms": 0.007944226264953613, "ViewRequirementAgentConnector_ms": 0.19581186771392822}, "num_episodes": 22, "episode_return_max": 36.0, "episode_return_min": -588.0, "episode_return_mean": -164.34, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.7636069145836, "num_env_steps_trained_throughput_per_sec": 275.7636069145836, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 15447.756, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15447.692, "sample_time_ms": 2191.853, "learn_time_ms": 13237.656, "learn_throughput": 302.168, "synch_weights_time_ms": 14.763}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "e1352_00000", "date": "2024-08-13_16-45-04", "timestamp": 1723581904, "time_this_iter_s": 14.568519115447998, "time_total_s": 426.20651412010193, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b165e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 426.20651412010193, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 74.775, "ram_util_percent": 85.61}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2284805715635971, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 3.043349103952842, "policy_loss": 0.0009131538701396455, "vf_loss": 3.0305311918258666, "vf_explained_var": 0.34461535458211545, "kl": 0.017636679940137713, "entropy": 0.8493134737330139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.099373540849912, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 5.873330327190419, "policy_loss": 0.0023277537070618814, "vf_loss": 5.841486056645711, "vf_explained_var": -2.4598742288256448e-09, "kl": 0.00863766345208509, "entropy": 0.7019872975254816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 36.0, "episode_reward_min": -588.0, "episode_reward_mean": -180.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 24.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -130.31, "predator_policy": 39.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-525.0, -4.0, -307.0, -370.0, -155.0, -438.0, -113.0, -349.0, -220.0, -299.0, 0.0, -494.0, -2.0, 6.0, -78.0, 0.0, -110.0, 26.0, 0.0, -300.0, -150.0, -421.0, 15.0, -67.0, -378.0, -335.0, -291.0, -371.0, -13.0, -453.0, 21.0, -224.0, -477.0, 0.0, -506.0, -434.0, -588.0, -12.0, -206.0, -46.0, 36.0, -318.0, -151.0, -437.0, -383.0, 0.0, -7.0, -3.0, 23.0, 20.0, -426.0, -530.0, 0.0, -300.0, 0.0, -14.0, -236.0, 2.0, -36.0, -510.0, -5.0, -25.0, -335.0, 0.0, -374.0, 4.0, -4.0, 0.0, 0.0, -6.0, -3.0, -9.0, -13.0, -30.0, -522.0, -199.0, -321.0, -17.0, -3.0, -528.0, -358.0, -30.0, 0.0, -233.0, -292.0, -16.0, -349.0, -257.0, -14.0, -436.0, -377.0, -439.0, 5.0, -381.0, 0.0, -178.0, 14.0, -394.0, -15.0, -8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-344.0, -362.0, 0.0, -23.0, -318.0, -204.0, -265.0, -242.0, -161.0, -97.0, -292.0, -310.0, -116.0, -58.0, -232.0, -246.0, -159.0, -152.0, -222.0, -206.0, 0.0, 0.0, -336.0, -326.0, 1.0, -17.0, 0.0, 6.0, -56.0, -65.0, 0.0, -1.0, -110.0, -65.0, 24.0, 0.0, 0.0, 0.0, -210.0, -198.0, -132.0, -86.0, -269.0, -310.0, 9.0, 6.0, -98.0, -18.0, -354.0, -230.0, -232.0, -230.0, -207.0, -221.0, -280.0, -241.0, 0.0, -26.0, -342.0, -351.0, 18.0, 3.0, -134.0, -187.0, -320.0, -318.0, 0.0, 0.0, -330.0, -352.0, -288.0, -316.0, -400.0, -388.0, 0.0, -24.0, -126.0, -176.0, -92.0, 0.0, 14.0, 22.0, -216.0, -212.0, -100.0, -102.0, -290.0, -298.0, -258.0, -272.0, 0.0, 0.0, -14.0, -6.0, -6.0, 0.0, 23.0, 0.0, 20.0, 0.0, -272.0, -308.0, -400.0, -330.0, 0.0, 0.0, -301.0, -320.0, 0.0, 0.0, -29.0, 0.0, -157.0, -176.0, 2.0, 0.0, -36.0, -36.0, -368.0, -330.0, 0.0, -10.0, -37.0, -14.0, -235.0, -230.0, 0.0, 0.0, -292.0, -233.0, 3.0, 0.0, 3.0, -14.0, 0.0, 0.0, 0.0, 0.0, -21.0, 2.0, 13.0, -32.0, -8.0, -13.0, -15.0, -39.0, -84.0, -12.0, -349.0, -348.0, -131.0, -146.0, -195.0, -252.0, 0.0, -38.0, -6.0, 0.0, -374.0, -342.0, -244.0, -236.0, -24.0, -28.0, 0.0, 0.0, -270.0, -99.0, -340.0, -122.0, 0.0, -32.0, -230.0, -304.0, -168.0, -178.0, -30.0, 0.0, -324.0, -285.0, -258.0, -257.0, -300.0, -302.0, 5.0, -1.0, -219.0, -334.0, 0.0, 0.0, -72.0, -228.0, 13.0, 0.0, -272.0, -258.0, -18.0, -12.0, -26.0, 0.0], "policy_predator_policy_reward": [181.0, 0.0, 9.0, 10.0, 56.0, 159.0, 18.0, 119.0, 74.0, 29.0, 164.0, 0.0, 2.0, 59.0, 124.0, 5.0, 90.0, 1.0, 8.0, 121.0, 0.0, 0.0, 168.0, 0.0, 13.0, 1.0, 0.0, 0.0, 0.0, 43.0, 1.0, 0.0, 0.0, 65.0, 0.0, 2.0, 0.0, 0.0, 107.0, 1.0, 25.0, 43.0, 158.0, 0.0, 0.0, 0.0, 49.0, 0.0, 130.0, 76.0, 0.0, 127.0, 128.0, 9.0, 0.0, 150.0, 0.0, 13.0, 69.0, 171.0, 0.0, 0.0, 95.0, 2.0, 0.0, 161.0, 0.0, 0.0, 0.0, 176.0, 163.0, 7.0, 0.0, 200.0, 0.0, 12.0, 0.0, 96.0, 28.0, 18.0, 0.0, 0.0, 110.0, 0.0, 51.0, 0.0, 151.0, 0.0, 147.0, 0.0, 0.0, 0.0, 10.0, 3.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 154.0, 0.0, 0.0, 200.0, 0.0, 0.0, 165.0, 156.0, 0.0, 0.0, 7.0, 8.0, 6.0, 91.0, 0.0, 0.0, 0.0, 36.0, 14.0, 174.0, 5.0, 0.0, 0.0, 26.0, 11.0, 119.0, 0.0, 0.0, 22.0, 129.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 16.0, 0.0, 12.0, 0.0, 28.0, 13.0, 24.0, 42.0, 0.0, 175.0, 78.0, 0.0, 0.0, 126.0, 4.0, 17.0, 0.0, 3.0, 188.0, 0.0, 0.0, 122.0, 9.0, 13.0, 0.0, 0.0, 136.0, 0.0, 0.0, 170.0, 0.0, 16.0, 26.0, 159.0, 89.0, 0.0, 16.0, 0.0, 167.0, 6.0, 6.0, 132.0, 153.0, 10.0, 0.0, 1.0, 0.0, 172.0, 0.0, 0.0, 8.0, 114.0, 0.0, 1.0, 136.0, 0.0, 11.0, 4.0, 10.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0974979862216196, "mean_inference_ms": 2.918592363278935, "mean_action_processing_ms": 0.598674370963075, "mean_env_wait_ms": 0.40350554657828946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01720130443572998, "StateBufferConnector_ms": 0.007102251052856445, "ViewRequirementAgentConnector_ms": 0.15593445301055908}, "num_episodes": 23, "episode_return_max": 36.0, "episode_return_min": -588.0, "episode_return_mean": -180.86, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.20609555000584, "num_env_steps_trained_throughput_per_sec": 264.20609555000584, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 15367.892, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15367.824, "sample_time_ms": 2198.905, "learn_time_ms": 13150.762, "learn_throughput": 304.165, "synch_weights_time_ms": 14.689}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "e1352_00000", "date": "2024-08-13_16-45-20", "timestamp": 1723581920, "time_this_iter_s": 15.182216167449951, "time_total_s": 441.3887302875519, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15c2550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 441.3887302875519, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 72.9909090909091, "ram_util_percent": 86.15454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3574238512724164, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.248841566509671, "policy_loss": 0.0023076571312255012, "vf_loss": 2.2350312346503847, "vf_explained_var": 0.2678550668179043, "kl": 0.017041006438118542, "entropy": 0.7893299168379849, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.905681729379785, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.48347266685395, "policy_loss": 0.002108816341521642, "vf_loss": 3.456560685268786, "vf_explained_var": -5.4558748921389304e-09, "kl": 0.007258357595401975, "entropy": 0.5880375653189956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 36.0, "episode_reward_min": -588.0, "episode_reward_mean": -164.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 23.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -119.34, "predator_policy": 37.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -300.0, -150.0, -421.0, 15.0, -67.0, -378.0, -335.0, -291.0, -371.0, -13.0, -453.0, 21.0, -224.0, -477.0, 0.0, -506.0, -434.0, -588.0, -12.0, -206.0, -46.0, 36.0, -318.0, -151.0, -437.0, -383.0, 0.0, -7.0, -3.0, 23.0, 20.0, -426.0, -530.0, 0.0, -300.0, 0.0, -14.0, -236.0, 2.0, -36.0, -510.0, -5.0, -25.0, -335.0, 0.0, -374.0, 4.0, -4.0, 0.0, 0.0, -6.0, -3.0, -9.0, -13.0, -30.0, -522.0, -199.0, -321.0, -17.0, -3.0, -528.0, -358.0, -30.0, 0.0, -233.0, -292.0, -16.0, -349.0, -257.0, -14.0, -436.0, -377.0, -439.0, 5.0, -381.0, 0.0, -178.0, 14.0, -394.0, -15.0, -8.0, -372.0, 0.0, -460.0, -96.0, -136.0, -202.0, 19.0, 0.0, 0.0, -24.0, -409.0, 19.0, -112.0, 9.0, -8.0, -26.0, 1.0, 16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -210.0, -198.0, -132.0, -86.0, -269.0, -310.0, 9.0, 6.0, -98.0, -18.0, -354.0, -230.0, -232.0, -230.0, -207.0, -221.0, -280.0, -241.0, 0.0, -26.0, -342.0, -351.0, 18.0, 3.0, -134.0, -187.0, -320.0, -318.0, 0.0, 0.0, -330.0, -352.0, -288.0, -316.0, -400.0, -388.0, 0.0, -24.0, -126.0, -176.0, -92.0, 0.0, 14.0, 22.0, -216.0, -212.0, -100.0, -102.0, -290.0, -298.0, -258.0, -272.0, 0.0, 0.0, -14.0, -6.0, -6.0, 0.0, 23.0, 0.0, 20.0, 0.0, -272.0, -308.0, -400.0, -330.0, 0.0, 0.0, -301.0, -320.0, 0.0, 0.0, -29.0, 0.0, -157.0, -176.0, 2.0, 0.0, -36.0, -36.0, -368.0, -330.0, 0.0, -10.0, -37.0, -14.0, -235.0, -230.0, 0.0, 0.0, -292.0, -233.0, 3.0, 0.0, 3.0, -14.0, 0.0, 0.0, 0.0, 0.0, -21.0, 2.0, 13.0, -32.0, -8.0, -13.0, -15.0, -39.0, -84.0, -12.0, -349.0, -348.0, -131.0, -146.0, -195.0, -252.0, 0.0, -38.0, -6.0, 0.0, -374.0, -342.0, -244.0, -236.0, -24.0, -28.0, 0.0, 0.0, -270.0, -99.0, -340.0, -122.0, 0.0, -32.0, -230.0, -304.0, -168.0, -178.0, -30.0, 0.0, -324.0, -285.0, -258.0, -257.0, -300.0, -302.0, 5.0, -1.0, -219.0, -334.0, 0.0, 0.0, -72.0, -228.0, 13.0, 0.0, -272.0, -258.0, -18.0, -12.0, -26.0, 0.0, -256.0, -244.0, 0.0, 0.0, -372.0, -276.0, -80.0, -60.0, -6.0, -278.0, -62.0, -294.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, -58.0, 0.0, -266.0, -290.0, 19.0, 0.0, -92.0, -80.0, 0.0, 9.0, -20.0, 0.0, 0.0, -52.0, -1.0, -17.0, -25.0, 22.0], "policy_predator_policy_reward": [0.0, 0.0, 107.0, 1.0, 25.0, 43.0, 158.0, 0.0, 0.0, 0.0, 49.0, 0.0, 130.0, 76.0, 0.0, 127.0, 128.0, 9.0, 0.0, 150.0, 0.0, 13.0, 69.0, 171.0, 0.0, 0.0, 95.0, 2.0, 0.0, 161.0, 0.0, 0.0, 0.0, 176.0, 163.0, 7.0, 0.0, 200.0, 0.0, 12.0, 0.0, 96.0, 28.0, 18.0, 0.0, 0.0, 110.0, 0.0, 51.0, 0.0, 151.0, 0.0, 147.0, 0.0, 0.0, 0.0, 10.0, 3.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 154.0, 0.0, 0.0, 200.0, 0.0, 0.0, 165.0, 156.0, 0.0, 0.0, 7.0, 8.0, 6.0, 91.0, 0.0, 0.0, 0.0, 36.0, 14.0, 174.0, 5.0, 0.0, 0.0, 26.0, 11.0, 119.0, 0.0, 0.0, 22.0, 129.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 16.0, 0.0, 12.0, 0.0, 28.0, 13.0, 24.0, 42.0, 0.0, 175.0, 78.0, 0.0, 0.0, 126.0, 4.0, 17.0, 0.0, 3.0, 188.0, 0.0, 0.0, 122.0, 9.0, 13.0, 0.0, 0.0, 136.0, 0.0, 0.0, 170.0, 0.0, 16.0, 26.0, 159.0, 89.0, 0.0, 16.0, 0.0, 167.0, 6.0, 6.0, 132.0, 153.0, 10.0, 0.0, 1.0, 0.0, 172.0, 0.0, 0.0, 8.0, 114.0, 0.0, 1.0, 136.0, 0.0, 11.0, 4.0, 10.0, 8.0, 128.0, 0.0, 0.0, 0.0, 161.0, 27.0, 44.0, 0.0, 13.0, 135.0, 10.0, 144.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 23.0, 0.0, 147.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 26.0, 3.0, 16.0, 0.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0911023939553832, "mean_inference_ms": 2.9032882699119424, "mean_action_processing_ms": 0.6300985430643045, "mean_env_wait_ms": 0.40131305811883633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01647162437438965, "StateBufferConnector_ms": 0.007153034210205078, "ViewRequirementAgentConnector_ms": 0.1523648500442505}, "num_episodes": 18, "episode_return_max": 36.0, "episode_return_min": -588.0, "episode_return_mean": -164.35, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.54709211806414, "num_env_steps_trained_throughput_per_sec": 252.54709211806414, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 15432.301, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15432.191, "sample_time_ms": 2133.282, "learn_time_ms": 13277.798, "learn_throughput": 301.255, "synch_weights_time_ms": 16.643}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "e1352_00000", "date": "2024-08-13_16-45-35", "timestamp": 1723581935, "time_this_iter_s": 15.897013187408447, "time_total_s": 457.2857434749603, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af1038b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 457.2857434749603, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 76.0, "ram_util_percent": 86.30454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4037180743677906, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.6346493450422135, "policy_loss": -0.0023690748366000003, "vf_loss": 1.6266998614899064, "vf_explained_var": 0.3409998039404551, "kl": 0.015286756136868909, "entropy": 0.8119372453954484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.7991714726364805, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 2.976272198384401, "policy_loss": 0.002519315334096078, "vf_loss": 2.9445138162406033, "vf_explained_var": -8.231117611839658e-09, "kl": 0.008556470908717306, "entropy": 0.5935107240443507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 36.0, "episode_reward_min": -588.0, "episode_reward_mean": -136.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 23.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -100.54, "predator_policy": 32.395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-588.0, -12.0, -206.0, -46.0, 36.0, -318.0, -151.0, -437.0, -383.0, 0.0, -7.0, -3.0, 23.0, 20.0, -426.0, -530.0, 0.0, -300.0, 0.0, -14.0, -236.0, 2.0, -36.0, -510.0, -5.0, -25.0, -335.0, 0.0, -374.0, 4.0, -4.0, 0.0, 0.0, -6.0, -3.0, -9.0, -13.0, -30.0, -522.0, -199.0, -321.0, -17.0, -3.0, -528.0, -358.0, -30.0, 0.0, -233.0, -292.0, -16.0, -349.0, -257.0, -14.0, -436.0, -377.0, -439.0, 5.0, -381.0, 0.0, -178.0, 14.0, -394.0, -15.0, -8.0, -372.0, 0.0, -460.0, -96.0, -136.0, -202.0, 19.0, 0.0, 0.0, -24.0, -409.0, 19.0, -112.0, 9.0, -8.0, -26.0, 1.0, 16.0, -26.0, 15.0, -111.0, 6.0, -496.0, -187.0, 14.0, 20.0, 0.0, -2.0, -16.0, -2.0, 0.0, 2.0, -229.0, -17.0, 6.0, -555.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-400.0, -388.0, 0.0, -24.0, -126.0, -176.0, -92.0, 0.0, 14.0, 22.0, -216.0, -212.0, -100.0, -102.0, -290.0, -298.0, -258.0, -272.0, 0.0, 0.0, -14.0, -6.0, -6.0, 0.0, 23.0, 0.0, 20.0, 0.0, -272.0, -308.0, -400.0, -330.0, 0.0, 0.0, -301.0, -320.0, 0.0, 0.0, -29.0, 0.0, -157.0, -176.0, 2.0, 0.0, -36.0, -36.0, -368.0, -330.0, 0.0, -10.0, -37.0, -14.0, -235.0, -230.0, 0.0, 0.0, -292.0, -233.0, 3.0, 0.0, 3.0, -14.0, 0.0, 0.0, 0.0, 0.0, -21.0, 2.0, 13.0, -32.0, -8.0, -13.0, -15.0, -39.0, -84.0, -12.0, -349.0, -348.0, -131.0, -146.0, -195.0, -252.0, 0.0, -38.0, -6.0, 0.0, -374.0, -342.0, -244.0, -236.0, -24.0, -28.0, 0.0, 0.0, -270.0, -99.0, -340.0, -122.0, 0.0, -32.0, -230.0, -304.0, -168.0, -178.0, -30.0, 0.0, -324.0, -285.0, -258.0, -257.0, -300.0, -302.0, 5.0, -1.0, -219.0, -334.0, 0.0, 0.0, -72.0, -228.0, 13.0, 0.0, -272.0, -258.0, -18.0, -12.0, -26.0, 0.0, -256.0, -244.0, 0.0, 0.0, -372.0, -276.0, -80.0, -60.0, -6.0, -278.0, -62.0, -294.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, -58.0, 0.0, -266.0, -290.0, 19.0, 0.0, -92.0, -80.0, 0.0, 9.0, -20.0, 0.0, 0.0, -52.0, -1.0, -17.0, -25.0, 22.0, 0.0, -52.0, 15.0, 0.0, -239.0, 0.0, 2.0, 1.0, -324.0, -348.0, -326.0, -26.0, 18.0, -8.0, 20.0, 0.0, 0.0, 0.0, -2.0, -2.0, -16.0, -16.0, 0.0, -4.0, 0.0, 0.0, 2.0, 0.0, -92.0, -291.0, -20.0, -14.0, 8.0, -6.0, -380.0, -384.0], "policy_predator_policy_reward": [0.0, 200.0, 0.0, 12.0, 0.0, 96.0, 28.0, 18.0, 0.0, 0.0, 110.0, 0.0, 51.0, 0.0, 151.0, 0.0, 147.0, 0.0, 0.0, 0.0, 10.0, 3.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 154.0, 0.0, 0.0, 200.0, 0.0, 0.0, 165.0, 156.0, 0.0, 0.0, 7.0, 8.0, 6.0, 91.0, 0.0, 0.0, 0.0, 36.0, 14.0, 174.0, 5.0, 0.0, 0.0, 26.0, 11.0, 119.0, 0.0, 0.0, 22.0, 129.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 16.0, 0.0, 12.0, 0.0, 28.0, 13.0, 24.0, 42.0, 0.0, 175.0, 78.0, 0.0, 0.0, 126.0, 4.0, 17.0, 0.0, 3.0, 188.0, 0.0, 0.0, 122.0, 9.0, 13.0, 0.0, 0.0, 136.0, 0.0, 0.0, 170.0, 0.0, 16.0, 26.0, 159.0, 89.0, 0.0, 16.0, 0.0, 167.0, 6.0, 6.0, 132.0, 153.0, 10.0, 0.0, 1.0, 0.0, 172.0, 0.0, 0.0, 8.0, 114.0, 0.0, 1.0, 136.0, 0.0, 11.0, 4.0, 10.0, 8.0, 128.0, 0.0, 0.0, 0.0, 161.0, 27.0, 44.0, 0.0, 13.0, 135.0, 10.0, 144.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 23.0, 0.0, 147.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 26.0, 3.0, 16.0, 0.0, 19.0, 26.0, 0.0, 0.0, 0.0, 0.0, 128.0, 3.0, 0.0, 176.0, 0.0, 1.0, 164.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 3.0, 13.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 139.0, 10.0, 7.0, 4.0, 0.0, 17.0, 192.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0864688944093541, "mean_inference_ms": 2.8931481062740674, "mean_action_processing_ms": 0.6250837222307107, "mean_env_wait_ms": 0.39983889789008226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013395190238952637, "StateBufferConnector_ms": 0.007190585136413574, "ViewRequirementAgentConnector_ms": 0.1623748540878296}, "num_episodes": 18, "episode_return_max": 36.0, "episode_return_min": -588.0, "episode_return_mean": -136.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.8071366287291, "num_env_steps_trained_throughput_per_sec": 248.8071366287291, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 15580.612, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15580.502, "sample_time_ms": 2187.819, "learn_time_ms": 13371.386, "learn_throughput": 299.146, "synch_weights_time_ms": 16.583}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "e1352_00000", "date": "2024-08-13_16-45-52", "timestamp": 1723581952, "time_this_iter_s": 16.134341716766357, "time_total_s": 473.4200851917267, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15d2820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 473.4200851917267, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 78.76521739130435, "ram_util_percent": 86.62173913043478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.064567679505815, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.5449161088340497, "policy_loss": 0.0006045699008696136, "vf_loss": 1.5334142820229606, "vf_explained_var": 0.1607508807270615, "kl": 0.01614408930042936, "entropy": 0.8244187443344682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.222254853904563, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.0735815836008262, "policy_loss": 0.002037819776506651, "vf_loss": 3.0370575839249545, "vf_explained_var": -7.600380630089493e-09, "kl": 0.010091979065447758, "entropy": 0.6941412367833355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 33.0, "episode_reward_min": -555.0, "episode_reward_mean": -107.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -384.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -81.065, "predator_policy": 27.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -14.0, -236.0, 2.0, -36.0, -510.0, -5.0, -25.0, -335.0, 0.0, -374.0, 4.0, -4.0, 0.0, 0.0, -6.0, -3.0, -9.0, -13.0, -30.0, -522.0, -199.0, -321.0, -17.0, -3.0, -528.0, -358.0, -30.0, 0.0, -233.0, -292.0, -16.0, -349.0, -257.0, -14.0, -436.0, -377.0, -439.0, 5.0, -381.0, 0.0, -178.0, 14.0, -394.0, -15.0, -8.0, -372.0, 0.0, -460.0, -96.0, -136.0, -202.0, 19.0, 0.0, 0.0, -24.0, -409.0, 19.0, -112.0, 9.0, -8.0, -26.0, 1.0, 16.0, -26.0, 15.0, -111.0, 6.0, -496.0, -187.0, 14.0, 20.0, 0.0, -2.0, -16.0, -2.0, 0.0, 2.0, -229.0, -17.0, 6.0, -555.0, -20.0, 0.0, -66.0, 13.0, -32.0, -1.0, 2.0, -38.0, -5.0, -31.0, 33.0, 13.0, 20.0, 11.0, -6.0, -12.0, 9.0, -306.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -29.0, 0.0, -157.0, -176.0, 2.0, 0.0, -36.0, -36.0, -368.0, -330.0, 0.0, -10.0, -37.0, -14.0, -235.0, -230.0, 0.0, 0.0, -292.0, -233.0, 3.0, 0.0, 3.0, -14.0, 0.0, 0.0, 0.0, 0.0, -21.0, 2.0, 13.0, -32.0, -8.0, -13.0, -15.0, -39.0, -84.0, -12.0, -349.0, -348.0, -131.0, -146.0, -195.0, -252.0, 0.0, -38.0, -6.0, 0.0, -374.0, -342.0, -244.0, -236.0, -24.0, -28.0, 0.0, 0.0, -270.0, -99.0, -340.0, -122.0, 0.0, -32.0, -230.0, -304.0, -168.0, -178.0, -30.0, 0.0, -324.0, -285.0, -258.0, -257.0, -300.0, -302.0, 5.0, -1.0, -219.0, -334.0, 0.0, 0.0, -72.0, -228.0, 13.0, 0.0, -272.0, -258.0, -18.0, -12.0, -26.0, 0.0, -256.0, -244.0, 0.0, 0.0, -372.0, -276.0, -80.0, -60.0, -6.0, -278.0, -62.0, -294.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, -58.0, 0.0, -266.0, -290.0, 19.0, 0.0, -92.0, -80.0, 0.0, 9.0, -20.0, 0.0, 0.0, -52.0, -1.0, -17.0, -25.0, 22.0, 0.0, -52.0, 15.0, 0.0, -239.0, 0.0, 2.0, 1.0, -324.0, -348.0, -326.0, -26.0, 18.0, -8.0, 20.0, 0.0, 0.0, 0.0, -2.0, -2.0, -16.0, -16.0, 0.0, -4.0, 0.0, 0.0, 2.0, 0.0, -92.0, -291.0, -20.0, -14.0, 8.0, -6.0, -380.0, -384.0, -26.0, -14.0, -1.0, 0.0, -152.0, 10.0, 13.0, 0.0, -34.0, -30.0, 0.0, -2.0, -6.0, 0.0, -38.0, -20.0, -26.0, 0.0, -106.0, -130.0, 15.0, 18.0, 0.0, 13.0, 0.0, 20.0, 11.0, 0.0, -12.0, 0.0, 0.0, -28.0, 0.0, 9.0, -222.0, -199.0], "policy_predator_policy_reward": [0.0, 0.0, 7.0, 8.0, 6.0, 91.0, 0.0, 0.0, 0.0, 36.0, 14.0, 174.0, 5.0, 0.0, 0.0, 26.0, 11.0, 119.0, 0.0, 0.0, 22.0, 129.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 16.0, 0.0, 12.0, 0.0, 28.0, 13.0, 24.0, 42.0, 0.0, 175.0, 78.0, 0.0, 0.0, 126.0, 4.0, 17.0, 0.0, 3.0, 188.0, 0.0, 0.0, 122.0, 9.0, 13.0, 0.0, 0.0, 136.0, 0.0, 0.0, 170.0, 0.0, 16.0, 26.0, 159.0, 89.0, 0.0, 16.0, 0.0, 167.0, 6.0, 6.0, 132.0, 153.0, 10.0, 0.0, 1.0, 0.0, 172.0, 0.0, 0.0, 8.0, 114.0, 0.0, 1.0, 136.0, 0.0, 11.0, 4.0, 10.0, 8.0, 128.0, 0.0, 0.0, 0.0, 161.0, 27.0, 44.0, 0.0, 13.0, 135.0, 10.0, 144.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 23.0, 0.0, 147.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 26.0, 3.0, 16.0, 0.0, 19.0, 26.0, 0.0, 0.0, 0.0, 0.0, 128.0, 3.0, 0.0, 176.0, 0.0, 1.0, 164.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 3.0, 13.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 139.0, 10.0, 7.0, 4.0, 0.0, 17.0, 192.0, 20.0, 0.0, 1.0, 0.0, 0.0, 76.0, 0.0, 0.0, 18.0, 14.0, 1.0, 0.0, 0.0, 8.0, 0.0, 20.0, 0.0, 21.0, 106.0, 99.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 14.0, 2.0, 0.0, 0.0, 2.0, 113.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0807133286201502, "mean_inference_ms": 2.876124803802181, "mean_action_processing_ms": 0.6170382471642967, "mean_env_wait_ms": 0.39759959273689743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009502291679382324, "StateBufferConnector_ms": 0.004832029342651367, "ViewRequirementAgentConnector_ms": 0.151422381401062}, "num_episodes": 18, "episode_return_max": 33.0, "episode_return_min": -555.0, "episode_return_mean": -107.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.4291239536516, "num_env_steps_trained_throughput_per_sec": 251.4291239536516, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 15698.016, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15697.906, "sample_time_ms": 2186.399, "learn_time_ms": 13489.76, "learn_throughput": 296.521, "synch_weights_time_ms": 16.749}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "e1352_00000", "date": "2024-08-13_16-46-08", "timestamp": 1723581968, "time_this_iter_s": 15.979804992675781, "time_total_s": 489.39989018440247, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b165e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 489.39989018440247, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 78.70454545454547, "ram_util_percent": 85.75000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0804871545818748, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.0146130295657607, "policy_loss": -0.0007653105331377851, "vf_loss": 2.0069392768794265, "vf_explained_var": 0.2219013360442308, "kl": 0.012502315193721313, "entropy": 0.694483117357133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.156332677634305, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.5454453743324077, "policy_loss": 0.0030768193566935165, "vf_loss": 3.507543361880792, "vf_explained_var": -5.140506401263848e-09, "kl": 0.010191180823845056, "entropy": 0.7463846027535737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 33.0, "episode_reward_min": -555.0, "episode_reward_mean": -88.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -384.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -69.45, "predator_policy": 25.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, 0.0, -233.0, -292.0, -16.0, -349.0, -257.0, -14.0, -436.0, -377.0, -439.0, 5.0, -381.0, 0.0, -178.0, 14.0, -394.0, -15.0, -8.0, -372.0, 0.0, -460.0, -96.0, -136.0, -202.0, 19.0, 0.0, 0.0, -24.0, -409.0, 19.0, -112.0, 9.0, -8.0, -26.0, 1.0, 16.0, -26.0, 15.0, -111.0, 6.0, -496.0, -187.0, 14.0, 20.0, 0.0, -2.0, -16.0, -2.0, 0.0, 2.0, -229.0, -17.0, 6.0, -555.0, -20.0, 0.0, -66.0, 13.0, -32.0, -1.0, 2.0, -38.0, -5.0, -31.0, 33.0, 13.0, 20.0, 11.0, -6.0, -12.0, 9.0, -306.0, -123.0, -53.0, -167.0, -55.0, 17.0, 0.0, -50.0, 8.0, 29.0, 5.0, -35.0, -172.0, -32.0, -15.0, -21.0, -1.0, -264.0, 5.0, -4.0, -202.0, -90.0, 1.0, -8.0, 31.0, -195.0, 2.0, -324.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.0, -28.0, 0.0, 0.0, -270.0, -99.0, -340.0, -122.0, 0.0, -32.0, -230.0, -304.0, -168.0, -178.0, -30.0, 0.0, -324.0, -285.0, -258.0, -257.0, -300.0, -302.0, 5.0, -1.0, -219.0, -334.0, 0.0, 0.0, -72.0, -228.0, 13.0, 0.0, -272.0, -258.0, -18.0, -12.0, -26.0, 0.0, -256.0, -244.0, 0.0, 0.0, -372.0, -276.0, -80.0, -60.0, -6.0, -278.0, -62.0, -294.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, -58.0, 0.0, -266.0, -290.0, 19.0, 0.0, -92.0, -80.0, 0.0, 9.0, -20.0, 0.0, 0.0, -52.0, -1.0, -17.0, -25.0, 22.0, 0.0, -52.0, 15.0, 0.0, -239.0, 0.0, 2.0, 1.0, -324.0, -348.0, -326.0, -26.0, 18.0, -8.0, 20.0, 0.0, 0.0, 0.0, -2.0, -2.0, -16.0, -16.0, 0.0, -4.0, 0.0, 0.0, 2.0, 0.0, -92.0, -291.0, -20.0, -14.0, 8.0, -6.0, -380.0, -384.0, -26.0, -14.0, -1.0, 0.0, -152.0, 10.0, 13.0, 0.0, -34.0, -30.0, 0.0, -2.0, -6.0, 0.0, -38.0, -20.0, -26.0, 0.0, -106.0, -130.0, 15.0, 18.0, 0.0, 13.0, 0.0, 20.0, 11.0, 0.0, -12.0, 0.0, 0.0, -28.0, 0.0, 9.0, -222.0, -199.0, -77.0, -92.0, -34.0, -58.0, -100.0, -134.0, -38.0, -38.0, 17.0, 0.0, 0.0, 0.0, -54.0, -26.0, 8.0, 0.0, 17.0, 12.0, 5.0, 0.0, -99.0, 10.0, -114.0, -118.0, -64.0, 0.0, -30.0, 0.0, -12.0, -35.0, -2.0, 0.0, -246.0, -141.0, 0.0, 1.0, 0.0, -8.0, -378.0, -26.0, 0.0, -180.0, 0.0, -2.0, -12.0, -4.0, 16.0, 15.0, -136.0, -130.0, 0.0, 2.0, -223.0, -228.0], "policy_predator_policy_reward": [9.0, 13.0, 0.0, 0.0, 136.0, 0.0, 0.0, 170.0, 0.0, 16.0, 26.0, 159.0, 89.0, 0.0, 16.0, 0.0, 167.0, 6.0, 6.0, 132.0, 153.0, 10.0, 0.0, 1.0, 0.0, 172.0, 0.0, 0.0, 8.0, 114.0, 0.0, 1.0, 136.0, 0.0, 11.0, 4.0, 10.0, 8.0, 128.0, 0.0, 0.0, 0.0, 161.0, 27.0, 44.0, 0.0, 13.0, 135.0, 10.0, 144.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 23.0, 0.0, 147.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 26.0, 3.0, 16.0, 0.0, 19.0, 26.0, 0.0, 0.0, 0.0, 0.0, 128.0, 3.0, 0.0, 176.0, 0.0, 1.0, 164.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 3.0, 13.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 139.0, 10.0, 7.0, 4.0, 0.0, 17.0, 192.0, 20.0, 0.0, 1.0, 0.0, 0.0, 76.0, 0.0, 0.0, 18.0, 14.0, 1.0, 0.0, 0.0, 8.0, 0.0, 20.0, 0.0, 21.0, 106.0, 99.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 14.0, 2.0, 0.0, 0.0, 2.0, 113.0, 0.0, 46.0, 2.0, 37.0, 67.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 22.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 47.0, 0.0, 60.0, 32.0, 0.0, 15.0, 0.0, 13.0, 13.0, 0.0, 1.0, 0.0, 123.0, 4.0, 0.0, 4.0, 0.0, 189.0, 13.0, 0.0, 90.0, 3.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 71.0, 0.0, 0.0, 114.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.074582035035264, "mean_inference_ms": 2.8537653039844457, "mean_action_processing_ms": 0.6075355549908658, "mean_env_wait_ms": 0.3949027575568442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072443485260009766, "StateBufferConnector_ms": 0.004670143127441406, "ViewRequirementAgentConnector_ms": 0.1527233123779297}, "num_episodes": 27, "episode_return_max": 33.0, "episode_return_min": -555.0, "episode_return_mean": -88.88, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.69461938329744, "num_env_steps_trained_throughput_per_sec": 260.69461938329744, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 15674.275, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15674.174, "sample_time_ms": 2191.249, "learn_time_ms": 13460.967, "learn_throughput": 297.155, "synch_weights_time_ms": 16.71}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "e1352_00000", "date": "2024-08-13_16-46-23", "timestamp": 1723581983, "time_this_iter_s": 15.410022020339966, "time_total_s": 504.80991220474243, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b164c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 504.80991220474243, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 76.9590909090909, "ram_util_percent": 86.23636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.084503882421703, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 0.9494146020166457, "policy_loss": -0.002166623345492457, "vf_loss": 0.941744865808222, "vf_explained_var": 0.29720955677133387, "kl": 0.014572383698738776, "entropy": 0.8193646311129211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.721060092392422, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 1.610273987354425, "policy_loss": 0.0019261248264382913, "vf_loss": 1.5709365031706592, "vf_explained_var": 5.897390779364046e-09, "kl": 0.010947998582745285, "entropy": 0.8200809784036465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 41.0, "episode_reward_min": -555.0, "episode_reward_mean": -55.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -384.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 32.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -46.205, "predator_policy": 18.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, -372.0, 0.0, -460.0, -96.0, -136.0, -202.0, 19.0, 0.0, 0.0, -24.0, -409.0, 19.0, -112.0, 9.0, -8.0, -26.0, 1.0, 16.0, -26.0, 15.0, -111.0, 6.0, -496.0, -187.0, 14.0, 20.0, 0.0, -2.0, -16.0, -2.0, 0.0, 2.0, -229.0, -17.0, 6.0, -555.0, -20.0, 0.0, -66.0, 13.0, -32.0, -1.0, 2.0, -38.0, -5.0, -31.0, 33.0, 13.0, 20.0, 11.0, -6.0, -12.0, 9.0, -306.0, -123.0, -53.0, -167.0, -55.0, 17.0, 0.0, -50.0, 8.0, 29.0, 5.0, -35.0, -172.0, -32.0, -15.0, -21.0, -1.0, -264.0, 5.0, -4.0, -202.0, -90.0, 1.0, -8.0, 31.0, -195.0, 2.0, -324.0, 0.0, 6.0, 0.0, 16.0, 0.0, 0.0, 16.0, 2.0, -4.0, -14.0, 41.0, 24.0, 3.0, -89.0, -20.0, -15.0, -8.0, -33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.0, 0.0, -256.0, -244.0, 0.0, 0.0, -372.0, -276.0, -80.0, -60.0, -6.0, -278.0, -62.0, -294.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, -58.0, 0.0, -266.0, -290.0, 19.0, 0.0, -92.0, -80.0, 0.0, 9.0, -20.0, 0.0, 0.0, -52.0, -1.0, -17.0, -25.0, 22.0, 0.0, -52.0, 15.0, 0.0, -239.0, 0.0, 2.0, 1.0, -324.0, -348.0, -326.0, -26.0, 18.0, -8.0, 20.0, 0.0, 0.0, 0.0, -2.0, -2.0, -16.0, -16.0, 0.0, -4.0, 0.0, 0.0, 2.0, 0.0, -92.0, -291.0, -20.0, -14.0, 8.0, -6.0, -380.0, -384.0, -26.0, -14.0, -1.0, 0.0, -152.0, 10.0, 13.0, 0.0, -34.0, -30.0, 0.0, -2.0, -6.0, 0.0, -38.0, -20.0, -26.0, 0.0, -106.0, -130.0, 15.0, 18.0, 0.0, 13.0, 0.0, 20.0, 11.0, 0.0, -12.0, 0.0, 0.0, -28.0, 0.0, 9.0, -222.0, -199.0, -77.0, -92.0, -34.0, -58.0, -100.0, -134.0, -38.0, -38.0, 17.0, 0.0, 0.0, 0.0, -54.0, -26.0, 8.0, 0.0, 17.0, 12.0, 5.0, 0.0, -99.0, 10.0, -114.0, -118.0, -64.0, 0.0, -30.0, 0.0, -12.0, -35.0, -2.0, 0.0, -246.0, -141.0, 0.0, 1.0, 0.0, -8.0, -378.0, -26.0, 0.0, -180.0, 0.0, -2.0, -12.0, -4.0, 16.0, 15.0, -136.0, -130.0, 0.0, 2.0, -223.0, -228.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 1.0, -4.0, -2.0, -35.0, 0.0, 32.0, 9.0, 26.0, -4.0, 0.0, 3.0, -98.0, -80.0, -8.0, -32.0, -5.0, -38.0, -4.0, -28.0, -66.0, 0.0], "policy_predator_policy_reward": [10.0, 8.0, 128.0, 0.0, 0.0, 0.0, 161.0, 27.0, 44.0, 0.0, 13.0, 135.0, 10.0, 144.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 23.0, 0.0, 147.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 26.0, 3.0, 16.0, 0.0, 19.0, 26.0, 0.0, 0.0, 0.0, 0.0, 128.0, 3.0, 0.0, 176.0, 0.0, 1.0, 164.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 3.0, 13.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 139.0, 10.0, 7.0, 4.0, 0.0, 17.0, 192.0, 20.0, 0.0, 1.0, 0.0, 0.0, 76.0, 0.0, 0.0, 18.0, 14.0, 1.0, 0.0, 0.0, 8.0, 0.0, 20.0, 0.0, 21.0, 106.0, 99.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 14.0, 2.0, 0.0, 0.0, 2.0, 113.0, 0.0, 46.0, 2.0, 37.0, 67.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 22.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 47.0, 0.0, 60.0, 32.0, 0.0, 15.0, 0.0, 13.0, 13.0, 0.0, 1.0, 0.0, 123.0, 4.0, 0.0, 4.0, 0.0, 189.0, 13.0, 0.0, 90.0, 3.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 71.0, 0.0, 0.0, 114.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 2.0, 21.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 71.0, 18.0, 0.0, 20.0, 0.0, 28.0, 14.0, 10.0, 23.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0684472720281033, "mean_inference_ms": 2.8417517615142303, "mean_action_processing_ms": 0.5994383141940028, "mean_env_wait_ms": 0.3928436464791353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006808876991271973, "StateBufferConnector_ms": 0.004498600959777832, "ViewRequirementAgentConnector_ms": 0.1626197099685669}, "num_episodes": 18, "episode_return_max": 41.0, "episode_return_min": -555.0, "episode_return_mean": -55.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.4516515156941, "num_env_steps_trained_throughput_per_sec": 261.4516515156941, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 15742.34, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15742.236, "sample_time_ms": 2174.4, "learn_time_ms": 13544.41, "learn_throughput": 295.325, "synch_weights_time_ms": 17.684}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "e1352_00000", "date": "2024-08-13_16-46-39", "timestamp": 1723581999, "time_this_iter_s": 15.396666049957275, "time_total_s": 520.2065782546997, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ad0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 520.2065782546997, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 76.62727272727274, "ram_util_percent": 86.57727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1270221950673553, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.0567798841567266, "policy_loss": -0.0008426595257506484, "vf_loss": 2.0496778675172695, "vf_explained_var": 0.4342354649273807, "kl": 0.011769888550420224, "entropy": 0.7765439276342039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.729807116493347, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.5988304086463163, "policy_loss": 0.002976703281371445, "vf_loss": 3.557520233386408, "vf_explained_var": -5.676632835751488e-09, "kl": 0.011217844820552735, "entropy": 0.8476754560987786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 41.0, "episode_reward_min": -555.0, "episode_reward_mean": -53.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -384.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 32.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -43.92, "predator_policy": 17.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -26.0, 15.0, -111.0, 6.0, -496.0, -187.0, 14.0, 20.0, 0.0, -2.0, -16.0, -2.0, 0.0, 2.0, -229.0, -17.0, 6.0, -555.0, -20.0, 0.0, -66.0, 13.0, -32.0, -1.0, 2.0, -38.0, -5.0, -31.0, 33.0, 13.0, 20.0, 11.0, -6.0, -12.0, 9.0, -306.0, -123.0, -53.0, -167.0, -55.0, 17.0, 0.0, -50.0, 8.0, 29.0, 5.0, -35.0, -172.0, -32.0, -15.0, -21.0, -1.0, -264.0, 5.0, -4.0, -202.0, -90.0, 1.0, -8.0, 31.0, -195.0, 2.0, -324.0, 0.0, 6.0, 0.0, 16.0, 0.0, 0.0, 16.0, 2.0, -4.0, -14.0, 41.0, 24.0, 3.0, -89.0, -20.0, -15.0, -8.0, -33.0, -24.0, -519.0, -8.0, 21.0, -213.0, -5.0, -4.0, -49.0, -338.0, 15.0, -15.0, -335.0, -2.0, 17.0, 22.0, 15.0, -117.0, -39.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.0, 22.0, 0.0, -52.0, 15.0, 0.0, -239.0, 0.0, 2.0, 1.0, -324.0, -348.0, -326.0, -26.0, 18.0, -8.0, 20.0, 0.0, 0.0, 0.0, -2.0, -2.0, -16.0, -16.0, 0.0, -4.0, 0.0, 0.0, 2.0, 0.0, -92.0, -291.0, -20.0, -14.0, 8.0, -6.0, -380.0, -384.0, -26.0, -14.0, -1.0, 0.0, -152.0, 10.0, 13.0, 0.0, -34.0, -30.0, 0.0, -2.0, -6.0, 0.0, -38.0, -20.0, -26.0, 0.0, -106.0, -130.0, 15.0, 18.0, 0.0, 13.0, 0.0, 20.0, 11.0, 0.0, -12.0, 0.0, 0.0, -28.0, 0.0, 9.0, -222.0, -199.0, -77.0, -92.0, -34.0, -58.0, -100.0, -134.0, -38.0, -38.0, 17.0, 0.0, 0.0, 0.0, -54.0, -26.0, 8.0, 0.0, 17.0, 12.0, 5.0, 0.0, -99.0, 10.0, -114.0, -118.0, -64.0, 0.0, -30.0, 0.0, -12.0, -35.0, -2.0, 0.0, -246.0, -141.0, 0.0, 1.0, 0.0, -8.0, -378.0, -26.0, 0.0, -180.0, 0.0, -2.0, -12.0, -4.0, 16.0, 15.0, -136.0, -130.0, 0.0, 2.0, -223.0, -228.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 1.0, -4.0, -2.0, -35.0, 0.0, 32.0, 9.0, 26.0, -4.0, 0.0, 3.0, -98.0, -80.0, -8.0, -32.0, -5.0, -38.0, -4.0, -28.0, -66.0, 0.0, -4.0, -44.0, -338.0, -362.0, -8.0, -4.0, 18.0, 0.0, -149.0, -145.0, 0.0, -10.0, -15.0, 0.0, -38.0, -42.0, -238.0, -221.0, 19.0, -8.0, -11.0, -22.0, -224.0, -226.0, -6.0, -9.0, 17.0, 0.0, 0.0, 22.0, -6.0, 18.0, -130.0, -80.0, -42.0, -38.0], "policy_predator_policy_reward": [0.0, 19.0, 26.0, 0.0, 0.0, 0.0, 0.0, 128.0, 3.0, 0.0, 176.0, 0.0, 1.0, 164.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 3.0, 13.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 139.0, 10.0, 7.0, 4.0, 0.0, 17.0, 192.0, 20.0, 0.0, 1.0, 0.0, 0.0, 76.0, 0.0, 0.0, 18.0, 14.0, 1.0, 0.0, 0.0, 8.0, 0.0, 20.0, 0.0, 21.0, 106.0, 99.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 14.0, 2.0, 0.0, 0.0, 2.0, 113.0, 0.0, 46.0, 2.0, 37.0, 67.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 22.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 47.0, 0.0, 60.0, 32.0, 0.0, 15.0, 0.0, 13.0, 13.0, 0.0, 1.0, 0.0, 123.0, 4.0, 0.0, 4.0, 0.0, 189.0, 13.0, 0.0, 90.0, 3.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 71.0, 0.0, 0.0, 114.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 2.0, 21.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 71.0, 18.0, 0.0, 20.0, 0.0, 28.0, 14.0, 10.0, 23.0, 10.0, 24.0, 0.0, 0.0, 181.0, 4.0, 0.0, 3.0, 0.0, 81.0, 0.0, 5.0, 0.0, 11.0, 0.0, 17.0, 14.0, 119.0, 2.0, 4.0, 0.0, 11.0, 7.0, 0.0, 115.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 70.0, 23.0, 33.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0644635923222643, "mean_inference_ms": 2.8319228289669836, "mean_action_processing_ms": 0.5929348405014118, "mean_env_wait_ms": 0.39130307811010995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006813406944274902, "StateBufferConnector_ms": 0.004470229148864746, "ViewRequirementAgentConnector_ms": 0.16093671321868896}, "num_episodes": 18, "episode_return_max": 41.0, "episode_return_min": -555.0, "episode_return_mean": -53.44, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.0137536064573, "num_env_steps_trained_throughput_per_sec": 263.0137536064573, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 15790.937, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15790.83, "sample_time_ms": 2194.996, "learn_time_ms": 13572.95, "learn_throughput": 294.704, "synch_weights_time_ms": 17.61}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "e1352_00000", "date": "2024-08-13_16-46-54", "timestamp": 1723582014, "time_this_iter_s": 15.26206088066101, "time_total_s": 535.4686391353607, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af103a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 535.4686391353607, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 76.99545454545455, "ram_util_percent": 85.27727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1249308576107655, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.5533452277461057, "policy_loss": -0.002843847060354338, "vf_loss": 2.547151866602519, "vf_explained_var": 0.12233271378057975, "kl": 0.013388455233446582, "entropy": 0.767086628252867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.408319530947499, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.207798480735254, "policy_loss": 0.003462521362157844, "vf_loss": 4.162584055668463, "vf_explained_var": -4.698990514038732e-09, "kl": 0.012218205850865013, "entropy": 0.9029361265361624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 41.0, "episode_reward_min": -555.0, "episode_reward_mean": -62.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -384.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 32.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -50.39, "predator_policy": 18.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-555.0, -20.0, 0.0, -66.0, 13.0, -32.0, -1.0, 2.0, -38.0, -5.0, -31.0, 33.0, 13.0, 20.0, 11.0, -6.0, -12.0, 9.0, -306.0, -123.0, -53.0, -167.0, -55.0, 17.0, 0.0, -50.0, 8.0, 29.0, 5.0, -35.0, -172.0, -32.0, -15.0, -21.0, -1.0, -264.0, 5.0, -4.0, -202.0, -90.0, 1.0, -8.0, 31.0, -195.0, 2.0, -324.0, 0.0, 6.0, 0.0, 16.0, 0.0, 0.0, 16.0, 2.0, -4.0, -14.0, 41.0, 24.0, 3.0, -89.0, -20.0, -15.0, -8.0, -33.0, -24.0, -519.0, -8.0, 21.0, -213.0, -5.0, -4.0, -49.0, -338.0, 15.0, -15.0, -335.0, -2.0, 17.0, 22.0, 15.0, -117.0, -39.0, -37.0, 0.0, 19.0, -275.0, -15.0, 8.0, -363.0, -18.0, 0.0, 12.0, 17.0, 11.0, -12.0, -323.0, -361.0, 2.0, -328.0, -287.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-380.0, -384.0, -26.0, -14.0, -1.0, 0.0, -152.0, 10.0, 13.0, 0.0, -34.0, -30.0, 0.0, -2.0, -6.0, 0.0, -38.0, -20.0, -26.0, 0.0, -106.0, -130.0, 15.0, 18.0, 0.0, 13.0, 0.0, 20.0, 11.0, 0.0, -12.0, 0.0, 0.0, -28.0, 0.0, 9.0, -222.0, -199.0, -77.0, -92.0, -34.0, -58.0, -100.0, -134.0, -38.0, -38.0, 17.0, 0.0, 0.0, 0.0, -54.0, -26.0, 8.0, 0.0, 17.0, 12.0, 5.0, 0.0, -99.0, 10.0, -114.0, -118.0, -64.0, 0.0, -30.0, 0.0, -12.0, -35.0, -2.0, 0.0, -246.0, -141.0, 0.0, 1.0, 0.0, -8.0, -378.0, -26.0, 0.0, -180.0, 0.0, -2.0, -12.0, -4.0, 16.0, 15.0, -136.0, -130.0, 0.0, 2.0, -223.0, -228.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 1.0, -4.0, -2.0, -35.0, 0.0, 32.0, 9.0, 26.0, -4.0, 0.0, 3.0, -98.0, -80.0, -8.0, -32.0, -5.0, -38.0, -4.0, -28.0, -66.0, 0.0, -4.0, -44.0, -338.0, -362.0, -8.0, -4.0, 18.0, 0.0, -149.0, -145.0, 0.0, -10.0, -15.0, 0.0, -38.0, -42.0, -238.0, -221.0, 19.0, -8.0, -11.0, -22.0, -224.0, -226.0, -6.0, -9.0, 17.0, 0.0, 0.0, 22.0, -6.0, 18.0, -130.0, -80.0, -42.0, -38.0, -6.0, -90.0, 0.0, 0.0, -6.0, 16.0, -176.0, -225.0, -14.0, -10.0, 3.0, 5.0, -270.0, -239.0, 3.0, -46.0, 0.0, 0.0, 12.0, 0.0, 16.0, 0.0, 10.0, 0.0, -24.0, 0.0, -230.0, -210.0, -300.0, -298.0, -7.0, -34.0, -171.0, -314.0, -212.0, -200.0], "policy_predator_policy_reward": [17.0, 192.0, 20.0, 0.0, 1.0, 0.0, 0.0, 76.0, 0.0, 0.0, 18.0, 14.0, 1.0, 0.0, 0.0, 8.0, 0.0, 20.0, 0.0, 21.0, 106.0, 99.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 14.0, 2.0, 0.0, 0.0, 2.0, 113.0, 0.0, 46.0, 2.0, 37.0, 67.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 22.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 47.0, 0.0, 60.0, 32.0, 0.0, 15.0, 0.0, 13.0, 13.0, 0.0, 1.0, 0.0, 123.0, 4.0, 0.0, 4.0, 0.0, 189.0, 13.0, 0.0, 90.0, 3.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 71.0, 0.0, 0.0, 114.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 2.0, 21.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 71.0, 18.0, 0.0, 20.0, 0.0, 28.0, 14.0, 10.0, 23.0, 10.0, 24.0, 0.0, 0.0, 181.0, 4.0, 0.0, 3.0, 0.0, 81.0, 0.0, 5.0, 0.0, 11.0, 0.0, 17.0, 14.0, 119.0, 2.0, 4.0, 0.0, 11.0, 7.0, 0.0, 115.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 70.0, 23.0, 33.0, 8.0, 26.0, 33.0, 0.0, 0.0, 9.0, 0.0, 104.0, 22.0, 0.0, 9.0, 0.0, 0.0, 0.0, 146.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 11.0, 1.0, 117.0, 0.0, 158.0, 79.0, 21.0, 22.0, 157.0, 0.0, 106.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0624786528474766, "mean_inference_ms": 2.8267536708833547, "mean_action_processing_ms": 0.5876006651799883, "mean_env_wait_ms": 0.39037446960461764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006597280502319336, "StateBufferConnector_ms": 0.005879759788513184, "ViewRequirementAgentConnector_ms": 0.15401875972747803}, "num_episodes": 18, "episode_return_max": 41.0, "episode_return_min": -555.0, "episode_return_mean": -62.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.2845659682675, "num_env_steps_trained_throughput_per_sec": 256.2845659682675, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 15516.43, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15516.324, "sample_time_ms": 2056.359, "learn_time_ms": 13435.779, "learn_throughput": 297.713, "synch_weights_time_ms": 18.264}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "e1352_00000", "date": "2024-08-13_16-47-10", "timestamp": 1723582030, "time_this_iter_s": 15.678299903869629, "time_total_s": 551.1469390392303, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ced30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 551.1469390392303, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 76.0409090909091, "ram_util_percent": 85.65454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.150248990818937, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.392120357953682, "policy_loss": -0.0026259685124925994, "vf_loss": 1.3837399498180107, "vf_explained_var": 0.22426138558085001, "kl": 0.016305744638728876, "entropy": 0.8140923843181953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.347681191910511, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 2.7520893959141284, "policy_loss": 0.001989888277634111, "vf_loss": 2.7175950858958813, "vf_explained_var": -9.082612537202382e-09, "kl": 0.009512040183427092, "entropy": 0.8660949776412318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 41.0, "episode_reward_min": -530.0, "episode_reward_mean": -65.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -760.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 32.0, "predator_policy": 808.0}, "policy_reward_mean": {"prey_policy": -55.035, "predator_policy": 22.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.0, 17.0, 0.0, -50.0, 8.0, 29.0, 5.0, -35.0, -172.0, -32.0, -15.0, -21.0, -1.0, -264.0, 5.0, -4.0, -202.0, -90.0, 1.0, -8.0, 31.0, -195.0, 2.0, -324.0, 0.0, 6.0, 0.0, 16.0, 0.0, 0.0, 16.0, 2.0, -4.0, -14.0, 41.0, 24.0, 3.0, -89.0, -20.0, -15.0, -8.0, -33.0, -24.0, -519.0, -8.0, 21.0, -213.0, -5.0, -4.0, -49.0, -338.0, 15.0, -15.0, -335.0, -2.0, 17.0, 22.0, 15.0, -117.0, -39.0, -37.0, 0.0, 19.0, -275.0, -15.0, 8.0, -363.0, -18.0, 0.0, 12.0, 17.0, 11.0, -12.0, -323.0, -361.0, 2.0, -328.0, -287.0, -354.0, -3.0, 0.0, -109.0, 0.0, 27.0, -6.0, -17.0, -197.0, -530.0, 32.0, -16.0, -34.0, -14.0, -3.0, -56.0, -177.0, -3.0, -6.0, 0.0, -9.0, -56.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.0, -38.0, 17.0, 0.0, 0.0, 0.0, -54.0, -26.0, 8.0, 0.0, 17.0, 12.0, 5.0, 0.0, -99.0, 10.0, -114.0, -118.0, -64.0, 0.0, -30.0, 0.0, -12.0, -35.0, -2.0, 0.0, -246.0, -141.0, 0.0, 1.0, 0.0, -8.0, -378.0, -26.0, 0.0, -180.0, 0.0, -2.0, -12.0, -4.0, 16.0, 15.0, -136.0, -130.0, 0.0, 2.0, -223.0, -228.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 1.0, -4.0, -2.0, -35.0, 0.0, 32.0, 9.0, 26.0, -4.0, 0.0, 3.0, -98.0, -80.0, -8.0, -32.0, -5.0, -38.0, -4.0, -28.0, -66.0, 0.0, -4.0, -44.0, -338.0, -362.0, -8.0, -4.0, 18.0, 0.0, -149.0, -145.0, 0.0, -10.0, -15.0, 0.0, -38.0, -42.0, -238.0, -221.0, 19.0, -8.0, -11.0, -22.0, -224.0, -226.0, -6.0, -9.0, 17.0, 0.0, 0.0, 22.0, -6.0, 18.0, -130.0, -80.0, -42.0, -38.0, -6.0, -90.0, 0.0, 0.0, -6.0, 16.0, -176.0, -225.0, -14.0, -10.0, 3.0, 5.0, -270.0, -239.0, 3.0, -46.0, 0.0, 0.0, 12.0, 0.0, 16.0, 0.0, 10.0, 0.0, -24.0, 0.0, -230.0, -210.0, -300.0, -298.0, -7.0, -34.0, -171.0, -314.0, -212.0, -200.0, -516.0, -760.0, -6.0, 0.0, 0.0, 0.0, -68.0, -84.0, 0.0, 0.0, 0.0, 27.0, 0.0, -12.0, -34.0, 0.0, -124.0, -146.0, -362.0, -385.0, 9.0, 23.0, 10.0, -56.0, -16.0, -69.0, 0.0, -28.0, -22.0, 0.0, -42.0, -42.0, -124.0, -130.0, -6.0, 0.0, -12.0, 0.0, 0.0, 0.0, -16.0, -14.0, 0.0, -120.0], "policy_predator_policy_reward": [0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 22.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 47.0, 0.0, 60.0, 32.0, 0.0, 15.0, 0.0, 13.0, 13.0, 0.0, 1.0, 0.0, 123.0, 4.0, 0.0, 4.0, 0.0, 189.0, 13.0, 0.0, 90.0, 3.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 71.0, 0.0, 0.0, 114.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 2.0, 21.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 71.0, 18.0, 0.0, 20.0, 0.0, 28.0, 14.0, 10.0, 23.0, 10.0, 24.0, 0.0, 0.0, 181.0, 4.0, 0.0, 3.0, 0.0, 81.0, 0.0, 5.0, 0.0, 11.0, 0.0, 17.0, 14.0, 119.0, 2.0, 4.0, 0.0, 11.0, 7.0, 0.0, 115.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 70.0, 23.0, 33.0, 8.0, 26.0, 33.0, 0.0, 0.0, 9.0, 0.0, 104.0, 22.0, 0.0, 9.0, 0.0, 0.0, 0.0, 146.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 11.0, 1.0, 117.0, 0.0, 158.0, 79.0, 21.0, 22.0, 157.0, 0.0, 106.0, 19.0, 114.0, 808.0, 3.0, 0.0, 0.0, 0.0, 43.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 17.0, 73.0, 0.0, 192.0, 25.0, 0.0, 0.0, 30.0, 0.0, 37.0, 14.0, 0.0, 14.0, 9.0, 10.0, 17.0, 11.0, 64.0, 13.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 7.0, 0.0, 64.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.061876355018385, "mean_inference_ms": 2.8281633456521353, "mean_action_processing_ms": 0.5821137530629918, "mean_env_wait_ms": 0.39008772809137476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004514932632446289, "StateBufferConnector_ms": 0.005063056945800781, "ViewRequirementAgentConnector_ms": 0.1487278938293457}, "num_episodes": 22, "episode_return_max": 41.0, "episode_return_min": -530.0, "episode_return_mean": -65.04, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.58455210608923, "num_env_steps_trained_throughput_per_sec": 260.58455210608923, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 15427.828, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15427.723, "sample_time_ms": 2047.381, "learn_time_ms": 13356.402, "learn_throughput": 299.482, "synch_weights_time_ms": 18.178}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "e1352_00000", "date": "2024-08-13_16-47-25", "timestamp": 1723582045, "time_this_iter_s": 15.424035787582397, "time_total_s": 566.5709748268127, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b164cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 566.5709748268127, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 76.01818181818182, "ram_util_percent": 86.03636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0057453572355881, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 1.6888717879063238, "policy_loss": -0.0006637614755028928, "vf_loss": 1.6797487681189542, "vf_explained_var": 0.29021873880946447, "kl": 0.01449893982732033, "entropy": 0.8749080937375467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.56286735974607, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 2.5323939118435774, "policy_loss": 0.0020016878049958636, "vf_loss": 2.4981697002415935, "vf_explained_var": -4.762064212213748e-09, "kl": 0.00942954573553519, "entropy": 0.8080546828489455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 41.0, "episode_reward_min": -530.0, "episode_reward_mean": -63.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -760.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 32.0, "predator_policy": 808.0}, "policy_reward_mean": {"prey_policy": -55.075, "predator_policy": 23.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-324.0, 0.0, 6.0, 0.0, 16.0, 0.0, 0.0, 16.0, 2.0, -4.0, -14.0, 41.0, 24.0, 3.0, -89.0, -20.0, -15.0, -8.0, -33.0, -24.0, -519.0, -8.0, 21.0, -213.0, -5.0, -4.0, -49.0, -338.0, 15.0, -15.0, -335.0, -2.0, 17.0, 22.0, 15.0, -117.0, -39.0, -37.0, 0.0, 19.0, -275.0, -15.0, 8.0, -363.0, -18.0, 0.0, 12.0, 17.0, 11.0, -12.0, -323.0, -361.0, 2.0, -328.0, -287.0, -354.0, -3.0, 0.0, -109.0, 0.0, 27.0, -6.0, -17.0, -197.0, -530.0, 32.0, -16.0, -34.0, -14.0, -3.0, -56.0, -177.0, -3.0, -6.0, 0.0, -9.0, -56.0, 13.0, -3.0, -7.0, -32.0, 21.0, 22.0, 2.0, 7.0, -18.0, -249.0, -20.0, -13.0, 8.0, 0.0, -122.0, -43.0, 0.0, -14.0, 23.0, -94.0, 4.0, -167.0, -257.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-223.0, -228.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 1.0, -4.0, -2.0, -35.0, 0.0, 32.0, 9.0, 26.0, -4.0, 0.0, 3.0, -98.0, -80.0, -8.0, -32.0, -5.0, -38.0, -4.0, -28.0, -66.0, 0.0, -4.0, -44.0, -338.0, -362.0, -8.0, -4.0, 18.0, 0.0, -149.0, -145.0, 0.0, -10.0, -15.0, 0.0, -38.0, -42.0, -238.0, -221.0, 19.0, -8.0, -11.0, -22.0, -224.0, -226.0, -6.0, -9.0, 17.0, 0.0, 0.0, 22.0, -6.0, 18.0, -130.0, -80.0, -42.0, -38.0, -6.0, -90.0, 0.0, 0.0, -6.0, 16.0, -176.0, -225.0, -14.0, -10.0, 3.0, 5.0, -270.0, -239.0, 3.0, -46.0, 0.0, 0.0, 12.0, 0.0, 16.0, 0.0, 10.0, 0.0, -24.0, 0.0, -230.0, -210.0, -300.0, -298.0, -7.0, -34.0, -171.0, -314.0, -212.0, -200.0, -516.0, -760.0, -6.0, 0.0, 0.0, 0.0, -68.0, -84.0, 0.0, 0.0, 0.0, 27.0, 0.0, -12.0, -34.0, 0.0, -124.0, -146.0, -362.0, -385.0, 9.0, 23.0, 10.0, -56.0, -16.0, -69.0, 0.0, -28.0, -22.0, 0.0, -42.0, -42.0, -124.0, -130.0, -6.0, 0.0, -12.0, 0.0, 0.0, 0.0, -16.0, -14.0, 0.0, -120.0, 14.0, -4.0, 0.0, -6.0, 0.0, -16.0, -64.0, 0.0, 0.0, 18.0, 14.0, -2.0, 0.0, -10.0, 0.0, 7.0, 0.0, -36.0, -136.0, -316.0, -47.0, 0.0, -25.0, -2.0, 5.0, 3.0, 0.0, 0.0, -156.0, -153.0, 0.0, -86.0, 0.0, 0.0, -6.0, -20.0, 0.0, 23.0, -60.0, -110.0, -12.0, 0.0, -149.0, -102.0, -188.0, -176.0], "policy_predator_policy_reward": [114.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 2.0, 21.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 71.0, 18.0, 0.0, 20.0, 0.0, 28.0, 14.0, 10.0, 23.0, 10.0, 24.0, 0.0, 0.0, 181.0, 4.0, 0.0, 3.0, 0.0, 81.0, 0.0, 5.0, 0.0, 11.0, 0.0, 17.0, 14.0, 119.0, 2.0, 4.0, 0.0, 11.0, 7.0, 0.0, 115.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 70.0, 23.0, 33.0, 8.0, 26.0, 33.0, 0.0, 0.0, 9.0, 0.0, 104.0, 22.0, 0.0, 9.0, 0.0, 0.0, 0.0, 146.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 11.0, 1.0, 117.0, 0.0, 158.0, 79.0, 21.0, 22.0, 157.0, 0.0, 106.0, 19.0, 114.0, 808.0, 3.0, 0.0, 0.0, 0.0, 43.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 17.0, 73.0, 0.0, 192.0, 25.0, 0.0, 0.0, 30.0, 0.0, 37.0, 14.0, 0.0, 14.0, 9.0, 10.0, 17.0, 11.0, 64.0, 13.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 7.0, 0.0, 64.0, 1.0, 2.0, 0.0, 3.0, 0.0, 9.0, 3.0, 29.0, 3.0, 0.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 18.0, 0.0, 47.0, 156.0, 27.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 111.0, 76.0, 43.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 7.0, 69.0, 6.0, 10.0, 69.0, 15.0, 37.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0606535706859543, "mean_inference_ms": 2.8269198526201738, "mean_action_processing_ms": 0.5770176280473767, "mean_env_wait_ms": 0.39000393798175864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050313472747802734, "StateBufferConnector_ms": 0.0051462650299072266, "ViewRequirementAgentConnector_ms": 0.14722979068756104}, "num_episodes": 23, "episode_return_max": 41.0, "episode_return_min": -530.0, "episode_return_mean": -63.97, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.3238332853533, "num_env_steps_trained_throughput_per_sec": 268.3238332853533, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 15468.046, "restore_workers_time_ms": 0.022, "training_step_time_ms": 15467.941, "sample_time_ms": 2048.788, "learn_time_ms": 13395.348, "learn_throughput": 298.611, "synch_weights_time_ms": 18.684}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "e1352_00000", "date": "2024-08-13_16-47-40", "timestamp": 1723582060, "time_this_iter_s": 14.930596828460693, "time_total_s": 581.5015716552734, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b164cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 581.5015716552734, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 75.01904761904761, "ram_util_percent": 85.89047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.131639148791631, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.201791082614313, "policy_loss": 0.0007177645296213173, "vf_loss": 2.1900626308072813, "vf_explained_var": 0.35715178197653835, "kl": 0.01631212816082496, "entropy": 0.8066177465297558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8930181528367696, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.267864471705502, "policy_loss": 0.0026193295558668162, "vf_loss": 3.2269638206592943, "vf_explained_var": -6.7488857047267695e-09, "kl": 0.011202579106200055, "entropy": 0.8324493672166552, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 32.0, "episode_reward_min": -530.0, "episode_reward_mean": -79.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -760.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 808.0}, "policy_reward_mean": {"prey_policy": -66.83, "predator_policy": 27.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.0, -24.0, -519.0, -8.0, 21.0, -213.0, -5.0, -4.0, -49.0, -338.0, 15.0, -15.0, -335.0, -2.0, 17.0, 22.0, 15.0, -117.0, -39.0, -37.0, 0.0, 19.0, -275.0, -15.0, 8.0, -363.0, -18.0, 0.0, 12.0, 17.0, 11.0, -12.0, -323.0, -361.0, 2.0, -328.0, -287.0, -354.0, -3.0, 0.0, -109.0, 0.0, 27.0, -6.0, -17.0, -197.0, -530.0, 32.0, -16.0, -34.0, -14.0, -3.0, -56.0, -177.0, -3.0, -6.0, 0.0, -9.0, -56.0, 13.0, -3.0, -7.0, -32.0, 21.0, 22.0, 2.0, 7.0, -18.0, -249.0, -20.0, -13.0, 8.0, 0.0, -122.0, -43.0, 0.0, -14.0, 23.0, -94.0, 4.0, -167.0, -257.0, -36.0, 19.0, -11.0, -72.0, 1.0, -485.0, -402.0, -342.0, -79.0, 12.0, -78.0, 1.0, 0.0, 12.0, -36.0, -322.0, -27.0, -52.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-66.0, 0.0, -4.0, -44.0, -338.0, -362.0, -8.0, -4.0, 18.0, 0.0, -149.0, -145.0, 0.0, -10.0, -15.0, 0.0, -38.0, -42.0, -238.0, -221.0, 19.0, -8.0, -11.0, -22.0, -224.0, -226.0, -6.0, -9.0, 17.0, 0.0, 0.0, 22.0, -6.0, 18.0, -130.0, -80.0, -42.0, -38.0, -6.0, -90.0, 0.0, 0.0, -6.0, 16.0, -176.0, -225.0, -14.0, -10.0, 3.0, 5.0, -270.0, -239.0, 3.0, -46.0, 0.0, 0.0, 12.0, 0.0, 16.0, 0.0, 10.0, 0.0, -24.0, 0.0, -230.0, -210.0, -300.0, -298.0, -7.0, -34.0, -171.0, -314.0, -212.0, -200.0, -516.0, -760.0, -6.0, 0.0, 0.0, 0.0, -68.0, -84.0, 0.0, 0.0, 0.0, 27.0, 0.0, -12.0, -34.0, 0.0, -124.0, -146.0, -362.0, -385.0, 9.0, 23.0, 10.0, -56.0, -16.0, -69.0, 0.0, -28.0, -22.0, 0.0, -42.0, -42.0, -124.0, -130.0, -6.0, 0.0, -12.0, 0.0, 0.0, 0.0, -16.0, -14.0, 0.0, -120.0, 14.0, -4.0, 0.0, -6.0, 0.0, -16.0, -64.0, 0.0, 0.0, 18.0, 14.0, -2.0, 0.0, -10.0, 0.0, 7.0, 0.0, -36.0, -136.0, -316.0, -47.0, 0.0, -25.0, -2.0, 5.0, 3.0, 0.0, 0.0, -156.0, -153.0, 0.0, -86.0, 0.0, 0.0, -6.0, -20.0, 0.0, 23.0, -60.0, -110.0, -12.0, 0.0, -149.0, -102.0, -188.0, -176.0, -40.0, -16.0, 19.0, 0.0, 1.0, -26.0, -120.0, -24.0, -12.0, 0.0, -320.0, -332.0, -224.0, -356.0, -341.0, -176.0, -80.0, -53.0, 23.0, -22.0, -90.0, -147.0, -5.0, 0.0, 0.0, 0.0, 24.0, -28.0, -55.0, -10.0, -172.0, -309.0, -41.0, -14.0, -65.0, -23.0], "policy_predator_policy_reward": [23.0, 10.0, 24.0, 0.0, 0.0, 181.0, 4.0, 0.0, 3.0, 0.0, 81.0, 0.0, 5.0, 0.0, 11.0, 0.0, 17.0, 14.0, 119.0, 2.0, 4.0, 0.0, 11.0, 7.0, 0.0, 115.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 70.0, 23.0, 33.0, 8.0, 26.0, 33.0, 0.0, 0.0, 9.0, 0.0, 104.0, 22.0, 0.0, 9.0, 0.0, 0.0, 0.0, 146.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 11.0, 1.0, 117.0, 0.0, 158.0, 79.0, 21.0, 22.0, 157.0, 0.0, 106.0, 19.0, 114.0, 808.0, 3.0, 0.0, 0.0, 0.0, 43.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 17.0, 73.0, 0.0, 192.0, 25.0, 0.0, 0.0, 30.0, 0.0, 37.0, 14.0, 0.0, 14.0, 9.0, 10.0, 17.0, 11.0, 64.0, 13.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 7.0, 0.0, 64.0, 1.0, 2.0, 0.0, 3.0, 0.0, 9.0, 3.0, 29.0, 3.0, 0.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 18.0, 0.0, 47.0, 156.0, 27.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 111.0, 76.0, 43.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 7.0, 69.0, 6.0, 10.0, 69.0, 15.0, 37.0, 70.0, 20.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 72.0, 0.0, 13.0, 0.0, 167.0, 178.0, 0.0, 0.0, 175.0, 0.0, 54.0, 0.0, 11.0, 62.0, 97.0, 6.0, 0.0, 0.0, 0.0, 4.0, 12.0, 10.0, 19.0, 2.0, 157.0, 0.0, 28.0, 0.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0591594255276207, "mean_inference_ms": 2.824621704446323, "mean_action_processing_ms": 0.5728913064007037, "mean_env_wait_ms": 0.3896765628997334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00507354736328125, "StateBufferConnector_ms": 0.005149483680725098, "ViewRequirementAgentConnector_ms": 0.13877630233764648}, "num_episodes": 18, "episode_return_max": 32.0, "episode_return_min": -530.0, "episode_return_mean": -79.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.37259417734504, "num_env_steps_trained_throughput_per_sec": 266.37259417734504, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 15455.731, "restore_workers_time_ms": 0.021, "training_step_time_ms": 15455.63, "sample_time_ms": 2019.016, "learn_time_ms": 13412.971, "learn_throughput": 298.219, "synch_weights_time_ms": 18.59}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "e1352_00000", "date": "2024-08-13_16-47-55", "timestamp": 1723582075, "time_this_iter_s": 15.081599950790405, "time_total_s": 596.5831716060638, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15a7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 596.5831716060638, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 77.78571428571429, "ram_util_percent": 85.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2691051227548136, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.0001760393223433, "policy_loss": -0.0001384163849430267, "vf_loss": 1.9894771132519635, "vf_explained_var": 0.1255404422838221, "kl": 0.01605532027958452, "entropy": 0.744998001232349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.859028844275172, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 2.9690853043838783, "policy_loss": 0.002623901510778716, "vf_loss": 2.9351251754180465, "vf_explained_var": -5.708169684838996e-09, "kl": 0.009170182312179047, "entropy": 0.7991629648460913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 40.0, "episode_reward_min": -530.0, "episode_reward_mean": -74.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -760.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 808.0}, "policy_reward_mean": {"prey_policy": -65.23, "predator_policy": 27.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.0, -37.0, 0.0, 19.0, -275.0, -15.0, 8.0, -363.0, -18.0, 0.0, 12.0, 17.0, 11.0, -12.0, -323.0, -361.0, 2.0, -328.0, -287.0, -354.0, -3.0, 0.0, -109.0, 0.0, 27.0, -6.0, -17.0, -197.0, -530.0, 32.0, -16.0, -34.0, -14.0, -3.0, -56.0, -177.0, -3.0, -6.0, 0.0, -9.0, -56.0, 13.0, -3.0, -7.0, -32.0, 21.0, 22.0, 2.0, 7.0, -18.0, -249.0, -20.0, -13.0, 8.0, 0.0, -122.0, -43.0, 0.0, -14.0, 23.0, -94.0, 4.0, -167.0, -257.0, -36.0, 19.0, -11.0, -72.0, 1.0, -485.0, -402.0, -342.0, -79.0, 12.0, -78.0, 1.0, 0.0, 12.0, -36.0, -322.0, -27.0, -52.0, 40.0, -295.0, -201.0, 7.0, -182.0, -105.0, -24.0, -6.0, 16.0, -13.0, -34.0, -34.0, 0.0, 16.0, 0.0, 28.0, -334.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-42.0, -38.0, -6.0, -90.0, 0.0, 0.0, -6.0, 16.0, -176.0, -225.0, -14.0, -10.0, 3.0, 5.0, -270.0, -239.0, 3.0, -46.0, 0.0, 0.0, 12.0, 0.0, 16.0, 0.0, 10.0, 0.0, -24.0, 0.0, -230.0, -210.0, -300.0, -298.0, -7.0, -34.0, -171.0, -314.0, -212.0, -200.0, -516.0, -760.0, -6.0, 0.0, 0.0, 0.0, -68.0, -84.0, 0.0, 0.0, 0.0, 27.0, 0.0, -12.0, -34.0, 0.0, -124.0, -146.0, -362.0, -385.0, 9.0, 23.0, 10.0, -56.0, -16.0, -69.0, 0.0, -28.0, -22.0, 0.0, -42.0, -42.0, -124.0, -130.0, -6.0, 0.0, -12.0, 0.0, 0.0, 0.0, -16.0, -14.0, 0.0, -120.0, 14.0, -4.0, 0.0, -6.0, 0.0, -16.0, -64.0, 0.0, 0.0, 18.0, 14.0, -2.0, 0.0, -10.0, 0.0, 7.0, 0.0, -36.0, -136.0, -316.0, -47.0, 0.0, -25.0, -2.0, 5.0, 3.0, 0.0, 0.0, -156.0, -153.0, 0.0, -86.0, 0.0, 0.0, -6.0, -20.0, 0.0, 23.0, -60.0, -110.0, -12.0, 0.0, -149.0, -102.0, -188.0, -176.0, -40.0, -16.0, 19.0, 0.0, 1.0, -26.0, -120.0, -24.0, -12.0, 0.0, -320.0, -332.0, -224.0, -356.0, -341.0, -176.0, -80.0, -53.0, 23.0, -22.0, -90.0, -147.0, -5.0, 0.0, 0.0, 0.0, 24.0, -28.0, -55.0, -10.0, -172.0, -309.0, -41.0, -14.0, -65.0, -23.0, 19.0, 21.0, -376.0, -118.0, -149.0, -132.0, -24.0, 16.0, -166.0, -106.0, -2.0, -208.0, -53.0, -4.0, -12.0, 0.0, 28.0, -24.0, -6.0, -18.0, -76.0, -10.0, -18.0, -34.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 15.0, 13.0, -260.0, -312.0, -4.0, -8.0], "policy_predator_policy_reward": [33.0, 8.0, 26.0, 33.0, 0.0, 0.0, 9.0, 0.0, 104.0, 22.0, 0.0, 9.0, 0.0, 0.0, 0.0, 146.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 11.0, 1.0, 117.0, 0.0, 158.0, 79.0, 21.0, 22.0, 157.0, 0.0, 106.0, 19.0, 114.0, 808.0, 3.0, 0.0, 0.0, 0.0, 43.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 17.0, 73.0, 0.0, 192.0, 25.0, 0.0, 0.0, 30.0, 0.0, 37.0, 14.0, 0.0, 14.0, 9.0, 10.0, 17.0, 11.0, 64.0, 13.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 7.0, 0.0, 64.0, 1.0, 2.0, 0.0, 3.0, 0.0, 9.0, 3.0, 29.0, 3.0, 0.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 18.0, 0.0, 47.0, 156.0, 27.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 111.0, 76.0, 43.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 7.0, 69.0, 6.0, 10.0, 69.0, 15.0, 37.0, 70.0, 20.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 72.0, 0.0, 13.0, 0.0, 167.0, 178.0, 0.0, 0.0, 175.0, 0.0, 54.0, 0.0, 11.0, 62.0, 97.0, 6.0, 0.0, 0.0, 0.0, 4.0, 12.0, 10.0, 19.0, 2.0, 157.0, 0.0, 28.0, 0.0, 36.0, 0.0, 0.0, 188.0, 11.0, 80.0, 0.0, 0.0, 15.0, 83.0, 7.0, 105.0, 0.0, 12.0, 21.0, 0.0, 6.0, 12.0, 0.0, 11.0, 0.0, 38.0, 14.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 156.0, 82.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.057547362097938, "mean_inference_ms": 2.821074517368549, "mean_action_processing_ms": 0.5690250465932399, "mean_env_wait_ms": 0.3892162604567397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005105018615722656, "StateBufferConnector_ms": 0.0051223039627075195, "ViewRequirementAgentConnector_ms": 0.16518807411193848}, "num_episodes": 18, "episode_return_max": 40.0, "episode_return_min": -530.0, "episode_return_mean": -74.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.34796919482443, "num_env_steps_trained_throughput_per_sec": 260.34796919482443, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 15408.274, "restore_workers_time_ms": 0.021, "training_step_time_ms": 15408.211, "sample_time_ms": 2034.985, "learn_time_ms": 13352.682, "learn_throughput": 299.565, "synch_weights_time_ms": 16.477}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "e1352_00000", "date": "2024-08-13_16-48-11", "timestamp": 1723582091, "time_this_iter_s": 15.45742416381836, "time_total_s": 612.0405957698822, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b164cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 612.0405957698822, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 76.32727272727273, "ram_util_percent": 86.50909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5147772761879774, "cur_kl_coeff": 0.675, "cur_lr": 0.009999999999999998, "total_loss": 2.2625356617428007, "policy_loss": 0.0014894048195509683, "vf_loss": 2.246675493351366, "vf_explained_var": 0.20892757344498206, "kl": 0.021290014258440407, "entropy": 0.922998843495808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.316616557096993, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.6147065040926454, "policy_loss": 0.0019639581018102864, "vf_loss": 3.584774169152376, "vf_explained_var": -4.00517983411355e-09, "kl": 0.00818461945716436, "entropy": 0.712379174872681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 40.0, "episode_reward_min": -530.0, "episode_reward_mean": -68.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -385.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -58.475, "predator_policy": 24.085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.0, 0.0, 27.0, -6.0, -17.0, -197.0, -530.0, 32.0, -16.0, -34.0, -14.0, -3.0, -56.0, -177.0, -3.0, -6.0, 0.0, -9.0, -56.0, 13.0, -3.0, -7.0, -32.0, 21.0, 22.0, 2.0, 7.0, -18.0, -249.0, -20.0, -13.0, 8.0, 0.0, -122.0, -43.0, 0.0, -14.0, 23.0, -94.0, 4.0, -167.0, -257.0, -36.0, 19.0, -11.0, -72.0, 1.0, -485.0, -402.0, -342.0, -79.0, 12.0, -78.0, 1.0, 0.0, 12.0, -36.0, -322.0, -27.0, -52.0, 40.0, -295.0, -201.0, 7.0, -182.0, -105.0, -24.0, -6.0, 16.0, -13.0, -34.0, -34.0, 0.0, 16.0, 0.0, 28.0, -334.0, -7.0, -137.0, -108.0, 0.0, -53.0, -141.0, -99.0, -155.0, -20.0, -15.0, 23.0, -311.0, 15.0, -1.0, 11.0, -10.0, 0.0, -16.0, -431.0, -56.0, 9.0, -236.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-68.0, -84.0, 0.0, 0.0, 0.0, 27.0, 0.0, -12.0, -34.0, 0.0, -124.0, -146.0, -362.0, -385.0, 9.0, 23.0, 10.0, -56.0, -16.0, -69.0, 0.0, -28.0, -22.0, 0.0, -42.0, -42.0, -124.0, -130.0, -6.0, 0.0, -12.0, 0.0, 0.0, 0.0, -16.0, -14.0, 0.0, -120.0, 14.0, -4.0, 0.0, -6.0, 0.0, -16.0, -64.0, 0.0, 0.0, 18.0, 14.0, -2.0, 0.0, -10.0, 0.0, 7.0, 0.0, -36.0, -136.0, -316.0, -47.0, 0.0, -25.0, -2.0, 5.0, 3.0, 0.0, 0.0, -156.0, -153.0, 0.0, -86.0, 0.0, 0.0, -6.0, -20.0, 0.0, 23.0, -60.0, -110.0, -12.0, 0.0, -149.0, -102.0, -188.0, -176.0, -40.0, -16.0, 19.0, 0.0, 1.0, -26.0, -120.0, -24.0, -12.0, 0.0, -320.0, -332.0, -224.0, -356.0, -341.0, -176.0, -80.0, -53.0, 23.0, -22.0, -90.0, -147.0, -5.0, 0.0, 0.0, 0.0, 24.0, -28.0, -55.0, -10.0, -172.0, -309.0, -41.0, -14.0, -65.0, -23.0, 19.0, 21.0, -376.0, -118.0, -149.0, -132.0, -24.0, 16.0, -166.0, -106.0, -2.0, -208.0, -53.0, -4.0, -12.0, 0.0, 28.0, -24.0, -6.0, -18.0, -76.0, -10.0, -18.0, -34.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 15.0, 13.0, -260.0, -312.0, -4.0, -8.0, -258.0, -8.0, -81.0, -139.0, 0.0, 0.0, -115.0, 0.0, -104.0, -187.0, -189.0, -20.0, -178.0, -128.0, -34.0, -6.0, 0.0, -37.0, 0.0, 23.0, -186.0, -264.0, 15.0, 0.0, 4.0, -18.0, 1.0, 10.0, -21.0, 0.0, 0.0, 0.0, -14.0, -24.0, -378.0, -242.0, -58.0, -42.0, -20.0, 14.0, -163.0, -160.0, 0.0, -21.0], "policy_predator_policy_reward": [43.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 17.0, 73.0, 0.0, 192.0, 25.0, 0.0, 0.0, 30.0, 0.0, 37.0, 14.0, 0.0, 14.0, 9.0, 10.0, 17.0, 11.0, 64.0, 13.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 7.0, 0.0, 64.0, 1.0, 2.0, 0.0, 3.0, 0.0, 9.0, 3.0, 29.0, 3.0, 0.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 18.0, 0.0, 47.0, 156.0, 27.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 111.0, 76.0, 43.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 7.0, 69.0, 6.0, 10.0, 69.0, 15.0, 37.0, 70.0, 20.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 72.0, 0.0, 13.0, 0.0, 167.0, 178.0, 0.0, 0.0, 175.0, 0.0, 54.0, 0.0, 11.0, 62.0, 97.0, 6.0, 0.0, 0.0, 0.0, 4.0, 12.0, 10.0, 19.0, 2.0, 157.0, 0.0, 28.0, 0.0, 36.0, 0.0, 0.0, 188.0, 11.0, 80.0, 0.0, 0.0, 15.0, 83.0, 7.0, 105.0, 0.0, 12.0, 21.0, 0.0, 6.0, 12.0, 0.0, 11.0, 0.0, 38.0, 14.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 156.0, 82.0, 5.0, 0.0, 129.0, 0.0, 112.0, 0.0, 0.0, 0.0, 62.0, 0.0, 150.0, 0.0, 100.0, 10.0, 62.0, 89.0, 0.0, 20.0, 4.0, 18.0, 0.0, 0.0, 7.0, 132.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 10.0, 12.0, 0.0, 189.0, 44.0, 0.0, 10.0, 5.0, 0.0, 87.0, 12.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0523709984902447, "mean_inference_ms": 2.8100780721685776, "mean_action_processing_ms": 0.5634314948717636, "mean_env_wait_ms": 0.3874440347387996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009568572044372559, "StateBufferConnector_ms": 0.0038019418716430664, "ViewRequirementAgentConnector_ms": 0.16823744773864746}, "num_episodes": 22, "episode_return_max": 40.0, "episode_return_min": -530.0, "episode_return_mean": -68.78, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.78876973841503, "num_env_steps_trained_throughput_per_sec": 254.78876973841503, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 15370.531, "restore_workers_time_ms": 0.021, "training_step_time_ms": 15370.42, "sample_time_ms": 1987.66, "learn_time_ms": 13361.723, "learn_throughput": 299.363, "synch_weights_time_ms": 16.693}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "e1352_00000", "date": "2024-08-13_16-48-27", "timestamp": 1723582107, "time_this_iter_s": 15.770941019058228, "time_total_s": 627.8115367889404, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15d2b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 627.8115367889404, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 78.10454545454546, "ram_util_percent": 85.95454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6106994152542145, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 2.88139389980407, "policy_loss": 2.696865371295384e-05, "vf_loss": 2.8663795176006497, "vf_explained_var": 0.05454308138322578, "kl": 0.014802379835668561, "entropy": 0.8493215893311475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.768089571264055, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.600537769882767, "policy_loss": 0.0022630453336412314, "vf_loss": 4.572718883696057, "vf_explained_var": -5.739706533926505e-09, "kl": 0.007478617487607487, "entropy": 0.6364008826553507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 40.0, "episode_reward_min": -485.0, "episode_reward_mean": -74.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -378.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -65.06, "predator_policy": 27.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 22.0, 2.0, 7.0, -18.0, -249.0, -20.0, -13.0, 8.0, 0.0, -122.0, -43.0, 0.0, -14.0, 23.0, -94.0, 4.0, -167.0, -257.0, -36.0, 19.0, -11.0, -72.0, 1.0, -485.0, -402.0, -342.0, -79.0, 12.0, -78.0, 1.0, 0.0, 12.0, -36.0, -322.0, -27.0, -52.0, 40.0, -295.0, -201.0, 7.0, -182.0, -105.0, -24.0, -6.0, 16.0, -13.0, -34.0, -34.0, 0.0, 16.0, 0.0, 28.0, -334.0, -7.0, -137.0, -108.0, 0.0, -53.0, -141.0, -99.0, -155.0, -20.0, -15.0, 23.0, -311.0, 15.0, -1.0, 11.0, -10.0, 0.0, -16.0, -431.0, -56.0, 9.0, -236.0, -9.0, -25.0, -5.0, -201.0, -205.0, -100.0, 3.0, -87.0, -390.0, -73.0, 5.0, -17.0, 0.0, -165.0, 14.0, -34.0, -5.0, -190.0, 9.0, 12.0, -39.0, -44.0, -210.0, -42.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 18.0, 14.0, -2.0, 0.0, -10.0, 0.0, 7.0, 0.0, -36.0, -136.0, -316.0, -47.0, 0.0, -25.0, -2.0, 5.0, 3.0, 0.0, 0.0, -156.0, -153.0, 0.0, -86.0, 0.0, 0.0, -6.0, -20.0, 0.0, 23.0, -60.0, -110.0, -12.0, 0.0, -149.0, -102.0, -188.0, -176.0, -40.0, -16.0, 19.0, 0.0, 1.0, -26.0, -120.0, -24.0, -12.0, 0.0, -320.0, -332.0, -224.0, -356.0, -341.0, -176.0, -80.0, -53.0, 23.0, -22.0, -90.0, -147.0, -5.0, 0.0, 0.0, 0.0, 24.0, -28.0, -55.0, -10.0, -172.0, -309.0, -41.0, -14.0, -65.0, -23.0, 19.0, 21.0, -376.0, -118.0, -149.0, -132.0, -24.0, 16.0, -166.0, -106.0, -2.0, -208.0, -53.0, -4.0, -12.0, 0.0, 28.0, -24.0, -6.0, -18.0, -76.0, -10.0, -18.0, -34.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 15.0, 13.0, -260.0, -312.0, -4.0, -8.0, -258.0, -8.0, -81.0, -139.0, 0.0, 0.0, -115.0, 0.0, -104.0, -187.0, -189.0, -20.0, -178.0, -128.0, -34.0, -6.0, 0.0, -37.0, 0.0, 23.0, -186.0, -264.0, 15.0, 0.0, 4.0, -18.0, 1.0, 10.0, -21.0, 0.0, 0.0, 0.0, -14.0, -24.0, -378.0, -242.0, -58.0, -42.0, -20.0, 14.0, -163.0, -160.0, 0.0, -21.0, -22.0, -28.0, 0.0, -10.0, -116.0, -215.0, -330.0, -40.0, -243.0, 19.0, 4.0, -4.0, 0.0, -176.0, -368.0, -206.0, -131.0, -50.0, 0.0, 5.0, -39.0, 0.0, 0.0, 0.0, -140.0, -98.0, 8.0, 0.0, 0.0, -68.0, -10.0, 0.0, -216.0, -150.0, 9.0, 0.0, 0.0, 5.0, -80.0, 0.0, -101.0, -3.0, -144.0, -214.0, 0.0, -84.0], "policy_predator_policy_reward": [3.0, 0.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 18.0, 0.0, 47.0, 156.0, 27.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 111.0, 76.0, 43.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 7.0, 69.0, 6.0, 10.0, 69.0, 15.0, 37.0, 70.0, 20.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 72.0, 0.0, 13.0, 0.0, 167.0, 178.0, 0.0, 0.0, 175.0, 0.0, 54.0, 0.0, 11.0, 62.0, 97.0, 6.0, 0.0, 0.0, 0.0, 4.0, 12.0, 10.0, 19.0, 2.0, 157.0, 0.0, 28.0, 0.0, 36.0, 0.0, 0.0, 188.0, 11.0, 80.0, 0.0, 0.0, 15.0, 83.0, 7.0, 105.0, 0.0, 12.0, 21.0, 0.0, 6.0, 12.0, 0.0, 11.0, 0.0, 38.0, 14.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 156.0, 82.0, 5.0, 0.0, 129.0, 0.0, 112.0, 0.0, 0.0, 0.0, 62.0, 0.0, 150.0, 0.0, 100.0, 10.0, 62.0, 89.0, 0.0, 20.0, 4.0, 18.0, 0.0, 0.0, 7.0, 132.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 10.0, 12.0, 0.0, 189.0, 44.0, 0.0, 10.0, 5.0, 0.0, 87.0, 12.0, 0.0, 11.0, 14.0, 5.0, 0.0, 130.0, 0.0, 0.0, 165.0, 113.0, 11.0, 3.0, 0.0, 0.0, 89.0, 0.0, 184.0, 71.0, 37.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 32.0, 41.0, 6.0, 0.0, 5.0, 29.0, 0.0, 5.0, 18.0, 158.0, 0.0, 0.0, 0.0, 7.0, 0.0, 41.0, 0.0, 60.0, 83.0, 65.0, 0.0, 42.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0470893479502592, "mean_inference_ms": 2.791349470668288, "mean_action_processing_ms": 0.5584945065440009, "mean_env_wait_ms": 0.3858420718539682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009430646896362305, "StateBufferConnector_ms": 0.0036280155181884766, "ViewRequirementAgentConnector_ms": 0.18374276161193848}, "num_episodes": 23, "episode_return_max": 40.0, "episode_return_min": -485.0, "episode_return_mean": -74.64, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.2352922261207, "num_env_steps_trained_throughput_per_sec": 254.2352922261207, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 15352.971, "restore_workers_time_ms": 0.021, "training_step_time_ms": 15352.86, "sample_time_ms": 1993.883, "learn_time_ms": 13337.378, "learn_throughput": 299.909, "synch_weights_time_ms": 17.316}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "e1352_00000", "date": "2024-08-13_16-48-43", "timestamp": 1723582123, "time_this_iter_s": 15.830209732055664, "time_total_s": 643.6417465209961, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1608d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 643.6417465209961, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 76.39090909090909, "ram_util_percent": 85.47727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5449273217922797, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 3.0137252392592253, "policy_loss": -0.0026459934217017635, "vf_loss": 2.99978838957176, "vf_explained_var": 0.21887519003222228, "kl": 0.01637810649234262, "entropy": 0.8467541390625888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8300764881429217, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 4.597619666750469, "policy_loss": 0.0026281051444894976, "vf_loss": 4.572305249158667, "vf_explained_var": -4.667453664951224e-09, "kl": 0.006638887974936528, "entropy": 0.5234490777922686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 40.0, "episode_reward_min": -485.0, "episode_reward_mean": -83.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -378.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -71.925, "predator_policy": 30.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-257.0, -36.0, 19.0, -11.0, -72.0, 1.0, -485.0, -402.0, -342.0, -79.0, 12.0, -78.0, 1.0, 0.0, 12.0, -36.0, -322.0, -27.0, -52.0, 40.0, -295.0, -201.0, 7.0, -182.0, -105.0, -24.0, -6.0, 16.0, -13.0, -34.0, -34.0, 0.0, 16.0, 0.0, 28.0, -334.0, -7.0, -137.0, -108.0, 0.0, -53.0, -141.0, -99.0, -155.0, -20.0, -15.0, 23.0, -311.0, 15.0, -1.0, 11.0, -10.0, 0.0, -16.0, -431.0, -56.0, 9.0, -236.0, -9.0, -25.0, -5.0, -201.0, -205.0, -100.0, 3.0, -87.0, -390.0, -73.0, 5.0, -17.0, 0.0, -165.0, 14.0, -34.0, -5.0, -190.0, 9.0, 12.0, -39.0, -44.0, -210.0, -42.0, -56.0, 3.0, -37.0, -63.0, -36.0, -330.0, -132.0, -1.0, -2.0, -1.0, -183.0, -159.0, -74.0, -11.0, -180.0, -89.0, -88.0, -107.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-188.0, -176.0, -40.0, -16.0, 19.0, 0.0, 1.0, -26.0, -120.0, -24.0, -12.0, 0.0, -320.0, -332.0, -224.0, -356.0, -341.0, -176.0, -80.0, -53.0, 23.0, -22.0, -90.0, -147.0, -5.0, 0.0, 0.0, 0.0, 24.0, -28.0, -55.0, -10.0, -172.0, -309.0, -41.0, -14.0, -65.0, -23.0, 19.0, 21.0, -376.0, -118.0, -149.0, -132.0, -24.0, 16.0, -166.0, -106.0, -2.0, -208.0, -53.0, -4.0, -12.0, 0.0, 28.0, -24.0, -6.0, -18.0, -76.0, -10.0, -18.0, -34.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 15.0, 13.0, -260.0, -312.0, -4.0, -8.0, -258.0, -8.0, -81.0, -139.0, 0.0, 0.0, -115.0, 0.0, -104.0, -187.0, -189.0, -20.0, -178.0, -128.0, -34.0, -6.0, 0.0, -37.0, 0.0, 23.0, -186.0, -264.0, 15.0, 0.0, 4.0, -18.0, 1.0, 10.0, -21.0, 0.0, 0.0, 0.0, -14.0, -24.0, -378.0, -242.0, -58.0, -42.0, -20.0, 14.0, -163.0, -160.0, 0.0, -21.0, -22.0, -28.0, 0.0, -10.0, -116.0, -215.0, -330.0, -40.0, -243.0, 19.0, 4.0, -4.0, 0.0, -176.0, -368.0, -206.0, -131.0, -50.0, 0.0, 5.0, -39.0, 0.0, 0.0, 0.0, -140.0, -98.0, 8.0, 0.0, 0.0, -68.0, -10.0, 0.0, -216.0, -150.0, 9.0, 0.0, 0.0, 5.0, -80.0, 0.0, -101.0, -3.0, -144.0, -214.0, 0.0, -84.0, -80.0, -29.0, 0.0, 3.0, -92.0, 9.0, -14.0, -112.0, -72.0, 0.0, -216.0, -231.0, -264.0, 0.0, -2.0, 0.0, -22.0, 0.0, -2.0, 0.0, -122.0, -122.0, -223.0, -56.0, -130.0, -24.0, -22.0, -14.0, -136.0, -251.0, -84.0, -70.0, -58.0, -118.0, -116.0, -61.0], "policy_predator_policy_reward": [37.0, 70.0, 20.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 72.0, 0.0, 13.0, 0.0, 167.0, 178.0, 0.0, 0.0, 175.0, 0.0, 54.0, 0.0, 11.0, 62.0, 97.0, 6.0, 0.0, 0.0, 0.0, 4.0, 12.0, 10.0, 19.0, 2.0, 157.0, 0.0, 28.0, 0.0, 36.0, 0.0, 0.0, 188.0, 11.0, 80.0, 0.0, 0.0, 15.0, 83.0, 7.0, 105.0, 0.0, 12.0, 21.0, 0.0, 6.0, 12.0, 0.0, 11.0, 0.0, 38.0, 14.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 156.0, 82.0, 5.0, 0.0, 129.0, 0.0, 112.0, 0.0, 0.0, 0.0, 62.0, 0.0, 150.0, 0.0, 100.0, 10.0, 62.0, 89.0, 0.0, 20.0, 4.0, 18.0, 0.0, 0.0, 7.0, 132.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 10.0, 12.0, 0.0, 189.0, 44.0, 0.0, 10.0, 5.0, 0.0, 87.0, 12.0, 0.0, 11.0, 14.0, 5.0, 0.0, 130.0, 0.0, 0.0, 165.0, 113.0, 11.0, 3.0, 0.0, 0.0, 89.0, 0.0, 184.0, 71.0, 37.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 32.0, 41.0, 6.0, 0.0, 5.0, 29.0, 0.0, 5.0, 18.0, 158.0, 0.0, 0.0, 0.0, 7.0, 0.0, 41.0, 0.0, 60.0, 83.0, 65.0, 0.0, 42.0, 0.0, 53.0, 0.0, 0.0, 44.0, 2.0, 0.0, 63.0, 0.0, 36.0, 0.0, 117.0, 36.0, 96.0, 0.0, 1.0, 0.0, 20.0, 1.0, 0.0, 61.0, 0.0, 0.0, 120.0, 80.0, 0.0, 25.0, 0.0, 135.0, 72.0, 12.0, 53.0, 5.0, 83.0, 37.0, 33.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0449993735731797, "mean_inference_ms": 2.7908748096537606, "mean_action_processing_ms": 0.554105698039962, "mean_env_wait_ms": 0.38550790217669345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009189844131469727, "StateBufferConnector_ms": 0.0037271976470947266, "ViewRequirementAgentConnector_ms": 0.2090461254119873}, "num_episodes": 18, "episode_return_max": 40.0, "episode_return_min": -485.0, "episode_return_mean": -83.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.2929776851401, "num_env_steps_trained_throughput_per_sec": 200.2929776851401, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 15815.683, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15815.569, "sample_time_ms": 2166.058, "learn_time_ms": 13627.416, "learn_throughput": 293.526, "synch_weights_time_ms": 17.969}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "e1352_00000", "date": "2024-08-13_16-49-03", "timestamp": 1723582143, "time_this_iter_s": 20.062628030776978, "time_total_s": 663.7043745517731, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ad430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 663.7043745517731, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 91.81071428571431, "ram_util_percent": 83.36428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.504304050248136, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 3.202321399771978, "policy_loss": -0.00019525326024642383, "vf_loss": 3.1871225459235055, "vf_explained_var": 0.1583037774398844, "kl": 0.015204061099004344, "entropy": 0.7118425238384771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.75651396913109, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.009999999999999998, "total_loss": 3.7164082640693303, "policy_loss": 0.0018042499061535905, "vf_loss": 3.69781603056287, "vf_explained_var": -2.6806321724382026e-09, "kl": 0.004912812746054908, "entropy": 0.40163231656034154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 40.0, "episode_reward_min": -431.0, "episode_reward_mean": -79.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -388.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -70.355, "predator_policy": 30.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.0, 40.0, -295.0, -201.0, 7.0, -182.0, -105.0, -24.0, -6.0, 16.0, -13.0, -34.0, -34.0, 0.0, 16.0, 0.0, 28.0, -334.0, -7.0, -137.0, -108.0, 0.0, -53.0, -141.0, -99.0, -155.0, -20.0, -15.0, 23.0, -311.0, 15.0, -1.0, 11.0, -10.0, 0.0, -16.0, -431.0, -56.0, 9.0, -236.0, -9.0, -25.0, -5.0, -201.0, -205.0, -100.0, 3.0, -87.0, -390.0, -73.0, 5.0, -17.0, 0.0, -165.0, 14.0, -34.0, -5.0, -190.0, 9.0, 12.0, -39.0, -44.0, -210.0, -42.0, -56.0, 3.0, -37.0, -63.0, -36.0, -330.0, -132.0, -1.0, -2.0, -1.0, -183.0, -159.0, -74.0, -11.0, -180.0, -89.0, -88.0, -107.0, 0.0, 4.0, -135.0, -107.0, -97.0, -57.0, -347.0, -5.0, 3.0, -12.0, 2.0, -7.0, -44.0, -203.0, -295.0, 15.0, -377.0, -34.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-65.0, -23.0, 19.0, 21.0, -376.0, -118.0, -149.0, -132.0, -24.0, 16.0, -166.0, -106.0, -2.0, -208.0, -53.0, -4.0, -12.0, 0.0, 28.0, -24.0, -6.0, -18.0, -76.0, -10.0, -18.0, -34.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 15.0, 13.0, -260.0, -312.0, -4.0, -8.0, -258.0, -8.0, -81.0, -139.0, 0.0, 0.0, -115.0, 0.0, -104.0, -187.0, -189.0, -20.0, -178.0, -128.0, -34.0, -6.0, 0.0, -37.0, 0.0, 23.0, -186.0, -264.0, 15.0, 0.0, 4.0, -18.0, 1.0, 10.0, -21.0, 0.0, 0.0, 0.0, -14.0, -24.0, -378.0, -242.0, -58.0, -42.0, -20.0, 14.0, -163.0, -160.0, 0.0, -21.0, -22.0, -28.0, 0.0, -10.0, -116.0, -215.0, -330.0, -40.0, -243.0, 19.0, 4.0, -4.0, 0.0, -176.0, -368.0, -206.0, -131.0, -50.0, 0.0, 5.0, -39.0, 0.0, 0.0, 0.0, -140.0, -98.0, 8.0, 0.0, 0.0, -68.0, -10.0, 0.0, -216.0, -150.0, 9.0, 0.0, 0.0, 5.0, -80.0, 0.0, -101.0, -3.0, -144.0, -214.0, 0.0, -84.0, -80.0, -29.0, 0.0, 3.0, -92.0, 9.0, -14.0, -112.0, -72.0, 0.0, -216.0, -231.0, -264.0, 0.0, -2.0, 0.0, -22.0, 0.0, -2.0, 0.0, -122.0, -122.0, -223.0, -56.0, -130.0, -24.0, -22.0, -14.0, -136.0, -251.0, -84.0, -70.0, -58.0, -118.0, -116.0, -61.0, 0.0, 0.0, 4.0, 0.0, -140.0, -74.0, -218.0, 2.0, -177.0, -34.0, -114.0, 0.0, -280.0, -330.0, -24.0, 7.0, 0.0, 3.0, -27.0, 0.0, 0.0, 2.0, -14.0, 0.0, -16.0, -154.0, -161.0, -154.0, -130.0, -330.0, 15.0, 0.0, -196.0, -388.0, -68.0, 0.0], "policy_predator_policy_reward": [0.0, 36.0, 0.0, 0.0, 188.0, 11.0, 80.0, 0.0, 0.0, 15.0, 83.0, 7.0, 105.0, 0.0, 12.0, 21.0, 0.0, 6.0, 12.0, 0.0, 11.0, 0.0, 38.0, 14.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 156.0, 82.0, 5.0, 0.0, 129.0, 0.0, 112.0, 0.0, 0.0, 0.0, 62.0, 0.0, 150.0, 0.0, 100.0, 10.0, 62.0, 89.0, 0.0, 20.0, 4.0, 18.0, 0.0, 0.0, 7.0, 132.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 10.0, 12.0, 0.0, 189.0, 44.0, 0.0, 10.0, 5.0, 0.0, 87.0, 12.0, 0.0, 11.0, 14.0, 5.0, 0.0, 130.0, 0.0, 0.0, 165.0, 113.0, 11.0, 3.0, 0.0, 0.0, 89.0, 0.0, 184.0, 71.0, 37.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 32.0, 41.0, 6.0, 0.0, 5.0, 29.0, 0.0, 5.0, 18.0, 158.0, 0.0, 0.0, 0.0, 7.0, 0.0, 41.0, 0.0, 60.0, 83.0, 65.0, 0.0, 42.0, 0.0, 53.0, 0.0, 0.0, 44.0, 2.0, 0.0, 63.0, 0.0, 36.0, 0.0, 117.0, 36.0, 96.0, 0.0, 1.0, 0.0, 20.0, 1.0, 0.0, 61.0, 0.0, 0.0, 120.0, 80.0, 0.0, 25.0, 0.0, 135.0, 72.0, 12.0, 53.0, 5.0, 83.0, 37.0, 33.0, 0.0, 0.0, 0.0, 0.0, 34.0, 45.0, 109.0, 0.0, 114.0, 0.0, 57.0, 0.0, 107.0, 156.0, 12.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 7.0, 49.0, 77.0, 28.0, 84.0, 0.0, 165.0, 0.0, 0.0, 13.0, 194.0, 0.0, 34.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0446399204264483, "mean_inference_ms": 2.7923730309552086, "mean_action_processing_ms": 0.5514134815128053, "mean_env_wait_ms": 0.38562177041261714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00921940803527832, "StateBufferConnector_ms": 0.0037842988967895508, "ViewRequirementAgentConnector_ms": 0.2244861125946045}, "num_episodes": 18, "episode_return_max": 40.0, "episode_return_min": -431.0, "episode_return_mean": -79.51, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.9242821867385, "num_env_steps_trained_throughput_per_sec": 292.9242821867385, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 15651.304, "restore_workers_time_ms": 0.021, "training_step_time_ms": 15651.192, "sample_time_ms": 2181.453, "learn_time_ms": 13448.881, "learn_throughput": 297.423, "synch_weights_time_ms": 17.036}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "e1352_00000", "date": "2024-08-13_16-49-16", "timestamp": 1723582156, "time_this_iter_s": 13.704461097717285, "time_total_s": 677.4088356494904, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1629040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 677.4088356494904, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 71.07999999999998, "ram_util_percent": 83.76500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6854265030098972, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 4.511218739565088, "policy_loss": -8.27282930788382e-05, "vf_loss": 4.493203688172437, "vf_explained_var": 0.053895617162109055, "kl": 0.01787436219547185, "entropy": 0.5967892451103403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4661333935719636, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 5.516195380120051, "policy_loss": 0.004471617087317759, "vf_loss": 5.492244534265428, "vf_explained_var": -9.208759933552414e-09, "kl": 0.011400734376788523, "entropy": 0.35456718089719297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -431.0, "episode_reward_mean": -88.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 23.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -79.66, "predator_policy": 35.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, -137.0, -108.0, 0.0, -53.0, -141.0, -99.0, -155.0, -20.0, -15.0, 23.0, -311.0, 15.0, -1.0, 11.0, -10.0, 0.0, -16.0, -431.0, -56.0, 9.0, -236.0, -9.0, -25.0, -5.0, -201.0, -205.0, -100.0, 3.0, -87.0, -390.0, -73.0, 5.0, -17.0, 0.0, -165.0, 14.0, -34.0, -5.0, -190.0, 9.0, 12.0, -39.0, -44.0, -210.0, -42.0, -56.0, 3.0, -37.0, -63.0, -36.0, -330.0, -132.0, -1.0, -2.0, -1.0, -183.0, -159.0, -74.0, -11.0, -180.0, -89.0, -88.0, -107.0, 0.0, 4.0, -135.0, -107.0, -97.0, -57.0, -347.0, -5.0, 3.0, -12.0, 2.0, -7.0, -44.0, -203.0, -295.0, 15.0, -377.0, -34.0, -210.0, -22.0, -110.0, -49.0, -33.0, 0.0, -161.0, -184.0, -266.0, -48.0, -68.0, -173.0, -4.0, -78.0, -243.0, -412.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, -8.0, -258.0, -8.0, -81.0, -139.0, 0.0, 0.0, -115.0, 0.0, -104.0, -187.0, -189.0, -20.0, -178.0, -128.0, -34.0, -6.0, 0.0, -37.0, 0.0, 23.0, -186.0, -264.0, 15.0, 0.0, 4.0, -18.0, 1.0, 10.0, -21.0, 0.0, 0.0, 0.0, -14.0, -24.0, -378.0, -242.0, -58.0, -42.0, -20.0, 14.0, -163.0, -160.0, 0.0, -21.0, -22.0, -28.0, 0.0, -10.0, -116.0, -215.0, -330.0, -40.0, -243.0, 19.0, 4.0, -4.0, 0.0, -176.0, -368.0, -206.0, -131.0, -50.0, 0.0, 5.0, -39.0, 0.0, 0.0, 0.0, -140.0, -98.0, 8.0, 0.0, 0.0, -68.0, -10.0, 0.0, -216.0, -150.0, 9.0, 0.0, 0.0, 5.0, -80.0, 0.0, -101.0, -3.0, -144.0, -214.0, 0.0, -84.0, -80.0, -29.0, 0.0, 3.0, -92.0, 9.0, -14.0, -112.0, -72.0, 0.0, -216.0, -231.0, -264.0, 0.0, -2.0, 0.0, -22.0, 0.0, -2.0, 0.0, -122.0, -122.0, -223.0, -56.0, -130.0, -24.0, -22.0, -14.0, -136.0, -251.0, -84.0, -70.0, -58.0, -118.0, -116.0, -61.0, 0.0, 0.0, 4.0, 0.0, -140.0, -74.0, -218.0, 2.0, -177.0, -34.0, -114.0, 0.0, -280.0, -330.0, -24.0, 7.0, 0.0, 3.0, -27.0, 0.0, 0.0, 2.0, -14.0, 0.0, -16.0, -154.0, -161.0, -154.0, -130.0, -330.0, 15.0, 0.0, -196.0, -388.0, -68.0, 0.0, -148.0, -136.0, -24.0, -14.0, -232.0, 0.0, 0.0, -400.0, -12.0, -70.0, 0.0, 0.0, -161.0, -104.0, -158.0, -196.0, -252.0, -256.0, -96.0, 0.0, -143.0, -10.0, -32.0, -314.0, -19.0, 0.0, -30.0, -96.0, -214.0, -136.0, -352.0, -324.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [5.0, 0.0, 129.0, 0.0, 112.0, 0.0, 0.0, 0.0, 62.0, 0.0, 150.0, 0.0, 100.0, 10.0, 62.0, 89.0, 0.0, 20.0, 4.0, 18.0, 0.0, 0.0, 7.0, 132.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 10.0, 12.0, 0.0, 189.0, 44.0, 0.0, 10.0, 5.0, 0.0, 87.0, 12.0, 0.0, 11.0, 14.0, 5.0, 0.0, 130.0, 0.0, 0.0, 165.0, 113.0, 11.0, 3.0, 0.0, 0.0, 89.0, 0.0, 184.0, 71.0, 37.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 32.0, 41.0, 6.0, 0.0, 5.0, 29.0, 0.0, 5.0, 18.0, 158.0, 0.0, 0.0, 0.0, 7.0, 0.0, 41.0, 0.0, 60.0, 83.0, 65.0, 0.0, 42.0, 0.0, 53.0, 0.0, 0.0, 44.0, 2.0, 0.0, 63.0, 0.0, 36.0, 0.0, 117.0, 36.0, 96.0, 0.0, 1.0, 0.0, 20.0, 1.0, 0.0, 61.0, 0.0, 0.0, 120.0, 80.0, 0.0, 25.0, 0.0, 135.0, 72.0, 12.0, 53.0, 5.0, 83.0, 37.0, 33.0, 0.0, 0.0, 0.0, 0.0, 34.0, 45.0, 109.0, 0.0, 114.0, 0.0, 57.0, 0.0, 107.0, 156.0, 12.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 7.0, 49.0, 77.0, 28.0, 84.0, 0.0, 165.0, 0.0, 0.0, 13.0, 194.0, 0.0, 34.0, 74.0, 0.0, 4.0, 12.0, 122.0, 0.0, 151.0, 200.0, 49.0, 0.0, 0.0, 0.0, 52.0, 52.0, 170.0, 0.0, 128.0, 114.0, 11.0, 37.0, 85.0, 0.0, 16.0, 157.0, 5.0, 10.0, 0.0, 48.0, 91.0, 16.0, 178.0, 86.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0436872457070139, "mean_inference_ms": 2.7925596899401337, "mean_action_processing_ms": 0.5484976650853538, "mean_env_wait_ms": 0.3855311228238007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00937032699584961, "StateBufferConnector_ms": 0.0038003921508789062, "ViewRequirementAgentConnector_ms": 0.19157326221466064}, "num_episodes": 18, "episode_return_max": 23.0, "episode_return_min": -431.0, "episode_return_mean": -88.39, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.9437650978806, "num_env_steps_trained_throughput_per_sec": 305.9437650978806, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 15437.899, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15437.791, "sample_time_ms": 2129.678, "learn_time_ms": 13286.689, "learn_throughput": 301.053, "synch_weights_time_ms": 17.19}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "e1352_00000", "date": "2024-08-13_16-49-30", "timestamp": 1723582170, "time_this_iter_s": 13.137786865234375, "time_total_s": 690.5466225147247, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ba430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 690.5466225147247, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 67.78333333333333, "ram_util_percent": 83.75555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3038371640538413, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 4.534496471869252, "policy_loss": -0.0006468410093692087, "vf_loss": 4.519880368974474, "vf_explained_var": 0.17714559893128734, "kl": 0.01507451208492732, "entropy": 0.6701704947090653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.053283400478817, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 5.124106459895139, "policy_loss": 0.005741569672578148, "vf_loss": 5.096180512791588, "vf_explained_var": -5.172043250351356e-09, "kl": 0.012984001295503814, "entropy": 0.4491335899978088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": -412.0, "episode_reward_mean": -103.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -91.91, "predator_policy": 40.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, -25.0, -5.0, -201.0, -205.0, -100.0, 3.0, -87.0, -390.0, -73.0, 5.0, -17.0, 0.0, -165.0, 14.0, -34.0, -5.0, -190.0, 9.0, 12.0, -39.0, -44.0, -210.0, -42.0, -56.0, 3.0, -37.0, -63.0, -36.0, -330.0, -132.0, -1.0, -2.0, -1.0, -183.0, -159.0, -74.0, -11.0, -180.0, -89.0, -88.0, -107.0, 0.0, 4.0, -135.0, -107.0, -97.0, -57.0, -347.0, -5.0, 3.0, -12.0, 2.0, -7.0, -44.0, -203.0, -295.0, 15.0, -377.0, -34.0, -210.0, -22.0, -110.0, -49.0, -33.0, 0.0, -161.0, -184.0, -266.0, -48.0, -68.0, -173.0, -4.0, -78.0, -243.0, -412.0, 0.0, 0.0, -242.0, -150.0, 15.0, 7.0, -86.0, -71.0, -127.0, -363.0, -11.0, -195.0, -187.0, 15.0, -157.0, -50.0, -68.0, -232.0, -169.0, -287.0, -254.0, 0.0, -228.0, -383.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -21.0, -22.0, -28.0, 0.0, -10.0, -116.0, -215.0, -330.0, -40.0, -243.0, 19.0, 4.0, -4.0, 0.0, -176.0, -368.0, -206.0, -131.0, -50.0, 0.0, 5.0, -39.0, 0.0, 0.0, 0.0, -140.0, -98.0, 8.0, 0.0, 0.0, -68.0, -10.0, 0.0, -216.0, -150.0, 9.0, 0.0, 0.0, 5.0, -80.0, 0.0, -101.0, -3.0, -144.0, -214.0, 0.0, -84.0, -80.0, -29.0, 0.0, 3.0, -92.0, 9.0, -14.0, -112.0, -72.0, 0.0, -216.0, -231.0, -264.0, 0.0, -2.0, 0.0, -22.0, 0.0, -2.0, 0.0, -122.0, -122.0, -223.0, -56.0, -130.0, -24.0, -22.0, -14.0, -136.0, -251.0, -84.0, -70.0, -58.0, -118.0, -116.0, -61.0, 0.0, 0.0, 4.0, 0.0, -140.0, -74.0, -218.0, 2.0, -177.0, -34.0, -114.0, 0.0, -280.0, -330.0, -24.0, 7.0, 0.0, 3.0, -27.0, 0.0, 0.0, 2.0, -14.0, 0.0, -16.0, -154.0, -161.0, -154.0, -130.0, -330.0, 15.0, 0.0, -196.0, -388.0, -68.0, 0.0, -148.0, -136.0, -24.0, -14.0, -232.0, 0.0, 0.0, -400.0, -12.0, -70.0, 0.0, 0.0, -161.0, -104.0, -158.0, -196.0, -252.0, -256.0, -96.0, 0.0, -143.0, -10.0, -32.0, -314.0, -19.0, 0.0, -30.0, -96.0, -214.0, -136.0, -352.0, -324.0, 0.0, 0.0, 0.0, 0.0, -242.0, -138.0, -144.0, -79.0, 2.0, 11.0, -6.0, 10.0, -266.0, 0.0, -142.0, 0.0, -195.0, -81.0, -232.0, -322.0, -8.0, -14.0, -104.0, -182.0, -111.0, -168.0, 15.0, 0.0, -152.0, -167.0, -106.0, 0.0, 11.0, -194.0, -250.0, -168.0, -288.0, -50.0, -195.0, -258.0, -186.0, -206.0, 0.0, 0.0, -178.0, -148.0, -310.0, -228.0], "policy_predator_policy_reward": [12.0, 0.0, 11.0, 14.0, 5.0, 0.0, 130.0, 0.0, 0.0, 165.0, 113.0, 11.0, 3.0, 0.0, 0.0, 89.0, 0.0, 184.0, 71.0, 37.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 32.0, 41.0, 6.0, 0.0, 5.0, 29.0, 0.0, 5.0, 18.0, 158.0, 0.0, 0.0, 0.0, 7.0, 0.0, 41.0, 0.0, 60.0, 83.0, 65.0, 0.0, 42.0, 0.0, 53.0, 0.0, 0.0, 44.0, 2.0, 0.0, 63.0, 0.0, 36.0, 0.0, 117.0, 36.0, 96.0, 0.0, 1.0, 0.0, 20.0, 1.0, 0.0, 61.0, 0.0, 0.0, 120.0, 80.0, 0.0, 25.0, 0.0, 135.0, 72.0, 12.0, 53.0, 5.0, 83.0, 37.0, 33.0, 0.0, 0.0, 0.0, 0.0, 34.0, 45.0, 109.0, 0.0, 114.0, 0.0, 57.0, 0.0, 107.0, 156.0, 12.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 7.0, 49.0, 77.0, 28.0, 84.0, 0.0, 165.0, 0.0, 0.0, 13.0, 194.0, 0.0, 34.0, 74.0, 0.0, 4.0, 12.0, 122.0, 0.0, 151.0, 200.0, 49.0, 0.0, 0.0, 0.0, 52.0, 52.0, 170.0, 0.0, 128.0, 114.0, 11.0, 37.0, 85.0, 0.0, 16.0, 157.0, 5.0, 10.0, 0.0, 48.0, 91.0, 16.0, 178.0, 86.0, 0.0, 0.0, 0.0, 0.0, 69.0, 69.0, 72.0, 1.0, 2.0, 0.0, 3.0, 0.0, 87.0, 93.0, 71.0, 0.0, 1.0, 148.0, 161.0, 30.0, 7.0, 4.0, 0.0, 91.0, 58.0, 34.0, 0.0, 0.0, 162.0, 0.0, 31.0, 25.0, 18.0, 97.0, 61.0, 125.0, 102.0, 67.0, 102.0, 64.0, 93.0, 45.0, 0.0, 0.0, 17.0, 81.0, 155.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.042117659280415, "mean_inference_ms": 2.7908026422567094, "mean_action_processing_ms": 0.5447330524573817, "mean_env_wait_ms": 0.38517886669752366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02384316921234131, "StateBufferConnector_ms": 0.00363314151763916, "ViewRequirementAgentConnector_ms": 0.17272984981536865}, "num_episodes": 22, "episode_return_max": 15.0, "episode_return_min": -412.0, "episode_return_mean": -103.24, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.8390318207956, "num_env_steps_trained_throughput_per_sec": 314.8390318207956, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 15147.625, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15147.517, "sample_time_ms": 1998.022, "learn_time_ms": 13130.35, "learn_throughput": 304.638, "synch_weights_time_ms": 15.917}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "e1352_00000", "date": "2024-08-13_16-49-42", "timestamp": 1723582182, "time_this_iter_s": 12.755769968032837, "time_total_s": 703.3023924827576, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ba4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 703.3023924827576, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 67.07222222222222, "ram_util_percent": 83.82777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4787753806543098, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 4.03288563559295, "policy_loss": 0.0004469186819045159, "vf_loss": 4.013595140674127, "vf_explained_var": 0.10728279270192302, "kl": 0.01861093887055836, "entropy": 0.7545567923595035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.147044235775395, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 5.115906204117669, "policy_loss": 0.004208530214610239, "vf_loss": 5.0942152686850735, "vf_explained_var": -1.6714530016379382e-09, "kl": 0.010232040496738317, "entropy": 0.42468843034335546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": -503.0, "episode_reward_mean": -118.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -106.495, "predator_policy": 47.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.0, -56.0, 3.0, -37.0, -63.0, -36.0, -330.0, -132.0, -1.0, -2.0, -1.0, -183.0, -159.0, -74.0, -11.0, -180.0, -89.0, -88.0, -107.0, 0.0, 4.0, -135.0, -107.0, -97.0, -57.0, -347.0, -5.0, 3.0, -12.0, 2.0, -7.0, -44.0, -203.0, -295.0, 15.0, -377.0, -34.0, -210.0, -22.0, -110.0, -49.0, -33.0, 0.0, -161.0, -184.0, -266.0, -48.0, -68.0, -173.0, -4.0, -78.0, -243.0, -412.0, 0.0, 0.0, -242.0, -150.0, 15.0, 7.0, -86.0, -71.0, -127.0, -363.0, -11.0, -195.0, -187.0, 15.0, -157.0, -50.0, -68.0, -232.0, -169.0, -287.0, -254.0, 0.0, -228.0, -383.0, -201.0, -503.0, -79.0, -53.0, -98.0, -20.0, -18.0, -60.0, -43.0, -72.0, -393.0, -285.0, -202.0, -21.0, -94.0, -144.0, -107.0, -72.0, -111.0, -422.0, 13.0, -182.0, -106.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -84.0, -80.0, -29.0, 0.0, 3.0, -92.0, 9.0, -14.0, -112.0, -72.0, 0.0, -216.0, -231.0, -264.0, 0.0, -2.0, 0.0, -22.0, 0.0, -2.0, 0.0, -122.0, -122.0, -223.0, -56.0, -130.0, -24.0, -22.0, -14.0, -136.0, -251.0, -84.0, -70.0, -58.0, -118.0, -116.0, -61.0, 0.0, 0.0, 4.0, 0.0, -140.0, -74.0, -218.0, 2.0, -177.0, -34.0, -114.0, 0.0, -280.0, -330.0, -24.0, 7.0, 0.0, 3.0, -27.0, 0.0, 0.0, 2.0, -14.0, 0.0, -16.0, -154.0, -161.0, -154.0, -130.0, -330.0, 15.0, 0.0, -196.0, -388.0, -68.0, 0.0, -148.0, -136.0, -24.0, -14.0, -232.0, 0.0, 0.0, -400.0, -12.0, -70.0, 0.0, 0.0, -161.0, -104.0, -158.0, -196.0, -252.0, -256.0, -96.0, 0.0, -143.0, -10.0, -32.0, -314.0, -19.0, 0.0, -30.0, -96.0, -214.0, -136.0, -352.0, -324.0, 0.0, 0.0, 0.0, 0.0, -242.0, -138.0, -144.0, -79.0, 2.0, 11.0, -6.0, 10.0, -266.0, 0.0, -142.0, 0.0, -195.0, -81.0, -232.0, -322.0, -8.0, -14.0, -104.0, -182.0, -111.0, -168.0, 15.0, 0.0, -152.0, -167.0, -106.0, 0.0, 11.0, -194.0, -250.0, -168.0, -288.0, -50.0, -195.0, -258.0, -186.0, -206.0, 0.0, 0.0, -178.0, -148.0, -310.0, -228.0, -132.0, -164.0, -400.0, -303.0, -198.0, 13.0, -106.0, 0.0, -84.0, -80.0, 0.0, -40.0, -46.0, 5.0, -2.0, -118.0, -101.0, 0.0, 0.0, -150.0, -264.0, -355.0, -175.0, -266.0, -307.0, -51.0, -42.0, 0.0, -80.0, -315.0, -118.0, -136.0, -194.0, -136.0, -332.0, 10.0, -74.0, -74.0, -281.0, -336.0, 13.0, 0.0, -132.0, -310.0, -158.0, -71.0], "policy_predator_policy_reward": [0.0, 42.0, 0.0, 53.0, 0.0, 0.0, 44.0, 2.0, 0.0, 63.0, 0.0, 36.0, 0.0, 117.0, 36.0, 96.0, 0.0, 1.0, 0.0, 20.0, 1.0, 0.0, 61.0, 0.0, 0.0, 120.0, 80.0, 0.0, 25.0, 0.0, 135.0, 72.0, 12.0, 53.0, 5.0, 83.0, 37.0, 33.0, 0.0, 0.0, 0.0, 0.0, 34.0, 45.0, 109.0, 0.0, 114.0, 0.0, 57.0, 0.0, 107.0, 156.0, 12.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 7.0, 49.0, 77.0, 28.0, 84.0, 0.0, 165.0, 0.0, 0.0, 13.0, 194.0, 0.0, 34.0, 74.0, 0.0, 4.0, 12.0, 122.0, 0.0, 151.0, 200.0, 49.0, 0.0, 0.0, 0.0, 52.0, 52.0, 170.0, 0.0, 128.0, 114.0, 11.0, 37.0, 85.0, 0.0, 16.0, 157.0, 5.0, 10.0, 0.0, 48.0, 91.0, 16.0, 178.0, 86.0, 0.0, 0.0, 0.0, 0.0, 69.0, 69.0, 72.0, 1.0, 2.0, 0.0, 3.0, 0.0, 87.0, 93.0, 71.0, 0.0, 1.0, 148.0, 161.0, 30.0, 7.0, 4.0, 0.0, 91.0, 58.0, 34.0, 0.0, 0.0, 162.0, 0.0, 31.0, 25.0, 18.0, 97.0, 61.0, 125.0, 102.0, 67.0, 102.0, 64.0, 93.0, 45.0, 0.0, 0.0, 17.0, 81.0, 155.0, 0.0, 20.0, 75.0, 200.0, 0.0, 6.0, 100.0, 51.0, 2.0, 0.0, 66.0, 20.0, 0.0, 0.0, 23.0, 59.0, 1.0, 58.0, 0.0, 0.0, 78.0, 185.0, 41.0, 30.0, 126.0, 156.0, 0.0, 0.0, 21.0, 165.0, 136.0, 42.0, 68.0, 71.0, 152.0, 142.0, 108.0, 37.0, 0.0, 84.0, 111.0, 0.0, 0.0, 98.0, 162.0, 9.0, 114.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0394609435257036, "mean_inference_ms": 2.7868652448860805, "mean_action_processing_ms": 0.5406522564637118, "mean_env_wait_ms": 0.38474466624195963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024039626121520996, "StateBufferConnector_ms": 0.0034797191619873047, "ViewRequirementAgentConnector_ms": 0.16060328483581543}, "num_episodes": 23, "episode_return_max": 15.0, "episode_return_min": -503.0, "episode_return_mean": -118.41, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.80709518058814, "num_env_steps_trained_throughput_per_sec": 314.80709518058814, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 14883.234, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14883.127, "sample_time_ms": 1892.855, "learn_time_ms": 12971.053, "learn_throughput": 308.379, "synch_weights_time_ms": 15.685}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "e1352_00000", "date": "2024-08-13_16-49-55", "timestamp": 1723582195, "time_this_iter_s": 12.79470682144165, "time_total_s": 716.0970993041992, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b164cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 716.0970993041992, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 67.2578947368421, "ram_util_percent": 83.72631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5826716442193305, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 2.968484599628146, "policy_loss": 0.000883053987232781, "vf_loss": 2.951232889468077, "vf_explained_var": 0.13543821330423708, "kl": 0.016166572246211684, "entropy": 0.894897972307508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.144442224116237, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 3.8643074456976834, "policy_loss": 0.0040172532629517334, "vf_loss": 3.8438183788269287, "vf_explained_var": -7.032717346514344e-09, "kl": 0.009640561731649787, "entropy": 0.3773411701911341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -526.0, "episode_reward_mean": -122.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -110.74, "predator_policy": 49.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.0, 0.0, 4.0, -135.0, -107.0, -97.0, -57.0, -347.0, -5.0, 3.0, -12.0, 2.0, -7.0, -44.0, -203.0, -295.0, 15.0, -377.0, -34.0, -210.0, -22.0, -110.0, -49.0, -33.0, 0.0, -161.0, -184.0, -266.0, -48.0, -68.0, -173.0, -4.0, -78.0, -243.0, -412.0, 0.0, 0.0, -242.0, -150.0, 15.0, 7.0, -86.0, -71.0, -127.0, -363.0, -11.0, -195.0, -187.0, 15.0, -157.0, -50.0, -68.0, -232.0, -169.0, -287.0, -254.0, 0.0, -228.0, -383.0, -201.0, -503.0, -79.0, -53.0, -98.0, -20.0, -18.0, -60.0, -43.0, -72.0, -393.0, -285.0, -202.0, -21.0, -94.0, -144.0, -107.0, -72.0, -111.0, -422.0, 13.0, -182.0, -106.0, -87.0, -16.0, -46.0, 17.0, -86.0, -48.0, -177.0, -228.0, 17.0, 8.0, -54.0, -39.0, -62.0, -101.0, -70.0, -10.0, -395.0, -526.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-116.0, -61.0, 0.0, 0.0, 4.0, 0.0, -140.0, -74.0, -218.0, 2.0, -177.0, -34.0, -114.0, 0.0, -280.0, -330.0, -24.0, 7.0, 0.0, 3.0, -27.0, 0.0, 0.0, 2.0, -14.0, 0.0, -16.0, -154.0, -161.0, -154.0, -130.0, -330.0, 15.0, 0.0, -196.0, -388.0, -68.0, 0.0, -148.0, -136.0, -24.0, -14.0, -232.0, 0.0, 0.0, -400.0, -12.0, -70.0, 0.0, 0.0, -161.0, -104.0, -158.0, -196.0, -252.0, -256.0, -96.0, 0.0, -143.0, -10.0, -32.0, -314.0, -19.0, 0.0, -30.0, -96.0, -214.0, -136.0, -352.0, -324.0, 0.0, 0.0, 0.0, 0.0, -242.0, -138.0, -144.0, -79.0, 2.0, 11.0, -6.0, 10.0, -266.0, 0.0, -142.0, 0.0, -195.0, -81.0, -232.0, -322.0, -8.0, -14.0, -104.0, -182.0, -111.0, -168.0, 15.0, 0.0, -152.0, -167.0, -106.0, 0.0, 11.0, -194.0, -250.0, -168.0, -288.0, -50.0, -195.0, -258.0, -186.0, -206.0, 0.0, 0.0, -178.0, -148.0, -310.0, -228.0, -132.0, -164.0, -400.0, -303.0, -198.0, 13.0, -106.0, 0.0, -84.0, -80.0, 0.0, -40.0, -46.0, 5.0, -2.0, -118.0, -101.0, 0.0, 0.0, -150.0, -264.0, -355.0, -175.0, -266.0, -307.0, -51.0, -42.0, 0.0, -80.0, -315.0, -118.0, -136.0, -194.0, -136.0, -332.0, 10.0, -74.0, -74.0, -281.0, -336.0, 13.0, 0.0, -132.0, -310.0, -158.0, -71.0, 0.0, -174.0, 0.0, -32.0, -3.0, -94.0, 0.0, 17.0, -240.0, 17.0, 0.0, -104.0, -133.0, -236.0, -238.0, -120.0, 17.0, 0.0, -12.0, 9.0, 0.0, -109.0, -89.0, 0.0, -154.0, -37.0, -144.0, -146.0, 0.0, -140.0, -33.0, 0.0, -206.0, -378.0, -327.0, -398.0], "policy_predator_policy_reward": [37.0, 33.0, 0.0, 0.0, 0.0, 0.0, 34.0, 45.0, 109.0, 0.0, 114.0, 0.0, 57.0, 0.0, 107.0, 156.0, 12.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 7.0, 49.0, 77.0, 28.0, 84.0, 0.0, 165.0, 0.0, 0.0, 13.0, 194.0, 0.0, 34.0, 74.0, 0.0, 4.0, 12.0, 122.0, 0.0, 151.0, 200.0, 49.0, 0.0, 0.0, 0.0, 52.0, 52.0, 170.0, 0.0, 128.0, 114.0, 11.0, 37.0, 85.0, 0.0, 16.0, 157.0, 5.0, 10.0, 0.0, 48.0, 91.0, 16.0, 178.0, 86.0, 0.0, 0.0, 0.0, 0.0, 69.0, 69.0, 72.0, 1.0, 2.0, 0.0, 3.0, 0.0, 87.0, 93.0, 71.0, 0.0, 1.0, 148.0, 161.0, 30.0, 7.0, 4.0, 0.0, 91.0, 58.0, 34.0, 0.0, 0.0, 162.0, 0.0, 31.0, 25.0, 18.0, 97.0, 61.0, 125.0, 102.0, 67.0, 102.0, 64.0, 93.0, 45.0, 0.0, 0.0, 17.0, 81.0, 155.0, 0.0, 20.0, 75.0, 200.0, 0.0, 6.0, 100.0, 51.0, 2.0, 0.0, 66.0, 20.0, 0.0, 0.0, 23.0, 59.0, 1.0, 58.0, 0.0, 0.0, 78.0, 185.0, 41.0, 30.0, 126.0, 156.0, 0.0, 0.0, 21.0, 165.0, 136.0, 42.0, 68.0, 71.0, 152.0, 142.0, 108.0, 37.0, 0.0, 84.0, 111.0, 0.0, 0.0, 98.0, 162.0, 9.0, 114.0, 37.0, 50.0, 16.0, 0.0, 39.0, 12.0, 0.0, 0.0, 39.0, 98.0, 0.0, 56.0, 43.0, 149.0, 39.0, 91.0, 0.0, 0.0, 7.0, 4.0, 27.0, 28.0, 50.0, 0.0, 70.0, 59.0, 94.0, 95.0, 70.0, 0.0, 0.0, 23.0, 0.0, 189.0, 199.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0342750622149928, "mean_inference_ms": 2.7708869384176866, "mean_action_processing_ms": 0.5359309718176374, "mean_env_wait_ms": 0.3825429385589804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024117588996887207, "StateBufferConnector_ms": 0.0033162832260131836, "ViewRequirementAgentConnector_ms": 0.12629282474517822}, "num_episodes": 18, "episode_return_max": 17.0, "episode_return_min": -526.0, "episode_return_mean": -122.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.25512439883715, "num_env_steps_trained_throughput_per_sec": 315.25512439883715, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 14661.311, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14661.208, "sample_time_ms": 1862.071, "learn_time_ms": 12780.697, "learn_throughput": 312.972, "synch_weights_time_ms": 14.933}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "e1352_00000", "date": "2024-08-13_16-50-08", "timestamp": 1723582208, "time_this_iter_s": 12.739454984664917, "time_total_s": 728.8365542888641, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b164c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 728.8365542888641, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 66.01666666666665, "ram_util_percent": 83.52777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9007369314236615, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 3.2974529903401772, "policy_loss": 0.0023614497904582, "vf_loss": 3.2771635274407727, "vf_explained_var": 0.2330851002029641, "kl": 0.017706675788565582, "entropy": 0.7223819876631732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8596814356310656, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 3.98820885955972, "policy_loss": 0.004478639470925801, "vf_loss": 3.9673981511403644, "vf_explained_var": -6.023538175714079e-09, "kl": 0.009558777870790876, "entropy": 0.36290800551731117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -526.0, "episode_reward_mean": -131.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -117.13, "predator_policy": 51.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, -210.0, -22.0, -110.0, -49.0, -33.0, 0.0, -161.0, -184.0, -266.0, -48.0, -68.0, -173.0, -4.0, -78.0, -243.0, -412.0, 0.0, 0.0, -242.0, -150.0, 15.0, 7.0, -86.0, -71.0, -127.0, -363.0, -11.0, -195.0, -187.0, 15.0, -157.0, -50.0, -68.0, -232.0, -169.0, -287.0, -254.0, 0.0, -228.0, -383.0, -201.0, -503.0, -79.0, -53.0, -98.0, -20.0, -18.0, -60.0, -43.0, -72.0, -393.0, -285.0, -202.0, -21.0, -94.0, -144.0, -107.0, -72.0, -111.0, -422.0, 13.0, -182.0, -106.0, -87.0, -16.0, -46.0, 17.0, -86.0, -48.0, -177.0, -228.0, 17.0, 8.0, -54.0, -39.0, -62.0, -101.0, -70.0, -10.0, -395.0, -526.0, -508.0, -24.0, -87.0, -99.0, -15.0, -27.0, -291.0, -10.0, -209.0, -1.0, -501.0, -232.0, -77.0, -498.0, -28.0, -69.0, 6.0, -8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-68.0, 0.0, -148.0, -136.0, -24.0, -14.0, -232.0, 0.0, 0.0, -400.0, -12.0, -70.0, 0.0, 0.0, -161.0, -104.0, -158.0, -196.0, -252.0, -256.0, -96.0, 0.0, -143.0, -10.0, -32.0, -314.0, -19.0, 0.0, -30.0, -96.0, -214.0, -136.0, -352.0, -324.0, 0.0, 0.0, 0.0, 0.0, -242.0, -138.0, -144.0, -79.0, 2.0, 11.0, -6.0, 10.0, -266.0, 0.0, -142.0, 0.0, -195.0, -81.0, -232.0, -322.0, -8.0, -14.0, -104.0, -182.0, -111.0, -168.0, 15.0, 0.0, -152.0, -167.0, -106.0, 0.0, 11.0, -194.0, -250.0, -168.0, -288.0, -50.0, -195.0, -258.0, -186.0, -206.0, 0.0, 0.0, -178.0, -148.0, -310.0, -228.0, -132.0, -164.0, -400.0, -303.0, -198.0, 13.0, -106.0, 0.0, -84.0, -80.0, 0.0, -40.0, -46.0, 5.0, -2.0, -118.0, -101.0, 0.0, 0.0, -150.0, -264.0, -355.0, -175.0, -266.0, -307.0, -51.0, -42.0, 0.0, -80.0, -315.0, -118.0, -136.0, -194.0, -136.0, -332.0, 10.0, -74.0, -74.0, -281.0, -336.0, 13.0, 0.0, -132.0, -310.0, -158.0, -71.0, 0.0, -174.0, 0.0, -32.0, -3.0, -94.0, 0.0, 17.0, -240.0, 17.0, 0.0, -104.0, -133.0, -236.0, -238.0, -120.0, 17.0, 0.0, -12.0, 9.0, 0.0, -109.0, -89.0, 0.0, -154.0, -37.0, -144.0, -146.0, 0.0, -140.0, -33.0, 0.0, -206.0, -378.0, -327.0, -398.0, -398.0, -386.0, -62.0, 0.0, -30.0, -134.0, -116.0, -91.0, 0.0, -30.0, 0.0, -54.0, -202.0, -190.0, -35.0, 0.0, -166.0, -264.0, -2.0, 0.0, -333.0, -344.0, -244.0, -247.0, -41.0, -92.0, -394.0, -302.0, 0.0, -56.0, -138.0, 0.0, -22.0, 14.0, -30.0, 6.0], "policy_predator_policy_reward": [0.0, 34.0, 74.0, 0.0, 4.0, 12.0, 122.0, 0.0, 151.0, 200.0, 49.0, 0.0, 0.0, 0.0, 52.0, 52.0, 170.0, 0.0, 128.0, 114.0, 11.0, 37.0, 85.0, 0.0, 16.0, 157.0, 5.0, 10.0, 0.0, 48.0, 91.0, 16.0, 178.0, 86.0, 0.0, 0.0, 0.0, 0.0, 69.0, 69.0, 72.0, 1.0, 2.0, 0.0, 3.0, 0.0, 87.0, 93.0, 71.0, 0.0, 1.0, 148.0, 161.0, 30.0, 7.0, 4.0, 0.0, 91.0, 58.0, 34.0, 0.0, 0.0, 162.0, 0.0, 31.0, 25.0, 18.0, 97.0, 61.0, 125.0, 102.0, 67.0, 102.0, 64.0, 93.0, 45.0, 0.0, 0.0, 17.0, 81.0, 155.0, 0.0, 20.0, 75.0, 200.0, 0.0, 6.0, 100.0, 51.0, 2.0, 0.0, 66.0, 20.0, 0.0, 0.0, 23.0, 59.0, 1.0, 58.0, 0.0, 0.0, 78.0, 185.0, 41.0, 30.0, 126.0, 156.0, 0.0, 0.0, 21.0, 165.0, 136.0, 42.0, 68.0, 71.0, 152.0, 142.0, 108.0, 37.0, 0.0, 84.0, 111.0, 0.0, 0.0, 98.0, 162.0, 9.0, 114.0, 37.0, 50.0, 16.0, 0.0, 39.0, 12.0, 0.0, 0.0, 39.0, 98.0, 0.0, 56.0, 43.0, 149.0, 39.0, 91.0, 0.0, 0.0, 7.0, 4.0, 27.0, 28.0, 50.0, 0.0, 70.0, 59.0, 94.0, 95.0, 70.0, 0.0, 0.0, 23.0, 0.0, 189.0, 199.0, 0.0, 77.0, 199.0, 38.0, 0.0, 58.0, 19.0, 0.0, 108.0, 0.0, 15.0, 0.0, 27.0, 101.0, 0.0, 0.0, 25.0, 90.0, 131.0, 0.0, 1.0, 176.0, 0.0, 127.0, 132.0, 56.0, 0.0, 198.0, 0.0, 0.0, 28.0, 69.0, 0.0, 3.0, 11.0, 16.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0293073882366788, "mean_inference_ms": 2.754572922021035, "mean_action_processing_ms": 0.5313352465680603, "mean_env_wait_ms": 0.3803936945314463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027151107788085938, "StateBufferConnector_ms": 0.004026532173156738, "ViewRequirementAgentConnector_ms": 0.12526631355285645}, "num_episodes": 18, "episode_return_max": 17.0, "episode_return_min": -526.0, "episode_return_mean": -131.72, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.0971804858461, "num_env_steps_trained_throughput_per_sec": 288.0971804858461, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 14548.076, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14547.971, "sample_time_ms": 1901.026, "learn_time_ms": 12627.98, "learn_throughput": 316.757, "synch_weights_time_ms": 15.169}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "e1352_00000", "date": "2024-08-13_16-50-22", "timestamp": 1723582222, "time_this_iter_s": 13.948360919952393, "time_total_s": 742.7849152088165, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ba4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 742.7849152088165, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 78.89999999999999, "ram_util_percent": 83.73157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.382238826061052, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 3.1192897495138583, "policy_loss": -0.0004126910026623774, "vf_loss": 3.1040893325729977, "vf_explained_var": 0.24760989802224295, "kl": 0.015420347177139594, "entropy": 0.7584851976740297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.721465633234019, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 3.790078772565044, "policy_loss": 0.0034160541690807177, "vf_loss": 3.773062365269535, "vf_explained_var": -8.199580762752149e-09, "kl": 0.007959973467078517, "entropy": 0.3076443979625033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -526.0, "episode_reward_mean": -126.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -111.595, "predator_policy": 48.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, -86.0, -71.0, -127.0, -363.0, -11.0, -195.0, -187.0, 15.0, -157.0, -50.0, -68.0, -232.0, -169.0, -287.0, -254.0, 0.0, -228.0, -383.0, -201.0, -503.0, -79.0, -53.0, -98.0, -20.0, -18.0, -60.0, -43.0, -72.0, -393.0, -285.0, -202.0, -21.0, -94.0, -144.0, -107.0, -72.0, -111.0, -422.0, 13.0, -182.0, -106.0, -87.0, -16.0, -46.0, 17.0, -86.0, -48.0, -177.0, -228.0, 17.0, 8.0, -54.0, -39.0, -62.0, -101.0, -70.0, -10.0, -395.0, -526.0, -508.0, -24.0, -87.0, -99.0, -15.0, -27.0, -291.0, -10.0, -209.0, -1.0, -501.0, -232.0, -77.0, -498.0, -28.0, -69.0, 6.0, -8.0, -29.0, -84.0, 0.0, -27.0, -31.0, -15.0, 0.0, -39.0, -80.0, -40.0, -259.0, -160.0, -53.0, -387.0, -125.0, 0.0, -17.0, -140.0, -29.0, -30.0, -406.0, -21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 10.0, -266.0, 0.0, -142.0, 0.0, -195.0, -81.0, -232.0, -322.0, -8.0, -14.0, -104.0, -182.0, -111.0, -168.0, 15.0, 0.0, -152.0, -167.0, -106.0, 0.0, 11.0, -194.0, -250.0, -168.0, -288.0, -50.0, -195.0, -258.0, -186.0, -206.0, 0.0, 0.0, -178.0, -148.0, -310.0, -228.0, -132.0, -164.0, -400.0, -303.0, -198.0, 13.0, -106.0, 0.0, -84.0, -80.0, 0.0, -40.0, -46.0, 5.0, -2.0, -118.0, -101.0, 0.0, 0.0, -150.0, -264.0, -355.0, -175.0, -266.0, -307.0, -51.0, -42.0, 0.0, -80.0, -315.0, -118.0, -136.0, -194.0, -136.0, -332.0, 10.0, -74.0, -74.0, -281.0, -336.0, 13.0, 0.0, -132.0, -310.0, -158.0, -71.0, 0.0, -174.0, 0.0, -32.0, -3.0, -94.0, 0.0, 17.0, -240.0, 17.0, 0.0, -104.0, -133.0, -236.0, -238.0, -120.0, 17.0, 0.0, -12.0, 9.0, 0.0, -109.0, -89.0, 0.0, -154.0, -37.0, -144.0, -146.0, 0.0, -140.0, -33.0, 0.0, -206.0, -378.0, -327.0, -398.0, -398.0, -386.0, -62.0, 0.0, -30.0, -134.0, -116.0, -91.0, 0.0, -30.0, 0.0, -54.0, -202.0, -190.0, -35.0, 0.0, -166.0, -264.0, -2.0, 0.0, -333.0, -344.0, -244.0, -247.0, -41.0, -92.0, -394.0, -302.0, 0.0, -56.0, -138.0, 0.0, -22.0, 14.0, -30.0, 6.0, -64.0, 0.0, -36.0, -132.0, 0.0, 0.0, 0.0, -54.0, -62.0, 0.0, 0.0, -30.0, 0.0, 0.0, 3.0, -89.0, 0.0, -160.0, -76.0, -2.0, -182.0, -179.0, -102.0, -161.0, -99.0, -17.0, -300.0, -367.0, -144.0, -104.0, 0.0, 0.0, 0.0, -108.0, -120.0, -126.0, -6.0, -69.0, -14.0, -48.0, -222.0, -368.0, -42.0, 0.0], "policy_predator_policy_reward": [3.0, 0.0, 87.0, 93.0, 71.0, 0.0, 1.0, 148.0, 161.0, 30.0, 7.0, 4.0, 0.0, 91.0, 58.0, 34.0, 0.0, 0.0, 162.0, 0.0, 31.0, 25.0, 18.0, 97.0, 61.0, 125.0, 102.0, 67.0, 102.0, 64.0, 93.0, 45.0, 0.0, 0.0, 17.0, 81.0, 155.0, 0.0, 20.0, 75.0, 200.0, 0.0, 6.0, 100.0, 51.0, 2.0, 0.0, 66.0, 20.0, 0.0, 0.0, 23.0, 59.0, 1.0, 58.0, 0.0, 0.0, 78.0, 185.0, 41.0, 30.0, 126.0, 156.0, 0.0, 0.0, 21.0, 165.0, 136.0, 42.0, 68.0, 71.0, 152.0, 142.0, 108.0, 37.0, 0.0, 84.0, 111.0, 0.0, 0.0, 98.0, 162.0, 9.0, 114.0, 37.0, 50.0, 16.0, 0.0, 39.0, 12.0, 0.0, 0.0, 39.0, 98.0, 0.0, 56.0, 43.0, 149.0, 39.0, 91.0, 0.0, 0.0, 7.0, 4.0, 27.0, 28.0, 50.0, 0.0, 70.0, 59.0, 94.0, 95.0, 70.0, 0.0, 0.0, 23.0, 0.0, 189.0, 199.0, 0.0, 77.0, 199.0, 38.0, 0.0, 58.0, 19.0, 0.0, 108.0, 0.0, 15.0, 0.0, 27.0, 101.0, 0.0, 0.0, 25.0, 90.0, 131.0, 0.0, 1.0, 176.0, 0.0, 127.0, 132.0, 56.0, 0.0, 198.0, 0.0, 0.0, 28.0, 69.0, 0.0, 3.0, 11.0, 16.0, 0.0, 16.0, 19.0, 0.0, 84.0, 0.0, 0.0, 27.0, 0.0, 0.0, 31.0, 10.0, 5.0, 0.0, 0.0, 0.0, 47.0, 29.0, 51.0, 0.0, 38.0, 4.0, 98.0, 5.0, 98.0, 54.0, 9.0, 98.0, 182.0, 43.0, 80.0, 0.0, 0.0, 50.0, 41.0, 14.0, 92.0, 18.0, 28.0, 32.0, 0.0, 184.0, 0.0, 21.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0234389211362969, "mean_inference_ms": 2.7369813850402416, "mean_action_processing_ms": 0.5264476632273893, "mean_env_wait_ms": 0.3777198022298932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008521318435668945, "StateBufferConnector_ms": 0.0052030086517333984, "ViewRequirementAgentConnector_ms": 0.12276363372802734}, "num_episodes": 22, "episode_return_max": 17.0, "episode_return_min": -526.0, "episode_return_mean": -126.72, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.0057277029876, "num_env_steps_trained_throughput_per_sec": 309.0057277029876, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 14306.145, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14306.042, "sample_time_ms": 1877.843, "learn_time_ms": 12409.373, "learn_throughput": 322.337, "synch_weights_time_ms": 15.114}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "e1352_00000", "date": "2024-08-13_16-50-35", "timestamp": 1723582235, "time_this_iter_s": 12.988233089447021, "time_total_s": 755.7731482982635, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b160caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 755.7731482982635, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 67.57368421052632, "ram_util_percent": 83.45263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.597953694223096, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 4.143211358060282, "policy_loss": -0.00017501115872864685, "vf_loss": 4.127741515447223, "vf_explained_var": 0.044882616637245056, "kl": 0.015451714784370955, "entropy": 0.6656033230521692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0571191918755334, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 5.16956255511632, "policy_loss": 0.0031335966328341295, "vf_loss": 5.1530818800446845, "vf_explained_var": -4.667453664951224e-09, "kl": 0.007811741843005724, "entropy": 0.29810255212443215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -526.0, "episode_reward_mean": -117.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -105.69, "predator_policy": 47.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.0, -20.0, -18.0, -60.0, -43.0, -72.0, -393.0, -285.0, -202.0, -21.0, -94.0, -144.0, -107.0, -72.0, -111.0, -422.0, 13.0, -182.0, -106.0, -87.0, -16.0, -46.0, 17.0, -86.0, -48.0, -177.0, -228.0, 17.0, 8.0, -54.0, -39.0, -62.0, -101.0, -70.0, -10.0, -395.0, -526.0, -508.0, -24.0, -87.0, -99.0, -15.0, -27.0, -291.0, -10.0, -209.0, -1.0, -501.0, -232.0, -77.0, -498.0, -28.0, -69.0, 6.0, -8.0, -29.0, -84.0, 0.0, -27.0, -31.0, -15.0, 0.0, -39.0, -80.0, -40.0, -259.0, -160.0, -53.0, -387.0, -125.0, 0.0, -17.0, -140.0, -29.0, -30.0, -406.0, -21.0, -463.0, -91.0, -12.0, -83.0, -219.0, -174.0, -265.0, -143.0, -67.0, -14.0, -23.0, 17.0, -90.0, -109.0, -117.0, -73.0, -52.0, -341.0, -3.0, -135.0, -145.0, -39.0, -82.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-84.0, -80.0, 0.0, -40.0, -46.0, 5.0, -2.0, -118.0, -101.0, 0.0, 0.0, -150.0, -264.0, -355.0, -175.0, -266.0, -307.0, -51.0, -42.0, 0.0, -80.0, -315.0, -118.0, -136.0, -194.0, -136.0, -332.0, 10.0, -74.0, -74.0, -281.0, -336.0, 13.0, 0.0, -132.0, -310.0, -158.0, -71.0, 0.0, -174.0, 0.0, -32.0, -3.0, -94.0, 0.0, 17.0, -240.0, 17.0, 0.0, -104.0, -133.0, -236.0, -238.0, -120.0, 17.0, 0.0, -12.0, 9.0, 0.0, -109.0, -89.0, 0.0, -154.0, -37.0, -144.0, -146.0, 0.0, -140.0, -33.0, 0.0, -206.0, -378.0, -327.0, -398.0, -398.0, -386.0, -62.0, 0.0, -30.0, -134.0, -116.0, -91.0, 0.0, -30.0, 0.0, -54.0, -202.0, -190.0, -35.0, 0.0, -166.0, -264.0, -2.0, 0.0, -333.0, -344.0, -244.0, -247.0, -41.0, -92.0, -394.0, -302.0, 0.0, -56.0, -138.0, 0.0, -22.0, 14.0, -30.0, 6.0, -64.0, 0.0, -36.0, -132.0, 0.0, 0.0, 0.0, -54.0, -62.0, 0.0, 0.0, -30.0, 0.0, 0.0, 3.0, -89.0, 0.0, -160.0, -76.0, -2.0, -182.0, -179.0, -102.0, -161.0, -99.0, -17.0, -300.0, -367.0, -144.0, -104.0, 0.0, 0.0, 0.0, -108.0, -120.0, -126.0, -6.0, -69.0, -14.0, -48.0, -222.0, -368.0, -42.0, 0.0, -330.0, -380.0, -182.0, 0.0, -24.0, 0.0, -132.0, -34.0, -154.0, -168.0, -184.0, -162.0, -170.0, -214.0, -66.0, -175.0, -8.0, -126.0, -30.0, 0.0, -100.0, -6.0, 17.0, 0.0, -59.0, -124.0, -80.0, -82.0, -301.0, 0.0, -146.0, 0.0, 0.0, -104.0, -400.0, -208.0, 0.0, -6.0, -80.0, -190.0, -193.0, -137.0, -24.0, -59.0, 0.0, -167.0], "policy_predator_policy_reward": [0.0, 66.0, 20.0, 0.0, 0.0, 23.0, 59.0, 1.0, 58.0, 0.0, 0.0, 78.0, 185.0, 41.0, 30.0, 126.0, 156.0, 0.0, 0.0, 21.0, 165.0, 136.0, 42.0, 68.0, 71.0, 152.0, 142.0, 108.0, 37.0, 0.0, 84.0, 111.0, 0.0, 0.0, 98.0, 162.0, 9.0, 114.0, 37.0, 50.0, 16.0, 0.0, 39.0, 12.0, 0.0, 0.0, 39.0, 98.0, 0.0, 56.0, 43.0, 149.0, 39.0, 91.0, 0.0, 0.0, 7.0, 4.0, 27.0, 28.0, 50.0, 0.0, 70.0, 59.0, 94.0, 95.0, 70.0, 0.0, 0.0, 23.0, 0.0, 189.0, 199.0, 0.0, 77.0, 199.0, 38.0, 0.0, 58.0, 19.0, 0.0, 108.0, 0.0, 15.0, 0.0, 27.0, 101.0, 0.0, 0.0, 25.0, 90.0, 131.0, 0.0, 1.0, 176.0, 0.0, 127.0, 132.0, 56.0, 0.0, 198.0, 0.0, 0.0, 28.0, 69.0, 0.0, 3.0, 11.0, 16.0, 0.0, 16.0, 19.0, 0.0, 84.0, 0.0, 0.0, 27.0, 0.0, 0.0, 31.0, 10.0, 5.0, 0.0, 0.0, 0.0, 47.0, 29.0, 51.0, 0.0, 38.0, 4.0, 98.0, 5.0, 98.0, 54.0, 9.0, 98.0, 182.0, 43.0, 80.0, 0.0, 0.0, 50.0, 41.0, 14.0, 92.0, 18.0, 28.0, 32.0, 0.0, 184.0, 0.0, 21.0, 0.0, 190.0, 57.0, 0.0, 91.0, 12.0, 0.0, 52.0, 31.0, 55.0, 48.0, 83.0, 89.0, 79.0, 40.0, 54.0, 44.0, 0.0, 67.0, 16.0, 0.0, 46.0, 37.0, 0.0, 0.0, 0.0, 93.0, 5.0, 48.0, 96.0, 88.0, 0.0, 73.0, 0.0, 52.0, 200.0, 67.0, 0.0, 3.0, 0.0, 135.0, 89.0, 96.0, 0.0, 44.0, 74.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.018233237422046, "mean_inference_ms": 2.719189928387173, "mean_action_processing_ms": 0.522676722937271, "mean_env_wait_ms": 0.37600399214956726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009019613265991211, "StateBufferConnector_ms": 0.005190730094909668, "ViewRequirementAgentConnector_ms": 0.12768864631652832}, "num_episodes": 23, "episode_return_max": 17.0, "episode_return_min": -526.0, "episode_return_mean": -117.13, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.96810218686596, "num_env_steps_trained_throughput_per_sec": 304.96810218686596, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 14047.829, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14047.775, "sample_time_ms": 1844.407, "learn_time_ms": 12185.195, "learn_throughput": 328.267, "synch_weights_time_ms": 14.905}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "e1352_00000", "date": "2024-08-13_16-50-48", "timestamp": 1723582248, "time_this_iter_s": 13.157531976699829, "time_total_s": 768.9306802749634, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16318b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 768.9306802749634, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 67.81111111111112, "ram_util_percent": 83.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5603908283369883, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 3.6127843913577853, "policy_loss": 0.0014493967684862947, "vf_loss": 3.5920192635248576, "vf_explained_var": 0.128221535934973, "kl": 0.019077254305481257, "entropy": 0.7242650995967249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6420798902552596, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 4.280333686127234, "policy_loss": 0.003292203793627402, "vf_loss": 4.261785376135004, "vf_explained_var": -6.212759270239129e-09, "kl": 0.008929044212999464, "entropy": 0.35259497958831687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -526.0, "episode_reward_mean": -110.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -98.09, "predator_policy": 42.845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.0, -87.0, -16.0, -46.0, 17.0, -86.0, -48.0, -177.0, -228.0, 17.0, 8.0, -54.0, -39.0, -62.0, -101.0, -70.0, -10.0, -395.0, -526.0, -508.0, -24.0, -87.0, -99.0, -15.0, -27.0, -291.0, -10.0, -209.0, -1.0, -501.0, -232.0, -77.0, -498.0, -28.0, -69.0, 6.0, -8.0, -29.0, -84.0, 0.0, -27.0, -31.0, -15.0, 0.0, -39.0, -80.0, -40.0, -259.0, -160.0, -53.0, -387.0, -125.0, 0.0, -17.0, -140.0, -29.0, -30.0, -406.0, -21.0, -463.0, -91.0, -12.0, -83.0, -219.0, -174.0, -265.0, -143.0, -67.0, -14.0, -23.0, 17.0, -90.0, -109.0, -117.0, -73.0, -52.0, -341.0, -3.0, -135.0, -145.0, -39.0, -82.0, -92.0, -226.0, -181.0, -136.0, -65.0, -78.0, -53.0, -58.0, -161.0, -72.0, -48.0, -106.0, 0.0, 4.0, -242.0, -81.0, -78.0, 6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-158.0, -71.0, 0.0, -174.0, 0.0, -32.0, -3.0, -94.0, 0.0, 17.0, -240.0, 17.0, 0.0, -104.0, -133.0, -236.0, -238.0, -120.0, 17.0, 0.0, -12.0, 9.0, 0.0, -109.0, -89.0, 0.0, -154.0, -37.0, -144.0, -146.0, 0.0, -140.0, -33.0, 0.0, -206.0, -378.0, -327.0, -398.0, -398.0, -386.0, -62.0, 0.0, -30.0, -134.0, -116.0, -91.0, 0.0, -30.0, 0.0, -54.0, -202.0, -190.0, -35.0, 0.0, -166.0, -264.0, -2.0, 0.0, -333.0, -344.0, -244.0, -247.0, -41.0, -92.0, -394.0, -302.0, 0.0, -56.0, -138.0, 0.0, -22.0, 14.0, -30.0, 6.0, -64.0, 0.0, -36.0, -132.0, 0.0, 0.0, 0.0, -54.0, -62.0, 0.0, 0.0, -30.0, 0.0, 0.0, 3.0, -89.0, 0.0, -160.0, -76.0, -2.0, -182.0, -179.0, -102.0, -161.0, -99.0, -17.0, -300.0, -367.0, -144.0, -104.0, 0.0, 0.0, 0.0, -108.0, -120.0, -126.0, -6.0, -69.0, -14.0, -48.0, -222.0, -368.0, -42.0, 0.0, -330.0, -380.0, -182.0, 0.0, -24.0, 0.0, -132.0, -34.0, -154.0, -168.0, -184.0, -162.0, -170.0, -214.0, -66.0, -175.0, -8.0, -126.0, -30.0, 0.0, -100.0, -6.0, 17.0, 0.0, -59.0, -124.0, -80.0, -82.0, -301.0, 0.0, -146.0, 0.0, 0.0, -104.0, -400.0, -208.0, 0.0, -6.0, -80.0, -190.0, -193.0, -137.0, -24.0, -59.0, 0.0, -167.0, -57.0, -126.0, -99.0, -254.0, -224.0, -162.0, -92.0, -138.0, -48.0, -44.0, -159.0, 0.0, -106.0, 0.0, -80.0, -18.0, -160.0, -114.0, -40.0, -86.0, -80.0, -16.0, -92.0, -212.0, -4.0, 0.0, 4.0, 0.0, -150.0, -190.0, -108.0, -46.0, -156.0, 0.0, 0.0, 6.0], "policy_predator_policy_reward": [9.0, 114.0, 37.0, 50.0, 16.0, 0.0, 39.0, 12.0, 0.0, 0.0, 39.0, 98.0, 0.0, 56.0, 43.0, 149.0, 39.0, 91.0, 0.0, 0.0, 7.0, 4.0, 27.0, 28.0, 50.0, 0.0, 70.0, 59.0, 94.0, 95.0, 70.0, 0.0, 0.0, 23.0, 0.0, 189.0, 199.0, 0.0, 77.0, 199.0, 38.0, 0.0, 58.0, 19.0, 0.0, 108.0, 0.0, 15.0, 0.0, 27.0, 101.0, 0.0, 0.0, 25.0, 90.0, 131.0, 0.0, 1.0, 176.0, 0.0, 127.0, 132.0, 56.0, 0.0, 198.0, 0.0, 0.0, 28.0, 69.0, 0.0, 3.0, 11.0, 16.0, 0.0, 16.0, 19.0, 0.0, 84.0, 0.0, 0.0, 27.0, 0.0, 0.0, 31.0, 10.0, 5.0, 0.0, 0.0, 0.0, 47.0, 29.0, 51.0, 0.0, 38.0, 4.0, 98.0, 5.0, 98.0, 54.0, 9.0, 98.0, 182.0, 43.0, 80.0, 0.0, 0.0, 50.0, 41.0, 14.0, 92.0, 18.0, 28.0, 32.0, 0.0, 184.0, 0.0, 21.0, 0.0, 190.0, 57.0, 0.0, 91.0, 12.0, 0.0, 52.0, 31.0, 55.0, 48.0, 83.0, 89.0, 79.0, 40.0, 54.0, 44.0, 0.0, 67.0, 16.0, 0.0, 46.0, 37.0, 0.0, 0.0, 0.0, 93.0, 5.0, 48.0, 96.0, 88.0, 0.0, 73.0, 0.0, 52.0, 200.0, 67.0, 0.0, 3.0, 0.0, 135.0, 89.0, 96.0, 0.0, 44.0, 74.0, 11.0, 3.0, 88.0, 79.0, 48.0, 78.0, 127.0, 85.0, 9.0, 0.0, 27.0, 0.0, 81.0, 35.0, 18.0, 0.0, 40.0, 57.0, 56.0, 48.0, 6.0, 35.0, 13.0, 77.0, 121.0, 0.0, 4.0, 0.0, 0.0, 98.0, 0.0, 56.0, 17.0, 34.0, 44.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0138263317660003, "mean_inference_ms": 2.706719026743421, "mean_action_processing_ms": 0.5179839638326578, "mean_env_wait_ms": 0.3740159112567204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009331226348876953, "StateBufferConnector_ms": 0.005404233932495117, "ViewRequirementAgentConnector_ms": 0.1209864616394043}, "num_episodes": 18, "episode_return_max": 17.0, "episode_return_min": -526.0, "episode_return_mean": -110.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.825575042741, "num_env_steps_trained_throughput_per_sec": 306.825575042741, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 13778.156, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13778.102, "sample_time_ms": 1810.292, "learn_time_ms": 11950.919, "learn_throughput": 334.702, "synch_weights_time_ms": 13.876}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "e1352_00000", "date": "2024-08-13_16-51-01", "timestamp": 1723582261, "time_this_iter_s": 13.096614122390747, "time_total_s": 782.0272943973541, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b164c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 782.0272943973541, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 65.81052631578946, "ram_util_percent": 83.4421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5142491770326776, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 1.9167896577290127, "policy_loss": -0.0007092546600178278, "vf_loss": 1.905217565903588, "vf_explained_var": 0.07738069800472765, "kl": 0.012129720620539658, "entropy": 0.7001506758430017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.53607169199321, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.6516205535994635, "policy_loss": 0.0031515214205399236, "vf_loss": 2.627674930499344, "vf_explained_var": -6.4650540629391944e-09, "kl": 0.012170304419639174, "entropy": 0.4877573780833729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -526.0, "episode_reward_mean": -108.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -94.265, "predator_policy": 40.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-526.0, -508.0, -24.0, -87.0, -99.0, -15.0, -27.0, -291.0, -10.0, -209.0, -1.0, -501.0, -232.0, -77.0, -498.0, -28.0, -69.0, 6.0, -8.0, -29.0, -84.0, 0.0, -27.0, -31.0, -15.0, 0.0, -39.0, -80.0, -40.0, -259.0, -160.0, -53.0, -387.0, -125.0, 0.0, -17.0, -140.0, -29.0, -30.0, -406.0, -21.0, -463.0, -91.0, -12.0, -83.0, -219.0, -174.0, -265.0, -143.0, -67.0, -14.0, -23.0, 17.0, -90.0, -109.0, -117.0, -73.0, -52.0, -341.0, -3.0, -135.0, -145.0, -39.0, -82.0, -92.0, -226.0, -181.0, -136.0, -65.0, -78.0, -53.0, -58.0, -161.0, -72.0, -48.0, -106.0, 0.0, 4.0, -242.0, -81.0, -78.0, 6.0, -27.0, -35.0, -84.0, 0.0, -166.0, -34.0, -51.0, -55.0, 1.0, -11.0, -35.0, 0.0, -359.0, -282.0, -39.0, -38.0, 0.0, -49.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-327.0, -398.0, -398.0, -386.0, -62.0, 0.0, -30.0, -134.0, -116.0, -91.0, 0.0, -30.0, 0.0, -54.0, -202.0, -190.0, -35.0, 0.0, -166.0, -264.0, -2.0, 0.0, -333.0, -344.0, -244.0, -247.0, -41.0, -92.0, -394.0, -302.0, 0.0, -56.0, -138.0, 0.0, -22.0, 14.0, -30.0, 6.0, -64.0, 0.0, -36.0, -132.0, 0.0, 0.0, 0.0, -54.0, -62.0, 0.0, 0.0, -30.0, 0.0, 0.0, 3.0, -89.0, 0.0, -160.0, -76.0, -2.0, -182.0, -179.0, -102.0, -161.0, -99.0, -17.0, -300.0, -367.0, -144.0, -104.0, 0.0, 0.0, 0.0, -108.0, -120.0, -126.0, -6.0, -69.0, -14.0, -48.0, -222.0, -368.0, -42.0, 0.0, -330.0, -380.0, -182.0, 0.0, -24.0, 0.0, -132.0, -34.0, -154.0, -168.0, -184.0, -162.0, -170.0, -214.0, -66.0, -175.0, -8.0, -126.0, -30.0, 0.0, -100.0, -6.0, 17.0, 0.0, -59.0, -124.0, -80.0, -82.0, -301.0, 0.0, -146.0, 0.0, 0.0, -104.0, -400.0, -208.0, 0.0, -6.0, -80.0, -190.0, -193.0, -137.0, -24.0, -59.0, 0.0, -167.0, -57.0, -126.0, -99.0, -254.0, -224.0, -162.0, -92.0, -138.0, -48.0, -44.0, -159.0, 0.0, -106.0, 0.0, -80.0, -18.0, -160.0, -114.0, -40.0, -86.0, -80.0, -16.0, -92.0, -212.0, -4.0, 0.0, 4.0, 0.0, -150.0, -190.0, -108.0, -46.0, -156.0, 0.0, 0.0, 6.0, -34.0, -17.0, -12.0, -81.0, -76.0, -86.0, 0.0, 0.0, -99.0, -138.0, -34.0, -116.0, -68.0, -42.0, -80.0, -32.0, 0.0, -5.0, 0.0, -39.0, 0.0, -70.0, 0.0, 0.0, -260.0, -229.0, -206.0, -214.0, -58.0, -37.0, 0.0, -81.0, 0.0, 0.0, -112.0, 0.0], "policy_predator_policy_reward": [199.0, 0.0, 77.0, 199.0, 38.0, 0.0, 58.0, 19.0, 0.0, 108.0, 0.0, 15.0, 0.0, 27.0, 101.0, 0.0, 0.0, 25.0, 90.0, 131.0, 0.0, 1.0, 176.0, 0.0, 127.0, 132.0, 56.0, 0.0, 198.0, 0.0, 0.0, 28.0, 69.0, 0.0, 3.0, 11.0, 16.0, 0.0, 16.0, 19.0, 0.0, 84.0, 0.0, 0.0, 27.0, 0.0, 0.0, 31.0, 10.0, 5.0, 0.0, 0.0, 0.0, 47.0, 29.0, 51.0, 0.0, 38.0, 4.0, 98.0, 5.0, 98.0, 54.0, 9.0, 98.0, 182.0, 43.0, 80.0, 0.0, 0.0, 50.0, 41.0, 14.0, 92.0, 18.0, 28.0, 32.0, 0.0, 184.0, 0.0, 21.0, 0.0, 190.0, 57.0, 0.0, 91.0, 12.0, 0.0, 52.0, 31.0, 55.0, 48.0, 83.0, 89.0, 79.0, 40.0, 54.0, 44.0, 0.0, 67.0, 16.0, 0.0, 46.0, 37.0, 0.0, 0.0, 0.0, 93.0, 5.0, 48.0, 96.0, 88.0, 0.0, 73.0, 0.0, 52.0, 200.0, 67.0, 0.0, 3.0, 0.0, 135.0, 89.0, 96.0, 0.0, 44.0, 74.0, 11.0, 3.0, 88.0, 79.0, 48.0, 78.0, 127.0, 85.0, 9.0, 0.0, 27.0, 0.0, 81.0, 35.0, 18.0, 0.0, 40.0, 57.0, 56.0, 48.0, 6.0, 35.0, 13.0, 77.0, 121.0, 0.0, 4.0, 0.0, 0.0, 98.0, 0.0, 56.0, 17.0, 34.0, 44.0, 0.0, 0.0, 0.0, 24.0, 4.0, 54.0, 49.0, 29.0, 0.0, 0.0, 61.0, 10.0, 44.0, 72.0, 59.0, 0.0, 57.0, 0.0, 0.0, 6.0, 4.0, 24.0, 35.0, 0.0, 0.0, 0.0, 0.0, 130.0, 88.0, 50.0, 0.0, 56.0, 2.0, 41.0, 0.0, 0.0, 0.0, 63.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0106611415331426, "mean_inference_ms": 2.697201233632337, "mean_action_processing_ms": 0.5146852778077003, "mean_env_wait_ms": 0.3726413257589779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008871197700500488, "StateBufferConnector_ms": 0.005346179008483887, "ViewRequirementAgentConnector_ms": 0.14010882377624512}, "num_episodes": 18, "episode_return_max": 17.0, "episode_return_min": -526.0, "episode_return_mean": -108.3, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.62059113612713, "num_env_steps_trained_throughput_per_sec": 306.62059113612713, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 13085.625, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13085.576, "sample_time_ms": 1644.429, "learn_time_ms": 11423.173, "learn_throughput": 350.165, "synch_weights_time_ms": 13.987}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "e1352_00000", "date": "2024-08-13_16-51-15", "timestamp": 1723582275, "time_this_iter_s": 13.191756010055542, "time_total_s": 795.2190504074097, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ba700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 795.2190504074097, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 65.18333333333334, "ram_util_percent": 83.42222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4950387640210687, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 1.7086600342440226, "policy_loss": -0.00013924363468374525, "vf_loss": 1.6962969633952651, "vf_explained_var": 0.14301425426725356, "kl": 0.012347965073139237, "entropy": 0.6680453354246402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3875960739792657, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 3.224019706249237, "policy_loss": 0.004070173264924614, "vf_loss": 3.1994020634858065, "vf_explained_var": -6.969643648339327e-09, "kl": 0.012025956340770031, "entropy": 0.4505169483325469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -463.0, "episode_reward_mean": -84.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -75.45, "predator_policy": 33.39}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, -29.0, -84.0, 0.0, -27.0, -31.0, -15.0, 0.0, -39.0, -80.0, -40.0, -259.0, -160.0, -53.0, -387.0, -125.0, 0.0, -17.0, -140.0, -29.0, -30.0, -406.0, -21.0, -463.0, -91.0, -12.0, -83.0, -219.0, -174.0, -265.0, -143.0, -67.0, -14.0, -23.0, 17.0, -90.0, -109.0, -117.0, -73.0, -52.0, -341.0, -3.0, -135.0, -145.0, -39.0, -82.0, -92.0, -226.0, -181.0, -136.0, -65.0, -78.0, -53.0, -58.0, -161.0, -72.0, -48.0, -106.0, 0.0, 4.0, -242.0, -81.0, -78.0, 6.0, -27.0, -35.0, -84.0, 0.0, -166.0, -34.0, -51.0, -55.0, 1.0, -11.0, -35.0, 0.0, -359.0, -282.0, -39.0, -38.0, 0.0, -49.0, 27.0, 14.0, -13.0, 5.0, -9.0, -158.0, -22.0, -140.0, 17.0, -114.0, -4.0, -2.0, 0.0, 0.0, -411.0, -6.0, 16.0, 22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.0, 6.0, -64.0, 0.0, -36.0, -132.0, 0.0, 0.0, 0.0, -54.0, -62.0, 0.0, 0.0, -30.0, 0.0, 0.0, 3.0, -89.0, 0.0, -160.0, -76.0, -2.0, -182.0, -179.0, -102.0, -161.0, -99.0, -17.0, -300.0, -367.0, -144.0, -104.0, 0.0, 0.0, 0.0, -108.0, -120.0, -126.0, -6.0, -69.0, -14.0, -48.0, -222.0, -368.0, -42.0, 0.0, -330.0, -380.0, -182.0, 0.0, -24.0, 0.0, -132.0, -34.0, -154.0, -168.0, -184.0, -162.0, -170.0, -214.0, -66.0, -175.0, -8.0, -126.0, -30.0, 0.0, -100.0, -6.0, 17.0, 0.0, -59.0, -124.0, -80.0, -82.0, -301.0, 0.0, -146.0, 0.0, 0.0, -104.0, -400.0, -208.0, 0.0, -6.0, -80.0, -190.0, -193.0, -137.0, -24.0, -59.0, 0.0, -167.0, -57.0, -126.0, -99.0, -254.0, -224.0, -162.0, -92.0, -138.0, -48.0, -44.0, -159.0, 0.0, -106.0, 0.0, -80.0, -18.0, -160.0, -114.0, -40.0, -86.0, -80.0, -16.0, -92.0, -212.0, -4.0, 0.0, 4.0, 0.0, -150.0, -190.0, -108.0, -46.0, -156.0, 0.0, 0.0, 6.0, -34.0, -17.0, -12.0, -81.0, -76.0, -86.0, 0.0, 0.0, -99.0, -138.0, -34.0, -116.0, -68.0, -42.0, -80.0, -32.0, 0.0, -5.0, 0.0, -39.0, 0.0, -70.0, 0.0, 0.0, -260.0, -229.0, -206.0, -214.0, -58.0, -37.0, 0.0, -81.0, 0.0, 0.0, -112.0, 0.0, 8.0, 19.0, 5.0, 4.0, -34.0, 4.0, 4.0, -2.0, -39.0, 2.0, -130.0, -93.0, -50.0, 0.0, -128.0, -124.0, 19.0, -8.0, -96.0, -77.0, -10.0, 0.0, 0.0, -13.0, 0.0, 0.0, 0.0, 0.0, -230.0, -362.0, -44.0, 16.0, 16.0, 0.0, 14.0, 8.0], "policy_predator_policy_reward": [16.0, 0.0, 16.0, 19.0, 0.0, 84.0, 0.0, 0.0, 27.0, 0.0, 0.0, 31.0, 10.0, 5.0, 0.0, 0.0, 0.0, 47.0, 29.0, 51.0, 0.0, 38.0, 4.0, 98.0, 5.0, 98.0, 54.0, 9.0, 98.0, 182.0, 43.0, 80.0, 0.0, 0.0, 50.0, 41.0, 14.0, 92.0, 18.0, 28.0, 32.0, 0.0, 184.0, 0.0, 21.0, 0.0, 190.0, 57.0, 0.0, 91.0, 12.0, 0.0, 52.0, 31.0, 55.0, 48.0, 83.0, 89.0, 79.0, 40.0, 54.0, 44.0, 0.0, 67.0, 16.0, 0.0, 46.0, 37.0, 0.0, 0.0, 0.0, 93.0, 5.0, 48.0, 96.0, 88.0, 0.0, 73.0, 0.0, 52.0, 200.0, 67.0, 0.0, 3.0, 0.0, 135.0, 89.0, 96.0, 0.0, 44.0, 74.0, 11.0, 3.0, 88.0, 79.0, 48.0, 78.0, 127.0, 85.0, 9.0, 0.0, 27.0, 0.0, 81.0, 35.0, 18.0, 0.0, 40.0, 57.0, 56.0, 48.0, 6.0, 35.0, 13.0, 77.0, 121.0, 0.0, 4.0, 0.0, 0.0, 98.0, 0.0, 56.0, 17.0, 34.0, 44.0, 0.0, 0.0, 0.0, 24.0, 4.0, 54.0, 49.0, 29.0, 0.0, 0.0, 61.0, 10.0, 44.0, 72.0, 59.0, 0.0, 57.0, 0.0, 0.0, 6.0, 4.0, 24.0, 35.0, 0.0, 0.0, 0.0, 0.0, 130.0, 88.0, 50.0, 0.0, 56.0, 2.0, 41.0, 0.0, 0.0, 0.0, 63.0, 0.0, 0.0, 5.0, 0.0, 0.0, 17.0, 0.0, 3.0, 28.0, 0.0, 0.0, 65.0, 0.0, 28.0, 0.0, 112.0, 4.0, 2.0, 0.0, 59.0, 6.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0077817338153714, "mean_inference_ms": 2.689434628973308, "mean_action_processing_ms": 0.5118323975812082, "mean_env_wait_ms": 0.37152489464978045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005802035331726074, "StateBufferConnector_ms": 0.004662156105041504, "ViewRequirementAgentConnector_ms": 0.13085103034973145}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -463.0, "episode_return_mean": -84.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.44433999333387, "num_env_steps_trained_throughput_per_sec": 298.44433999333387, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 13060.368, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13060.319, "sample_time_ms": 1671.096, "learn_time_ms": 11371.29, "learn_throughput": 351.763, "synch_weights_time_ms": 14.153}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "e1352_00000", "date": "2024-08-13_16-51-28", "timestamp": 1723582288, "time_this_iter_s": 13.448606967926025, "time_total_s": 808.6676573753357, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ba820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 808.6676573753357, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 68.35499999999999, "ram_util_percent": 83.57}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7206485288483755, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 1.7580080849468394, "policy_loss": -0.00046187642316220613, "vf_loss": 1.7431474794786443, "vf_explained_var": 0.15189147692508798, "kl": 0.015133319391509146, "entropy": 0.5795530569458764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.856538244171275, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.638601794633916, "policy_loss": 0.0037049098600628514, "vf_loss": 2.612574877373125, "vf_explained_var": -5.5189485903139465e-09, "kl": 0.013064554066442788, "entropy": 0.480995568538469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -463.0, "episode_reward_mean": -83.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -71.915, "predator_policy": 30.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.0, -463.0, -91.0, -12.0, -83.0, -219.0, -174.0, -265.0, -143.0, -67.0, -14.0, -23.0, 17.0, -90.0, -109.0, -117.0, -73.0, -52.0, -341.0, -3.0, -135.0, -145.0, -39.0, -82.0, -92.0, -226.0, -181.0, -136.0, -65.0, -78.0, -53.0, -58.0, -161.0, -72.0, -48.0, -106.0, 0.0, 4.0, -242.0, -81.0, -78.0, 6.0, -27.0, -35.0, -84.0, 0.0, -166.0, -34.0, -51.0, -55.0, 1.0, -11.0, -35.0, 0.0, -359.0, -282.0, -39.0, -38.0, 0.0, -49.0, 27.0, 14.0, -13.0, 5.0, -9.0, -158.0, -22.0, -140.0, 17.0, -114.0, -4.0, -2.0, 0.0, 0.0, -411.0, -6.0, 16.0, 22.0, -33.0, -94.0, 0.0, -141.0, 30.0, -10.0, -229.0, -192.0, -14.0, 0.0, -15.0, -1.0, -133.0, -24.0, 12.0, -39.0, -418.0, -36.0, 6.0, -202.0, -244.0, -95.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-42.0, 0.0, -330.0, -380.0, -182.0, 0.0, -24.0, 0.0, -132.0, -34.0, -154.0, -168.0, -184.0, -162.0, -170.0, -214.0, -66.0, -175.0, -8.0, -126.0, -30.0, 0.0, -100.0, -6.0, 17.0, 0.0, -59.0, -124.0, -80.0, -82.0, -301.0, 0.0, -146.0, 0.0, 0.0, -104.0, -400.0, -208.0, 0.0, -6.0, -80.0, -190.0, -193.0, -137.0, -24.0, -59.0, 0.0, -167.0, -57.0, -126.0, -99.0, -254.0, -224.0, -162.0, -92.0, -138.0, -48.0, -44.0, -159.0, 0.0, -106.0, 0.0, -80.0, -18.0, -160.0, -114.0, -40.0, -86.0, -80.0, -16.0, -92.0, -212.0, -4.0, 0.0, 4.0, 0.0, -150.0, -190.0, -108.0, -46.0, -156.0, 0.0, 0.0, 6.0, -34.0, -17.0, -12.0, -81.0, -76.0, -86.0, 0.0, 0.0, -99.0, -138.0, -34.0, -116.0, -68.0, -42.0, -80.0, -32.0, 0.0, -5.0, 0.0, -39.0, 0.0, -70.0, 0.0, 0.0, -260.0, -229.0, -206.0, -214.0, -58.0, -37.0, 0.0, -81.0, 0.0, 0.0, -112.0, 0.0, 8.0, 19.0, 5.0, 4.0, -34.0, 4.0, 4.0, -2.0, -39.0, 2.0, -130.0, -93.0, -50.0, 0.0, -128.0, -124.0, 19.0, -8.0, -96.0, -77.0, -10.0, 0.0, 0.0, -13.0, 0.0, 0.0, 0.0, 0.0, -230.0, -362.0, -44.0, 16.0, 16.0, 0.0, 14.0, 8.0, 2.0, -70.0, -62.0, -68.0, 0.0, 0.0, -94.0, -94.0, 16.0, 14.0, -10.0, -6.0, -184.0, -158.0, -128.0, -128.0, -28.0, 0.0, 0.0, 0.0, -38.0, 0.0, 0.0, -18.0, -89.0, -122.0, 0.0, -48.0, 0.0, 12.0, -14.0, -50.0, -273.0, -290.0, 0.0, -72.0, 6.0, 0.0, -137.0, -144.0, -164.0, -162.0, -36.0, -118.0], "policy_predator_policy_reward": [21.0, 0.0, 190.0, 57.0, 0.0, 91.0, 12.0, 0.0, 52.0, 31.0, 55.0, 48.0, 83.0, 89.0, 79.0, 40.0, 54.0, 44.0, 0.0, 67.0, 16.0, 0.0, 46.0, 37.0, 0.0, 0.0, 0.0, 93.0, 5.0, 48.0, 96.0, 88.0, 0.0, 73.0, 0.0, 52.0, 200.0, 67.0, 0.0, 3.0, 0.0, 135.0, 89.0, 96.0, 0.0, 44.0, 74.0, 11.0, 3.0, 88.0, 79.0, 48.0, 78.0, 127.0, 85.0, 9.0, 0.0, 27.0, 0.0, 81.0, 35.0, 18.0, 0.0, 40.0, 57.0, 56.0, 48.0, 6.0, 35.0, 13.0, 77.0, 121.0, 0.0, 4.0, 0.0, 0.0, 98.0, 0.0, 56.0, 17.0, 34.0, 44.0, 0.0, 0.0, 0.0, 24.0, 4.0, 54.0, 49.0, 29.0, 0.0, 0.0, 61.0, 10.0, 44.0, 72.0, 59.0, 0.0, 57.0, 0.0, 0.0, 6.0, 4.0, 24.0, 35.0, 0.0, 0.0, 0.0, 0.0, 130.0, 88.0, 50.0, 0.0, 56.0, 2.0, 41.0, 0.0, 0.0, 0.0, 63.0, 0.0, 0.0, 5.0, 0.0, 0.0, 17.0, 0.0, 3.0, 28.0, 0.0, 0.0, 65.0, 0.0, 28.0, 0.0, 112.0, 4.0, 2.0, 0.0, 59.0, 6.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 28.0, 7.0, 36.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 1.0, 5.0, 113.0, 0.0, 64.0, 0.0, 14.0, 0.0, 0.0, 0.0, 8.0, 15.0, 8.0, 9.0, 43.0, 35.0, 24.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 145.0, 0.0, 36.0, 0.0, 0.0, 7.0, 72.0, 82.0, 0.0, 0.0, 59.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0043246558500425, "mean_inference_ms": 2.680210298805812, "mean_action_processing_ms": 0.5084995842312564, "mean_env_wait_ms": 0.37001889698423013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005058765411376953, "StateBufferConnector_ms": 0.0033953189849853516, "ViewRequirementAgentConnector_ms": 0.1309373378753662}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -463.0, "episode_return_mean": -83.25, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.6495463435552, "num_env_steps_trained_throughput_per_sec": 289.6495463435552, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 13133.919, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13133.866, "sample_time_ms": 1680.126, "learn_time_ms": 11436.776, "learn_throughput": 349.749, "synch_weights_time_ms": 13.674}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "e1352_00000", "date": "2024-08-13_16-51-42", "timestamp": 1723582302, "time_this_iter_s": 13.87683391571045, "time_total_s": 822.5444912910461, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b160cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 822.5444912910461, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 67.56842105263158, "ram_util_percent": 83.74210526315791}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.458271597286381, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 2.352116164139339, "policy_loss": -0.001309943570701218, "vf_loss": 2.3433079730265987, "vf_explained_var": 0.13369035033321885, "kl": 0.009993219777474196, "entropy": 0.4229422080532584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.483557870148351, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 3.536432751587459, "policy_loss": 0.0032331542305342816, "vf_loss": 3.514268102216973, "vf_explained_var": -7.379622686476935e-09, "kl": 0.011080165888185705, "entropy": 0.5370818285557328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -542.0, "episode_reward_mean": -72.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -60.84, "predator_policy": 24.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.0, -92.0, -226.0, -181.0, -136.0, -65.0, -78.0, -53.0, -58.0, -161.0, -72.0, -48.0, -106.0, 0.0, 4.0, -242.0, -81.0, -78.0, 6.0, -27.0, -35.0, -84.0, 0.0, -166.0, -34.0, -51.0, -55.0, 1.0, -11.0, -35.0, 0.0, -359.0, -282.0, -39.0, -38.0, 0.0, -49.0, 27.0, 14.0, -13.0, 5.0, -9.0, -158.0, -22.0, -140.0, 17.0, -114.0, -4.0, -2.0, 0.0, 0.0, -411.0, -6.0, 16.0, 22.0, -33.0, -94.0, 0.0, -141.0, 30.0, -10.0, -229.0, -192.0, -14.0, 0.0, -15.0, -1.0, -133.0, -24.0, 12.0, -39.0, -418.0, -36.0, 6.0, -202.0, -244.0, -95.0, 20.0, -82.0, -39.0, -3.0, -542.0, -8.0, 17.0, -312.0, -159.0, -18.0, -14.0, 9.0, -9.0, 0.0, -50.0, 16.0, -203.0, 9.0, -79.0, -106.0, -25.0, -43.0, -8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -167.0, -57.0, -126.0, -99.0, -254.0, -224.0, -162.0, -92.0, -138.0, -48.0, -44.0, -159.0, 0.0, -106.0, 0.0, -80.0, -18.0, -160.0, -114.0, -40.0, -86.0, -80.0, -16.0, -92.0, -212.0, -4.0, 0.0, 4.0, 0.0, -150.0, -190.0, -108.0, -46.0, -156.0, 0.0, 0.0, 6.0, -34.0, -17.0, -12.0, -81.0, -76.0, -86.0, 0.0, 0.0, -99.0, -138.0, -34.0, -116.0, -68.0, -42.0, -80.0, -32.0, 0.0, -5.0, 0.0, -39.0, 0.0, -70.0, 0.0, 0.0, -260.0, -229.0, -206.0, -214.0, -58.0, -37.0, 0.0, -81.0, 0.0, 0.0, -112.0, 0.0, 8.0, 19.0, 5.0, 4.0, -34.0, 4.0, 4.0, -2.0, -39.0, 2.0, -130.0, -93.0, -50.0, 0.0, -128.0, -124.0, 19.0, -8.0, -96.0, -77.0, -10.0, 0.0, 0.0, -13.0, 0.0, 0.0, 0.0, 0.0, -230.0, -362.0, -44.0, 16.0, 16.0, 0.0, 14.0, 8.0, 2.0, -70.0, -62.0, -68.0, 0.0, 0.0, -94.0, -94.0, 16.0, 14.0, -10.0, -6.0, -184.0, -158.0, -128.0, -128.0, -28.0, 0.0, 0.0, 0.0, -38.0, 0.0, 0.0, -18.0, -89.0, -122.0, 0.0, -48.0, 0.0, 12.0, -14.0, -50.0, -273.0, -290.0, 0.0, -72.0, 6.0, 0.0, -137.0, -144.0, -164.0, -162.0, -36.0, -118.0, 20.0, 0.0, -64.0, -100.0, -72.0, -53.0, 0.0, -8.0, -400.0, -342.0, -20.0, 0.0, 0.0, 17.0, -234.0, -198.0, -159.0, -102.0, -30.0, -10.0, -28.0, 0.0, 18.0, -18.0, -40.0, 11.0, 0.0, 0.0, -18.0, -82.0, 4.0, 8.0, -152.0, -148.0, 8.0, 1.0, -64.0, -47.0, -60.0, -97.0, -59.0, 3.0, -116.0, 8.0, -7.0, -18.0], "policy_predator_policy_reward": [74.0, 11.0, 3.0, 88.0, 79.0, 48.0, 78.0, 127.0, 85.0, 9.0, 0.0, 27.0, 0.0, 81.0, 35.0, 18.0, 0.0, 40.0, 57.0, 56.0, 48.0, 6.0, 35.0, 13.0, 77.0, 121.0, 0.0, 4.0, 0.0, 0.0, 98.0, 0.0, 56.0, 17.0, 34.0, 44.0, 0.0, 0.0, 0.0, 24.0, 4.0, 54.0, 49.0, 29.0, 0.0, 0.0, 61.0, 10.0, 44.0, 72.0, 59.0, 0.0, 57.0, 0.0, 0.0, 6.0, 4.0, 24.0, 35.0, 0.0, 0.0, 0.0, 0.0, 130.0, 88.0, 50.0, 0.0, 56.0, 2.0, 41.0, 0.0, 0.0, 0.0, 63.0, 0.0, 0.0, 5.0, 0.0, 0.0, 17.0, 0.0, 3.0, 28.0, 0.0, 0.0, 65.0, 0.0, 28.0, 0.0, 112.0, 4.0, 2.0, 0.0, 59.0, 6.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 28.0, 7.0, 36.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 1.0, 5.0, 113.0, 0.0, 64.0, 0.0, 14.0, 0.0, 0.0, 0.0, 8.0, 15.0, 8.0, 9.0, 43.0, 35.0, 24.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 145.0, 0.0, 36.0, 0.0, 0.0, 7.0, 72.0, 82.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 82.0, 40.0, 46.0, 5.0, 0.0, 0.0, 200.0, 12.0, 0.0, 0.0, 0.0, 0.0, 120.0, 102.0, 0.0, 8.0, 14.0, 14.0, 0.0, 9.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 39.0, 4.0, 0.0, 74.0, 23.0, 0.0, 0.0, 0.0, 32.0, 44.0, 7.0, 31.0, 0.0, 23.0, 42.0, 0.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0011625564933417, "mean_inference_ms": 2.6710846408486053, "mean_action_processing_ms": 0.5049967808573322, "mean_env_wait_ms": 0.3685698487894573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00455474853515625, "StateBufferConnector_ms": 0.0034987926483154297, "ViewRequirementAgentConnector_ms": 0.13166189193725586}, "num_episodes": 23, "episode_return_max": 30.0, "episode_return_min": -542.0, "episode_return_mean": -72.92, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.27833528777836, "num_env_steps_trained_throughput_per_sec": 302.27833528777836, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 13186.712, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13186.659, "sample_time_ms": 1685.758, "learn_time_ms": 11483.134, "learn_throughput": 348.337, "synch_weights_time_ms": 14.363}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "e1352_00000", "date": "2024-08-13_16-51-55", "timestamp": 1723582315, "time_this_iter_s": 13.283130168914795, "time_total_s": 835.8276214599609, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b162d430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 835.8276214599609, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 64.57894736842104, "ram_util_percent": 83.64736842105265}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.434744153073225, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 2.462951664129893, "policy_loss": 0.0006391515686772961, "vf_loss": 2.4498320571959966, "vf_explained_var": 0.06339837331620474, "kl": 0.012326379815976004, "entropy": 0.4328468519228476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2348852625323667, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.6927705662906485, "policy_loss": 0.0022400892333487277, "vf_loss": 2.6781377036735496, "vf_explained_var": -3.532127097800926e-09, "kl": 0.007253200567418793, "entropy": 0.37505217106254013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -542.0, "episode_reward_mean": -68.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -58.55, "predator_policy": 24.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, -27.0, -35.0, -84.0, 0.0, -166.0, -34.0, -51.0, -55.0, 1.0, -11.0, -35.0, 0.0, -359.0, -282.0, -39.0, -38.0, 0.0, -49.0, 27.0, 14.0, -13.0, 5.0, -9.0, -158.0, -22.0, -140.0, 17.0, -114.0, -4.0, -2.0, 0.0, 0.0, -411.0, -6.0, 16.0, 22.0, -33.0, -94.0, 0.0, -141.0, 30.0, -10.0, -229.0, -192.0, -14.0, 0.0, -15.0, -1.0, -133.0, -24.0, 12.0, -39.0, -418.0, -36.0, 6.0, -202.0, -244.0, -95.0, 20.0, -82.0, -39.0, -3.0, -542.0, -8.0, 17.0, -312.0, -159.0, -18.0, -14.0, 9.0, -9.0, 0.0, -50.0, 16.0, -203.0, 9.0, -79.0, -106.0, -25.0, -43.0, -8.0, -32.0, -4.0, -388.0, 16.0, -21.0, -10.0, -15.0, -44.0, -44.0, 14.0, -21.0, 0.0, 14.0, -137.0, -216.0, 0.0, -313.0, -125.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 6.0, -34.0, -17.0, -12.0, -81.0, -76.0, -86.0, 0.0, 0.0, -99.0, -138.0, -34.0, -116.0, -68.0, -42.0, -80.0, -32.0, 0.0, -5.0, 0.0, -39.0, 0.0, -70.0, 0.0, 0.0, -260.0, -229.0, -206.0, -214.0, -58.0, -37.0, 0.0, -81.0, 0.0, 0.0, -112.0, 0.0, 8.0, 19.0, 5.0, 4.0, -34.0, 4.0, 4.0, -2.0, -39.0, 2.0, -130.0, -93.0, -50.0, 0.0, -128.0, -124.0, 19.0, -8.0, -96.0, -77.0, -10.0, 0.0, 0.0, -13.0, 0.0, 0.0, 0.0, 0.0, -230.0, -362.0, -44.0, 16.0, 16.0, 0.0, 14.0, 8.0, 2.0, -70.0, -62.0, -68.0, 0.0, 0.0, -94.0, -94.0, 16.0, 14.0, -10.0, -6.0, -184.0, -158.0, -128.0, -128.0, -28.0, 0.0, 0.0, 0.0, -38.0, 0.0, 0.0, -18.0, -89.0, -122.0, 0.0, -48.0, 0.0, 12.0, -14.0, -50.0, -273.0, -290.0, 0.0, -72.0, 6.0, 0.0, -137.0, -144.0, -164.0, -162.0, -36.0, -118.0, 20.0, 0.0, -64.0, -100.0, -72.0, -53.0, 0.0, -8.0, -400.0, -342.0, -20.0, 0.0, 0.0, 17.0, -234.0, -198.0, -159.0, -102.0, -30.0, -10.0, -28.0, 0.0, 18.0, -18.0, -40.0, 11.0, 0.0, 0.0, -18.0, -82.0, 4.0, 8.0, -152.0, -148.0, 8.0, 1.0, -64.0, -47.0, -60.0, -97.0, -59.0, 3.0, -116.0, 8.0, -7.0, -18.0, -37.0, -219.0, -26.0, 4.0, -272.0, -278.0, 16.0, 0.0, 0.0, -48.0, 0.0, -20.0, 0.0, -30.0, 0.0, -88.0, 0.0, -214.0, 0.0, 12.0, -25.0, -21.0, 0.0, 0.0, 14.0, 0.0, -85.0, -183.0, -182.0, -217.0, 0.0, 0.0, -270.0, -340.0, -97.0, -160.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 24.0, 4.0, 54.0, 49.0, 29.0, 0.0, 0.0, 61.0, 10.0, 44.0, 72.0, 59.0, 0.0, 57.0, 0.0, 0.0, 6.0, 4.0, 24.0, 35.0, 0.0, 0.0, 0.0, 0.0, 130.0, 88.0, 50.0, 0.0, 56.0, 2.0, 41.0, 0.0, 0.0, 0.0, 63.0, 0.0, 0.0, 5.0, 0.0, 0.0, 17.0, 0.0, 3.0, 28.0, 0.0, 0.0, 65.0, 0.0, 28.0, 0.0, 112.0, 4.0, 2.0, 0.0, 59.0, 6.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 28.0, 7.0, 36.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 1.0, 5.0, 113.0, 0.0, 64.0, 0.0, 14.0, 0.0, 0.0, 0.0, 8.0, 15.0, 8.0, 9.0, 43.0, 35.0, 24.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 145.0, 0.0, 36.0, 0.0, 0.0, 7.0, 72.0, 82.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 82.0, 40.0, 46.0, 5.0, 0.0, 0.0, 200.0, 12.0, 0.0, 0.0, 0.0, 0.0, 120.0, 102.0, 0.0, 8.0, 14.0, 14.0, 0.0, 9.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 39.0, 4.0, 0.0, 74.0, 23.0, 0.0, 0.0, 0.0, 32.0, 44.0, 7.0, 31.0, 0.0, 23.0, 42.0, 0.0, 17.0, 107.0, 117.0, 8.0, 10.0, 125.0, 37.0, 0.0, 0.0, 27.0, 0.0, 0.0, 10.0, 0.0, 15.0, 0.0, 44.0, 94.0, 76.0, 0.0, 2.0, 11.0, 14.0, 0.0, 0.0, 0.0, 0.0, 129.0, 2.0, 110.0, 73.0, 0.0, 0.0, 178.0, 119.0, 132.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9986713983980837, "mean_inference_ms": 2.6630715760760157, "mean_action_processing_ms": 0.5022714077769108, "mean_env_wait_ms": 0.36733389853561715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038956403732299805, "StateBufferConnector_ms": 0.003498673439025879, "ViewRequirementAgentConnector_ms": 0.13366985321044922}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -542.0, "episode_return_mean": -68.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.4486641232456, "num_env_steps_trained_throughput_per_sec": 304.4486641232456, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 13229.943, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13229.89, "sample_time_ms": 1677.478, "learn_time_ms": 11534.819, "learn_throughput": 346.776, "synch_weights_time_ms": 14.52}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "e1352_00000", "date": "2024-08-13_16-52-09", "timestamp": 1723582329, "time_this_iter_s": 13.174463033676147, "time_total_s": 849.0020844936371, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b160c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 849.0020844936371, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 64.89999999999999, "ram_util_percent": 83.56315789473683}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5583043496996638, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 2.093314267655529, "policy_loss": 0.00033408068576285606, "vf_loss": 2.0817567341542116, "vf_explained_var": 0.08373508611053386, "kl": 0.011084897712686458, "entropy": 0.39805469605184735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2317541073396723, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.8763039594604853, "policy_loss": 0.003421346516786981, "vf_loss": 2.85500740052531, "vf_explained_var": -3.563663946888434e-09, "kl": 0.010461947587591789, "entropy": 0.37371445460215447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -542.0, "episode_reward_mean": -69.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -59.315, "predator_policy": 24.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.0, 27.0, 14.0, -13.0, 5.0, -9.0, -158.0, -22.0, -140.0, 17.0, -114.0, -4.0, -2.0, 0.0, 0.0, -411.0, -6.0, 16.0, 22.0, -33.0, -94.0, 0.0, -141.0, 30.0, -10.0, -229.0, -192.0, -14.0, 0.0, -15.0, -1.0, -133.0, -24.0, 12.0, -39.0, -418.0, -36.0, 6.0, -202.0, -244.0, -95.0, 20.0, -82.0, -39.0, -3.0, -542.0, -8.0, 17.0, -312.0, -159.0, -18.0, -14.0, 9.0, -9.0, 0.0, -50.0, 16.0, -203.0, 9.0, -79.0, -106.0, -25.0, -43.0, -8.0, -32.0, -4.0, -388.0, 16.0, -21.0, -10.0, -15.0, -44.0, -44.0, 14.0, -21.0, 0.0, 14.0, -137.0, -216.0, 0.0, -313.0, -125.0, 0.0, -76.0, -8.0, -144.0, -63.0, -59.0, -44.0, -216.0, -42.0, -273.0, 8.0, 0.0, 0.0, -3.0, 0.0, 11.0, -302.0, -56.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-112.0, 0.0, 8.0, 19.0, 5.0, 4.0, -34.0, 4.0, 4.0, -2.0, -39.0, 2.0, -130.0, -93.0, -50.0, 0.0, -128.0, -124.0, 19.0, -8.0, -96.0, -77.0, -10.0, 0.0, 0.0, -13.0, 0.0, 0.0, 0.0, 0.0, -230.0, -362.0, -44.0, 16.0, 16.0, 0.0, 14.0, 8.0, 2.0, -70.0, -62.0, -68.0, 0.0, 0.0, -94.0, -94.0, 16.0, 14.0, -10.0, -6.0, -184.0, -158.0, -128.0, -128.0, -28.0, 0.0, 0.0, 0.0, -38.0, 0.0, 0.0, -18.0, -89.0, -122.0, 0.0, -48.0, 0.0, 12.0, -14.0, -50.0, -273.0, -290.0, 0.0, -72.0, 6.0, 0.0, -137.0, -144.0, -164.0, -162.0, -36.0, -118.0, 20.0, 0.0, -64.0, -100.0, -72.0, -53.0, 0.0, -8.0, -400.0, -342.0, -20.0, 0.0, 0.0, 17.0, -234.0, -198.0, -159.0, -102.0, -30.0, -10.0, -28.0, 0.0, 18.0, -18.0, -40.0, 11.0, 0.0, 0.0, -18.0, -82.0, 4.0, 8.0, -152.0, -148.0, 8.0, 1.0, -64.0, -47.0, -60.0, -97.0, -59.0, 3.0, -116.0, 8.0, -7.0, -18.0, -37.0, -219.0, -26.0, 4.0, -272.0, -278.0, 16.0, 0.0, 0.0, -48.0, 0.0, -20.0, 0.0, -30.0, 0.0, -88.0, 0.0, -214.0, 0.0, 12.0, -25.0, -21.0, 0.0, 0.0, 14.0, 0.0, -85.0, -183.0, -182.0, -217.0, 0.0, 0.0, -270.0, -340.0, -97.0, -160.0, 0.0, 0.0, 0.0, -193.0, -12.0, -10.0, -168.0, -120.0, -26.0, -102.0, 0.0, -118.0, -100.0, -7.0, -143.0, -146.0, -34.0, -30.0, -96.0, -356.0, -15.0, 9.0, 0.0, 0.0, 0.0, 0.0, -10.0, 2.0, 0.0, 0.0, 11.0, 0.0, -361.0, -124.0, -112.0, 0.0], "policy_predator_policy_reward": [0.0, 63.0, 0.0, 0.0, 5.0, 0.0, 0.0, 17.0, 0.0, 3.0, 28.0, 0.0, 0.0, 65.0, 0.0, 28.0, 0.0, 112.0, 4.0, 2.0, 0.0, 59.0, 6.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 28.0, 7.0, 36.0, 0.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 1.0, 5.0, 113.0, 0.0, 64.0, 0.0, 14.0, 0.0, 0.0, 0.0, 8.0, 15.0, 8.0, 9.0, 43.0, 35.0, 24.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 145.0, 0.0, 36.0, 0.0, 0.0, 7.0, 72.0, 82.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 82.0, 40.0, 46.0, 5.0, 0.0, 0.0, 200.0, 12.0, 0.0, 0.0, 0.0, 0.0, 120.0, 102.0, 0.0, 8.0, 14.0, 14.0, 0.0, 9.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 39.0, 4.0, 0.0, 74.0, 23.0, 0.0, 0.0, 0.0, 32.0, 44.0, 7.0, 31.0, 0.0, 23.0, 42.0, 0.0, 17.0, 107.0, 117.0, 8.0, 10.0, 125.0, 37.0, 0.0, 0.0, 27.0, 0.0, 0.0, 10.0, 0.0, 15.0, 0.0, 44.0, 94.0, 76.0, 0.0, 2.0, 11.0, 14.0, 0.0, 0.0, 0.0, 0.0, 129.0, 2.0, 110.0, 73.0, 0.0, 0.0, 178.0, 119.0, 132.0, 0.0, 0.0, 0.0, 51.0, 66.0, 7.0, 7.0, 0.0, 144.0, 0.0, 65.0, 59.0, 0.0, 55.0, 8.0, 73.0, 0.0, 22.0, 0.0, 171.0, 8.0, 11.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 20.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9951718530430511, "mean_inference_ms": 2.6526170901454447, "mean_action_processing_ms": 0.49934169513799936, "mean_env_wait_ms": 0.36584158434770875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003919363021850586, "StateBufferConnector_ms": 0.0036791563034057617, "ViewRequirementAgentConnector_ms": 0.11269021034240723}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -542.0, "episode_return_mean": -69.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.56032176326687, "num_env_steps_trained_throughput_per_sec": 312.56032176326687, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 13240.882, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13240.827, "sample_time_ms": 1669.972, "learn_time_ms": 11552.659, "learn_throughput": 346.241, "synch_weights_time_ms": 14.652}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "e1352_00000", "date": "2024-08-13_16-52-22", "timestamp": 1723582342, "time_this_iter_s": 12.841421127319336, "time_total_s": 861.8435056209564, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b160c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 861.8435056209564, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 69.25, "ram_util_percent": 83.52222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0624722980159933, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 2.160745892764399, "policy_loss": 0.001541247683769417, "vf_loss": 2.1470706086940865, "vf_explained_var": 0.11098446464412427, "kl": 0.011984233374142252, "entropy": 0.41096214173489776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.958465802713874, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.849326057724221, "policy_loss": 0.0028332296988025072, "vf_loss": 2.8327211460739217, "vf_explained_var": -4.320548324988633e-09, "kl": 0.008060245034236383, "entropy": 0.3025078521006637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -542.0, "episode_reward_mean": -75.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -64.74, "predator_policy": 27.18}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-141.0, 30.0, -10.0, -229.0, -192.0, -14.0, 0.0, -15.0, -1.0, -133.0, -24.0, 12.0, -39.0, -418.0, -36.0, 6.0, -202.0, -244.0, -95.0, 20.0, -82.0, -39.0, -3.0, -542.0, -8.0, 17.0, -312.0, -159.0, -18.0, -14.0, 9.0, -9.0, 0.0, -50.0, 16.0, -203.0, 9.0, -79.0, -106.0, -25.0, -43.0, -8.0, -32.0, -4.0, -388.0, 16.0, -21.0, -10.0, -15.0, -44.0, -44.0, 14.0, -21.0, 0.0, 14.0, -137.0, -216.0, 0.0, -313.0, -125.0, 0.0, -76.0, -8.0, -144.0, -63.0, -59.0, -44.0, -216.0, -42.0, -273.0, 8.0, 0.0, 0.0, -3.0, 0.0, 11.0, -302.0, -56.0, 2.0, -215.0, -262.0, -46.0, 0.0, 0.0, 0.0, -67.0, 15.0, -23.0, -438.0, -177.0, -124.0, -161.0, -49.0, 4.0, -63.0, 3.0, 11.0, 16.0, 29.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-94.0, -94.0, 16.0, 14.0, -10.0, -6.0, -184.0, -158.0, -128.0, -128.0, -28.0, 0.0, 0.0, 0.0, -38.0, 0.0, 0.0, -18.0, -89.0, -122.0, 0.0, -48.0, 0.0, 12.0, -14.0, -50.0, -273.0, -290.0, 0.0, -72.0, 6.0, 0.0, -137.0, -144.0, -164.0, -162.0, -36.0, -118.0, 20.0, 0.0, -64.0, -100.0, -72.0, -53.0, 0.0, -8.0, -400.0, -342.0, -20.0, 0.0, 0.0, 17.0, -234.0, -198.0, -159.0, -102.0, -30.0, -10.0, -28.0, 0.0, 18.0, -18.0, -40.0, 11.0, 0.0, 0.0, -18.0, -82.0, 4.0, 8.0, -152.0, -148.0, 8.0, 1.0, -64.0, -47.0, -60.0, -97.0, -59.0, 3.0, -116.0, 8.0, -7.0, -18.0, -37.0, -219.0, -26.0, 4.0, -272.0, -278.0, 16.0, 0.0, 0.0, -48.0, 0.0, -20.0, 0.0, -30.0, 0.0, -88.0, 0.0, -214.0, 0.0, 12.0, -25.0, -21.0, 0.0, 0.0, 14.0, 0.0, -85.0, -183.0, -182.0, -217.0, 0.0, 0.0, -270.0, -340.0, -97.0, -160.0, 0.0, 0.0, 0.0, -193.0, -12.0, -10.0, -168.0, -120.0, -26.0, -102.0, 0.0, -118.0, -100.0, -7.0, -143.0, -146.0, -34.0, -30.0, -96.0, -356.0, -15.0, 9.0, 0.0, 0.0, 0.0, 0.0, -10.0, 2.0, 0.0, 0.0, 11.0, 0.0, -361.0, -124.0, -112.0, 0.0, -6.0, 0.0, -186.0, -122.0, -183.0, -210.0, -76.0, -19.0, 0.0, 0.0, 0.0, 0.0, -18.0, 9.0, -152.0, -64.0, 0.0, 15.0, -74.0, 6.0, -310.0, -330.0, -163.0, -142.0, -162.0, -99.0, -88.0, -152.0, -98.0, 0.0, 4.0, -12.0, 0.0, -143.0, 3.0, 0.0, 0.0, 11.0, 0.0, 16.0, 13.0, 16.0, 0.0, 0.0], "policy_predator_policy_reward": [47.0, 0.0, 0.0, 0.0, 1.0, 5.0, 113.0, 0.0, 64.0, 0.0, 14.0, 0.0, 0.0, 0.0, 8.0, 15.0, 8.0, 9.0, 43.0, 35.0, 24.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 145.0, 0.0, 36.0, 0.0, 0.0, 7.0, 72.0, 82.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 82.0, 40.0, 46.0, 5.0, 0.0, 0.0, 200.0, 12.0, 0.0, 0.0, 0.0, 0.0, 120.0, 102.0, 0.0, 8.0, 14.0, 14.0, 0.0, 9.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 39.0, 4.0, 0.0, 74.0, 23.0, 0.0, 0.0, 0.0, 32.0, 44.0, 7.0, 31.0, 0.0, 23.0, 42.0, 0.0, 17.0, 107.0, 117.0, 8.0, 10.0, 125.0, 37.0, 0.0, 0.0, 27.0, 0.0, 0.0, 10.0, 0.0, 15.0, 0.0, 44.0, 94.0, 76.0, 0.0, 2.0, 11.0, 14.0, 0.0, 0.0, 0.0, 0.0, 129.0, 2.0, 110.0, 73.0, 0.0, 0.0, 178.0, 119.0, 132.0, 0.0, 0.0, 0.0, 51.0, 66.0, 7.0, 7.0, 0.0, 144.0, 0.0, 65.0, 59.0, 0.0, 55.0, 8.0, 73.0, 0.0, 22.0, 0.0, 171.0, 8.0, 11.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 20.0, 36.0, 0.0, 8.0, 93.0, 0.0, 131.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 46.0, 103.0, 0.0, 0.0, 45.0, 0.0, 91.0, 111.0, 128.0, 0.0, 137.0, 0.0, 0.0, 79.0, 0.0, 49.0, 0.0, 12.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.989495993008066, "mean_inference_ms": 2.638184573363453, "mean_action_processing_ms": 0.49539774652685054, "mean_env_wait_ms": 0.3630828136348628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004065871238708496, "StateBufferConnector_ms": 0.0036045312881469727, "ViewRequirementAgentConnector_ms": 0.1392127275466919}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -542.0, "episode_return_mean": -75.12, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.42258087673287, "num_env_steps_trained_throughput_per_sec": 312.42258087673287, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 13132.779, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13132.726, "sample_time_ms": 1634.522, "learn_time_ms": 11480.465, "learn_throughput": 348.418, "synch_weights_time_ms": 14.478}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "e1352_00000", "date": "2024-08-13_16-52-34", "timestamp": 1723582354, "time_this_iter_s": 12.848452806472778, "time_total_s": 874.6919584274292, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b160c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 874.6919584274292, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 65.8111111111111, "ram_util_percent": 83.18333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8841857745376214, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 2.174693187330135, "policy_loss": 0.0005964248707251889, "vf_loss": 2.164354626968424, "vf_explained_var": 0.13455088116504527, "kl": 0.009621861138865435, "entropy": 0.38444851136239117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7876656678017406, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.7538206803735603, "policy_loss": 0.0027697561978899613, "vf_loss": 2.737489296078051, "vf_explained_var": -5.172043250351356e-09, "kl": 0.00793730661044625, "entropy": 0.34491175703664934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -542.0, "episode_reward_mean": -68.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -62.16, "predator_policy": 27.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-95.0, 20.0, -82.0, -39.0, -3.0, -542.0, -8.0, 17.0, -312.0, -159.0, -18.0, -14.0, 9.0, -9.0, 0.0, -50.0, 16.0, -203.0, 9.0, -79.0, -106.0, -25.0, -43.0, -8.0, -32.0, -4.0, -388.0, 16.0, -21.0, -10.0, -15.0, -44.0, -44.0, 14.0, -21.0, 0.0, 14.0, -137.0, -216.0, 0.0, -313.0, -125.0, 0.0, -76.0, -8.0, -144.0, -63.0, -59.0, -44.0, -216.0, -42.0, -273.0, 8.0, 0.0, 0.0, -3.0, 0.0, 11.0, -302.0, -56.0, 2.0, -215.0, -262.0, -46.0, 0.0, 0.0, 0.0, -67.0, 15.0, -23.0, -438.0, -177.0, -124.0, -161.0, -49.0, 4.0, -63.0, 3.0, 11.0, 16.0, 29.0, 0.0, -287.0, 11.0, 0.0, -1.0, 8.0, -115.0, -7.0, -13.0, -15.0, -48.0, -32.0, -8.0, -62.0, 1.0, -39.0, -437.0, 13.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-36.0, -118.0, 20.0, 0.0, -64.0, -100.0, -72.0, -53.0, 0.0, -8.0, -400.0, -342.0, -20.0, 0.0, 0.0, 17.0, -234.0, -198.0, -159.0, -102.0, -30.0, -10.0, -28.0, 0.0, 18.0, -18.0, -40.0, 11.0, 0.0, 0.0, -18.0, -82.0, 4.0, 8.0, -152.0, -148.0, 8.0, 1.0, -64.0, -47.0, -60.0, -97.0, -59.0, 3.0, -116.0, 8.0, -7.0, -18.0, -37.0, -219.0, -26.0, 4.0, -272.0, -278.0, 16.0, 0.0, 0.0, -48.0, 0.0, -20.0, 0.0, -30.0, 0.0, -88.0, 0.0, -214.0, 0.0, 12.0, -25.0, -21.0, 0.0, 0.0, 14.0, 0.0, -85.0, -183.0, -182.0, -217.0, 0.0, 0.0, -270.0, -340.0, -97.0, -160.0, 0.0, 0.0, 0.0, -193.0, -12.0, -10.0, -168.0, -120.0, -26.0, -102.0, 0.0, -118.0, -100.0, -7.0, -143.0, -146.0, -34.0, -30.0, -96.0, -356.0, -15.0, 9.0, 0.0, 0.0, 0.0, 0.0, -10.0, 2.0, 0.0, 0.0, 11.0, 0.0, -361.0, -124.0, -112.0, 0.0, -6.0, 0.0, -186.0, -122.0, -183.0, -210.0, -76.0, -19.0, 0.0, 0.0, 0.0, 0.0, -18.0, 9.0, -152.0, -64.0, 0.0, 15.0, -74.0, 6.0, -310.0, -330.0, -163.0, -142.0, -162.0, -99.0, -88.0, -152.0, -98.0, 0.0, 4.0, -12.0, 0.0, -143.0, 3.0, 0.0, 0.0, 11.0, 0.0, 16.0, 13.0, 16.0, 0.0, 0.0, -225.0, -182.0, -2.0, 7.0, 0.0, 0.0, -12.0, 0.0, 8.0, 0.0, -58.0, -175.0, -10.0, -18.0, 0.0, -26.0, -50.0, -112.0, -96.0, 0.0, 0.0, -68.0, 2.0, -20.0, 0.0, -129.0, -7.0, 0.0, -14.0, -71.0, -250.0, -374.0, 0.0, 13.0, 0.0, -18.0], "policy_predator_policy_reward": [0.0, 59.0, 0.0, 0.0, 0.0, 82.0, 40.0, 46.0, 5.0, 0.0, 0.0, 200.0, 12.0, 0.0, 0.0, 0.0, 0.0, 120.0, 102.0, 0.0, 8.0, 14.0, 14.0, 0.0, 9.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 39.0, 4.0, 0.0, 74.0, 23.0, 0.0, 0.0, 0.0, 32.0, 44.0, 7.0, 31.0, 0.0, 23.0, 42.0, 0.0, 17.0, 107.0, 117.0, 8.0, 10.0, 125.0, 37.0, 0.0, 0.0, 27.0, 0.0, 0.0, 10.0, 0.0, 15.0, 0.0, 44.0, 94.0, 76.0, 0.0, 2.0, 11.0, 14.0, 0.0, 0.0, 0.0, 0.0, 129.0, 2.0, 110.0, 73.0, 0.0, 0.0, 178.0, 119.0, 132.0, 0.0, 0.0, 0.0, 51.0, 66.0, 7.0, 7.0, 0.0, 144.0, 0.0, 65.0, 59.0, 0.0, 55.0, 8.0, 73.0, 0.0, 22.0, 0.0, 171.0, 8.0, 11.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 20.0, 36.0, 0.0, 8.0, 93.0, 0.0, 131.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 46.0, 103.0, 0.0, 0.0, 45.0, 0.0, 91.0, 111.0, 128.0, 0.0, 137.0, 0.0, 0.0, 79.0, 0.0, 49.0, 0.0, 12.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 120.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 75.0, 43.0, 11.0, 10.0, 0.0, 13.0, 66.0, 81.0, 48.0, 0.0, 36.0, 0.0, 0.0, 10.0, 55.0, 12.0, 8.0, 0.0, 0.0, 46.0, 0.0, 187.0, 0.0, 0.0, 12.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9855914238896082, "mean_inference_ms": 2.62439095766391, "mean_action_processing_ms": 0.49224417432653444, "mean_env_wait_ms": 0.3616936741013479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004173994064331055, "StateBufferConnector_ms": 0.0036797523498535156, "ViewRequirementAgentConnector_ms": 0.14240479469299316}, "num_episodes": 18, "episode_return_max": 29.0, "episode_return_min": -542.0, "episode_return_mean": -68.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.37550303789465, "num_env_steps_trained_throughput_per_sec": 300.37550303789465, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 13169.971, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13169.891, "sample_time_ms": 1613.09, "learn_time_ms": 11537.44, "learn_throughput": 346.697, "synch_weights_time_ms": 15.212}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "e1352_00000", "date": "2024-08-13_16-52-48", "timestamp": 1723582368, "time_this_iter_s": 13.367569923400879, "time_total_s": 888.0595283508301, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16088b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 888.0595283508301, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 68.62105263157893, "ram_util_percent": 83.45263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.551492608508105, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.009999999999999998, "total_loss": 1.0199645887922357, "policy_loss": -0.002288412850438839, "vf_loss": 1.0173461781371207, "vf_explained_var": 0.12748038712001983, "kl": 0.0048462462120121485, "entropy": 0.2983654672427783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.20311739894527, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 1.1752941873732698, "policy_loss": 0.001528940795521651, "vf_loss": 1.1622171046714933, "vf_explained_var": -6.18122242115162e-09, "kl": 0.006758858290126824, "entropy": 0.254601217388476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -438.0, "episode_reward_mean": -59.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": -56.165, "predator_policy": 26.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, -32.0, -4.0, -388.0, 16.0, -21.0, -10.0, -15.0, -44.0, -44.0, 14.0, -21.0, 0.0, 14.0, -137.0, -216.0, 0.0, -313.0, -125.0, 0.0, -76.0, -8.0, -144.0, -63.0, -59.0, -44.0, -216.0, -42.0, -273.0, 8.0, 0.0, 0.0, -3.0, 0.0, 11.0, -302.0, -56.0, 2.0, -215.0, -262.0, -46.0, 0.0, 0.0, 0.0, -67.0, 15.0, -23.0, -438.0, -177.0, -124.0, -161.0, -49.0, 4.0, -63.0, 3.0, 11.0, 16.0, 29.0, 0.0, -287.0, 11.0, 0.0, -1.0, 8.0, -115.0, -7.0, -13.0, -15.0, -48.0, -32.0, -8.0, -62.0, 1.0, -39.0, -437.0, 13.0, -6.0, 0.0, -191.0, -10.0, -38.0, -59.0, 4.0, -69.0, -9.0, 0.0, 11.0, -1.0, 0.0, -29.0, -78.0, -91.0, -14.0, -109.0, -110.0, 0.0, 9.0, 15.0, 13.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.0, -18.0, -37.0, -219.0, -26.0, 4.0, -272.0, -278.0, 16.0, 0.0, 0.0, -48.0, 0.0, -20.0, 0.0, -30.0, 0.0, -88.0, 0.0, -214.0, 0.0, 12.0, -25.0, -21.0, 0.0, 0.0, 14.0, 0.0, -85.0, -183.0, -182.0, -217.0, 0.0, 0.0, -270.0, -340.0, -97.0, -160.0, 0.0, 0.0, 0.0, -193.0, -12.0, -10.0, -168.0, -120.0, -26.0, -102.0, 0.0, -118.0, -100.0, -7.0, -143.0, -146.0, -34.0, -30.0, -96.0, -356.0, -15.0, 9.0, 0.0, 0.0, 0.0, 0.0, -10.0, 2.0, 0.0, 0.0, 11.0, 0.0, -361.0, -124.0, -112.0, 0.0, -6.0, 0.0, -186.0, -122.0, -183.0, -210.0, -76.0, -19.0, 0.0, 0.0, 0.0, 0.0, -18.0, 9.0, -152.0, -64.0, 0.0, 15.0, -74.0, 6.0, -310.0, -330.0, -163.0, -142.0, -162.0, -99.0, -88.0, -152.0, -98.0, 0.0, 4.0, -12.0, 0.0, -143.0, 3.0, 0.0, 0.0, 11.0, 0.0, 16.0, 13.0, 16.0, 0.0, 0.0, -225.0, -182.0, -2.0, 7.0, 0.0, 0.0, -12.0, 0.0, 8.0, 0.0, -58.0, -175.0, -10.0, -18.0, 0.0, -26.0, -50.0, -112.0, -96.0, 0.0, 0.0, -68.0, 2.0, -20.0, 0.0, -129.0, -7.0, 0.0, -14.0, -71.0, -250.0, -374.0, 0.0, 13.0, 0.0, -18.0, 0.0, 0.0, 0.0, -382.0, -24.0, 0.0, -28.0, -24.0, -16.0, -110.0, 4.0, 0.0, -138.0, 0.0, -12.0, -3.0, 0.0, 0.0, 9.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -58.0, 0.0, -156.0, -70.0, -132.0, 1.0, -30.0, 0.0, -218.0, -124.0, -96.0, 0.0, 0.0, 0.0, 9.0, 15.0, 0.0, 3.0, 4.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 17.0, 107.0, 117.0, 8.0, 10.0, 125.0, 37.0, 0.0, 0.0, 27.0, 0.0, 0.0, 10.0, 0.0, 15.0, 0.0, 44.0, 94.0, 76.0, 0.0, 2.0, 11.0, 14.0, 0.0, 0.0, 0.0, 0.0, 129.0, 2.0, 110.0, 73.0, 0.0, 0.0, 178.0, 119.0, 132.0, 0.0, 0.0, 0.0, 51.0, 66.0, 7.0, 7.0, 0.0, 144.0, 0.0, 65.0, 59.0, 0.0, 55.0, 8.0, 73.0, 0.0, 22.0, 0.0, 171.0, 8.0, 11.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 20.0, 36.0, 0.0, 8.0, 93.0, 0.0, 131.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 46.0, 103.0, 0.0, 0.0, 45.0, 0.0, 91.0, 111.0, 128.0, 0.0, 137.0, 0.0, 0.0, 79.0, 0.0, 49.0, 0.0, 12.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 120.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 75.0, 43.0, 11.0, 10.0, 0.0, 13.0, 66.0, 81.0, 48.0, 0.0, 36.0, 0.0, 0.0, 10.0, 55.0, 12.0, 8.0, 0.0, 0.0, 46.0, 0.0, 187.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 191.0, 2.0, 12.0, 14.0, 0.0, 0.0, 67.0, 0.0, 0.0, 69.0, 0.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 29.0, 0.0, 78.0, 29.0, 82.0, 15.0, 0.0, 109.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9800652306964649, "mean_inference_ms": 2.6077685599745912, "mean_action_processing_ms": 0.4880629267690397, "mean_env_wait_ms": 0.359362611923939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057103633880615234, "StateBufferConnector_ms": 0.0051833391189575195, "ViewRequirementAgentConnector_ms": 0.16631150245666504}, "num_episodes": 23, "episode_return_max": 29.0, "episode_return_min": -438.0, "episode_return_mean": -59.39, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.1261015379759, "num_env_steps_trained_throughput_per_sec": 318.1261015379759, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 13115.722, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13115.641, "sample_time_ms": 1608.503, "learn_time_ms": 11487.413, "learn_throughput": 348.207, "synch_weights_time_ms": 15.567}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "e1352_00000", "date": "2024-08-13_16-53-00", "timestamp": 1723582380, "time_this_iter_s": 12.644078016281128, "time_total_s": 900.7036063671112, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ad160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 900.7036063671112, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 66.1277777777778, "ram_util_percent": 83.5777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7484297053050744, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.009999999999999998, "total_loss": 0.8581821121393688, "policy_loss": -0.0019196746737829276, "vf_loss": 0.8542523878749716, "vf_explained_var": 0.08792705873332957, "kl": 0.011554368931067163, "entropy": 0.2544198900066986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5482021196099818, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 1.1640551180672394, "policy_loss": 0.0031911436606336524, "vf_loss": 1.1389295120560934, "vf_explained_var": -6.717348855639261e-09, "kl": 0.012837728346785928, "entropy": 0.4092886285964774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -438.0, "episode_reward_mean": -48.48, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": -45.09, "predator_policy": 20.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-125.0, 0.0, -76.0, -8.0, -144.0, -63.0, -59.0, -44.0, -216.0, -42.0, -273.0, 8.0, 0.0, 0.0, -3.0, 0.0, 11.0, -302.0, -56.0, 2.0, -215.0, -262.0, -46.0, 0.0, 0.0, 0.0, -67.0, 15.0, -23.0, -438.0, -177.0, -124.0, -161.0, -49.0, 4.0, -63.0, 3.0, 11.0, 16.0, 29.0, 0.0, -287.0, 11.0, 0.0, -1.0, 8.0, -115.0, -7.0, -13.0, -15.0, -48.0, -32.0, -8.0, -62.0, 1.0, -39.0, -437.0, 13.0, -6.0, 0.0, -191.0, -10.0, -38.0, -59.0, 4.0, -69.0, -9.0, 0.0, 11.0, -1.0, 0.0, -29.0, -78.0, -91.0, -14.0, -109.0, -110.0, 0.0, 9.0, 15.0, 13.0, 0.0, 15.0, 18.0, -147.0, -83.0, -1.0, 15.0, 7.0, 2.0, -4.0, 21.0, 0.0, 0.0, 2.0, -10.0, 30.0, -2.0, 7.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-97.0, -160.0, 0.0, 0.0, 0.0, -193.0, -12.0, -10.0, -168.0, -120.0, -26.0, -102.0, 0.0, -118.0, -100.0, -7.0, -143.0, -146.0, -34.0, -30.0, -96.0, -356.0, -15.0, 9.0, 0.0, 0.0, 0.0, 0.0, -10.0, 2.0, 0.0, 0.0, 11.0, 0.0, -361.0, -124.0, -112.0, 0.0, -6.0, 0.0, -186.0, -122.0, -183.0, -210.0, -76.0, -19.0, 0.0, 0.0, 0.0, 0.0, -18.0, 9.0, -152.0, -64.0, 0.0, 15.0, -74.0, 6.0, -310.0, -330.0, -163.0, -142.0, -162.0, -99.0, -88.0, -152.0, -98.0, 0.0, 4.0, -12.0, 0.0, -143.0, 3.0, 0.0, 0.0, 11.0, 0.0, 16.0, 13.0, 16.0, 0.0, 0.0, -225.0, -182.0, -2.0, 7.0, 0.0, 0.0, -12.0, 0.0, 8.0, 0.0, -58.0, -175.0, -10.0, -18.0, 0.0, -26.0, -50.0, -112.0, -96.0, 0.0, 0.0, -68.0, 2.0, -20.0, 0.0, -129.0, -7.0, 0.0, -14.0, -71.0, -250.0, -374.0, 0.0, 13.0, 0.0, -18.0, 0.0, 0.0, 0.0, -382.0, -24.0, 0.0, -28.0, -24.0, -16.0, -110.0, 4.0, 0.0, -138.0, 0.0, -12.0, -3.0, 0.0, 0.0, 9.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -58.0, 0.0, -156.0, -70.0, -132.0, 1.0, -30.0, 0.0, -218.0, -124.0, -96.0, 0.0, 0.0, 0.0, 9.0, 15.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 15.0, 18.0, 0.0, -97.0, -106.0, 10.0, -186.0, -11.0, 0.0, 15.0, 0.0, 4.0, 1.0, -8.0, 6.0, 6.0, -20.0, 21.0, 0.0, 1.0, -3.0, 0.0, 0.0, 2.0, 0.0, -15.0, -16.0, 15.0, 15.0, 0.0, -5.0, 0.0, 7.0, 0.0, 12.0], "policy_predator_policy_reward": [132.0, 0.0, 0.0, 0.0, 51.0, 66.0, 7.0, 7.0, 0.0, 144.0, 0.0, 65.0, 59.0, 0.0, 55.0, 8.0, 73.0, 0.0, 22.0, 0.0, 171.0, 8.0, 11.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 20.0, 36.0, 0.0, 8.0, 93.0, 0.0, 131.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 46.0, 103.0, 0.0, 0.0, 45.0, 0.0, 91.0, 111.0, 128.0, 0.0, 137.0, 0.0, 0.0, 79.0, 0.0, 49.0, 0.0, 12.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 120.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 75.0, 43.0, 11.0, 10.0, 0.0, 13.0, 66.0, 81.0, 48.0, 0.0, 36.0, 0.0, 0.0, 10.0, 55.0, 12.0, 8.0, 0.0, 0.0, 46.0, 0.0, 187.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 191.0, 2.0, 12.0, 14.0, 0.0, 0.0, 67.0, 0.0, 0.0, 69.0, 0.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 29.0, 0.0, 78.0, 29.0, 82.0, 15.0, 0.0, 109.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 56.0, 7.0, 86.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9755386939689888, "mean_inference_ms": 2.5951411859084303, "mean_action_processing_ms": 0.48496411096329495, "mean_env_wait_ms": 0.35756762853051954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005664348602294922, "StateBufferConnector_ms": 0.00493621826171875, "ViewRequirementAgentConnector_ms": 0.16171514987945557}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -438.0, "episode_return_mean": -48.48, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.81538198611196, "num_env_steps_trained_throughput_per_sec": 310.81538198611196, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 13098.987, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13098.907, "sample_time_ms": 1579.773, "learn_time_ms": 11499.026, "learn_throughput": 347.856, "synch_weights_time_ms": 15.503}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "e1352_00000", "date": "2024-08-13_16-53-13", "timestamp": 1723582393, "time_this_iter_s": 12.942260980606079, "time_total_s": 913.6458673477173, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b160c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 913.6458673477173, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 65.55000000000001, "ram_util_percent": 83.47222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7691159765477533, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.009999999999999998, "total_loss": 0.2599307504379087, "policy_loss": -0.0052547015887857585, "vf_loss": 0.24958069611183076, "vf_explained_var": 0.47352862342324836, "kl": 0.030824208477844298, "entropy": 0.33354603384163173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4005559051093996, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 0.44233724535442887, "policy_loss": 0.0009344508820927884, "vf_loss": 0.42486561327487743, "vf_explained_var": 3.4601284713341445e-06, "kl": 0.009678825226351714, "entropy": 0.344332711491241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 35.0, "episode_reward_min": -438.0, "episode_reward_mean": -38.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": -35.705, "predator_policy": 16.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.0, 2.0, -215.0, -262.0, -46.0, 0.0, 0.0, 0.0, -67.0, 15.0, -23.0, -438.0, -177.0, -124.0, -161.0, -49.0, 4.0, -63.0, 3.0, 11.0, 16.0, 29.0, 0.0, -287.0, 11.0, 0.0, -1.0, 8.0, -115.0, -7.0, -13.0, -15.0, -48.0, -32.0, -8.0, -62.0, 1.0, -39.0, -437.0, 13.0, -6.0, 0.0, -191.0, -10.0, -38.0, -59.0, 4.0, -69.0, -9.0, 0.0, 11.0, -1.0, 0.0, -29.0, -78.0, -91.0, -14.0, -109.0, -110.0, 0.0, 9.0, 15.0, 13.0, 0.0, 15.0, 18.0, -147.0, -83.0, -1.0, 15.0, 7.0, 2.0, -4.0, 21.0, 0.0, 0.0, 2.0, -10.0, 30.0, -2.0, 7.0, 12.0, 10.0, -11.0, 4.0, 0.0, 0.0, 0.0, -360.0, -3.0, 7.0, 0.0, -14.0, 35.0, -10.0, 3.0, -3.0, 15.0, 20.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-112.0, 0.0, -6.0, 0.0, -186.0, -122.0, -183.0, -210.0, -76.0, -19.0, 0.0, 0.0, 0.0, 0.0, -18.0, 9.0, -152.0, -64.0, 0.0, 15.0, -74.0, 6.0, -310.0, -330.0, -163.0, -142.0, -162.0, -99.0, -88.0, -152.0, -98.0, 0.0, 4.0, -12.0, 0.0, -143.0, 3.0, 0.0, 0.0, 11.0, 0.0, 16.0, 13.0, 16.0, 0.0, 0.0, -225.0, -182.0, -2.0, 7.0, 0.0, 0.0, -12.0, 0.0, 8.0, 0.0, -58.0, -175.0, -10.0, -18.0, 0.0, -26.0, -50.0, -112.0, -96.0, 0.0, 0.0, -68.0, 2.0, -20.0, 0.0, -129.0, -7.0, 0.0, -14.0, -71.0, -250.0, -374.0, 0.0, 13.0, 0.0, -18.0, 0.0, 0.0, 0.0, -382.0, -24.0, 0.0, -28.0, -24.0, -16.0, -110.0, 4.0, 0.0, -138.0, 0.0, -12.0, -3.0, 0.0, 0.0, 9.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -58.0, 0.0, -156.0, -70.0, -132.0, 1.0, -30.0, 0.0, -218.0, -124.0, -96.0, 0.0, 0.0, 0.0, 9.0, 15.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 15.0, 18.0, 0.0, -97.0, -106.0, 10.0, -186.0, -11.0, 0.0, 15.0, 0.0, 4.0, 1.0, -8.0, 6.0, 6.0, -20.0, 21.0, 0.0, 1.0, -3.0, 0.0, 0.0, 2.0, 0.0, -15.0, -16.0, 15.0, 15.0, 0.0, -5.0, 0.0, 7.0, 0.0, 12.0, 1.0, 9.0, -10.0, -12.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -230.0, -276.0, 0.0, -14.0, 1.0, 0.0, 0.0, 0.0, 0.0, -32.0, 19.0, 16.0, 1.0, -22.0, 0.0, -7.0, 0.0, -15.0, 0.0, 15.0, 0.0, 20.0, 3.0, 0.0], "policy_predator_policy_reward": [20.0, 36.0, 0.0, 8.0, 93.0, 0.0, 131.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 46.0, 103.0, 0.0, 0.0, 45.0, 0.0, 91.0, 111.0, 128.0, 0.0, 137.0, 0.0, 0.0, 79.0, 0.0, 49.0, 0.0, 12.0, 80.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 120.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 75.0, 43.0, 11.0, 10.0, 0.0, 13.0, 66.0, 81.0, 48.0, 0.0, 36.0, 0.0, 0.0, 10.0, 55.0, 12.0, 8.0, 0.0, 0.0, 46.0, 0.0, 187.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 191.0, 2.0, 12.0, 14.0, 0.0, 0.0, 67.0, 0.0, 0.0, 69.0, 0.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 29.0, 0.0, 78.0, 29.0, 82.0, 15.0, 0.0, 109.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 56.0, 7.0, 86.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 14.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9712219013823368, "mean_inference_ms": 2.5827336687362026, "mean_action_processing_ms": 0.48192592411670576, "mean_env_wait_ms": 0.3558435768393368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005697846412658691, "StateBufferConnector_ms": 0.005039691925048828, "ViewRequirementAgentConnector_ms": 0.1618177890777588}, "num_episodes": 18, "episode_return_max": 35.0, "episode_return_min": -438.0, "episode_return_mean": -38.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.41505479215556, "num_env_steps_trained_throughput_per_sec": 315.41505479215556, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 13062.614, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13062.534, "sample_time_ms": 1511.059, "learn_time_ms": 11533.893, "learn_throughput": 346.804, "synch_weights_time_ms": 14.253}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "e1352_00000", "date": "2024-08-13_16-53-26", "timestamp": 1723582406, "time_this_iter_s": 12.73219895362854, "time_total_s": 926.3780663013458, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1608940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 926.3780663013458, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 64.50555555555556, "ram_util_percent": 83.47777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8564294884759913, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.009999999999999998, "total_loss": 1.2369445584123098, "policy_loss": -0.0011684729249546767, "vf_loss": 1.2286133766489684, "vf_explained_var": 0.0757975404540067, "kl": 0.012509830819546586, "entropy": 0.2558593628740815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2123387087865796, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 1.8994651632964927, "policy_loss": 0.0031533699911383407, "vf_loss": 1.8777976874005857, "vf_explained_var": -5.960464477539063e-09, "kl": 0.010835875371868068, "entropy": 0.38797313930496335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 35.0, "episode_reward_min": -437.0, "episode_reward_mean": -27.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": -26.725, "predator_policy": 12.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -287.0, 11.0, 0.0, -1.0, 8.0, -115.0, -7.0, -13.0, -15.0, -48.0, -32.0, -8.0, -62.0, 1.0, -39.0, -437.0, 13.0, -6.0, 0.0, -191.0, -10.0, -38.0, -59.0, 4.0, -69.0, -9.0, 0.0, 11.0, -1.0, 0.0, -29.0, -78.0, -91.0, -14.0, -109.0, -110.0, 0.0, 9.0, 15.0, 13.0, 0.0, 15.0, 18.0, -147.0, -83.0, -1.0, 15.0, 7.0, 2.0, -4.0, 21.0, 0.0, 0.0, 2.0, -10.0, 30.0, -2.0, 7.0, 12.0, 10.0, -11.0, 4.0, 0.0, 0.0, 0.0, -360.0, -3.0, 7.0, 0.0, -14.0, 35.0, -10.0, 3.0, -3.0, 15.0, 20.0, 3.0, 3.0, 0.0, -304.0, -8.0, 2.0, -191.0, 10.0, 8.0, -78.0, 15.0, -72.0, 16.0, -7.0, 3.0, 2.0, 26.0, -8.0, 13.0, -14.0, 2.0, 11.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -225.0, -182.0, -2.0, 7.0, 0.0, 0.0, -12.0, 0.0, 8.0, 0.0, -58.0, -175.0, -10.0, -18.0, 0.0, -26.0, -50.0, -112.0, -96.0, 0.0, 0.0, -68.0, 2.0, -20.0, 0.0, -129.0, -7.0, 0.0, -14.0, -71.0, -250.0, -374.0, 0.0, 13.0, 0.0, -18.0, 0.0, 0.0, 0.0, -382.0, -24.0, 0.0, -28.0, -24.0, -16.0, -110.0, 4.0, 0.0, -138.0, 0.0, -12.0, -3.0, 0.0, 0.0, 9.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -58.0, 0.0, -156.0, -70.0, -132.0, 1.0, -30.0, 0.0, -218.0, -124.0, -96.0, 0.0, 0.0, 0.0, 9.0, 15.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 15.0, 18.0, 0.0, -97.0, -106.0, 10.0, -186.0, -11.0, 0.0, 15.0, 0.0, 4.0, 1.0, -8.0, 6.0, 6.0, -20.0, 21.0, 0.0, 1.0, -3.0, 0.0, 0.0, 2.0, 0.0, -15.0, -16.0, 15.0, 15.0, 0.0, -5.0, 0.0, 7.0, 0.0, 12.0, 1.0, 9.0, -10.0, -12.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -230.0, -276.0, 0.0, -14.0, 1.0, 0.0, 0.0, 0.0, 0.0, -32.0, 19.0, 16.0, 1.0, -22.0, 0.0, -7.0, 0.0, -15.0, 0.0, 15.0, 0.0, 20.0, 3.0, 0.0, -28.0, 10.0, 0.0, 0.0, -226.0, -199.0, 0.0, -16.0, 2.0, 0.0, -114.0, -178.0, 0.0, 10.0, 0.0, 0.0, -4.0, -152.0, 0.0, 15.0, -144.0, 0.0, -16.0, 17.0, 0.0, -14.0, 6.0, -6.0, 0.0, 2.0, 14.0, 12.0, 0.0, -34.0, 0.0, 13.0, -9.0, -12.0, -18.0, 11.0, 0.0, 11.0, 0.0, 15.0], "policy_predator_policy_reward": [0.0, 0.0, 120.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 75.0, 43.0, 11.0, 10.0, 0.0, 13.0, 66.0, 81.0, 48.0, 0.0, 36.0, 0.0, 0.0, 10.0, 55.0, 12.0, 8.0, 0.0, 0.0, 46.0, 0.0, 187.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 191.0, 2.0, 12.0, 14.0, 0.0, 0.0, 67.0, 0.0, 0.0, 69.0, 0.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 29.0, 0.0, 78.0, 29.0, 82.0, 15.0, 0.0, 109.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 56.0, 7.0, 86.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 14.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 108.0, 13.0, 0.0, 8.0, 0.0, 0.0, 101.0, 0.0, 0.0, 0.0, 8.0, 0.0, 77.0, 1.0, 0.0, 0.0, 8.0, 64.0, 4.0, 11.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 13.0, 13.0, 0.0, 0.0, 0.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9658297960416733, "mean_inference_ms": 2.5672769310828083, "mean_action_processing_ms": 0.47825122582588236, "mean_env_wait_ms": 0.35372836498378146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006275653839111328, "StateBufferConnector_ms": 0.0057909488677978516, "ViewRequirementAgentConnector_ms": 0.13099360466003418}, "num_episodes": 22, "episode_return_max": 35.0, "episode_return_min": -437.0, "episode_return_mean": -27.71, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.2442772018306, "num_env_steps_trained_throughput_per_sec": 308.2442772018306, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 13020.003, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13019.921, "sample_time_ms": 1425.1, "learn_time_ms": 11577.577, "learn_throughput": 345.495, "synch_weights_time_ms": 13.923}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "e1352_00000", "date": "2024-08-13_16-53-39", "timestamp": 1723582419, "time_this_iter_s": 13.039228916168213, "time_total_s": 939.417295217514, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ba700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 939.417295217514, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 64.69999999999999, "ram_util_percent": 83.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.642540680021836, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 0.009999999999999998, "total_loss": 0.5798622226352415, "policy_loss": -0.00020481550292402663, "vf_loss": 0.5777309039440105, "vf_explained_var": 0.3013832768750569, "kl": 0.0030763883611666467, "entropy": 0.1980053405597727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.347427604225262, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 0.9912302459752749, "policy_loss": 0.0020235475601145516, "vf_loss": 0.9733862697762787, "vf_explained_var": -7.411159535564442e-09, "kl": 0.00925932847143998, "entropy": 0.3806205042140194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 35.0, "episode_reward_min": -468.0, "episode_reward_mean": -24.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": -22.7, "predator_policy": 10.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.0, 4.0, -69.0, -9.0, 0.0, 11.0, -1.0, 0.0, -29.0, -78.0, -91.0, -14.0, -109.0, -110.0, 0.0, 9.0, 15.0, 13.0, 0.0, 15.0, 18.0, -147.0, -83.0, -1.0, 15.0, 7.0, 2.0, -4.0, 21.0, 0.0, 0.0, 2.0, -10.0, 30.0, -2.0, 7.0, 12.0, 10.0, -11.0, 4.0, 0.0, 0.0, 0.0, -360.0, -3.0, 7.0, 0.0, -14.0, 35.0, -10.0, 3.0, -3.0, 15.0, 20.0, 3.0, 3.0, 0.0, -304.0, -8.0, 2.0, -191.0, 10.0, 8.0, -78.0, 15.0, -72.0, 16.0, -7.0, 3.0, 2.0, 26.0, -8.0, 13.0, -14.0, 2.0, 11.0, 15.0, -6.0, 15.0, -15.0, -1.0, -4.0, 22.0, -8.0, 1.0, -12.0, -28.0, -11.0, 0.0, 3.0, 0.0, -2.0, -15.0, -1.0, 2.0, -468.0, -9.0, -399.0, -1.0, 23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.0, -110.0, 4.0, 0.0, -138.0, 0.0, -12.0, -3.0, 0.0, 0.0, 9.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -58.0, 0.0, -156.0, -70.0, -132.0, 1.0, -30.0, 0.0, -218.0, -124.0, -96.0, 0.0, 0.0, 0.0, 9.0, 15.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 15.0, 18.0, 0.0, -97.0, -106.0, 10.0, -186.0, -11.0, 0.0, 15.0, 0.0, 4.0, 1.0, -8.0, 6.0, 6.0, -20.0, 21.0, 0.0, 1.0, -3.0, 0.0, 0.0, 2.0, 0.0, -15.0, -16.0, 15.0, 15.0, 0.0, -5.0, 0.0, 7.0, 0.0, 12.0, 1.0, 9.0, -10.0, -12.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -230.0, -276.0, 0.0, -14.0, 1.0, 0.0, 0.0, 0.0, 0.0, -32.0, 19.0, 16.0, 1.0, -22.0, 0.0, -7.0, 0.0, -15.0, 0.0, 15.0, 0.0, 20.0, 3.0, 0.0, -28.0, 10.0, 0.0, 0.0, -226.0, -199.0, 0.0, -16.0, 2.0, 0.0, -114.0, -178.0, 0.0, 10.0, 0.0, 0.0, -4.0, -152.0, 0.0, 15.0, -144.0, 0.0, -16.0, 17.0, 0.0, -14.0, 6.0, -6.0, 0.0, 2.0, 14.0, 12.0, 0.0, -34.0, 0.0, 13.0, -9.0, -12.0, -18.0, 11.0, 0.0, 11.0, 0.0, 15.0, -14.0, -8.0, 9.0, 6.0, -33.0, -6.0, -2.0, 0.0, 6.0, -20.0, 0.0, 17.0, -16.0, 0.0, -33.0, 8.0, 0.0, -24.0, -30.0, -23.0, -23.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, -6.0, -22.0, -8.0, -4.0, 1.0, -61.0, 0.0, -286.0, -364.0, -18.0, 0.0, -217.0, -372.0, 0.0, -12.0, 3.0, 20.0], "policy_predator_policy_reward": [0.0, 67.0, 0.0, 0.0, 69.0, 0.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 29.0, 0.0, 78.0, 29.0, 82.0, 15.0, 0.0, 109.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 56.0, 7.0, 86.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 14.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 108.0, 13.0, 0.0, 8.0, 0.0, 0.0, 101.0, 0.0, 0.0, 0.0, 8.0, 0.0, 77.0, 1.0, 0.0, 0.0, 8.0, 64.0, 4.0, 11.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 13.0, 13.0, 0.0, 0.0, 0.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 6.0, 18.0, 0.0, 1.0, 10.0, 0.0, 0.0, 5.0, 0.0, 8.0, 14.0, 12.0, 0.0, 12.0, 12.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 15.0, 0.0, 2.0, 38.0, 25.0, 5.0, 177.0, 9.0, 0.0, 179.0, 11.0, 0.0, 11.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.96045758491832, "mean_inference_ms": 2.5531456907935715, "mean_action_processing_ms": 0.4753388064876893, "mean_env_wait_ms": 0.35196787081343706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006254315376281738, "StateBufferConnector_ms": 0.00587308406829834, "ViewRequirementAgentConnector_ms": 0.12416446208953857}, "num_episodes": 23, "episode_return_max": 35.0, "episode_return_min": -468.0, "episode_return_mean": -24.09, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.68079105047883, "num_env_steps_trained_throughput_per_sec": 310.68079105047883, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 12926.517, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12926.439, "sample_time_ms": 1417.328, "learn_time_ms": 11491.728, "learn_throughput": 348.076, "synch_weights_time_ms": 13.976}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "e1352_00000", "date": "2024-08-13_16-53-52", "timestamp": 1723582432, "time_this_iter_s": 12.936689853668213, "time_total_s": 952.3539850711823, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ced30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 952.3539850711823, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 66.20555555555556, "ram_util_percent": 83.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4898736226259086, "cur_kl_coeff": 0.3796875000000001, "cur_lr": 0.009999999999999998, "total_loss": 0.6588327678896132, "policy_loss": 0.0012716982452070744, "vf_loss": 0.6450739583621422, "vf_explained_var": 0.17472960725032463, "kl": 0.032887863179419365, "entropy": 0.307996282048484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.035669171983603, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 0.8553001952771512, "policy_loss": 0.001514652593396407, "vf_loss": 0.8383933933008285, "vf_explained_var": -4.415158872251157e-09, "kl": 0.009008665099023464, "entropy": 0.3657903709384815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 35.0, "episode_reward_min": -468.0, "episode_reward_mean": -19.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": -18.06, "predator_policy": 8.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 15.0, 18.0, -147.0, -83.0, -1.0, 15.0, 7.0, 2.0, -4.0, 21.0, 0.0, 0.0, 2.0, -10.0, 30.0, -2.0, 7.0, 12.0, 10.0, -11.0, 4.0, 0.0, 0.0, 0.0, -360.0, -3.0, 7.0, 0.0, -14.0, 35.0, -10.0, 3.0, -3.0, 15.0, 20.0, 3.0, 3.0, 0.0, -304.0, -8.0, 2.0, -191.0, 10.0, 8.0, -78.0, 15.0, -72.0, 16.0, -7.0, 3.0, 2.0, 26.0, -8.0, 13.0, -14.0, 2.0, 11.0, 15.0, -6.0, 15.0, -15.0, -1.0, -4.0, 22.0, -8.0, 1.0, -12.0, -28.0, -11.0, 0.0, 3.0, 0.0, -2.0, -15.0, -1.0, 2.0, -468.0, -9.0, -399.0, -1.0, 23.0, 0.0, 0.0, 16.0, 0.0, -3.0, -31.0, 0.0, 3.0, -2.0, 0.0, -6.0, -56.0, 0.0, 0.0, 28.0, 13.0, -6.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 15.0, 18.0, 0.0, -97.0, -106.0, 10.0, -186.0, -11.0, 0.0, 15.0, 0.0, 4.0, 1.0, -8.0, 6.0, 6.0, -20.0, 21.0, 0.0, 1.0, -3.0, 0.0, 0.0, 2.0, 0.0, -15.0, -16.0, 15.0, 15.0, 0.0, -5.0, 0.0, 7.0, 0.0, 12.0, 1.0, 9.0, -10.0, -12.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -230.0, -276.0, 0.0, -14.0, 1.0, 0.0, 0.0, 0.0, 0.0, -32.0, 19.0, 16.0, 1.0, -22.0, 0.0, -7.0, 0.0, -15.0, 0.0, 15.0, 0.0, 20.0, 3.0, 0.0, -28.0, 10.0, 0.0, 0.0, -226.0, -199.0, 0.0, -16.0, 2.0, 0.0, -114.0, -178.0, 0.0, 10.0, 0.0, 0.0, -4.0, -152.0, 0.0, 15.0, -144.0, 0.0, -16.0, 17.0, 0.0, -14.0, 6.0, -6.0, 0.0, 2.0, 14.0, 12.0, 0.0, -34.0, 0.0, 13.0, -9.0, -12.0, -18.0, 11.0, 0.0, 11.0, 0.0, 15.0, -14.0, -8.0, 9.0, 6.0, -33.0, -6.0, -2.0, 0.0, 6.0, -20.0, 0.0, 17.0, -16.0, 0.0, -33.0, 8.0, 0.0, -24.0, -30.0, -23.0, -23.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, -6.0, -22.0, -8.0, -4.0, 1.0, -61.0, 0.0, -286.0, -364.0, -18.0, 0.0, -217.0, -372.0, 0.0, -12.0, 3.0, 20.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, -4.0, -2.0, 0.0, -62.0, 0.0, 0.0, 3.0, 0.0, -4.0, 0.0, 0.0, 0.0, -17.0, 0.0, -152.0, 14.0, 0.0, 0.0, -24.0, 12.0, 12.0, 16.0, 0.0, 13.0, -18.0, 0.0, 5.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 56.0, 7.0, 86.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 14.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 108.0, 13.0, 0.0, 8.0, 0.0, 0.0, 101.0, 0.0, 0.0, 0.0, 8.0, 0.0, 77.0, 1.0, 0.0, 0.0, 8.0, 64.0, 4.0, 11.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 13.0, 13.0, 0.0, 0.0, 0.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 6.0, 18.0, 0.0, 1.0, 10.0, 0.0, 0.0, 5.0, 0.0, 8.0, 14.0, 12.0, 0.0, 12.0, 12.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 15.0, 0.0, 2.0, 38.0, 25.0, 5.0, 177.0, 9.0, 0.0, 179.0, 11.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 72.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9576683542059176, "mean_inference_ms": 2.5423085928476388, "mean_action_processing_ms": 0.4718895771270498, "mean_env_wait_ms": 0.3502730006616032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004800677299499512, "StateBufferConnector_ms": 0.004280567169189453, "ViewRequirementAgentConnector_ms": 0.11947131156921387}, "num_episodes": 18, "episode_return_max": 35.0, "episode_return_min": -468.0, "episode_return_mean": -19.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.63785227760104, "num_env_steps_trained_throughput_per_sec": 308.63785227760104, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 12899.251, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12899.172, "sample_time_ms": 1452.505, "learn_time_ms": 11428.13, "learn_throughput": 350.014, "synch_weights_time_ms": 13.569}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "e1352_00000", "date": "2024-08-13_16-54-05", "timestamp": 1723582445, "time_this_iter_s": 13.026415824890137, "time_total_s": 965.3804008960724, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1639310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 965.3804008960724, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 63.921052631578945, "ram_util_percent": 83.43157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5791946403879338, "cur_kl_coeff": 0.5695312499999997, "cur_lr": 0.009999999999999998, "total_loss": 1.460644103704937, "policy_loss": 0.001504728482868621, "vf_loss": 1.444253249017019, "vf_explained_var": 0.12457082281036982, "kl": 0.026137504925444525, "entropy": 0.3790251544425412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.575972389436706, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.125256870868345, "policy_loss": 0.0021417559559392947, "vf_loss": 2.1126605156552856, "vf_explained_var": -4.8566747594762735e-09, "kl": 0.006118834585982632, "entropy": 0.26185372606629415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 35.0, "episode_reward_min": -468.0, "episode_reward_mean": -32.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -392.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -28.005, "predator_policy": 11.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 10.0, -11.0, 4.0, 0.0, 0.0, 0.0, -360.0, -3.0, 7.0, 0.0, -14.0, 35.0, -10.0, 3.0, -3.0, 15.0, 20.0, 3.0, 3.0, 0.0, -304.0, -8.0, 2.0, -191.0, 10.0, 8.0, -78.0, 15.0, -72.0, 16.0, -7.0, 3.0, 2.0, 26.0, -8.0, 13.0, -14.0, 2.0, 11.0, 15.0, -6.0, 15.0, -15.0, -1.0, -4.0, 22.0, -8.0, 1.0, -12.0, -28.0, -11.0, 0.0, 3.0, 0.0, -2.0, -15.0, -1.0, 2.0, -468.0, -9.0, -399.0, -1.0, 23.0, 0.0, 0.0, 16.0, 0.0, -3.0, -31.0, 0.0, 3.0, -2.0, 0.0, -6.0, -56.0, 0.0, 0.0, 28.0, 13.0, -6.0, 5.0, -123.0, 0.0, 22.0, -10.0, -180.0, -464.0, 19.0, 4.0, -8.0, -5.0, 15.0, -77.0, 0.0, 16.0, -82.0, -230.0, -93.0, -222.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 12.0, 1.0, 9.0, -10.0, -12.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -230.0, -276.0, 0.0, -14.0, 1.0, 0.0, 0.0, 0.0, 0.0, -32.0, 19.0, 16.0, 1.0, -22.0, 0.0, -7.0, 0.0, -15.0, 0.0, 15.0, 0.0, 20.0, 3.0, 0.0, -28.0, 10.0, 0.0, 0.0, -226.0, -199.0, 0.0, -16.0, 2.0, 0.0, -114.0, -178.0, 0.0, 10.0, 0.0, 0.0, -4.0, -152.0, 0.0, 15.0, -144.0, 0.0, -16.0, 17.0, 0.0, -14.0, 6.0, -6.0, 0.0, 2.0, 14.0, 12.0, 0.0, -34.0, 0.0, 13.0, -9.0, -12.0, -18.0, 11.0, 0.0, 11.0, 0.0, 15.0, -14.0, -8.0, 9.0, 6.0, -33.0, -6.0, -2.0, 0.0, 6.0, -20.0, 0.0, 17.0, -16.0, 0.0, -33.0, 8.0, 0.0, -24.0, -30.0, -23.0, -23.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, -6.0, -22.0, -8.0, -4.0, 1.0, -61.0, 0.0, -286.0, -364.0, -18.0, 0.0, -217.0, -372.0, 0.0, -12.0, 3.0, 20.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, -4.0, -2.0, 0.0, -62.0, 0.0, 0.0, 3.0, 0.0, -4.0, 0.0, 0.0, 0.0, -17.0, 0.0, -152.0, 14.0, 0.0, 0.0, -24.0, 12.0, 12.0, 16.0, 0.0, 13.0, -18.0, 0.0, 5.0, 0.0, -92.0, -132.0, 0.0, 0.0, 3.0, 13.0, 0.0, -20.0, -205.0, -87.0, -392.0, -268.0, 19.0, 0.0, 0.0, 4.0, -16.0, 0.0, 0.0, -13.0, 13.0, 2.0, -32.0, -140.0, 0.0, 0.0, 16.0, 0.0, 0.0, -164.0, -182.0, -160.0, -186.0, 0.0, -154.0, -147.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 14.0, 0.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 11.0, 0.0, 0.0, 108.0, 13.0, 0.0, 8.0, 0.0, 0.0, 101.0, 0.0, 0.0, 0.0, 8.0, 0.0, 77.0, 1.0, 0.0, 0.0, 8.0, 64.0, 4.0, 11.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 13.0, 13.0, 0.0, 0.0, 0.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 6.0, 18.0, 0.0, 1.0, 10.0, 0.0, 0.0, 5.0, 0.0, 8.0, 14.0, 12.0, 0.0, 12.0, 12.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 15.0, 0.0, 2.0, 38.0, 25.0, 5.0, 177.0, 9.0, 0.0, 179.0, 11.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 72.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 100.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 112.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 76.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 82.0, 99.0, 13.0, 0.0, 93.0, 0.0, 79.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9562362239866482, "mean_inference_ms": 2.5354203923894842, "mean_action_processing_ms": 0.4697578005790005, "mean_env_wait_ms": 0.34928659658160327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004934430122375488, "StateBufferConnector_ms": 0.0044203996658325195, "ViewRequirementAgentConnector_ms": 0.14609074592590332}, "num_episodes": 18, "episode_return_max": 35.0, "episode_return_min": -468.0, "episode_return_mean": -32.19, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.6772507893699, "num_env_steps_trained_throughput_per_sec": 288.6772507893699, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 12971.032, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12970.947, "sample_time_ms": 1543.79, "learn_time_ms": 11407.633, "learn_throughput": 350.642, "synch_weights_time_ms": 14.336}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "e1352_00000", "date": "2024-08-13_16-54-19", "timestamp": 1723582459, "time_this_iter_s": 13.91787576675415, "time_total_s": 979.2982766628265, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16393a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 979.2982766628265, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 70.35499999999999, "ram_util_percent": 83.53}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.864466136378586, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 0.009999999999999998, "total_loss": 2.4299842412509616, "policy_loss": 0.0022668657148079505, "vf_loss": 2.4132892233984813, "vf_explained_var": 0.015183456454958234, "kl": 0.016888912662411507, "entropy": 0.3477525524361424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.47051024634056, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.009999999999999998, "total_loss": 2.83271400240994, "policy_loss": 0.0014676263445012627, "vf_loss": 2.826802346567628, "vf_explained_var": -7.064254195601852e-09, "kl": 0.0026009878928535636, "entropy": 0.09286204560748523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -492.0, "episode_reward_mean": -40.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -392.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -36.67, "predator_policy": 16.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, 2.0, -191.0, 10.0, 8.0, -78.0, 15.0, -72.0, 16.0, -7.0, 3.0, 2.0, 26.0, -8.0, 13.0, -14.0, 2.0, 11.0, 15.0, -6.0, 15.0, -15.0, -1.0, -4.0, 22.0, -8.0, 1.0, -12.0, -28.0, -11.0, 0.0, 3.0, 0.0, -2.0, -15.0, -1.0, 2.0, -468.0, -9.0, -399.0, -1.0, 23.0, 0.0, 0.0, 16.0, 0.0, -3.0, -31.0, 0.0, 3.0, -2.0, 0.0, -6.0, -56.0, 0.0, 0.0, 28.0, 13.0, -6.0, 5.0, -123.0, 0.0, 22.0, -10.0, -180.0, -464.0, 19.0, 4.0, -8.0, -5.0, 15.0, -77.0, 0.0, 16.0, -82.0, -230.0, -93.0, -222.0, 7.0, -7.0, -18.0, -7.0, -6.0, 14.0, 8.0, 15.0, -105.0, -117.0, 15.0, 16.0, 1.0, -302.0, -124.0, -185.0, 12.0, -173.0, 0.0, -492.0, 0.0, 17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -16.0, 2.0, 0.0, -114.0, -178.0, 0.0, 10.0, 0.0, 0.0, -4.0, -152.0, 0.0, 15.0, -144.0, 0.0, -16.0, 17.0, 0.0, -14.0, 6.0, -6.0, 0.0, 2.0, 14.0, 12.0, 0.0, -34.0, 0.0, 13.0, -9.0, -12.0, -18.0, 11.0, 0.0, 11.0, 0.0, 15.0, -14.0, -8.0, 9.0, 6.0, -33.0, -6.0, -2.0, 0.0, 6.0, -20.0, 0.0, 17.0, -16.0, 0.0, -33.0, 8.0, 0.0, -24.0, -30.0, -23.0, -23.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, -6.0, -22.0, -8.0, -4.0, 1.0, -61.0, 0.0, -286.0, -364.0, -18.0, 0.0, -217.0, -372.0, 0.0, -12.0, 3.0, 20.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, -4.0, -2.0, 0.0, -62.0, 0.0, 0.0, 3.0, 0.0, -4.0, 0.0, 0.0, 0.0, -17.0, 0.0, -152.0, 14.0, 0.0, 0.0, -24.0, 12.0, 12.0, 16.0, 0.0, 13.0, -18.0, 0.0, 5.0, 0.0, -92.0, -132.0, 0.0, 0.0, 3.0, 13.0, 0.0, -20.0, -205.0, -87.0, -392.0, -268.0, 19.0, 0.0, 0.0, 4.0, -16.0, 0.0, 0.0, -13.0, 13.0, 2.0, -32.0, -140.0, 0.0, 0.0, 16.0, 0.0, 0.0, -164.0, -182.0, -160.0, -186.0, 0.0, -154.0, -147.0, 1.0, 6.0, -14.0, 0.0, 13.0, -62.0, 0.0, -19.0, 1.0, -48.0, 8.0, 6.0, 7.0, 0.0, 0.0, 15.0, -210.0, -9.0, 0.0, -249.0, 2.0, 12.0, 15.0, 1.0, 0.0, 1.0, -183.0, -368.0, -248.0, 0.0, -372.0, 0.0, 16.0, -8.0, -382.0, 16.0, 0.0, 0.0, -326.0, -332.0, 0.0, 0.0, 15.0, 2.0], "policy_predator_policy_reward": [0.0, 8.0, 0.0, 0.0, 101.0, 0.0, 0.0, 0.0, 8.0, 0.0, 77.0, 1.0, 0.0, 0.0, 8.0, 64.0, 4.0, 11.0, 7.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 13.0, 13.0, 0.0, 0.0, 0.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 6.0, 18.0, 0.0, 1.0, 10.0, 0.0, 0.0, 5.0, 0.0, 8.0, 14.0, 12.0, 0.0, 12.0, 12.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 15.0, 0.0, 2.0, 38.0, 25.0, 5.0, 177.0, 9.0, 0.0, 179.0, 11.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 72.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 100.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 112.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 76.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 82.0, 99.0, 13.0, 0.0, 93.0, 0.0, 79.0, 0.0, 0.0, 0.0, 7.0, 0.0, 31.0, 8.0, 4.0, 17.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 9.0, 105.0, 4.0, 128.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 58.0, 0.0, 124.0, 1.0, 186.0, 4.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 166.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9544104685105188, "mean_inference_ms": 2.529599858667823, "mean_action_processing_ms": 0.46739696002922687, "mean_env_wait_ms": 0.34786507272174744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004302382469177246, "StateBufferConnector_ms": 0.004203319549560547, "ViewRequirementAgentConnector_ms": 0.15334701538085938}, "num_episodes": 22, "episode_return_max": 28.0, "episode_return_min": -492.0, "episode_return_mean": -40.57, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.8627963002004, "num_env_steps_trained_throughput_per_sec": 310.8627963002004, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 12978.02, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12977.937, "sample_time_ms": 1564.061, "learn_time_ms": 11394.681, "learn_throughput": 351.041, "synch_weights_time_ms": 14.396}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "e1352_00000", "date": "2024-08-13_16-54-32", "timestamp": 1723582472, "time_this_iter_s": 12.919739961624146, "time_total_s": 992.2180166244507, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1639e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 992.2180166244507, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 64.56666666666666, "ram_util_percent": 83.3611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.73486244251173, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 0.009999999999999998, "total_loss": 1.9948331970386404, "policy_loss": 0.0006290182606785228, "vf_loss": 1.9821582507204127, "vf_explained_var": 0.014904536866637135, "kl": 0.014100400471857507, "entropy": 0.32261881902419703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.736216341091133, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 0.009999999999999998, "total_loss": 2.834696058495335, "policy_loss": 0.002453467334995155, "vf_loss": 2.823026987295302, "vf_explained_var": -3.27983230510086e-09, "kl": 0.010787350588374621, "entropy": 0.0786797633583158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -560.0, "episode_reward_mean": -57.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -50.125, "predator_policy": 21.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -6.0, 15.0, -15.0, -1.0, -4.0, 22.0, -8.0, 1.0, -12.0, -28.0, -11.0, 0.0, 3.0, 0.0, -2.0, -15.0, -1.0, 2.0, -468.0, -9.0, -399.0, -1.0, 23.0, 0.0, 0.0, 16.0, 0.0, -3.0, -31.0, 0.0, 3.0, -2.0, 0.0, -6.0, -56.0, 0.0, 0.0, 28.0, 13.0, -6.0, 5.0, -123.0, 0.0, 22.0, -10.0, -180.0, -464.0, 19.0, 4.0, -8.0, -5.0, 15.0, -77.0, 0.0, 16.0, -82.0, -230.0, -93.0, -222.0, 7.0, -7.0, -18.0, -7.0, -6.0, 14.0, 8.0, 15.0, -105.0, -117.0, 15.0, 16.0, 1.0, -302.0, -124.0, -185.0, 12.0, -173.0, 0.0, -492.0, 0.0, 17.0, -560.0, -2.0, 6.0, 15.0, 20.0, 0.0, -5.0, -325.0, 2.0, 0.0, -374.0, -86.0, -6.0, -139.0, -169.0, 21.0, 9.0, -372.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 15.0, -14.0, -8.0, 9.0, 6.0, -33.0, -6.0, -2.0, 0.0, 6.0, -20.0, 0.0, 17.0, -16.0, 0.0, -33.0, 8.0, 0.0, -24.0, -30.0, -23.0, -23.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, -6.0, -22.0, -8.0, -4.0, 1.0, -61.0, 0.0, -286.0, -364.0, -18.0, 0.0, -217.0, -372.0, 0.0, -12.0, 3.0, 20.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, -4.0, -2.0, 0.0, -62.0, 0.0, 0.0, 3.0, 0.0, -4.0, 0.0, 0.0, 0.0, -17.0, 0.0, -152.0, 14.0, 0.0, 0.0, -24.0, 12.0, 12.0, 16.0, 0.0, 13.0, -18.0, 0.0, 5.0, 0.0, -92.0, -132.0, 0.0, 0.0, 3.0, 13.0, 0.0, -20.0, -205.0, -87.0, -392.0, -268.0, 19.0, 0.0, 0.0, 4.0, -16.0, 0.0, 0.0, -13.0, 13.0, 2.0, -32.0, -140.0, 0.0, 0.0, 16.0, 0.0, 0.0, -164.0, -182.0, -160.0, -186.0, 0.0, -154.0, -147.0, 1.0, 6.0, -14.0, 0.0, 13.0, -62.0, 0.0, -19.0, 1.0, -48.0, 8.0, 6.0, 7.0, 0.0, 0.0, 15.0, -210.0, -9.0, 0.0, -249.0, 2.0, 12.0, 15.0, 1.0, 0.0, 1.0, -183.0, -368.0, -248.0, 0.0, -372.0, 0.0, 16.0, -8.0, -382.0, 16.0, 0.0, 0.0, -326.0, -332.0, 0.0, 0.0, 15.0, 2.0, -360.0, -400.0, -4.0, 0.0, 0.0, 6.0, 0.0, 15.0, 15.0, 5.0, 0.0, 0.0, 0.0, -11.0, -370.0, -296.0, 2.0, 0.0, 0.0, 0.0, -281.0, -245.0, -13.0, -166.0, 0.0, -12.0, -286.0, 0.0, 0.0, -352.0, 7.0, 14.0, 9.0, 0.0, -400.0, -172.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 6.0, 18.0, 0.0, 1.0, 10.0, 0.0, 0.0, 5.0, 0.0, 8.0, 14.0, 12.0, 0.0, 12.0, 12.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 15.0, 0.0, 2.0, 38.0, 25.0, 5.0, 177.0, 9.0, 0.0, 179.0, 11.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 72.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 100.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 112.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 76.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 82.0, 99.0, 13.0, 0.0, 93.0, 0.0, 79.0, 0.0, 0.0, 0.0, 7.0, 0.0, 31.0, 8.0, 4.0, 17.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 9.0, 105.0, 4.0, 128.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 58.0, 0.0, 124.0, 1.0, 186.0, 4.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 166.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 189.0, 152.0, 0.0, 0.0, 0.0, 0.0, 152.0, 0.0, 10.0, 83.0, 6.0, 0.0, 0.0, 147.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9539742372631125, "mean_inference_ms": 2.5245215528110645, "mean_action_processing_ms": 0.46555152506037845, "mean_env_wait_ms": 0.3474976322407909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044144392013549805, "StateBufferConnector_ms": 0.004133343696594238, "ViewRequirementAgentConnector_ms": 0.15290451049804688}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -560.0, "episode_return_mean": -57.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.99700033761417, "num_env_steps_trained_throughput_per_sec": 302.99700033761417, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 13017.848, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13017.764, "sample_time_ms": 1562.828, "learn_time_ms": 11435.515, "learn_throughput": 349.787, "synch_weights_time_ms": 14.495}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "e1352_00000", "date": "2024-08-13_16-54-46", "timestamp": 1723582486, "time_this_iter_s": 13.263750076293945, "time_total_s": 1005.4817667007446, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b163b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1005.4817667007446, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 66.02631578947368, "ram_util_percent": 83.32631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6779125920363835, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 0.009999999999999998, "total_loss": 2.3071063707745263, "policy_loss": 0.0023790154096093915, "vf_loss": 2.2837314065171297, "vf_explained_var": 0.03285512463756339, "kl": 0.024576874384498248, "entropy": 0.3299572241152563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0354212489097363, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 0.009999999999999998, "total_loss": 2.3998856416139653, "policy_loss": 0.0020081409248252392, "vf_loss": 2.383239000058048, "vf_explained_var": -5.3928011939639136e-09, "kl": 0.01713514520579591, "entropy": 0.03160624440663311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -560.0, "episode_reward_mean": -67.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -59.905, "predator_policy": 26.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 0.0, 0.0, 16.0, 0.0, -3.0, -31.0, 0.0, 3.0, -2.0, 0.0, -6.0, -56.0, 0.0, 0.0, 28.0, 13.0, -6.0, 5.0, -123.0, 0.0, 22.0, -10.0, -180.0, -464.0, 19.0, 4.0, -8.0, -5.0, 15.0, -77.0, 0.0, 16.0, -82.0, -230.0, -93.0, -222.0, 7.0, -7.0, -18.0, -7.0, -6.0, 14.0, 8.0, 15.0, -105.0, -117.0, 15.0, 16.0, 1.0, -302.0, -124.0, -185.0, 12.0, -173.0, 0.0, -492.0, 0.0, 17.0, -560.0, -2.0, 6.0, 15.0, 20.0, 0.0, -5.0, -325.0, 2.0, 0.0, -374.0, -86.0, -6.0, -139.0, -169.0, 21.0, 9.0, -372.0, -13.0, -2.0, -53.0, -173.0, 5.0, -165.0, -8.0, -130.0, -71.0, 15.0, 0.0, 8.0, -200.0, -198.0, 7.0, 7.0, -189.0, -8.0, -7.0, -131.0, -558.0, -6.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, 20.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, -4.0, -2.0, 0.0, -62.0, 0.0, 0.0, 3.0, 0.0, -4.0, 0.0, 0.0, 0.0, -17.0, 0.0, -152.0, 14.0, 0.0, 0.0, -24.0, 12.0, 12.0, 16.0, 0.0, 13.0, -18.0, 0.0, 5.0, 0.0, -92.0, -132.0, 0.0, 0.0, 3.0, 13.0, 0.0, -20.0, -205.0, -87.0, -392.0, -268.0, 19.0, 0.0, 0.0, 4.0, -16.0, 0.0, 0.0, -13.0, 13.0, 2.0, -32.0, -140.0, 0.0, 0.0, 16.0, 0.0, 0.0, -164.0, -182.0, -160.0, -186.0, 0.0, -154.0, -147.0, 1.0, 6.0, -14.0, 0.0, 13.0, -62.0, 0.0, -19.0, 1.0, -48.0, 8.0, 6.0, 7.0, 0.0, 0.0, 15.0, -210.0, -9.0, 0.0, -249.0, 2.0, 12.0, 15.0, 1.0, 0.0, 1.0, -183.0, -368.0, -248.0, 0.0, -372.0, 0.0, 16.0, -8.0, -382.0, 16.0, 0.0, 0.0, -326.0, -332.0, 0.0, 0.0, 15.0, 2.0, -360.0, -400.0, -4.0, 0.0, 0.0, 6.0, 0.0, 15.0, 15.0, 5.0, 0.0, 0.0, 0.0, -11.0, -370.0, -296.0, 2.0, 0.0, 0.0, 0.0, -281.0, -245.0, -13.0, -166.0, 0.0, -12.0, -286.0, 0.0, 0.0, -352.0, 7.0, 14.0, 9.0, 0.0, -400.0, -172.0, 2.0, -30.0, -6.0, 0.0, -86.0, -20.0, -359.0, 0.0, 0.0, 5.0, 0.0, -345.0, 0.0, -18.0, -260.0, 0.0, -142.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 8.0, -400.0, 0.0, -400.0, -8.0, 2.0, 0.0, 0.0, 7.0, -400.0, 11.0, 4.0, -25.0, -35.0, 8.0, 0.0, -262.0, -390.0, -368.0, 0.0, -12.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 72.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 100.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 112.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 76.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 82.0, 99.0, 13.0, 0.0, 93.0, 0.0, 79.0, 0.0, 0.0, 0.0, 7.0, 0.0, 31.0, 8.0, 4.0, 17.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 9.0, 105.0, 4.0, 128.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 58.0, 0.0, 124.0, 1.0, 186.0, 4.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 166.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 189.0, 152.0, 0.0, 0.0, 0.0, 0.0, 152.0, 0.0, 10.0, 83.0, 6.0, 0.0, 0.0, 147.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 5.0, 0.0, 4.0, 43.0, 10.0, 186.0, 0.0, 0.0, 0.0, 0.0, 180.0, 10.0, 0.0, 130.0, 0.0, 3.0, 68.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 10.0, 0.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 13.0, 9.0, 11.0, 0.0, 131.0, 0.0, 200.0, 6.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.95269191220062, "mean_inference_ms": 2.5192319616335506, "mean_action_processing_ms": 0.4632143708913075, "mean_env_wait_ms": 0.3465087821817587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009257674217224121, "StateBufferConnector_ms": 0.004256248474121094, "ViewRequirementAgentConnector_ms": 0.16280794143676758}, "num_episodes": 23, "episode_return_max": 28.0, "episode_return_min": -560.0, "episode_return_mean": -67.0, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.1628730366292, "num_env_steps_trained_throughput_per_sec": 311.1628730366292, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 12971.682, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12971.624, "sample_time_ms": 1574.375, "learn_time_ms": 11378.997, "learn_throughput": 351.525, "synch_weights_time_ms": 13.94}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "e1352_00000", "date": "2024-08-13_16-54-59", "timestamp": 1723582499, "time_this_iter_s": 12.927326917648315, "time_total_s": 1018.409093618393, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1629ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1018.409093618393, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 66.48333333333332, "ram_util_percent": 83.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.345264437589696, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 0.009999999999999998, "total_loss": 2.7249293650899613, "policy_loss": 0.00015260930821082736, "vf_loss": 2.7112794924034644, "vf_explained_var": 0.08198989163000117, "kl": 0.010532844328061584, "entropy": 0.26675739421179057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9209807308873645, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 0.009999999999999998, "total_loss": 3.4742648916900474, "policy_loss": 0.0028770878452748535, "vf_loss": 3.4612583895839713, "vf_explained_var": -8.041896517314608e-09, "kl": 0.011857019941438788, "entropy": 0.05881773878571318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -598.0, "episode_reward_mean": -82.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -74.165, "predator_policy": 32.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, -123.0, 0.0, 22.0, -10.0, -180.0, -464.0, 19.0, 4.0, -8.0, -5.0, 15.0, -77.0, 0.0, 16.0, -82.0, -230.0, -93.0, -222.0, 7.0, -7.0, -18.0, -7.0, -6.0, 14.0, 8.0, 15.0, -105.0, -117.0, 15.0, 16.0, 1.0, -302.0, -124.0, -185.0, 12.0, -173.0, 0.0, -492.0, 0.0, 17.0, -560.0, -2.0, 6.0, 15.0, 20.0, 0.0, -5.0, -325.0, 2.0, 0.0, -374.0, -86.0, -6.0, -139.0, -169.0, 21.0, 9.0, -372.0, -13.0, -2.0, -53.0, -173.0, 5.0, -165.0, -8.0, -130.0, -71.0, 15.0, 0.0, 8.0, -200.0, -198.0, 7.0, 7.0, -189.0, -8.0, -7.0, -131.0, -558.0, -6.0, 0.0, -178.0, 30.0, -1.0, 13.0, 0.0, -15.0, -7.0, -264.0, -73.0, 0.0, 0.0, -8.0, -185.0, 5.0, -179.0, -127.0, -5.0, -598.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 0.0, -92.0, -132.0, 0.0, 0.0, 3.0, 13.0, 0.0, -20.0, -205.0, -87.0, -392.0, -268.0, 19.0, 0.0, 0.0, 4.0, -16.0, 0.0, 0.0, -13.0, 13.0, 2.0, -32.0, -140.0, 0.0, 0.0, 16.0, 0.0, 0.0, -164.0, -182.0, -160.0, -186.0, 0.0, -154.0, -147.0, 1.0, 6.0, -14.0, 0.0, 13.0, -62.0, 0.0, -19.0, 1.0, -48.0, 8.0, 6.0, 7.0, 0.0, 0.0, 15.0, -210.0, -9.0, 0.0, -249.0, 2.0, 12.0, 15.0, 1.0, 0.0, 1.0, -183.0, -368.0, -248.0, 0.0, -372.0, 0.0, 16.0, -8.0, -382.0, 16.0, 0.0, 0.0, -326.0, -332.0, 0.0, 0.0, 15.0, 2.0, -360.0, -400.0, -4.0, 0.0, 0.0, 6.0, 0.0, 15.0, 15.0, 5.0, 0.0, 0.0, 0.0, -11.0, -370.0, -296.0, 2.0, 0.0, 0.0, 0.0, -281.0, -245.0, -13.0, -166.0, 0.0, -12.0, -286.0, 0.0, 0.0, -352.0, 7.0, 14.0, 9.0, 0.0, -400.0, -172.0, 2.0, -30.0, -6.0, 0.0, -86.0, -20.0, -359.0, 0.0, 0.0, 5.0, 0.0, -345.0, 0.0, -18.0, -260.0, 0.0, -142.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 8.0, -400.0, 0.0, -400.0, -8.0, 2.0, 0.0, 0.0, 7.0, -400.0, 11.0, 4.0, -25.0, -35.0, 8.0, 0.0, -262.0, -390.0, -368.0, 0.0, -12.0, 0.0, 0.0, 0.0, -356.0, 15.0, 15.0, 0.0, -2.0, 0.0, 13.0, 0.0, 0.0, 16.0, -62.0, -20.0, 2.0, -382.0, -262.0, 0.0, -158.0, 3.0, -6.0, 0.0, 0.0, 0.0, -16.0, -400.0, 15.0, 5.0, 0.0, -368.0, 0.0, 11.0, -276.0, -15.0, 0.0, -398.0, -400.0], "policy_predator_policy_reward": [0.0, 0.0, 1.0, 100.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 112.0, 0.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 76.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 82.0, 99.0, 13.0, 0.0, 93.0, 0.0, 79.0, 0.0, 0.0, 0.0, 7.0, 0.0, 31.0, 8.0, 4.0, 17.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 9.0, 105.0, 4.0, 128.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 58.0, 0.0, 124.0, 1.0, 186.0, 4.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 166.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 189.0, 152.0, 0.0, 0.0, 0.0, 0.0, 152.0, 0.0, 10.0, 83.0, 6.0, 0.0, 0.0, 147.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 5.0, 0.0, 4.0, 43.0, 10.0, 186.0, 0.0, 0.0, 0.0, 0.0, 180.0, 10.0, 0.0, 130.0, 0.0, 3.0, 68.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 10.0, 0.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 13.0, 9.0, 11.0, 0.0, 131.0, 0.0, 200.0, 6.0, 0.0, 0.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 10.0, 1.0, 189.0, 191.0, 82.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 200.0, 0.0, 0.0, 0.0, 189.0, 0.0, 138.0, 0.0, 10.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9509468242642041, "mean_inference_ms": 2.514067505576816, "mean_action_processing_ms": 0.4613662667861941, "mean_env_wait_ms": 0.34550078389338473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00947868824005127, "StateBufferConnector_ms": 0.004276275634765625, "ViewRequirementAgentConnector_ms": 0.14825820922851562}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -598.0, "episode_return_mean": -82.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.3994931958221, "num_env_steps_trained_throughput_per_sec": 311.3994931958221, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 12998.842, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12998.786, "sample_time_ms": 1572.728, "learn_time_ms": 11407.805, "learn_throughput": 350.637, "synch_weights_time_ms": 13.625}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "e1352_00000", "date": "2024-08-13_16-55-12", "timestamp": 1723582512, "time_this_iter_s": 12.90331506729126, "time_total_s": 1031.3124086856842, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16295e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1031.3124086856842, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 63.47222222222222, "ram_util_percent": 83.48333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3502865303130376, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 0.009999999999999998, "total_loss": 1.9541164615797617, "policy_loss": -6.853460516563798e-05, "vf_loss": 1.9451232438995725, "vf_explained_var": 0.1612138968296152, "kl": 0.007071512595703594, "entropy": 0.22535019343492216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0335984266146268, "cur_kl_coeff": 0.8542968749999997, "cur_lr": 0.009999999999999998, "total_loss": 2.193196022478992, "policy_loss": 0.0003600152771151255, "vf_loss": 2.192197743925468, "vf_explained_var": -7.09579104468936e-09, "kl": 0.000747116802879706, "entropy": 0.008839200510676415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -598.0, "episode_reward_mean": -89.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -80.655, "predator_policy": 35.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-222.0, 7.0, -7.0, -18.0, -7.0, -6.0, 14.0, 8.0, 15.0, -105.0, -117.0, 15.0, 16.0, 1.0, -302.0, -124.0, -185.0, 12.0, -173.0, 0.0, -492.0, 0.0, 17.0, -560.0, -2.0, 6.0, 15.0, 20.0, 0.0, -5.0, -325.0, 2.0, 0.0, -374.0, -86.0, -6.0, -139.0, -169.0, 21.0, 9.0, -372.0, -13.0, -2.0, -53.0, -173.0, 5.0, -165.0, -8.0, -130.0, -71.0, 15.0, 0.0, 8.0, -200.0, -198.0, 7.0, 7.0, -189.0, -8.0, -7.0, -131.0, -558.0, -6.0, 0.0, -178.0, 30.0, -1.0, 13.0, 0.0, -15.0, -7.0, -264.0, -73.0, 0.0, 0.0, -8.0, -185.0, 5.0, -179.0, -127.0, -5.0, -598.0, -519.0, -315.0, -2.0, -521.0, -182.0, 0.0, -66.0, -7.0, -108.0, 0.0, 16.0, -1.0, -190.0, -31.0, 0.0, 4.0, 0.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-154.0, -147.0, 1.0, 6.0, -14.0, 0.0, 13.0, -62.0, 0.0, -19.0, 1.0, -48.0, 8.0, 6.0, 7.0, 0.0, 0.0, 15.0, -210.0, -9.0, 0.0, -249.0, 2.0, 12.0, 15.0, 1.0, 0.0, 1.0, -183.0, -368.0, -248.0, 0.0, -372.0, 0.0, 16.0, -8.0, -382.0, 16.0, 0.0, 0.0, -326.0, -332.0, 0.0, 0.0, 15.0, 2.0, -360.0, -400.0, -4.0, 0.0, 0.0, 6.0, 0.0, 15.0, 15.0, 5.0, 0.0, 0.0, 0.0, -11.0, -370.0, -296.0, 2.0, 0.0, 0.0, 0.0, -281.0, -245.0, -13.0, -166.0, 0.0, -12.0, -286.0, 0.0, 0.0, -352.0, 7.0, 14.0, 9.0, 0.0, -400.0, -172.0, 2.0, -30.0, -6.0, 0.0, -86.0, -20.0, -359.0, 0.0, 0.0, 5.0, 0.0, -345.0, 0.0, -18.0, -260.0, 0.0, -142.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 8.0, -400.0, 0.0, -400.0, -8.0, 2.0, 0.0, 0.0, 7.0, -400.0, 11.0, 4.0, -25.0, -35.0, 8.0, 0.0, -262.0, -390.0, -368.0, 0.0, -12.0, 0.0, 0.0, 0.0, -356.0, 15.0, 15.0, 0.0, -2.0, 0.0, 13.0, 0.0, 0.0, 16.0, -62.0, -20.0, 2.0, -382.0, -262.0, 0.0, -158.0, 3.0, -6.0, 0.0, 0.0, 0.0, -16.0, -400.0, 15.0, 5.0, 0.0, -368.0, 0.0, 11.0, -276.0, -15.0, 0.0, -398.0, -400.0, -346.0, -346.0, -278.0, -363.0, -6.0, -10.0, -349.0, -358.0, -364.0, 0.0, 0.0, 0.0, -122.0, -14.0, -22.0, -16.0, 0.0, -286.0, 0.0, 0.0, 16.0, 0.0, -6.0, 0.0, 0.0, -385.0, -4.0, -64.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 0.0], "policy_predator_policy_reward": [0.0, 79.0, 0.0, 0.0, 0.0, 7.0, 0.0, 31.0, 8.0, 4.0, 17.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 9.0, 105.0, 4.0, 128.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 58.0, 0.0, 124.0, 1.0, 186.0, 4.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 166.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 189.0, 152.0, 0.0, 0.0, 0.0, 0.0, 152.0, 0.0, 10.0, 83.0, 6.0, 0.0, 0.0, 147.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 5.0, 0.0, 4.0, 43.0, 10.0, 186.0, 0.0, 0.0, 0.0, 0.0, 180.0, 10.0, 0.0, 130.0, 0.0, 3.0, 68.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 10.0, 0.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 13.0, 9.0, 11.0, 0.0, 131.0, 0.0, 200.0, 6.0, 0.0, 0.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 10.0, 1.0, 189.0, 191.0, 82.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 200.0, 0.0, 0.0, 0.0, 189.0, 0.0, 138.0, 0.0, 10.0, 0.0, 200.0, 173.0, 0.0, 187.0, 139.0, 11.0, 3.0, 0.0, 186.0, 0.0, 182.0, 0.0, 0.0, 70.0, 0.0, 16.0, 15.0, 35.0, 143.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 195.0, 35.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9478519418263293, "mean_inference_ms": 2.5062566862362496, "mean_action_processing_ms": 0.4591244265137856, "mean_env_wait_ms": 0.34422265262709684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010113358497619629, "StateBufferConnector_ms": 0.004255175590515137, "ViewRequirementAgentConnector_ms": 0.13003194332122803}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -598.0, "episode_return_mean": -89.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.05748505824874, "num_env_steps_trained_throughput_per_sec": 305.05748505824874, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 13023.133, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13023.076, "sample_time_ms": 1577.915, "learn_time_ms": 11427.328, "learn_throughput": 350.038, "synch_weights_time_ms": 13.606}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "e1352_00000", "date": "2024-08-13_16-55-25", "timestamp": 1723582525, "time_this_iter_s": 13.167371988296509, "time_total_s": 1044.4797806739807, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1608940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1044.4797806739807, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 62.81052631578947, "ram_util_percent": 83.38421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7638006510557953, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 0.009999999999999998, "total_loss": 0.7446429030762778, "policy_loss": 0.00018066462971979663, "vf_loss": 0.7384230355027491, "vf_explained_var": 0.24589402344491745, "kl": 0.004712807104798859, "entropy": 0.274614766650099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6565801843142176, "cur_kl_coeff": 0.42714843749999987, "cur_lr": 0.009999999999999998, "total_loss": 1.3065265145409044, "policy_loss": -3.728803848384549e-05, "vf_loss": 1.3046570159140087, "vf_explained_var": -4.541306268601191e-09, "kl": 0.004463988353849127, "entropy": 0.013973716058313174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -598.0, "episode_reward_mean": -78.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -71.495, "predator_policy": 32.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, -560.0, -2.0, 6.0, 15.0, 20.0, 0.0, -5.0, -325.0, 2.0, 0.0, -374.0, -86.0, -6.0, -139.0, -169.0, 21.0, 9.0, -372.0, -13.0, -2.0, -53.0, -173.0, 5.0, -165.0, -8.0, -130.0, -71.0, 15.0, 0.0, 8.0, -200.0, -198.0, 7.0, 7.0, -189.0, -8.0, -7.0, -131.0, -558.0, -6.0, 0.0, -178.0, 30.0, -1.0, 13.0, 0.0, -15.0, -7.0, -264.0, -73.0, 0.0, 0.0, -8.0, -185.0, 5.0, -179.0, -127.0, -5.0, -598.0, -519.0, -315.0, -2.0, -521.0, -182.0, 0.0, -66.0, -7.0, -108.0, 0.0, 16.0, -1.0, -190.0, -31.0, 0.0, 4.0, 0.0, 11.0, 10.0, 15.0, 0.0, -6.0, 6.0, -28.0, -165.0, 8.0, 6.0, -10.0, 7.0, 15.0, -10.0, 18.0, 0.0, -22.0, -196.0, -192.0, 0.0, 3.0, 15.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 2.0, -360.0, -400.0, -4.0, 0.0, 0.0, 6.0, 0.0, 15.0, 15.0, 5.0, 0.0, 0.0, 0.0, -11.0, -370.0, -296.0, 2.0, 0.0, 0.0, 0.0, -281.0, -245.0, -13.0, -166.0, 0.0, -12.0, -286.0, 0.0, 0.0, -352.0, 7.0, 14.0, 9.0, 0.0, -400.0, -172.0, 2.0, -30.0, -6.0, 0.0, -86.0, -20.0, -359.0, 0.0, 0.0, 5.0, 0.0, -345.0, 0.0, -18.0, -260.0, 0.0, -142.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 8.0, -400.0, 0.0, -400.0, -8.0, 2.0, 0.0, 0.0, 7.0, -400.0, 11.0, 4.0, -25.0, -35.0, 8.0, 0.0, -262.0, -390.0, -368.0, 0.0, -12.0, 0.0, 0.0, 0.0, -356.0, 15.0, 15.0, 0.0, -2.0, 0.0, 13.0, 0.0, 0.0, 16.0, -62.0, -20.0, 2.0, -382.0, -262.0, 0.0, -158.0, 3.0, -6.0, 0.0, 0.0, 0.0, -16.0, -400.0, 15.0, 5.0, 0.0, -368.0, 0.0, 11.0, -276.0, -15.0, 0.0, -398.0, -400.0, -346.0, -346.0, -278.0, -363.0, -6.0, -10.0, -349.0, -358.0, -364.0, 0.0, 0.0, 0.0, -122.0, -14.0, -22.0, -16.0, 0.0, -286.0, 0.0, 0.0, 16.0, 0.0, -6.0, 0.0, 0.0, -385.0, -4.0, -64.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -12.0, 1.0, 1.0, 1.0, -58.0, 0.0, -330.0, -1.0, 5.0, 6.0, 0.0, -10.0, -15.0, -6.0, 10.0, 15.0, 0.0, 0.0, -20.0, 6.0, 12.0, 0.0, 0.0, -15.0, -20.0, 2.0, -396.0, -360.0, -21.0, 0.0, 0.0, 3.0, 0.0, 2.0, 11.0, 0.0, -12.0], "policy_predator_policy_reward": [0.0, 0.0, 200.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 189.0, 152.0, 0.0, 0.0, 0.0, 0.0, 152.0, 0.0, 10.0, 83.0, 6.0, 0.0, 0.0, 147.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 5.0, 0.0, 4.0, 43.0, 10.0, 186.0, 0.0, 0.0, 0.0, 0.0, 180.0, 10.0, 0.0, 130.0, 0.0, 3.0, 68.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 10.0, 0.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 13.0, 9.0, 11.0, 0.0, 131.0, 0.0, 200.0, 6.0, 0.0, 0.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 10.0, 1.0, 189.0, 191.0, 82.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 200.0, 0.0, 0.0, 0.0, 189.0, 0.0, 138.0, 0.0, 10.0, 0.0, 200.0, 173.0, 0.0, 187.0, 139.0, 11.0, 3.0, 0.0, 186.0, 0.0, 182.0, 0.0, 0.0, 70.0, 0.0, 16.0, 15.0, 35.0, 143.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 195.0, 35.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 0.0, 29.0, 0.0, 165.0, 0.0, 4.0, 0.0, 0.0, 10.0, 5.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 198.0, 0.0, 3.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9442748085056902, "mean_inference_ms": 2.4961528862077222, "mean_action_processing_ms": 0.4564173562644558, "mean_env_wait_ms": 0.3426393195189722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011397361755371094, "StateBufferConnector_ms": 0.005129694938659668, "ViewRequirementAgentConnector_ms": 0.1331261396408081}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -598.0, "episode_return_mean": -78.49, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.96020928751807, "num_env_steps_trained_throughput_per_sec": 311.96020928751807, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 13037.178, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13037.119, "sample_time_ms": 1592.081, "learn_time_ms": 11427.019, "learn_throughput": 350.048, "synch_weights_time_ms": 13.686}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "e1352_00000", "date": "2024-08-13_16-55-38", "timestamp": 1723582538, "time_this_iter_s": 12.871031045913696, "time_total_s": 1057.3508117198944, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1713430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1057.3508117198944, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 64.95, "ram_util_percent": 83.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4077765283603516, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.599762499143207, "policy_loss": 0.0006094551142600793, "vf_loss": 1.5900941073894501, "vf_explained_var": 0.13871688101657484, "kl": 0.014138620530085489, "entropy": 0.25822763733132176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.208323538915387, "cur_kl_coeff": 0.21357421874999993, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.0011755763437283574, "vf_loss": 2.150043547531915, "vf_explained_var": -6.2758329684141455e-09, "kl": Infinity, "entropy": 0.00905504270808993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -598.0, "episode_reward_mean": -75.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -68.505, "predator_policy": 30.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, -165.0, -8.0, -130.0, -71.0, 15.0, 0.0, 8.0, -200.0, -198.0, 7.0, 7.0, -189.0, -8.0, -7.0, -131.0, -558.0, -6.0, 0.0, -178.0, 30.0, -1.0, 13.0, 0.0, -15.0, -7.0, -264.0, -73.0, 0.0, 0.0, -8.0, -185.0, 5.0, -179.0, -127.0, -5.0, -598.0, -519.0, -315.0, -2.0, -521.0, -182.0, 0.0, -66.0, -7.0, -108.0, 0.0, 16.0, -1.0, -190.0, -31.0, 0.0, 4.0, 0.0, 11.0, 10.0, 15.0, 0.0, -6.0, 6.0, -28.0, -165.0, 8.0, 6.0, -10.0, 7.0, 15.0, -10.0, 18.0, 0.0, -22.0, -196.0, -192.0, 0.0, 3.0, 15.0, -2.0, 30.0, -580.0, -22.0, 13.0, 0.0, 0.0, -585.0, 4.0, -12.0, -11.0, -6.0, 20.0, 0.0, 12.0, -4.0, 14.0, 8.0, 0.0, -180.0, -10.0, -1.0, -594.0, -23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 5.0, 0.0, -345.0, 0.0, -18.0, -260.0, 0.0, -142.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 8.0, -400.0, 0.0, -400.0, -8.0, 2.0, 0.0, 0.0, 7.0, -400.0, 11.0, 4.0, -25.0, -35.0, 8.0, 0.0, -262.0, -390.0, -368.0, 0.0, -12.0, 0.0, 0.0, 0.0, -356.0, 15.0, 15.0, 0.0, -2.0, 0.0, 13.0, 0.0, 0.0, 16.0, -62.0, -20.0, 2.0, -382.0, -262.0, 0.0, -158.0, 3.0, -6.0, 0.0, 0.0, 0.0, -16.0, -400.0, 15.0, 5.0, 0.0, -368.0, 0.0, 11.0, -276.0, -15.0, 0.0, -398.0, -400.0, -346.0, -346.0, -278.0, -363.0, -6.0, -10.0, -349.0, -358.0, -364.0, 0.0, 0.0, 0.0, -122.0, -14.0, -22.0, -16.0, 0.0, -286.0, 0.0, 0.0, 16.0, 0.0, -6.0, 0.0, 0.0, -385.0, -4.0, -64.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -12.0, 1.0, 1.0, 1.0, -58.0, 0.0, -330.0, -1.0, 5.0, 6.0, 0.0, -10.0, -15.0, -6.0, 10.0, 15.0, 0.0, 0.0, -20.0, 6.0, 12.0, 0.0, 0.0, -15.0, -20.0, 2.0, -396.0, -360.0, -21.0, 0.0, 0.0, 3.0, 0.0, 2.0, 11.0, 0.0, -12.0, 15.0, 15.0, -382.0, -396.0, -16.0, -19.0, 5.0, 8.0, 0.0, 0.0, 0.0, 0.0, -400.0, -385.0, 0.0, -4.0, -20.0, -4.0, 0.0, -22.0, -18.0, 2.0, 5.0, 15.0, 0.0, 0.0, 12.0, 0.0, 0.0, -8.0, 0.0, 14.0, 8.0, 0.0, 0.0, 0.0, 0.0, -369.0, 0.0, -20.0, 9.0, -30.0, -400.0, -394.0, -400.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 180.0, 10.0, 0.0, 130.0, 0.0, 3.0, 68.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 10.0, 0.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 13.0, 9.0, 11.0, 0.0, 131.0, 0.0, 200.0, 6.0, 0.0, 0.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 10.0, 1.0, 189.0, 191.0, 82.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 200.0, 0.0, 0.0, 0.0, 189.0, 0.0, 138.0, 0.0, 10.0, 0.0, 200.0, 173.0, 0.0, 187.0, 139.0, 11.0, 3.0, 0.0, 186.0, 0.0, 182.0, 0.0, 0.0, 70.0, 0.0, 16.0, 15.0, 35.0, 143.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 195.0, 35.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 0.0, 29.0, 0.0, 165.0, 0.0, 4.0, 0.0, 0.0, 10.0, 5.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 198.0, 0.0, 3.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 8.0, 0.0, 12.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 4.0, 0.0, 10.0, 10.0, 10.0, 0.0, 200.0, 177.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9412332845803251, "mean_inference_ms": 2.488112813077366, "mean_action_processing_ms": 0.45469285863418013, "mean_env_wait_ms": 0.3415720083018924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011540055274963379, "StateBufferConnector_ms": 0.004862785339355469, "ViewRequirementAgentConnector_ms": 0.13757526874542236}, "num_episodes": 23, "episode_return_max": 30.0, "episode_return_min": -598.0, "episode_return_mean": -75.87, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.3012962138002, "num_env_steps_trained_throughput_per_sec": 300.3012962138002, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 13071.501, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13071.444, "sample_time_ms": 1643.765, "learn_time_ms": 11409.289, "learn_throughput": 350.592, "synch_weights_time_ms": 13.713}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "e1352_00000", "date": "2024-08-13_16-55-51", "timestamp": 1723582551, "time_this_iter_s": 13.365383863449097, "time_total_s": 1070.7161955833435, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1713670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1070.7161955833435, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 66.45263157894738, "ram_util_percent": 83.64736842105265}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3339950688459257, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.8186688308677976, "policy_loss": 0.0004372874777468424, "vf_loss": 1.807944954450799, "vf_explained_var": 0.17101223156565712, "kl": 0.01605466683469366, "entropy": 0.2745645858347416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.183618229402909, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 0.009999999999999998, "total_loss": 2.1193334391508154, "policy_loss": 0.004281951640190546, "vf_loss": 2.0736057980666085, "vf_explained_var": -8.073433366402117e-09, "kl": 0.12937170576755558, "entropy": 0.04270290299354244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -598.0, "episode_reward_mean": -72.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -65.165, "predator_policy": 28.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -178.0, 30.0, -1.0, 13.0, 0.0, -15.0, -7.0, -264.0, -73.0, 0.0, 0.0, -8.0, -185.0, 5.0, -179.0, -127.0, -5.0, -598.0, -519.0, -315.0, -2.0, -521.0, -182.0, 0.0, -66.0, -7.0, -108.0, 0.0, 16.0, -1.0, -190.0, -31.0, 0.0, 4.0, 0.0, 11.0, 10.0, 15.0, 0.0, -6.0, 6.0, -28.0, -165.0, 8.0, 6.0, -10.0, 7.0, 15.0, -10.0, 18.0, 0.0, -22.0, -196.0, -192.0, 0.0, 3.0, 15.0, -2.0, 30.0, -580.0, -22.0, 13.0, 0.0, 0.0, -585.0, 4.0, -12.0, -11.0, -6.0, 20.0, 0.0, 12.0, -4.0, 14.0, 8.0, 0.0, -180.0, -10.0, -1.0, -594.0, -23.0, -1.0, -9.0, -36.0, 1.0, 0.0, -30.0, 12.0, -157.0, 10.0, -532.0, -6.0, 0.0, 0.0, 15.0, 13.0, 0.0, 1.0, -572.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -356.0, 15.0, 15.0, 0.0, -2.0, 0.0, 13.0, 0.0, 0.0, 16.0, -62.0, -20.0, 2.0, -382.0, -262.0, 0.0, -158.0, 3.0, -6.0, 0.0, 0.0, 0.0, -16.0, -400.0, 15.0, 5.0, 0.0, -368.0, 0.0, 11.0, -276.0, -15.0, 0.0, -398.0, -400.0, -346.0, -346.0, -278.0, -363.0, -6.0, -10.0, -349.0, -358.0, -364.0, 0.0, 0.0, 0.0, -122.0, -14.0, -22.0, -16.0, 0.0, -286.0, 0.0, 0.0, 16.0, 0.0, -6.0, 0.0, 0.0, -385.0, -4.0, -64.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -12.0, 1.0, 1.0, 1.0, -58.0, 0.0, -330.0, -1.0, 5.0, 6.0, 0.0, -10.0, -15.0, -6.0, 10.0, 15.0, 0.0, 0.0, -20.0, 6.0, 12.0, 0.0, 0.0, -15.0, -20.0, 2.0, -396.0, -360.0, -21.0, 0.0, 0.0, 3.0, 0.0, 2.0, 11.0, 0.0, -12.0, 15.0, 15.0, -382.0, -396.0, -16.0, -19.0, 5.0, 8.0, 0.0, 0.0, 0.0, 0.0, -400.0, -385.0, 0.0, -4.0, -20.0, -4.0, 0.0, -22.0, -18.0, 2.0, 5.0, 15.0, 0.0, 0.0, 12.0, 0.0, 0.0, -8.0, 0.0, 14.0, 8.0, 0.0, 0.0, 0.0, 0.0, -369.0, 0.0, -20.0, 9.0, -30.0, -400.0, -394.0, -400.0, 0.0, 4.0, -10.0, 0.0, -400.0, -66.0, -6.0, 0.0, 1.0, 0.0, 0.0, 0.0, -60.0, 12.0, 0.0, -317.0, -17.0, 0.0, 8.0, -343.0, -384.0, 2.0, -16.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, -4.0, -400.0, -372.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 178.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 31.0, 10.0, 1.0, 189.0, 191.0, 82.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 200.0, 0.0, 0.0, 0.0, 189.0, 0.0, 138.0, 0.0, 10.0, 0.0, 200.0, 173.0, 0.0, 187.0, 139.0, 11.0, 3.0, 0.0, 186.0, 0.0, 182.0, 0.0, 0.0, 70.0, 0.0, 16.0, 15.0, 35.0, 143.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 195.0, 35.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 0.0, 29.0, 0.0, 165.0, 0.0, 4.0, 0.0, 0.0, 10.0, 5.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 198.0, 0.0, 3.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 8.0, 0.0, 12.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 4.0, 0.0, 10.0, 10.0, 10.0, 0.0, 200.0, 177.0, 200.0, 0.0, 5.0, 191.0, 200.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 166.0, 11.0, 2.0, 0.0, 0.0, 195.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 200.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9391650917354133, "mean_inference_ms": 2.480799459888558, "mean_action_processing_ms": 0.45195573381769266, "mean_env_wait_ms": 0.3402160927351689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006957292556762695, "StateBufferConnector_ms": 0.004320859909057617, "ViewRequirementAgentConnector_ms": 0.12442958354949951}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -598.0, "episode_return_mean": -72.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.15426671625767, "num_env_steps_trained_throughput_per_sec": 310.15426671625767, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 13073.687, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13073.63, "sample_time_ms": 1642.641, "learn_time_ms": 11412.771, "learn_throughput": 350.485, "synch_weights_time_ms": 13.627}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "e1352_00000", "date": "2024-08-13_16-56-04", "timestamp": 1723582564, "time_this_iter_s": 12.935572862625122, "time_total_s": 1083.6517684459686, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1608940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1083.6517684459686, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 63.62105263157895, "ram_util_percent": 83.49473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3331903002407186, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.0512679689460331, "policy_loss": -9.029476469747289e-05, "vf_loss": 1.0451923485786196, "vf_explained_var": 0.08986758930342538, "kl": 0.009623376365885639, "entropy": 0.22433642833715395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3623306250091267, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 0.009999999999999998, "total_loss": 1.1948798544350125, "policy_loss": 0.001647666418708112, "vf_loss": 1.1770840007476706, "vf_explained_var": -6.938106799251818e-09, "kl": 0.03360410719651464, "entropy": 0.04734472309162806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -598.0, "episode_reward_mean": -66.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -58.985, "predator_policy": 25.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-598.0, -519.0, -315.0, -2.0, -521.0, -182.0, 0.0, -66.0, -7.0, -108.0, 0.0, 16.0, -1.0, -190.0, -31.0, 0.0, 4.0, 0.0, 11.0, 10.0, 15.0, 0.0, -6.0, 6.0, -28.0, -165.0, 8.0, 6.0, -10.0, 7.0, 15.0, -10.0, 18.0, 0.0, -22.0, -196.0, -192.0, 0.0, 3.0, 15.0, -2.0, 30.0, -580.0, -22.0, 13.0, 0.0, 0.0, -585.0, 4.0, -12.0, -11.0, -6.0, 20.0, 0.0, 12.0, -4.0, 14.0, 8.0, 0.0, -180.0, -10.0, -1.0, -594.0, -23.0, -1.0, -9.0, -36.0, 1.0, 0.0, -30.0, 12.0, -157.0, 10.0, -532.0, -6.0, 0.0, 0.0, 15.0, 13.0, 0.0, 1.0, -572.0, -9.0, 14.0, -200.0, -12.0, -18.0, 0.0, 11.0, 4.0, -116.0, 15.0, 6.0, -163.0, 0.0, 3.0, -1.0, 0.0, -1.0, 30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-398.0, -400.0, -346.0, -346.0, -278.0, -363.0, -6.0, -10.0, -349.0, -358.0, -364.0, 0.0, 0.0, 0.0, -122.0, -14.0, -22.0, -16.0, 0.0, -286.0, 0.0, 0.0, 16.0, 0.0, -6.0, 0.0, 0.0, -385.0, -4.0, -64.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -12.0, 1.0, 1.0, 1.0, -58.0, 0.0, -330.0, -1.0, 5.0, 6.0, 0.0, -10.0, -15.0, -6.0, 10.0, 15.0, 0.0, 0.0, -20.0, 6.0, 12.0, 0.0, 0.0, -15.0, -20.0, 2.0, -396.0, -360.0, -21.0, 0.0, 0.0, 3.0, 0.0, 2.0, 11.0, 0.0, -12.0, 15.0, 15.0, -382.0, -396.0, -16.0, -19.0, 5.0, 8.0, 0.0, 0.0, 0.0, 0.0, -400.0, -385.0, 0.0, -4.0, -20.0, -4.0, 0.0, -22.0, -18.0, 2.0, 5.0, 15.0, 0.0, 0.0, 12.0, 0.0, 0.0, -8.0, 0.0, 14.0, 8.0, 0.0, 0.0, 0.0, 0.0, -369.0, 0.0, -20.0, 9.0, -30.0, -400.0, -394.0, -400.0, 0.0, 4.0, -10.0, 0.0, -400.0, -66.0, -6.0, 0.0, 1.0, 0.0, 0.0, 0.0, -60.0, 12.0, 0.0, -317.0, -17.0, 0.0, 8.0, -343.0, -384.0, 2.0, -16.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, -4.0, -400.0, -372.0, -19.0, 0.0, 0.0, 14.0, -400.0, 0.0, -22.0, -2.0, -39.0, 0.0, 0.0, 0.0, 6.0, -4.0, 4.0, 0.0, 1.0, -242.0, 15.0, 0.0, 6.0, 0.0, -312.0, -14.0, 0.0, 0.0, 1.0, 0.0, -22.0, 9.0, 0.0, 0.0, 0.0, -2.0, 15.0, 15.0], "policy_predator_policy_reward": [0.0, 200.0, 173.0, 0.0, 187.0, 139.0, 11.0, 3.0, 0.0, 186.0, 0.0, 182.0, 0.0, 0.0, 70.0, 0.0, 16.0, 15.0, 35.0, 143.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 195.0, 35.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 0.0, 29.0, 0.0, 165.0, 0.0, 4.0, 0.0, 0.0, 10.0, 5.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 198.0, 0.0, 3.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 8.0, 0.0, 12.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 4.0, 0.0, 10.0, 10.0, 10.0, 0.0, 200.0, 177.0, 200.0, 0.0, 5.0, 191.0, 200.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 166.0, 11.0, 2.0, 0.0, 0.0, 195.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 12.0, 0.0, 11.0, 10.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 121.0, 4.0, 0.0, 0.0, 0.0, 0.0, 156.0, 7.0, 0.0, 0.0, 2.0, 0.0, 11.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9368968643296128, "mean_inference_ms": 2.473860130834094, "mean_action_processing_ms": 0.4499997312388669, "mean_env_wait_ms": 0.33916859209349054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006623625755310059, "StateBufferConnector_ms": 0.004247069358825684, "ViewRequirementAgentConnector_ms": 0.12428820133209229}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -598.0, "episode_return_mean": -66.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.8147457627183, "num_env_steps_trained_throughput_per_sec": 318.8147457627183, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 13032.317, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13032.261, "sample_time_ms": 1591.776, "learn_time_ms": 11424.177, "learn_throughput": 350.135, "synch_weights_time_ms": 13.468}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "e1352_00000", "date": "2024-08-13_16-56-17", "timestamp": 1723582577, "time_this_iter_s": 12.605343103408813, "time_total_s": 1096.2571115493774, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b164c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1096.2571115493774, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 67.85294117647061, "ram_util_percent": 83.59411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4986430952946344, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 0.8915985422790366, "policy_loss": -0.0005439672229821405, "vf_loss": 0.886974421411595, "vf_explained_var": 0.07624627771200958, "kl": 0.008066028660985651, "entropy": 0.23701174755496954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4662906199161494, "cur_kl_coeff": 0.72081298828125, "cur_lr": 0.009999999999999998, "total_loss": 1.0593125454667542, "policy_loss": 0.0007787630511398511, "vf_loss": 1.0399936221106343, "vf_explained_var": -8.924928291764839e-09, "kl": 0.025721178409666784, "entropy": 0.015616252323531983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -594.0, "episode_reward_mean": -52.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -48.48, "predator_policy": 22.085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, 6.0, -28.0, -165.0, 8.0, 6.0, -10.0, 7.0, 15.0, -10.0, 18.0, 0.0, -22.0, -196.0, -192.0, 0.0, 3.0, 15.0, -2.0, 30.0, -580.0, -22.0, 13.0, 0.0, 0.0, -585.0, 4.0, -12.0, -11.0, -6.0, 20.0, 0.0, 12.0, -4.0, 14.0, 8.0, 0.0, -180.0, -10.0, -1.0, -594.0, -23.0, -1.0, -9.0, -36.0, 1.0, 0.0, -30.0, 12.0, -157.0, 10.0, -532.0, -6.0, 0.0, 0.0, 15.0, 13.0, 0.0, 1.0, -572.0, -9.0, 14.0, -200.0, -12.0, -18.0, 0.0, 11.0, 4.0, -116.0, 15.0, 6.0, -163.0, 0.0, 3.0, -1.0, 0.0, -1.0, 30.0, 15.0, -5.0, -181.0, -3.0, -23.0, 2.0, -196.0, -6.0, 3.0, -10.0, -16.0, -9.0, 0.0, 15.0, 6.0, 7.0, 0.0, -208.0, -480.0, 3.0, 15.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -12.0, 1.0, 1.0, 1.0, -58.0, 0.0, -330.0, -1.0, 5.0, 6.0, 0.0, -10.0, -15.0, -6.0, 10.0, 15.0, 0.0, 0.0, -20.0, 6.0, 12.0, 0.0, 0.0, -15.0, -20.0, 2.0, -396.0, -360.0, -21.0, 0.0, 0.0, 3.0, 0.0, 2.0, 11.0, 0.0, -12.0, 15.0, 15.0, -382.0, -396.0, -16.0, -19.0, 5.0, 8.0, 0.0, 0.0, 0.0, 0.0, -400.0, -385.0, 0.0, -4.0, -20.0, -4.0, 0.0, -22.0, -18.0, 2.0, 5.0, 15.0, 0.0, 0.0, 12.0, 0.0, 0.0, -8.0, 0.0, 14.0, 8.0, 0.0, 0.0, 0.0, 0.0, -369.0, 0.0, -20.0, 9.0, -30.0, -400.0, -394.0, -400.0, 0.0, 4.0, -10.0, 0.0, -400.0, -66.0, -6.0, 0.0, 1.0, 0.0, 0.0, 0.0, -60.0, 12.0, 0.0, -317.0, -17.0, 0.0, 8.0, -343.0, -384.0, 2.0, -16.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, -4.0, -400.0, -372.0, -19.0, 0.0, 0.0, 14.0, -400.0, 0.0, -22.0, -2.0, -39.0, 0.0, 0.0, 0.0, 6.0, -4.0, 4.0, 0.0, 1.0, -242.0, 15.0, 0.0, 6.0, 0.0, -312.0, -14.0, 0.0, 0.0, 1.0, 0.0, -22.0, 9.0, 0.0, 0.0, 0.0, -2.0, 15.0, 15.0, 15.0, -10.0, 0.0, -15.0, -388.0, 13.0, 0.0, -6.0, -12.0, -36.0, 2.0, 0.0, 1.0, -394.0, -22.0, 5.0, -7.0, 0.0, -20.0, 0.0, 0.0, -32.0, -18.0, 0.0, -11.0, 1.0, 0.0, 15.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, -400.0, -16.0, -368.0, -312.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0], "policy_predator_policy_reward": [6.0, 0.0, 4.0, 0.0, 0.0, 29.0, 0.0, 165.0, 0.0, 4.0, 0.0, 0.0, 10.0, 5.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 198.0, 0.0, 3.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 8.0, 0.0, 12.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 4.0, 0.0, 10.0, 10.0, 10.0, 0.0, 200.0, 177.0, 200.0, 0.0, 5.0, 191.0, 200.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 166.0, 11.0, 2.0, 0.0, 0.0, 195.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 12.0, 0.0, 11.0, 10.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 121.0, 4.0, 0.0, 0.0, 0.0, 0.0, 156.0, 7.0, 0.0, 0.0, 2.0, 0.0, 11.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 194.0, 0.0, 3.0, 0.0, 9.0, 16.0, 0.0, 0.0, 0.0, 197.0, 0.0, 11.0, 0.0, 10.0, 10.0, 0.0, 6.0, 10.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 200.0, 8.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9338573751198297, "mean_inference_ms": 2.466718963921634, "mean_action_processing_ms": 0.44775645496991684, "mean_env_wait_ms": 0.3377181680725435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005403995513916016, "StateBufferConnector_ms": 0.007226347923278809, "ViewRequirementAgentConnector_ms": 0.12553048133850098}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -594.0, "episode_return_mean": -52.79, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.2998401804938, "num_env_steps_trained_throughput_per_sec": 305.2998401804938, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 12956.873, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12956.823, "sample_time_ms": 1508.704, "learn_time_ms": 11432.99, "learn_throughput": 349.865, "synch_weights_time_ms": 12.518}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "e1352_00000", "date": "2024-08-13_16-56-30", "timestamp": 1723582590, "time_this_iter_s": 13.14902377128601, "time_total_s": 1109.4061353206635, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16295e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1109.4061353206635, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 67.64736842105262, "ram_util_percent": 83.47894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.72685238023599, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.1152349643290989, "policy_loss": 0.0005368892248798772, "vf_loss": 1.1078686155575923, "vf_explained_var": 0.05611126473341039, "kl": 0.010658994376707014, "entropy": 0.18320758865071982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1842322880155827, "cur_kl_coeff": 1.0812194824218753, "cur_lr": 0.009999999999999998, "total_loss": 1.4602804086038044, "policy_loss": 0.002789876506313997, "vf_loss": 1.4195889817186134, "vf_explained_var": -1.2520129087740782e-08, "kl": 0.035054450066257105, "entropy": 0.07617281089147769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -594.0, "episode_reward_mean": -58.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -52.33, "predator_policy": 23.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, 30.0, -580.0, -22.0, 13.0, 0.0, 0.0, -585.0, 4.0, -12.0, -11.0, -6.0, 20.0, 0.0, 12.0, -4.0, 14.0, 8.0, 0.0, -180.0, -10.0, -1.0, -594.0, -23.0, -1.0, -9.0, -36.0, 1.0, 0.0, -30.0, 12.0, -157.0, 10.0, -532.0, -6.0, 0.0, 0.0, 15.0, 13.0, 0.0, 1.0, -572.0, -9.0, 14.0, -200.0, -12.0, -18.0, 0.0, 11.0, 4.0, -116.0, 15.0, 6.0, -163.0, 0.0, 3.0, -1.0, 0.0, -1.0, 30.0, 15.0, -5.0, -181.0, -3.0, -23.0, 2.0, -196.0, -6.0, 3.0, -10.0, -16.0, -9.0, 0.0, 15.0, 6.0, 7.0, 0.0, -208.0, -480.0, 3.0, 15.0, 0.0, -182.0, -284.0, 0.0, 2.0, 6.0, -5.0, 3.0, 0.0, 0.0, 0.0, 17.0, -194.0, 0.0, -507.0, 25.0, -1.0, -5.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -12.0, 15.0, 15.0, -382.0, -396.0, -16.0, -19.0, 5.0, 8.0, 0.0, 0.0, 0.0, 0.0, -400.0, -385.0, 0.0, -4.0, -20.0, -4.0, 0.0, -22.0, -18.0, 2.0, 5.0, 15.0, 0.0, 0.0, 12.0, 0.0, 0.0, -8.0, 0.0, 14.0, 8.0, 0.0, 0.0, 0.0, 0.0, -369.0, 0.0, -20.0, 9.0, -30.0, -400.0, -394.0, -400.0, 0.0, 4.0, -10.0, 0.0, -400.0, -66.0, -6.0, 0.0, 1.0, 0.0, 0.0, 0.0, -60.0, 12.0, 0.0, -317.0, -17.0, 0.0, 8.0, -343.0, -384.0, 2.0, -16.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, -4.0, -400.0, -372.0, -19.0, 0.0, 0.0, 14.0, -400.0, 0.0, -22.0, -2.0, -39.0, 0.0, 0.0, 0.0, 6.0, -4.0, 4.0, 0.0, 1.0, -242.0, 15.0, 0.0, 6.0, 0.0, -312.0, -14.0, 0.0, 0.0, 1.0, 0.0, -22.0, 9.0, 0.0, 0.0, 0.0, -2.0, 15.0, 15.0, 15.0, -10.0, 0.0, -15.0, -388.0, 13.0, 0.0, -6.0, -12.0, -36.0, 2.0, 0.0, 1.0, -394.0, -22.0, 5.0, -7.0, 0.0, -20.0, 0.0, 0.0, -32.0, -18.0, 0.0, -11.0, 1.0, 0.0, 15.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, -400.0, -16.0, -368.0, -312.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, -364.0, 0.0, -84.0, -400.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -10.0, 0.0, -16.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 1.0, -400.0, 6.0, 0.0, 0.0, -334.0, -361.0, 12.0, 13.0, 0.0, -2.0, -10.0, 0.0, -26.0, -6.0], "policy_predator_policy_reward": [10.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 8.0, 0.0, 12.0, 11.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 4.0, 0.0, 10.0, 10.0, 10.0, 0.0, 200.0, 177.0, 200.0, 0.0, 5.0, 191.0, 200.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 166.0, 11.0, 2.0, 0.0, 0.0, 195.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 12.0, 0.0, 11.0, 10.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 121.0, 4.0, 0.0, 0.0, 0.0, 0.0, 156.0, 7.0, 0.0, 0.0, 2.0, 0.0, 11.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 194.0, 0.0, 3.0, 0.0, 9.0, 16.0, 0.0, 0.0, 0.0, 197.0, 0.0, 11.0, 0.0, 10.0, 10.0, 0.0, 6.0, 10.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 200.0, 8.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 200.0, 0.0, 0.0, 0.0, 3.0, 4.0, 6.0, 0.0, 0.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 185.0, 3.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 10.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9320531961258738, "mean_inference_ms": 2.4597460321723754, "mean_action_processing_ms": 0.44593145721674887, "mean_env_wait_ms": 0.3371462040552155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426479339599609, "StateBufferConnector_ms": 0.006293773651123047, "ViewRequirementAgentConnector_ms": 0.11109912395477295}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -594.0, "episode_return_mean": -58.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3786607326535, "num_env_steps_trained_throughput_per_sec": 301.3786607326535, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 12997.366, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12997.316, "sample_time_ms": 1492.662, "learn_time_ms": 11489.09, "learn_throughput": 348.156, "synch_weights_time_ms": 12.487}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "e1352_00000", "date": "2024-08-13_16-56-43", "timestamp": 1723582603, "time_this_iter_s": 13.324994087219238, "time_total_s": 1122.7311294078827, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b163ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1122.7311294078827, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 68.09473684210528, "ram_util_percent": 83.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.340891355165729, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 0.9085708028582669, "policy_loss": 0.0003370228733512617, "vf_loss": 0.9022874609266639, "vf_explained_var": 0.06751837402424485, "kl": 0.00928064998709117, "entropy": 0.2388966416043264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.63985932355244, "cur_kl_coeff": 1.621829223632812, "cur_lr": 0.009999999999999998, "total_loss": 1.1120300295688803, "policy_loss": 0.0009456313717814665, "vf_loss": 1.1030112231692308, "vf_explained_var": -9.524128424427496e-09, "kl": 0.004977823550054186, "entropy": 0.0391319289082347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -572.0, "episode_reward_mean": -44.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -44.14, "predator_policy": 21.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -1.0, -9.0, -36.0, 1.0, 0.0, -30.0, 12.0, -157.0, 10.0, -532.0, -6.0, 0.0, 0.0, 15.0, 13.0, 0.0, 1.0, -572.0, -9.0, 14.0, -200.0, -12.0, -18.0, 0.0, 11.0, 4.0, -116.0, 15.0, 6.0, -163.0, 0.0, 3.0, -1.0, 0.0, -1.0, 30.0, 15.0, -5.0, -181.0, -3.0, -23.0, 2.0, -196.0, -6.0, 3.0, -10.0, -16.0, -9.0, 0.0, 15.0, 6.0, 7.0, 0.0, -208.0, -480.0, 3.0, 15.0, 0.0, -182.0, -284.0, 0.0, 2.0, 6.0, -5.0, 3.0, 0.0, 0.0, 0.0, 17.0, -194.0, 0.0, -507.0, 25.0, -1.0, -5.0, -9.0, 10.0, 6.0, 6.0, 2.0, -9.0, -7.0, 15.0, 15.0, 1.0, -176.0, -185.0, 0.0, 0.0, -23.0, -4.0, 26.0, 5.0, 3.0, 0.0, 0.0, -2.0, 5.0, -200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-400.0, 0.0, 4.0, -10.0, 0.0, -400.0, -66.0, -6.0, 0.0, 1.0, 0.0, 0.0, 0.0, -60.0, 12.0, 0.0, -317.0, -17.0, 0.0, 8.0, -343.0, -384.0, 2.0, -16.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, -4.0, -400.0, -372.0, -19.0, 0.0, 0.0, 14.0, -400.0, 0.0, -22.0, -2.0, -39.0, 0.0, 0.0, 0.0, 6.0, -4.0, 4.0, 0.0, 1.0, -242.0, 15.0, 0.0, 6.0, 0.0, -312.0, -14.0, 0.0, 0.0, 1.0, 0.0, -22.0, 9.0, 0.0, 0.0, 0.0, -2.0, 15.0, 15.0, 15.0, -10.0, 0.0, -15.0, -388.0, 13.0, 0.0, -6.0, -12.0, -36.0, 2.0, 0.0, 1.0, -394.0, -22.0, 5.0, -7.0, 0.0, -20.0, 0.0, 0.0, -32.0, -18.0, 0.0, -11.0, 1.0, 0.0, 15.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, -400.0, -16.0, -368.0, -312.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, -364.0, 0.0, -84.0, -400.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -10.0, 0.0, -16.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 1.0, -400.0, 6.0, 0.0, 0.0, -334.0, -361.0, 12.0, 13.0, 0.0, -2.0, -10.0, 0.0, -26.0, -6.0, 10.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 2.0, 0.0, -18.0, -6.0, -8.0, 0.0, 15.0, 0.0, 15.0, 0.0, 1.0, 15.0, -382.0, -370.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, -8.0, 11.0, 15.0, 0.0, 5.0, -20.0, 11.0, 0.0, 0.0, 0.0, 0.0, -12.0, 4.0, -20.0, 15.0, -400.0, 0.0], "policy_predator_policy_reward": [177.0, 200.0, 0.0, 5.0, 191.0, 200.0, 36.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 166.0, 11.0, 2.0, 0.0, 0.0, 195.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 12.0, 0.0, 11.0, 10.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 121.0, 4.0, 0.0, 0.0, 0.0, 0.0, 156.0, 7.0, 0.0, 0.0, 2.0, 0.0, 11.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 194.0, 0.0, 3.0, 0.0, 9.0, 16.0, 0.0, 0.0, 0.0, 197.0, 0.0, 11.0, 0.0, 10.0, 10.0, 0.0, 6.0, 10.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 200.0, 8.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 200.0, 0.0, 0.0, 0.0, 3.0, 4.0, 6.0, 0.0, 0.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 185.0, 3.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 10.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 200.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9293233398293502, "mean_inference_ms": 2.452282772990971, "mean_action_processing_ms": 0.44369366267373694, "mean_env_wait_ms": 0.3361051255488247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008394956588745117, "StateBufferConnector_ms": 0.006457328796386719, "ViewRequirementAgentConnector_ms": 0.1336902379989624}, "num_episodes": 23, "episode_return_max": 30.0, "episode_return_min": -572.0, "episode_return_mean": -44.68, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.73246747943267, "num_env_steps_trained_throughput_per_sec": 309.73246747943267, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 12968.658, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12968.609, "sample_time_ms": 1545.083, "learn_time_ms": 11405.867, "learn_throughput": 350.697, "synch_weights_time_ms": 13.555}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "e1352_00000", "date": "2024-08-13_16-56-56", "timestamp": 1723582616, "time_this_iter_s": 13.035837888717651, "time_total_s": 1135.7669672966003, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b164c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1135.7669672966003, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 66.86666666666667, "ram_util_percent": 83.53888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2649928965896526, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 0.9994813200500277, "policy_loss": 0.0005420984200167435, "vf_loss": 0.9901511007496131, "vf_explained_var": 0.13055295423855856, "kl": 0.013715954894456647, "entropy": 0.3996156991553054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0393138543047287, "cur_kl_coeff": 0.810914611816406, "cur_lr": 0.009999999999999998, "total_loss": 1.4256769637503321, "policy_loss": 0.0016337636925979819, "vf_loss": 1.4079925476243256, "vf_explained_var": -7.348085837389426e-09, "kl": 0.019793265850370036, "entropy": 0.045448207328252645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -572.0, "episode_reward_mean": -45.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.215, "predator_policy": 18.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-572.0, -9.0, 14.0, -200.0, -12.0, -18.0, 0.0, 11.0, 4.0, -116.0, 15.0, 6.0, -163.0, 0.0, 3.0, -1.0, 0.0, -1.0, 30.0, 15.0, -5.0, -181.0, -3.0, -23.0, 2.0, -196.0, -6.0, 3.0, -10.0, -16.0, -9.0, 0.0, 15.0, 6.0, 7.0, 0.0, -208.0, -480.0, 3.0, 15.0, 0.0, -182.0, -284.0, 0.0, 2.0, 6.0, -5.0, 3.0, 0.0, 0.0, 0.0, 17.0, -194.0, 0.0, -507.0, 25.0, -1.0, -5.0, -9.0, 10.0, 6.0, 6.0, 2.0, -9.0, -7.0, 15.0, 15.0, 1.0, -176.0, -185.0, 0.0, 0.0, -23.0, -4.0, 26.0, 5.0, 3.0, 0.0, 0.0, -2.0, 5.0, -200.0, 9.0, -2.0, -5.0, 0.0, 12.0, -115.0, 11.0, 15.0, 0.0, -8.0, 12.0, -543.0, 7.0, 2.0, -13.0, 2.0, 11.0, -200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-400.0, -372.0, -19.0, 0.0, 0.0, 14.0, -400.0, 0.0, -22.0, -2.0, -39.0, 0.0, 0.0, 0.0, 6.0, -4.0, 4.0, 0.0, 1.0, -242.0, 15.0, 0.0, 6.0, 0.0, -312.0, -14.0, 0.0, 0.0, 1.0, 0.0, -22.0, 9.0, 0.0, 0.0, 0.0, -2.0, 15.0, 15.0, 15.0, -10.0, 0.0, -15.0, -388.0, 13.0, 0.0, -6.0, -12.0, -36.0, 2.0, 0.0, 1.0, -394.0, -22.0, 5.0, -7.0, 0.0, -20.0, 0.0, 0.0, -32.0, -18.0, 0.0, -11.0, 1.0, 0.0, 15.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, -400.0, -16.0, -368.0, -312.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, -364.0, 0.0, -84.0, -400.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -10.0, 0.0, -16.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 1.0, -400.0, 6.0, 0.0, 0.0, -334.0, -361.0, 12.0, 13.0, 0.0, -2.0, -10.0, 0.0, -26.0, -6.0, 10.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 2.0, 0.0, -18.0, -6.0, -8.0, 0.0, 15.0, 0.0, 15.0, 0.0, 1.0, 15.0, -382.0, -370.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, -8.0, 11.0, 15.0, 0.0, 5.0, -20.0, 11.0, 0.0, 0.0, 0.0, 0.0, -12.0, 4.0, -20.0, 15.0, -400.0, 0.0, -10.0, 14.0, 0.0, -12.0, 0.0, -15.0, 0.0, 0.0, 3.0, 9.0, 8.0, -246.0, 0.0, 11.0, 15.0, 0.0, 0.0, 0.0, -14.0, -9.0, 12.0, 0.0, -360.0, -366.0, 7.0, 0.0, 2.0, 0.0, -20.0, -13.0, 1.0, -8.0, 11.0, 0.0, 0.0, -400.0], "policy_predator_policy_reward": [200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 12.0, 0.0, 11.0, 10.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 121.0, 4.0, 0.0, 0.0, 0.0, 0.0, 156.0, 7.0, 0.0, 0.0, 2.0, 0.0, 11.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 194.0, 0.0, 3.0, 0.0, 9.0, 16.0, 0.0, 0.0, 0.0, 197.0, 0.0, 11.0, 0.0, 10.0, 10.0, 0.0, 6.0, 10.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 200.0, 8.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 200.0, 0.0, 0.0, 0.0, 3.0, 4.0, 6.0, 0.0, 0.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 185.0, 3.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 10.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 200.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 123.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 9.0, 0.0, 0.0, 200.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9283280522744772, "mean_inference_ms": 2.449330026426644, "mean_action_processing_ms": 0.44263022837384997, "mean_env_wait_ms": 0.33567059896169754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008858680725097656, "StateBufferConnector_ms": 0.00652003288269043, "ViewRequirementAgentConnector_ms": 0.1684584617614746}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -572.0, "episode_return_mean": -45.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.7150094944546, "num_env_steps_trained_throughput_per_sec": 294.7150094944546, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 13040.401, "restore_workers_time_ms": 0.02, "training_step_time_ms": 13040.342, "sample_time_ms": 1639.011, "learn_time_ms": 11383.133, "learn_throughput": 351.397, "synch_weights_time_ms": 14.195}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "e1352_00000", "date": "2024-08-13_16-57-10", "timestamp": 1723582630, "time_this_iter_s": 13.645534038543701, "time_total_s": 1149.412501335144, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b171d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1149.412501335144, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 68.06500000000001, "ram_util_percent": 83.44500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.329557860323361, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.1108425016756411, "policy_loss": -0.00032280178632212693, "vf_loss": 1.1022790972360228, "vf_explained_var": 0.0866991677612224, "kl": 0.013869035715142865, "entropy": 0.3923684384772386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.414188442568457, "cur_kl_coeff": 0.810914611816406, "cur_lr": 0.009999999999999998, "total_loss": 1.5148969286648686, "policy_loss": -2.0676816532772684e-05, "vf_loss": 1.5107606393477273, "vf_explained_var": -5.771243383014013e-09, "kl": 0.005126266461819786, "entropy": 0.02001894722997787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -598.0, "episode_reward_mean": -43.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -38.38, "predator_policy": 16.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -23.0, 2.0, -196.0, -6.0, 3.0, -10.0, -16.0, -9.0, 0.0, 15.0, 6.0, 7.0, 0.0, -208.0, -480.0, 3.0, 15.0, 0.0, -182.0, -284.0, 0.0, 2.0, 6.0, -5.0, 3.0, 0.0, 0.0, 0.0, 17.0, -194.0, 0.0, -507.0, 25.0, -1.0, -5.0, -9.0, 10.0, 6.0, 6.0, 2.0, -9.0, -7.0, 15.0, 15.0, 1.0, -176.0, -185.0, 0.0, 0.0, -23.0, -4.0, 26.0, 5.0, 3.0, 0.0, 0.0, -2.0, 5.0, -200.0, 9.0, -2.0, -5.0, 0.0, 12.0, -115.0, 11.0, 15.0, 0.0, -8.0, 12.0, -543.0, 7.0, 2.0, -13.0, 2.0, 11.0, -200.0, -10.0, -174.0, 0.0, 0.0, -1.0, 24.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, -598.0, 9.0, -2.0, 0.0, 2.0, -8.0, -33.0, 1.0, 0.0, -172.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -6.0, -12.0, -36.0, 2.0, 0.0, 1.0, -394.0, -22.0, 5.0, -7.0, 0.0, -20.0, 0.0, 0.0, -32.0, -18.0, 0.0, -11.0, 1.0, 0.0, 15.0, 6.0, 0.0, 4.0, 0.0, 0.0, 0.0, -400.0, -16.0, -368.0, -312.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, -364.0, 0.0, -84.0, -400.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -10.0, 0.0, -16.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 1.0, -400.0, 6.0, 0.0, 0.0, -334.0, -361.0, 12.0, 13.0, 0.0, -2.0, -10.0, 0.0, -26.0, -6.0, 10.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 2.0, 0.0, -18.0, -6.0, -8.0, 0.0, 15.0, 0.0, 15.0, 0.0, 1.0, 15.0, -382.0, -370.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, -8.0, 11.0, 15.0, 0.0, 5.0, -20.0, 11.0, 0.0, 0.0, 0.0, 0.0, -12.0, 4.0, -20.0, 15.0, -400.0, 0.0, -10.0, 14.0, 0.0, -12.0, 0.0, -15.0, 0.0, 0.0, 3.0, 9.0, 8.0, -246.0, 0.0, 11.0, 15.0, 0.0, 0.0, 0.0, -14.0, -9.0, 12.0, 0.0, -360.0, -366.0, 7.0, 0.0, 2.0, 0.0, -20.0, -13.0, 1.0, -8.0, 11.0, 0.0, 0.0, -400.0, 0.0, -20.0, 15.0, -378.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 9.0, 15.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, -400.0, 9.0, 0.0, -4.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -16.0, 0.0, -66.0, 0.0, 1.0, 0.0, 0.0, 0.0, -347.0], "policy_predator_policy_reward": [3.0, 0.0, 9.0, 16.0, 0.0, 0.0, 0.0, 197.0, 0.0, 11.0, 0.0, 10.0, 10.0, 0.0, 6.0, 10.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 200.0, 8.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 200.0, 0.0, 0.0, 0.0, 3.0, 4.0, 6.0, 0.0, 0.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 185.0, 3.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 10.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 200.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 123.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 9.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 185.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 33.0, 0.0, 0.0, 0.0, 0.0, 175.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9270980106015116, "mean_inference_ms": 2.4476831970483066, "mean_action_processing_ms": 0.44161945762411264, "mean_env_wait_ms": 0.33490765215285784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009609818458557129, "StateBufferConnector_ms": 0.0066013336181640625, "ViewRequirementAgentConnector_ms": 0.1694878339767456}, "num_episodes": 22, "episode_return_max": 26.0, "episode_return_min": -598.0, "episode_return_mean": -43.05, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.9349279248906, "num_env_steps_trained_throughput_per_sec": 312.9349279248906, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 13034.099, "restore_workers_time_ms": 0.02, "training_step_time_ms": 13034.037, "sample_time_ms": 1659.869, "learn_time_ms": 11356.271, "learn_throughput": 352.228, "synch_weights_time_ms": 14.287}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "e1352_00000", "date": "2024-08-13_16-57-23", "timestamp": 1723582643, "time_this_iter_s": 12.816787242889404, "time_total_s": 1162.2292885780334, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16393a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1162.2292885780334, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 66.72222222222221, "ram_util_percent": 83.47222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.444012056898188, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.591285982491478, "policy_loss": -2.5117071591830127e-05, "vf_loss": 1.5829736728201467, "vf_explained_var": 0.12983532412342294, "kl": 0.013012531082849771, "entropy": 0.35716020758978273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1328621688835994, "cur_kl_coeff": 0.810914611816406, "cur_lr": 0.009999999999999998, "total_loss": 2.262822217001486, "policy_loss": 0.0016543018732653567, "vf_loss": 2.242899222916396, "vf_explained_var": -7.442696384651951e-09, "kl": 0.02252850905045706, "entropy": 0.04720165224506748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -598.0, "episode_reward_mean": -50.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -43.835, "predator_policy": 18.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -182.0, -284.0, 0.0, 2.0, 6.0, -5.0, 3.0, 0.0, 0.0, 0.0, 17.0, -194.0, 0.0, -507.0, 25.0, -1.0, -5.0, -9.0, 10.0, 6.0, 6.0, 2.0, -9.0, -7.0, 15.0, 15.0, 1.0, -176.0, -185.0, 0.0, 0.0, -23.0, -4.0, 26.0, 5.0, 3.0, 0.0, 0.0, -2.0, 5.0, -200.0, 9.0, -2.0, -5.0, 0.0, 12.0, -115.0, 11.0, 15.0, 0.0, -8.0, 12.0, -543.0, 7.0, 2.0, -13.0, 2.0, 11.0, -200.0, -10.0, -174.0, 0.0, 0.0, -1.0, 24.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, -598.0, 9.0, -2.0, 0.0, 2.0, -8.0, -33.0, 1.0, 0.0, -172.0, 15.0, 0.0, -9.0, -8.0, 1.0, -567.0, 0.0, -62.0, 14.0, -22.0, -450.0, 8.0, -4.0, 13.0, -200.0, 3.0, -298.0, -78.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -364.0, 0.0, -84.0, -400.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -10.0, 0.0, -16.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 1.0, -400.0, 6.0, 0.0, 0.0, -334.0, -361.0, 12.0, 13.0, 0.0, -2.0, -10.0, 0.0, -26.0, -6.0, 10.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 2.0, 0.0, -18.0, -6.0, -8.0, 0.0, 15.0, 0.0, 15.0, 0.0, 1.0, 15.0, -382.0, -370.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, -8.0, 11.0, 15.0, 0.0, 5.0, -20.0, 11.0, 0.0, 0.0, 0.0, 0.0, -12.0, 4.0, -20.0, 15.0, -400.0, 0.0, -10.0, 14.0, 0.0, -12.0, 0.0, -15.0, 0.0, 0.0, 3.0, 9.0, 8.0, -246.0, 0.0, 11.0, 15.0, 0.0, 0.0, 0.0, -14.0, -9.0, 12.0, 0.0, -360.0, -366.0, 7.0, 0.0, 2.0, 0.0, -20.0, -13.0, 1.0, -8.0, 11.0, 0.0, 0.0, -400.0, 0.0, -20.0, 15.0, -378.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 9.0, 15.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, -400.0, 9.0, 0.0, -4.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -16.0, 0.0, -66.0, 0.0, 1.0, 0.0, 0.0, 0.0, -347.0, 15.0, 0.0, 0.0, 0.0, -18.0, 0.0, -18.0, 0.0, 0.0, 1.0, -382.0, -382.0, -12.0, 2.0, 0.0, -124.0, 3.0, 9.0, 15.0, -74.0, -376.0, -278.0, 0.0, 8.0, 0.0, -12.0, 0.0, 13.0, 0.0, -400.0, -12.0, 4.0, -108.0, -380.0, -203.0, 16.0], "policy_predator_policy_reward": [0.0, 0.0, 182.0, 0.0, 200.0, 0.0, 0.0, 0.0, 3.0, 4.0, 6.0, 0.0, 0.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 185.0, 3.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 10.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 200.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 123.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 9.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 185.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 33.0, 0.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 187.0, 10.0, 0.0, 10.0, 62.0, 0.0, 0.0, 2.0, 0.0, 37.0, 4.0, 200.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 200.0, 6.0, 5.0, 190.0, 0.0, 0.0, 109.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9270802485794539, "mean_inference_ms": 2.4456281458262605, "mean_action_processing_ms": 0.44069226988712495, "mean_env_wait_ms": 0.33487916935616474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009713172912597656, "StateBufferConnector_ms": 0.0035228729248046875, "ViewRequirementAgentConnector_ms": 0.17870736122131348}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -598.0, "episode_return_mean": -50.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.467178944998, "num_env_steps_trained_throughput_per_sec": 319.467178944998, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 12974.955, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12974.894, "sample_time_ms": 1670.161, "learn_time_ms": 11286.722, "learn_throughput": 354.399, "synch_weights_time_ms": 14.244}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "e1352_00000", "date": "2024-08-13_16-57-36", "timestamp": 1723582656, "time_this_iter_s": 12.579545021057129, "time_total_s": 1174.8088335990906, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af0fb3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1174.8088335990906, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 64.32777777777778, "ram_util_percent": 83.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9850803864222986, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.0385953552666165, "policy_loss": 0.0010281722393951245, "vf_loss": 1.0315756895791286, "vf_explained_var": 0.1190895900209114, "kl": 0.009351159141818582, "entropy": 0.22183023143618827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2711517710407465, "cur_kl_coeff": 1.2163719177246093, "cur_lr": 0.009999999999999998, "total_loss": 1.0461122699949161, "policy_loss": 0.00018298404892443348, "vf_loss": 1.0456406807615644, "vf_explained_var": -3.09061121057581e-09, "kl": 0.0002372666922180533, "entropy": 0.00013932072580652473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -598.0, "episode_reward_mean": -50.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -44.04, "predator_policy": 19.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, -7.0, 15.0, 15.0, 1.0, -176.0, -185.0, 0.0, 0.0, -23.0, -4.0, 26.0, 5.0, 3.0, 0.0, 0.0, -2.0, 5.0, -200.0, 9.0, -2.0, -5.0, 0.0, 12.0, -115.0, 11.0, 15.0, 0.0, -8.0, 12.0, -543.0, 7.0, 2.0, -13.0, 2.0, 11.0, -200.0, -10.0, -174.0, 0.0, 0.0, -1.0, 24.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, -598.0, 9.0, -2.0, 0.0, 2.0, -8.0, -33.0, 1.0, 0.0, -172.0, 15.0, 0.0, -9.0, -8.0, 1.0, -567.0, 0.0, -62.0, 14.0, -22.0, -450.0, 8.0, -4.0, 13.0, -200.0, 3.0, -298.0, -78.0, 0.0, -3.0, 0.0, -6.0, 0.0, 10.0, 0.0, 0.0, 3.0, -187.0, -74.0, -444.0, 4.0, 0.0, -3.0, 17.0, -198.0, -162.0, 0.0, -7.0, -12.0, -10.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -18.0, -6.0, -8.0, 0.0, 15.0, 0.0, 15.0, 0.0, 1.0, 15.0, -382.0, -370.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, -8.0, 11.0, 15.0, 0.0, 5.0, -20.0, 11.0, 0.0, 0.0, 0.0, 0.0, -12.0, 4.0, -20.0, 15.0, -400.0, 0.0, -10.0, 14.0, 0.0, -12.0, 0.0, -15.0, 0.0, 0.0, 3.0, 9.0, 8.0, -246.0, 0.0, 11.0, 15.0, 0.0, 0.0, 0.0, -14.0, -9.0, 12.0, 0.0, -360.0, -366.0, 7.0, 0.0, 2.0, 0.0, -20.0, -13.0, 1.0, -8.0, 11.0, 0.0, 0.0, -400.0, 0.0, -20.0, 15.0, -378.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 9.0, 15.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, -400.0, 9.0, 0.0, -4.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -16.0, 0.0, -66.0, 0.0, 1.0, 0.0, 0.0, 0.0, -347.0, 15.0, 0.0, 0.0, 0.0, -18.0, 0.0, -18.0, 0.0, 0.0, 1.0, -382.0, -382.0, -12.0, 2.0, 0.0, -124.0, 3.0, 9.0, 15.0, -74.0, -376.0, -278.0, 0.0, 8.0, 0.0, -12.0, 0.0, 13.0, 0.0, -400.0, -12.0, 4.0, -108.0, -380.0, -203.0, 16.0, 0.0, 0.0, 0.0, -6.0, -9.0, 0.0, -14.0, -9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -379.0, 0.0, -20.0, -131.0, -400.0, -244.0, 0.0, 4.0, 0.0, 0.0, -7.0, 0.0, 15.0, 2.0, -396.0, 0.0, 0.0, -339.0, 0.0, 0.0, 0.0, -18.0, -12.0, -6.0, -20.0, 0.0, -6.0, 7.0], "policy_predator_policy_reward": [9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 200.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 123.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 9.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 185.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 33.0, 0.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 187.0, 10.0, 0.0, 10.0, 62.0, 0.0, 0.0, 2.0, 0.0, 37.0, 4.0, 200.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 200.0, 6.0, 5.0, 190.0, 0.0, 0.0, 109.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 10.0, 67.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 193.0, 5.0, 177.0, 0.0, 0.0, 0.0, 1.0, 10.0, 6.0, 0.0, 0.0, 10.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9266088638595275, "mean_inference_ms": 2.4443153395920096, "mean_action_processing_ms": 0.440229017333429, "mean_env_wait_ms": 0.33471231770553944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009911060333251953, "StateBufferConnector_ms": 0.005683183670043945, "ViewRequirementAgentConnector_ms": 0.18407094478607178}, "num_episodes": 23, "episode_return_max": 26.0, "episode_return_min": -598.0, "episode_return_mean": -50.07, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.60812987767, "num_env_steps_trained_throughput_per_sec": 293.60812987767, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 13055.1, "restore_workers_time_ms": 0.02, "training_step_time_ms": 13055.04, "sample_time_ms": 1681.813, "learn_time_ms": 11354.323, "learn_throughput": 352.289, "synch_weights_time_ms": 14.356}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "e1352_00000", "date": "2024-08-13_16-57-49", "timestamp": 1723582669, "time_this_iter_s": 13.664403915405273, "time_total_s": 1188.4732375144958, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1679c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1188.4732375144958, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 72.23157894736842, "ram_util_percent": 83.5578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7349527075098305, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.295926896289543, "policy_loss": 0.000783177582970845, "vf_loss": 1.286398221292193, "vf_explained_var": 0.10308986334573655, "kl": 0.01364942410840829, "entropy": 0.18362867834746208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2662805243071587, "cur_kl_coeff": 0.6081859588623046, "cur_lr": 0.009999999999999998, "total_loss": 1.6646317458972728, "policy_loss": 0.00023727958994823947, "vf_loss": 1.6643940221380304, "vf_explained_var": -7.2219384410393934e-09, "kl": 7.269811232578672e-07, "entropy": 0.0002980316615393681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -598.0, "episode_reward_mean": -58.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -50.395, "predator_policy": 21.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.0, 9.0, -2.0, -5.0, 0.0, 12.0, -115.0, 11.0, 15.0, 0.0, -8.0, 12.0, -543.0, 7.0, 2.0, -13.0, 2.0, 11.0, -200.0, -10.0, -174.0, 0.0, 0.0, -1.0, 24.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, -598.0, 9.0, -2.0, 0.0, 2.0, -8.0, -33.0, 1.0, 0.0, -172.0, 15.0, 0.0, -9.0, -8.0, 1.0, -567.0, 0.0, -62.0, 14.0, -22.0, -450.0, 8.0, -4.0, 13.0, -200.0, 3.0, -298.0, -78.0, 0.0, -3.0, 0.0, -6.0, 0.0, 10.0, 0.0, 0.0, 3.0, -187.0, -74.0, -444.0, 4.0, 0.0, -3.0, 17.0, -198.0, -162.0, 0.0, -7.0, -12.0, -10.0, 4.0, -3.0, -27.0, 0.0, -4.0, 0.0, 15.0, -3.0, -3.0, 5.0, -558.0, -221.0, 4.0, -15.0, 15.0, 13.0, -197.0, 0.0, -189.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-400.0, 0.0, -10.0, 14.0, 0.0, -12.0, 0.0, -15.0, 0.0, 0.0, 3.0, 9.0, 8.0, -246.0, 0.0, 11.0, 15.0, 0.0, 0.0, 0.0, -14.0, -9.0, 12.0, 0.0, -360.0, -366.0, 7.0, 0.0, 2.0, 0.0, -20.0, -13.0, 1.0, -8.0, 11.0, 0.0, 0.0, -400.0, 0.0, -20.0, 15.0, -378.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 9.0, 15.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, -400.0, 9.0, 0.0, -4.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -16.0, 0.0, -66.0, 0.0, 1.0, 0.0, 0.0, 0.0, -347.0, 15.0, 0.0, 0.0, 0.0, -18.0, 0.0, -18.0, 0.0, 0.0, 1.0, -382.0, -382.0, -12.0, 2.0, 0.0, -124.0, 3.0, 9.0, 15.0, -74.0, -376.0, -278.0, 0.0, 8.0, 0.0, -12.0, 0.0, 13.0, 0.0, -400.0, -12.0, 4.0, -108.0, -380.0, -203.0, 16.0, 0.0, 0.0, 0.0, -6.0, -9.0, 0.0, -14.0, -9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -379.0, 0.0, -20.0, -131.0, -400.0, -244.0, 0.0, 4.0, 0.0, 0.0, -7.0, 0.0, 15.0, 2.0, -396.0, 0.0, 0.0, -339.0, 0.0, 0.0, 0.0, -18.0, -12.0, -6.0, -20.0, 0.0, -6.0, 7.0, -6.0, 0.0, -28.0, -25.0, 0.0, 0.0, -15.0, 1.0, 0.0, 0.0, 0.0, 15.0, -7.0, 0.0, 0.0, -13.0, 5.0, 0.0, -400.0, -358.0, -400.0, -33.0, 4.0, 0.0, 0.0, -31.0, 15.0, 0.0, 14.0, -11.0, 3.0, -400.0, 0.0, 0.0, 0.0, -378.0], "policy_predator_policy_reward": [200.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 123.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 183.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 9.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 185.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 33.0, 0.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 187.0, 10.0, 0.0, 10.0, 62.0, 0.0, 0.0, 2.0, 0.0, 37.0, 4.0, 200.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 200.0, 6.0, 5.0, 190.0, 0.0, 0.0, 109.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 10.0, 67.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 193.0, 5.0, 177.0, 0.0, 0.0, 0.0, 1.0, 10.0, 6.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 3.0, 13.0, 13.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 16.0, 196.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 0.0, 10.0, 179.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9259981784967803, "mean_inference_ms": 2.441387261051166, "mean_action_processing_ms": 0.4386326604408173, "mean_env_wait_ms": 0.33399771656763505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005443930625915527, "StateBufferConnector_ms": 0.005473136901855469, "ViewRequirementAgentConnector_ms": 0.17111945152282715}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -598.0, "episode_return_mean": -58.39, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.69328858052154, "num_env_steps_trained_throughput_per_sec": 299.69328858052154, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 13057.802, "restore_workers_time_ms": 0.02, "training_step_time_ms": 13057.742, "sample_time_ms": 1656.867, "learn_time_ms": 11381.797, "learn_throughput": 351.438, "synch_weights_time_ms": 14.444}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "e1352_00000", "date": "2024-08-13_16-58-03", "timestamp": 1723582683, "time_this_iter_s": 13.405257940292358, "time_total_s": 1201.8784954547882, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1713700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1201.8784954547882, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 73.71052631578947, "ram_util_percent": 83.71052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.379631933112624, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 1.1106706148732908, "policy_loss": 0.00046573366560830325, "vf_loss": 1.102985959488248, "vf_explained_var": 0.04592705116700874, "kl": 0.01126684287727099, "entropy": 0.15577779204323494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3324752506262882, "cur_kl_coeff": 0.3040929794311523, "cur_lr": 0.009999999999999998, "total_loss": 1.011912041305313, "policy_loss": -4.098421238638736e-06, "vf_loss": 1.0119159145408838, "vf_explained_var": -5.960464477539063e-09, "kl": 7.503906624969738e-07, "entropy": 0.00029738193162884464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -598.0, "episode_reward_mean": -57.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -50.99, "predator_policy": 22.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.0, -10.0, -174.0, 0.0, 0.0, -1.0, 24.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, -598.0, 9.0, -2.0, 0.0, 2.0, -8.0, -33.0, 1.0, 0.0, -172.0, 15.0, 0.0, -9.0, -8.0, 1.0, -567.0, 0.0, -62.0, 14.0, -22.0, -450.0, 8.0, -4.0, 13.0, -200.0, 3.0, -298.0, -78.0, 0.0, -3.0, 0.0, -6.0, 0.0, 10.0, 0.0, 0.0, 3.0, -187.0, -74.0, -444.0, 4.0, 0.0, -3.0, 17.0, -198.0, -162.0, 0.0, -7.0, -12.0, -10.0, 4.0, -3.0, -27.0, 0.0, -4.0, 0.0, 15.0, -3.0, -3.0, 5.0, -558.0, -221.0, 4.0, -15.0, 15.0, 13.0, -197.0, 0.0, -189.0, 9.0, -1.0, 15.0, -7.0, 0.0, 0.0, 0.0, 9.0, 0.0, -3.0, 0.0, 10.0, 0.0, 2.0, -576.0, 0.0, -186.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -400.0, 0.0, -20.0, 15.0, -378.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 9.0, 15.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, -400.0, 9.0, 0.0, -4.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -16.0, 0.0, -66.0, 0.0, 1.0, 0.0, 0.0, 0.0, -347.0, 15.0, 0.0, 0.0, 0.0, -18.0, 0.0, -18.0, 0.0, 0.0, 1.0, -382.0, -382.0, -12.0, 2.0, 0.0, -124.0, 3.0, 9.0, 15.0, -74.0, -376.0, -278.0, 0.0, 8.0, 0.0, -12.0, 0.0, 13.0, 0.0, -400.0, -12.0, 4.0, -108.0, -380.0, -203.0, 16.0, 0.0, 0.0, 0.0, -6.0, -9.0, 0.0, -14.0, -9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -379.0, 0.0, -20.0, -131.0, -400.0, -244.0, 0.0, 4.0, 0.0, 0.0, -7.0, 0.0, 15.0, 2.0, -396.0, 0.0, 0.0, -339.0, 0.0, 0.0, 0.0, -18.0, -12.0, -6.0, -20.0, 0.0, -6.0, 7.0, -6.0, 0.0, -28.0, -25.0, 0.0, 0.0, -15.0, 1.0, 0.0, 0.0, 0.0, 15.0, -7.0, 0.0, 0.0, -13.0, 5.0, 0.0, -400.0, -358.0, -400.0, -33.0, 4.0, 0.0, 0.0, -31.0, 15.0, 0.0, 14.0, -11.0, 3.0, -400.0, 0.0, 0.0, 0.0, -378.0, 9.0, 0.0, -6.0, 0.0, 15.0, 0.0, -17.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -360.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -396.0, -378.0, 0.0, 0.0, -394.0, 11.0, 0.0, 10.0], "policy_predator_policy_reward": [200.0, 0.0, 10.0, 0.0, 185.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 33.0, 0.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 187.0, 10.0, 0.0, 10.0, 62.0, 0.0, 0.0, 2.0, 0.0, 37.0, 4.0, 200.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 200.0, 6.0, 5.0, 190.0, 0.0, 0.0, 109.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 10.0, 67.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 193.0, 5.0, 177.0, 0.0, 0.0, 0.0, 1.0, 10.0, 6.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 3.0, 13.0, 13.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 16.0, 196.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 177.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9240530946980668, "mean_inference_ms": 2.435986806668741, "mean_action_processing_ms": 0.4371454626267595, "mean_env_wait_ms": 0.3331663957389452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004759073257446289, "StateBufferConnector_ms": 0.005371809005737305, "ViewRequirementAgentConnector_ms": 0.1371288299560547}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -598.0, "episode_return_mean": -57.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.71988433794536, "num_env_steps_trained_throughput_per_sec": 314.71988433794536, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 13039.093, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13039.027, "sample_time_ms": 1646.794, "learn_time_ms": 11372.784, "learn_throughput": 351.717, "synch_weights_time_ms": 14.638}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "e1352_00000", "date": "2024-08-13_16-58-16", "timestamp": 1723582696, "time_this_iter_s": 12.755464315414429, "time_total_s": 1214.6339597702026, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af0fb3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1214.6339597702026, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 68.51666666666665, "ram_util_percent": 83.36111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.312176705368612, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 0.009999999999999998, "total_loss": 0.3052150968363676, "policy_loss": 0.00011102716640505211, "vf_loss": 0.30420295713646783, "vf_explained_var": 0.0811866304546437, "kl": 0.0014064000183655633, "entropy": 0.08236544447206946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3260211483744793, "cur_kl_coeff": 0.15204648971557616, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -0.000283882425723489, "vf_loss": 0.5702000620509449, "vf_explained_var": 1.2740571662862466e-06, "kl": Infinity, "entropy": 4.400483174222001e-06, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 18.0, "episode_reward_min": -576.0, "episode_reward_mean": -47.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -43.245, "predator_policy": 19.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.0, 15.0, 0.0, -9.0, -8.0, 1.0, -567.0, 0.0, -62.0, 14.0, -22.0, -450.0, 8.0, -4.0, 13.0, -200.0, 3.0, -298.0, -78.0, 0.0, -3.0, 0.0, -6.0, 0.0, 10.0, 0.0, 0.0, 3.0, -187.0, -74.0, -444.0, 4.0, 0.0, -3.0, 17.0, -198.0, -162.0, 0.0, -7.0, -12.0, -10.0, 4.0, -3.0, -27.0, 0.0, -4.0, 0.0, 15.0, -3.0, -3.0, 5.0, -558.0, -221.0, 4.0, -15.0, 15.0, 13.0, -197.0, 0.0, -189.0, 9.0, -1.0, 15.0, -7.0, 0.0, 0.0, 0.0, 9.0, 0.0, -3.0, 0.0, 10.0, 0.0, 2.0, -576.0, 0.0, -186.0, 10.0, -6.0, -5.0, -9.0, -12.0, -6.0, 15.0, 5.0, 0.0, -2.0, 15.0, 18.0, -8.0, 0.0, -10.0, 17.0, -4.0, 0.0, 3.0, 11.0, 0.0, -10.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -347.0, 15.0, 0.0, 0.0, 0.0, -18.0, 0.0, -18.0, 0.0, 0.0, 1.0, -382.0, -382.0, -12.0, 2.0, 0.0, -124.0, 3.0, 9.0, 15.0, -74.0, -376.0, -278.0, 0.0, 8.0, 0.0, -12.0, 0.0, 13.0, 0.0, -400.0, -12.0, 4.0, -108.0, -380.0, -203.0, 16.0, 0.0, 0.0, 0.0, -6.0, -9.0, 0.0, -14.0, -9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -379.0, 0.0, -20.0, -131.0, -400.0, -244.0, 0.0, 4.0, 0.0, 0.0, -7.0, 0.0, 15.0, 2.0, -396.0, 0.0, 0.0, -339.0, 0.0, 0.0, 0.0, -18.0, -12.0, -6.0, -20.0, 0.0, -6.0, 7.0, -6.0, 0.0, -28.0, -25.0, 0.0, 0.0, -15.0, 1.0, 0.0, 0.0, 0.0, 15.0, -7.0, 0.0, 0.0, -13.0, 5.0, 0.0, -400.0, -358.0, -400.0, -33.0, 4.0, 0.0, 0.0, -31.0, 15.0, 0.0, 14.0, -11.0, 3.0, -400.0, 0.0, 0.0, 0.0, -378.0, 9.0, 0.0, -6.0, 0.0, 15.0, 0.0, -17.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -360.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -396.0, -378.0, 0.0, 0.0, -394.0, 11.0, 0.0, 10.0, -12.0, 0.0, -10.0, 0.0, -18.0, 0.0, -6.0, -20.0, -12.0, 0.0, 0.0, 15.0, 2.0, 3.0, 0.0, 0.0, 0.0, -12.0, 15.0, 0.0, 11.0, 7.0, 0.0, -28.0, 0.0, 0.0, 0.0, -20.0, 1.0, 14.0, -8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 187.0, 10.0, 0.0, 10.0, 62.0, 0.0, 0.0, 2.0, 0.0, 37.0, 4.0, 200.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 200.0, 6.0, 5.0, 190.0, 0.0, 0.0, 109.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 10.0, 67.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 193.0, 5.0, 177.0, 0.0, 0.0, 0.0, 1.0, 10.0, 6.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 3.0, 13.0, 13.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 16.0, 196.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 177.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 9.0, 4.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9214984532193745, "mean_inference_ms": 2.4286799879950234, "mean_action_processing_ms": 0.4353268272632023, "mean_env_wait_ms": 0.3320554875874012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003938198089599609, "StateBufferConnector_ms": 0.005830049514770508, "ViewRequirementAgentConnector_ms": 0.14143216609954834}, "num_episodes": 22, "episode_return_max": 18.0, "episode_return_min": -576.0, "episode_return_mean": -47.58, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.44024182030614, "num_env_steps_trained_throughput_per_sec": 314.44024182030614, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 13056.548, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13056.482, "sample_time_ms": 1658.634, "learn_time_ms": 11378.487, "learn_throughput": 351.541, "synch_weights_time_ms": 14.521}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "e1352_00000", "date": "2024-08-13_16-58-28", "timestamp": 1723582708, "time_this_iter_s": 12.792722940444946, "time_total_s": 1227.4266827106476, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1749ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1227.4266827106476, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 67.64444444444445, "ram_util_percent": 83.27222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.328913776513445, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 0.009999999999999998, "total_loss": 0.2589379490047654, "policy_loss": -0.0006769553487184186, "vf_loss": 0.2562478380169345, "vf_explained_var": 0.09922385054921347, "kl": 0.010510215546363276, "entropy": 0.05558462495490083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2681831592061954, "cur_kl_coeff": 0.22806973457336432, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00011310181087720646, "vf_loss": 0.38472252074249025, "vf_explained_var": 7.80584320189461e-06, "kl": Infinity, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -576.0, "episode_reward_mean": -35.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -32.875, "predator_policy": 15.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-78.0, 0.0, -3.0, 0.0, -6.0, 0.0, 10.0, 0.0, 0.0, 3.0, -187.0, -74.0, -444.0, 4.0, 0.0, -3.0, 17.0, -198.0, -162.0, 0.0, -7.0, -12.0, -10.0, 4.0, -3.0, -27.0, 0.0, -4.0, 0.0, 15.0, -3.0, -3.0, 5.0, -558.0, -221.0, 4.0, -15.0, 15.0, 13.0, -197.0, 0.0, -189.0, 9.0, -1.0, 15.0, -7.0, 0.0, 0.0, 0.0, 9.0, 0.0, -3.0, 0.0, 10.0, 0.0, 2.0, -576.0, 0.0, -186.0, 10.0, -6.0, -5.0, -9.0, -12.0, -6.0, 15.0, 5.0, 0.0, -2.0, 15.0, 18.0, -8.0, 0.0, -10.0, 17.0, -4.0, 0.0, 3.0, 11.0, 0.0, -10.0, 0.0, 0.0, 12.0, 17.0, 12.0, 13.0, 4.0, -8.0, -3.0, -5.0, -17.0, -569.0, -3.0, 9.0, 7.0, 0.0, 7.0, 25.0, -8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-203.0, 16.0, 0.0, 0.0, 0.0, -6.0, -9.0, 0.0, -14.0, -9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -379.0, 0.0, -20.0, -131.0, -400.0, -244.0, 0.0, 4.0, 0.0, 0.0, -7.0, 0.0, 15.0, 2.0, -396.0, 0.0, 0.0, -339.0, 0.0, 0.0, 0.0, -18.0, -12.0, -6.0, -20.0, 0.0, -6.0, 7.0, -6.0, 0.0, -28.0, -25.0, 0.0, 0.0, -15.0, 1.0, 0.0, 0.0, 0.0, 15.0, -7.0, 0.0, 0.0, -13.0, 5.0, 0.0, -400.0, -358.0, -400.0, -33.0, 4.0, 0.0, 0.0, -31.0, 15.0, 0.0, 14.0, -11.0, 3.0, -400.0, 0.0, 0.0, 0.0, -378.0, 9.0, 0.0, -6.0, 0.0, 15.0, 0.0, -17.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -360.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -396.0, -378.0, 0.0, 0.0, -394.0, 11.0, 0.0, 10.0, -12.0, 0.0, -10.0, 0.0, -18.0, 0.0, -6.0, -20.0, -12.0, 0.0, 0.0, 15.0, 2.0, 3.0, 0.0, 0.0, 0.0, -12.0, 15.0, 0.0, 11.0, 7.0, 0.0, -28.0, 0.0, 0.0, 0.0, -20.0, 1.0, 14.0, -8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 10.0, 7.0, 12.0, 0.0, 13.0, 0.0, -11.0, -10.0, -18.0, 0.0, -6.0, 0.0, -10.0, 0.0, -20.0, -8.0, -373.0, -392.0, -6.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, -16.0, 12.0, 10.0, 15.0, -2.0, -14.0], "policy_predator_policy_reward": [0.0, 109.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 17.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 10.0, 67.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 193.0, 5.0, 177.0, 0.0, 0.0, 0.0, 1.0, 10.0, 6.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 3.0, 13.0, 13.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 16.0, 196.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 177.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 9.0, 4.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 10.0, 0.0, 10.0, 3.0, 0.0, 0.0, 5.0, 11.0, 0.0, 196.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 7.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9195582910111005, "mean_inference_ms": 2.423093310787129, "mean_action_processing_ms": 0.4339514380904275, "mean_env_wait_ms": 0.3311977126949264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003884553909301758, "StateBufferConnector_ms": 0.005788326263427734, "ViewRequirementAgentConnector_ms": 0.13326334953308105}, "num_episodes": 18, "episode_return_max": 25.0, "episode_return_min": -576.0, "episode_return_mean": -35.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.5032908310259, "num_env_steps_trained_throughput_per_sec": 308.5032908310259, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 13042.943, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13042.877, "sample_time_ms": 1671.411, "learn_time_ms": 11351.516, "learn_throughput": 352.376, "synch_weights_time_ms": 14.791}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "e1352_00000", "date": "2024-08-13_16-58-41", "timestamp": 1723582721, "time_this_iter_s": 13.025917053222656, "time_total_s": 1240.4525997638702, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b171d5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1240.4525997638702, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 67.51111111111112, "ram_util_percent": 83.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4417814248847582, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 0.009999999999999998, "total_loss": 1.0700291989814668, "policy_loss": 0.0002899566517462806, "vf_loss": 1.0594515839424083, "vf_explained_var": 0.08598445559304858, "kl": 0.032112664950231296, "entropy": 0.06390946854826847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.277166317714127, "cur_kl_coeff": 0.3421046018600463, "cur_lr": 0.009999999999999998, "total_loss": 1.3881398979948942, "policy_loss": 0.00028151146840875744, "vf_loss": 1.387858388789747, "vf_explained_var": -5.5189485903139465e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -576.0, "episode_reward_mean": -31.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -28.115, "predator_policy": 12.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, -3.0, -27.0, 0.0, -4.0, 0.0, 15.0, -3.0, -3.0, 5.0, -558.0, -221.0, 4.0, -15.0, 15.0, 13.0, -197.0, 0.0, -189.0, 9.0, -1.0, 15.0, -7.0, 0.0, 0.0, 0.0, 9.0, 0.0, -3.0, 0.0, 10.0, 0.0, 2.0, -576.0, 0.0, -186.0, 10.0, -6.0, -5.0, -9.0, -12.0, -6.0, 15.0, 5.0, 0.0, -2.0, 15.0, 18.0, -8.0, 0.0, -10.0, 17.0, -4.0, 0.0, 3.0, 11.0, 0.0, -10.0, 0.0, 0.0, 12.0, 17.0, 12.0, 13.0, 4.0, -8.0, -3.0, -5.0, -17.0, -569.0, -3.0, 9.0, 7.0, 0.0, 7.0, 25.0, -8.0, 0.0, 14.0, -7.0, 0.0, 14.0, 9.0, 0.0, 0.0, 3.0, -2.0, -196.0, 0.0, 8.0, -570.0, -13.0, 0.0, 3.0, 1.0, 0.0, 5.0, -9.0, -5.0, 7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 7.0, -6.0, 0.0, -28.0, -25.0, 0.0, 0.0, -15.0, 1.0, 0.0, 0.0, 0.0, 15.0, -7.0, 0.0, 0.0, -13.0, 5.0, 0.0, -400.0, -358.0, -400.0, -33.0, 4.0, 0.0, 0.0, -31.0, 15.0, 0.0, 14.0, -11.0, 3.0, -400.0, 0.0, 0.0, 0.0, -378.0, 9.0, 0.0, -6.0, 0.0, 15.0, 0.0, -17.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -360.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -396.0, -378.0, 0.0, 0.0, -394.0, 11.0, 0.0, 10.0, -12.0, 0.0, -10.0, 0.0, -18.0, 0.0, -6.0, -20.0, -12.0, 0.0, 0.0, 15.0, 2.0, 3.0, 0.0, 0.0, 0.0, -12.0, 15.0, 0.0, 11.0, 7.0, 0.0, -28.0, 0.0, 0.0, 0.0, -20.0, 1.0, 14.0, -8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 10.0, 7.0, 12.0, 0.0, 13.0, 0.0, -11.0, -10.0, -18.0, 0.0, -6.0, 0.0, -10.0, 0.0, -20.0, -8.0, -373.0, -392.0, -6.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, -16.0, 12.0, 10.0, 15.0, -2.0, -14.0, 0.0, 0.0, 14.0, 0.0, -2.0, -16.0, 0.0, 0.0, -3.0, 15.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, -4.0, 0.0, -394.0, 0.0, -10.0, 8.0, 0.0, -400.0, -370.0, -26.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, -13.0, 0.0, -19.0, 0.0, -15.0, 0.0, 7.0], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 3.0, 13.0, 13.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 16.0, 196.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 0.0, 10.0, 200.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 177.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 9.0, 4.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 10.0, 0.0, 10.0, 3.0, 0.0, 0.0, 5.0, 11.0, 0.0, 196.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 198.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9169787070593813, "mean_inference_ms": 2.4163714886645606, "mean_action_processing_ms": 0.4322451773880382, "mean_env_wait_ms": 0.330234412627399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00389254093170166, "StateBufferConnector_ms": 0.003751039505004883, "ViewRequirementAgentConnector_ms": 0.12450170516967773}, "num_episodes": 23, "episode_return_max": 25.0, "episode_return_min": -576.0, "episode_return_mean": -31.15, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.802168800834, "num_env_steps_trained_throughput_per_sec": 311.802168800834, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 12998.573, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12998.507, "sample_time_ms": 1683.811, "learn_time_ms": 11295.36, "learn_throughput": 354.128, "synch_weights_time_ms": 14.78}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "e1352_00000", "date": "2024-08-13_16-58-54", "timestamp": 1723582734, "time_this_iter_s": 12.884720802307129, "time_total_s": 1253.3373205661774, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b171d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1253.3373205661774, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 67.28333333333335, "ram_util_percent": 83.72222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.601402016851322, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 0.009999999999999998, "total_loss": 1.224152991822157, "policy_loss": -0.00016205992929085538, "vf_loss": 1.2161066566194807, "vf_explained_var": 0.07159527776733278, "kl": 0.017081535729422757, "entropy": 0.08922815002162929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2828548985649215, "cur_kl_coeff": 0.17105230093002316, "cur_lr": 0.009999999999999998, "total_loss": 1.295762563603265, "policy_loss": -0.00017848417197388632, "vf_loss": 1.295941049980108, "vf_explained_var": -5.834317081189029e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -576.0, "episode_reward_mean": -31.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -29.865, "predator_policy": 14.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.0, 9.0, -1.0, 15.0, -7.0, 0.0, 0.0, 0.0, 9.0, 0.0, -3.0, 0.0, 10.0, 0.0, 2.0, -576.0, 0.0, -186.0, 10.0, -6.0, -5.0, -9.0, -12.0, -6.0, 15.0, 5.0, 0.0, -2.0, 15.0, 18.0, -8.0, 0.0, -10.0, 17.0, -4.0, 0.0, 3.0, 11.0, 0.0, -10.0, 0.0, 0.0, 12.0, 17.0, 12.0, 13.0, 4.0, -8.0, -3.0, -5.0, -17.0, -569.0, -3.0, 9.0, 7.0, 0.0, 7.0, 25.0, -8.0, 0.0, 14.0, -7.0, 0.0, 14.0, 9.0, 0.0, 0.0, 3.0, -2.0, -196.0, 0.0, 8.0, -570.0, -13.0, 0.0, 3.0, 1.0, 0.0, 5.0, -9.0, -5.0, 7.0, -387.0, -200.0, -195.0, -4.0, -5.0, 0.0, 12.0, 1.0, -5.0, -16.0, -4.0, 8.0, -186.0, 0.0, -3.0, 0.0, 0.0, 21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -378.0, 9.0, 0.0, -6.0, 0.0, 15.0, 0.0, -17.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -360.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 2.0, 0.0, -396.0, -378.0, 0.0, 0.0, -394.0, 11.0, 0.0, 10.0, -12.0, 0.0, -10.0, 0.0, -18.0, 0.0, -6.0, -20.0, -12.0, 0.0, 0.0, 15.0, 2.0, 3.0, 0.0, 0.0, 0.0, -12.0, 15.0, 0.0, 11.0, 7.0, 0.0, -28.0, 0.0, 0.0, 0.0, -20.0, 1.0, 14.0, -8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 10.0, 7.0, 12.0, 0.0, 13.0, 0.0, -11.0, -10.0, -18.0, 0.0, -6.0, 0.0, -10.0, 0.0, -20.0, -8.0, -373.0, -392.0, -6.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, -16.0, 12.0, 10.0, 15.0, -2.0, -14.0, 0.0, 0.0, 14.0, 0.0, -2.0, -16.0, 0.0, 0.0, -3.0, 15.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, -4.0, 0.0, -394.0, 0.0, -10.0, 8.0, 0.0, -400.0, -370.0, -26.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, -13.0, 0.0, -19.0, 0.0, -15.0, 0.0, 7.0, -400.0, -374.0, -400.0, 0.0, -400.0, 4.0, 0.0, -12.0, -20.0, 2.0, 0.0, 0.0, 9.0, 0.0, 11.0, -20.0, -15.0, 0.0, -10.0, -17.0, 0.0, -8.0, -15.0, 13.0, -379.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 9.0, 9.0], "policy_predator_policy_reward": [10.0, 179.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 177.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 9.0, 4.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 10.0, 0.0, 10.0, 3.0, 0.0, 0.0, 5.0, 11.0, 0.0, 196.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 198.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 187.0, 200.0, 0.0, 196.0, 5.0, 0.0, 8.0, 10.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 0.0, 10.0, 0.0, 11.0, 0.0, 4.0, 0.0, 10.0, 189.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9150150771469207, "mean_inference_ms": 2.4111543999863785, "mean_action_processing_ms": 0.4309026982749954, "mean_env_wait_ms": 0.3293856657849905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004040360450744629, "StateBufferConnector_ms": 0.0037735700607299805, "ViewRequirementAgentConnector_ms": 0.12791049480438232}, "num_episodes": 18, "episode_return_max": 25.0, "episode_return_min": -576.0, "episode_return_mean": -31.03, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.2227039967012, "num_env_steps_trained_throughput_per_sec": 317.2227039967012, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 12968.081, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12968.013, "sample_time_ms": 1631.717, "learn_time_ms": 11319.515, "learn_throughput": 353.372, "synch_weights_time_ms": 13.381}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "e1352_00000", "date": "2024-08-13_16-59-07", "timestamp": 1723582747, "time_this_iter_s": 12.668951034545898, "time_total_s": 1266.0062716007233, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1749ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1266.0062716007233, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 65.67777777777776, "ram_util_percent": 83.48333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.59360984128619, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 0.009999999999999998, "total_loss": 1.0829794007318991, "policy_loss": 5.541306097434942e-05, "vf_loss": 1.0781274905438145, "vf_explained_var": 0.04116821181837213, "kl": 0.009981426689943186, "entropy": 0.048237331018998506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.270603698660144, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 0.009999999999999998, "total_loss": 1.0911593573788803, "policy_loss": -0.00024088600147811193, "vf_loss": 1.0914002402907326, "vf_explained_var": -7.505770082826967e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -570.0, "episode_reward_mean": -31.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -30.04, "predator_policy": 14.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -6.0, 15.0, 5.0, 0.0, -2.0, 15.0, 18.0, -8.0, 0.0, -10.0, 17.0, -4.0, 0.0, 3.0, 11.0, 0.0, -10.0, 0.0, 0.0, 12.0, 17.0, 12.0, 13.0, 4.0, -8.0, -3.0, -5.0, -17.0, -569.0, -3.0, 9.0, 7.0, 0.0, 7.0, 25.0, -8.0, 0.0, 14.0, -7.0, 0.0, 14.0, 9.0, 0.0, 0.0, 3.0, -2.0, -196.0, 0.0, 8.0, -570.0, -13.0, 0.0, 3.0, 1.0, 0.0, 5.0, -9.0, -5.0, 7.0, -387.0, -200.0, -195.0, -4.0, -5.0, 0.0, 12.0, 1.0, -5.0, -16.0, -4.0, 8.0, -186.0, 0.0, -3.0, 0.0, 0.0, 21.0, -169.0, -195.0, -200.0, 3.0, 0.0, 0.0, 13.0, 0.0, 4.0, 0.0, -14.0, 0.0, -14.0, 5.0, 6.0, 0.0, -3.0, 0.0, -182.0, 4.0, -10.0, -175.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -20.0, -12.0, 0.0, 0.0, 15.0, 2.0, 3.0, 0.0, 0.0, 0.0, -12.0, 15.0, 0.0, 11.0, 7.0, 0.0, -28.0, 0.0, 0.0, 0.0, -20.0, 1.0, 14.0, -8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 9.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 10.0, 7.0, 12.0, 0.0, 13.0, 0.0, -11.0, -10.0, -18.0, 0.0, -6.0, 0.0, -10.0, 0.0, -20.0, -8.0, -373.0, -392.0, -6.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, -16.0, 12.0, 10.0, 15.0, -2.0, -14.0, 0.0, 0.0, 14.0, 0.0, -2.0, -16.0, 0.0, 0.0, -3.0, 15.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, -4.0, 0.0, -394.0, 0.0, -10.0, 8.0, 0.0, -400.0, -370.0, -26.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, -13.0, 0.0, -19.0, 0.0, -15.0, 0.0, 7.0, -400.0, -374.0, -400.0, 0.0, -400.0, 4.0, 0.0, -12.0, -20.0, 2.0, 0.0, 0.0, 9.0, 0.0, 11.0, -20.0, -15.0, 0.0, -10.0, -17.0, 0.0, -8.0, -15.0, 13.0, -379.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 9.0, 9.0, -352.0, 0.0, -400.0, 0.0, 0.0, -400.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, -15.0, -18.0, 0.0, 0.0, -12.0, -20.0, 0.0, 3.0, -1.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, 0.0, -364.0, 0.0, 0.0, 4.0, -20.0, 0.0, -378.0, 14.0], "policy_predator_policy_reward": [4.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 10.0, 0.0, 10.0, 3.0, 0.0, 0.0, 5.0, 11.0, 0.0, 196.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 198.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 187.0, 200.0, 0.0, 196.0, 5.0, 0.0, 8.0, 10.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 0.0, 10.0, 0.0, 11.0, 0.0, 4.0, 0.0, 10.0, 189.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 183.0, 196.0, 9.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 12.0, 6.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 10.0, 179.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9122468230511143, "mean_inference_ms": 2.4056457692142494, "mean_action_processing_ms": 0.4294540786323175, "mean_env_wait_ms": 0.32811669277772587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004088163375854492, "StateBufferConnector_ms": 0.004343271255493164, "ViewRequirementAgentConnector_ms": 0.11852872371673584}, "num_episodes": 22, "episode_return_max": 25.0, "episode_return_min": -570.0, "episode_return_mean": -31.03, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.7273321442636, "num_env_steps_trained_throughput_per_sec": 319.7273321442636, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 12861.903, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12861.846, "sample_time_ms": 1533.217, "learn_time_ms": 11312.877, "learn_throughput": 353.579, "synch_weights_time_ms": 12.52}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "e1352_00000", "date": "2024-08-13_16-59-20", "timestamp": 1723582760, "time_this_iter_s": 12.56023120880127, "time_total_s": 1278.5665028095245, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af103a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1278.5665028095245, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 64.71666666666667, "ram_util_percent": 83.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2452217933835175, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 0.009999999999999998, "total_loss": 1.5352368963143181, "policy_loss": 0.0035870827116052466, "vf_loss": 1.51986480973385, "vf_explained_var": 0.06516802355095193, "kl": 0.024524401611570403, "entropy": 0.07027412830423711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.091596789073221, "cur_kl_coeff": 0.04276307523250579, "cur_lr": 0.009999999999999998, "total_loss": 1.5968907132192893, "policy_loss": 0.00012297912749644152, "vf_loss": 1.5967677328637038, "vf_explained_var": -6.3389066665891615e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -570.0, "episode_reward_mean": -35.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -36.09, "predator_policy": 18.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 12.0, 17.0, 12.0, 13.0, 4.0, -8.0, -3.0, -5.0, -17.0, -569.0, -3.0, 9.0, 7.0, 0.0, 7.0, 25.0, -8.0, 0.0, 14.0, -7.0, 0.0, 14.0, 9.0, 0.0, 0.0, 3.0, -2.0, -196.0, 0.0, 8.0, -570.0, -13.0, 0.0, 3.0, 1.0, 0.0, 5.0, -9.0, -5.0, 7.0, -387.0, -200.0, -195.0, -4.0, -5.0, 0.0, 12.0, 1.0, -5.0, -16.0, -4.0, 8.0, -186.0, 0.0, -3.0, 0.0, 0.0, 21.0, -169.0, -195.0, -200.0, 3.0, 0.0, 0.0, 13.0, 0.0, 4.0, 0.0, -14.0, 0.0, -14.0, 5.0, 6.0, 0.0, -3.0, 0.0, -182.0, 4.0, -10.0, -175.0, 14.0, -10.0, -27.0, -15.0, 0.0, 0.0, 11.0, -2.0, -5.0, 18.0, -3.0, 0.0, -2.0, -395.0, -2.0, -5.0, -2.0, 27.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 10.0, 7.0, 12.0, 0.0, 13.0, 0.0, -11.0, -10.0, -18.0, 0.0, -6.0, 0.0, -10.0, 0.0, -20.0, -8.0, -373.0, -392.0, -6.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, -16.0, 12.0, 10.0, 15.0, -2.0, -14.0, 0.0, 0.0, 14.0, 0.0, -2.0, -16.0, 0.0, 0.0, -3.0, 15.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, -4.0, 0.0, -394.0, 0.0, -10.0, 8.0, 0.0, -400.0, -370.0, -26.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, -13.0, 0.0, -19.0, 0.0, -15.0, 0.0, 7.0, -400.0, -374.0, -400.0, 0.0, -400.0, 4.0, 0.0, -12.0, -20.0, 2.0, 0.0, 0.0, 9.0, 0.0, 11.0, -20.0, -15.0, 0.0, -10.0, -17.0, 0.0, -8.0, -15.0, 13.0, -379.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 9.0, 9.0, -352.0, 0.0, -400.0, 0.0, 0.0, -400.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, -15.0, -18.0, 0.0, 0.0, -12.0, -20.0, 0.0, 3.0, -1.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, 0.0, -364.0, 0.0, 0.0, 4.0, -20.0, 0.0, -378.0, 14.0, 0.0, 14.0, -20.0, 0.0, -18.0, -18.0, -32.0, 1.0, 0.0, 0.0, 0.0, -2.0, -367.0, 0.0, -12.0, 0.0, -26.0, 7.0, 14.0, 4.0, 0.0, -6.0, 0.0, 0.0, -12.0, 0.0, -400.0, -392.0, -4.0, 0.0, 0.0, -10.0, -4.0, 0.0, 15.0, 12.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 10.0, 0.0, 10.0, 3.0, 0.0, 0.0, 5.0, 11.0, 0.0, 196.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 198.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 187.0, 200.0, 0.0, 196.0, 5.0, 0.0, 8.0, 10.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 0.0, 10.0, 0.0, 11.0, 0.0, 4.0, 0.0, 10.0, 189.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 183.0, 196.0, 9.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 12.0, 6.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 10.0, 179.0, 10.0, 0.0, 0.0, 0.0, 10.0, 9.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 2.0, 189.0, 189.0, 0.0, 10.0, 10.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 200.0, 197.0, 0.0, 2.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9110988793862979, "mean_inference_ms": 2.4006883762308338, "mean_action_processing_ms": 0.4282062634544617, "mean_env_wait_ms": 0.32778674494467813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004140138626098633, "StateBufferConnector_ms": 0.0038411617279052734, "ViewRequirementAgentConnector_ms": 0.12057912349700928}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -570.0, "episode_return_mean": -35.33, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.383256507408, "num_env_steps_trained_throughput_per_sec": 317.383256507408, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 12843.987, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12843.933, "sample_time_ms": 1524.691, "learn_time_ms": 11303.881, "learn_throughput": 353.861, "synch_weights_time_ms": 12.18}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "e1352_00000", "date": "2024-08-13_16-59-32", "timestamp": 1723582772, "time_this_iter_s": 12.65481686592102, "time_total_s": 1291.2213196754456, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16e0c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1291.2213196754456, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 64.02777777777777, "ram_util_percent": 83.28333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9101125771406466, "cur_kl_coeff": 0.72081298828125, "cur_lr": 0.009999999999999998, "total_loss": 0.2582862005869626, "policy_loss": -0.00028874221511638514, "vf_loss": 0.25712728737681, "vf_explained_var": 0.12856335469654628, "kl": 0.0020083651982591914, "entropy": 0.0733038055340922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5897645982650044, "cur_kl_coeff": 0.021381537616252895, "cur_lr": 0.009999999999999998, "total_loss": 0.39985208428371205, "policy_loss": -0.00015662110942815031, "vf_loss": 0.40000870493333046, "vf_explained_var": 6.469406148113271e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -570.0, "episode_reward_mean": -37.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -38.225, "predator_policy": 19.395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 9.0, 0.0, 0.0, 3.0, -2.0, -196.0, 0.0, 8.0, -570.0, -13.0, 0.0, 3.0, 1.0, 0.0, 5.0, -9.0, -5.0, 7.0, -387.0, -200.0, -195.0, -4.0, -5.0, 0.0, 12.0, 1.0, -5.0, -16.0, -4.0, 8.0, -186.0, 0.0, -3.0, 0.0, 0.0, 21.0, -169.0, -195.0, -200.0, 3.0, 0.0, 0.0, 13.0, 0.0, 4.0, 0.0, -14.0, 0.0, -14.0, 5.0, 6.0, 0.0, -3.0, 0.0, -182.0, 4.0, -10.0, -175.0, 14.0, -10.0, -27.0, -15.0, 0.0, 0.0, 11.0, -2.0, -5.0, 18.0, -3.0, 0.0, -2.0, -395.0, -2.0, -5.0, -2.0, 27.0, 0.0, 0.0, 0.0, 3.0, -7.0, 7.0, -1.0, 5.0, -204.0, 17.0, 19.0, -26.0, 0.0, 4.0, -5.0, -10.0, 9.0, 5.0, -14.0, 0.0, -558.0, 23.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0, 15.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, -4.0, 0.0, -394.0, 0.0, -10.0, 8.0, 0.0, -400.0, -370.0, -26.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, -13.0, 0.0, -19.0, 0.0, -15.0, 0.0, 7.0, -400.0, -374.0, -400.0, 0.0, -400.0, 4.0, 0.0, -12.0, -20.0, 2.0, 0.0, 0.0, 9.0, 0.0, 11.0, -20.0, -15.0, 0.0, -10.0, -17.0, 0.0, -8.0, -15.0, 13.0, -379.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 9.0, 9.0, -352.0, 0.0, -400.0, 0.0, 0.0, -400.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, -15.0, -18.0, 0.0, 0.0, -12.0, -20.0, 0.0, 3.0, -1.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, 0.0, -364.0, 0.0, 0.0, 4.0, -20.0, 0.0, -378.0, 14.0, 0.0, 14.0, -20.0, 0.0, -18.0, -18.0, -32.0, 1.0, 0.0, 0.0, 0.0, -2.0, -367.0, 0.0, -12.0, 0.0, -26.0, 7.0, 14.0, 4.0, 0.0, -6.0, 0.0, 0.0, -12.0, 0.0, -400.0, -392.0, -4.0, 0.0, 0.0, -10.0, -4.0, 0.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -10.0, 0.0, -14.0, 7.0, 0.0, 0.0, -2.0, 0.0, 4.0, -396.0, -12.0, 2.0, 11.0, 12.0, 7.0, -20.0, -20.0, 0.0, 0.0, 7.0, -6.0, -15.0, 0.0, 0.0, -20.0, 5.0, 0.0, 15.0, -20.0, -28.0, 0.0, 0.0, 0.0, -370.0, -378.0, 14.0, 9.0, 0.0, 0.0], "policy_predator_policy_reward": [2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 198.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 187.0, 200.0, 0.0, 196.0, 5.0, 0.0, 8.0, 10.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 0.0, 10.0, 0.0, 11.0, 0.0, 4.0, 0.0, 10.0, 189.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 183.0, 196.0, 9.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 12.0, 6.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 10.0, 179.0, 10.0, 0.0, 0.0, 0.0, 10.0, 9.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 2.0, 189.0, 189.0, 0.0, 10.0, 10.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 200.0, 197.0, 0.0, 2.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 6.0, 198.0, 4.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 10.0, 0.0, 4.0, 0.0, 0.0, 10.0, 10.0, 4.0, 0.0, 0.0, 189.0, 1.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9089040929577135, "mean_inference_ms": 2.3951652761605646, "mean_action_processing_ms": 0.4271098843253012, "mean_env_wait_ms": 0.3272381543534003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053288936614990234, "StateBufferConnector_ms": 0.0037745237350463867, "ViewRequirementAgentConnector_ms": 0.1344977617263794}, "num_episodes": 23, "episode_return_max": 27.0, "episode_return_min": -570.0, "episode_return_mean": -37.66, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.513954271418, "num_env_steps_trained_throughput_per_sec": 306.513954271418, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 12896.9, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12896.846, "sample_time_ms": 1527.125, "learn_time_ms": 11354.423, "learn_throughput": 352.286, "synch_weights_time_ms": 12.313}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "e1352_00000", "date": "2024-08-13_16-59-45", "timestamp": 1723582785, "time_this_iter_s": 13.099654912948608, "time_total_s": 1304.3209745883942, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1749ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1304.3209745883942, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 65.83684210526316, "ram_util_percent": 83.4157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.138817568545146, "cur_kl_coeff": 0.360406494140625, "cur_lr": 0.009999999999999998, "total_loss": 0.7342470668295704, "policy_loss": 1.5299101039846107e-05, "vf_loss": 0.7309979651891996, "vf_explained_var": 0.10121460106007006, "kl": 0.008972649683448406, "entropy": 0.06132915148741896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.604119672800695, "cur_kl_coeff": 0.010690768808126448, "cur_lr": 0.009999999999999998, "total_loss": 1.1051013327543697, "policy_loss": -0.0001263484090231556, "vf_loss": 1.105227684438544, "vf_explained_var": -8.672633499064773e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -558.0, "episode_reward_mean": -32.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -34.805, "predator_policy": 18.605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, -387.0, -200.0, -195.0, -4.0, -5.0, 0.0, 12.0, 1.0, -5.0, -16.0, -4.0, 8.0, -186.0, 0.0, -3.0, 0.0, 0.0, 21.0, -169.0, -195.0, -200.0, 3.0, 0.0, 0.0, 13.0, 0.0, 4.0, 0.0, -14.0, 0.0, -14.0, 5.0, 6.0, 0.0, -3.0, 0.0, -182.0, 4.0, -10.0, -175.0, 14.0, -10.0, -27.0, -15.0, 0.0, 0.0, 11.0, -2.0, -5.0, 18.0, -3.0, 0.0, -2.0, -395.0, -2.0, -5.0, -2.0, 27.0, 0.0, 0.0, 0.0, 3.0, -7.0, 7.0, -1.0, 5.0, -204.0, 17.0, 19.0, -26.0, 0.0, 4.0, -5.0, -10.0, 9.0, 5.0, -14.0, 0.0, -558.0, 23.0, 0.0, -10.0, -8.0, -2.0, 0.0, 2.0, -10.0, -13.0, -200.0, -5.0, 14.0, 10.0, -10.0, 9.0, -16.0, 0.0, -1.0, 0.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 7.0, -400.0, -374.0, -400.0, 0.0, -400.0, 4.0, 0.0, -12.0, -20.0, 2.0, 0.0, 0.0, 9.0, 0.0, 11.0, -20.0, -15.0, 0.0, -10.0, -17.0, 0.0, -8.0, -15.0, 13.0, -379.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 9.0, 9.0, -352.0, 0.0, -400.0, 0.0, 0.0, -400.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, -15.0, -18.0, 0.0, 0.0, -12.0, -20.0, 0.0, 3.0, -1.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, 0.0, -364.0, 0.0, 0.0, 4.0, -20.0, 0.0, -378.0, 14.0, 0.0, 14.0, -20.0, 0.0, -18.0, -18.0, -32.0, 1.0, 0.0, 0.0, 0.0, -2.0, -367.0, 0.0, -12.0, 0.0, -26.0, 7.0, 14.0, 4.0, 0.0, -6.0, 0.0, 0.0, -12.0, 0.0, -400.0, -392.0, -4.0, 0.0, 0.0, -10.0, -4.0, 0.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -10.0, 0.0, -14.0, 7.0, 0.0, 0.0, -2.0, 0.0, 4.0, -396.0, -12.0, 2.0, 11.0, 12.0, 7.0, -20.0, -20.0, 0.0, 0.0, 7.0, -6.0, -15.0, 0.0, 0.0, -20.0, 5.0, 0.0, 15.0, -20.0, -28.0, 0.0, 0.0, 0.0, -370.0, -378.0, 14.0, 9.0, 0.0, 0.0, -20.0, 0.0, 0.0, -16.0, -4.0, 0.0, 0.0, 0.0, 11.0, -19.0, -20.0, 0.0, -6.0, -20.0, -400.0, 0.0, 2.0, -17.0, 0.0, 14.0, 5.0, 0.0, -13.0, -10.0, -12.0, 15.0, -18.0, -15.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 14.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 200.0, 187.0, 200.0, 0.0, 196.0, 5.0, 0.0, 8.0, 10.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 0.0, 10.0, 0.0, 11.0, 0.0, 4.0, 0.0, 10.0, 189.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 183.0, 196.0, 9.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 12.0, 6.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 10.0, 179.0, 10.0, 0.0, 0.0, 0.0, 10.0, 9.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 2.0, 189.0, 189.0, 0.0, 10.0, 10.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 200.0, 197.0, 0.0, 2.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 6.0, 198.0, 4.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 10.0, 0.0, 4.0, 0.0, 0.0, 10.0, 10.0, 4.0, 0.0, 0.0, 189.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 2.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 13.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 5.0, 8.0, 6.0, 0.0, 9.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9080683989412793, "mean_inference_ms": 2.391409714638744, "mean_action_processing_ms": 0.4256387389609837, "mean_env_wait_ms": 0.3264786981574603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005658626556396484, "StateBufferConnector_ms": 0.004080653190612793, "ViewRequirementAgentConnector_ms": 0.14733707904815674}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -558.0, "episode_return_mean": -32.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.9005687848692, "num_env_steps_trained_throughput_per_sec": 310.9005687848692, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 12821.125, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12821.071, "sample_time_ms": 1581.223, "learn_time_ms": 11225.731, "learn_throughput": 356.324, "synch_weights_time_ms": 12.021}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "e1352_00000", "date": "2024-08-13_16-59-58", "timestamp": 1723582798, "time_this_iter_s": 12.90645980834961, "time_total_s": 1317.2274343967438, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3af0fbc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1317.2274343967438, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 63.58888888888888, "ram_util_percent": 83.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4445513664887697, "cur_kl_coeff": 0.360406494140625, "cur_lr": 0.009999999999999998, "total_loss": 0.5302714480294122, "policy_loss": 0.00021151215473692568, "vf_loss": 0.5282658064530955, "vf_explained_var": 0.02275887134844664, "kl": 0.004978063625104951, "entropy": 0.028530166204833642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9040219658899153, "cur_kl_coeff": 0.005345384404063224, "cur_lr": 0.009999999999999998, "total_loss": 0.6354155595251728, "policy_loss": 4.713753455136188e-05, "vf_loss": 0.6353684208005982, "vf_explained_var": 8.02833567220698e-07, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -588.0, "episode_reward_mean": -32.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -32.9, "predator_policy": 16.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -169.0, -195.0, -200.0, 3.0, 0.0, 0.0, 13.0, 0.0, 4.0, 0.0, -14.0, 0.0, -14.0, 5.0, 6.0, 0.0, -3.0, 0.0, -182.0, 4.0, -10.0, -175.0, 14.0, -10.0, -27.0, -15.0, 0.0, 0.0, 11.0, -2.0, -5.0, 18.0, -3.0, 0.0, -2.0, -395.0, -2.0, -5.0, -2.0, 27.0, 0.0, 0.0, 0.0, 3.0, -7.0, 7.0, -1.0, 5.0, -204.0, 17.0, 19.0, -26.0, 0.0, 4.0, -5.0, -10.0, 9.0, 5.0, -14.0, 0.0, -558.0, 23.0, 0.0, -10.0, -8.0, -2.0, 0.0, 2.0, -10.0, -13.0, -200.0, -5.0, 14.0, 10.0, -10.0, 9.0, -16.0, 0.0, -1.0, 0.0, 14.0, -6.0, -8.0, -199.0, 0.0, 7.0, 0.0, -588.0, -200.0, 7.0, 0.0, -4.0, 0.0, -24.0, 15.0, 15.0, 0.0, 12.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [9.0, 9.0, -352.0, 0.0, -400.0, 0.0, 0.0, -400.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, -15.0, -18.0, 0.0, 0.0, -12.0, -20.0, 0.0, 3.0, -1.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, 0.0, -364.0, 0.0, 0.0, 4.0, -20.0, 0.0, -378.0, 14.0, 0.0, 14.0, -20.0, 0.0, -18.0, -18.0, -32.0, 1.0, 0.0, 0.0, 0.0, -2.0, -367.0, 0.0, -12.0, 0.0, -26.0, 7.0, 14.0, 4.0, 0.0, -6.0, 0.0, 0.0, -12.0, 0.0, -400.0, -392.0, -4.0, 0.0, 0.0, -10.0, -4.0, 0.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -10.0, 0.0, -14.0, 7.0, 0.0, 0.0, -2.0, 0.0, 4.0, -396.0, -12.0, 2.0, 11.0, 12.0, 7.0, -20.0, -20.0, 0.0, 0.0, 7.0, -6.0, -15.0, 0.0, 0.0, -20.0, 5.0, 0.0, 15.0, -20.0, -28.0, 0.0, 0.0, 0.0, -370.0, -378.0, 14.0, 9.0, 0.0, 0.0, -20.0, 0.0, 0.0, -16.0, -4.0, 0.0, 0.0, 0.0, 11.0, -19.0, -20.0, 0.0, -6.0, -20.0, -400.0, 0.0, 2.0, -17.0, 0.0, 14.0, 5.0, 0.0, -13.0, -10.0, -12.0, 15.0, -18.0, -15.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 14.0, 0.0, -12.0, 0.0, 0.0, -22.0, 0.0, -398.0, 0.0, 0.0, 15.0, -16.0, 0.0, 0.0, -388.0, -400.0, 0.0, -400.0, 11.0, -14.0, 0.0, 0.0, -3.0, -12.0, 0.0, 0.0, -20.0, -20.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, -12.0], "policy_predator_policy_reward": [3.0, 0.0, 0.0, 183.0, 196.0, 9.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 12.0, 6.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 182.0, 0.0, 0.0, 0.0, 10.0, 179.0, 10.0, 0.0, 0.0, 0.0, 10.0, 9.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 2.0, 189.0, 189.0, 0.0, 10.0, 10.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 200.0, 197.0, 0.0, 2.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 6.0, 198.0, 4.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 10.0, 0.0, 4.0, 0.0, 0.0, 10.0, 10.0, 4.0, 0.0, 0.0, 189.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 2.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 13.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 5.0, 8.0, 6.0, 0.0, 9.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 10.0, 199.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.908425776798591, "mean_inference_ms": 2.391521726390765, "mean_action_processing_ms": 0.42537125781707374, "mean_env_wait_ms": 0.3264626777016211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007228851318359375, "StateBufferConnector_ms": 0.0051076412200927734, "ViewRequirementAgentConnector_ms": 0.16458821296691895}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -588.0, "episode_return_mean": -32.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.69306032335123, "num_env_steps_trained_throughput_per_sec": 294.69306032335123, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 12843.772, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12843.716, "sample_time_ms": 1730.226, "learn_time_ms": 11098.472, "learn_throughput": 360.41, "synch_weights_time_ms": 12.28}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "e1352_00000", "date": "2024-08-13_17-00-12", "timestamp": 1723582812, "time_this_iter_s": 13.620508193969727, "time_total_s": 1330.8479425907135, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b163b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1330.8479425907135, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 64.29473684210525, "ram_util_percent": 83.57368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.177103883974136, "cur_kl_coeff": 0.1802032470703125, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 3.801719599684316e-05, "vf_loss": 0.08942874370132962, "vf_explained_var": 0.33115433495511454, "kl": Infinity, "entropy": 0.0031191191647553127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4268566049664977, "cur_kl_coeff": 0.002672692202031612, "cur_lr": 0.009999999999999998, "total_loss": 0.17993557868329357, "policy_loss": 7.716422837730201e-06, "vf_loss": 0.17992786276982678, "vf_explained_var": 0.0001487615877989108, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -588.0, "episode_reward_mean": -24.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -25.425, "predator_policy": 12.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.0, 14.0, -10.0, -27.0, -15.0, 0.0, 0.0, 11.0, -2.0, -5.0, 18.0, -3.0, 0.0, -2.0, -395.0, -2.0, -5.0, -2.0, 27.0, 0.0, 0.0, 0.0, 3.0, -7.0, 7.0, -1.0, 5.0, -204.0, 17.0, 19.0, -26.0, 0.0, 4.0, -5.0, -10.0, 9.0, 5.0, -14.0, 0.0, -558.0, 23.0, 0.0, -10.0, -8.0, -2.0, 0.0, 2.0, -10.0, -13.0, -200.0, -5.0, 14.0, 10.0, -10.0, 9.0, -16.0, 0.0, -1.0, 0.0, 14.0, -6.0, -8.0, -199.0, 0.0, 7.0, 0.0, -588.0, -200.0, 7.0, 0.0, -4.0, 0.0, -24.0, 15.0, 15.0, 0.0, 12.0, -6.0, 0.0, 15.0, -10.0, 2.0, 0.0, 0.0, -20.0, 2.0, 0.0, 15.0, 0.0, 14.0, 9.0, -4.0, -10.0, -4.0, 4.0, -5.0, -10.0, 0.0, 0.0, 17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-378.0, 14.0, 0.0, 14.0, -20.0, 0.0, -18.0, -18.0, -32.0, 1.0, 0.0, 0.0, 0.0, -2.0, -367.0, 0.0, -12.0, 0.0, -26.0, 7.0, 14.0, 4.0, 0.0, -6.0, 0.0, 0.0, -12.0, 0.0, -400.0, -392.0, -4.0, 0.0, 0.0, -10.0, -4.0, 0.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -10.0, 0.0, -14.0, 7.0, 0.0, 0.0, -2.0, 0.0, 4.0, -396.0, -12.0, 2.0, 11.0, 12.0, 7.0, -20.0, -20.0, 0.0, 0.0, 7.0, -6.0, -15.0, 0.0, 0.0, -20.0, 5.0, 0.0, 15.0, -20.0, -28.0, 0.0, 0.0, 0.0, -370.0, -378.0, 14.0, 9.0, 0.0, 0.0, -20.0, 0.0, 0.0, -16.0, -4.0, 0.0, 0.0, 0.0, 11.0, -19.0, -20.0, 0.0, -6.0, -20.0, -400.0, 0.0, 2.0, -17.0, 0.0, 14.0, 5.0, 0.0, -13.0, -10.0, -12.0, 15.0, -18.0, -15.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 14.0, 0.0, -12.0, 0.0, 0.0, -22.0, 0.0, -398.0, 0.0, 0.0, 15.0, -16.0, 0.0, 0.0, -388.0, -400.0, 0.0, -400.0, 11.0, -14.0, 0.0, 0.0, -3.0, -12.0, 0.0, 0.0, -20.0, -20.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 15.0, 0.0, -20.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 6.0, -14.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 14.0, 7.0, 2.0, -8.0, 0.0, -20.0, 0.0, 0.0, -16.0, 0.0, 4.0, -10.0, 0.0, -11.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, 2.0], "policy_predator_policy_reward": [179.0, 10.0, 0.0, 0.0, 0.0, 10.0, 9.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 2.0, 189.0, 189.0, 0.0, 10.0, 10.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 200.0, 197.0, 0.0, 2.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 6.0, 198.0, 4.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 10.0, 0.0, 4.0, 0.0, 0.0, 10.0, 10.0, 4.0, 0.0, 0.0, 189.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 2.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 13.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 5.0, 8.0, 6.0, 0.0, 9.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 10.0, 199.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 10.0, 2.0, 0.0, 0.0, 5.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9111460565827596, "mean_inference_ms": 2.3973806218110187, "mean_action_processing_ms": 0.4258266119239274, "mean_env_wait_ms": 0.32726171759051903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010785579681396484, "StateBufferConnector_ms": 0.00456690788269043, "ViewRequirementAgentConnector_ms": 0.21805274486541748}, "num_episodes": 22, "episode_return_max": 27.0, "episode_return_min": -588.0, "episode_return_mean": -24.96, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.97895844264826, "num_env_steps_trained_throughput_per_sec": 293.97895844264826, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 12933.442, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12933.391, "sample_time_ms": 1933.482, "learn_time_ms": 10984.162, "learn_throughput": 364.161, "synch_weights_time_ms": 13.153}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "e1352_00000", "date": "2024-08-13_17-00-26", "timestamp": 1723582826, "time_this_iter_s": 13.65137004852295, "time_total_s": 1344.4993126392365, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1639700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1344.4993126392365, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 64.865, "ram_util_percent": 83.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.097902374340113, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -0.00038931537074623286, "vf_loss": 0.8556373166896049, "vf_explained_var": 0.022922514197687625, "kl": Infinity, "entropy": 0.006623017946013125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0047847416591904, "cur_kl_coeff": 0.001336346101015806, "cur_lr": 0.009999999999999998, "total_loss": 1.4703188836574554, "policy_loss": 0.00025620776704123255, "vf_loss": 1.4700626741641414, "vf_explained_var": -8.199580762752149e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -588.0, "episode_reward_mean": -24.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -20.955, "predator_policy": 8.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 0.0, 0.0, 0.0, 3.0, -7.0, 7.0, -1.0, 5.0, -204.0, 17.0, 19.0, -26.0, 0.0, 4.0, -5.0, -10.0, 9.0, 5.0, -14.0, 0.0, -558.0, 23.0, 0.0, -10.0, -8.0, -2.0, 0.0, 2.0, -10.0, -13.0, -200.0, -5.0, 14.0, 10.0, -10.0, 9.0, -16.0, 0.0, -1.0, 0.0, 14.0, -6.0, -8.0, -199.0, 0.0, 7.0, 0.0, -588.0, -200.0, 7.0, 0.0, -4.0, 0.0, -24.0, 15.0, 15.0, 0.0, 12.0, -6.0, 0.0, 15.0, -10.0, 2.0, 0.0, 0.0, -20.0, 2.0, 0.0, 15.0, 0.0, 14.0, 9.0, -4.0, -10.0, -4.0, 4.0, -5.0, -10.0, 0.0, 0.0, 17.0, 6.0, 0.0, 0.0, 1.0, -7.0, 0.0, 0.0, 0.0, 9.0, -552.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 4.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -10.0, 0.0, -14.0, 7.0, 0.0, 0.0, -2.0, 0.0, 4.0, -396.0, -12.0, 2.0, 11.0, 12.0, 7.0, -20.0, -20.0, 0.0, 0.0, 7.0, -6.0, -15.0, 0.0, 0.0, -20.0, 5.0, 0.0, 15.0, -20.0, -28.0, 0.0, 0.0, 0.0, -370.0, -378.0, 14.0, 9.0, 0.0, 0.0, -20.0, 0.0, 0.0, -16.0, -4.0, 0.0, 0.0, 0.0, 11.0, -19.0, -20.0, 0.0, -6.0, -20.0, -400.0, 0.0, 2.0, -17.0, 0.0, 14.0, 5.0, 0.0, -13.0, -10.0, -12.0, 15.0, -18.0, -15.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 14.0, 0.0, -12.0, 0.0, 0.0, -22.0, 0.0, -398.0, 0.0, 0.0, 15.0, -16.0, 0.0, 0.0, -388.0, -400.0, 0.0, -400.0, 11.0, -14.0, 0.0, 0.0, -3.0, -12.0, 0.0, 0.0, -20.0, -20.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 15.0, 0.0, -20.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 6.0, -14.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 14.0, 7.0, 2.0, -8.0, 0.0, -20.0, 0.0, 0.0, -16.0, 0.0, 4.0, -10.0, 0.0, -11.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, 2.0, -4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, -14.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, -396.0, -354.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, -6.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 6.0, 198.0, 4.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 10.0, 0.0, 4.0, 0.0, 0.0, 10.0, 10.0, 4.0, 0.0, 0.0, 189.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 2.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 13.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 5.0, 8.0, 6.0, 0.0, 9.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 10.0, 199.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 10.0, 2.0, 0.0, 0.0, 5.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9145737698275069, "mean_inference_ms": 2.405651320217423, "mean_action_processing_ms": 0.426641089130227, "mean_env_wait_ms": 0.3281316566191144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01807236671447754, "StateBufferConnector_ms": 0.011020898818969727, "ViewRequirementAgentConnector_ms": 0.27375125885009766}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -588.0, "episode_return_mean": -24.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.13709467074113, "num_env_steps_trained_throughput_per_sec": 287.13709467074113, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 13054.403, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13054.351, "sample_time_ms": 2078.879, "learn_time_ms": 10958.736, "learn_throughput": 365.006, "synch_weights_time_ms": 14.113}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "e1352_00000", "date": "2024-08-13_17-00-40", "timestamp": 1723582840, "time_this_iter_s": 14.035506963729858, "time_total_s": 1358.5348196029663, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16eda60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1358.5348196029663, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 66.09, "ram_util_percent": 83.13000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.099541959276906, "cur_kl_coeff": 0.405457305908203, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.0001599897046588243, "vf_loss": 0.8919932789982311, "vf_explained_var": 0.01724115045613082, "kl": Infinity, "entropy": 0.009911981135743564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4377094513677533, "cur_kl_coeff": 0.000668173050507903, "cur_lr": 0.009999999999999998, "total_loss": 1.089597962457667, "policy_loss": 0.00011663114277537537, "vf_loss": 1.0894813324408557, "vf_explained_var": -6.969643648339327e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -588.0, "episode_reward_mean": -32.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -26.87, "predator_policy": 10.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, -8.0, -2.0, 0.0, 2.0, -10.0, -13.0, -200.0, -5.0, 14.0, 10.0, -10.0, 9.0, -16.0, 0.0, -1.0, 0.0, 14.0, -6.0, -8.0, -199.0, 0.0, 7.0, 0.0, -588.0, -200.0, 7.0, 0.0, -4.0, 0.0, -24.0, 15.0, 15.0, 0.0, 12.0, -6.0, 0.0, 15.0, -10.0, 2.0, 0.0, 0.0, -20.0, 2.0, 0.0, 15.0, 0.0, 14.0, 9.0, -4.0, -10.0, -4.0, 4.0, -5.0, -10.0, 0.0, 0.0, 17.0, 6.0, 0.0, 0.0, 1.0, -7.0, 0.0, 0.0, 0.0, 9.0, -552.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 4.0, -3.0, 0.0, -7.0, -6.0, 0.0, -563.0, 4.0, 0.0, -6.0, -171.0, 10.0, -203.0, 0.0, 5.0, -7.0, -3.0, 4.0, -5.0, 0.0, 15.0, -7.0, -574.0, 15.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -20.0, 0.0, 0.0, -16.0, -4.0, 0.0, 0.0, 0.0, 11.0, -19.0, -20.0, 0.0, -6.0, -20.0, -400.0, 0.0, 2.0, -17.0, 0.0, 14.0, 5.0, 0.0, -13.0, -10.0, -12.0, 15.0, -18.0, -15.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 14.0, 0.0, -12.0, 0.0, 0.0, -22.0, 0.0, -398.0, 0.0, 0.0, 15.0, -16.0, 0.0, 0.0, -388.0, -400.0, 0.0, -400.0, 11.0, -14.0, 0.0, 0.0, -3.0, -12.0, 0.0, 0.0, -20.0, -20.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 15.0, 0.0, -20.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 6.0, -14.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 14.0, 7.0, 2.0, -8.0, 0.0, -20.0, 0.0, 0.0, -16.0, 0.0, 4.0, -10.0, 0.0, -11.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, 2.0, -4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, -14.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, -396.0, -354.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, -6.0, 0.0, 0.0, -16.0, 0.0, 0.0, -16.0, 0.0, 0.0, -374.0, -378.0, 4.0, 0.0, -13.0, 3.0, 0.0, -16.0, -366.0, 7.0, 10.0, 0.0, -13.0, -400.0, 0.0, 0.0, -16.0, 13.0, -17.0, 0.0, -13.0, 0.0, 0.0, 3.0, 0.0, -10.0, 0.0, 0.0, 15.0, 0.0, 0.0, -14.0, -374.0, -400.0, 15.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 2.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 13.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 5.0, 8.0, 6.0, 0.0, 9.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 10.0, 199.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 10.0, 2.0, 0.0, 0.0, 5.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 188.0, 0.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9204635531623778, "mean_inference_ms": 2.419641057704877, "mean_action_processing_ms": 0.4281259708636576, "mean_env_wait_ms": 0.32948722675626596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01703500747680664, "StateBufferConnector_ms": 0.014509320259094238, "ViewRequirementAgentConnector_ms": 0.26584315299987793}, "num_episodes": 23, "episode_return_max": 17.0, "episode_return_min": -588.0, "episode_return_mean": -32.19, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.87316934281995, "num_env_steps_trained_throughput_per_sec": 301.87316934281995, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 13082.881, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13082.828, "sample_time_ms": 2185.28, "learn_time_ms": 10879.703, "learn_throughput": 367.657, "synch_weights_time_ms": 15.524}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "e1352_00000", "date": "2024-08-13_17-00-53", "timestamp": 1723582853, "time_this_iter_s": 13.369164943695068, "time_total_s": 1371.9039845466614, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16edca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1371.9039845466614, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 65.59444444444445, "ram_util_percent": 83.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.038961404384602, "cur_kl_coeff": 0.6081859588623046, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 5.726433462566799e-06, "vf_loss": 1.893260849294839, "vf_explained_var": 0.02041578810051005, "kl": Infinity, "entropy": 0.01225057608010424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.099291990511982, "cur_kl_coeff": 0.0003340865252539515, "cur_lr": 0.009999999999999998, "total_loss": 1.9558497495752163, "policy_loss": 9.637940736615626e-05, "vf_loss": 1.9557533679815826, "vf_explained_var": -9.11414938628989e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -588.0, "episode_reward_mean": -42.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.595, "predator_policy": 16.245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, -6.0, -8.0, -199.0, 0.0, 7.0, 0.0, -588.0, -200.0, 7.0, 0.0, -4.0, 0.0, -24.0, 15.0, 15.0, 0.0, 12.0, -6.0, 0.0, 15.0, -10.0, 2.0, 0.0, 0.0, -20.0, 2.0, 0.0, 15.0, 0.0, 14.0, 9.0, -4.0, -10.0, -4.0, 4.0, -5.0, -10.0, 0.0, 0.0, 17.0, 6.0, 0.0, 0.0, 1.0, -7.0, 0.0, 0.0, 0.0, 9.0, -552.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 4.0, -3.0, 0.0, -7.0, -6.0, 0.0, -563.0, 4.0, 0.0, -6.0, -171.0, 10.0, -203.0, 0.0, 5.0, -7.0, -3.0, 4.0, -5.0, 0.0, 15.0, -7.0, -574.0, 15.0, 0.0, 0.0, -185.0, 0.0, 7.0, -10.0, 6.0, -194.0, 0.0, -181.0, 6.0, 0.0, -170.0, -195.0, -9.0, 5.0, 0.0, -200.0, -171.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [14.0, 0.0, -12.0, 0.0, 0.0, -22.0, 0.0, -398.0, 0.0, 0.0, 15.0, -16.0, 0.0, 0.0, -388.0, -400.0, 0.0, -400.0, 11.0, -14.0, 0.0, 0.0, -3.0, -12.0, 0.0, 0.0, -20.0, -20.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 15.0, 0.0, -20.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 6.0, -14.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 14.0, 7.0, 2.0, -8.0, 0.0, -20.0, 0.0, 0.0, -16.0, 0.0, 4.0, -10.0, 0.0, -11.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, 2.0, -4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, -14.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, -396.0, -354.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, -6.0, 0.0, 0.0, -16.0, 0.0, 0.0, -16.0, 0.0, 0.0, -374.0, -378.0, 4.0, 0.0, -13.0, 3.0, 0.0, -16.0, -366.0, 7.0, 10.0, 0.0, -13.0, -400.0, 0.0, 0.0, -16.0, 13.0, -17.0, 0.0, -13.0, 0.0, 0.0, 3.0, 0.0, -10.0, 0.0, 0.0, 15.0, 0.0, 0.0, -14.0, -374.0, -400.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -20.0, 6.0, 0.0, 0.0, -391.0, 0.0, 0.0, 0.0, -370.0, -13.0, 9.0, 0.0, 0.0, 6.0, -366.0, -400.0, 0.0, -11.0, -16.0, 10.0, -15.0, 0.0, 0.0, -400.0, 0.0, -352.0, -4.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 6.0, 4.0, 10.0, 199.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 200.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 10.0, 2.0, 0.0, 0.0, 5.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 188.0, 0.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 185.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 180.0, 5.0, 200.0, 8.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 2.0, 183.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.925166641080161, "mean_inference_ms": 2.4311348154382437, "mean_action_processing_ms": 0.4294214416944381, "mean_env_wait_ms": 0.33072044395340294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016501784324645996, "StateBufferConnector_ms": 0.01709437370300293, "ViewRequirementAgentConnector_ms": 0.2721560001373291}, "num_episodes": 18, "episode_return_max": 17.0, "episode_return_min": -588.0, "episode_return_mean": -42.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.0754106451694, "num_env_steps_trained_throughput_per_sec": 308.0754106451694, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 13098.399, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13098.347, "sample_time_ms": 2273.069, "learn_time_ms": 10804.595, "learn_throughput": 370.213, "synch_weights_time_ms": 17.047}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "e1352_00000", "date": "2024-08-13_17-01-07", "timestamp": 1723582867, "time_this_iter_s": 13.059162855148315, "time_total_s": 1384.9631474018097, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1639700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1384.9631474018097, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 63.478947368421046, "ram_util_percent": 83.0578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5231396671404283, "cur_kl_coeff": 0.9122789382934573, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -3.856637234252597e-05, "vf_loss": 0.674308157483579, "vf_explained_var": 0.012947843850605071, "kl": Infinity, "entropy": 0.004328432491512445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.45716833264392, "cur_kl_coeff": 0.00016704326262697574, "cur_lr": 0.009999999999999998, "total_loss": 0.7149685291386155, "policy_loss": 0.00010313085433115404, "vf_loss": 0.7148653991687944, "vf_explained_var": 0.0001330594537119386, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -574.0, "episode_reward_mean": -38.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.73, "predator_policy": 16.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, 0.0, -20.0, 2.0, 0.0, 15.0, 0.0, 14.0, 9.0, -4.0, -10.0, -4.0, 4.0, -5.0, -10.0, 0.0, 0.0, 17.0, 6.0, 0.0, 0.0, 1.0, -7.0, 0.0, 0.0, 0.0, 9.0, -552.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 4.0, -3.0, 0.0, -7.0, -6.0, 0.0, -563.0, 4.0, 0.0, -6.0, -171.0, 10.0, -203.0, 0.0, 5.0, -7.0, -3.0, 4.0, -5.0, 0.0, 15.0, -7.0, -574.0, 15.0, 0.0, 0.0, -185.0, 0.0, 7.0, -10.0, 6.0, -194.0, 0.0, -181.0, 6.0, 0.0, -170.0, -195.0, -9.0, 5.0, 0.0, -200.0, -171.0, -4.0, 0.0, -13.0, -3.0, 14.0, 2.0, 1.0, 0.0, -10.0, -182.0, 5.0, -195.0, -10.0, -190.0, -10.0, -10.0, 25.0, 0.0, 15.0, 0.0, 0.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -20.0, 6.0, -14.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 14.0, 7.0, 2.0, -8.0, 0.0, -20.0, 0.0, 0.0, -16.0, 0.0, 4.0, -10.0, 0.0, -11.0, -18.0, 0.0, 0.0, 0.0, 0.0, 15.0, 2.0, -4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, -14.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, -396.0, -354.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, -6.0, 0.0, 0.0, -16.0, 0.0, 0.0, -16.0, 0.0, 0.0, -374.0, -378.0, 4.0, 0.0, -13.0, 3.0, 0.0, -16.0, -366.0, 7.0, 10.0, 0.0, -13.0, -400.0, 0.0, 0.0, -16.0, 13.0, -17.0, 0.0, -13.0, 0.0, 0.0, 3.0, 0.0, -10.0, 0.0, 0.0, 15.0, 0.0, 0.0, -14.0, -374.0, -400.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -20.0, 6.0, 0.0, 0.0, -391.0, 0.0, 0.0, 0.0, -370.0, -13.0, 9.0, 0.0, 0.0, 6.0, -366.0, -400.0, 0.0, -11.0, -16.0, 10.0, -15.0, 0.0, 0.0, -400.0, 0.0, -352.0, -4.0, -8.0, 0.0, -14.0, 0.0, -14.0, -22.0, -13.0, 0.0, 14.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, -2.0, -16.0, 2.0, -376.0, 5.0, 0.0, -400.0, 0.0, -20.0, 0.0, -386.0, 3.0, -20.0, 0.0, 0.0, -20.0, 10.0, 15.0, 1.0, -2.0, 0.0, 15.0, 0.0, 0.0, 7.0, -18.0, 0.0, -11.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 0.0, 10.0, 2.0, 0.0, 0.0, 5.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 188.0, 0.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 185.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 180.0, 5.0, 200.0, 8.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 2.0, 183.0, 4.0, 0.0, 7.0, 7.0, 13.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 192.0, 0.0, 0.0, 195.0, 10.0, 10.0, 0.0, 0.0, 193.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9293427195214445, "mean_inference_ms": 2.4431867287577718, "mean_action_processing_ms": 0.4306077061288535, "mean_env_wait_ms": 0.331754982303876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014071106910705566, "StateBufferConnector_ms": 0.016280293464660645, "ViewRequirementAgentConnector_ms": 0.2800215482711792}, "num_episodes": 22, "episode_return_max": 25.0, "episode_return_min": -574.0, "episode_return_mean": -38.8, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.5751684409842, "num_env_steps_trained_throughput_per_sec": 313.5751684409842, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 13113.067, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13113.013, "sample_time_ms": 2362.057, "learn_time_ms": 10729.321, "learn_throughput": 372.81, "synch_weights_time_ms": 17.581}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "e1352_00000", "date": "2024-08-13_17-01-20", "timestamp": 1723582880, "time_this_iter_s": 12.88678503036499, "time_total_s": 1397.8499324321747, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16ed670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1397.8499324321747, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 64.3111111111111, "ram_util_percent": 83.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.097194465521782, "cur_kl_coeff": 1.3684184074401853, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -0.0002619887963331566, "vf_loss": 0.9058734046403694, "vf_explained_var": 0.01684816558525045, "kl": Infinity, "entropy": 0.0015992482458675533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1385161728033966, "cur_kl_coeff": 8.352163131348787e-05, "cur_lr": 0.009999999999999998, "total_loss": 1.2990905046463013, "policy_loss": 7.801811856331018e-05, "vf_loss": 1.2990124847207751, "vf_explained_var": -1.0154865406177662e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -574.0, "episode_reward_mean": -46.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.275, "predator_policy": 18.16}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, 6.0, 0.0, 0.0, 1.0, -7.0, 0.0, 0.0, 0.0, 9.0, -552.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 4.0, -3.0, 0.0, -7.0, -6.0, 0.0, -563.0, 4.0, 0.0, -6.0, -171.0, 10.0, -203.0, 0.0, 5.0, -7.0, -3.0, 4.0, -5.0, 0.0, 15.0, -7.0, -574.0, 15.0, 0.0, 0.0, -185.0, 0.0, 7.0, -10.0, 6.0, -194.0, 0.0, -181.0, 6.0, 0.0, -170.0, -195.0, -9.0, 5.0, 0.0, -200.0, -171.0, -4.0, 0.0, -13.0, -3.0, 14.0, 2.0, 1.0, 0.0, -10.0, -182.0, 5.0, -195.0, -10.0, -190.0, -10.0, -10.0, 25.0, 0.0, 15.0, 0.0, 0.0, -5.0, 6.0, -14.0, 0.0, 0.0, 14.0, -175.0, 0.0, -10.0, 0.0, -6.0, -3.0, -6.0, 15.0, 1.0, -10.0, 13.0, -6.0, -569.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 2.0, -4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, -14.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, -396.0, -354.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, -6.0, 0.0, 0.0, -16.0, 0.0, 0.0, -16.0, 0.0, 0.0, -374.0, -378.0, 4.0, 0.0, -13.0, 3.0, 0.0, -16.0, -366.0, 7.0, 10.0, 0.0, -13.0, -400.0, 0.0, 0.0, -16.0, 13.0, -17.0, 0.0, -13.0, 0.0, 0.0, 3.0, 0.0, -10.0, 0.0, 0.0, 15.0, 0.0, 0.0, -14.0, -374.0, -400.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -20.0, 6.0, 0.0, 0.0, -391.0, 0.0, 0.0, 0.0, -370.0, -13.0, 9.0, 0.0, 0.0, 6.0, -366.0, -400.0, 0.0, -11.0, -16.0, 10.0, -15.0, 0.0, 0.0, -400.0, 0.0, -352.0, -4.0, -8.0, 0.0, -14.0, 0.0, -14.0, -22.0, -13.0, 0.0, 14.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, -2.0, -16.0, 2.0, -376.0, 5.0, 0.0, -400.0, 0.0, -20.0, 0.0, -386.0, 3.0, -20.0, 0.0, 0.0, -20.0, 10.0, 15.0, 1.0, -2.0, 0.0, 15.0, 0.0, 0.0, 7.0, -18.0, 0.0, -11.0, 4.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 3.0, -367.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, -12.0, 0.0, -19.0, 3.0, 0.0, 15.0, 1.0, 0.0, 0.0, -20.0, 13.0, 0.0, 0.0, -15.0, -390.0, -374.0], "policy_predator_policy_reward": [0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 188.0, 0.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 185.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 180.0, 5.0, 200.0, 8.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 2.0, 183.0, 4.0, 0.0, 7.0, 7.0, 13.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 192.0, 0.0, 0.0, 195.0, 10.0, 10.0, 0.0, 0.0, 193.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 6.0, 2.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 195.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.932901381982171, "mean_inference_ms": 2.4505625128168567, "mean_action_processing_ms": 0.4313482271996751, "mean_env_wait_ms": 0.33284467855085054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011486411094665527, "StateBufferConnector_ms": 0.01628899574279785, "ViewRequirementAgentConnector_ms": 0.24043262004852295}, "num_episodes": 18, "episode_return_max": 25.0, "episode_return_min": -574.0, "episode_return_mean": -46.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.65370416740956, "num_env_steps_trained_throughput_per_sec": 300.65370416740956, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 13192.435, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13192.381, "sample_time_ms": 2467.996, "learn_time_ms": 10702.389, "learn_throughput": 373.748, "synch_weights_time_ms": 17.779}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "e1352_00000", "date": "2024-08-13_17-01-33", "timestamp": 1723582893, "time_this_iter_s": 13.414466857910156, "time_total_s": 1411.2643992900848, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1749ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1411.2643992900848, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 64.56315789473683, "ram_util_percent": 83.6421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1202526473533854, "cur_kl_coeff": 2.0526276111602786, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -0.0001123667196937339, "vf_loss": 0.8658821495437118, "vf_explained_var": 0.009902566860592555, "kl": Infinity, "entropy": 0.002434306766895735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.172305279346454, "cur_kl_coeff": 4.1760815656743936e-05, "cur_lr": 0.009999999999999998, "total_loss": 1.390017353605341, "policy_loss": 2.756439858958835e-06, "vf_loss": 1.3900145994607733, "vf_explained_var": -6.906569950164311e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -582.0, "episode_reward_mean": -56.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -49.595, "predator_policy": 21.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-563.0, 4.0, 0.0, -6.0, -171.0, 10.0, -203.0, 0.0, 5.0, -7.0, -3.0, 4.0, -5.0, 0.0, 15.0, -7.0, -574.0, 15.0, 0.0, 0.0, -185.0, 0.0, 7.0, -10.0, 6.0, -194.0, 0.0, -181.0, 6.0, 0.0, -170.0, -195.0, -9.0, 5.0, 0.0, -200.0, -171.0, -4.0, 0.0, -13.0, -3.0, 14.0, 2.0, 1.0, 0.0, -10.0, -182.0, 5.0, -195.0, -10.0, -190.0, -10.0, -10.0, 25.0, 0.0, 15.0, 0.0, 0.0, -5.0, 6.0, -14.0, 0.0, 0.0, 14.0, -175.0, 0.0, -10.0, 0.0, -6.0, -3.0, -6.0, 15.0, 1.0, -10.0, 13.0, -6.0, -569.0, -10.0, -10.0, -582.0, -22.0, -10.0, 16.0, 15.0, 18.0, -10.0, 9.0, 0.0, -168.0, -210.0, 1.0, -10.0, 0.0, 0.0, 0.0, 0.0, -3.0, 18.0, -574.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-374.0, -378.0, 4.0, 0.0, -13.0, 3.0, 0.0, -16.0, -366.0, 7.0, 10.0, 0.0, -13.0, -400.0, 0.0, 0.0, -16.0, 13.0, -17.0, 0.0, -13.0, 0.0, 0.0, 3.0, 0.0, -10.0, 0.0, 0.0, 15.0, 0.0, 0.0, -14.0, -374.0, -400.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -20.0, 6.0, 0.0, 0.0, -391.0, 0.0, 0.0, 0.0, -370.0, -13.0, 9.0, 0.0, 0.0, 6.0, -366.0, -400.0, 0.0, -11.0, -16.0, 10.0, -15.0, 0.0, 0.0, -400.0, 0.0, -352.0, -4.0, -8.0, 0.0, -14.0, 0.0, -14.0, -22.0, -13.0, 0.0, 14.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, -2.0, -16.0, 2.0, -376.0, 5.0, 0.0, -400.0, 0.0, -20.0, 0.0, -386.0, 3.0, -20.0, 0.0, 0.0, -20.0, 10.0, 15.0, 1.0, -2.0, 0.0, 15.0, 0.0, 0.0, 7.0, -18.0, 0.0, -11.0, 4.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 3.0, -367.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, -12.0, 0.0, -19.0, 3.0, 0.0, 15.0, 1.0, 0.0, 0.0, -20.0, 13.0, 0.0, 0.0, -15.0, -390.0, -374.0, 0.0, -20.0, -20.0, 0.0, -400.0, -382.0, -19.0, -16.0, -20.0, 0.0, 15.0, -9.0, 0.0, 15.0, 3.0, 15.0, -22.0, 0.0, 0.0, 9.0, 0.0, 0.0, -350.0, 0.0, -400.0, -20.0, 1.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, -7.0, 12.0, -400.0, -374.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 188.0, 0.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 185.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 180.0, 5.0, 200.0, 8.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 2.0, 183.0, 4.0, 0.0, 7.0, 7.0, 13.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 192.0, 0.0, 0.0, 195.0, 10.0, 10.0, 0.0, 0.0, 193.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 6.0, 2.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 195.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 13.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 200.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 4.0, 0.0, 200.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9363141857315957, "mean_inference_ms": 2.4589918498487164, "mean_action_processing_ms": 0.43267487650944814, "mean_env_wait_ms": 0.33392481610831803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01747441291809082, "StateBufferConnector_ms": 0.010792374610900879, "ViewRequirementAgentConnector_ms": 0.19347119331359863}, "num_episodes": 23, "episode_return_max": 25.0, "episode_return_min": -582.0, "episode_return_mean": -56.29, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.978268762814, "num_env_steps_trained_throughput_per_sec": 290.978268762814, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 13306.802, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13306.744, "sample_time_ms": 2582.907, "learn_time_ms": 10700.939, "learn_throughput": 373.799, "synch_weights_time_ms": 18.639}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 100, "trial_id": "e1352_00000", "date": "2024-08-13_17-01-47", "timestamp": 1723582907, "time_this_iter_s": 13.821767807006836, "time_total_s": 1425.0861670970917, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b171da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1425.0861670970917, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 68.78, "ram_util_percent": 83.57000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1459964890683456, "cur_kl_coeff": 3.0789414167404177, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -4.514134328851782e-05, "vf_loss": 1.4428859339346962, "vf_explained_var": 0.03582049869986438, "kl": Infinity, "entropy": 7.079513482130278e-05, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1864675978431403, "cur_kl_coeff": 2.0880407828371968e-05, "cur_lr": 0.009999999999999998, "total_loss": 2.0297190586725873, "policy_loss": -0.00010320891665600279, "vf_loss": 2.029822274364492, "vf_explained_var": -5.64509598666398e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -597.0, "episode_reward_mean": -58.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -51.855, "predator_policy": 22.395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -185.0, 0.0, 7.0, -10.0, 6.0, -194.0, 0.0, -181.0, 6.0, 0.0, -170.0, -195.0, -9.0, 5.0, 0.0, -200.0, -171.0, -4.0, 0.0, -13.0, -3.0, 14.0, 2.0, 1.0, 0.0, -10.0, -182.0, 5.0, -195.0, -10.0, -190.0, -10.0, -10.0, 25.0, 0.0, 15.0, 0.0, 0.0, -5.0, 6.0, -14.0, 0.0, 0.0, 14.0, -175.0, 0.0, -10.0, 0.0, -6.0, -3.0, -6.0, 15.0, 1.0, -10.0, 13.0, -6.0, -569.0, -10.0, -10.0, -582.0, -22.0, -10.0, 16.0, 15.0, 18.0, -10.0, 9.0, 0.0, -168.0, -210.0, 1.0, -10.0, 0.0, 0.0, 0.0, 0.0, -3.0, 18.0, -574.0, 0.0, 3.0, -540.0, -6.0, -200.0, -8.0, 0.0, 0.0, -2.0, 0.0, 1.0, 5.0, -192.0, -597.0, -9.0, 0.0, 0.0, -200.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -20.0, 6.0, 0.0, 0.0, -391.0, 0.0, 0.0, 0.0, -370.0, -13.0, 9.0, 0.0, 0.0, 6.0, -366.0, -400.0, 0.0, -11.0, -16.0, 10.0, -15.0, 0.0, 0.0, -400.0, 0.0, -352.0, -4.0, -8.0, 0.0, -14.0, 0.0, -14.0, -22.0, -13.0, 0.0, 14.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, -2.0, -16.0, 2.0, -376.0, 5.0, 0.0, -400.0, 0.0, -20.0, 0.0, -386.0, 3.0, -20.0, 0.0, 0.0, -20.0, 10.0, 15.0, 1.0, -2.0, 0.0, 15.0, 0.0, 0.0, 7.0, -18.0, 0.0, -11.0, 4.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 3.0, -367.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, -12.0, 0.0, -19.0, 3.0, 0.0, 15.0, 1.0, 0.0, 0.0, -20.0, 13.0, 0.0, 0.0, -15.0, -390.0, -374.0, 0.0, -20.0, -20.0, 0.0, -400.0, -382.0, -19.0, -16.0, -20.0, 0.0, 15.0, -9.0, 0.0, 15.0, 3.0, 15.0, -22.0, 0.0, 0.0, 9.0, 0.0, 0.0, -350.0, 0.0, -400.0, -20.0, 1.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, -7.0, 12.0, -400.0, -374.0, 0.0, 0.0, 5.0, -4.0, -367.0, -361.0, -20.0, 4.0, -400.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -10.0, 1.0, 0.0, 5.0, 0.0, -384.0, 0.0, -398.0, -398.0, -27.0, 4.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, -4.0, -4.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 185.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 180.0, 5.0, 200.0, 8.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 2.0, 183.0, 4.0, 0.0, 7.0, 7.0, 13.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 192.0, 0.0, 0.0, 195.0, 10.0, 10.0, 0.0, 0.0, 193.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 6.0, 2.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 195.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 13.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 200.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 4.0, 0.0, 200.0, 0.0, 0.0, 2.0, 0.0, 188.0, 0.0, 0.0, 10.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 182.0, 0.0, 199.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 2.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9379927157598418, "mean_inference_ms": 2.4638377039875885, "mean_action_processing_ms": 0.4326987461536023, "mean_env_wait_ms": 0.3345700049674324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02967989444732666, "StateBufferConnector_ms": 0.007626891136169434, "ViewRequirementAgentConnector_ms": 0.1844179630279541}, "num_episodes": 18, "episode_return_max": 25.0, "episode_return_min": -597.0, "episode_return_mean": -58.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.3204466005034, "num_env_steps_trained_throughput_per_sec": 297.3204466005034, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1616000, "timers": {"training_iteration_time_ms": 13347.155, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13347.096, "sample_time_ms": 2639.429, "learn_time_ms": 10684.168, "learn_throughput": 374.386, "synch_weights_time_ms": 19.05}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "done": false, "training_iteration": 101, "trial_id": "e1352_00000", "date": "2024-08-13_17-02-01", "timestamp": 1723582921, "time_this_iter_s": 13.551182985305786, "time_total_s": 1438.6373500823975, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17af3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1438.6373500823975, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 66.26315789473684, "ram_util_percent": 83.53684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4508198079924104, "cur_kl_coeff": 4.618412125110625, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -1.5877030060562506e-05, "vf_loss": 1.4177158313611198, "vf_explained_var": 0.06653709030025219, "kl": Infinity, "entropy": 7.674153949937425e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1631715884779594, "cur_kl_coeff": 1.0440203914185984e-05, "cur_lr": 0.009999999999999998, "total_loss": 1.4740804635973834, "policy_loss": -0.00011754849354031855, "vf_loss": 1.4741980085612605, "vf_explained_var": -8.231117611839658e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -597.0, "episode_reward_mean": -54.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -47.96, "predator_policy": 20.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.0, -4.0, 0.0, -13.0, -3.0, 14.0, 2.0, 1.0, 0.0, -10.0, -182.0, 5.0, -195.0, -10.0, -190.0, -10.0, -10.0, 25.0, 0.0, 15.0, 0.0, 0.0, -5.0, 6.0, -14.0, 0.0, 0.0, 14.0, -175.0, 0.0, -10.0, 0.0, -6.0, -3.0, -6.0, 15.0, 1.0, -10.0, 13.0, -6.0, -569.0, -10.0, -10.0, -582.0, -22.0, -10.0, 16.0, 15.0, 18.0, -10.0, 9.0, 0.0, -168.0, -210.0, 1.0, -10.0, 0.0, 0.0, 0.0, 0.0, -3.0, 18.0, -574.0, 0.0, 3.0, -540.0, -6.0, -200.0, -8.0, 0.0, 0.0, -2.0, 0.0, 1.0, 5.0, -192.0, -597.0, -9.0, 0.0, 0.0, -200.0, -4.0, 10.0, 2.0, 0.0, -27.0, -7.0, 11.0, 7.0, 1.0, 2.0, -196.0, 4.0, -202.0, 11.0, -172.0, -167.0, 9.0, 15.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-352.0, -4.0, -8.0, 0.0, -14.0, 0.0, -14.0, -22.0, -13.0, 0.0, 14.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, -2.0, -16.0, 2.0, -376.0, 5.0, 0.0, -400.0, 0.0, -20.0, 0.0, -386.0, 3.0, -20.0, 0.0, 0.0, -20.0, 10.0, 15.0, 1.0, -2.0, 0.0, 15.0, 0.0, 0.0, 7.0, -18.0, 0.0, -11.0, 4.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 3.0, -367.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, -12.0, 0.0, -19.0, 3.0, 0.0, 15.0, 1.0, 0.0, 0.0, -20.0, 13.0, 0.0, 0.0, -15.0, -390.0, -374.0, 0.0, -20.0, -20.0, 0.0, -400.0, -382.0, -19.0, -16.0, -20.0, 0.0, 15.0, -9.0, 0.0, 15.0, 3.0, 15.0, -22.0, 0.0, 0.0, 9.0, 0.0, 0.0, -350.0, 0.0, -400.0, -20.0, 1.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, -7.0, 12.0, -400.0, -374.0, 0.0, 0.0, 5.0, -4.0, -367.0, -361.0, -20.0, 4.0, -400.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -10.0, 1.0, 0.0, 5.0, 0.0, -384.0, 0.0, -398.0, -398.0, -27.0, 4.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, -4.0, -4.0, 6.0, 0.0, 1.0, 1.0, 0.0, 0.0, -20.0, -20.0, 3.0, -20.0, 4.0, 7.0, 8.0, -2.0, 0.0, -19.0, 12.0, -20.0, -394.0, 0.0, 3.0, -9.0, -400.0, -4.0, 0.0, 11.0, 0.0, -358.0, 0.0, -349.0, 9.0, 0.0, 0.0, 10.0, -15.0, 0.0], "policy_predator_policy_reward": [2.0, 183.0, 4.0, 0.0, 7.0, 7.0, 13.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 192.0, 0.0, 0.0, 195.0, 10.0, 10.0, 0.0, 0.0, 193.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 6.0, 2.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 195.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 13.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 200.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 4.0, 0.0, 200.0, 0.0, 0.0, 2.0, 0.0, 188.0, 0.0, 0.0, 10.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 182.0, 0.0, 199.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 2.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 198.0, 0.0, 10.0, 200.0, 2.0, 0.0, 0.0, 0.0, 186.0, 182.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9399970789524309, "mean_inference_ms": 2.469283545872442, "mean_action_processing_ms": 0.4332267706626092, "mean_env_wait_ms": 0.3353310982685874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031147003173828125, "StateBufferConnector_ms": 0.0048035383224487305, "ViewRequirementAgentConnector_ms": 0.18749475479125977}, "num_episodes": 18, "episode_return_max": 25.0, "episode_return_min": -597.0, "episode_return_mean": -54.76, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.69569230099773, "num_env_steps_trained_throughput_per_sec": 299.69569230099773, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 13395.257, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13395.197, "sample_time_ms": 2685.304, "learn_time_ms": 10683.752, "learn_throughput": 374.4, "synch_weights_time_ms": 21.063}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 102, "trial_id": "e1352_00000", "date": "2024-08-13_17-02-14", "timestamp": 1723582934, "time_this_iter_s": 13.409633159637451, "time_total_s": 1452.046983242035, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17afdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1452.046983242035, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 65.8157894736842, "ram_util_percent": 83.6263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6221343260238728, "cur_kl_coeff": 6.927618187665941, "cur_lr": 0.009999999999999998, "total_loss": 0.46391302617611707, "policy_loss": -0.00025613376175955173, "vf_loss": 0.4641691588841024, "vf_explained_var": 0.03357455392993947, "kl": 1.9561459276991435e-43, "entropy": 4.8062424257228354e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4098087737974883, "cur_kl_coeff": 5.220101957092992e-06, "cur_lr": 0.009999999999999998, "total_loss": 0.5051633134602554, "policy_loss": -0.00022616407282098576, "vf_loss": 0.5053894809146643, "vf_explained_var": 7.623402529923373e-07, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "env_runners": {"episode_reward_max": 18.0, "episode_reward_min": -597.0, "episode_reward_mean": -51.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -44.065, "predator_policy": 18.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, 6.0, -14.0, 0.0, 0.0, 14.0, -175.0, 0.0, -10.0, 0.0, -6.0, -3.0, -6.0, 15.0, 1.0, -10.0, 13.0, -6.0, -569.0, -10.0, -10.0, -582.0, -22.0, -10.0, 16.0, 15.0, 18.0, -10.0, 9.0, 0.0, -168.0, -210.0, 1.0, -10.0, 0.0, 0.0, 0.0, 0.0, -3.0, 18.0, -574.0, 0.0, 3.0, -540.0, -6.0, -200.0, -8.0, 0.0, 0.0, -2.0, 0.0, 1.0, 5.0, -192.0, -597.0, -9.0, 0.0, 0.0, -200.0, -4.0, 10.0, 2.0, 0.0, -27.0, -7.0, 11.0, 7.0, 1.0, 2.0, -196.0, 4.0, -202.0, 11.0, -172.0, -167.0, 9.0, 15.0, -5.0, 0.0, -17.0, 0.0, -186.0, -1.0, -2.0, 15.0, 10.0, 1.0, -8.0, 0.0, -10.0, 0.0, 7.0, -175.0, -10.0, 4.0, -4.0, -1.0, 0.0, 2.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -11.0, 4.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 3.0, -367.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, -12.0, 0.0, -19.0, 3.0, 0.0, 15.0, 1.0, 0.0, 0.0, -20.0, 13.0, 0.0, 0.0, -15.0, -390.0, -374.0, 0.0, -20.0, -20.0, 0.0, -400.0, -382.0, -19.0, -16.0, -20.0, 0.0, 15.0, -9.0, 0.0, 15.0, 3.0, 15.0, -22.0, 0.0, 0.0, 9.0, 0.0, 0.0, -350.0, 0.0, -400.0, -20.0, 1.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, -7.0, 12.0, -400.0, -374.0, 0.0, 0.0, 5.0, -4.0, -367.0, -361.0, -20.0, 4.0, -400.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -10.0, 1.0, 0.0, 5.0, 0.0, -384.0, 0.0, -398.0, -398.0, -27.0, 4.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, -4.0, -4.0, 6.0, 0.0, 1.0, 1.0, 0.0, 0.0, -20.0, -20.0, 3.0, -20.0, 4.0, 7.0, 8.0, -2.0, 0.0, -19.0, 12.0, -20.0, -394.0, 0.0, 3.0, -9.0, -400.0, -4.0, 0.0, 11.0, 0.0, -358.0, 0.0, -349.0, 9.0, 0.0, 0.0, 10.0, -15.0, 0.0, 0.0, 0.0, -20.0, -14.0, 0.0, 0.0, -398.0, 13.0, 6.0, -22.0, -11.0, 2.0, 0.0, 15.0, 10.0, 0.0, 0.0, 1.0, -2.0, -14.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 7.0, 0.0, 4.0, -358.0, 0.0, -20.0, 4.0, 0.0, 0.0, -8.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 6.0, 2.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 9.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 195.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 13.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 200.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 4.0, 0.0, 200.0, 0.0, 0.0, 2.0, 0.0, 188.0, 0.0, 0.0, 10.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 182.0, 0.0, 199.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 2.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 198.0, 0.0, 10.0, 200.0, 2.0, 0.0, 0.0, 0.0, 186.0, 182.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 199.0, 10.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 179.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9424274643566849, "mean_inference_ms": 2.475681138700085, "mean_action_processing_ms": 0.4337579382979539, "mean_env_wait_ms": 0.3362232496497763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03271806240081787, "StateBufferConnector_ms": 0.005490541458129883, "ViewRequirementAgentConnector_ms": 0.19494688510894775}, "num_episodes": 22, "episode_return_max": 18.0, "episode_return_min": -597.0, "episode_return_mean": -51.15, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.39278846002344, "num_env_steps_trained_throughput_per_sec": 300.39278846002344, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1648000, "timers": {"training_iteration_time_ms": 13369.503, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13369.441, "sample_time_ms": 2611.368, "learn_time_ms": 10729.248, "learn_throughput": 372.813, "synch_weights_time_ms": 24.278}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "done": false, "training_iteration": 103, "trial_id": "e1352_00000", "date": "2024-08-13_17-02-28", "timestamp": 1723582948, "time_this_iter_s": 13.38930082321167, "time_total_s": 1465.4362840652466, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b171da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1465.4362840652466, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 66.57368421052631, "ram_util_percent": 83.54210526315791}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0501123072885017, "cur_kl_coeff": 3.4638090938329706, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -8.429568162355474e-05, "vf_loss": 1.0786514155606113, "vf_explained_var": 0.033633345554745384, "kl": Infinity, "entropy": 6.283893862087141e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8865994798842443, "cur_kl_coeff": 2.610050978546496e-06, "cur_lr": 0.009999999999999998, "total_loss": 1.1266463347272109, "policy_loss": -0.0002955479921881484, "vf_loss": 1.1269418782500362, "vf_explained_var": -3.185221757838335e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "env_runners": {"episode_reward_max": 18.0, "episode_reward_min": -597.0, "episode_reward_mean": -55.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -48.08, "predator_policy": 20.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-569.0, -10.0, -10.0, -582.0, -22.0, -10.0, 16.0, 15.0, 18.0, -10.0, 9.0, 0.0, -168.0, -210.0, 1.0, -10.0, 0.0, 0.0, 0.0, 0.0, -3.0, 18.0, -574.0, 0.0, 3.0, -540.0, -6.0, -200.0, -8.0, 0.0, 0.0, -2.0, 0.0, 1.0, 5.0, -192.0, -597.0, -9.0, 0.0, 0.0, -200.0, -4.0, 10.0, 2.0, 0.0, -27.0, -7.0, 11.0, 7.0, 1.0, 2.0, -196.0, 4.0, -202.0, 11.0, -172.0, -167.0, 9.0, 15.0, -5.0, 0.0, -17.0, 0.0, -186.0, -1.0, -2.0, 15.0, 10.0, 1.0, -8.0, 0.0, -10.0, 0.0, 7.0, -175.0, -10.0, 4.0, -4.0, -1.0, 0.0, 2.0, 0.0, 0.0, -200.0, 0.0, -7.0, -6.0, 15.0, 6.0, -200.0, -10.0, 0.0, 0.0, 12.0, -16.0, 1.0, 15.0, 0.0, -190.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-390.0, -374.0, 0.0, -20.0, -20.0, 0.0, -400.0, -382.0, -19.0, -16.0, -20.0, 0.0, 15.0, -9.0, 0.0, 15.0, 3.0, 15.0, -22.0, 0.0, 0.0, 9.0, 0.0, 0.0, -350.0, 0.0, -400.0, -20.0, 1.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, -7.0, 12.0, -400.0, -374.0, 0.0, 0.0, 5.0, -4.0, -367.0, -361.0, -20.0, 4.0, -400.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -10.0, 1.0, 0.0, 5.0, 0.0, -384.0, 0.0, -398.0, -398.0, -27.0, 4.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, -4.0, -4.0, 6.0, 0.0, 1.0, 1.0, 0.0, 0.0, -20.0, -20.0, 3.0, -20.0, 4.0, 7.0, 8.0, -2.0, 0.0, -19.0, 12.0, -20.0, -394.0, 0.0, 3.0, -9.0, -400.0, -4.0, 0.0, 11.0, 0.0, -358.0, 0.0, -349.0, 9.0, 0.0, 0.0, 10.0, -15.0, 0.0, 0.0, 0.0, -20.0, -14.0, 0.0, 0.0, -398.0, 13.0, 6.0, -22.0, -11.0, 2.0, 0.0, 15.0, 10.0, 0.0, 0.0, 1.0, -2.0, -14.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 7.0, 0.0, 4.0, -358.0, 0.0, -20.0, 4.0, 0.0, 0.0, -8.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -24.0, 0.0, -16.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, -13.0, -10.0, -9.0, 0.0, 11.0, 2.0, 0.0, 0.0, 3.0, -386.0, -19.0, 2.0], "policy_predator_policy_reward": [195.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 13.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 200.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 9.0, 4.0, 0.0, 200.0, 0.0, 0.0, 2.0, 0.0, 188.0, 0.0, 0.0, 10.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 182.0, 0.0, 199.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 2.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 198.0, 0.0, 10.0, 200.0, 2.0, 0.0, 0.0, 0.0, 186.0, 182.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 199.0, 10.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 179.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 193.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9441464472394446, "mean_inference_ms": 2.479932973473209, "mean_action_processing_ms": 0.43406514439004057, "mean_env_wait_ms": 0.3367543366149215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03252124786376953, "StateBufferConnector_ms": 0.015614032745361328, "ViewRequirementAgentConnector_ms": 0.21507441997528076}, "num_episodes": 18, "episode_return_max": 18.0, "episode_return_min": -597.0, "episode_return_mean": -55.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.35405965853056, "num_env_steps_trained_throughput_per_sec": 306.35405965853056, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1664000, "timers": {"training_iteration_time_ms": 13314.54, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13314.477, "sample_time_ms": 2474.556, "learn_time_ms": 10810.641, "learn_throughput": 370.006, "synch_weights_time_ms": 24.239}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "done": false, "training_iteration": 104, "trial_id": "e1352_00000", "date": "2024-08-13_17-02-41", "timestamp": 1723582961, "time_this_iter_s": 13.167553901672363, "time_total_s": 1478.603837966919, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16e0e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1478.603837966919, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 65.08888888888889, "ram_util_percent": 83.60555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6098837370594974, "cur_kl_coeff": 5.195713640749455, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -0.00013499556050177605, "vf_loss": 0.7046845565397273, "vf_explained_var": 0.010546197809239544, "kl": Infinity, "entropy": 9.380658926930982e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6368035086021617, "cur_kl_coeff": 1.305025489273248e-06, "cur_lr": 0.009999999999999998, "total_loss": 0.8217837495739182, "policy_loss": -3.510693423252888e-05, "vf_loss": 0.8218188565165278, "vf_explained_var": -5.834317081189029e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -597.0, "episode_reward_mean": -41.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -40.16, "predator_policy": 19.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 3.0, -540.0, -6.0, -200.0, -8.0, 0.0, 0.0, -2.0, 0.0, 1.0, 5.0, -192.0, -597.0, -9.0, 0.0, 0.0, -200.0, -4.0, 10.0, 2.0, 0.0, -27.0, -7.0, 11.0, 7.0, 1.0, 2.0, -196.0, 4.0, -202.0, 11.0, -172.0, -167.0, 9.0, 15.0, -5.0, 0.0, -17.0, 0.0, -186.0, -1.0, -2.0, 15.0, 10.0, 1.0, -8.0, 0.0, -10.0, 0.0, 7.0, -175.0, -10.0, 4.0, -4.0, -1.0, 0.0, 2.0, 0.0, 0.0, -200.0, 0.0, -7.0, -6.0, 15.0, 6.0, -200.0, -10.0, 0.0, 0.0, 12.0, -16.0, 1.0, 15.0, 0.0, -190.0, -7.0, -207.0, -184.0, 0.0, -2.0, 13.0, 13.0, -190.0, -10.0, 0.0, 0.0, 0.0, -200.0, 0.0, 0.0, -6.0, -7.0, -20.0, 0.0, 0.0, 26.0, 7.0, 6.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 5.0, -4.0, -367.0, -361.0, -20.0, 4.0, -400.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -10.0, 1.0, 0.0, 5.0, 0.0, -384.0, 0.0, -398.0, -398.0, -27.0, 4.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, -4.0, -4.0, 6.0, 0.0, 1.0, 1.0, 0.0, 0.0, -20.0, -20.0, 3.0, -20.0, 4.0, 7.0, 8.0, -2.0, 0.0, -19.0, 12.0, -20.0, -394.0, 0.0, 3.0, -9.0, -400.0, -4.0, 0.0, 11.0, 0.0, -358.0, 0.0, -349.0, 9.0, 0.0, 0.0, 10.0, -15.0, 0.0, 0.0, 0.0, -20.0, -14.0, 0.0, 0.0, -398.0, 13.0, 6.0, -22.0, -11.0, 2.0, 0.0, 15.0, 10.0, 0.0, 0.0, 1.0, -2.0, -14.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 7.0, 0.0, 4.0, -358.0, 0.0, -20.0, 4.0, 0.0, 0.0, -8.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -24.0, 0.0, -16.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, -13.0, -10.0, -9.0, 0.0, 11.0, 2.0, 0.0, 0.0, 3.0, -386.0, -19.0, 2.0, -14.0, -400.0, -398.0, 15.0, 0.0, 0.0, 0.0, -8.0, 13.0, 0.0, 0.0, 13.0, 0.0, -385.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, -17.0, 0.0, -20.0, -11.0, 0.0, 0.0, 0.0, 0.0, 15.0, 11.0, 7.0, 0.0, -14.0, 13.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 2.0, 0.0, 188.0, 0.0, 0.0, 10.0, 200.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 182.0, 0.0, 199.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 2.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 198.0, 0.0, 10.0, 200.0, 2.0, 0.0, 0.0, 0.0, 186.0, 182.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 199.0, 10.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 179.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 193.0, 0.0, 0.0, 10.0, 200.0, 7.0, 0.0, 199.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9456355307451756, "mean_inference_ms": 2.4835163230203148, "mean_action_processing_ms": 0.43413969241765377, "mean_env_wait_ms": 0.33717960934450664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021854043006896973, "StateBufferConnector_ms": 0.014834046363830566, "ViewRequirementAgentConnector_ms": 0.21750521659851074}, "num_episodes": 23, "episode_return_max": 26.0, "episode_return_min": -597.0, "episode_return_mean": -41.76, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.76373333104266, "num_env_steps_trained_throughput_per_sec": 302.76373333104266, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 13242.643, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13242.567, "sample_time_ms": 2379.276, "learn_time_ms": 10832.582, "learn_throughput": 369.256, "synch_weights_time_ms": 23.519}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 105, "trial_id": "e1352_00000", "date": "2024-08-13_17-02-54", "timestamp": 1723582974, "time_this_iter_s": 13.28190279006958, "time_total_s": 1491.8857407569885, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16e0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1491.8857407569885, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 71.35263157894737, "ram_util_percent": 83.75263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.205347737453129, "cur_kl_coeff": 7.79357046112418, "cur_lr": 0.009999999999999998, "total_loss": 0.8818477293013265, "policy_loss": -0.0002427651214280299, "vf_loss": 0.882090493421706, "vf_explained_var": 0.014973071706358088, "kl": 7.505028346709803e-44, "entropy": 1.1783174764027256e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1560350480612622, "cur_kl_coeff": 6.52512744636624e-07, "cur_lr": 0.009999999999999998, "total_loss": 1.1349675771026384, "policy_loss": -0.0001662125769095919, "vf_loss": 1.135133784299805, "vf_explained_var": -7.884212271877066e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -576.0, "episode_reward_mean": -30.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -30.555, "predator_policy": 15.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, 10.0, 2.0, 0.0, -27.0, -7.0, 11.0, 7.0, 1.0, 2.0, -196.0, 4.0, -202.0, 11.0, -172.0, -167.0, 9.0, 15.0, -5.0, 0.0, -17.0, 0.0, -186.0, -1.0, -2.0, 15.0, 10.0, 1.0, -8.0, 0.0, -10.0, 0.0, 7.0, -175.0, -10.0, 4.0, -4.0, -1.0, 0.0, 2.0, 0.0, 0.0, -200.0, 0.0, -7.0, -6.0, 15.0, 6.0, -200.0, -10.0, 0.0, 0.0, 12.0, -16.0, 1.0, 15.0, 0.0, -190.0, -7.0, -207.0, -184.0, 0.0, -2.0, 13.0, 13.0, -190.0, -10.0, 0.0, 0.0, 0.0, -200.0, 0.0, 0.0, -6.0, -7.0, -20.0, 0.0, 0.0, 26.0, 7.0, 6.0, 0.0, 4.0, -18.0, 18.0, -7.0, 0.0, 1.0, -4.0, -7.0, -6.0, 1.0, 1.0, -2.0, 1.0, 0.0, 5.0, -576.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, -4.0, 6.0, 0.0, 1.0, 1.0, 0.0, 0.0, -20.0, -20.0, 3.0, -20.0, 4.0, 7.0, 8.0, -2.0, 0.0, -19.0, 12.0, -20.0, -394.0, 0.0, 3.0, -9.0, -400.0, -4.0, 0.0, 11.0, 0.0, -358.0, 0.0, -349.0, 9.0, 0.0, 0.0, 10.0, -15.0, 0.0, 0.0, 0.0, -20.0, -14.0, 0.0, 0.0, -398.0, 13.0, 6.0, -22.0, -11.0, 2.0, 0.0, 15.0, 10.0, 0.0, 0.0, 1.0, -2.0, -14.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 7.0, 0.0, 4.0, -358.0, 0.0, -20.0, 4.0, 0.0, 0.0, -8.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -24.0, 0.0, -16.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, -13.0, -10.0, -9.0, 0.0, 11.0, 2.0, 0.0, 0.0, 3.0, -386.0, -19.0, 2.0, -14.0, -400.0, -398.0, 15.0, 0.0, 0.0, 0.0, -8.0, 13.0, 0.0, 0.0, 13.0, 0.0, -385.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, -17.0, 0.0, -20.0, -11.0, 0.0, 0.0, 0.0, 0.0, 15.0, 11.0, 7.0, 0.0, -14.0, 13.0, 0.0, 0.0, 4.0, 0.0, -32.0, -6.0, 6.0, 12.0, 0.0, -14.0, 0.0, 0.0, 1.0, 0.0, -11.0, 0.0, -17.0, 1.0, -12.0, 0.0, 0.0, 1.0, 1.0, 0.0, -24.0, 5.0, 3.0, -4.0, 0.0, 0.0, 0.0, 5.0, -400.0, -376.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [2.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 198.0, 0.0, 10.0, 200.0, 2.0, 0.0, 0.0, 0.0, 186.0, 182.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 199.0, 10.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 179.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 193.0, 0.0, 0.0, 10.0, 200.0, 7.0, 0.0, 199.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 13.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 9.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9463708626585327, "mean_inference_ms": 2.48518931475987, "mean_action_processing_ms": 0.44250345113653095, "mean_env_wait_ms": 0.33738644739065793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010251283645629883, "StateBufferConnector_ms": 0.015029549598693848, "ViewRequirementAgentConnector_ms": 0.22059118747711182}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -576.0, "episode_return_mean": -30.2, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.04087838374886, "num_env_steps_trained_throughput_per_sec": 268.04087838374886, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1696000, "timers": {"training_iteration_time_ms": 13409.893, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13409.816, "sample_time_ms": 2492.672, "learn_time_ms": 10887.476, "learn_throughput": 367.395, "synch_weights_time_ms": 22.222}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "done": false, "training_iteration": 106, "trial_id": "e1352_00000", "date": "2024-08-13_17-03-09", "timestamp": 1723582989, "time_this_iter_s": 14.98533296585083, "time_total_s": 1506.8710737228394, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1679040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1506.8710737228394, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 72.69999999999999, "ram_util_percent": 83.72857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3652407922816496, "cur_kl_coeff": 3.89678523056209, "cur_lr": 0.009999999999999998, "total_loss": 1.0328569980525466, "policy_loss": 0.0001303366060176539, "vf_loss": 1.0327266619870903, "vf_explained_var": 0.015929358251511105, "kl": 2.0776288659952393e-44, "entropy": 1.881525968903312e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6716332984722353, "cur_kl_coeff": 3.26256372318312e-07, "cur_lr": 0.009999999999999998, "total_loss": 1.180616718786892, "policy_loss": 4.861167651753892e-05, "vf_loss": 1.1805681125827567, "vf_explained_var": -4.478232570426174e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -576.0, "episode_reward_mean": -32.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -32.43, "predator_policy": 16.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.0, -1.0, -2.0, 15.0, 10.0, 1.0, -8.0, 0.0, -10.0, 0.0, 7.0, -175.0, -10.0, 4.0, -4.0, -1.0, 0.0, 2.0, 0.0, 0.0, -200.0, 0.0, -7.0, -6.0, 15.0, 6.0, -200.0, -10.0, 0.0, 0.0, 12.0, -16.0, 1.0, 15.0, 0.0, -190.0, -7.0, -207.0, -184.0, 0.0, -2.0, 13.0, 13.0, -190.0, -10.0, 0.0, 0.0, 0.0, -200.0, 0.0, 0.0, -6.0, -7.0, -20.0, 0.0, 0.0, 26.0, 7.0, 6.0, 0.0, 4.0, -18.0, 18.0, -7.0, 0.0, 1.0, -4.0, -7.0, -6.0, 1.0, 1.0, -2.0, 1.0, 0.0, 5.0, -576.0, 0.0, 0.0, 13.0, -194.0, 12.0, -184.0, 0.0, -17.0, -172.0, -8.0, -7.0, 15.0, -192.0, -17.0, 14.0, 7.0, 0.0, 14.0, 2.0, 0.0, 3.0, -3.0, -182.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-398.0, 13.0, 6.0, -22.0, -11.0, 2.0, 0.0, 15.0, 10.0, 0.0, 0.0, 1.0, -2.0, -14.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 7.0, 0.0, 4.0, -358.0, 0.0, -20.0, 4.0, 0.0, 0.0, -8.0, -10.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -24.0, 0.0, -16.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, -13.0, -10.0, -9.0, 0.0, 11.0, 2.0, 0.0, 0.0, 3.0, -386.0, -19.0, 2.0, -14.0, -400.0, -398.0, 15.0, 0.0, 0.0, 0.0, -8.0, 13.0, 0.0, 0.0, 13.0, 0.0, -385.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, -17.0, 0.0, -20.0, -11.0, 0.0, 0.0, 0.0, 0.0, 15.0, 11.0, 7.0, 0.0, -14.0, 13.0, 0.0, 0.0, 4.0, 0.0, -32.0, -6.0, 6.0, 12.0, 0.0, -14.0, 0.0, 0.0, 1.0, 0.0, -11.0, 0.0, -17.0, 1.0, -12.0, 0.0, 0.0, 1.0, 1.0, 0.0, -24.0, 5.0, 3.0, -4.0, 0.0, 0.0, 0.0, 5.0, -400.0, -376.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, -400.0, 6.0, 0.0, 12.0, 0.0, -375.0, 0.0, -10.0, -14.0, -20.0, -368.0, 4.0, 0.0, -18.0, 0.0, -17.0, 0.0, 15.0, 0.0, -400.0, -10.0, -14.0, 14.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, -1.0, 0.0, 0.0, 0.0, 6.0, -6.0, -13.0, 0.0, -373.0, 0.0, -18.0, -6.0], "policy_predator_policy_reward": [0.0, 199.0, 10.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 179.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 193.0, 0.0, 0.0, 10.0, 200.0, 7.0, 0.0, 199.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 13.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 9.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 181.0, 0.0, 10.0, 10.0, 7.0, 182.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 198.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 9.0, 182.0, 9.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9450891381019986, "mean_inference_ms": 2.484813756001359, "mean_action_processing_ms": 0.452160474254887, "mean_env_wait_ms": 0.33698829901315824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008678793907165527, "StateBufferConnector_ms": 0.014773368835449219, "ViewRequirementAgentConnector_ms": 0.20271730422973633}, "num_episodes": 22, "episode_return_max": 26.0, "episode_return_min": -576.0, "episode_return_mean": -32.0, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.4218387057226, "num_env_steps_trained_throughput_per_sec": 315.4218387057226, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1712000, "timers": {"training_iteration_time_ms": 13379.652, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13379.576, "sample_time_ms": 2394.751, "learn_time_ms": 10957.654, "learn_throughput": 365.042, "synch_weights_time_ms": 20.793}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "done": false, "training_iteration": 107, "trial_id": "e1352_00000", "date": "2024-08-13_17-03-22", "timestamp": 1723583002, "time_this_iter_s": 12.719215869903564, "time_total_s": 1519.590289592743, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ec700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1519.590289592743, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 65.58333333333333, "ram_util_percent": 83.40555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0929851003148885, "cur_kl_coeff": 1.948392615281045, "cur_lr": 0.009999999999999998, "total_loss": 0.1832149332044301, "policy_loss": -5.9393077113089106e-05, "vf_loss": 0.18327432563947268, "vf_explained_var": 0.08161097405448793, "kl": 3.697870947523823e-44, "entropy": 1.151826633291036e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5581250899848, "cur_kl_coeff": 1.63128186159156e-07, "cur_lr": 0.009999999999999998, "total_loss": 0.3903461445931089, "policy_loss": -0.00029708934102759316, "vf_loss": 0.39064323394978173, "vf_explained_var": 4.8930682833232575e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -576.0, "episode_reward_mean": -29.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -30.02, "predator_policy": 15.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -200.0, 0.0, -7.0, -6.0, 15.0, 6.0, -200.0, -10.0, 0.0, 0.0, 12.0, -16.0, 1.0, 15.0, 0.0, -190.0, -7.0, -207.0, -184.0, 0.0, -2.0, 13.0, 13.0, -190.0, -10.0, 0.0, 0.0, 0.0, -200.0, 0.0, 0.0, -6.0, -7.0, -20.0, 0.0, 0.0, 26.0, 7.0, 6.0, 0.0, 4.0, -18.0, 18.0, -7.0, 0.0, 1.0, -4.0, -7.0, -6.0, 1.0, 1.0, -2.0, 1.0, 0.0, 5.0, -576.0, 0.0, 0.0, 13.0, -194.0, 12.0, -184.0, 0.0, -17.0, -172.0, -8.0, -7.0, 15.0, -192.0, -17.0, 14.0, 7.0, 0.0, 14.0, 2.0, 0.0, 3.0, -3.0, -182.0, -9.0, 14.0, 15.0, -13.0, -1.0, 15.0, 8.0, 0.0, 9.0, 10.0, -2.0, 15.0, 2.0, 13.0, 16.0, 0.0, 6.0, -176.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -24.0, 0.0, -16.0, 0.0, 15.0, 0.0, 6.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, -13.0, -10.0, -9.0, 0.0, 11.0, 2.0, 0.0, 0.0, 3.0, -386.0, -19.0, 2.0, -14.0, -400.0, -398.0, 15.0, 0.0, 0.0, 0.0, -8.0, 13.0, 0.0, 0.0, 13.0, 0.0, -385.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, -17.0, 0.0, -20.0, -11.0, 0.0, 0.0, 0.0, 0.0, 15.0, 11.0, 7.0, 0.0, -14.0, 13.0, 0.0, 0.0, 4.0, 0.0, -32.0, -6.0, 6.0, 12.0, 0.0, -14.0, 0.0, 0.0, 1.0, 0.0, -11.0, 0.0, -17.0, 1.0, -12.0, 0.0, 0.0, 1.0, 1.0, 0.0, -24.0, 5.0, 3.0, -4.0, 0.0, 0.0, 0.0, 5.0, -400.0, -376.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, -400.0, 6.0, 0.0, 12.0, 0.0, -375.0, 0.0, -10.0, -14.0, -20.0, -368.0, 4.0, 0.0, -18.0, 0.0, -17.0, 0.0, 15.0, 0.0, -400.0, -10.0, -14.0, 14.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, -1.0, 0.0, 0.0, 0.0, 6.0, -6.0, -13.0, 0.0, -373.0, 0.0, -18.0, -6.0, -6.0, 11.0, 0.0, 15.0, 7.0, -40.0, -11.0, 0.0, 0.0, 15.0, 4.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 15.0, 0.0, 2.0, 0.0, 13.0, 0.0, 15.0, 1.0, 0.0, 0.0, 15.0, -18.0, -364.0, -10.0, 1.0, 3.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 193.0, 0.0, 0.0, 10.0, 200.0, 7.0, 0.0, 199.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 13.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 9.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 181.0, 0.0, 10.0, 10.0, 7.0, 182.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 198.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 9.0, 182.0, 9.0, 6.0, 9.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 188.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9445263021330433, "mean_inference_ms": 2.482199257514293, "mean_action_processing_ms": 0.4596583649701248, "mean_env_wait_ms": 0.33690392128233365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01185309886932373, "StateBufferConnector_ms": 0.013969898223876953, "ViewRequirementAgentConnector_ms": 0.17761433124542236}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -576.0, "episode_return_mean": -29.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.075200706002, "num_env_steps_trained_throughput_per_sec": 311.075200706002, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 13389.904, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13389.831, "sample_time_ms": 2308.127, "learn_time_ms": 11055.368, "learn_throughput": 361.815, "synch_weights_time_ms": 20.385}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 108, "trial_id": "e1352_00000", "date": "2024-08-13_17-03-35", "timestamp": 1723583015, "time_this_iter_s": 12.910434007644653, "time_total_s": 1532.5007236003876, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ecaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1532.5007236003876, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 65.52222222222223, "ram_util_percent": 83.52777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.875482043745144, "cur_kl_coeff": 0.9741963076405225, "cur_lr": 0.009999999999999998, "total_loss": 1.0127445654578942, "policy_loss": -0.0002365851755101214, "vf_loss": 1.0129811507290003, "vf_explained_var": 0.003249684969584147, "kl": 2.5623743347653797e-45, "entropy": 7.628310730176755e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.016485828951016, "cur_kl_coeff": 8.1564093079578e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.6514483538411913, "policy_loss": -0.00012415469040177643, "vf_loss": 1.6515725165132493, "vf_explained_var": -8.672633499064773e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -600.0, "episode_reward_mean": -35.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -33.0, "predator_policy": 15.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, -207.0, -184.0, 0.0, -2.0, 13.0, 13.0, -190.0, -10.0, 0.0, 0.0, 0.0, -200.0, 0.0, 0.0, -6.0, -7.0, -20.0, 0.0, 0.0, 26.0, 7.0, 6.0, 0.0, 4.0, -18.0, 18.0, -7.0, 0.0, 1.0, -4.0, -7.0, -6.0, 1.0, 1.0, -2.0, 1.0, 0.0, 5.0, -576.0, 0.0, 0.0, 13.0, -194.0, 12.0, -184.0, 0.0, -17.0, -172.0, -8.0, -7.0, 15.0, -192.0, -17.0, 14.0, 7.0, 0.0, 14.0, 2.0, 0.0, 3.0, -3.0, -182.0, -9.0, 14.0, 15.0, -13.0, -1.0, 15.0, 8.0, 0.0, 9.0, 10.0, -2.0, 15.0, 2.0, 13.0, 16.0, 0.0, 6.0, -176.0, 4.0, 27.0, 0.0, 0.0, 15.0, 15.0, 15.0, 0.0, 18.0, 11.0, -5.0, 5.0, -173.0, -6.0, 0.0, 12.0, -600.0, 0.0, -549.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.0, 2.0, -14.0, -400.0, -398.0, 15.0, 0.0, 0.0, 0.0, -8.0, 13.0, 0.0, 0.0, 13.0, 0.0, -385.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, -17.0, 0.0, -20.0, -11.0, 0.0, 0.0, 0.0, 0.0, 15.0, 11.0, 7.0, 0.0, -14.0, 13.0, 0.0, 0.0, 4.0, 0.0, -32.0, -6.0, 6.0, 12.0, 0.0, -14.0, 0.0, 0.0, 1.0, 0.0, -11.0, 0.0, -17.0, 1.0, -12.0, 0.0, 0.0, 1.0, 1.0, 0.0, -24.0, 5.0, 3.0, -4.0, 0.0, 0.0, 0.0, 5.0, -400.0, -376.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, -400.0, 6.0, 0.0, 12.0, 0.0, -375.0, 0.0, -10.0, -14.0, -20.0, -368.0, 4.0, 0.0, -18.0, 0.0, -17.0, 0.0, 15.0, 0.0, -400.0, -10.0, -14.0, 14.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, -1.0, 0.0, 0.0, 0.0, 6.0, -6.0, -13.0, 0.0, -373.0, 0.0, -18.0, -6.0, -6.0, 11.0, 0.0, 15.0, 7.0, -40.0, -11.0, 0.0, 0.0, 15.0, 4.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 15.0, 0.0, 2.0, 0.0, 13.0, 0.0, 15.0, 1.0, 0.0, 0.0, 15.0, -18.0, -364.0, -10.0, 1.0, 3.0, 12.0, 15.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 4.0, 14.0, 0.0, 7.0, 0.0, -10.0, 0.0, 5.0, -379.0, 14.0, 0.0, -12.0, 0.0, 0.0, 11.0, -2.0, -400.0, -400.0, 0.0, 0.0, -400.0, -349.0], "policy_predator_policy_reward": [0.0, 10.0, 200.0, 7.0, 0.0, 199.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 13.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 9.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 181.0, 0.0, 10.0, 10.0, 7.0, 182.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 198.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 9.0, 182.0, 9.0, 6.0, 9.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 0.0, 192.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 1.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9429293514568936, "mean_inference_ms": 2.478579392179068, "mean_action_processing_ms": 0.4669505217554111, "mean_env_wait_ms": 0.3364456257878349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011760473251342773, "StateBufferConnector_ms": 0.003797173500061035, "ViewRequirementAgentConnector_ms": 0.15956580638885498}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -600.0, "episode_return_mean": -35.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.9467291067826, "num_env_steps_trained_throughput_per_sec": 276.9467291067826, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1744000, "timers": {"training_iteration_time_ms": 13503.79, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13503.718, "sample_time_ms": 2199.521, "learn_time_ms": 11278.091, "learn_throughput": 354.67, "synch_weights_time_ms": 20.308}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "done": false, "training_iteration": 109, "trial_id": "e1352_00000", "date": "2024-08-13_17-03-49", "timestamp": 1723583029, "time_this_iter_s": 14.521544933319092, "time_total_s": 1547.0222685337067, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1679040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1547.0222685337067, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 78.57142857142858, "ram_util_percent": 82.8952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2820698323960182, "cur_kl_coeff": 0.4870981538202612, "cur_lr": 0.009999999999999998, "total_loss": 0.706187736554436, "policy_loss": 8.62213445423299e-05, "vf_loss": 0.7061015135731804, "vf_explained_var": 0.004437544989207435, "kl": -5.81131077427403e-45, "entropy": 8.845855221590813e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.31648624440952, "cur_kl_coeff": 4.0782046539789e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.0283207051475685, "policy_loss": -0.00011487027245854575, "vf_loss": 1.0284355745350242, "vf_explained_var": -6.875033101076802e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -600.0, "episode_reward_mean": -37.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -33.235, "predator_policy": 14.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 4.0, -18.0, 18.0, -7.0, 0.0, 1.0, -4.0, -7.0, -6.0, 1.0, 1.0, -2.0, 1.0, 0.0, 5.0, -576.0, 0.0, 0.0, 13.0, -194.0, 12.0, -184.0, 0.0, -17.0, -172.0, -8.0, -7.0, 15.0, -192.0, -17.0, 14.0, 7.0, 0.0, 14.0, 2.0, 0.0, 3.0, -3.0, -182.0, -9.0, 14.0, 15.0, -13.0, -1.0, 15.0, 8.0, 0.0, 9.0, 10.0, -2.0, 15.0, 2.0, 13.0, 16.0, 0.0, 6.0, -176.0, 4.0, 27.0, 0.0, 0.0, 15.0, 15.0, 15.0, 0.0, 18.0, 11.0, -5.0, 5.0, -173.0, -6.0, 0.0, 12.0, -600.0, 0.0, -549.0, 8.0, 0.0, 0.0, 9.0, 0.0, -200.0, 0.0, -3.0, 15.0, -10.0, 0.0, -200.0, 0.0, 0.0, -1.0, 0.0, -12.0, 4.0, -12.0, 6.0, 5.0, 0.0, -589.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 4.0, 0.0, -32.0, -6.0, 6.0, 12.0, 0.0, -14.0, 0.0, 0.0, 1.0, 0.0, -11.0, 0.0, -17.0, 1.0, -12.0, 0.0, 0.0, 1.0, 1.0, 0.0, -24.0, 5.0, 3.0, -4.0, 0.0, 0.0, 0.0, 5.0, -400.0, -376.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, -400.0, 6.0, 0.0, 12.0, 0.0, -375.0, 0.0, -10.0, -14.0, -20.0, -368.0, 4.0, 0.0, -18.0, 0.0, -17.0, 0.0, 15.0, 0.0, -400.0, -10.0, -14.0, 14.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, -1.0, 0.0, 0.0, 0.0, 6.0, -6.0, -13.0, 0.0, -373.0, 0.0, -18.0, -6.0, -6.0, 11.0, 0.0, 15.0, 7.0, -40.0, -11.0, 0.0, 0.0, 15.0, 4.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 15.0, 0.0, 2.0, 0.0, 13.0, 0.0, 15.0, 1.0, 0.0, 0.0, 15.0, -18.0, -364.0, -10.0, 1.0, 3.0, 12.0, 15.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 4.0, 14.0, 0.0, 7.0, 0.0, -10.0, 0.0, 5.0, -379.0, 14.0, 0.0, -12.0, 0.0, 0.0, 11.0, -2.0, -400.0, -400.0, 0.0, 0.0, -400.0, -349.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, -12.0, 15.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -12.0, -8.0, 0.0, 15.0, 0.0, -20.0, 0.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -20.0, -2.0, 1.0, 0.0, -32.0, 0.0, 0.0, 6.0, 15.0, -20.0, 0.0, 0.0, -397.0, -391.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 7.0, 13.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 9.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 181.0, 0.0, 10.0, 10.0, 7.0, 182.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 198.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 9.0, 182.0, 9.0, 6.0, 9.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 0.0, 192.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 1.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 199.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9406106082510202, "mean_inference_ms": 2.472897320965618, "mean_action_processing_ms": 0.4760620558200582, "mean_env_wait_ms": 0.33569603167577045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01062619686126709, "StateBufferConnector_ms": 0.004409074783325195, "ViewRequirementAgentConnector_ms": 0.15193533897399902}, "num_episodes": 23, "episode_return_max": 27.0, "episode_return_min": -600.0, "episode_return_mean": -37.54, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.02794250569315, "num_env_steps_trained_throughput_per_sec": 264.02794250569315, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 13644.109, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13644.039, "sample_time_ms": 2085.771, "learn_time_ms": 11532.726, "learn_throughput": 346.839, "synch_weights_time_ms": 19.699}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 110, "trial_id": "e1352_00000", "date": "2024-08-13_17-04-05", "timestamp": 1723583045, "time_this_iter_s": 15.21240782737732, "time_total_s": 1562.234676361084, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ec9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1562.234676361084, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 82.70000000000002, "ram_util_percent": 82.92380952380952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.116933716147665, "cur_kl_coeff": 0.2435490769101306, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 9.118172182410798e-05, "vf_loss": 0.48280637298233897, "vf_explained_var": 0.003357019027074178, "kl": Infinity, "entropy": 1.0706875226395068e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3402467945024554, "cur_kl_coeff": 2.03910232698945e-08, "cur_lr": 0.009999999999999998, "total_loss": 0.5857508457349564, "policy_loss": 7.932354331450172e-05, "vf_loss": 0.5856715196891437, "vf_explained_var": 9.776423217127562e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -600.0, "episode_reward_mean": -31.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -29.14, "predator_policy": 13.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 13.0, -194.0, 12.0, -184.0, 0.0, -17.0, -172.0, -8.0, -7.0, 15.0, -192.0, -17.0, 14.0, 7.0, 0.0, 14.0, 2.0, 0.0, 3.0, -3.0, -182.0, -9.0, 14.0, 15.0, -13.0, -1.0, 15.0, 8.0, 0.0, 9.0, 10.0, -2.0, 15.0, 2.0, 13.0, 16.0, 0.0, 6.0, -176.0, 4.0, 27.0, 0.0, 0.0, 15.0, 15.0, 15.0, 0.0, 18.0, 11.0, -5.0, 5.0, -173.0, -6.0, 0.0, 12.0, -600.0, 0.0, -549.0, 8.0, 0.0, 0.0, 9.0, 0.0, -200.0, 0.0, -3.0, 15.0, -10.0, 0.0, -200.0, 0.0, 0.0, -1.0, 0.0, -12.0, 4.0, -12.0, 6.0, 5.0, 0.0, -589.0, 15.0, 3.0, 4.0, 0.0, 0.0, 0.0, 1.0, 6.0, 11.0, 5.0, 6.0, 11.0, 0.0, 0.0, 1.0, -28.0, 6.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 13.0, -400.0, 6.0, 0.0, 12.0, 0.0, -375.0, 0.0, -10.0, -14.0, -20.0, -368.0, 4.0, 0.0, -18.0, 0.0, -17.0, 0.0, 15.0, 0.0, -400.0, -10.0, -14.0, 14.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 14.0, -1.0, 0.0, 0.0, 0.0, 6.0, -6.0, -13.0, 0.0, -373.0, 0.0, -18.0, -6.0, -6.0, 11.0, 0.0, 15.0, 7.0, -40.0, -11.0, 0.0, 0.0, 15.0, 4.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 15.0, 0.0, 2.0, 0.0, 13.0, 0.0, 15.0, 1.0, 0.0, 0.0, 15.0, -18.0, -364.0, -10.0, 1.0, 3.0, 12.0, 15.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 4.0, 14.0, 0.0, 7.0, 0.0, -10.0, 0.0, 5.0, -379.0, 14.0, 0.0, -12.0, 0.0, 0.0, 11.0, -2.0, -400.0, -400.0, 0.0, 0.0, -400.0, -349.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, -12.0, 15.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -12.0, -8.0, 0.0, 15.0, 0.0, -20.0, 0.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -20.0, -2.0, 1.0, 0.0, -32.0, 0.0, 0.0, 6.0, 15.0, -20.0, 0.0, 0.0, -397.0, -391.0, 15.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, -11.0, 11.0, 0.0, 15.0, -20.0, 0.0, 4.0, 11.0, -9.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, -20.0, -20.0, 11.0, -15.0, -20.0, 10.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 181.0, 0.0, 10.0, 10.0, 7.0, 182.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 198.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 9.0, 182.0, 9.0, 6.0, 9.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 0.0, 192.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 1.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 12.0, 0.0, 10.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9394976993551438, "mean_inference_ms": 2.4696146052136823, "mean_action_processing_ms": 0.47539879998744466, "mean_env_wait_ms": 0.3352533108112171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012164473533630371, "StateBufferConnector_ms": 0.004048585891723633, "ViewRequirementAgentConnector_ms": 0.1634918451309204}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -600.0, "episode_return_mean": -31.24, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.90981223545333, "num_env_steps_trained_throughput_per_sec": 290.90981223545333, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 13673.755, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13673.686, "sample_time_ms": 2110.637, "learn_time_ms": 11537.352, "learn_throughput": 346.7, "synch_weights_time_ms": 19.859}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 111, "trial_id": "e1352_00000", "date": "2024-08-13_17-04-18", "timestamp": 1723583058, "time_this_iter_s": 13.80174207687378, "time_total_s": 1576.0364184379578, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17b2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1576.0364184379578, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 72.24000000000001, "ram_util_percent": 83.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0391887256865777, "cur_kl_coeff": 0.36532361536519614, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -0.00010881363635971433, "vf_loss": 0.8841558865754416, "vf_explained_var": 0.0018726053061308683, "kl": Infinity, "entropy": 1.1434695561637959e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7125104574588246, "cur_kl_coeff": 1.019551163494725e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.0591839095764848, "policy_loss": 2.118811040880188e-05, "vf_loss": 1.0591627183887693, "vf_explained_var": -8.3888018572772e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -600.0, "episode_reward_mean": -29.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -27.18, "predator_policy": 12.395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, 14.0, 15.0, -13.0, -1.0, 15.0, 8.0, 0.0, 9.0, 10.0, -2.0, 15.0, 2.0, 13.0, 16.0, 0.0, 6.0, -176.0, 4.0, 27.0, 0.0, 0.0, 15.0, 15.0, 15.0, 0.0, 18.0, 11.0, -5.0, 5.0, -173.0, -6.0, 0.0, 12.0, -600.0, 0.0, -549.0, 8.0, 0.0, 0.0, 9.0, 0.0, -200.0, 0.0, -3.0, 15.0, -10.0, 0.0, -200.0, 0.0, 0.0, -1.0, 0.0, -12.0, 4.0, -12.0, 6.0, 5.0, 0.0, -589.0, 15.0, 3.0, 4.0, 0.0, 0.0, 0.0, 1.0, 6.0, 11.0, 5.0, 6.0, 11.0, 0.0, 0.0, 1.0, -28.0, 6.0, 0.0, 6.0, 0.0, 0.0, -188.0, -2.0, 8.0, 1.0, 21.0, 9.0, -12.0, 0.0, -197.0, -9.0, -200.0, 6.0, 3.0, -7.0, 0.0, -180.0, 12.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.0, -6.0, -6.0, 11.0, 0.0, 15.0, 7.0, -40.0, -11.0, 0.0, 0.0, 15.0, 4.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 15.0, 0.0, 2.0, 0.0, 13.0, 0.0, 15.0, 1.0, 0.0, 0.0, 15.0, -18.0, -364.0, -10.0, 1.0, 3.0, 12.0, 15.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 4.0, 14.0, 0.0, 7.0, 0.0, -10.0, 0.0, 5.0, -379.0, 14.0, 0.0, -12.0, 0.0, 0.0, 11.0, -2.0, -400.0, -400.0, 0.0, 0.0, -400.0, -349.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, -12.0, 15.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -12.0, -8.0, 0.0, 15.0, 0.0, -20.0, 0.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -20.0, -2.0, 1.0, 0.0, -32.0, 0.0, 0.0, 6.0, 15.0, -20.0, 0.0, 0.0, -397.0, -391.0, 15.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, -11.0, 11.0, 0.0, 15.0, -20.0, 0.0, 4.0, 11.0, -9.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, -20.0, -20.0, 11.0, -15.0, -20.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -382.0, 0.0, -4.0, 8.0, 0.0, 0.0, 1.0, 15.0, 6.0, -2.0, 4.0, 0.0, -32.0, 0.0, 0.0, -394.0, -8.0, -18.0, 0.0, -400.0, 0.0, 7.0, -2.0, 0.0, 3.0, -14.0, 0.0, 0.0, 0.0, -360.0, 0.0, -8.0, 15.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [9.0, 6.0, 9.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 0.0, 192.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 1.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 12.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 10.0, 0.0, 0.0, 7.0, 198.0, 9.0, 0.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 180.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9396349448039664, "mean_inference_ms": 2.4693442455457073, "mean_action_processing_ms": 0.47442968261194124, "mean_env_wait_ms": 0.3352987553463086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012601494789123535, "StateBufferConnector_ms": 0.005901694297790527, "ViewRequirementAgentConnector_ms": 0.22236979007720947}, "num_episodes": 22, "episode_return_max": 27.0, "episode_return_min": -600.0, "episode_return_mean": -29.57, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.2411224840169, "num_env_steps_trained_throughput_per_sec": 284.2411224840169, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 13746.324, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13746.256, "sample_time_ms": 2144.096, "learn_time_ms": 11577.86, "learn_throughput": 345.487, "synch_weights_time_ms": 19.003}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "done": false, "training_iteration": 112, "trial_id": "e1352_00000", "date": "2024-08-13_17-04-33", "timestamp": 1723583073, "time_this_iter_s": 14.127681016921997, "time_total_s": 1590.1640994548798, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16e0dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1590.1640994548798, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 68.87500000000001, "ram_util_percent": 83.765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.161925127793833, "cur_kl_coeff": 0.5479854230477937, "cur_lr": 0.009999999999999998, "total_loss": 0.8013786322067654, "policy_loss": 0.0001317103647148956, "vf_loss": 0.8012469199993623, "vf_explained_var": 0.004875587975537336, "kl": 7.837336268249689e-44, "entropy": 2.7048500586270276e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.24888132411208, "cur_kl_coeff": 5.097755817473625e-09, "cur_lr": 0.009999999999999998, "total_loss": 1.0446932762703567, "policy_loss": -6.475814805420303e-05, "vf_loss": 1.0447580334686097, "vf_explained_var": -5.960464477539063e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -600.0, "episode_reward_mean": -30.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -27.42, "predator_policy": 12.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 27.0, 0.0, 0.0, 15.0, 15.0, 15.0, 0.0, 18.0, 11.0, -5.0, 5.0, -173.0, -6.0, 0.0, 12.0, -600.0, 0.0, -549.0, 8.0, 0.0, 0.0, 9.0, 0.0, -200.0, 0.0, -3.0, 15.0, -10.0, 0.0, -200.0, 0.0, 0.0, -1.0, 0.0, -12.0, 4.0, -12.0, 6.0, 5.0, 0.0, -589.0, 15.0, 3.0, 4.0, 0.0, 0.0, 0.0, 1.0, 6.0, 11.0, 5.0, 6.0, 11.0, 0.0, 0.0, 1.0, -28.0, 6.0, 0.0, 6.0, 0.0, 0.0, -188.0, -2.0, 8.0, 1.0, 21.0, 9.0, -12.0, 0.0, -197.0, -9.0, -200.0, 6.0, 3.0, -7.0, 0.0, -180.0, 12.0, 0.0, 0.0, 15.0, 8.0, 11.0, 15.0, -2.0, 15.0, 0.0, 0.0, -9.0, -10.0, 10.0, 15.0, -3.0, -3.0, 10.0, -10.0, -180.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 3.0, 12.0, 15.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 15.0, 0.0, 0.0, 0.0, 4.0, 14.0, 0.0, 7.0, 0.0, -10.0, 0.0, 5.0, -379.0, 14.0, 0.0, -12.0, 0.0, 0.0, 11.0, -2.0, -400.0, -400.0, 0.0, 0.0, -400.0, -349.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, -12.0, 15.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -12.0, -8.0, 0.0, 15.0, 0.0, -20.0, 0.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -20.0, -2.0, 1.0, 0.0, -32.0, 0.0, 0.0, 6.0, 15.0, -20.0, 0.0, 0.0, -397.0, -391.0, 15.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, -11.0, 11.0, 0.0, 15.0, -20.0, 0.0, 4.0, 11.0, -9.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, -20.0, -20.0, 11.0, -15.0, -20.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -382.0, 0.0, -4.0, 8.0, 0.0, 0.0, 1.0, 15.0, 6.0, -2.0, 4.0, 0.0, -32.0, 0.0, 0.0, -394.0, -8.0, -18.0, 0.0, -400.0, 0.0, 7.0, -2.0, 0.0, 3.0, -14.0, 0.0, 0.0, 0.0, -360.0, 0.0, -8.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 0.0, 11.0, 0.0, 0.0, 15.0, -9.0, -6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -7.0, -19.0, 0.0, -20.0, -10.0, 15.0, 15.0, 0.0, -16.0, 5.0, -4.0, -11.0, 0.0, 10.0, 0.0, -20.0, -360.0, 0.0, 0.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 0.0, 192.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 1.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 12.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 10.0, 0.0, 0.0, 7.0, 198.0, 9.0, 0.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 180.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 15.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 2.0, 0.0, 0.0, 10.0, 0.0, 180.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9401853398157288, "mean_inference_ms": 2.469956634904295, "mean_action_processing_ms": 0.47386586591768365, "mean_env_wait_ms": 0.3353490055942008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0085068941116333, "StateBufferConnector_ms": 0.005828142166137695, "ViewRequirementAgentConnector_ms": 0.21506226062774658}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -600.0, "episode_return_mean": -30.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6498842502992, "num_env_steps_trained_throughput_per_sec": 300.6498842502992, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1808000, "timers": {"training_iteration_time_ms": 13745.186, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13745.117, "sample_time_ms": 2104.569, "learn_time_ms": 11618.708, "learn_throughput": 344.272, "synch_weights_time_ms": 17.061}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "done": false, "training_iteration": 113, "trial_id": "e1352_00000", "date": "2024-08-13_17-04-46", "timestamp": 1723583086, "time_this_iter_s": 13.383867263793945, "time_total_s": 1603.5479667186737, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17afc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1603.5479667186737, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 69.52105263157895, "ram_util_percent": 83.79473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1221716439814635, "cur_kl_coeff": 0.27399271152389687, "cur_lr": 0.009999999999999998, "total_loss": 1.3294129225627456, "policy_loss": -0.00048774788180789934, "vf_loss": 1.3299006712342065, "vf_explained_var": 0.0016847469819285881, "kl": -1.0003195037554267e-43, "entropy": 5.156206337199334e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1005068544020613, "cur_kl_coeff": 2.5488779087368125e-09, "cur_lr": 0.009999999999999998, "total_loss": 1.8609533286914623, "policy_loss": -0.0001283739144031806, "vf_loss": 1.8610817177901193, "vf_explained_var": -8.73570719723979e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -600.0, "episode_reward_mean": -39.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -36.015, "predator_policy": 16.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -200.0, 0.0, -3.0, 15.0, -10.0, 0.0, -200.0, 0.0, 0.0, -1.0, 0.0, -12.0, 4.0, -12.0, 6.0, 5.0, 0.0, -589.0, 15.0, 3.0, 4.0, 0.0, 0.0, 0.0, 1.0, 6.0, 11.0, 5.0, 6.0, 11.0, 0.0, 0.0, 1.0, -28.0, 6.0, 0.0, 6.0, 0.0, 0.0, -188.0, -2.0, 8.0, 1.0, 21.0, 9.0, -12.0, 0.0, -197.0, -9.0, -200.0, 6.0, 3.0, -7.0, 0.0, -180.0, 12.0, 0.0, 0.0, 15.0, 8.0, 11.0, 15.0, -2.0, 15.0, 0.0, 0.0, -9.0, -10.0, 10.0, 15.0, -3.0, -3.0, 10.0, -10.0, -180.0, -10.0, 0.0, 0.0, -180.0, -8.0, -600.0, -560.0, 0.0, 0.0, -200.0, -13.0, -8.0, 15.0, 0.0, 0.0, -1.0, -16.0, -7.0, 14.0, -200.0, 15.0, -161.0, 5.0, -185.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -12.0, -8.0, 0.0, 15.0, 0.0, -20.0, 0.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -20.0, -2.0, 1.0, 0.0, -32.0, 0.0, 0.0, 6.0, 15.0, -20.0, 0.0, 0.0, -397.0, -391.0, 15.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, -11.0, 11.0, 0.0, 15.0, -20.0, 0.0, 4.0, 11.0, -9.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, -20.0, -20.0, 11.0, -15.0, -20.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -382.0, 0.0, -4.0, 8.0, 0.0, 0.0, 1.0, 15.0, 6.0, -2.0, 4.0, 0.0, -32.0, 0.0, 0.0, -394.0, -8.0, -18.0, 0.0, -400.0, 0.0, 7.0, -2.0, 0.0, 3.0, -14.0, 0.0, 0.0, 0.0, -360.0, 0.0, -8.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 0.0, 11.0, 0.0, 0.0, 15.0, -9.0, -6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -7.0, -19.0, 0.0, -20.0, -10.0, 15.0, 15.0, 0.0, -16.0, 5.0, -4.0, -11.0, 0.0, 10.0, 0.0, -20.0, -360.0, 0.0, 0.0, -20.0, 0.0, -18.0, 0.0, 0.0, 6.0, -372.0, -16.0, 0.0, -400.0, -400.0, -384.0, -368.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -13.0, -20.0, -16.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, -12.0, -10.0, 0.0, -14.0, 0.0, 14.0, -400.0, 0.0, 0.0, 15.0, 15.0, -363.0, -2.0, 1.0, -400.0, 15.0], "policy_predator_policy_reward": [0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 12.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 10.0, 0.0, 0.0, 7.0, 198.0, 9.0, 0.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 180.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 15.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 2.0, 0.0, 0.0, 10.0, 0.0, 180.0, 0.0, 10.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 186.0, 0.0, 8.0, 200.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 20.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 187.0, 0.0, 6.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9412838633079847, "mean_inference_ms": 2.470860139250507, "mean_action_processing_ms": 0.47370650567507405, "mean_env_wait_ms": 0.33539827850715737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010495424270629883, "StateBufferConnector_ms": 0.005914807319641113, "ViewRequirementAgentConnector_ms": 0.22116518020629883}, "num_episodes": 23, "episode_return_max": 21.0, "episode_return_min": -600.0, "episode_return_mean": -39.03, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.83010979741255, "num_env_steps_trained_throughput_per_sec": 315.83010979741255, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 13706.011, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13705.942, "sample_time_ms": 2043.286, "learn_time_ms": 11641.934, "learn_throughput": 343.586, "synch_weights_time_ms": 16.266}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 114, "trial_id": "e1352_00000", "date": "2024-08-13_17-04-59", "timestamp": 1723583099, "time_this_iter_s": 12.733014822006226, "time_total_s": 1616.28098154068, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17b2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1616.28098154068, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 68.81111111111112, "ram_util_percent": 83.55555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3791088942812864, "cur_kl_coeff": 0.13699635576194844, "cur_lr": 0.009999999999999998, "total_loss": 0.9607356208026725, "policy_loss": -6.081312352781573e-05, "vf_loss": 0.9607964337345154, "vf_explained_var": 0.004335357682414787, "kl": 1.6399937170257333e-43, "entropy": 8.547357369712946e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.160235230345325, "cur_kl_coeff": 1.2744389543684062e-09, "cur_lr": 0.009999999999999998, "total_loss": 1.2814949086655385, "policy_loss": -0.00023388949656494396, "vf_loss": 1.2817287974572056, "vf_explained_var": -6.969643648339327e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -38.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.615, "predator_policy": 16.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-589.0, 15.0, 3.0, 4.0, 0.0, 0.0, 0.0, 1.0, 6.0, 11.0, 5.0, 6.0, 11.0, 0.0, 0.0, 1.0, -28.0, 6.0, 0.0, 6.0, 0.0, 0.0, -188.0, -2.0, 8.0, 1.0, 21.0, 9.0, -12.0, 0.0, -197.0, -9.0, -200.0, 6.0, 3.0, -7.0, 0.0, -180.0, 12.0, 0.0, 0.0, 15.0, 8.0, 11.0, 15.0, -2.0, 15.0, 0.0, 0.0, -9.0, -10.0, 10.0, 15.0, -3.0, -3.0, 10.0, -10.0, -180.0, -10.0, 0.0, 0.0, -180.0, -8.0, -600.0, -560.0, 0.0, 0.0, -200.0, -13.0, -8.0, 15.0, 0.0, 0.0, -1.0, -16.0, -7.0, 14.0, -200.0, 15.0, -161.0, 5.0, -185.0, 21.0, -5.0, 3.0, -6.0, 9.0, 0.0, -200.0, 26.0, 11.0, -198.0, 0.0, -7.0, -1.0, -10.0, 0.0, 11.0, -3.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-397.0, -391.0, 15.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, -11.0, 11.0, 0.0, 15.0, -20.0, 0.0, 4.0, 11.0, -9.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, -20.0, -20.0, 11.0, -15.0, -20.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -382.0, 0.0, -4.0, 8.0, 0.0, 0.0, 1.0, 15.0, 6.0, -2.0, 4.0, 0.0, -32.0, 0.0, 0.0, -394.0, -8.0, -18.0, 0.0, -400.0, 0.0, 7.0, -2.0, 0.0, 3.0, -14.0, 0.0, 0.0, 0.0, -360.0, 0.0, -8.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 0.0, 11.0, 0.0, 0.0, 15.0, -9.0, -6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -7.0, -19.0, 0.0, -20.0, -10.0, 15.0, 15.0, 0.0, -16.0, 5.0, -4.0, -11.0, 0.0, 10.0, 0.0, -20.0, -360.0, 0.0, 0.0, -20.0, 0.0, -18.0, 0.0, 0.0, 6.0, -372.0, -16.0, 0.0, -400.0, -400.0, -384.0, -368.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -13.0, -20.0, -16.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, -12.0, -10.0, 0.0, -14.0, 0.0, 14.0, -400.0, 0.0, 0.0, 15.0, 15.0, -363.0, -2.0, 1.0, -400.0, 15.0, 13.0, 8.0, -15.0, 0.0, 0.0, 3.0, -18.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, -400.0, 15.0, 11.0, -6.0, 14.0, 0.0, -396.0, 0.0, 0.0, -14.0, 0.0, 0.0, -2.0, -20.0, 0.0, 0.0, 0.0, 15.0, -8.0, -6.0, 0.0, 0.0, -22.0], "policy_predator_policy_reward": [0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 12.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 10.0, 0.0, 0.0, 7.0, 198.0, 9.0, 0.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 180.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 15.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 2.0, 0.0, 0.0, 10.0, 0.0, 180.0, 0.0, 10.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 186.0, 0.0, 8.0, 200.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 20.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 187.0, 0.0, 6.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 198.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 10.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9413468950432989, "mean_inference_ms": 2.4712089954549317, "mean_action_processing_ms": 0.4727324176342478, "mean_env_wait_ms": 0.3353868371222822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009394288063049316, "StateBufferConnector_ms": 0.005121350288391113, "ViewRequirementAgentConnector_ms": 0.19462966918945312}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -38.51, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.8590826622148, "num_env_steps_trained_throughput_per_sec": 300.8590826622148, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 13714.37, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13714.317, "sample_time_ms": 1985.261, "learn_time_ms": 11710.44, "learn_throughput": 341.576, "synch_weights_time_ms": 16.277}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 115, "trial_id": "e1352_00000", "date": "2024-08-13_17-05-12", "timestamp": 1723583112, "time_this_iter_s": 13.367337942123413, "time_total_s": 1629.6483194828033, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15f58b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1629.6483194828033, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 70.7578947368421, "ram_util_percent": 83.67894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2252247322074794, "cur_kl_coeff": 0.06849817788097422, "cur_lr": 0.009999999999999998, "total_loss": 1.3864428132614761, "policy_loss": 8.263892035872217e-05, "vf_loss": 1.3863601793057074, "vf_explained_var": 0.004209133998426811, "kl": 9.046011800811761e-44, "entropy": 1.094550056245832e-40, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0620051859612682, "cur_kl_coeff": 6.372194771842031e-10, "cur_lr": 0.009999999999999998, "total_loss": 1.743617203216704, "policy_loss": 0.00013873759489605036, "vf_loss": 1.743478466625567, "vf_explained_var": -7.411159535564442e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -53.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -49.07, "predator_policy": 22.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.0, -2.0, 8.0, 1.0, 21.0, 9.0, -12.0, 0.0, -197.0, -9.0, -200.0, 6.0, 3.0, -7.0, 0.0, -180.0, 12.0, 0.0, 0.0, 15.0, 8.0, 11.0, 15.0, -2.0, 15.0, 0.0, 0.0, -9.0, -10.0, 10.0, 15.0, -3.0, -3.0, 10.0, -10.0, -180.0, -10.0, 0.0, 0.0, -180.0, -8.0, -600.0, -560.0, 0.0, 0.0, -200.0, -13.0, -8.0, 15.0, 0.0, 0.0, -1.0, -16.0, -7.0, 14.0, -200.0, 15.0, -161.0, 5.0, -185.0, 21.0, -5.0, 3.0, -6.0, 9.0, 0.0, -200.0, 26.0, 11.0, -198.0, 0.0, -7.0, -1.0, -10.0, 0.0, 11.0, -3.0, -7.0, -170.0, -9.0, -183.0, 0.0, -10.0, -152.0, 0.0, -8.0, 0.0, -598.0, 0.0, 0.0, 5.0, -573.0, -1.0, -193.0, -4.0, 6.0, -1.0, 0.0, -186.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, -382.0, 0.0, -4.0, 8.0, 0.0, 0.0, 1.0, 15.0, 6.0, -2.0, 4.0, 0.0, -32.0, 0.0, 0.0, -394.0, -8.0, -18.0, 0.0, -400.0, 0.0, 7.0, -2.0, 0.0, 3.0, -14.0, 0.0, 0.0, 0.0, -360.0, 0.0, -8.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 8.0, 0.0, 11.0, 0.0, 0.0, 15.0, -9.0, -6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -7.0, -19.0, 0.0, -20.0, -10.0, 15.0, 15.0, 0.0, -16.0, 5.0, -4.0, -11.0, 0.0, 10.0, 0.0, -20.0, -360.0, 0.0, 0.0, -20.0, 0.0, -18.0, 0.0, 0.0, 6.0, -372.0, -16.0, 0.0, -400.0, -400.0, -384.0, -368.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -13.0, -20.0, -16.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, -12.0, -10.0, 0.0, -14.0, 0.0, 14.0, -400.0, 0.0, 0.0, 15.0, 15.0, -363.0, -2.0, 1.0, -400.0, 15.0, 13.0, 8.0, -15.0, 0.0, 0.0, 3.0, -18.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, -400.0, 15.0, 11.0, -6.0, 14.0, 0.0, -396.0, 0.0, 0.0, -14.0, 0.0, 0.0, -2.0, -20.0, 0.0, 0.0, 0.0, 15.0, -8.0, -6.0, 0.0, 0.0, -22.0, -355.0, 0.0, 0.0, -18.0, 0.0, -366.0, 0.0, 0.0, -20.0, 0.0, 12.0, -343.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -400.0, -398.0, 0.0, 0.0, 0.0, 0.0, -20.0, 15.0, -383.0, -400.0, 0.0, -3.0, -400.0, 7.0, 0.0, -8.0, -19.0, 15.0, -2.0, -8.0, 0.0, 0.0, 7.0, -388.0, -20.0, 0.0], "policy_predator_policy_reward": [0.0, 191.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 10.0, 0.0, 0.0, 7.0, 198.0, 9.0, 0.0, 200.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 180.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 15.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 2.0, 0.0, 0.0, 10.0, 0.0, 180.0, 0.0, 10.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 186.0, 0.0, 8.0, 200.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 20.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 187.0, 0.0, 6.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 198.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 10.0, 5.0, 0.0, 185.0, 0.0, 9.0, 183.0, 0.0, 0.0, 0.0, 10.0, 0.0, 179.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 200.0, 2.0, 0.0, 200.0, 0.0, 4.0, 0.0, 0.0, 10.0, 5.0, 4.0, 0.0, 0.0, 0.0, 195.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9403995388505197, "mean_inference_ms": 2.4701396401094633, "mean_action_processing_ms": 0.47173838964612286, "mean_env_wait_ms": 0.3348933857050287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00792384147644043, "StateBufferConnector_ms": 0.005056500434875488, "ViewRequirementAgentConnector_ms": 0.16616785526275635}, "num_episodes": 22, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -53.96, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.4370611557648, "num_env_steps_trained_throughput_per_sec": 302.4370611557648, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1856000, "timers": {"training_iteration_time_ms": 13544.65, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13544.597, "sample_time_ms": 1758.353, "learn_time_ms": 11767.597, "learn_throughput": 339.916, "synch_weights_time_ms": 15.918}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "done": false, "training_iteration": 116, "trial_id": "e1352_00000", "date": "2024-08-13_17-05-26", "timestamp": 1723583126, "time_this_iter_s": 13.28015398979187, "time_total_s": 1642.9284734725952, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17afc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1642.9284734725952, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 63.9388888888889, "ram_util_percent": 83.55555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.011539557105098, "cur_kl_coeff": 0.03424908894048711, "cur_lr": 0.009999999999999998, "total_loss": 1.4934695352006842, "policy_loss": 0.00018752794158423232, "vf_loss": 1.4932820059635021, "vf_explained_var": 0.011181713822026733, "kl": 3.6530145681102506e-43, "entropy": 8.066979058728291e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1840201149954477, "cur_kl_coeff": 3.1860973859210156e-10, "cur_lr": 0.009999999999999998, "total_loss": 2.276688831508475, "policy_loss": 5.3371007741483115e-05, "vf_loss": 2.2766354664923654, "vf_explained_var": -4.762064212213748e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -65.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -55.12, "predator_policy": 22.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 15.0, 8.0, 11.0, 15.0, -2.0, 15.0, 0.0, 0.0, -9.0, -10.0, 10.0, 15.0, -3.0, -3.0, 10.0, -10.0, -180.0, -10.0, 0.0, 0.0, -180.0, -8.0, -600.0, -560.0, 0.0, 0.0, -200.0, -13.0, -8.0, 15.0, 0.0, 0.0, -1.0, -16.0, -7.0, 14.0, -200.0, 15.0, -161.0, 5.0, -185.0, 21.0, -5.0, 3.0, -6.0, 9.0, 0.0, -200.0, 26.0, 11.0, -198.0, 0.0, -7.0, -1.0, -10.0, 0.0, 11.0, -3.0, -7.0, -170.0, -9.0, -183.0, 0.0, -10.0, -152.0, 0.0, -8.0, 0.0, -598.0, 0.0, 0.0, 5.0, -573.0, -1.0, -193.0, -4.0, 6.0, -1.0, 0.0, -186.0, -10.0, -587.0, -546.0, 1.0, -600.0, 0.0, 3.0, 0.0, 6.0, -4.0, 14.0, 6.0, 0.0, 2.0, -180.0, -16.0, -10.0, -8.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 15.0, 8.0, 0.0, 11.0, 0.0, 0.0, 15.0, -9.0, -6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -7.0, -19.0, 0.0, -20.0, -10.0, 15.0, 15.0, 0.0, -16.0, 5.0, -4.0, -11.0, 0.0, 10.0, 0.0, -20.0, -360.0, 0.0, 0.0, -20.0, 0.0, -18.0, 0.0, 0.0, 6.0, -372.0, -16.0, 0.0, -400.0, -400.0, -384.0, -368.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -13.0, -20.0, -16.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, -12.0, -10.0, 0.0, -14.0, 0.0, 14.0, -400.0, 0.0, 0.0, 15.0, 15.0, -363.0, -2.0, 1.0, -400.0, 15.0, 13.0, 8.0, -15.0, 0.0, 0.0, 3.0, -18.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, -400.0, 15.0, 11.0, -6.0, 14.0, 0.0, -396.0, 0.0, 0.0, -14.0, 0.0, 0.0, -2.0, -20.0, 0.0, 0.0, 0.0, 15.0, -8.0, -6.0, 0.0, 0.0, -22.0, -355.0, 0.0, 0.0, -18.0, 0.0, -366.0, 0.0, 0.0, -20.0, 0.0, 12.0, -343.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -400.0, -398.0, 0.0, 0.0, 0.0, 0.0, -20.0, 15.0, -383.0, -400.0, 0.0, -3.0, -400.0, 7.0, 0.0, -8.0, -19.0, 15.0, -2.0, -8.0, 0.0, 0.0, 7.0, -388.0, -20.0, 0.0, -394.0, -394.0, -378.0, -367.0, 1.0, 0.0, -400.0, -400.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, -8.0, 0.0, -11.0, 15.0, 0.0, 6.0, 0.0, 0.0, 2.0, 0.0, 2.0, -373.0, -15.0, -15.0, -20.0, 0.0, 0.0, -16.0, 2.0, -16.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 15.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 2.0, 0.0, 0.0, 10.0, 0.0, 180.0, 0.0, 10.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 186.0, 0.0, 8.0, 200.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 20.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 187.0, 0.0, 6.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 198.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 10.0, 5.0, 0.0, 185.0, 0.0, 9.0, 183.0, 0.0, 0.0, 0.0, 10.0, 0.0, 179.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 200.0, 2.0, 0.0, 200.0, 0.0, 4.0, 0.0, 0.0, 10.0, 5.0, 4.0, 0.0, 0.0, 0.0, 195.0, 0.0, 10.0, 191.0, 10.0, 189.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 8.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9399558723342054, "mean_inference_ms": 2.465812839993696, "mean_action_processing_ms": 0.4706283512278563, "mean_env_wait_ms": 0.33453431114806714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00812983512878418, "StateBufferConnector_ms": 0.0034868717193603516, "ViewRequirementAgentConnector_ms": 0.15896821022033691}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -65.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8730688976362, "num_env_steps_trained_throughput_per_sec": 302.8730688976362, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 13597.192, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13597.139, "sample_time_ms": 1769.648, "learn_time_ms": 11809.344, "learn_throughput": 338.715, "synch_weights_time_ms": 15.594}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 117, "trial_id": "e1352_00000", "date": "2024-08-13_17-05-39", "timestamp": 1723583139, "time_this_iter_s": 13.267498016357422, "time_total_s": 1656.1959714889526, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16dbd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1656.1959714889526, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 63.74736842105262, "ram_util_percent": 83.6263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2884923930856442, "cur_kl_coeff": 0.017124544470243554, "cur_lr": 0.009999999999999998, "total_loss": 0.598819307959269, "policy_loss": 0.00015815243115106589, "vf_loss": 0.5986611550486592, "vf_explained_var": 0.005334528287251791, "kl": -1.0107143209352331e-43, "entropy": 8.985571425476603e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2694874840189834, "cur_kl_coeff": 1.5930486929605078e-10, "cur_lr": 0.009999999999999998, "total_loss": 0.6106463310855722, "policy_loss": 5.505679953823645e-06, "vf_loss": 0.6106408289841037, "vf_explained_var": 4.842609324783244e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -70.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -59.17, "predator_policy": 24.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, 0.0, -180.0, -8.0, -600.0, -560.0, 0.0, 0.0, -200.0, -13.0, -8.0, 15.0, 0.0, 0.0, -1.0, -16.0, -7.0, 14.0, -200.0, 15.0, -161.0, 5.0, -185.0, 21.0, -5.0, 3.0, -6.0, 9.0, 0.0, -200.0, 26.0, 11.0, -198.0, 0.0, -7.0, -1.0, -10.0, 0.0, 11.0, -3.0, -7.0, -170.0, -9.0, -183.0, 0.0, -10.0, -152.0, 0.0, -8.0, 0.0, -598.0, 0.0, 0.0, 5.0, -573.0, -1.0, -193.0, -4.0, 6.0, -1.0, 0.0, -186.0, -10.0, -587.0, -546.0, 1.0, -600.0, 0.0, 3.0, 0.0, 6.0, -4.0, 14.0, 6.0, 0.0, 2.0, -180.0, -16.0, -10.0, -8.0, -6.0, 9.0, 14.0, -3.0, 0.0, 0.0, -4.0, -198.0, 0.0, -5.0, -1.0, -195.0, 6.0, 2.0, 2.0, 0.0, 10.0, -200.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -20.0, 0.0, -18.0, 0.0, 0.0, 6.0, -372.0, -16.0, 0.0, -400.0, -400.0, -384.0, -368.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -13.0, -20.0, -16.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, -12.0, -10.0, 0.0, -14.0, 0.0, 14.0, -400.0, 0.0, 0.0, 15.0, 15.0, -363.0, -2.0, 1.0, -400.0, 15.0, 13.0, 8.0, -15.0, 0.0, 0.0, 3.0, -18.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, -400.0, 15.0, 11.0, -6.0, 14.0, 0.0, -396.0, 0.0, 0.0, -14.0, 0.0, 0.0, -2.0, -20.0, 0.0, 0.0, 0.0, 15.0, -8.0, -6.0, 0.0, 0.0, -22.0, -355.0, 0.0, 0.0, -18.0, 0.0, -366.0, 0.0, 0.0, -20.0, 0.0, 12.0, -343.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -400.0, -398.0, 0.0, 0.0, 0.0, 0.0, -20.0, 15.0, -383.0, -400.0, 0.0, -3.0, -400.0, 7.0, 0.0, -8.0, -19.0, 15.0, -2.0, -8.0, 0.0, 0.0, 7.0, -388.0, -20.0, 0.0, -394.0, -394.0, -378.0, -367.0, 1.0, 0.0, -400.0, -400.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, -8.0, 0.0, -11.0, 15.0, 0.0, 6.0, 0.0, 0.0, 2.0, 0.0, 2.0, -373.0, -15.0, -15.0, -20.0, 0.0, 0.0, -16.0, 2.0, -16.0, 4.0, 5.0, 15.0, -2.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, -400.0, 0.0, 0.0, 0.0, -10.0, 0.0, 4.0, -10.0, 5.0, -400.0, 6.0, 0.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, -400.0, 0.0, 0.0], "policy_predator_policy_reward": [10.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 186.0, 0.0, 8.0, 200.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 20.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 187.0, 0.0, 6.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 198.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 10.0, 5.0, 0.0, 185.0, 0.0, 9.0, 183.0, 0.0, 0.0, 0.0, 10.0, 0.0, 179.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 200.0, 2.0, 0.0, 200.0, 0.0, 4.0, 0.0, 0.0, 10.0, 5.0, 4.0, 0.0, 0.0, 0.0, 195.0, 0.0, 10.0, 191.0, 10.0, 189.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 197.0, 5.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9385629847802679, "mean_inference_ms": 2.4613964030883246, "mean_action_processing_ms": 0.46932753601630794, "mean_env_wait_ms": 0.3338854781374822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008016824722290039, "StateBufferConnector_ms": 0.0034693479537963867, "ViewRequirementAgentConnector_ms": 0.12954449653625488}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -70.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.00236705836494, "num_env_steps_trained_throughput_per_sec": 316.00236705836494, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1888000, "timers": {"training_iteration_time_ms": 13577.143, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13577.089, "sample_time_ms": 1775.978, "learn_time_ms": 11782.856, "learn_throughput": 339.476, "synch_weights_time_ms": 15.71}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "done": false, "training_iteration": 118, "trial_id": "e1352_00000", "date": "2024-08-13_17-05-52", "timestamp": 1723583152, "time_this_iter_s": 12.698450088500977, "time_total_s": 1668.8944215774536, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ecca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1668.8944215774536, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 66.53888888888889, "ram_util_percent": 83.65555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.249283579669932, "cur_kl_coeff": 0.008562272235121777, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.000123581217069711, "vf_loss": 1.2767273637510481, "vf_explained_var": 0.003250605814040653, "kl": Infinity, "entropy": 4.660301046087752e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.130151467683735, "cur_kl_coeff": 7.965243464802539e-11, "cur_lr": 0.009999999999999998, "total_loss": 1.9840767147679808, "policy_loss": -2.9988274121134684e-05, "vf_loss": 1.9841066955889344, "vf_explained_var": -6.2758329684141455e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -62.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -53.25, "predator_policy": 21.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.0, 21.0, -5.0, 3.0, -6.0, 9.0, 0.0, -200.0, 26.0, 11.0, -198.0, 0.0, -7.0, -1.0, -10.0, 0.0, 11.0, -3.0, -7.0, -170.0, -9.0, -183.0, 0.0, -10.0, -152.0, 0.0, -8.0, 0.0, -598.0, 0.0, 0.0, 5.0, -573.0, -1.0, -193.0, -4.0, 6.0, -1.0, 0.0, -186.0, -10.0, -587.0, -546.0, 1.0, -600.0, 0.0, 3.0, 0.0, 6.0, -4.0, 14.0, 6.0, 0.0, 2.0, -180.0, -16.0, -10.0, -8.0, -6.0, 9.0, 14.0, -3.0, 0.0, 0.0, -4.0, -198.0, 0.0, -5.0, -1.0, -195.0, 6.0, 2.0, 2.0, 0.0, 10.0, -200.0, 0.0, 0.0, 7.0, 5.0, 10.0, 0.0, -558.0, 5.0, 0.0, 0.0, -12.0, -210.0, -176.0, 0.0, 1.0, -9.0, -9.0, -200.0, 0.0, -3.0, 0.0, 0.0, 4.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-400.0, 15.0, 13.0, 8.0, -15.0, 0.0, 0.0, 3.0, -18.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, -400.0, 15.0, 11.0, -6.0, 14.0, 0.0, -396.0, 0.0, 0.0, -14.0, 0.0, 0.0, -2.0, -20.0, 0.0, 0.0, 0.0, 15.0, -8.0, -6.0, 0.0, 0.0, -22.0, -355.0, 0.0, 0.0, -18.0, 0.0, -366.0, 0.0, 0.0, -20.0, 0.0, 12.0, -343.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -400.0, -398.0, 0.0, 0.0, 0.0, 0.0, -20.0, 15.0, -383.0, -400.0, 0.0, -3.0, -400.0, 7.0, 0.0, -8.0, -19.0, 15.0, -2.0, -8.0, 0.0, 0.0, 7.0, -388.0, -20.0, 0.0, -394.0, -394.0, -378.0, -367.0, 1.0, 0.0, -400.0, -400.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, -8.0, 0.0, -11.0, 15.0, 0.0, 6.0, 0.0, 0.0, 2.0, 0.0, 2.0, -373.0, -15.0, -15.0, -20.0, 0.0, 0.0, -16.0, 2.0, -16.0, 4.0, 5.0, 15.0, -2.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, -400.0, 0.0, 0.0, 0.0, -10.0, 0.0, 4.0, -10.0, 5.0, -400.0, 6.0, 0.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, -368.0, -384.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, -19.0, -400.0, -20.0, -364.0, 0.0, 0.0, 0.0, 0.0, 1.0, -18.0, 0.0, -18.0, 0.0, -400.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 198.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 10.0, 5.0, 0.0, 185.0, 0.0, 9.0, 183.0, 0.0, 0.0, 0.0, 10.0, 0.0, 179.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 200.0, 2.0, 0.0, 200.0, 0.0, 4.0, 0.0, 0.0, 10.0, 5.0, 4.0, 0.0, 0.0, 0.0, 195.0, 0.0, 10.0, 191.0, 10.0, 189.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 197.0, 5.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 200.0, 10.0, 178.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 9.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9368197210736734, "mean_inference_ms": 2.4560392964950086, "mean_action_processing_ms": 0.4676687363934542, "mean_env_wait_ms": 0.3331233254123432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008278250694274902, "StateBufferConnector_ms": 0.003556370735168457, "ViewRequirementAgentConnector_ms": 0.1412203311920166}, "num_episodes": 23, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -62.61, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.7091158137865, "num_env_steps_trained_throughput_per_sec": 316.7091158137865, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1904000, "timers": {"training_iteration_time_ms": 13395.81, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13395.757, "sample_time_ms": 1784.304, "learn_time_ms": 11593.231, "learn_throughput": 345.029, "synch_weights_time_ms": 15.617}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "done": false, "training_iteration": 119, "trial_id": "e1352_00000", "date": "2024-08-13_17-06-04", "timestamp": 1723583164, "time_this_iter_s": 12.695311069488525, "time_total_s": 1681.5897326469421, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17b2670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1681.5897326469421, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 66.78888888888889, "ram_util_percent": 83.61111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0965676260924844, "cur_kl_coeff": 0.012843408352682668, "cur_lr": 0.009999999999999998, "total_loss": 1.075280437393794, "policy_loss": 3.883667960368767e-05, "vf_loss": 1.0752415969810158, "vf_explained_var": 0.003032542063445641, "kl": 1.0823362424451682e-44, "entropy": 8.55560775538568e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2318755051256627, "cur_kl_coeff": 3.9826217324012695e-11, "cur_lr": 0.009999999999999998, "total_loss": 1.2824351509490972, "policy_loss": 0.00012891187046767857, "vf_loss": 1.282306240065388, "vf_explained_var": -7.600380630089493e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 16.0, "episode_reward_min": -600.0, "episode_reward_mean": -70.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -56.9, "predator_policy": 21.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, -152.0, 0.0, -8.0, 0.0, -598.0, 0.0, 0.0, 5.0, -573.0, -1.0, -193.0, -4.0, 6.0, -1.0, 0.0, -186.0, -10.0, -587.0, -546.0, 1.0, -600.0, 0.0, 3.0, 0.0, 6.0, -4.0, 14.0, 6.0, 0.0, 2.0, -180.0, -16.0, -10.0, -8.0, -6.0, 9.0, 14.0, -3.0, 0.0, 0.0, -4.0, -198.0, 0.0, -5.0, -1.0, -195.0, 6.0, 2.0, 2.0, 0.0, 10.0, -200.0, 0.0, 0.0, 7.0, 5.0, 10.0, 0.0, -558.0, 5.0, 0.0, 0.0, -12.0, -210.0, -176.0, 0.0, 1.0, -9.0, -9.0, -200.0, 0.0, -3.0, 0.0, 0.0, 4.0, 0.0, -10.0, 0.0, 6.0, -554.0, 15.0, 16.0, -575.0, -4.0, -192.0, 14.0, 10.0, 0.0, -8.0, 0.0, -1.0, 3.0, -10.0, -176.0, 0.0, 0.0, -192.0, 7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -20.0, 0.0, 12.0, -343.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -400.0, -398.0, 0.0, 0.0, 0.0, 0.0, -20.0, 15.0, -383.0, -400.0, 0.0, -3.0, -400.0, 7.0, 0.0, -8.0, -19.0, 15.0, -2.0, -8.0, 0.0, 0.0, 7.0, -388.0, -20.0, 0.0, -394.0, -394.0, -378.0, -367.0, 1.0, 0.0, -400.0, -400.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, -8.0, 0.0, -11.0, 15.0, 0.0, 6.0, 0.0, 0.0, 2.0, 0.0, 2.0, -373.0, -15.0, -15.0, -20.0, 0.0, 0.0, -16.0, 2.0, -16.0, 4.0, 5.0, 15.0, -2.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, -400.0, 0.0, 0.0, 0.0, -10.0, 0.0, 4.0, -10.0, 5.0, -400.0, 6.0, 0.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, -368.0, -384.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, -19.0, -400.0, -20.0, -364.0, 0.0, 0.0, 0.0, 0.0, 1.0, -18.0, 0.0, -18.0, 0.0, -400.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 6.0, 0.0, -382.0, -363.0, -10.0, 15.0, 8.0, 8.0, -379.0, -394.0, -8.0, 0.0, 2.0, -388.0, 2.0, 12.0, 9.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -4.0, -12.0, -6.0, 0.0, -364.0, 0.0, 0.0, 0.0, 0.0, 8.0, -400.0, 6.0, 1.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 179.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 200.0, 2.0, 0.0, 200.0, 0.0, 4.0, 0.0, 0.0, 10.0, 5.0, 4.0, 0.0, 0.0, 0.0, 195.0, 0.0, 10.0, 191.0, 10.0, 189.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 197.0, 5.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 200.0, 10.0, 178.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 9.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 10.0, 0.0, 0.0, 198.0, 0.0, 4.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 2.0, 6.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9346361016488391, "mean_inference_ms": 2.4519723212764215, "mean_action_processing_ms": 0.46623877769011157, "mean_env_wait_ms": 0.33225613341322036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00768280029296875, "StateBufferConnector_ms": 0.0036504268646240234, "ViewRequirementAgentConnector_ms": 0.13987600803375244}, "num_episodes": 22, "episode_return_max": 16.0, "episode_return_min": -600.0, "episode_return_mean": -70.09, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.34895504838596, "num_env_steps_trained_throughput_per_sec": 316.34895504838596, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 13145.245, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13145.192, "sample_time_ms": 1781.644, "learn_time_ms": 11345.329, "learn_throughput": 352.568, "synch_weights_time_ms": 15.672}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 120, "trial_id": "e1352_00000", "date": "2024-08-13_17-06-17", "timestamp": 1723583177, "time_this_iter_s": 12.700594186782837, "time_total_s": 1694.290326833725, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15f59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1694.290326833725, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 67.50555555555555, "ram_util_percent": 83.61666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.329953794926405, "cur_kl_coeff": 0.006421704176341334, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00036025671177499353, "vf_loss": 1.5735172483498456, "vf_explained_var": 0.003603042654259495, "kl": Infinity, "entropy": 7.905778947529452e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9885350923395313, "cur_kl_coeff": 1.9913108662006347e-11, "cur_lr": 0.009999999999999998, "total_loss": 1.89791436160683, "policy_loss": -0.00011737106550268079, "vf_loss": 1.8980317326449843, "vf_explained_var": -8.136507064577132e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "env_runners": {"episode_reward_max": 16.0, "episode_reward_min": -600.0, "episode_reward_mean": -66.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -55.46, "predator_policy": 22.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -587.0, -546.0, 1.0, -600.0, 0.0, 3.0, 0.0, 6.0, -4.0, 14.0, 6.0, 0.0, 2.0, -180.0, -16.0, -10.0, -8.0, -6.0, 9.0, 14.0, -3.0, 0.0, 0.0, -4.0, -198.0, 0.0, -5.0, -1.0, -195.0, 6.0, 2.0, 2.0, 0.0, 10.0, -200.0, 0.0, 0.0, 7.0, 5.0, 10.0, 0.0, -558.0, 5.0, 0.0, 0.0, -12.0, -210.0, -176.0, 0.0, 1.0, -9.0, -9.0, -200.0, 0.0, -3.0, 0.0, 0.0, 4.0, 0.0, -10.0, 0.0, 6.0, -554.0, 15.0, 16.0, -575.0, -4.0, -192.0, 14.0, 10.0, 0.0, -8.0, 0.0, -1.0, 3.0, -10.0, -176.0, 0.0, 0.0, -192.0, 7.0, -9.0, -2.0, -580.0, -5.0, 0.0, -9.0, -199.0, 9.0, 12.0, -7.0, -192.0, -17.0, -177.0, -4.0, 0.0, -196.0, -14.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, 0.0, -394.0, -394.0, -378.0, -367.0, 1.0, 0.0, -400.0, -400.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, -8.0, 0.0, -11.0, 15.0, 0.0, 6.0, 0.0, 0.0, 2.0, 0.0, 2.0, -373.0, -15.0, -15.0, -20.0, 0.0, 0.0, -16.0, 2.0, -16.0, 4.0, 5.0, 15.0, -2.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, -400.0, 0.0, 0.0, 0.0, -10.0, 0.0, 4.0, -10.0, 5.0, -400.0, 6.0, 0.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, -368.0, -384.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, -19.0, -400.0, -20.0, -364.0, 0.0, 0.0, 0.0, 0.0, 1.0, -18.0, 0.0, -18.0, 0.0, -400.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 6.0, 0.0, -382.0, -363.0, -10.0, 15.0, 8.0, 8.0, -379.0, -394.0, -8.0, 0.0, 2.0, -388.0, 2.0, 12.0, 9.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -4.0, -12.0, -6.0, 0.0, -364.0, 0.0, 0.0, 0.0, 0.0, 8.0, -400.0, 6.0, 1.0, -18.0, 0.0, -8.0, 2.0, -380.0, -400.0, 0.0, -18.0, 0.0, 0.0, -13.0, -12.0, -400.0, 0.0, 9.0, 0.0, 12.0, 0.0, 3.0, -20.0, 0.0, -384.0, -20.0, -14.0, 0.0, -365.0, 0.0, -8.0, 0.0, 0.0, -400.0, 4.0, -14.0, -20.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 10.0, 191.0, 10.0, 189.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 197.0, 5.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 200.0, 10.0, 178.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 9.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 10.0, 0.0, 0.0, 198.0, 0.0, 4.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 2.0, 6.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 4.0, 0.0, 200.0, 4.0, 9.0, 0.0, 0.0, 0.0, 16.0, 196.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 192.0, 7.0, 10.0, 188.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 200.0, 17.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9339670472664782, "mean_inference_ms": 2.4478152469344128, "mean_action_processing_ms": 0.4650727559531168, "mean_env_wait_ms": 0.3319589949603578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006909370422363281, "StateBufferConnector_ms": 0.005774736404418945, "ViewRequirementAgentConnector_ms": 0.1406012773513794}, "num_episodes": 18, "episode_return_max": 16.0, "episode_return_min": -600.0, "episode_return_mean": -66.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.0144607527802, "num_env_steps_trained_throughput_per_sec": 321.0144607527802, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1936000, "timers": {"training_iteration_time_ms": 13016.299, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13016.245, "sample_time_ms": 1697.203, "learn_time_ms": 11301.585, "learn_throughput": 353.933, "synch_weights_time_ms": 15.115}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "done": false, "training_iteration": 121, "trial_id": "e1352_00000", "date": "2024-08-13_17-06-30", "timestamp": 1723583190, "time_this_iter_s": 12.52449893951416, "time_total_s": 1706.8148257732391, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15ecca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1706.8148257732391, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 64.34444444444445, "ram_util_percent": 83.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2095082256450223, "cur_kl_coeff": 0.009632556264512006, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 2.0224183659862588e-05, "vf_loss": 1.945702114401671, "vf_explained_var": 0.004440226599022194, "kl": Infinity, "entropy": 2.3322106912861493e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0938430491088345, "cur_kl_coeff": 9.956554331003174e-12, "cur_lr": 0.009999999999999998, "total_loss": 2.317388225610925, "policy_loss": -4.417919529178155e-05, "vf_loss": 2.3174324052043693, "vf_explained_var": -5.361264344876405e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "env_runners": {"episode_reward_max": 16.0, "episode_reward_min": -594.0, "episode_reward_mean": -64.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -56.675, "predator_policy": 24.605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, 9.0, 14.0, -3.0, 0.0, 0.0, -4.0, -198.0, 0.0, -5.0, -1.0, -195.0, 6.0, 2.0, 2.0, 0.0, 10.0, -200.0, 0.0, 0.0, 7.0, 5.0, 10.0, 0.0, -558.0, 5.0, 0.0, 0.0, -12.0, -210.0, -176.0, 0.0, 1.0, -9.0, -9.0, -200.0, 0.0, -3.0, 0.0, 0.0, 4.0, 0.0, -10.0, 0.0, 6.0, -554.0, 15.0, 16.0, -575.0, -4.0, -192.0, 14.0, 10.0, 0.0, -8.0, 0.0, -1.0, 3.0, -10.0, -176.0, 0.0, 0.0, -192.0, 7.0, -9.0, -2.0, -580.0, -5.0, 0.0, -9.0, -199.0, 9.0, 12.0, -7.0, -192.0, -17.0, -177.0, -4.0, 0.0, -196.0, -14.0, 0.0, -158.0, -15.0, -10.0, -169.0, 9.0, 6.0, -178.0, -3.0, 0.0, 0.0, 7.0, -594.0, -200.0, -189.0, -180.0, 0.0, 15.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, -16.0, 4.0, 5.0, 15.0, -2.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, -400.0, 0.0, 0.0, 0.0, -10.0, 0.0, 4.0, -10.0, 5.0, -400.0, 6.0, 0.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 5.0, 0.0, 5.0, 0.0, 0.0, -368.0, -384.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, -19.0, -400.0, -20.0, -364.0, 0.0, 0.0, 0.0, 0.0, 1.0, -18.0, 0.0, -18.0, 0.0, -400.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 6.0, 0.0, -382.0, -363.0, -10.0, 15.0, 8.0, 8.0, -379.0, -394.0, -8.0, 0.0, 2.0, -388.0, 2.0, 12.0, 9.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -4.0, -12.0, -6.0, 0.0, -364.0, 0.0, 0.0, 0.0, 0.0, 8.0, -400.0, 6.0, 1.0, -18.0, 0.0, -8.0, 2.0, -380.0, -400.0, 0.0, -18.0, 0.0, 0.0, -13.0, -12.0, -400.0, 0.0, 9.0, 0.0, 12.0, 0.0, 3.0, -20.0, 0.0, -384.0, -20.0, -14.0, 0.0, -365.0, 0.0, -8.0, 0.0, 0.0, -400.0, 4.0, -14.0, -20.0, 0.0, 0.0, 10.0, -351.0, -20.0, -15.0, 0.0, -20.0, -353.0, 0.0, 7.0, 2.0, 6.0, 0.0, 0.0, -356.0, 7.0, -20.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -396.0, -396.0, -400.0, 0.0, 0.0, -378.0, -370.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [8.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 197.0, 5.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 200.0, 10.0, 178.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 9.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 10.0, 0.0, 0.0, 198.0, 0.0, 4.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 2.0, 6.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 4.0, 0.0, 200.0, 4.0, 9.0, 0.0, 0.0, 0.0, 16.0, 196.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 192.0, 7.0, 10.0, 188.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 200.0, 17.0, 3.0, 0.0, 0.0, 183.0, 0.0, 10.0, 10.0, 10.0, 0.0, 5.0, 179.0, 0.0, 0.0, 0.0, 0.0, 0.0, 178.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 189.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9326368040875433, "mean_inference_ms": 2.4440093164102974, "mean_action_processing_ms": 0.46395554028802194, "mean_env_wait_ms": 0.33144135298284666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006546139717102051, "StateBufferConnector_ms": 0.006097912788391113, "ViewRequirementAgentConnector_ms": 0.16938960552215576}, "num_episodes": 18, "episode_return_max": 16.0, "episode_return_min": -594.0, "episode_return_mean": -64.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.91431682295763, "num_env_steps_trained_throughput_per_sec": 290.91431682295763, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1952000, "timers": {"training_iteration_time_ms": 12984.018, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12983.963, "sample_time_ms": 1556.544, "learn_time_ms": 11410.462, "learn_throughput": 350.555, "synch_weights_time_ms": 14.31}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "done": false, "training_iteration": 122, "trial_id": "e1352_00000", "date": "2024-08-13_17-06-44", "timestamp": 1723583204, "time_this_iter_s": 13.79768681526184, "time_total_s": 1720.612512588501, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15f5a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1720.612512588501, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 69.21052631578948, "ram_util_percent": 83.73157894736843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.310494029029179, "cur_kl_coeff": 0.014448834396768003, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -7.555442468002044e-05, "vf_loss": 1.6659963684737997, "vf_explained_var": 0.002070513194200223, "kl": Infinity, "entropy": 9.022504092288014e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3410006983724307, "cur_kl_coeff": 4.978277165501587e-12, "cur_lr": 0.009999999999999998, "total_loss": 2.42556722734971, "policy_loss": -9.925181671937623e-05, "vf_loss": 2.425666475012189, "vf_explained_var": -8.861854593589824e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -594.0, "episode_reward_mean": -79.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -68.47, "predator_policy": 28.735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -558.0, 5.0, 0.0, 0.0, -12.0, -210.0, -176.0, 0.0, 1.0, -9.0, -9.0, -200.0, 0.0, -3.0, 0.0, 0.0, 4.0, 0.0, -10.0, 0.0, 6.0, -554.0, 15.0, 16.0, -575.0, -4.0, -192.0, 14.0, 10.0, 0.0, -8.0, 0.0, -1.0, 3.0, -10.0, -176.0, 0.0, 0.0, -192.0, 7.0, -9.0, -2.0, -580.0, -5.0, 0.0, -9.0, -199.0, 9.0, 12.0, -7.0, -192.0, -17.0, -177.0, -4.0, 0.0, -196.0, -14.0, 0.0, -158.0, -15.0, -10.0, -169.0, 9.0, 6.0, -178.0, -3.0, 0.0, 0.0, 7.0, -594.0, -200.0, -189.0, -180.0, 0.0, 15.0, 0.0, 4.0, -200.0, 22.0, 5.0, 0.0, 0.0, -194.0, -581.0, -198.0, -16.0, -540.0, 0.0, 6.0, -188.0, -27.0, 9.0, 1.0, 15.0, 1.0, -9.0, -187.0, -5.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -368.0, -384.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, -19.0, -400.0, -20.0, -364.0, 0.0, 0.0, 0.0, 0.0, 1.0, -18.0, 0.0, -18.0, 0.0, -400.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 6.0, 0.0, -382.0, -363.0, -10.0, 15.0, 8.0, 8.0, -379.0, -394.0, -8.0, 0.0, 2.0, -388.0, 2.0, 12.0, 9.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -4.0, -12.0, -6.0, 0.0, -364.0, 0.0, 0.0, 0.0, 0.0, 8.0, -400.0, 6.0, 1.0, -18.0, 0.0, -8.0, 2.0, -380.0, -400.0, 0.0, -18.0, 0.0, 0.0, -13.0, -12.0, -400.0, 0.0, 9.0, 0.0, 12.0, 0.0, 3.0, -20.0, 0.0, -384.0, -20.0, -14.0, 0.0, -365.0, 0.0, -8.0, 0.0, 0.0, -400.0, 4.0, -14.0, -20.0, 0.0, 0.0, 10.0, -351.0, -20.0, -15.0, 0.0, -20.0, -353.0, 0.0, 7.0, 2.0, 6.0, 0.0, 0.0, -356.0, 7.0, -20.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -396.0, -396.0, -400.0, 0.0, 0.0, -378.0, -370.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 4.0, 0.0, -400.0, 0.0, 7.0, 15.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -15.0, -378.0, -398.0, -382.0, 0.0, -396.0, -18.0, -14.0, -366.0, -361.0, 0.0, 0.0, 6.0, 0.0, -388.0, 0.0, -20.0, -20.0, 0.0, 5.0, -10.0, 0.0, 15.0, 0.0, 0.0, -1.0, 0.0, -18.0, 11.0, -400.0, 5.0, -20.0, 0.0, -7.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 200.0, 10.0, 178.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 9.0, 200.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 10.0, 0.0, 0.0, 198.0, 0.0, 4.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 2.0, 6.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 4.0, 0.0, 200.0, 4.0, 9.0, 0.0, 0.0, 0.0, 16.0, 196.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 192.0, 7.0, 10.0, 188.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 200.0, 17.0, 3.0, 0.0, 0.0, 183.0, 0.0, 10.0, 10.0, 10.0, 0.0, 5.0, 179.0, 0.0, 0.0, 0.0, 0.0, 0.0, 178.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 189.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 189.0, 199.0, 0.0, 198.0, 0.0, 7.0, 9.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 190.0, 10.0, 13.0, 0.0, 4.0, 0.0, 9.0, 2.0, 0.0, 0.0, 2.0, 0.0, 9.0, 0.0, 2.0, 200.0, 10.0, 0.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9310593767613394, "mean_inference_ms": 2.4390925155899863, "mean_action_processing_ms": 0.46303936235667764, "mean_env_wait_ms": 0.3308042177493342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010449767112731934, "StateBufferConnector_ms": 0.008141756057739258, "ViewRequirementAgentConnector_ms": 0.1615821123123169}, "num_episodes": 23, "episode_return_max": 22.0, "episode_return_min": -594.0, "episode_return_mean": -79.47, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.9409665586338, "num_env_steps_trained_throughput_per_sec": 315.9409665586338, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 12919.625, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12919.573, "sample_time_ms": 1514.275, "learn_time_ms": 11389.846, "learn_throughput": 351.19, "synch_weights_time_ms": 12.711}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 123, "trial_id": "e1352_00000", "date": "2024-08-13_17-06-56", "timestamp": 1723583216, "time_this_iter_s": 12.715955972671509, "time_total_s": 1733.3284685611725, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15f5820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1733.3284685611725, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 66.6277777777778, "ram_util_percent": 83.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.297603948334498, "cur_kl_coeff": 0.02167325159515201, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00014661953220311455, "vf_loss": 1.054260364663664, "vf_explained_var": 0.0003636158647991362, "kl": Infinity, "entropy": 7.690062023932427e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1797949563564054, "cur_kl_coeff": 2.4891385827507934e-12, "cur_lr": 0.009999999999999998, "total_loss": 1.2385916547090918, "policy_loss": -1.705900935958775e-05, "vf_loss": 1.2386087188171961, "vf_explained_var": -8.830317744502314e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -594.0, "episode_reward_mean": -81.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -70.285, "predator_policy": 29.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -10.0, 0.0, 6.0, -554.0, 15.0, 16.0, -575.0, -4.0, -192.0, 14.0, 10.0, 0.0, -8.0, 0.0, -1.0, 3.0, -10.0, -176.0, 0.0, 0.0, -192.0, 7.0, -9.0, -2.0, -580.0, -5.0, 0.0, -9.0, -199.0, 9.0, 12.0, -7.0, -192.0, -17.0, -177.0, -4.0, 0.0, -196.0, -14.0, 0.0, -158.0, -15.0, -10.0, -169.0, 9.0, 6.0, -178.0, -3.0, 0.0, 0.0, 7.0, -594.0, -200.0, -189.0, -180.0, 0.0, 15.0, 0.0, 4.0, -200.0, 22.0, 5.0, 0.0, 0.0, -194.0, -581.0, -198.0, -16.0, -540.0, 0.0, 6.0, -188.0, -27.0, 9.0, 1.0, 15.0, 1.0, -9.0, -187.0, -5.0, 2.0, -205.0, -18.0, 26.0, 6.0, 0.0, -171.0, -571.0, -18.0, -10.0, 0.0, -5.0, -176.0, -190.0, 0.0, 4.0, 10.0, 0.0, -13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 6.0, 0.0, -382.0, -363.0, -10.0, 15.0, 8.0, 8.0, -379.0, -394.0, -8.0, 0.0, 2.0, -388.0, 2.0, 12.0, 9.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -4.0, -12.0, -6.0, 0.0, -364.0, 0.0, 0.0, 0.0, 0.0, 8.0, -400.0, 6.0, 1.0, -18.0, 0.0, -8.0, 2.0, -380.0, -400.0, 0.0, -18.0, 0.0, 0.0, -13.0, -12.0, -400.0, 0.0, 9.0, 0.0, 12.0, 0.0, 3.0, -20.0, 0.0, -384.0, -20.0, -14.0, 0.0, -365.0, 0.0, -8.0, 0.0, 0.0, -400.0, 4.0, -14.0, -20.0, 0.0, 0.0, 10.0, -351.0, -20.0, -15.0, 0.0, -20.0, -353.0, 0.0, 7.0, 2.0, 6.0, 0.0, 0.0, -356.0, 7.0, -20.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -396.0, -396.0, -400.0, 0.0, 0.0, -378.0, -370.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 4.0, 0.0, -400.0, 0.0, 7.0, 15.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -15.0, -378.0, -398.0, -382.0, 0.0, -396.0, -18.0, -14.0, -366.0, -361.0, 0.0, 0.0, 6.0, 0.0, -388.0, 0.0, -20.0, -20.0, 0.0, 5.0, -10.0, 0.0, 15.0, 0.0, 0.0, -1.0, 0.0, -18.0, 11.0, -400.0, 5.0, -20.0, 0.0, -7.0, -10.0, -400.0, 0.0, -36.0, 15.0, 11.0, 0.0, 6.0, 0.0, 0.0, -362.0, 10.0, -382.0, -380.0, -20.0, -16.0, -20.0, 0.0, 0.0, 0.0, 0.0, -10.0, -364.0, 0.0, -384.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, 0.0, 0.0, 0.0, -14.0, -12.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 10.0, 0.0, 0.0, 198.0, 0.0, 4.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 2.0, 6.0, 0.0, 188.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 4.0, 0.0, 200.0, 4.0, 9.0, 0.0, 0.0, 0.0, 16.0, 196.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 192.0, 7.0, 10.0, 188.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 200.0, 17.0, 3.0, 0.0, 0.0, 183.0, 0.0, 10.0, 10.0, 10.0, 0.0, 5.0, 179.0, 0.0, 0.0, 0.0, 0.0, 0.0, 178.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 189.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 189.0, 199.0, 0.0, 198.0, 0.0, 7.0, 9.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 190.0, 10.0, 13.0, 0.0, 4.0, 0.0, 9.0, 2.0, 0.0, 0.0, 2.0, 0.0, 9.0, 0.0, 2.0, 200.0, 10.0, 0.0, 9.0, 0.0, 5.0, 200.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 191.0, 0.0, 0.0, 18.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 188.0, 0.0, 194.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9294077599293143, "mean_inference_ms": 2.4351652876031746, "mean_action_processing_ms": 0.4615387016908589, "mean_env_wait_ms": 0.3303033155742689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008212924003601074, "StateBufferConnector_ms": 0.007999777793884277, "ViewRequirementAgentConnector_ms": 0.14674651622772217}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -594.0, "episode_return_mean": -81.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.44924110132473, "num_env_steps_trained_throughput_per_sec": 314.44924110132473, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1984000, "timers": {"training_iteration_time_ms": 12925.187, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12925.135, "sample_time_ms": 1522.276, "learn_time_ms": 11387.76, "learn_throughput": 351.254, "synch_weights_time_ms": 12.557}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "done": false, "training_iteration": 124, "trial_id": "e1352_00000", "date": "2024-08-13_17-07-09", "timestamp": 1723583229, "time_this_iter_s": 12.75960397720337, "time_total_s": 1746.0880725383759, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16de820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1746.0880725383759, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 66.99444444444444, "ram_util_percent": 83.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9847307112777517, "cur_kl_coeff": 0.03250987739272802, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 9.986877086616697e-05, "vf_loss": 0.7795458633432943, "vf_explained_var": 0.0009861089565135815, "kl": Infinity, "entropy": 1.7267704219276256e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.167647230863619, "cur_kl_coeff": 1.2445692913753967e-12, "cur_lr": 0.009999999999999998, "total_loss": 1.4085688991994454, "policy_loss": 6.90074179262396e-05, "vf_loss": 1.4084998946025888, "vf_explained_var": -8.0103596682271e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -594.0, "episode_reward_mean": -75.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -64.87, "predator_policy": 26.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, -9.0, -2.0, -580.0, -5.0, 0.0, -9.0, -199.0, 9.0, 12.0, -7.0, -192.0, -17.0, -177.0, -4.0, 0.0, -196.0, -14.0, 0.0, -158.0, -15.0, -10.0, -169.0, 9.0, 6.0, -178.0, -3.0, 0.0, 0.0, 7.0, -594.0, -200.0, -189.0, -180.0, 0.0, 15.0, 0.0, 4.0, -200.0, 22.0, 5.0, 0.0, 0.0, -194.0, -581.0, -198.0, -16.0, -540.0, 0.0, 6.0, -188.0, -27.0, 9.0, 1.0, 15.0, 1.0, -9.0, -187.0, -5.0, 2.0, -205.0, -18.0, 26.0, 6.0, 0.0, -171.0, -571.0, -18.0, -10.0, 0.0, -5.0, -176.0, -190.0, 0.0, 4.0, 10.0, 0.0, -13.0, -7.0, 0.0, 0.0, 10.0, 15.0, -578.0, -17.0, -529.0, -7.0, 0.0, 15.0, 0.0, 10.0, 5.0, -10.0, -17.0, -18.0, -3.0, 0.0, 1.0, 8.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, 1.0, -18.0, 0.0, -8.0, 2.0, -380.0, -400.0, 0.0, -18.0, 0.0, 0.0, -13.0, -12.0, -400.0, 0.0, 9.0, 0.0, 12.0, 0.0, 3.0, -20.0, 0.0, -384.0, -20.0, -14.0, 0.0, -365.0, 0.0, -8.0, 0.0, 0.0, -400.0, 4.0, -14.0, -20.0, 0.0, 0.0, 10.0, -351.0, -20.0, -15.0, 0.0, -20.0, -353.0, 0.0, 7.0, 2.0, 6.0, 0.0, 0.0, -356.0, 7.0, -20.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -396.0, -396.0, -400.0, 0.0, 0.0, -378.0, -370.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 4.0, 0.0, -400.0, 0.0, 7.0, 15.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -15.0, -378.0, -398.0, -382.0, 0.0, -396.0, -18.0, -14.0, -366.0, -361.0, 0.0, 0.0, 6.0, 0.0, -388.0, 0.0, -20.0, -20.0, 0.0, 5.0, -10.0, 0.0, 15.0, 0.0, 0.0, -1.0, 0.0, -18.0, 11.0, -400.0, 5.0, -20.0, 0.0, -7.0, -10.0, -400.0, 0.0, -36.0, 15.0, 11.0, 0.0, 6.0, 0.0, 0.0, -362.0, 10.0, -382.0, -380.0, -20.0, -16.0, -20.0, 0.0, 0.0, 0.0, 0.0, -10.0, -364.0, 0.0, -384.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, 0.0, 0.0, 0.0, -14.0, -12.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -10.0, 0.0, 15.0, -384.0, -388.0, -33.0, -6.0, -353.0, -363.0, -20.0, 3.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, -20.0, 0.0, 0.0, -34.0, -19.0, -14.0, 0.0, -6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 9.0, 0.0, 4.0, 0.0, 200.0, 4.0, 9.0, 0.0, 0.0, 0.0, 16.0, 196.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 192.0, 7.0, 10.0, 188.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 200.0, 17.0, 3.0, 0.0, 0.0, 183.0, 0.0, 10.0, 10.0, 10.0, 0.0, 5.0, 179.0, 0.0, 0.0, 0.0, 0.0, 0.0, 178.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 189.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 189.0, 199.0, 0.0, 198.0, 0.0, 7.0, 9.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 190.0, 10.0, 13.0, 0.0, 4.0, 0.0, 9.0, 2.0, 0.0, 0.0, 2.0, 0.0, 9.0, 0.0, 2.0, 200.0, 10.0, 0.0, 9.0, 0.0, 5.0, 200.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 191.0, 0.0, 0.0, 18.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 188.0, 0.0, 194.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 194.0, 9.0, 13.0, 0.0, 187.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 10.0, 7.0, 0.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9275825033542734, "mean_inference_ms": 2.4300470232586906, "mean_action_processing_ms": 0.4601220942294482, "mean_env_wait_ms": 0.3296630195740725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008308649063110352, "StateBufferConnector_ms": 0.007930994033813477, "ViewRequirementAgentConnector_ms": 0.14846038818359375}, "num_episodes": 22, "episode_return_max": 26.0, "episode_return_min": -594.0, "episode_return_mean": -75.75, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.59234442766285, "num_env_steps_trained_throughput_per_sec": 333.59234442766285, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 12794.729, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12794.678, "sample_time_ms": 1519.929, "learn_time_ms": 11259.777, "learn_throughput": 355.247, "synch_weights_time_ms": 12.499}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 125, "trial_id": "e1352_00000", "date": "2024-08-13_17-07-21", "timestamp": 1723583241, "time_this_iter_s": 12.006574153900146, "time_total_s": 1758.094646692276, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16e0550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1758.094646692276, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 59.652941176470584, "ram_util_percent": 80.98235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.309206479809508, "cur_kl_coeff": 0.048764816089092014, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 3.607012898163506e-05, "vf_loss": 0.738567671164003, "vf_explained_var": 0.005714812102141204, "kl": Infinity, "entropy": 1.1866505312705773e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.263446534514484, "cur_kl_coeff": 6.222846456876984e-13, "cur_lr": 0.009999999999999998, "total_loss": 1.0576034692111154, "policy_loss": 7.621285397184904e-05, "vf_loss": 1.0575272616570588, "vf_explained_var": -6.307369817501653e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -594.0, "episode_reward_mean": -71.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -60.52, "predator_policy": 24.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -158.0, -15.0, -10.0, -169.0, 9.0, 6.0, -178.0, -3.0, 0.0, 0.0, 7.0, -594.0, -200.0, -189.0, -180.0, 0.0, 15.0, 0.0, 4.0, -200.0, 22.0, 5.0, 0.0, 0.0, -194.0, -581.0, -198.0, -16.0, -540.0, 0.0, 6.0, -188.0, -27.0, 9.0, 1.0, 15.0, 1.0, -9.0, -187.0, -5.0, 2.0, -205.0, -18.0, 26.0, 6.0, 0.0, -171.0, -571.0, -18.0, -10.0, 0.0, -5.0, -176.0, -190.0, 0.0, 4.0, 10.0, 0.0, -13.0, -7.0, 0.0, 0.0, 10.0, 15.0, -578.0, -17.0, -529.0, -7.0, 0.0, 15.0, 0.0, 10.0, 5.0, -10.0, -17.0, -18.0, -3.0, 0.0, 1.0, 8.0, 0.0, 0.0, 14.0, 1.0, -7.0, 3.0, 2.0, -588.0, -166.0, 10.0, -42.0, 0.0, 15.0, -174.0, -10.0, 8.0, 15.0, -27.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 10.0, -351.0, -20.0, -15.0, 0.0, -20.0, -353.0, 0.0, 7.0, 2.0, 6.0, 0.0, 0.0, -356.0, 7.0, -20.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, -396.0, -396.0, -400.0, 0.0, 0.0, -378.0, -370.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 4.0, 0.0, -400.0, 0.0, 7.0, 15.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -15.0, -378.0, -398.0, -382.0, 0.0, -396.0, -18.0, -14.0, -366.0, -361.0, 0.0, 0.0, 6.0, 0.0, -388.0, 0.0, -20.0, -20.0, 0.0, 5.0, -10.0, 0.0, 15.0, 0.0, 0.0, -1.0, 0.0, -18.0, 11.0, -400.0, 5.0, -20.0, 0.0, -7.0, -10.0, -400.0, 0.0, -36.0, 15.0, 11.0, 0.0, 6.0, 0.0, 0.0, -362.0, 10.0, -382.0, -380.0, -20.0, -16.0, -20.0, 0.0, 0.0, 0.0, 0.0, -10.0, -364.0, 0.0, -384.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, 0.0, 0.0, 0.0, -14.0, -12.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -10.0, 0.0, 15.0, -384.0, -388.0, -33.0, -6.0, -353.0, -363.0, -20.0, 3.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, -20.0, 0.0, 0.0, -34.0, -19.0, -14.0, 0.0, -6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 1.0, 0.0, 0.0, -14.0, 0.0, 0.0, -4.0, 0.0, -400.0, -388.0, -347.0, 0.0, 0.0, 10.0, -33.0, -33.0, 0.0, -10.0, 15.0, 0.0, -361.0, 0.0, 0.0, -20.0, 8.0, 0.0, 0.0, 15.0, -20.0, -20.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 183.0, 0.0, 10.0, 10.0, 10.0, 0.0, 5.0, 179.0, 0.0, 0.0, 0.0, 0.0, 0.0, 178.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 189.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 189.0, 199.0, 0.0, 198.0, 0.0, 7.0, 9.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 190.0, 10.0, 13.0, 0.0, 4.0, 0.0, 9.0, 2.0, 0.0, 0.0, 2.0, 0.0, 9.0, 0.0, 2.0, 200.0, 10.0, 0.0, 9.0, 0.0, 5.0, 200.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 191.0, 0.0, 0.0, 18.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 188.0, 0.0, 194.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 194.0, 9.0, 13.0, 0.0, 187.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 10.0, 7.0, 0.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 6.0, 0.0, 200.0, 0.0, 181.0, 0.0, 0.0, 0.0, 12.0, 12.0, 10.0, 0.0, 0.0, 0.0, 187.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9260500797822624, "mean_inference_ms": 2.42552775156752, "mean_action_processing_ms": 0.4589324027596556, "mean_env_wait_ms": 0.32907217000686984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008378982543945312, "StateBufferConnector_ms": 0.005856990814208984, "ViewRequirementAgentConnector_ms": 0.15201497077941895}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -594.0, "episode_return_mean": -71.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.9735094192652, "num_env_steps_trained_throughput_per_sec": 362.9735094192652, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 12574.149, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12574.098, "sample_time_ms": 1500.322, "learn_time_ms": 11059.481, "learn_throughput": 361.681, "synch_weights_time_ms": 12.522}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 126, "trial_id": "e1352_00000", "date": "2024-08-13_17-07-32", "timestamp": 1723583252, "time_this_iter_s": 11.023607015609741, "time_total_s": 1769.1182537078857, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15dbc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1769.1182537078857, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 45.79375, "ram_util_percent": 77.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9584228117235754, "cur_kl_coeff": 0.07314722413363803, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00024265646675808563, "vf_loss": 1.3933863789158523, "vf_explained_var": 0.0022934620657925884, "kl": Infinity, "entropy": 5.111908994315974e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1385811191224664, "cur_kl_coeff": 3.111423228438492e-13, "cur_lr": 0.009999999999999998, "total_loss": 1.5306928489100997, "policy_loss": -2.0906206703296413e-05, "vf_loss": 1.530713755696539, "vf_explained_var": -7.82113857370205e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -588.0, "episode_reward_mean": -59.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -50.975, "predator_policy": 21.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 4.0, -200.0, 22.0, 5.0, 0.0, 0.0, -194.0, -581.0, -198.0, -16.0, -540.0, 0.0, 6.0, -188.0, -27.0, 9.0, 1.0, 15.0, 1.0, -9.0, -187.0, -5.0, 2.0, -205.0, -18.0, 26.0, 6.0, 0.0, -171.0, -571.0, -18.0, -10.0, 0.0, -5.0, -176.0, -190.0, 0.0, 4.0, 10.0, 0.0, -13.0, -7.0, 0.0, 0.0, 10.0, 15.0, -578.0, -17.0, -529.0, -7.0, 0.0, 15.0, 0.0, 10.0, 5.0, -10.0, -17.0, -18.0, -3.0, 0.0, 1.0, 8.0, 0.0, 0.0, 14.0, 1.0, -7.0, 3.0, 2.0, -588.0, -166.0, 10.0, -42.0, 0.0, 15.0, -174.0, -10.0, 8.0, 15.0, -27.0, 0.0, 2.0, -157.0, -9.0, 0.0, 5.0, 0.0, 0.0, 1.0, 14.0, 1.0, -6.0, -178.0, 2.0, -191.0, 3.0, 15.0, 0.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 4.0, 0.0, -400.0, 0.0, 7.0, 15.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -15.0, -378.0, -398.0, -382.0, 0.0, -396.0, -18.0, -14.0, -366.0, -361.0, 0.0, 0.0, 6.0, 0.0, -388.0, 0.0, -20.0, -20.0, 0.0, 5.0, -10.0, 0.0, 15.0, 0.0, 0.0, -1.0, 0.0, -18.0, 11.0, -400.0, 5.0, -20.0, 0.0, -7.0, -10.0, -400.0, 0.0, -36.0, 15.0, 11.0, 0.0, 6.0, 0.0, 0.0, -362.0, 10.0, -382.0, -380.0, -20.0, -16.0, -20.0, 0.0, 0.0, 0.0, 0.0, -10.0, -364.0, 0.0, -384.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, 0.0, 0.0, 0.0, -14.0, -12.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -10.0, 0.0, 15.0, -384.0, -388.0, -33.0, -6.0, -353.0, -363.0, -20.0, 3.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, -20.0, 0.0, 0.0, -34.0, -19.0, -14.0, 0.0, -6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 1.0, 0.0, 0.0, -14.0, 0.0, 0.0, -4.0, 0.0, -400.0, -388.0, -347.0, 0.0, 0.0, 10.0, -33.0, -33.0, 0.0, -10.0, 15.0, 0.0, -361.0, 0.0, 0.0, -20.0, 8.0, 0.0, 0.0, 15.0, -20.0, -20.0, 0.0, 0.0, 10.0, -16.0, -357.0, 15.0, 0.0, -18.0, -4.0, -8.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 14.0, 6.0, -10.0, 0.0, -26.0, -366.0, 0.0, 2.0, 0.0, -12.0, -371.0, 10.0, -14.0, 15.0, 0.0, 0.0, 0.0, 1.0, 11.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 189.0, 199.0, 0.0, 198.0, 0.0, 7.0, 9.0, 0.0, 187.0, 0.0, 0.0, 0.0, 0.0, 190.0, 10.0, 13.0, 0.0, 4.0, 0.0, 9.0, 2.0, 0.0, 0.0, 2.0, 0.0, 9.0, 0.0, 2.0, 200.0, 10.0, 0.0, 9.0, 0.0, 5.0, 200.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 191.0, 0.0, 0.0, 18.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 188.0, 0.0, 194.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 194.0, 9.0, 13.0, 0.0, 187.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 10.0, 7.0, 0.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 6.0, 0.0, 200.0, 0.0, 181.0, 0.0, 0.0, 0.0, 12.0, 12.0, 10.0, 0.0, 0.0, 0.0, 187.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 8.0, 185.0, 0.0, 0.0, 9.0, 3.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 10.0, 2.0, 186.0, 0.0, 0.0, 182.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9246486661700873, "mean_inference_ms": 2.4214817391659387, "mean_action_processing_ms": 0.4578456951942029, "mean_env_wait_ms": 0.32856588490307537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00835716724395752, "StateBufferConnector_ms": 0.005923151969909668, "ViewRequirementAgentConnector_ms": 0.14960086345672607}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -588.0, "episode_return_mean": -59.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.27215652525985, "num_env_steps_trained_throughput_per_sec": 355.27215652525985, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 2032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2032000, "timers": {"training_iteration_time_ms": 12379.361, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12379.312, "sample_time_ms": 1528.551, "learn_time_ms": 10835.871, "learn_throughput": 369.144, "synch_weights_time_ms": 13.236}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "done": false, "training_iteration": 127, "trial_id": "e1352_00000", "date": "2024-08-13_17-07-43", "timestamp": 1723583263, "time_this_iter_s": 11.270757913589478, "time_total_s": 1780.3890116214752, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15dbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1780.3890116214752, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 45.21875, "ram_util_percent": 76.33125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3919391631961813, "cur_kl_coeff": 0.10972083620045708, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -1.1548197892292468e-06, "vf_loss": 1.2520952159292484, "vf_explained_var": 0.0068648615526774575, "kl": Infinity, "entropy": 4.886593472809428e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.08910149543758, "cur_kl_coeff": 1.555711614219246e-13, "cur_lr": 0.009999999999999998, "total_loss": 1.7681208493394984, "policy_loss": 0.0001709602694347422, "vf_loss": 1.7679498883309188, "vf_explained_var": -7.947285970052083e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -588.0, "episode_reward_mean": -51.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -44.48, "predator_policy": 18.815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -205.0, -18.0, 26.0, 6.0, 0.0, -171.0, -571.0, -18.0, -10.0, 0.0, -5.0, -176.0, -190.0, 0.0, 4.0, 10.0, 0.0, -13.0, -7.0, 0.0, 0.0, 10.0, 15.0, -578.0, -17.0, -529.0, -7.0, 0.0, 15.0, 0.0, 10.0, 5.0, -10.0, -17.0, -18.0, -3.0, 0.0, 1.0, 8.0, 0.0, 0.0, 14.0, 1.0, -7.0, 3.0, 2.0, -588.0, -166.0, 10.0, -42.0, 0.0, 15.0, -174.0, -10.0, 8.0, 15.0, -27.0, 0.0, 2.0, -157.0, -9.0, 0.0, 5.0, 0.0, 0.0, 1.0, 14.0, 1.0, -6.0, -178.0, 2.0, -191.0, 3.0, 15.0, 0.0, 12.0, 0.0, -185.0, 0.0, 0.0, 21.0, 0.0, -166.0, 0.0, -3.0, 0.0, 0.0, -199.0, 3.0, 0.0, -173.0, 2.0, 21.0, 10.0, -8.0, -578.0, 0.0, 6.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -7.0, -10.0, -400.0, 0.0, -36.0, 15.0, 11.0, 0.0, 6.0, 0.0, 0.0, -362.0, 10.0, -382.0, -380.0, -20.0, -16.0, -20.0, 0.0, 0.0, 0.0, 0.0, -10.0, -364.0, 0.0, -384.0, 0.0, 0.0, 0.0, -2.0, 0.0, 10.0, 0.0, 0.0, 0.0, -14.0, -12.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -10.0, 0.0, 15.0, -384.0, -388.0, -33.0, -6.0, -353.0, -363.0, -20.0, 3.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, -20.0, 0.0, 0.0, -34.0, -19.0, -14.0, 0.0, -6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 1.0, 0.0, 0.0, -14.0, 0.0, 0.0, -4.0, 0.0, -400.0, -388.0, -347.0, 0.0, 0.0, 10.0, -33.0, -33.0, 0.0, -10.0, 15.0, 0.0, -361.0, 0.0, 0.0, -20.0, 8.0, 0.0, 0.0, 15.0, -20.0, -20.0, 0.0, 0.0, 10.0, -16.0, -357.0, 15.0, 0.0, -18.0, -4.0, -8.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 14.0, 6.0, -10.0, 0.0, -26.0, -366.0, 0.0, 2.0, 0.0, -12.0, -371.0, 10.0, -14.0, 15.0, 0.0, 0.0, 0.0, 1.0, 11.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 6.0, 0.0, 0.0, -343.0, -4.0, 0.0, -2.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, -400.0, 1.0, 2.0, 0.0, 0.0, 15.0, -376.0, 0.0, 2.0, 9.0, 12.0, 2.0, 8.0, -20.0, 2.0, -378.0, -400.0, 0.0, 0.0, -8.0, 10.0, 0.0, -11.0], "policy_predator_policy_reward": [9.0, 0.0, 5.0, 200.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 191.0, 0.0, 0.0, 18.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 188.0, 0.0, 194.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 194.0, 9.0, 13.0, 0.0, 187.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 10.0, 7.0, 0.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 6.0, 0.0, 200.0, 0.0, 181.0, 0.0, 0.0, 0.0, 12.0, 12.0, 10.0, 0.0, 0.0, 0.0, 187.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 8.0, 185.0, 0.0, 0.0, 9.0, 3.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 10.0, 2.0, 186.0, 0.0, 0.0, 182.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 179.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9229339051788089, "mean_inference_ms": 2.4167615883772204, "mean_action_processing_ms": 0.45649966219457405, "mean_env_wait_ms": 0.32797495652501574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003960728645324707, "StateBufferConnector_ms": 0.004918575286865234, "ViewRequirementAgentConnector_ms": 0.14467918872833252}, "num_episodes": 23, "episode_return_max": 26.0, "episode_return_min": -588.0, "episode_return_mean": -51.33, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.5198173561133, "num_env_steps_trained_throughput_per_sec": 348.5198173561133, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 2048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 12261.259, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12261.203, "sample_time_ms": 1528.38, "learn_time_ms": 10717.967, "learn_throughput": 373.205, "synch_weights_time_ms": 13.21}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "done": false, "training_iteration": 128, "trial_id": "e1352_00000", "date": "2024-08-13_17-07-55", "timestamp": 1723583275, "time_this_iter_s": 11.480632066726685, "time_total_s": 1791.869643688202, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16dbee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1791.869643688202, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 50.65, "ram_util_percent": 76.98124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0330662112485953, "cur_kl_coeff": 0.16458125430068554, "cur_lr": 0.009999999999999998, "total_loss": 0.35558138712846415, "policy_loss": 5.079790156472612e-05, "vf_loss": 0.35553058895415496, "vf_explained_var": 0.025579178396356168, "kl": -2.9987787136551083e-44, "entropy": 4.202581138129021e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6411576895134417, "cur_kl_coeff": 7.77855807109623e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.7184141454488906, "policy_loss": 5.2607944727968916e-05, "vf_loss": 0.7183615359285521, "vf_explained_var": -5.298190646701389e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -588.0, "episode_reward_mean": -51.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -42.525, "predator_policy": 16.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 15.0, -578.0, -17.0, -529.0, -7.0, 0.0, 15.0, 0.0, 10.0, 5.0, -10.0, -17.0, -18.0, -3.0, 0.0, 1.0, 8.0, 0.0, 0.0, 14.0, 1.0, -7.0, 3.0, 2.0, -588.0, -166.0, 10.0, -42.0, 0.0, 15.0, -174.0, -10.0, 8.0, 15.0, -27.0, 0.0, 2.0, -157.0, -9.0, 0.0, 5.0, 0.0, 0.0, 1.0, 14.0, 1.0, -6.0, -178.0, 2.0, -191.0, 3.0, 15.0, 0.0, 12.0, 0.0, -185.0, 0.0, 0.0, 21.0, 0.0, -166.0, 0.0, -3.0, 0.0, 0.0, -199.0, 3.0, 0.0, -173.0, 2.0, 21.0, 10.0, -8.0, -578.0, 0.0, 6.0, -1.0, 3.0, 3.0, 5.0, -176.0, 13.0, 5.0, -3.0, 10.0, 0.0, -558.0, 0.0, 0.0, -11.0, -23.0, 0.0, 18.0, -6.0, 0.0, -587.0, -3.0, -8.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, -10.0, 0.0, 15.0, -384.0, -388.0, -33.0, -6.0, -353.0, -363.0, -20.0, 3.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 5.0, 0.0, 5.0, -20.0, 0.0, 0.0, -34.0, -19.0, -14.0, 0.0, -6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 1.0, 0.0, 0.0, -14.0, 0.0, 0.0, -4.0, 0.0, -400.0, -388.0, -347.0, 0.0, 0.0, 10.0, -33.0, -33.0, 0.0, -10.0, 15.0, 0.0, -361.0, 0.0, 0.0, -20.0, 8.0, 0.0, 0.0, 15.0, -20.0, -20.0, 0.0, 0.0, 10.0, -16.0, -357.0, 15.0, 0.0, -18.0, -4.0, -8.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 14.0, 6.0, -10.0, 0.0, -26.0, -366.0, 0.0, 2.0, 0.0, -12.0, -371.0, 10.0, -14.0, 15.0, 0.0, 0.0, 0.0, 1.0, 11.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 6.0, 0.0, 0.0, -343.0, -4.0, 0.0, -2.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, -400.0, 1.0, 2.0, 0.0, 0.0, 15.0, -376.0, 0.0, 2.0, 9.0, 12.0, 2.0, 8.0, -20.0, 2.0, -378.0, -400.0, 0.0, 0.0, -8.0, 10.0, 0.0, -11.0, 8.0, -15.0, 3.0, 0.0, 0.0, 5.0, -364.0, 0.0, 13.0, 0.0, 3.0, 0.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, -384.0, -366.0, 0.0, 0.0, 0.0, 0.0, -20.0, -11.0, -14.0, -18.0, 0.0, 0.0, 15.0, 3.0, 0.0, -16.0, 0.0, 0.0, -397.0, -400.0, 2.0, -15.0, 0.0, -28.0, 2.0, 0.0], "policy_predator_policy_reward": [5.0, 0.0, 0.0, 0.0, 0.0, 194.0, 9.0, 13.0, 0.0, 187.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 10.0, 7.0, 0.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 6.0, 0.0, 200.0, 0.0, 181.0, 0.0, 0.0, 0.0, 12.0, 12.0, 10.0, 0.0, 0.0, 0.0, 187.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 8.0, 185.0, 0.0, 0.0, 9.0, 3.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 10.0, 2.0, 186.0, 0.0, 0.0, 182.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 179.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 186.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.920312612642729, "mean_inference_ms": 2.4121572859199194, "mean_action_processing_ms": 0.4552094983301289, "mean_env_wait_ms": 0.3271019743170702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003923773765563965, "StateBufferConnector_ms": 0.004836320877075195, "ViewRequirementAgentConnector_ms": 0.13303875923156738}, "num_episodes": 22, "episode_return_max": 21.0, "episode_return_min": -588.0, "episode_return_mean": -51.13, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.45612624271087, "num_env_steps_trained_throughput_per_sec": 371.45612624271087, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 12075.114, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12075.058, "sample_time_ms": 1491.292, "learn_time_ms": 10568.863, "learn_throughput": 378.47, "synch_weights_time_ms": 13.357}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 129, "trial_id": "e1352_00000", "date": "2024-08-13_17-08-06", "timestamp": 1723583286, "time_this_iter_s": 10.78577995300293, "time_total_s": 1802.6554236412048, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16db550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1802.6554236412048, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 45.13999999999999, "ram_util_percent": 77.75999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2797722210851377, "cur_kl_coeff": 0.08229062715034277, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -0.00010943621367452637, "vf_loss": 0.4934712297796819, "vf_explained_var": 0.014887158675168558, "kl": Infinity, "entropy": 5.383497392969475e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1983128595420913, "cur_kl_coeff": 3.889279035548115e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.5747549320694315, "policy_loss": 0.0002303972177542549, "vf_loss": 0.5745245371861433, "vf_explained_var": 1.0091791708002645e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -588.0, "episode_reward_mean": -41.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -36.7, "predator_policy": 15.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 14.0, 1.0, -7.0, 3.0, 2.0, -588.0, -166.0, 10.0, -42.0, 0.0, 15.0, -174.0, -10.0, 8.0, 15.0, -27.0, 0.0, 2.0, -157.0, -9.0, 0.0, 5.0, 0.0, 0.0, 1.0, 14.0, 1.0, -6.0, -178.0, 2.0, -191.0, 3.0, 15.0, 0.0, 12.0, 0.0, -185.0, 0.0, 0.0, 21.0, 0.0, -166.0, 0.0, -3.0, 0.0, 0.0, -199.0, 3.0, 0.0, -173.0, 2.0, 21.0, 10.0, -8.0, -578.0, 0.0, 6.0, -1.0, 3.0, 3.0, 5.0, -176.0, 13.0, 5.0, -3.0, 10.0, 0.0, -558.0, 0.0, 0.0, -11.0, -23.0, 0.0, 18.0, -6.0, 0.0, -587.0, -3.0, -8.0, 2.0, 0.0, -183.0, 10.0, 0.0, 15.0, 1.0, -11.0, 0.0, 0.0, 0.0, 19.0, -7.0, -3.0, -10.0, -10.0, -2.0, 0.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 1.0, 0.0, 0.0, -14.0, 0.0, 0.0, -4.0, 0.0, -400.0, -388.0, -347.0, 0.0, 0.0, 10.0, -33.0, -33.0, 0.0, -10.0, 15.0, 0.0, -361.0, 0.0, 0.0, -20.0, 8.0, 0.0, 0.0, 15.0, -20.0, -20.0, 0.0, 0.0, 10.0, -16.0, -357.0, 15.0, 0.0, -18.0, -4.0, -8.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 14.0, 6.0, -10.0, 0.0, -26.0, -366.0, 0.0, 2.0, 0.0, -12.0, -371.0, 10.0, -14.0, 15.0, 0.0, 0.0, 0.0, 1.0, 11.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 6.0, 0.0, 0.0, -343.0, -4.0, 0.0, -2.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, -400.0, 1.0, 2.0, 0.0, 0.0, 15.0, -376.0, 0.0, 2.0, 9.0, 12.0, 2.0, 8.0, -20.0, 2.0, -378.0, -400.0, 0.0, 0.0, -8.0, 10.0, 0.0, -11.0, 8.0, -15.0, 3.0, 0.0, 0.0, 5.0, -364.0, 0.0, 13.0, 0.0, 3.0, 0.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, -384.0, -366.0, 0.0, 0.0, 0.0, 0.0, -20.0, -11.0, -14.0, -18.0, 0.0, 0.0, 15.0, 3.0, 0.0, -16.0, 0.0, 0.0, -397.0, -400.0, 2.0, -15.0, 0.0, -28.0, 2.0, 0.0, -2.0, 0.0, 0.0, -382.0, 3.0, 7.0, 0.0, 0.0, 15.0, 0.0, 0.0, 1.0, -2.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, -17.0, 0.0, -6.0, 0.0, -20.0, 0.0, -20.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 10.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 6.0, 0.0, 200.0, 0.0, 181.0, 0.0, 0.0, 0.0, 12.0, 12.0, 10.0, 0.0, 0.0, 0.0, 187.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 8.0, 185.0, 0.0, 0.0, 9.0, 3.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 10.0, 2.0, 186.0, 0.0, 0.0, 182.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 179.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 186.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 2.0, 189.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 10.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9193649041182772, "mean_inference_ms": 2.4070196581112118, "mean_action_processing_ms": 0.45408716076360756, "mean_env_wait_ms": 0.32665289222070554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00380861759185791, "StateBufferConnector_ms": 0.0052602291107177734, "ViewRequirementAgentConnector_ms": 0.1348733901977539}, "num_episodes": 18, "episode_return_max": 21.0, "episode_return_min": -588.0, "episode_return_mean": -41.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.8913696330129, "num_env_steps_trained_throughput_per_sec": 322.8913696330129, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 12049.494, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12049.438, "sample_time_ms": 1447.115, "learn_time_ms": 10586.746, "learn_throughput": 377.831, "synch_weights_time_ms": 13.875}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 130, "trial_id": "e1352_00000", "date": "2024-08-13_17-08-18", "timestamp": 1723583298, "time_this_iter_s": 12.45572304725647, "time_total_s": 1815.1111466884613, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15f5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1815.1111466884613, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 53.42222222222222, "ram_util_percent": 80.98888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1203834817059852, "cur_kl_coeff": 0.12343594072551417, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -0.0003881939117693239, "vf_loss": 0.5870329027380129, "vf_explained_var": 0.005370704206840071, "kl": Infinity, "entropy": 7.14123791967142e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2321090416236236, "cur_kl_coeff": 1.9446395177740574e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.8833226439538141, "policy_loss": 0.00013243195517037912, "vf_loss": 0.8831902139164783, "vf_explained_var": -5.077432703088831e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -587.0, "episode_reward_mean": -33.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.015, "predator_policy": 14.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 2.0, -157.0, -9.0, 0.0, 5.0, 0.0, 0.0, 1.0, 14.0, 1.0, -6.0, -178.0, 2.0, -191.0, 3.0, 15.0, 0.0, 12.0, 0.0, -185.0, 0.0, 0.0, 21.0, 0.0, -166.0, 0.0, -3.0, 0.0, 0.0, -199.0, 3.0, 0.0, -173.0, 2.0, 21.0, 10.0, -8.0, -578.0, 0.0, 6.0, -1.0, 3.0, 3.0, 5.0, -176.0, 13.0, 5.0, -3.0, 10.0, 0.0, -558.0, 0.0, 0.0, -11.0, -23.0, 0.0, 18.0, -6.0, 0.0, -587.0, -3.0, -8.0, 2.0, 0.0, -183.0, 10.0, 0.0, 15.0, 1.0, -11.0, 0.0, 0.0, 0.0, 19.0, -7.0, -3.0, -10.0, -10.0, -2.0, 0.0, 10.0, -8.0, 9.0, -194.0, -4.0, -8.0, 0.0, 1.0, 0.0, 5.0, 5.0, 11.0, 6.0, 15.0, 0.0, -10.0, 0.0, 8.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 10.0, -16.0, -357.0, 15.0, 0.0, -18.0, -4.0, -8.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 14.0, 6.0, -10.0, 0.0, -26.0, -366.0, 0.0, 2.0, 0.0, -12.0, -371.0, 10.0, -14.0, 15.0, 0.0, 0.0, 0.0, 1.0, 11.0, 0.0, 0.0, -370.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 6.0, 0.0, 0.0, -343.0, -4.0, 0.0, -2.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, -400.0, 1.0, 2.0, 0.0, 0.0, 15.0, -376.0, 0.0, 2.0, 9.0, 12.0, 2.0, 8.0, -20.0, 2.0, -378.0, -400.0, 0.0, 0.0, -8.0, 10.0, 0.0, -11.0, 8.0, -15.0, 3.0, 0.0, 0.0, 5.0, -364.0, 0.0, 13.0, 0.0, 3.0, 0.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, -384.0, -366.0, 0.0, 0.0, 0.0, 0.0, -20.0, -11.0, -14.0, -18.0, 0.0, 0.0, 15.0, 3.0, 0.0, -16.0, 0.0, 0.0, -397.0, -400.0, 2.0, -15.0, 0.0, -28.0, 2.0, 0.0, -2.0, 0.0, 0.0, -382.0, 3.0, 7.0, 0.0, 0.0, 15.0, 0.0, 0.0, 1.0, -2.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, -17.0, 0.0, -6.0, 0.0, -20.0, 0.0, -20.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 10.0, 2.0, -20.0, 11.0, -4.0, 0.0, -388.0, -8.0, 0.0, 0.0, -25.0, 0.0, 0.0, -20.0, 11.0, 0.0, 0.0, -12.0, 11.0, 0.0, 5.0, 11.0, 0.0, 0.0, -4.0, 0.0, 15.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -11.0, 9.0, -19.0, 6.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 8.0, 185.0, 0.0, 0.0, 9.0, 3.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 10.0, 2.0, 186.0, 0.0, 0.0, 182.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 179.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 186.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 2.0, 189.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 10.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 194.0, 0.0, 0.0, 4.0, 10.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.917746209669468, "mean_inference_ms": 2.40318613680406, "mean_action_processing_ms": 0.45300791657382705, "mean_env_wait_ms": 0.32605155700689503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003759145736694336, "StateBufferConnector_ms": 0.005220890045166016, "ViewRequirementAgentConnector_ms": 0.1319136619567871}, "num_episodes": 18, "episode_return_max": 21.0, "episode_return_min": -587.0, "episode_return_mean": -33.9, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.3595092753533, "num_env_steps_trained_throughput_per_sec": 318.3595092753533, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 2096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2096000, "timers": {"training_iteration_time_ms": 12059.885, "restore_workers_time_ms": 0.021, "training_step_time_ms": 12059.829, "sample_time_ms": 1464.753, "learn_time_ms": 10578.801, "learn_throughput": 378.115, "synch_weights_time_ms": 14.322}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "done": false, "training_iteration": 131, "trial_id": "e1352_00000", "date": "2024-08-13_17-08-31", "timestamp": 1723583311, "time_this_iter_s": 12.610483884811401, "time_total_s": 1827.7216305732727, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16dbee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1827.7216305732727, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 50.63888888888889, "ram_util_percent": 83.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1977455302166247, "cur_kl_coeff": 0.18515391108827123, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00036011149899827107, "vf_loss": 1.458364652168183, "vf_explained_var": 0.0017506677322286777, "kl": Infinity, "entropy": 3.881019767097766e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4887264364595967, "cur_kl_coeff": 9.723197588870287e-15, "cur_lr": 0.009999999999999998, "total_loss": 1.5999014500272337, "policy_loss": 9.740808924472836e-05, "vf_loss": 1.599804042003773, "vf_explained_var": -9.429517877164972e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -587.0, "episode_reward_mean": -37.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -34.97, "predator_policy": 16.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 0.0, -166.0, 0.0, -3.0, 0.0, 0.0, -199.0, 3.0, 0.0, -173.0, 2.0, 21.0, 10.0, -8.0, -578.0, 0.0, 6.0, -1.0, 3.0, 3.0, 5.0, -176.0, 13.0, 5.0, -3.0, 10.0, 0.0, -558.0, 0.0, 0.0, -11.0, -23.0, 0.0, 18.0, -6.0, 0.0, -587.0, -3.0, -8.0, 2.0, 0.0, -183.0, 10.0, 0.0, 15.0, 1.0, -11.0, 0.0, 0.0, 0.0, 19.0, -7.0, -3.0, -10.0, -10.0, -2.0, 0.0, 10.0, -8.0, 9.0, -194.0, -4.0, -8.0, 0.0, 1.0, 0.0, 5.0, 5.0, 11.0, 6.0, 15.0, 0.0, -10.0, 0.0, 8.0, -3.0, 9.0, 8.0, -185.0, 9.0, 5.0, -181.0, 0.0, -200.0, -6.0, 0.0, -10.0, -536.0, 15.0, 5.0, 7.0, 0.0, 8.0, 0.0, 0.0, 13.0, 3.0, 0.0, -15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 6.0, 0.0, 0.0, -343.0, -4.0, 0.0, -2.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, -400.0, 1.0, 2.0, 0.0, 0.0, 15.0, -376.0, 0.0, 2.0, 9.0, 12.0, 2.0, 8.0, -20.0, 2.0, -378.0, -400.0, 0.0, 0.0, -8.0, 10.0, 0.0, -11.0, 8.0, -15.0, 3.0, 0.0, 0.0, 5.0, -364.0, 0.0, 13.0, 0.0, 3.0, 0.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, -384.0, -366.0, 0.0, 0.0, 0.0, 0.0, -20.0, -11.0, -14.0, -18.0, 0.0, 0.0, 15.0, 3.0, 0.0, -16.0, 0.0, 0.0, -397.0, -400.0, 2.0, -15.0, 0.0, -28.0, 2.0, 0.0, -2.0, 0.0, 0.0, -382.0, 3.0, 7.0, 0.0, 0.0, 15.0, 0.0, 0.0, 1.0, -2.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, -17.0, 0.0, -6.0, 0.0, -20.0, 0.0, -20.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 10.0, 2.0, -20.0, 11.0, -4.0, 0.0, -388.0, -8.0, 0.0, 0.0, -25.0, 0.0, 0.0, -20.0, 11.0, 0.0, 0.0, -12.0, 11.0, 0.0, 5.0, 11.0, 0.0, 0.0, -4.0, 0.0, 15.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -11.0, 9.0, -19.0, 6.0, 6.0, -5.0, 4.0, 0.0, -388.0, 8.0, 0.0, 9.0, 15.0, -20.0, -362.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -19.0, 0.0, 0.0, -20.0, 0.0, -379.0, -350.0, 0.0, 15.0, 15.0, -20.0, 7.0, 0.0, 0.0, 0.0, -10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 15.0, -376.0, 3.0, 0.0, 0.0, 0.0, -8.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 2.0, 179.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 182.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 186.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 2.0, 189.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 10.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 194.0, 0.0, 0.0, 4.0, 10.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 195.0, 0.0, 0.0, 10.0, 0.0, 0.0, 181.0, 0.0, 0.0, 0.0, 200.0, 3.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 186.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9155598497045386, "mean_inference_ms": 2.3982717639018616, "mean_action_processing_ms": 0.4518320189705621, "mean_env_wait_ms": 0.32519962782589285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046024322509765625, "StateBufferConnector_ms": 0.004666686058044434, "ViewRequirementAgentConnector_ms": 0.13190829753875732}, "num_episodes": 23, "episode_return_max": 21.0, "episode_return_min": -587.0, "episode_return_mean": -37.7, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.8442305451847, "num_env_steps_trained_throughput_per_sec": 316.8442305451847, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 11947.36, "restore_workers_time_ms": 0.021, "training_step_time_ms": 11947.304, "sample_time_ms": 1459.582, "learn_time_ms": 10471.737, "learn_throughput": 381.981, "synch_weights_time_ms": 14.132}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 132, "trial_id": "e1352_00000", "date": "2024-08-13_17-08-44", "timestamp": 1723583324, "time_this_iter_s": 12.675310134887695, "time_total_s": 1840.3969407081604, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17103a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1840.3969407081604, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 49.93888888888889, "ram_util_percent": 83.54444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1784746405860735, "cur_kl_coeff": 0.2777308666324069, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00014370780970369068, "vf_loss": 0.2974990273655821, "vf_explained_var": 0.0023201960735220128, "kl": Infinity, "entropy": 5.643558443541447e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3031111713720573, "cur_kl_coeff": 4.8615987944351434e-15, "cur_lr": 0.009999999999999998, "total_loss": 0.4724100535306784, "policy_loss": -0.00018597578644634238, "vf_loss": 0.4725960276528245, "vf_explained_var": 0.0009702788774298613, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -588.0, "episode_reward_mean": -32.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -29.98, "predator_policy": 13.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 3.0, 3.0, 5.0, -176.0, 13.0, 5.0, -3.0, 10.0, 0.0, -558.0, 0.0, 0.0, -11.0, -23.0, 0.0, 18.0, -6.0, 0.0, -587.0, -3.0, -8.0, 2.0, 0.0, -183.0, 10.0, 0.0, 15.0, 1.0, -11.0, 0.0, 0.0, 0.0, 19.0, -7.0, -3.0, -10.0, -10.0, -2.0, 0.0, 10.0, -8.0, 9.0, -194.0, -4.0, -8.0, 0.0, 1.0, 0.0, 5.0, 5.0, 11.0, 6.0, 15.0, 0.0, -10.0, 0.0, 8.0, -3.0, 9.0, 8.0, -185.0, 9.0, 5.0, -181.0, 0.0, -200.0, -6.0, 0.0, -10.0, -536.0, 15.0, 5.0, 7.0, 0.0, 8.0, 0.0, 0.0, 13.0, 3.0, 0.0, -15.0, -21.0, 4.0, -588.0, -16.0, 22.0, -13.0, 9.0, 3.0, 6.0, 0.0, 0.0, 5.0, 0.0, 1.0, 15.0, 0.0, -1.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -11.0, 8.0, -15.0, 3.0, 0.0, 0.0, 5.0, -364.0, 0.0, 13.0, 0.0, 3.0, 0.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, -384.0, -366.0, 0.0, 0.0, 0.0, 0.0, -20.0, -11.0, -14.0, -18.0, 0.0, 0.0, 15.0, 3.0, 0.0, -16.0, 0.0, 0.0, -397.0, -400.0, 2.0, -15.0, 0.0, -28.0, 2.0, 0.0, -2.0, 0.0, 0.0, -382.0, 3.0, 7.0, 0.0, 0.0, 15.0, 0.0, 0.0, 1.0, -2.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, -17.0, 0.0, -6.0, 0.0, -20.0, 0.0, -20.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 10.0, 2.0, -20.0, 11.0, -4.0, 0.0, -388.0, -8.0, 0.0, 0.0, -25.0, 0.0, 0.0, -20.0, 11.0, 0.0, 0.0, -12.0, 11.0, 0.0, 5.0, 11.0, 0.0, 0.0, -4.0, 0.0, 15.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -11.0, 9.0, -19.0, 6.0, 6.0, -5.0, 4.0, 0.0, -388.0, 8.0, 0.0, 9.0, 15.0, -20.0, -362.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -19.0, 0.0, 0.0, -20.0, 0.0, -379.0, -350.0, 0.0, 15.0, 15.0, -20.0, 7.0, 0.0, 0.0, 0.0, -10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 15.0, -376.0, 3.0, 0.0, 0.0, 0.0, -8.0, -20.0, -22.0, -18.0, 4.0, 0.0, -397.0, -400.0, -16.0, -20.0, 4.0, 14.0, -20.0, -11.0, 9.0, 0.0, 1.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0], "policy_predator_policy_reward": [10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 186.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 2.0, 189.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 10.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 194.0, 0.0, 0.0, 4.0, 10.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 195.0, 0.0, 0.0, 10.0, 0.0, 0.0, 181.0, 0.0, 0.0, 0.0, 200.0, 3.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 186.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 9.0, 10.0, 0.0, 0.0, 199.0, 10.0, 10.0, 10.0, 0.0, 4.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9133474595066181, "mean_inference_ms": 2.3942503819393157, "mean_action_processing_ms": 0.45011185291234695, "mean_env_wait_ms": 0.32438675276114715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045833587646484375, "StateBufferConnector_ms": 0.0038764476776123047, "ViewRequirementAgentConnector_ms": 0.11676192283630371}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -588.0, "episode_return_mean": -32.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.8656716868935, "num_env_steps_trained_throughput_per_sec": 316.8656716868935, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 2128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2128000, "timers": {"training_iteration_time_ms": 11943.665, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11943.608, "sample_time_ms": 1462.471, "learn_time_ms": 10464.039, "learn_throughput": 382.262, "synch_weights_time_ms": 14.835}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "done": false, "training_iteration": 133, "trial_id": "e1352_00000", "date": "2024-08-13_17-08-56", "timestamp": 1723583336, "time_this_iter_s": 12.660131931304932, "time_total_s": 1853.0570726394653, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1710e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1853.0570726394653, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 50.252941176470586, "ram_util_percent": 83.48235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3541030733230173, "cur_kl_coeff": 0.4165962999486102, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00015325094671752402, "vf_loss": 1.2584882001239788, "vf_explained_var": 0.001233527143165548, "kl": Infinity, "entropy": 7.620587128926721e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0546202544271996, "cur_kl_coeff": 2.4307993972175717e-15, "cur_lr": 0.009999999999999998, "total_loss": 1.289395266751606, "policy_loss": -0.0002207197039511311, "vf_loss": 1.2896159838352885, "vf_explained_var": -7.442696384651951e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -588.0, "episode_reward_mean": -27.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -28.195, "predator_policy": 14.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, -183.0, 10.0, 0.0, 15.0, 1.0, -11.0, 0.0, 0.0, 0.0, 19.0, -7.0, -3.0, -10.0, -10.0, -2.0, 0.0, 10.0, -8.0, 9.0, -194.0, -4.0, -8.0, 0.0, 1.0, 0.0, 5.0, 5.0, 11.0, 6.0, 15.0, 0.0, -10.0, 0.0, 8.0, -3.0, 9.0, 8.0, -185.0, 9.0, 5.0, -181.0, 0.0, -200.0, -6.0, 0.0, -10.0, -536.0, 15.0, 5.0, 7.0, 0.0, 8.0, 0.0, 0.0, 13.0, 3.0, 0.0, -15.0, -21.0, 4.0, -588.0, -16.0, 22.0, -13.0, 9.0, 3.0, 6.0, 0.0, 0.0, 5.0, 0.0, 1.0, 15.0, 0.0, -1.0, 0.0, -10.0, -182.0, -10.0, 15.0, -189.0, -4.0, -10.0, -6.0, 0.0, 0.0, -193.0, 2.0, -8.0, 0.0, -1.0, 0.0, 14.0, 4.0, 8.0, 0.0, -200.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, 0.0, -2.0, 0.0, 0.0, -382.0, 3.0, 7.0, 0.0, 0.0, 15.0, 0.0, 0.0, 1.0, -2.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, -17.0, 0.0, -6.0, 0.0, -20.0, 0.0, -20.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 10.0, 2.0, -20.0, 11.0, -4.0, 0.0, -388.0, -8.0, 0.0, 0.0, -25.0, 0.0, 0.0, -20.0, 11.0, 0.0, 0.0, -12.0, 11.0, 0.0, 5.0, 11.0, 0.0, 0.0, -4.0, 0.0, 15.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -11.0, 9.0, -19.0, 6.0, 6.0, -5.0, 4.0, 0.0, -388.0, 8.0, 0.0, 9.0, 15.0, -20.0, -362.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -19.0, 0.0, 0.0, -20.0, 0.0, -379.0, -350.0, 0.0, 15.0, 15.0, -20.0, 7.0, 0.0, 0.0, 0.0, -10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 15.0, -376.0, 3.0, 0.0, 0.0, 0.0, -8.0, -20.0, -22.0, -18.0, 4.0, 0.0, -397.0, -400.0, -16.0, -20.0, 4.0, 14.0, -20.0, -11.0, 9.0, 0.0, 1.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -20.0, 0.0, 0.0, -364.0, -20.0, 0.0, 0.0, 15.0, 0.0, -383.0, -8.0, 0.0, -20.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, 0.0, 0.0, -8.0, 0.0, -16.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, 15.0, -2.0, -16.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, -400.0, 0.0, -10.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 2.0, 189.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 10.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 194.0, 0.0, 0.0, 4.0, 10.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 195.0, 0.0, 0.0, 10.0, 0.0, 0.0, 181.0, 0.0, 0.0, 0.0, 200.0, 3.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 186.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 9.0, 10.0, 0.0, 0.0, 199.0, 10.0, 10.0, 10.0, 0.0, 4.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 180.0, 10.0, 0.0, 0.0, 0.0, 184.0, 10.0, 4.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 10.0, 0.0, 8.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9109568834725391, "mean_inference_ms": 2.3901180531492803, "mean_action_processing_ms": 0.4484749302660041, "mean_env_wait_ms": 0.3234762756637127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004811644554138184, "StateBufferConnector_ms": 0.004221439361572266, "ViewRequirementAgentConnector_ms": 0.11925768852233887}, "num_episodes": 22, "episode_return_max": 22.0, "episode_return_min": -588.0, "episode_return_mean": -27.36, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.85002888195214, "num_env_steps_trained_throughput_per_sec": 316.85002888195214, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 2144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2144000, "timers": {"training_iteration_time_ms": 11934.026, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11933.969, "sample_time_ms": 1449.772, "learn_time_ms": 10466.377, "learn_throughput": 382.176, "synch_weights_time_ms": 15.419}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "done": false, "training_iteration": 134, "trial_id": "e1352_00000", "date": "2024-08-13_17-09-09", "timestamp": 1723583349, "time_this_iter_s": 12.648081302642822, "time_total_s": 1865.7051539421082, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b170a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1865.7051539421082, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 49.22222222222222, "ram_util_percent": 83.53333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1217715492881046, "cur_kl_coeff": 0.6248944499229157, "cur_lr": 0.009999999999999998, "total_loss": 0.947711040055941, "policy_loss": -6.425425511287161e-05, "vf_loss": 0.9477752933032298, "vf_explained_var": 0.000427556384808172, "kl": 8.039301189774599e-45, "entropy": 6.88516397101572e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0063805209837033, "cur_kl_coeff": 1.2153996986087859e-15, "cur_lr": 0.009999999999999998, "total_loss": 0.9657689211742272, "policy_loss": -1.4076421712401999e-05, "vf_loss": 0.9657829978478649, "vf_explained_var": -7.2850121392144095e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -588.0, "episode_reward_mean": -32.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -33.335, "predator_policy": 17.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -8.0, 9.0, -194.0, -4.0, -8.0, 0.0, 1.0, 0.0, 5.0, 5.0, 11.0, 6.0, 15.0, 0.0, -10.0, 0.0, 8.0, -3.0, 9.0, 8.0, -185.0, 9.0, 5.0, -181.0, 0.0, -200.0, -6.0, 0.0, -10.0, -536.0, 15.0, 5.0, 7.0, 0.0, 8.0, 0.0, 0.0, 13.0, 3.0, 0.0, -15.0, -21.0, 4.0, -588.0, -16.0, 22.0, -13.0, 9.0, 3.0, 6.0, 0.0, 0.0, 5.0, 0.0, 1.0, 15.0, 0.0, -1.0, 0.0, -10.0, -182.0, -10.0, 15.0, -189.0, -4.0, -10.0, -6.0, 0.0, 0.0, -193.0, 2.0, -8.0, 0.0, -1.0, 0.0, 14.0, 4.0, 8.0, 0.0, -200.0, -5.0, -9.0, 12.0, 0.0, 5.0, 5.0, 0.0, -168.0, -168.0, -1.0, 0.0, -5.0, 0.0, 2.0, -169.0, -176.0, 7.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 10.0, 2.0, -20.0, 11.0, -4.0, 0.0, -388.0, -8.0, 0.0, 0.0, -25.0, 0.0, 0.0, -20.0, 11.0, 0.0, 0.0, -12.0, 11.0, 0.0, 5.0, 11.0, 0.0, 0.0, -4.0, 0.0, 15.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -11.0, 9.0, -19.0, 6.0, 6.0, -5.0, 4.0, 0.0, -388.0, 8.0, 0.0, 9.0, 15.0, -20.0, -362.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -19.0, 0.0, 0.0, -20.0, 0.0, -379.0, -350.0, 0.0, 15.0, 15.0, -20.0, 7.0, 0.0, 0.0, 0.0, -10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 15.0, -376.0, 3.0, 0.0, 0.0, 0.0, -8.0, -20.0, -22.0, -18.0, 4.0, 0.0, -397.0, -400.0, -16.0, -20.0, 4.0, 14.0, -20.0, -11.0, 9.0, 0.0, 1.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -20.0, 0.0, 0.0, -364.0, -20.0, 0.0, 0.0, 15.0, 0.0, -383.0, -8.0, 0.0, -20.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, 0.0, 0.0, -8.0, 0.0, -16.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, 15.0, -2.0, -16.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, -400.0, 0.0, -10.0, 0.0, -18.0, 15.0, -13.0, 0.0, 0.0, 5.0, 0.0, -20.0, 15.0, 0.0, 0.0, 13.0, -362.0, 0.0, -355.0, 0.0, -2.0, 0.0, 0.0, 3.0, -16.0, 0.0, 0.0, 8.0, -12.0, 0.0, -358.0, 0.0, -364.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 194.0, 0.0, 0.0, 4.0, 10.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 195.0, 0.0, 0.0, 10.0, 0.0, 0.0, 181.0, 0.0, 0.0, 0.0, 200.0, 3.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 186.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 9.0, 10.0, 0.0, 0.0, 199.0, 10.0, 10.0, 10.0, 0.0, 4.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 180.0, 10.0, 0.0, 0.0, 0.0, 184.0, 10.0, 4.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 10.0, 0.0, 8.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 5.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 181.0, 177.0, 10.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 179.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9091697040342116, "mean_inference_ms": 2.387590215860794, "mean_action_processing_ms": 0.44720613574709484, "mean_env_wait_ms": 0.32280387262290233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004850506782531738, "StateBufferConnector_ms": 0.0037723779678344727, "ViewRequirementAgentConnector_ms": 0.12014460563659668}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -588.0, "episode_return_mean": -32.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.41148898635356, "num_env_steps_trained_throughput_per_sec": 313.41148898635356, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 12011.235, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12011.179, "sample_time_ms": 1462.991, "learn_time_ms": 10530.658, "learn_throughput": 379.843, "synch_weights_time_ms": 15.162}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 135, "trial_id": "e1352_00000", "date": "2024-08-13_17-09-22", "timestamp": 1723583362, "time_this_iter_s": 12.814394235610962, "time_total_s": 1878.5195481777191, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16dbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1878.5195481777191, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 46.94736842105264, "ram_util_percent": 83.26842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1277489962056277, "cur_kl_coeff": 0.3124472249614578, "cur_lr": 0.009999999999999998, "total_loss": 0.7545485438493194, "policy_loss": 0.00016873725049355357, "vf_loss": 0.7543798056386766, "vf_explained_var": 5.700499923140914e-05, "kl": 2.2555085067722173e-42, "entropy": 3.5663159355513705e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4844213516211813, "cur_kl_coeff": 6.076998493043929e-16, "cur_lr": 0.009999999999999998, "total_loss": 0.861096825716751, "policy_loss": -1.4188926095369632e-05, "vf_loss": 0.861111013607058, "vf_explained_var": -7.631917479177e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -588.0, "episode_reward_mean": -34.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.45, "predator_policy": 18.205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, 9.0, 8.0, -185.0, 9.0, 5.0, -181.0, 0.0, -200.0, -6.0, 0.0, -10.0, -536.0, 15.0, 5.0, 7.0, 0.0, 8.0, 0.0, 0.0, 13.0, 3.0, 0.0, -15.0, -21.0, 4.0, -588.0, -16.0, 22.0, -13.0, 9.0, 3.0, 6.0, 0.0, 0.0, 5.0, 0.0, 1.0, 15.0, 0.0, -1.0, 0.0, -10.0, -182.0, -10.0, 15.0, -189.0, -4.0, -10.0, -6.0, 0.0, 0.0, -193.0, 2.0, -8.0, 0.0, -1.0, 0.0, 14.0, 4.0, 8.0, 0.0, -200.0, -5.0, -9.0, 12.0, 0.0, 5.0, 5.0, 0.0, -168.0, -168.0, -1.0, 0.0, -5.0, 0.0, 2.0, -169.0, -176.0, 7.0, 0.0, 0.0, -2.0, 15.0, 13.0, -18.0, 0.0, -196.0, 0.0, 0.0, 0.0, 0.0, 16.0, 15.0, -6.0, 2.0, 2.0, -200.0, -3.0, -19.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.0, 6.0, 6.0, -5.0, 4.0, 0.0, -388.0, 8.0, 0.0, 9.0, 15.0, -20.0, -362.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -19.0, 0.0, 0.0, -20.0, 0.0, -379.0, -350.0, 0.0, 15.0, 15.0, -20.0, 7.0, 0.0, 0.0, 0.0, -10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 15.0, -376.0, 3.0, 0.0, 0.0, 0.0, -8.0, -20.0, -22.0, -18.0, 4.0, 0.0, -397.0, -400.0, -16.0, -20.0, 4.0, 14.0, -20.0, -11.0, 9.0, 0.0, 1.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -20.0, 0.0, 0.0, -364.0, -20.0, 0.0, 0.0, 15.0, 0.0, -383.0, -8.0, 0.0, -20.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, 0.0, 0.0, -8.0, 0.0, -16.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, 15.0, -2.0, -16.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, -400.0, 0.0, -10.0, 0.0, -18.0, 15.0, -13.0, 0.0, 0.0, 5.0, 0.0, -20.0, 15.0, 0.0, 0.0, 13.0, -362.0, 0.0, -355.0, 0.0, -2.0, 0.0, 0.0, 3.0, -16.0, 0.0, 0.0, 8.0, -12.0, 0.0, -358.0, 0.0, -364.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 15.0, 0.0, 13.0, -15.0, -14.0, 0.0, 0.0, 0.0, -394.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 1.0, 0.0, 15.0, 0.0, -22.0, 0.0, 2.0, 0.0, 2.0, -400.0, 0.0, -12.0, 3.0, -26.0, -29.0], "policy_predator_policy_reward": [10.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 195.0, 0.0, 0.0, 10.0, 0.0, 0.0, 181.0, 0.0, 0.0, 0.0, 200.0, 3.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 186.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 9.0, 10.0, 0.0, 0.0, 199.0, 10.0, 10.0, 10.0, 0.0, 4.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 180.0, 10.0, 0.0, 0.0, 0.0, 184.0, 10.0, 4.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 10.0, 0.0, 8.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 5.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 181.0, 177.0, 10.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 179.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 6.0, 0.0, 18.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9073149488319601, "mean_inference_ms": 2.3849668467403955, "mean_action_processing_ms": 0.4459168960005212, "mean_env_wait_ms": 0.32212003755467344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005099654197692871, "StateBufferConnector_ms": 0.0037353038787841797, "ViewRequirementAgentConnector_ms": 0.120452880859375}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -588.0, "episode_return_mean": -34.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.9731273186605, "num_env_steps_trained_throughput_per_sec": 323.9731273186605, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 2176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2176000, "timers": {"training_iteration_time_ms": 12143.897, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12143.839, "sample_time_ms": 1480.606, "learn_time_ms": 10645.718, "learn_throughput": 375.738, "synch_weights_time_ms": 15.064}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "done": false, "training_iteration": 136, "trial_id": "e1352_00000", "date": "2024-08-13_17-09-34", "timestamp": 1723583374, "time_this_iter_s": 12.412409782409668, "time_total_s": 1890.9319579601288, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1713670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1890.9319579601288, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 47.35294117647059, "ram_util_percent": 83.11764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5326790315296166, "cur_kl_coeff": 0.1562236124807289, "cur_lr": 0.009999999999999998, "total_loss": 0.8590258331683578, "policy_loss": -0.00010378393406176536, "vf_loss": 0.8591296175169566, "vf_explained_var": 0.0004501860923868008, "kl": 2.204820798034881e-43, "entropy": 1.2105785551908462e-41, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.377790650750003, "cur_kl_coeff": 3.0384992465219646e-16, "cur_lr": 0.009999999999999998, "total_loss": 1.038249714842076, "policy_loss": -8.70162562008888e-05, "vf_loss": 1.0383367324001576, "vf_explained_var": -7.694991177352017e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -588.0, "episode_reward_mean": -30.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -30.735, "predator_policy": 15.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, -21.0, 4.0, -588.0, -16.0, 22.0, -13.0, 9.0, 3.0, 6.0, 0.0, 0.0, 5.0, 0.0, 1.0, 15.0, 0.0, -1.0, 0.0, -10.0, -182.0, -10.0, 15.0, -189.0, -4.0, -10.0, -6.0, 0.0, 0.0, -193.0, 2.0, -8.0, 0.0, -1.0, 0.0, 14.0, 4.0, 8.0, 0.0, -200.0, -5.0, -9.0, 12.0, 0.0, 5.0, 5.0, 0.0, -168.0, -168.0, -1.0, 0.0, -5.0, 0.0, 2.0, -169.0, -176.0, 7.0, 0.0, 0.0, -2.0, 15.0, 13.0, -18.0, 0.0, -196.0, 0.0, 0.0, 0.0, 0.0, 16.0, 15.0, -6.0, 2.0, 2.0, -200.0, -3.0, -19.0, 0.0, 4.0, -10.0, 0.0, 14.0, -6.0, -200.0, -190.0, 0.0, -3.0, 4.0, 14.0, -21.0, -9.0, -3.0, 8.0, 14.0, -6.0, -200.0, -6.0, -8.0, -15.0, 22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, -20.0, -22.0, -18.0, 4.0, 0.0, -397.0, -400.0, -16.0, -20.0, 4.0, 14.0, -20.0, -11.0, 9.0, 0.0, 1.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -20.0, 0.0, 0.0, -364.0, -20.0, 0.0, 0.0, 15.0, 0.0, -383.0, -8.0, 0.0, -20.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, 0.0, 0.0, -8.0, 0.0, -16.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, 15.0, -2.0, -16.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, -400.0, 0.0, -10.0, 0.0, -18.0, 15.0, -13.0, 0.0, 0.0, 5.0, 0.0, -20.0, 15.0, 0.0, 0.0, 13.0, -362.0, 0.0, -355.0, 0.0, -2.0, 0.0, 0.0, 3.0, -16.0, 0.0, 0.0, 8.0, -12.0, 0.0, -358.0, 0.0, -364.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 15.0, 0.0, 13.0, -15.0, -14.0, 0.0, 0.0, 0.0, -394.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 1.0, 0.0, 15.0, 0.0, -22.0, 0.0, 2.0, 0.0, 2.0, -400.0, 0.0, -12.0, 3.0, -26.0, -29.0, 0.0, 0.0, -20.0, 14.0, 0.0, -20.0, 0.0, 0.0, -2.0, 15.0, 0.0, -12.0, -400.0, 0.0, -400.0, 9.0, 0.0, 0.0, -2.0, -2.0, 4.0, 0.0, 0.0, 14.0, -20.0, -17.0, -18.0, 0.0, -10.0, 0.0, 0.0, 8.0, 0.0, 14.0, -2.0, -8.0, -400.0, 0.0, -19.0, 0.0, -6.0, -15.0, -22.0, -15.0, 15.0, 2.0], "policy_predator_policy_reward": [0.0, 13.0, 9.0, 10.0, 0.0, 0.0, 199.0, 10.0, 10.0, 10.0, 0.0, 4.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 180.0, 10.0, 0.0, 0.0, 0.0, 184.0, 10.0, 4.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 10.0, 0.0, 8.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 5.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 181.0, 177.0, 10.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 179.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 6.0, 0.0, 18.0, 18.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 200.0, 0.0, 5.0, 196.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 200.0, 0.0, 3.0, 10.0, 10.0, 3.0, 10.0, 12.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9050136991339564, "mean_inference_ms": 2.381545622359826, "mean_action_processing_ms": 0.44426230989846327, "mean_env_wait_ms": 0.3212499918204332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017938971519470215, "StateBufferConnector_ms": 0.0038166046142578125, "ViewRequirementAgentConnector_ms": 0.10872769355773926}, "num_episodes": 23, "episode_return_max": 22.0, "episode_return_min": -588.0, "episode_return_mean": -30.07, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.3996853262679, "num_env_steps_trained_throughput_per_sec": 315.3996853262679, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 2192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2192000, "timers": {"training_iteration_time_ms": 12286.231, "restore_workers_time_ms": 0.02, "training_step_time_ms": 12286.174, "sample_time_ms": 1441.447, "learn_time_ms": 10827.382, "learn_throughput": 369.434, "synch_weights_time_ms": 14.857}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "done": false, "training_iteration": 137, "trial_id": "e1352_00000", "date": "2024-08-13_17-09-47", "timestamp": 1723583387, "time_this_iter_s": 12.721368074417114, "time_total_s": 1903.653326034546, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1710670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1903.653326034546, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 48.800000000000004, "ram_util_percent": 82.8722222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1291475936070716, "cur_kl_coeff": 0.07811180624036446, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00011943910325133296, "vf_loss": 1.6086528959413053, "vf_explained_var": 0.0006152324575595755, "kl": Infinity, "entropy": 3.5876599354463145e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.137920472792534, "cur_kl_coeff": 1.5192496232609823e-16, "cur_lr": 0.009999999999999998, "total_loss": 2.3699853371060082, "policy_loss": -9.9563845014446e-05, "vf_loss": 2.3700848997585355, "vf_explained_var": -5.708169684838996e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -587.0, "episode_reward_mean": -38.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.88, "predator_policy": 18.445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -189.0, -4.0, -10.0, -6.0, 0.0, 0.0, -193.0, 2.0, -8.0, 0.0, -1.0, 0.0, 14.0, 4.0, 8.0, 0.0, -200.0, -5.0, -9.0, 12.0, 0.0, 5.0, 5.0, 0.0, -168.0, -168.0, -1.0, 0.0, -5.0, 0.0, 2.0, -169.0, -176.0, 7.0, 0.0, 0.0, -2.0, 15.0, 13.0, -18.0, 0.0, -196.0, 0.0, 0.0, 0.0, 0.0, 16.0, 15.0, -6.0, 2.0, 2.0, -200.0, -3.0, -19.0, 0.0, 4.0, -10.0, 0.0, 14.0, -6.0, -200.0, -190.0, 0.0, -3.0, 4.0, 14.0, -21.0, -9.0, -3.0, 8.0, 14.0, -6.0, -200.0, -6.0, -8.0, -15.0, 22.0, 12.0, 5.0, 0.0, 3.0, 0.0, 9.0, 15.0, -185.0, 10.0, 1.0, -10.0, 0.0, -587.0, 0.0, -181.0, -200.0, 0.0, 5.0, 14.0, -583.0, -5.0, 6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 15.0, 0.0, -383.0, -8.0, 0.0, -20.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, 0.0, 0.0, -8.0, 0.0, -16.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, 15.0, -2.0, -16.0, 0.0, 5.0, 3.0, 0.0, 0.0, 0.0, -400.0, 0.0, -10.0, 0.0, -18.0, 15.0, -13.0, 0.0, 0.0, 5.0, 0.0, -20.0, 15.0, 0.0, 0.0, 13.0, -362.0, 0.0, -355.0, 0.0, -2.0, 0.0, 0.0, 3.0, -16.0, 0.0, 0.0, 8.0, -12.0, 0.0, -358.0, 0.0, -364.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 15.0, 0.0, 13.0, -15.0, -14.0, 0.0, 0.0, 0.0, -394.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 1.0, 0.0, 15.0, 0.0, -22.0, 0.0, 2.0, 0.0, 2.0, -400.0, 0.0, -12.0, 3.0, -26.0, -29.0, 0.0, 0.0, -20.0, 14.0, 0.0, -20.0, 0.0, 0.0, -2.0, 15.0, 0.0, -12.0, -400.0, 0.0, -400.0, 9.0, 0.0, 0.0, -2.0, -2.0, 4.0, 0.0, 0.0, 14.0, -20.0, -17.0, -18.0, 0.0, -10.0, 0.0, 0.0, 8.0, 0.0, 14.0, -2.0, -8.0, -400.0, 0.0, -19.0, 0.0, -6.0, -15.0, -22.0, -15.0, 15.0, 2.0, 1.0, 10.0, -20.0, 15.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 0.0, -16.0, -365.0, 10.0, 0.0, 0.0, -2.0, 0.0, -20.0, 0.0, 0.0, -390.0, -400.0, 0.0, 0.0, -358.0, -20.0, 0.0, -400.0, 0.0, 0.0, -20.0, 15.0, 5.0, 5.0, -398.0, -384.0, -15.0, 0.0, 0.0, 5.0], "policy_predator_policy_reward": [0.0, 0.0, 184.0, 10.0, 4.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 10.0, 0.0, 8.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 5.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 181.0, 177.0, 10.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 179.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 6.0, 0.0, 18.0, 18.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 200.0, 0.0, 5.0, 196.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 200.0, 0.0, 3.0, 10.0, 10.0, 3.0, 10.0, 12.0, 5.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 188.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 200.0, 3.0, 0.0, 0.0, 177.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 199.0, 10.0, 0.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9022008958817929, "mean_inference_ms": 2.3788715113527372, "mean_action_processing_ms": 0.4427620473669447, "mean_env_wait_ms": 0.32023367575888473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018604636192321777, "StateBufferConnector_ms": 0.003874540328979492, "ViewRequirementAgentConnector_ms": 0.11556470394134521}, "num_episodes": 22, "episode_return_max": 22.0, "episode_return_min": -587.0, "episode_return_mean": -38.87, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.4991419666352, "num_env_steps_trained_throughput_per_sec": 317.4991419666352, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 12398.365, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12398.315, "sample_time_ms": 1432.275, "learn_time_ms": 10945.817, "learn_throughput": 365.436, "synch_weights_time_ms": 17.355}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 138, "trial_id": "e1352_00000", "date": "2024-08-13_17-10-00", "timestamp": 1723583400, "time_this_iter_s": 12.685686588287354, "time_total_s": 1916.3390126228333, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16dbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1916.3390126228333, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 47.02777777777777, "ram_util_percent": 83.22777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1272422991732443, "cur_kl_coeff": 0.1171677093605466, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": -3.121090762159496e-05, "vf_loss": 0.6925525016333691, "vf_explained_var": 0.0016637452064998566, "kl": Infinity, "entropy": 2.0415606298079328e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3665119494232094, "cur_kl_coeff": 7.596248116304912e-17, "cur_lr": 0.009999999999999998, "total_loss": 1.1109640277567363, "policy_loss": -2.4470048537724232e-05, "vf_loss": 1.110988502795734, "vf_explained_var": -5.235116948526372e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -587.0, "episode_reward_mean": -48.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -43.4, "predator_policy": 19.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, -9.0, 12.0, 0.0, 5.0, 5.0, 0.0, -168.0, -168.0, -1.0, 0.0, -5.0, 0.0, 2.0, -169.0, -176.0, 7.0, 0.0, 0.0, -2.0, 15.0, 13.0, -18.0, 0.0, -196.0, 0.0, 0.0, 0.0, 0.0, 16.0, 15.0, -6.0, 2.0, 2.0, -200.0, -3.0, -19.0, 0.0, 4.0, -10.0, 0.0, 14.0, -6.0, -200.0, -190.0, 0.0, -3.0, 4.0, 14.0, -21.0, -9.0, -3.0, 8.0, 14.0, -6.0, -200.0, -6.0, -8.0, -15.0, 22.0, 12.0, 5.0, 0.0, 3.0, 0.0, 9.0, 15.0, -185.0, 10.0, 1.0, -10.0, 0.0, -587.0, 0.0, -181.0, -200.0, 0.0, 5.0, 14.0, -583.0, -5.0, 6.0, -8.0, 6.0, 29.0, 7.0, -9.0, 0.0, 0.0, 0.0, -551.0, 9.0, -6.0, -4.0, -196.0, -1.0, -198.0, -10.0, -578.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -10.0, 0.0, -18.0, 15.0, -13.0, 0.0, 0.0, 5.0, 0.0, -20.0, 15.0, 0.0, 0.0, 13.0, -362.0, 0.0, -355.0, 0.0, -2.0, 0.0, 0.0, 3.0, -16.0, 0.0, 0.0, 8.0, -12.0, 0.0, -358.0, 0.0, -364.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 15.0, 0.0, 13.0, -15.0, -14.0, 0.0, 0.0, 0.0, -394.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 1.0, 0.0, 15.0, 0.0, -22.0, 0.0, 2.0, 0.0, 2.0, -400.0, 0.0, -12.0, 3.0, -26.0, -29.0, 0.0, 0.0, -20.0, 14.0, 0.0, -20.0, 0.0, 0.0, -2.0, 15.0, 0.0, -12.0, -400.0, 0.0, -400.0, 9.0, 0.0, 0.0, -2.0, -2.0, 4.0, 0.0, 0.0, 14.0, -20.0, -17.0, -18.0, 0.0, -10.0, 0.0, 0.0, 8.0, 0.0, 14.0, -2.0, -8.0, -400.0, 0.0, -19.0, 0.0, -6.0, -15.0, -22.0, -15.0, 15.0, 2.0, 1.0, 10.0, -20.0, 15.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 0.0, -16.0, -365.0, 10.0, 0.0, 0.0, -2.0, 0.0, -20.0, 0.0, 0.0, -390.0, -400.0, 0.0, 0.0, -358.0, -20.0, 0.0, -400.0, 0.0, 0.0, -20.0, 15.0, 5.0, 5.0, -398.0, -384.0, -15.0, 0.0, 0.0, 5.0, 1.0, -18.0, 6.0, 0.0, 15.0, 14.0, 0.0, 7.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -351.0, 5.0, 4.0, -12.0, 0.0, -14.0, 0.0, -394.0, 0.0, -2.0, 0.0, -400.0, 2.0, -20.0, 0.0, -380.0, -396.0, 15.0, 0.0], "policy_predator_policy_reward": [5.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 181.0, 177.0, 10.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 179.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 6.0, 0.0, 18.0, 18.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 200.0, 0.0, 5.0, 196.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 200.0, 0.0, 3.0, 10.0, 10.0, 3.0, 10.0, 12.0, 5.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 188.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 200.0, 3.0, 0.0, 0.0, 177.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 199.0, 10.0, 0.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 0.0, 192.0, 6.0, 1.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 198.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9017183821970879, "mean_inference_ms": 2.377367810848163, "mean_action_processing_ms": 0.44182667988345287, "mean_env_wait_ms": 0.3200009005621572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019038677215576172, "StateBufferConnector_ms": 0.009014725685119629, "ViewRequirementAgentConnector_ms": 0.1274564266204834}, "num_episodes": 18, "episode_return_max": 29.0, "episode_return_min": -587.0, "episode_return_mean": -48.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.3113510188606, "num_env_steps_trained_throughput_per_sec": 308.3113510188606, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 2224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2224000, "timers": {"training_iteration_time_ms": 12618.912, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12618.86, "sample_time_ms": 1543.266, "learn_time_ms": 11052.78, "learn_throughput": 361.9, "synch_weights_time_ms": 19.868}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "done": false, "training_iteration": 139, "trial_id": "e1352_00000", "date": "2024-08-13_17-10-13", "timestamp": 1723583413, "time_this_iter_s": 13.034611940383911, "time_total_s": 1929.3736245632172, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15d8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1929.3736245632172, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 49.24444444444444, "ram_util_percent": 83.24444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.15225978547106, "cur_kl_coeff": 0.17575156404081996, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.0001286995587328439, "vf_loss": 0.949773878206021, "vf_explained_var": 4.070076362165824e-05, "kl": Infinity, "entropy": 7.489933618966317e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.251903989434885, "cur_kl_coeff": 3.798124058152456e-17, "cur_lr": 0.009999999999999998, "total_loss": 1.1075608003352369, "policy_loss": 8.934380476752287e-06, "vf_loss": 1.107551860762021, "vf_explained_var": -9.334907329902448e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -587.0, "episode_reward_mean": -44.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -39.66, "predator_policy": 17.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -2.0, 15.0, 13.0, -18.0, 0.0, -196.0, 0.0, 0.0, 0.0, 0.0, 16.0, 15.0, -6.0, 2.0, 2.0, -200.0, -3.0, -19.0, 0.0, 4.0, -10.0, 0.0, 14.0, -6.0, -200.0, -190.0, 0.0, -3.0, 4.0, 14.0, -21.0, -9.0, -3.0, 8.0, 14.0, -6.0, -200.0, -6.0, -8.0, -15.0, 22.0, 12.0, 5.0, 0.0, 3.0, 0.0, 9.0, 15.0, -185.0, 10.0, 1.0, -10.0, 0.0, -587.0, 0.0, -181.0, -200.0, 0.0, 5.0, 14.0, -583.0, -5.0, 6.0, -8.0, 6.0, 29.0, 7.0, -9.0, 0.0, 0.0, 0.0, -551.0, 9.0, -6.0, -4.0, -196.0, -1.0, -198.0, -10.0, -578.0, 15.0, 0.0, 0.0, 1.0, 0.0, 4.0, 28.0, 0.0, -13.0, -10.0, -167.0, 21.0, -174.0, 13.0, -26.0, 0.0, 0.0, -3.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -4.0, 0.0, 15.0, 0.0, 13.0, -15.0, -14.0, 0.0, 0.0, 0.0, -394.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 1.0, 0.0, 15.0, 0.0, -22.0, 0.0, 2.0, 0.0, 2.0, -400.0, 0.0, -12.0, 3.0, -26.0, -29.0, 0.0, 0.0, -20.0, 14.0, 0.0, -20.0, 0.0, 0.0, -2.0, 15.0, 0.0, -12.0, -400.0, 0.0, -400.0, 9.0, 0.0, 0.0, -2.0, -2.0, 4.0, 0.0, 0.0, 14.0, -20.0, -17.0, -18.0, 0.0, -10.0, 0.0, 0.0, 8.0, 0.0, 14.0, -2.0, -8.0, -400.0, 0.0, -19.0, 0.0, -6.0, -15.0, -22.0, -15.0, 15.0, 2.0, 1.0, 10.0, -20.0, 15.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 0.0, -16.0, -365.0, 10.0, 0.0, 0.0, -2.0, 0.0, -20.0, 0.0, 0.0, -390.0, -400.0, 0.0, 0.0, -358.0, -20.0, 0.0, -400.0, 0.0, 0.0, -20.0, 15.0, 5.0, 5.0, -398.0, -384.0, -15.0, 0.0, 0.0, 5.0, 1.0, -18.0, 6.0, 0.0, 15.0, 14.0, 0.0, 7.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -351.0, 5.0, 4.0, -12.0, 0.0, -14.0, 0.0, -394.0, 0.0, -2.0, 0.0, -400.0, 2.0, -20.0, 0.0, -380.0, -396.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 4.0, 13.0, 15.0, 0.0, 0.0, -6.0, -20.0, -20.0, 0.0, -348.0, 0.0, 6.0, 15.0, -361.0, 0.0, 13.0, 0.0, -18.0, -19.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 15.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 6.0, 0.0, 18.0, 18.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 200.0, 0.0, 5.0, 196.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 200.0, 0.0, 3.0, 10.0, 10.0, 3.0, 10.0, 12.0, 5.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 188.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 200.0, 3.0, 0.0, 0.0, 177.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 199.0, 10.0, 0.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 0.0, 192.0, 6.0, 1.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 181.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9005522793393341, "mean_inference_ms": 2.3764107071245477, "mean_action_processing_ms": 0.44085600304960265, "mean_env_wait_ms": 0.3195239234783123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020988106727600098, "StateBufferConnector_ms": 0.00916147232055664, "ViewRequirementAgentConnector_ms": 0.12880098819732666}, "num_episodes": 18, "episode_return_max": 29.0, "episode_return_min": -587.0, "episode_return_mean": -44.55, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.6041258826542, "num_env_steps_trained_throughput_per_sec": 318.6041258826542, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 12635.582, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12635.53, "sample_time_ms": 1586.226, "learn_time_ms": 11027.393, "learn_throughput": 362.733, "synch_weights_time_ms": 19.105}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 140, "trial_id": "e1352_00000", "date": "2024-08-13_17-10-26", "timestamp": 1723583426, "time_this_iter_s": 12.60417890548706, "time_total_s": 1941.9778034687042, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1710f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1941.9778034687042, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 50.41666666666666, "ram_util_percent": 83.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4885377399564264, "cur_kl_coeff": 0.26362734606122995, "cur_lr": 0.009999999999999998, "total_loss": Infinity, "policy_loss": 0.00017427030701939233, "vf_loss": 1.5008688076936378, "vf_explained_var": 0.00042243186758939553, "kl": Infinity, "entropy": 5.439848052786529e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0727898328030565, "cur_kl_coeff": 1.899062029076228e-17, "cur_lr": 0.009999999999999998, "total_loss": 1.5727493609070147, "policy_loss": -0.00019912964124823847, "vf_loss": 1.5729484981014614, "vf_explained_var": -1.1321728822415468e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -587.0, "episode_reward_mean": -54.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -49.215, "predator_policy": 22.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, -6.0, -200.0, -190.0, 0.0, -3.0, 4.0, 14.0, -21.0, -9.0, -3.0, 8.0, 14.0, -6.0, -200.0, -6.0, -8.0, -15.0, 22.0, 12.0, 5.0, 0.0, 3.0, 0.0, 9.0, 15.0, -185.0, 10.0, 1.0, -10.0, 0.0, -587.0, 0.0, -181.0, -200.0, 0.0, 5.0, 14.0, -583.0, -5.0, 6.0, -8.0, 6.0, 29.0, 7.0, -9.0, 0.0, 0.0, 0.0, -551.0, 9.0, -6.0, -4.0, -196.0, -1.0, -198.0, -10.0, -578.0, 15.0, 0.0, 0.0, 1.0, 0.0, 4.0, 28.0, 0.0, -13.0, -10.0, -167.0, 21.0, -174.0, 13.0, -26.0, 0.0, 0.0, -3.0, 15.0, -182.0, 0.0, 0.0, -4.0, -184.0, 0.0, -188.0, -9.0, -9.0, -169.0, -13.0, 0.0, -10.0, 0.0, 7.0, 0.0, -194.0, 5.0, -10.0, -197.0, 0.0, -200.0, 21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 15.0, 0.0, -12.0, -400.0, 0.0, -400.0, 9.0, 0.0, 0.0, -2.0, -2.0, 4.0, 0.0, 0.0, 14.0, -20.0, -17.0, -18.0, 0.0, -10.0, 0.0, 0.0, 8.0, 0.0, 14.0, -2.0, -8.0, -400.0, 0.0, -19.0, 0.0, -6.0, -15.0, -22.0, -15.0, 15.0, 2.0, 1.0, 10.0, -20.0, 15.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 0.0, -16.0, -365.0, 10.0, 0.0, 0.0, -2.0, 0.0, -20.0, 0.0, 0.0, -390.0, -400.0, 0.0, 0.0, -358.0, -20.0, 0.0, -400.0, 0.0, 0.0, -20.0, 15.0, 5.0, 5.0, -398.0, -384.0, -15.0, 0.0, 0.0, 5.0, 1.0, -18.0, 6.0, 0.0, 15.0, 14.0, 0.0, 7.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -351.0, 5.0, 4.0, -12.0, 0.0, -14.0, 0.0, -394.0, 0.0, -2.0, 0.0, -400.0, 2.0, -20.0, 0.0, -380.0, -396.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 4.0, 13.0, 15.0, 0.0, 0.0, -6.0, -20.0, -20.0, 0.0, -348.0, 0.0, 6.0, 15.0, -361.0, 0.0, 13.0, 0.0, -18.0, -19.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 15.0, 0.0, -384.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -384.0, 8.0, 0.0, 0.0, -400.0, 12.0, 0.0, -18.0, -18.0, 0.0, 9.0, -367.0, -27.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -16.0, 15.0, 0.0, 0.0, 0.0, -390.0, 11.0, -17.0, -20.0, 0.0, -400.0, 2.0, 0.0, 0.0, 0.0, -400.0, 9.0, 12.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 6.0, 200.0, 0.0, 5.0, 196.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 9.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 200.0, 0.0, 3.0, 10.0, 10.0, 3.0, 10.0, 12.0, 5.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 188.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 200.0, 3.0, 0.0, 0.0, 177.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 199.0, 10.0, 0.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 0.0, 192.0, 6.0, 1.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 181.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 192.0, 0.0, 0.0, 0.0, 0.0, 200.0, 9.0, 0.0, 9.0, 0.0, 189.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 186.0, 10.0, 1.0, 10.0, 10.0, 0.0, 1.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8993613348631156, "mean_inference_ms": 2.37527686711872, "mean_action_processing_ms": 0.44002099431431607, "mean_env_wait_ms": 0.31895094644744965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02066802978515625, "StateBufferConnector_ms": 0.009119033813476562, "ViewRequirementAgentConnector_ms": 0.1359173059463501}, "num_episodes": 23, "episode_return_max": 29.0, "episode_return_min": -587.0, "episode_return_mean": -54.04, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.0068104555017, "num_env_steps_trained_throughput_per_sec": 318.0068104555017, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 12636.975, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12636.924, "sample_time_ms": 1576.877, "learn_time_ms": 11038.271, "learn_throughput": 362.376, "synch_weights_time_ms": 19.094}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 141, "trial_id": "e1352_00000", "date": "2024-08-13_17-10-38", "timestamp": 1723583438, "time_this_iter_s": 12.805755853652954, "time_total_s": 1954.7835593223572, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17100d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1954.7835593223572, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 45.86666666666666, "ram_util_percent": 83.38333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2675014826727824, "cur_kl_coeff": 0.3954410190918448, "cur_lr": 0.009999999999999998, "total_loss": 0.6168764139136309, "policy_loss": -1.7868071084930784e-05, "vf_loss": 0.6168942829934023, "vf_explained_var": 0.0002527013657585023, "kl": -1.8476379751838327e-45, "entropy": 6.362596418694591e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2969912592383848, "cur_kl_coeff": 9.49531014538114e-18, "cur_lr": 0.009999999999999998, "total_loss": 1.184046613484148, "policy_loss": 0.00010543885695003959, "vf_loss": 1.1839411724733298, "vf_explained_var": -1.0470233897052744e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -587.0, "episode_reward_mean": -53.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -46.87, "predator_policy": 20.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 12.0, 5.0, 0.0, 3.0, 0.0, 9.0, 15.0, -185.0, 10.0, 1.0, -10.0, 0.0, -587.0, 0.0, -181.0, -200.0, 0.0, 5.0, 14.0, -583.0, -5.0, 6.0, -8.0, 6.0, 29.0, 7.0, -9.0, 0.0, 0.0, 0.0, -551.0, 9.0, -6.0, -4.0, -196.0, -1.0, -198.0, -10.0, -578.0, 15.0, 0.0, 0.0, 1.0, 0.0, 4.0, 28.0, 0.0, -13.0, -10.0, -167.0, 21.0, -174.0, 13.0, -26.0, 0.0, 0.0, -3.0, 15.0, -182.0, 0.0, 0.0, -4.0, -184.0, 0.0, -188.0, -9.0, -9.0, -169.0, -13.0, 0.0, -10.0, 0.0, 7.0, 0.0, -194.0, 5.0, -10.0, -197.0, 0.0, -200.0, 21.0, 0.0, 8.0, 10.0, 6.0, -4.0, 0.0, 15.0, 0.0, -557.0, 3.0, -8.0, -18.0, 0.0, -10.0, 10.0, -28.0, 0.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 2.0, 1.0, 10.0, -20.0, 15.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 0.0, -16.0, -365.0, 10.0, 0.0, 0.0, -2.0, 0.0, -20.0, 0.0, 0.0, -390.0, -400.0, 0.0, 0.0, -358.0, -20.0, 0.0, -400.0, 0.0, 0.0, -20.0, 15.0, 5.0, 5.0, -398.0, -384.0, -15.0, 0.0, 0.0, 5.0, 1.0, -18.0, 6.0, 0.0, 15.0, 14.0, 0.0, 7.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -351.0, 5.0, 4.0, -12.0, 0.0, -14.0, 0.0, -394.0, 0.0, -2.0, 0.0, -400.0, 2.0, -20.0, 0.0, -380.0, -396.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 4.0, 13.0, 15.0, 0.0, 0.0, -6.0, -20.0, -20.0, 0.0, -348.0, 0.0, 6.0, 15.0, -361.0, 0.0, 13.0, 0.0, -18.0, -19.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 15.0, 0.0, -384.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -384.0, 8.0, 0.0, 0.0, -400.0, 12.0, 0.0, -18.0, -18.0, 0.0, 9.0, -367.0, -27.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -16.0, 15.0, 0.0, 0.0, 0.0, -390.0, 11.0, -17.0, -20.0, 0.0, -400.0, 2.0, 0.0, 0.0, 0.0, -400.0, 9.0, 12.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 0.0, 4.0, 0.0, -8.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -396.0, -369.0, 0.0, 3.0, -12.0, -12.0, -16.0, -20.0, 0.0, 0.0, -20.0, 0.0, 15.0, -13.0, -20.0, -20.0, 0.0, 0.0, 15.0, 0.0], "policy_predator_policy_reward": [5.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 188.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 200.0, 3.0, 0.0, 0.0, 177.0, 20.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 199.0, 10.0, 0.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 0.0, 192.0, 6.0, 1.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 181.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 192.0, 0.0, 0.0, 0.0, 0.0, 200.0, 9.0, 0.0, 9.0, 0.0, 189.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 186.0, 10.0, 1.0, 10.0, 10.0, 0.0, 1.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 13.0, 0.0, 0.0, 0.0, 16.0, 0.0, 18.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8980141322084646, "mean_inference_ms": 2.374462798770325, "mean_action_processing_ms": 0.4388067279197929, "mean_env_wait_ms": 0.3184564913265755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007341504096984863, "StateBufferConnector_ms": 0.00918269157409668, "ViewRequirementAgentConnector_ms": 0.135107159614563}, "num_episodes": 18, "episode_return_max": 29.0, "episode_return_min": -587.0, "episode_return_mean": -53.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.2842366211225, "num_env_steps_trained_throughput_per_sec": 320.2842366211225, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 2272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2272000, "timers": {"training_iteration_time_ms": 12623.416, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12623.366, "sample_time_ms": 1579.746, "learn_time_ms": 11021.912, "learn_throughput": 362.913, "synch_weights_time_ms": 19.23}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "done": false, "training_iteration": 142, "trial_id": "e1352_00000", "date": "2024-08-13_17-10-51", "timestamp": 1723583451, "time_this_iter_s": 12.5178701877594, "time_total_s": 1967.3014295101166, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1710790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1967.3014295101166, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 49.45, "ram_util_percent": 83.54444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.426167768366615, "cur_kl_coeff": 0.1977205095459224, "cur_lr": 0.009999999999999998, "total_loss": 0.2802981399630428, "policy_loss": 0.0002703100218679066, "vf_loss": 0.28002782867220166, "vf_explained_var": -0.00029473213291672805, "kl": -1.0291017293560032e-45, "entropy": 5.4277650045997025e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.282181674105555, "cur_kl_coeff": 4.74765507269057e-18, "cur_lr": 0.009999999999999998, "total_loss": 0.386399308051027, "policy_loss": 5.786887557299995e-05, "vf_loss": 0.386341440301907, "vf_explained_var": 5.5340515873419546e-05, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -584.0, "episode_reward_mean": -42.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.815, "predator_policy": 16.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, -8.0, 6.0, 29.0, 7.0, -9.0, 0.0, 0.0, 0.0, -551.0, 9.0, -6.0, -4.0, -196.0, -1.0, -198.0, -10.0, -578.0, 15.0, 0.0, 0.0, 1.0, 0.0, 4.0, 28.0, 0.0, -13.0, -10.0, -167.0, 21.0, -174.0, 13.0, -26.0, 0.0, 0.0, -3.0, 15.0, -182.0, 0.0, 0.0, -4.0, -184.0, 0.0, -188.0, -9.0, -9.0, -169.0, -13.0, 0.0, -10.0, 0.0, 7.0, 0.0, -194.0, 5.0, -10.0, -197.0, 0.0, -200.0, 21.0, 0.0, 8.0, 10.0, 6.0, -4.0, 0.0, 15.0, 0.0, -557.0, 3.0, -8.0, -18.0, 0.0, -10.0, 10.0, -28.0, 0.0, 15.0, 0.0, -1.0, -6.0, 2.0, 0.0, -5.0, -584.0, 10.0, 11.0, 0.0, -3.0, 0.0, -15.0, -1.0, -10.0, -16.0, -3.0, 0.0, 13.0, 2.0, -1.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 5.0, 1.0, -18.0, 6.0, 0.0, 15.0, 14.0, 0.0, 7.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -351.0, 5.0, 4.0, -12.0, 0.0, -14.0, 0.0, -394.0, 0.0, -2.0, 0.0, -400.0, 2.0, -20.0, 0.0, -380.0, -396.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 4.0, 13.0, 15.0, 0.0, 0.0, -6.0, -20.0, -20.0, 0.0, -348.0, 0.0, 6.0, 15.0, -361.0, 0.0, 13.0, 0.0, -18.0, -19.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 15.0, 0.0, -384.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -384.0, 8.0, 0.0, 0.0, -400.0, 12.0, 0.0, -18.0, -18.0, 0.0, 9.0, -367.0, -27.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -16.0, 15.0, 0.0, 0.0, 0.0, -390.0, 11.0, -17.0, -20.0, 0.0, -400.0, 2.0, 0.0, 0.0, 0.0, -400.0, 9.0, 12.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 0.0, 4.0, 0.0, -8.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -396.0, -369.0, 0.0, 3.0, -12.0, -12.0, -16.0, -20.0, 0.0, 0.0, -20.0, 0.0, 15.0, -13.0, -20.0, -20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -2.0, 0.0, -24.0, 0.0, 2.0, 0.0, 0.0, 0.0, -10.0, 0.0, -400.0, -394.0, 0.0, 10.0, -8.0, 15.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, -20.0, -10.0, -2.0, 0.0, 0.0, -20.0, -12.0, -20.0, -6.0, 0.0, 0.0, 0.0, 0.0, 13.0, -8.0, 0.0, -4.0, 1.0, 0.0, 13.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 0.0, 192.0, 6.0, 1.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 181.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 192.0, 0.0, 0.0, 0.0, 0.0, 200.0, 9.0, 0.0, 9.0, 0.0, 189.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 186.0, 10.0, 1.0, 10.0, 10.0, 0.0, 1.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 13.0, 0.0, 0.0, 0.0, 16.0, 0.0, 18.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 1.0, 10.0, 0.0, 6.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8966418149638193, "mean_inference_ms": 2.37367331689286, "mean_action_processing_ms": 0.437740660300866, "mean_env_wait_ms": 0.31790464489409875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070601701736450195, "StateBufferConnector_ms": 0.009215831756591797, "ViewRequirementAgentConnector_ms": 0.1316438913345337}, "num_episodes": 22, "episode_return_max": 29.0, "episode_return_min": -584.0, "episode_return_mean": -42.87, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.55456783650175, "num_env_steps_trained_throughput_per_sec": 335.55456783650175, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 2288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2288000, "timers": {"training_iteration_time_ms": 12553.108, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12553.058, "sample_time_ms": 1579.915, "learn_time_ms": 10952.114, "learn_throughput": 365.226, "synch_weights_time_ms": 18.672}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "done": false, "training_iteration": 143, "trial_id": "e1352_00000", "date": "2024-08-13_17-11-03", "timestamp": 1723583463, "time_this_iter_s": 11.978457927703857, "time_total_s": 1979.2798874378204, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15d8700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1979.2798874378204, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 47.72941176470588, "ram_util_percent": 83.21176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3867306375501567, "cur_kl_coeff": 0.0988602547729612, "cur_lr": 0.009999999999999998, "total_loss": 1.1469432981872054, "policy_loss": -0.00033322015565342056, "vf_loss": 1.1472765216436336, "vf_explained_var": 0.00036893313523953555, "kl": -5.1640443407525665e-45, "entropy": 6.462396302181598e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.037245632200773, "cur_kl_coeff": 2.373827536345285e-18, "cur_lr": 0.009999999999999998, "total_loss": 1.2127888104903004, "policy_loss": 0.00045213337085904585, "vf_loss": 1.2123366760356085, "vf_explained_var": -6.591201459289228e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -584.0, "episode_reward_mean": -31.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -30.225, "predator_policy": 14.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 0.0, 0.0, 1.0, 0.0, 4.0, 28.0, 0.0, -13.0, -10.0, -167.0, 21.0, -174.0, 13.0, -26.0, 0.0, 0.0, -3.0, 15.0, -182.0, 0.0, 0.0, -4.0, -184.0, 0.0, -188.0, -9.0, -9.0, -169.0, -13.0, 0.0, -10.0, 0.0, 7.0, 0.0, -194.0, 5.0, -10.0, -197.0, 0.0, -200.0, 21.0, 0.0, 8.0, 10.0, 6.0, -4.0, 0.0, 15.0, 0.0, -557.0, 3.0, -8.0, -18.0, 0.0, -10.0, 10.0, -28.0, 0.0, 15.0, 0.0, -1.0, -6.0, 2.0, 0.0, -5.0, -584.0, 10.0, 11.0, 0.0, -3.0, 0.0, -15.0, -1.0, -10.0, -16.0, -3.0, 0.0, 13.0, 2.0, -1.0, 14.0, -1.0, 0.0, -1.0, -3.0, 12.0, 1.0, 3.0, -5.0, -200.0, -3.0, -7.0, 12.0, 15.0, 11.0, 12.0, -10.0, 15.0, -191.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 4.0, 13.0, 15.0, 0.0, 0.0, -6.0, -20.0, -20.0, 0.0, -348.0, 0.0, 6.0, 15.0, -361.0, 0.0, 13.0, 0.0, -18.0, -19.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 15.0, 0.0, -384.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -384.0, 8.0, 0.0, 0.0, -400.0, 12.0, 0.0, -18.0, -18.0, 0.0, 9.0, -367.0, -27.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -16.0, 15.0, 0.0, 0.0, 0.0, -390.0, 11.0, -17.0, -20.0, 0.0, -400.0, 2.0, 0.0, 0.0, 0.0, -400.0, 9.0, 12.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 0.0, 4.0, 0.0, -8.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -396.0, -369.0, 0.0, 3.0, -12.0, -12.0, -16.0, -20.0, 0.0, 0.0, -20.0, 0.0, 15.0, -13.0, -20.0, -20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -2.0, 0.0, -24.0, 0.0, 2.0, 0.0, 0.0, 0.0, -10.0, 0.0, -400.0, -394.0, 0.0, 10.0, -8.0, 15.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, -20.0, -10.0, -2.0, 0.0, 0.0, -20.0, -12.0, -20.0, -6.0, 0.0, 0.0, 0.0, 0.0, 13.0, -8.0, 0.0, -4.0, 1.0, 0.0, 13.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -13.0, 0.0, 12.0, -19.0, 0.0, 0.0, 3.0, 0.0, -15.0, 0.0, -400.0, 0.0, -6.0, -19.0, -16.0, 12.0, 0.0, 15.0, 0.0, 11.0, 0.0, 0.0, 12.0, -20.0, 0.0, 0.0, 15.0, -382.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 181.0, 0.0, 0.0, 187.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 192.0, 0.0, 0.0, 0.0, 0.0, 200.0, 9.0, 0.0, 9.0, 0.0, 189.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 186.0, 10.0, 1.0, 10.0, 10.0, 0.0, 1.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 13.0, 0.0, 0.0, 0.0, 16.0, 0.0, 18.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 1.0, 10.0, 0.0, 6.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 8.0, 7.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 10.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 191.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8950659203088995, "mean_inference_ms": 2.3718114351468302, "mean_action_processing_ms": 0.43665137523322095, "mean_env_wait_ms": 0.3172980507160183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006557345390319824, "StateBufferConnector_ms": 0.003666400909423828, "ViewRequirementAgentConnector_ms": 0.12726855278015137}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -584.0, "episode_return_mean": -31.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.31795423503996, "num_env_steps_trained_throughput_per_sec": 306.31795423503996, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 12596.514, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12596.464, "sample_time_ms": 1587.592, "learn_time_ms": 10987.545, "learn_throughput": 364.049, "synch_weights_time_ms": 19.027}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 144, "trial_id": "e1352_00000", "date": "2024-08-13_17-11-16", "timestamp": 1723583476, "time_this_iter_s": 13.118921995162964, "time_total_s": 1992.3988094329834, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15d85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1992.3988094329834, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 55.14736842105262, "ram_util_percent": 83.46842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.276644077154909, "cur_kl_coeff": 0.0494301273864806, "cur_lr": 0.009999999999999998, "total_loss": 1.3885589193730128, "policy_loss": -0.0002937559242897406, "vf_loss": 1.388852671719102, "vf_explained_var": -7.154764952483e-07, "kl": -1.9811691145620865e-44, "entropy": 8.870394997554952e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.194981876967035, "cur_kl_coeff": 1.1869137681726424e-18, "cur_lr": 0.009999999999999998, "total_loss": 1.4477033045872179, "policy_loss": -0.00011452469708664076, "vf_loss": 1.4478178286678576, "vf_explained_var": -8.578022951802249e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -584.0, "episode_reward_mean": -39.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -38.73, "predator_policy": 18.885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -182.0, 0.0, 0.0, -4.0, -184.0, 0.0, -188.0, -9.0, -9.0, -169.0, -13.0, 0.0, -10.0, 0.0, 7.0, 0.0, -194.0, 5.0, -10.0, -197.0, 0.0, -200.0, 21.0, 0.0, 8.0, 10.0, 6.0, -4.0, 0.0, 15.0, 0.0, -557.0, 3.0, -8.0, -18.0, 0.0, -10.0, 10.0, -28.0, 0.0, 15.0, 0.0, -1.0, -6.0, 2.0, 0.0, -5.0, -584.0, 10.0, 11.0, 0.0, -3.0, 0.0, -15.0, -1.0, -10.0, -16.0, -3.0, 0.0, 13.0, 2.0, -1.0, 14.0, -1.0, 0.0, -1.0, -3.0, 12.0, 1.0, 3.0, -5.0, -200.0, -3.0, -7.0, 12.0, 15.0, 11.0, 12.0, -10.0, 15.0, -191.0, -2.0, 4.0, 13.0, -10.0, -183.0, -189.0, -7.0, -27.0, 0.0, -200.0, -575.0, 13.0, 0.0, -3.0, -2.0, -1.0, 7.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, -384.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -384.0, 8.0, 0.0, 0.0, -400.0, 12.0, 0.0, -18.0, -18.0, 0.0, 9.0, -367.0, -27.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -16.0, 15.0, 0.0, 0.0, 0.0, -390.0, 11.0, -17.0, -20.0, 0.0, -400.0, 2.0, 0.0, 0.0, 0.0, -400.0, 9.0, 12.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 0.0, 4.0, 0.0, -8.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -396.0, -369.0, 0.0, 3.0, -12.0, -12.0, -16.0, -20.0, 0.0, 0.0, -20.0, 0.0, 15.0, -13.0, -20.0, -20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -2.0, 0.0, -24.0, 0.0, 2.0, 0.0, 0.0, 0.0, -10.0, 0.0, -400.0, -394.0, 0.0, 10.0, -8.0, 15.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, -20.0, -10.0, -2.0, 0.0, 0.0, -20.0, -12.0, -20.0, -6.0, 0.0, 0.0, 0.0, 0.0, 13.0, -8.0, 0.0, -4.0, 1.0, 0.0, 13.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -13.0, 0.0, 12.0, -19.0, 0.0, 0.0, 3.0, 0.0, -15.0, 0.0, -400.0, 0.0, -6.0, -19.0, -16.0, 12.0, 0.0, 15.0, 0.0, 11.0, 0.0, 0.0, 12.0, -20.0, 0.0, 0.0, 15.0, -382.0, 0.0, 0.0, -4.0, 0.0, -4.0, 13.0, 0.0, 0.0, -20.0, 15.0, -396.0, -378.0, 0.0, -14.0, 0.0, -20.0, -18.0, 0.0, 0.0, -400.0, 0.0, -400.0, -385.0, 0.0, 13.0, 0.0, -400.0, -12.0, 3.0, -28.0, 12.0, 0.0, -4.0, 5.0, 0.0, 0.0, 5.0], "policy_predator_policy_reward": [0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 192.0, 0.0, 0.0, 0.0, 0.0, 200.0, 9.0, 0.0, 9.0, 0.0, 189.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 186.0, 10.0, 1.0, 10.0, 10.0, 0.0, 1.0, 200.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 13.0, 0.0, 0.0, 0.0, 16.0, 0.0, 18.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 1.0, 10.0, 0.0, 6.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 8.0, 7.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 10.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 2.0, 8.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 198.0, 189.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 10.0, 0.0, 0.0, 200.0, 200.0, 6.0, 0.0, 4.0, 10.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8935665970452827, "mean_inference_ms": 2.370218047089769, "mean_action_processing_ms": 0.4355966038558215, "mean_env_wait_ms": 0.3167353992554536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004737734794616699, "StateBufferConnector_ms": 0.0035691261291503906, "ViewRequirementAgentConnector_ms": 0.1164313554763794}, "num_episodes": 18, "episode_return_max": 21.0, "episode_return_min": -584.0, "episode_return_mean": -39.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.07523310870613, "num_env_steps_trained_throughput_per_sec": 325.07523310870613, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 12550.721, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12550.669, "sample_time_ms": 1604.465, "learn_time_ms": 10924.288, "learn_throughput": 366.157, "synch_weights_time_ms": 19.298}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 145, "trial_id": "e1352_00000", "date": "2024-08-13_17-11-29", "timestamp": 1723583489, "time_this_iter_s": 12.344823122024536, "time_total_s": 2004.743632555008, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2a955e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2004.743632555008, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 52.48823529411764, "ram_util_percent": 83.61764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.393190100393628, "cur_kl_coeff": 0.0247150636932403, "cur_lr": 0.009999999999999998, "total_loss": 0.9025456874458878, "policy_loss": 7.171574191599296e-05, "vf_loss": 0.9024739710899888, "vf_explained_var": 4.162864079551091e-09, "kl": -7.414277589020197e-49, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.330010911590247, "cur_kl_coeff": 5.934568840863212e-19, "cur_lr": 0.009999999999999998, "total_loss": 1.1605835290891784, "policy_loss": -0.0002074453817118728, "vf_loss": 1.1607909721041483, "vf_explained_var": -9.934107462565104e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -584.0, "episode_reward_mean": -34.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -33.005, "predator_policy": 15.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 0.0, 8.0, 10.0, 6.0, -4.0, 0.0, 15.0, 0.0, -557.0, 3.0, -8.0, -18.0, 0.0, -10.0, 10.0, -28.0, 0.0, 15.0, 0.0, -1.0, -6.0, 2.0, 0.0, -5.0, -584.0, 10.0, 11.0, 0.0, -3.0, 0.0, -15.0, -1.0, -10.0, -16.0, -3.0, 0.0, 13.0, 2.0, -1.0, 14.0, -1.0, 0.0, -1.0, -3.0, 12.0, 1.0, 3.0, -5.0, -200.0, -3.0, -7.0, 12.0, 15.0, 11.0, 12.0, -10.0, 15.0, -191.0, -2.0, 4.0, 13.0, -10.0, -183.0, -189.0, -7.0, -27.0, 0.0, -200.0, -575.0, 13.0, 0.0, -3.0, -2.0, -1.0, 7.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, -193.0, -10.0, -5.0, 0.0, 5.0, -10.0, 0.0, -6.0, -3.0, 0.0, -5.0, -195.0, -208.0, 0.0, -183.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [9.0, 12.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 0.0, 4.0, 0.0, -8.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -396.0, -369.0, 0.0, 3.0, -12.0, -12.0, -16.0, -20.0, 0.0, 0.0, -20.0, 0.0, 15.0, -13.0, -20.0, -20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -2.0, 0.0, -24.0, 0.0, 2.0, 0.0, 0.0, 0.0, -10.0, 0.0, -400.0, -394.0, 0.0, 10.0, -8.0, 15.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, -20.0, -10.0, -2.0, 0.0, 0.0, -20.0, -12.0, -20.0, -6.0, 0.0, 0.0, 0.0, 0.0, 13.0, -8.0, 0.0, -4.0, 1.0, 0.0, 13.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -13.0, 0.0, 12.0, -19.0, 0.0, 0.0, 3.0, 0.0, -15.0, 0.0, -400.0, 0.0, -6.0, -19.0, -16.0, 12.0, 0.0, 15.0, 0.0, 11.0, 0.0, 0.0, 12.0, -20.0, 0.0, 0.0, 15.0, -382.0, 0.0, 0.0, -4.0, 0.0, -4.0, 13.0, 0.0, 0.0, -20.0, 15.0, -396.0, -378.0, 0.0, -14.0, 0.0, -20.0, -18.0, 0.0, 0.0, -400.0, 0.0, -400.0, -385.0, 0.0, 13.0, 0.0, -400.0, -12.0, 3.0, -28.0, 12.0, 0.0, -4.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, -14.0, -378.0, -20.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 5.0, 0.0, -20.0, 0.0, 0.0, 0.0, -13.0, -6.0, 0.0, 0.0, 0.0, -15.0, 0.0, -9.0, -400.0, -16.0, -400.0, 0.0, 0.0, 0.0, -366.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 13.0, 0.0, 0.0, 0.0, 16.0, 0.0, 18.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 1.0, 10.0, 0.0, 6.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 8.0, 7.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 10.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 2.0, 8.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 198.0, 189.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 10.0, 0.0, 0.0, 200.0, 200.0, 6.0, 0.0, 4.0, 10.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 7.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 10.0, 0.0, 200.0, 14.0, 200.0, 8.0, 0.0, 0.0, 183.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8916451082907454, "mean_inference_ms": 2.367984374171004, "mean_action_processing_ms": 0.4342486511930901, "mean_env_wait_ms": 0.31601885979843974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004697561264038086, "StateBufferConnector_ms": 0.0038733482360839844, "ViewRequirementAgentConnector_ms": 0.1092989444732666}, "num_episodes": 23, "episode_return_max": 21.0, "episode_return_min": -584.0, "episode_return_mean": -34.26, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.7069450643902, "num_env_steps_trained_throughput_per_sec": 321.7069450643902, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 2336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2336000, "timers": {"training_iteration_time_ms": 12559.419, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12559.366, "sample_time_ms": 1600.139, "learn_time_ms": 10936.956, "learn_throughput": 365.732, "synch_weights_time_ms": 19.616}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "done": false, "training_iteration": 146, "trial_id": "e1352_00000", "date": "2024-08-13_17-11-41", "timestamp": 1723583501, "time_this_iter_s": 12.487781047821045, "time_total_s": 2017.231413602829, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2a95940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2017.231413602829, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 50.400000000000006, "ram_util_percent": 83.61666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4439900800733576, "cur_kl_coeff": 0.01235753184662015, "cur_lr": 0.009999999999999998, "total_loss": 0.9244792070653703, "policy_loss": -4.16570638735143e-05, "vf_loss": 0.9245208631195719, "vf_explained_var": -5.8027802321015215e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3138664452966413, "cur_kl_coeff": 2.967284420431606e-19, "cur_lr": 0.009999999999999998, "total_loss": 1.0525465956756046, "policy_loss": 0.0002346357239518689, "vf_loss": 1.052311956030982, "vf_explained_var": -6.149685572064112e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": -584.0, "episode_reward_mean": -38.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -36.845, "predator_policy": 17.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, -5.0, -584.0, 10.0, 11.0, 0.0, -3.0, 0.0, -15.0, -1.0, -10.0, -16.0, -3.0, 0.0, 13.0, 2.0, -1.0, 14.0, -1.0, 0.0, -1.0, -3.0, 12.0, 1.0, 3.0, -5.0, -200.0, -3.0, -7.0, 12.0, 15.0, 11.0, 12.0, -10.0, 15.0, -191.0, -2.0, 4.0, 13.0, -10.0, -183.0, -189.0, -7.0, -27.0, 0.0, -200.0, -575.0, 13.0, 0.0, -3.0, -2.0, -1.0, 7.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, -193.0, -10.0, -5.0, 0.0, 5.0, -10.0, 0.0, -6.0, -3.0, 0.0, -5.0, -195.0, -208.0, 0.0, -183.0, -564.0, 0.0, -8.0, 4.0, -4.0, 7.0, 2.0, 0.0, -184.0, -18.0, 0.0, -191.0, 0.0, -3.0, -7.0, 15.0, 6.0, 8.0, -1.0, 0.0, 0.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, 0.0, 0.0, 0.0, -10.0, 0.0, -400.0, -394.0, 0.0, 10.0, -8.0, 15.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, -20.0, -10.0, -2.0, 0.0, 0.0, -20.0, -12.0, -20.0, -6.0, 0.0, 0.0, 0.0, 0.0, 13.0, -8.0, 0.0, -4.0, 1.0, 0.0, 13.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -13.0, 0.0, 12.0, -19.0, 0.0, 0.0, 3.0, 0.0, -15.0, 0.0, -400.0, 0.0, -6.0, -19.0, -16.0, 12.0, 0.0, 15.0, 0.0, 11.0, 0.0, 0.0, 12.0, -20.0, 0.0, 0.0, 15.0, -382.0, 0.0, 0.0, -4.0, 0.0, -4.0, 13.0, 0.0, 0.0, -20.0, 15.0, -396.0, -378.0, 0.0, -14.0, 0.0, -20.0, -18.0, 0.0, 0.0, -400.0, 0.0, -400.0, -385.0, 0.0, 13.0, 0.0, -400.0, -12.0, 3.0, -28.0, 12.0, 0.0, -4.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, -14.0, -378.0, -20.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 5.0, 0.0, -20.0, 0.0, 0.0, 0.0, -13.0, -6.0, 0.0, 0.0, 0.0, -15.0, 0.0, -9.0, -400.0, -16.0, -400.0, 0.0, 0.0, 0.0, -366.0, -372.0, -384.0, 0.0, 0.0, -16.0, 0.0, 4.0, 0.0, -20.0, 6.0, 6.0, 0.0, -24.0, 8.0, 0.0, 0.0, -375.0, 0.0, -17.0, -25.0, 0.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, -11.0, -14.0, 0.0, 15.0, 0.0, 0.0, 6.0, 8.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -21.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 1.0, 10.0, 0.0, 6.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 8.0, 7.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 10.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 2.0, 8.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 198.0, 189.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 10.0, 0.0, 0.0, 200.0, 200.0, 6.0, 0.0, 4.0, 10.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 7.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 10.0, 0.0, 200.0, 14.0, 200.0, 8.0, 0.0, 0.0, 183.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 10.0, 8.0, 0.0, 0.0, 4.0, 187.0, 10.0, 14.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8892435896156453, "mean_inference_ms": 2.3662547234987166, "mean_action_processing_ms": 0.4329614786376789, "mean_env_wait_ms": 0.31513185303213703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004505038261413574, "StateBufferConnector_ms": 0.0038461685180664062, "ViewRequirementAgentConnector_ms": 0.11280655860900879}, "num_episodes": 22, "episode_return_max": 15.0, "episode_return_min": -584.0, "episode_return_mean": -38.21, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.0749112708599, "num_env_steps_trained_throughput_per_sec": 329.0749112708599, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 12506.715, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12506.663, "sample_time_ms": 1598.458, "learn_time_ms": 10886.27, "learn_throughput": 367.435, "synch_weights_time_ms": 19.274}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 147, "trial_id": "e1352_00000", "date": "2024-08-13_17-11-53", "timestamp": 1723583513, "time_this_iter_s": 12.213346242904663, "time_total_s": 2029.4447598457336, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16dbd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2029.4447598457336, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 50.71176470588235, "ram_util_percent": 83.69411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.361629400474251, "cur_kl_coeff": 0.006178765923310075, "cur_lr": 0.009999999999999998, "total_loss": 0.8899605948142905, "policy_loss": -0.00017974033247107867, "vf_loss": 0.8901403351514428, "vf_explained_var": -5.077432703088831e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0367597895434186, "cur_kl_coeff": 1.483642210215803e-19, "cur_lr": 0.009999999999999998, "total_loss": 0.9185778472552855, "policy_loss": 0.00012750073986512328, "vf_loss": 0.9184503459504673, "vf_explained_var": -5.203580099438864e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": -575.0, "episode_reward_mean": -40.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -40.79, "predator_policy": 20.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, -1.0, 0.0, -1.0, -3.0, 12.0, 1.0, 3.0, -5.0, -200.0, -3.0, -7.0, 12.0, 15.0, 11.0, 12.0, -10.0, 15.0, -191.0, -2.0, 4.0, 13.0, -10.0, -183.0, -189.0, -7.0, -27.0, 0.0, -200.0, -575.0, 13.0, 0.0, -3.0, -2.0, -1.0, 7.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, -193.0, -10.0, -5.0, 0.0, 5.0, -10.0, 0.0, -6.0, -3.0, 0.0, -5.0, -195.0, -208.0, 0.0, -183.0, -564.0, 0.0, -8.0, 4.0, -4.0, 7.0, 2.0, 0.0, -184.0, -18.0, 0.0, -191.0, 0.0, -3.0, -7.0, 15.0, 6.0, 8.0, -1.0, 0.0, 0.0, -1.0, -10.0, -20.0, 5.0, -1.0, 12.0, -8.0, 0.0, 0.0, -182.0, -4.0, -183.0, 0.0, -204.0, -4.0, 0.0, 0.0, -12.0, -195.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 13.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -13.0, 0.0, 12.0, -19.0, 0.0, 0.0, 3.0, 0.0, -15.0, 0.0, -400.0, 0.0, -6.0, -19.0, -16.0, 12.0, 0.0, 15.0, 0.0, 11.0, 0.0, 0.0, 12.0, -20.0, 0.0, 0.0, 15.0, -382.0, 0.0, 0.0, -4.0, 0.0, -4.0, 13.0, 0.0, 0.0, -20.0, 15.0, -396.0, -378.0, 0.0, -14.0, 0.0, -20.0, -18.0, 0.0, 0.0, -400.0, 0.0, -400.0, -385.0, 0.0, 13.0, 0.0, -400.0, -12.0, 3.0, -28.0, 12.0, 0.0, -4.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, -14.0, -378.0, -20.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 5.0, 0.0, -20.0, 0.0, 0.0, 0.0, -13.0, -6.0, 0.0, 0.0, 0.0, -15.0, 0.0, -9.0, -400.0, -16.0, -400.0, 0.0, 0.0, 0.0, -366.0, -372.0, -384.0, 0.0, 0.0, -16.0, 0.0, 4.0, 0.0, -20.0, 6.0, 6.0, 0.0, -24.0, 8.0, 0.0, 0.0, -375.0, 0.0, -17.0, -25.0, 0.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, -11.0, -14.0, 0.0, 15.0, 0.0, 0.0, 6.0, 8.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -21.0, -20.0, 0.0, -15.0, -20.0, 5.0, 0.0, -2.0, 0.0, 12.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, -386.0, 11.0, 0.0, -8.0, -384.0, 9.0, 0.0, 0.0, -400.0, -14.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -19.0, -13.0, -400.0, 0.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 8.0, 7.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 10.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 2.0, 8.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 198.0, 189.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 10.0, 0.0, 0.0, 200.0, 200.0, 6.0, 0.0, 4.0, 10.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 7.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 10.0, 0.0, 200.0, 14.0, 200.0, 8.0, 0.0, 0.0, 183.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 10.0, 8.0, 0.0, 0.0, 4.0, 187.0, 10.0, 14.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 183.0, 10.0, 4.0, 0.0, 0.0, 192.0, 0.0, 0.0, 10.0, 200.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 5.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8885778540959826, "mean_inference_ms": 2.364094855157264, "mean_action_processing_ms": 0.4319631252014723, "mean_env_wait_ms": 0.31480234584547384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256725311279297, "StateBufferConnector_ms": 0.0037908554077148438, "ViewRequirementAgentConnector_ms": 0.1105046272277832}, "num_episodes": 18, "episode_return_max": 15.0, "episode_return_min": -575.0, "episode_return_mean": -40.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.4143440462097, "num_env_steps_trained_throughput_per_sec": 322.4143440462097, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 2368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2368000, "timers": {"training_iteration_time_ms": 12487.509, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12487.454, "sample_time_ms": 1603.913, "learn_time_ms": 10864.094, "learn_throughput": 368.185, "synch_weights_time_ms": 16.901}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "done": false, "training_iteration": 148, "trial_id": "e1352_00000", "date": "2024-08-13_17-12-06", "timestamp": 1723583526, "time_this_iter_s": 12.4689040184021, "time_total_s": 2041.9136638641357, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1710dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2041.9136638641357, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 49.45555555555555, "ram_util_percent": 83.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1860931701039177, "cur_kl_coeff": 0.0030893829616550376, "cur_lr": 0.009999999999999998, "total_loss": 0.77558973193484, "policy_loss": -0.00011672139138219848, "vf_loss": 0.7757064528093136, "vf_explained_var": -8.704170348152282e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.205423902723108, "cur_kl_coeff": 7.418211051079015e-20, "cur_lr": 0.009999999999999998, "total_loss": 0.8235299840884864, "policy_loss": -0.00022135888073573668, "vf_loss": 0.8237513471010421, "vf_explained_var": 4.464485657908929e-05, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": -575.0, "episode_reward_mean": -40.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -40.77, "predator_policy": 20.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.0, -2.0, 4.0, 13.0, -10.0, -183.0, -189.0, -7.0, -27.0, 0.0, -200.0, -575.0, 13.0, 0.0, -3.0, -2.0, -1.0, 7.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, -193.0, -10.0, -5.0, 0.0, 5.0, -10.0, 0.0, -6.0, -3.0, 0.0, -5.0, -195.0, -208.0, 0.0, -183.0, -564.0, 0.0, -8.0, 4.0, -4.0, 7.0, 2.0, 0.0, -184.0, -18.0, 0.0, -191.0, 0.0, -3.0, -7.0, 15.0, 6.0, 8.0, -1.0, 0.0, 0.0, -1.0, -10.0, -20.0, 5.0, -1.0, 12.0, -8.0, 0.0, 0.0, -182.0, -4.0, -183.0, 0.0, -204.0, -4.0, 0.0, 0.0, -12.0, -195.0, -192.0, -5.0, -3.0, 9.0, 0.0, 0.0, 0.0, -4.0, 0.0, 10.0, -7.0, 0.0, 11.0, 0.0, 0.0, 0.0, -4.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-382.0, 0.0, 0.0, -4.0, 0.0, -4.0, 13.0, 0.0, 0.0, -20.0, 15.0, -396.0, -378.0, 0.0, -14.0, 0.0, -20.0, -18.0, 0.0, 0.0, -400.0, 0.0, -400.0, -385.0, 0.0, 13.0, 0.0, -400.0, -12.0, 3.0, -28.0, 12.0, 0.0, -4.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, -14.0, -378.0, -20.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 5.0, 0.0, -20.0, 0.0, 0.0, 0.0, -13.0, -6.0, 0.0, 0.0, 0.0, -15.0, 0.0, -9.0, -400.0, -16.0, -400.0, 0.0, 0.0, 0.0, -366.0, -372.0, -384.0, 0.0, 0.0, -16.0, 0.0, 4.0, 0.0, -20.0, 6.0, 6.0, 0.0, -24.0, 8.0, 0.0, 0.0, -375.0, 0.0, -17.0, -25.0, 0.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, -11.0, -14.0, 0.0, 15.0, 0.0, 0.0, 6.0, 8.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -21.0, -20.0, 0.0, -15.0, -20.0, 5.0, 0.0, -2.0, 0.0, 12.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, -386.0, 11.0, 0.0, -8.0, -384.0, 9.0, 0.0, 0.0, -400.0, -14.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -19.0, -13.0, -400.0, 0.0, -388.0, 0.0, -4.0, -16.0, -12.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 10.0, -17.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0], "policy_predator_policy_reward": [191.0, 0.0, 0.0, 2.0, 8.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 198.0, 189.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 0.0, 0.0, 200.0, 200.0, 10.0, 0.0, 0.0, 200.0, 200.0, 6.0, 0.0, 4.0, 10.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 7.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 10.0, 0.0, 200.0, 14.0, 200.0, 8.0, 0.0, 0.0, 183.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 10.0, 8.0, 0.0, 0.0, 4.0, 187.0, 10.0, 14.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 183.0, 10.0, 4.0, 0.0, 0.0, 192.0, 0.0, 0.0, 10.0, 200.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 5.0, 200.0, 187.0, 9.0, 10.0, 5.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8871838484286263, "mean_inference_ms": 2.362127926499152, "mean_action_processing_ms": 0.4309218822314531, "mean_env_wait_ms": 0.3142375312494333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004420042037963867, "StateBufferConnector_ms": 0.003779292106628418, "ViewRequirementAgentConnector_ms": 0.11310994625091553}, "num_episodes": 18, "episode_return_max": 15.0, "episode_return_min": -575.0, "episode_return_mean": -40.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.65305437271587, "num_env_steps_trained_throughput_per_sec": 333.65305437271587, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 2384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2384000, "timers": {"training_iteration_time_ms": 12388.969, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12388.915, "sample_time_ms": 1513.021, "learn_time_ms": 10858.793, "learn_throughput": 368.365, "synch_weights_time_ms": 14.578}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "done": false, "training_iteration": 149, "trial_id": "e1352_00000", "date": "2024-08-13_17-12-18", "timestamp": 1723583538, "time_this_iter_s": 12.036051988601685, "time_total_s": 2053.9497158527374, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b173bc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2053.9497158527374, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 49.87647058823529, "ram_util_percent": 83.45882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.076508780640843, "cur_kl_coeff": 0.0015446914808275188, "cur_lr": 0.009999999999999998, "total_loss": 1.0137913834481012, "policy_loss": 5.6739548645006915e-05, "vf_loss": 1.0137346405989278, "vf_explained_var": -3.39651864672464e-08, "kl": -9.638560865726255e-48, "entropy": 8.891833381203604e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9530776618366996, "cur_kl_coeff": 3.7091055255395076e-20, "cur_lr": 0.009999999999999998, "total_loss": 1.3525074483245296, "policy_loss": -0.0001291027147244051, "vf_loss": 1.3526365518096894, "vf_explained_var": -8.546486102714741e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": -569.0, "episode_reward_mean": -42.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -40.545, "predator_policy": 19.205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 12.0, 0.0, 0.0, -193.0, -10.0, -5.0, 0.0, 5.0, -10.0, 0.0, -6.0, -3.0, 0.0, -5.0, -195.0, -208.0, 0.0, -183.0, -564.0, 0.0, -8.0, 4.0, -4.0, 7.0, 2.0, 0.0, -184.0, -18.0, 0.0, -191.0, 0.0, -3.0, -7.0, 15.0, 6.0, 8.0, -1.0, 0.0, 0.0, -1.0, -10.0, -20.0, 5.0, -1.0, 12.0, -8.0, 0.0, 0.0, -182.0, -4.0, -183.0, 0.0, -204.0, -4.0, 0.0, 0.0, -12.0, -195.0, -192.0, -5.0, -3.0, 9.0, 0.0, 0.0, 0.0, -4.0, 0.0, 10.0, -7.0, 0.0, 11.0, 0.0, 0.0, 0.0, -4.0, 0.0, -6.0, 0.0, -200.0, 0.0, 5.0, 3.0, 0.0, 15.0, 4.0, 0.0, 9.0, -183.0, -569.0, -200.0, 4.0, -200.0, -10.0, 0.0, -28.0, 0.0, -181.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, -14.0, -378.0, -20.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 5.0, 0.0, -20.0, 0.0, 0.0, 0.0, -13.0, -6.0, 0.0, 0.0, 0.0, -15.0, 0.0, -9.0, -400.0, -16.0, -400.0, 0.0, 0.0, 0.0, -366.0, -372.0, -384.0, 0.0, 0.0, -16.0, 0.0, 4.0, 0.0, -20.0, 6.0, 6.0, 0.0, -24.0, 8.0, 0.0, 0.0, -375.0, 0.0, -17.0, -25.0, 0.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, -11.0, -14.0, 0.0, 15.0, 0.0, 0.0, 6.0, 8.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -21.0, -20.0, 0.0, -15.0, -20.0, 5.0, 0.0, -2.0, 0.0, 12.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, -386.0, 11.0, 0.0, -8.0, -384.0, 9.0, 0.0, 0.0, -400.0, -14.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -19.0, -13.0, -400.0, 0.0, -388.0, 0.0, -4.0, -16.0, -12.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 10.0, -17.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, -20.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 0.0, 0.0, 15.0, -12.0, 0.0, -366.0, -394.0, -373.0, -400.0, 0.0, 4.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, -20.0, -20.0, 0.0, 0.0, 0.0, -371.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 192.0, 7.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 10.0, 0.0, 200.0, 14.0, 200.0, 8.0, 0.0, 0.0, 183.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 10.0, 8.0, 0.0, 0.0, 4.0, 187.0, 10.0, 14.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 183.0, 10.0, 4.0, 0.0, 0.0, 192.0, 0.0, 0.0, 10.0, 200.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 5.0, 200.0, 187.0, 9.0, 10.0, 5.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 183.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 10.0, 180.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8856237703962335, "mean_inference_ms": 2.3597149042226606, "mean_action_processing_ms": 0.42997428894284956, "mean_env_wait_ms": 0.31361325935908924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005101442337036133, "StateBufferConnector_ms": 0.003843069076538086, "ViewRequirementAgentConnector_ms": 0.11188399791717529}, "num_episodes": 23, "episode_return_max": 15.0, "episode_return_min": -569.0, "episode_return_mean": -42.68, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.3456986422525, "num_env_steps_trained_throughput_per_sec": 326.3456986422525, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 12359.187, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12359.133, "sample_time_ms": 1531.832, "learn_time_ms": 10809.913, "learn_throughput": 370.031, "synch_weights_time_ms": 14.867}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 150, "trial_id": "e1352_00000", "date": "2024-08-13_17-12-30", "timestamp": 1723583550, "time_this_iter_s": 12.305746078491211, "time_total_s": 2066.2554619312286, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16dbd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2066.2554619312286, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 53.241176470588236, "ram_util_percent": 83.75294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.426109782757888, "cur_kl_coeff": 0.0007723457404137594, "cur_lr": 0.009999999999999998, "total_loss": 0.6905580068549151, "policy_loss": -9.755966051545724e-05, "vf_loss": 0.6906555653339075, "vf_explained_var": 4.697224450489832e-06, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5877437077859002, "cur_kl_coeff": 1.8545527627697538e-20, "cur_lr": 0.009999999999999998, "total_loss": 0.8843912157708059, "policy_loss": 7.865456741046968e-05, "vf_loss": 0.8843125619437723, "vf_explained_var": 4.3883525505267753e-07, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -569.0, "episode_reward_mean": -39.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.915, "predator_policy": 18.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183.0, -564.0, 0.0, -8.0, 4.0, -4.0, 7.0, 2.0, 0.0, -184.0, -18.0, 0.0, -191.0, 0.0, -3.0, -7.0, 15.0, 6.0, 8.0, -1.0, 0.0, 0.0, -1.0, -10.0, -20.0, 5.0, -1.0, 12.0, -8.0, 0.0, 0.0, -182.0, -4.0, -183.0, 0.0, -204.0, -4.0, 0.0, 0.0, -12.0, -195.0, -192.0, -5.0, -3.0, 9.0, 0.0, 0.0, 0.0, -4.0, 0.0, 10.0, -7.0, 0.0, 11.0, 0.0, 0.0, 0.0, -4.0, 0.0, -6.0, 0.0, -200.0, 0.0, 5.0, 3.0, 0.0, 15.0, 4.0, 0.0, 9.0, -183.0, -569.0, -200.0, 4.0, -200.0, -10.0, 0.0, -28.0, 0.0, -181.0, 0.0, 0.0, 2.0, 0.0, 15.0, -211.0, 0.0, 2.0, 2.0, 0.0, 9.0, 7.0, -6.0, -196.0, 22.0, 0.0, 7.0, 14.0, -4.0, 13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -366.0, -372.0, -384.0, 0.0, 0.0, -16.0, 0.0, 4.0, 0.0, -20.0, 6.0, 6.0, 0.0, -24.0, 8.0, 0.0, 0.0, -375.0, 0.0, -17.0, -25.0, 0.0, 0.0, 0.0, -382.0, 0.0, 0.0, 0.0, -11.0, -14.0, 0.0, 15.0, 0.0, 0.0, 6.0, 8.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -21.0, -20.0, 0.0, -15.0, -20.0, 5.0, 0.0, -2.0, 0.0, 12.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, -386.0, 11.0, 0.0, -8.0, -384.0, 9.0, 0.0, 0.0, -400.0, -14.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -19.0, -13.0, -400.0, 0.0, -388.0, 0.0, -4.0, -16.0, -12.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 10.0, -17.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, -20.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 0.0, 0.0, 15.0, -12.0, 0.0, -366.0, -394.0, -373.0, -400.0, 0.0, 4.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, -20.0, -20.0, 0.0, 0.0, 0.0, -371.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 15.0, 0.0, -19.0, -400.0, 0.0, 0.0, -3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, -12.0, -9.0, -392.0, 7.0, 15.0, 0.0, 0.0, 0.0, 7.0, 14.0, 0.0, -20.0, 6.0, 13.0, 0.0], "policy_predator_policy_reward": [183.0, 0.0, 0.0, 192.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 10.0, 8.0, 0.0, 0.0, 4.0, 187.0, 10.0, 14.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 183.0, 10.0, 4.0, 0.0, 0.0, 192.0, 0.0, 0.0, 10.0, 200.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 5.0, 200.0, 187.0, 9.0, 10.0, 5.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 183.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 10.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 197.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8842488132135076, "mean_inference_ms": 2.3579492190832063, "mean_action_processing_ms": 0.42869618157168077, "mean_env_wait_ms": 0.31312512064514264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004942059516906738, "StateBufferConnector_ms": 0.003525972366333008, "ViewRequirementAgentConnector_ms": 0.13065791130065918}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -569.0, "episode_return_mean": -39.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.1122232312001, "num_env_steps_trained_throughput_per_sec": 319.1122232312001, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 2416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2416000, "timers": {"training_iteration_time_ms": 12354.83, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12354.777, "sample_time_ms": 1547.421, "learn_time_ms": 10790.503, "learn_throughput": 370.696, "synch_weights_time_ms": 14.471}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "done": false, "training_iteration": 151, "trial_id": "e1352_00000", "date": "2024-08-13_17-12-43", "timestamp": 1723583563, "time_this_iter_s": 12.577254056930542, "time_total_s": 2078.832715988159, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17acd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2078.832715988159, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 52.894444444444446, "ram_util_percent": 83.55555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0803707303162713, "cur_kl_coeff": 0.0003861728702068797, "cur_lr": 0.009999999999999998, "total_loss": 0.8378735206114551, "policy_loss": -4.897333149399076e-05, "vf_loss": 0.8379224948782139, "vf_explained_var": -9.334907329902448e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.171853066335565, "cur_kl_coeff": 9.272763813848769e-21, "cur_lr": 0.009999999999999998, "total_loss": 1.368697446080112, "policy_loss": 8.680600446289179e-05, "vf_loss": 1.3686106407768512, "vf_explained_var": -1.0943286633365368e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -572.0, "episode_reward_mean": -41.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.94, "predator_policy": 17.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -10.0, -20.0, 5.0, -1.0, 12.0, -8.0, 0.0, 0.0, -182.0, -4.0, -183.0, 0.0, -204.0, -4.0, 0.0, 0.0, -12.0, -195.0, -192.0, -5.0, -3.0, 9.0, 0.0, 0.0, 0.0, -4.0, 0.0, 10.0, -7.0, 0.0, 11.0, 0.0, 0.0, 0.0, -4.0, 0.0, -6.0, 0.0, -200.0, 0.0, 5.0, 3.0, 0.0, 15.0, 4.0, 0.0, 9.0, -183.0, -569.0, -200.0, 4.0, -200.0, -10.0, 0.0, -28.0, 0.0, -181.0, 0.0, 0.0, 2.0, 0.0, 15.0, -211.0, 0.0, 2.0, 2.0, 0.0, 9.0, 7.0, -6.0, -196.0, 22.0, 0.0, 7.0, 14.0, -4.0, 13.0, 0.0, 0.0, 15.0, 0.0, -9.0, 7.0, -7.0, 1.0, 4.0, 1.0, 2.0, 9.0, -5.0, -570.0, 5.0, 0.0, -572.0, 8.0, -9.0, 0.0, 4.0, -175.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -21.0, -20.0, 0.0, -15.0, -20.0, 5.0, 0.0, -2.0, 0.0, 12.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, 0.0, -386.0, 11.0, 0.0, -8.0, -384.0, 9.0, 0.0, 0.0, -400.0, -14.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -19.0, -13.0, -400.0, 0.0, -388.0, 0.0, -4.0, -16.0, -12.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 10.0, -17.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, -20.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 0.0, 0.0, 15.0, -12.0, 0.0, -366.0, -394.0, -373.0, -400.0, 0.0, 4.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, -20.0, -20.0, 0.0, 0.0, 0.0, -371.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 15.0, 0.0, -19.0, -400.0, 0.0, 0.0, -3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, -12.0, -9.0, -392.0, 7.0, 15.0, 0.0, 0.0, 0.0, 7.0, 14.0, 0.0, -20.0, 6.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -19.0, 7.0, 0.0, -14.0, 0.0, 0.0, -8.0, -27.0, 11.0, 1.0, 0.0, 2.0, 0.0, 9.0, 0.0, -10.0, 0.0, -400.0, -370.0, 15.0, -20.0, 0.0, 0.0, -373.0, -400.0, 6.0, 2.0, -9.0, -20.0, 0.0, 0.0, 0.0, 4.0, -362.0, 0.0], "policy_predator_policy_reward": [10.0, 10.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 183.0, 10.0, 4.0, 0.0, 0.0, 192.0, 0.0, 0.0, 10.0, 200.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 5.0, 200.0, 187.0, 9.0, 10.0, 5.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 183.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 10.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 197.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 9.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 200.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 183.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8836294661214055, "mean_inference_ms": 2.357945289932616, "mean_action_processing_ms": 0.427818130390656, "mean_env_wait_ms": 0.3128899925374617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005025625228881836, "StateBufferConnector_ms": 0.0035380125045776367, "ViewRequirementAgentConnector_ms": 0.13046550750732422}, "num_episodes": 22, "episode_return_max": 22.0, "episode_return_min": -572.0, "episode_return_mean": -41.44, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.89841020485153, "num_env_steps_trained_throughput_per_sec": 312.89841020485153, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 2432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2432000, "timers": {"training_iteration_time_ms": 12384.309, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12384.256, "sample_time_ms": 1664.341, "learn_time_ms": 10702.133, "learn_throughput": 373.757, "synch_weights_time_ms": 15.099}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "done": false, "training_iteration": 152, "trial_id": "e1352_00000", "date": "2024-08-13_17-12-56", "timestamp": 1723583576, "time_this_iter_s": 12.83527398109436, "time_total_s": 2091.6679899692535, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b173bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2091.6679899692535, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 51.349999999999994, "ram_util_percent": 83.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1639966087481413, "cur_kl_coeff": 0.00019308643510343985, "cur_lr": 0.009999999999999998, "total_loss": 0.9112955570694, "policy_loss": 0.00012024211827862673, "vf_loss": 0.9111753169585157, "vf_explained_var": -7.064254195601852e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1421488918722225, "cur_kl_coeff": 4.6363819069243845e-21, "cur_lr": 0.009999999999999998, "total_loss": 1.0250544159875188, "policy_loss": 0.00047160440972124145, "vf_loss": 1.0245828137432456, "vf_explained_var": -4.951285306738798e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -572.0, "episode_reward_mean": -38.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.51, "predator_policy": 16.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-195.0, -192.0, -5.0, -3.0, 9.0, 0.0, 0.0, 0.0, -4.0, 0.0, 10.0, -7.0, 0.0, 11.0, 0.0, 0.0, 0.0, -4.0, 0.0, -6.0, 0.0, -200.0, 0.0, 5.0, 3.0, 0.0, 15.0, 4.0, 0.0, 9.0, -183.0, -569.0, -200.0, 4.0, -200.0, -10.0, 0.0, -28.0, 0.0, -181.0, 0.0, 0.0, 2.0, 0.0, 15.0, -211.0, 0.0, 2.0, 2.0, 0.0, 9.0, 7.0, -6.0, -196.0, 22.0, 0.0, 7.0, 14.0, -4.0, 13.0, 0.0, 0.0, 15.0, 0.0, -9.0, 7.0, -7.0, 1.0, 4.0, 1.0, 2.0, 9.0, -5.0, -570.0, 5.0, 0.0, -572.0, 8.0, -9.0, 0.0, 4.0, -175.0, 0.0, -200.0, 0.0, 15.0, -4.0, 0.0, 14.0, -181.0, -5.0, -21.0, -6.0, 0.0, 0.0, -5.0, 14.0, 16.0, 0.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-400.0, 0.0, -388.0, 0.0, -4.0, -16.0, -12.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 10.0, -17.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, -20.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 0.0, 0.0, 15.0, -12.0, 0.0, -366.0, -394.0, -373.0, -400.0, 0.0, 4.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, -20.0, -20.0, 0.0, 0.0, 0.0, -371.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 15.0, 0.0, -19.0, -400.0, 0.0, 0.0, -3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, -12.0, -9.0, -392.0, 7.0, 15.0, 0.0, 0.0, 0.0, 7.0, 14.0, 0.0, -20.0, 6.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -19.0, 7.0, 0.0, -14.0, 0.0, 0.0, -8.0, -27.0, 11.0, 1.0, 0.0, 2.0, 0.0, 9.0, 0.0, -10.0, 0.0, -400.0, -370.0, 15.0, -20.0, 0.0, 0.0, -373.0, -400.0, 6.0, 2.0, -9.0, -20.0, 0.0, 0.0, 0.0, 4.0, -362.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, -12.0, 0.0, 0.0, 13.0, 0.0, -362.0, 0.0, -15.0, 0.0, -15.0, -20.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 13.0, 0.0, 7.0, 9.0, 0.0, 0.0, -2.0, 15.0], "policy_predator_policy_reward": [5.0, 200.0, 187.0, 9.0, 10.0, 5.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 183.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 10.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 197.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 9.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 200.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 183.0, 4.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 181.0, 0.0, 10.0, 1.0, 13.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8837249201845969, "mean_inference_ms": 2.3595532206423977, "mean_action_processing_ms": 0.42734980183849536, "mean_env_wait_ms": 0.3128496949848061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005069851875305176, "StateBufferConnector_ms": 0.0036357641220092773, "ViewRequirementAgentConnector_ms": 0.14321935176849365}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -572.0, "episode_return_mean": -38.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.507987766421, "num_env_steps_trained_throughput_per_sec": 314.507987766421, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 2448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2448000, "timers": {"training_iteration_time_ms": 12464.081, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12464.024, "sample_time_ms": 1764.469, "learn_time_ms": 10680.013, "learn_throughput": 374.531, "synch_weights_time_ms": 17.213}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "done": false, "training_iteration": 153, "trial_id": "e1352_00000", "date": "2024-08-13_17-13-09", "timestamp": 1723583589, "time_this_iter_s": 12.797428846359253, "time_total_s": 2104.465418815613, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2a44d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2104.465418815613, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 50.12777777777777, "ram_util_percent": 83.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.222199059673462, "cur_kl_coeff": 9.654321755171993e-05, "cur_lr": 0.009999999999999998, "total_loss": 0.7409516049755944, "policy_loss": 3.0030094323650238e-05, "vf_loss": 0.7409215750596511, "vf_explained_var": -4.131327230463583e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0630016286243937, "cur_kl_coeff": 2.3181909534621923e-21, "cur_lr": 0.009999999999999998, "total_loss": 0.7854792878918705, "policy_loss": 8.944926744021436e-05, "vf_loss": 0.7853898358892938, "vf_explained_var": 3.683346289175528e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -572.0, "episode_reward_mean": -40.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -36.99, "predator_policy": 16.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -6.0, 0.0, -200.0, 0.0, 5.0, 3.0, 0.0, 15.0, 4.0, 0.0, 9.0, -183.0, -569.0, -200.0, 4.0, -200.0, -10.0, 0.0, -28.0, 0.0, -181.0, 0.0, 0.0, 2.0, 0.0, 15.0, -211.0, 0.0, 2.0, 2.0, 0.0, 9.0, 7.0, -6.0, -196.0, 22.0, 0.0, 7.0, 14.0, -4.0, 13.0, 0.0, 0.0, 15.0, 0.0, -9.0, 7.0, -7.0, 1.0, 4.0, 1.0, 2.0, 9.0, -5.0, -570.0, 5.0, 0.0, -572.0, 8.0, -9.0, 0.0, 4.0, -175.0, 0.0, -200.0, 0.0, 15.0, -4.0, 0.0, 14.0, -181.0, -5.0, -21.0, -6.0, 0.0, 0.0, -5.0, 14.0, 16.0, 0.0, 14.0, 0.0, 0.0, -1.0, -5.0, 0.0, 1.0, -4.0, 0.0, 0.0, 0.0, 15.0, 0.0, -10.0, 13.0, -168.0, -171.0, -183.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, -20.0, 0.0, 3.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 0.0, 0.0, 15.0, -12.0, 0.0, -366.0, -394.0, -373.0, -400.0, 0.0, 4.0, 0.0, 0.0, -400.0, 0.0, -20.0, 0.0, 0.0, -20.0, -20.0, 0.0, 0.0, 0.0, -371.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 15.0, 0.0, -19.0, -400.0, 0.0, 0.0, -3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, -12.0, -9.0, -392.0, 7.0, 15.0, 0.0, 0.0, 0.0, 7.0, 14.0, 0.0, -20.0, 6.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -19.0, 7.0, 0.0, -14.0, 0.0, 0.0, -8.0, -27.0, 11.0, 1.0, 0.0, 2.0, 0.0, 9.0, 0.0, -10.0, 0.0, -400.0, -370.0, 15.0, -20.0, 0.0, 0.0, -373.0, -400.0, 6.0, 2.0, -9.0, -20.0, 0.0, 0.0, 0.0, 4.0, -362.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, -12.0, 0.0, 0.0, 13.0, 0.0, -362.0, 0.0, -15.0, 0.0, -15.0, -20.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 13.0, 0.0, 7.0, 9.0, 0.0, 0.0, -2.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 5.0, -20.0, 0.0, 0.0, 0.0, 1.0, 5.0, -19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -10.0, 0.0, -20.0, 0.0, 0.0, 13.0, 15.0, -371.0, 15.0, -386.0, 0.0, -366.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 183.0, 0.0, 0.0, 198.0, 0.0, 200.0, 0.0, 0.0, 0.0, 200.0, 10.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 10.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 197.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 9.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 200.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 183.0, 4.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 181.0, 0.0, 10.0, 1.0, 13.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 178.0, 190.0, 10.0, 183.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8840739315383934, "mean_inference_ms": 2.362099435118456, "mean_action_processing_ms": 0.42704236637449455, "mean_env_wait_ms": 0.31292210770784307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048847198486328125, "StateBufferConnector_ms": 0.0036249160766601562, "ViewRequirementAgentConnector_ms": 0.15937161445617676}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -572.0, "episode_return_mean": -40.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.9604672473107, "num_env_steps_trained_throughput_per_sec": 307.9604672473107, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 2464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 12457.117, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12457.059, "sample_time_ms": 1818.045, "learn_time_ms": 10620.041, "learn_throughput": 376.646, "synch_weights_time_ms": 16.65}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "done": false, "training_iteration": 154, "trial_id": "e1352_00000", "date": "2024-08-13_17-13-22", "timestamp": 1723583602, "time_this_iter_s": 13.034170150756836, "time_total_s": 2117.4995889663696, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17acd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2117.4995889663696, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 55.17777777777778, "ram_util_percent": 83.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5340245234346384, "cur_kl_coeff": 4.827160877585996e-05, "cur_lr": 0.009999999999999998, "total_loss": 0.7283890485448181, "policy_loss": 0.0002534610820470979, "vf_loss": 0.7281355862855596, "vf_explained_var": -7.253475290126902e-10, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3903192001027818, "cur_kl_coeff": 1.1590954767310961e-21, "cur_lr": 0.009999999999999998, "total_loss": 1.1260824038691464, "policy_loss": -7.53098224146814e-05, "vf_loss": 1.12615771860515, "vf_explained_var": -1.1227118275152943e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -572.0, "episode_reward_mean": -34.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.29, "predator_policy": 14.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 2.0, 0.0, 15.0, -211.0, 0.0, 2.0, 2.0, 0.0, 9.0, 7.0, -6.0, -196.0, 22.0, 0.0, 7.0, 14.0, -4.0, 13.0, 0.0, 0.0, 15.0, 0.0, -9.0, 7.0, -7.0, 1.0, 4.0, 1.0, 2.0, 9.0, -5.0, -570.0, 5.0, 0.0, -572.0, 8.0, -9.0, 0.0, 4.0, -175.0, 0.0, -200.0, 0.0, 15.0, -4.0, 0.0, 14.0, -181.0, -5.0, -21.0, -6.0, 0.0, 0.0, -5.0, 14.0, 16.0, 0.0, 14.0, 0.0, 0.0, -1.0, -5.0, 0.0, 1.0, -4.0, 0.0, 0.0, 0.0, 15.0, 0.0, -10.0, 13.0, -168.0, -171.0, -183.0, 0.0, -5.0, 0.0, -10.0, -559.0, -173.0, 15.0, 0.0, -10.0, 9.0, 0.0, -200.0, -12.0, 15.0, 12.0, -17.0, -19.0, -8.0, 0.0, -8.0, 27.0, -5.0, 16.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 15.0, 0.0, -19.0, -400.0, 0.0, 0.0, -3.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, -12.0, -9.0, -392.0, 7.0, 15.0, 0.0, 0.0, 0.0, 7.0, 14.0, 0.0, -20.0, 6.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -19.0, 7.0, 0.0, -14.0, 0.0, 0.0, -8.0, -27.0, 11.0, 1.0, 0.0, 2.0, 0.0, 9.0, 0.0, -10.0, 0.0, -400.0, -370.0, 15.0, -20.0, 0.0, 0.0, -373.0, -400.0, 6.0, 2.0, -9.0, -20.0, 0.0, 0.0, 0.0, 4.0, -362.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, -12.0, 0.0, 0.0, 13.0, 0.0, -362.0, 0.0, -15.0, 0.0, -15.0, -20.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 13.0, 0.0, 7.0, 9.0, 0.0, 0.0, -2.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 5.0, -20.0, 0.0, 0.0, 0.0, 1.0, 5.0, -19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -10.0, 0.0, -20.0, 0.0, 0.0, 13.0, 15.0, -371.0, 15.0, -386.0, 0.0, -366.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -20.0, 0.0, -374.0, -374.0, 0.0, -359.0, 0.0, 15.0, 0.0, 0.0, -20.0, 0.0, -6.0, 12.0, 0.0, 0.0, -400.0, 0.0, -16.0, -4.0, 15.0, 0.0, 0.0, 12.0, -34.0, 0.0, -20.0, -18.0, 0.0, -16.0, 0.0, 0.0, -16.0, 0.0, 12.0, 15.0, -10.0, 0.0, 1.0, 15.0, -20.0, 13.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 197.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 196.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 9.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 200.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 183.0, 4.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 181.0, 0.0, 10.0, 1.0, 13.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 178.0, 190.0, 10.0, 183.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 181.0, 8.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 19.0, 8.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.884409815298286, "mean_inference_ms": 2.3648547582417465, "mean_action_processing_ms": 0.42662171713784924, "mean_env_wait_ms": 0.31293158582043645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004040718078613281, "StateBufferConnector_ms": 0.0035153627395629883, "ViewRequirementAgentConnector_ms": 0.15612280368804932}, "num_episodes": 23, "episode_return_max": 27.0, "episode_return_min": -572.0, "episode_return_mean": -34.06, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.9466528407781, "num_env_steps_trained_throughput_per_sec": 324.9466528407781, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 12457.604, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12457.547, "sample_time_ms": 1801.75, "learn_time_ms": 10637.136, "learn_throughput": 376.041, "synch_weights_time_ms": 16.542}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 155, "trial_id": "e1352_00000", "date": "2024-08-13_17-13-34", "timestamp": 1723583614, "time_this_iter_s": 12.352644205093384, "time_total_s": 2129.852233171463, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17c2af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2129.852233171463, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 49.77222222222221, "ram_util_percent": 83.47777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.519294002852107, "cur_kl_coeff": 2.413580438792998e-05, "cur_lr": 0.009999999999999998, "total_loss": 0.6295151204343826, "policy_loss": -0.00022551296894788425, "vf_loss": 0.6297406352701641, "vf_explained_var": 4.5728431176886985e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3117593873489315, "cur_kl_coeff": 5.795477383655481e-22, "cur_lr": 0.009999999999999998, "total_loss": 0.9926012470421416, "policy_loss": 7.148944482049614e-05, "vf_loss": 0.9925297604272605, "vf_explained_var": -8.231117611839658e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -572.0, "episode_reward_mean": -36.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.805, "predator_policy": 13.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -9.0, 7.0, -7.0, 1.0, 4.0, 1.0, 2.0, 9.0, -5.0, -570.0, 5.0, 0.0, -572.0, 8.0, -9.0, 0.0, 4.0, -175.0, 0.0, -200.0, 0.0, 15.0, -4.0, 0.0, 14.0, -181.0, -5.0, -21.0, -6.0, 0.0, 0.0, -5.0, 14.0, 16.0, 0.0, 14.0, 0.0, 0.0, -1.0, -5.0, 0.0, 1.0, -4.0, 0.0, 0.0, 0.0, 15.0, 0.0, -10.0, 13.0, -168.0, -171.0, -183.0, 0.0, -5.0, 0.0, -10.0, -559.0, -173.0, 15.0, 0.0, -10.0, 9.0, 0.0, -200.0, -12.0, 15.0, 12.0, -17.0, -19.0, -8.0, 0.0, -8.0, 27.0, -5.0, 16.0, 3.0, 0.0, -4.0, -10.0, -9.0, 0.0, -9.0, -9.0, 7.0, -1.0, -14.0, 2.0, 0.0, 0.0, -4.0, 0.0, -2.0, 19.0, 15.0, 6.0, -543.0, 0.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -19.0, 7.0, 0.0, -14.0, 0.0, 0.0, -8.0, -27.0, 11.0, 1.0, 0.0, 2.0, 0.0, 9.0, 0.0, -10.0, 0.0, -400.0, -370.0, 15.0, -20.0, 0.0, 0.0, -373.0, -400.0, 6.0, 2.0, -9.0, -20.0, 0.0, 0.0, 0.0, 4.0, -362.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, -12.0, 0.0, 0.0, 13.0, 0.0, -362.0, 0.0, -15.0, 0.0, -15.0, -20.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 13.0, 0.0, 7.0, 9.0, 0.0, 0.0, -2.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 5.0, -20.0, 0.0, 0.0, 0.0, 1.0, 5.0, -19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -10.0, 0.0, -20.0, 0.0, 0.0, 13.0, 15.0, -371.0, 15.0, -386.0, 0.0, -366.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -20.0, 0.0, -374.0, -374.0, 0.0, -359.0, 0.0, 15.0, 0.0, 0.0, -20.0, 0.0, -6.0, 12.0, 0.0, 0.0, -400.0, 0.0, -16.0, -4.0, 15.0, 0.0, 0.0, 12.0, -34.0, 0.0, -20.0, -18.0, 0.0, -16.0, 0.0, 0.0, -16.0, 0.0, 12.0, 15.0, -10.0, 0.0, 1.0, 15.0, -20.0, 13.0, 0.0, 0.0, 0.0, -14.0, -20.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, -19.0, -6.0, -16.0, 0.0, 7.0, -2.0, 0.0, -12.0, -16.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, -6.0, -2.0, 15.0, -16.0, 15.0, 0.0, 6.0, 0.0, -343.0, -400.0, 0.0, 0.0, 0.0, 14.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 9.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 200.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 183.0, 4.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 181.0, 0.0, 10.0, 1.0, 13.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 178.0, 190.0, 10.0, 183.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 181.0, 8.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 19.0, 8.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 3.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 3.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8838328270462421, "mean_inference_ms": 2.367660628931569, "mean_action_processing_ms": 0.4261802472008542, "mean_env_wait_ms": 0.31269535518304664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004111886024475098, "StateBufferConnector_ms": 0.003610849380493164, "ViewRequirementAgentConnector_ms": 0.14786803722381592}, "num_episodes": 22, "episode_return_max": 27.0, "episode_return_min": -572.0, "episode_return_mean": -36.39, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.01373456845465, "num_env_steps_trained_throughput_per_sec": 315.01373456845465, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 2496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 12484.022, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12483.965, "sample_time_ms": 1799.175, "learn_time_ms": 10665.96, "learn_throughput": 375.025, "synch_weights_time_ms": 16.771}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "done": false, "training_iteration": 156, "trial_id": "e1352_00000", "date": "2024-08-13_17-13-47", "timestamp": 1723583627, "time_this_iter_s": 12.738417148590088, "time_total_s": 2142.590650320053, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17c2d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2142.590650320053, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 53.099999999999994, "ram_util_percent": 83.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.100937597042876, "cur_kl_coeff": 1.206790219396499e-05, "cur_lr": 0.009999999999999998, "total_loss": 0.9985165298615813, "policy_loss": -5.362072057785496e-05, "vf_loss": 0.9985701477874523, "vf_explained_var": -8.104970215489625e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3928638821262647, "cur_kl_coeff": 2.8977386918277403e-22, "cur_lr": 0.009999999999999998, "total_loss": 1.095131524924248, "policy_loss": -0.0001947784269100459, "vf_loss": 1.0953263044436141, "vf_explained_var": -6.843496251989294e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -559.0, "episode_reward_mean": -32.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.405, "predator_policy": 15.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.0, 0.0, -200.0, 0.0, 15.0, -4.0, 0.0, 14.0, -181.0, -5.0, -21.0, -6.0, 0.0, 0.0, -5.0, 14.0, 16.0, 0.0, 14.0, 0.0, 0.0, -1.0, -5.0, 0.0, 1.0, -4.0, 0.0, 0.0, 0.0, 15.0, 0.0, -10.0, 13.0, -168.0, -171.0, -183.0, 0.0, -5.0, 0.0, -10.0, -559.0, -173.0, 15.0, 0.0, -10.0, 9.0, 0.0, -200.0, -12.0, 15.0, 12.0, -17.0, -19.0, -8.0, 0.0, -8.0, 27.0, -5.0, 16.0, 3.0, 0.0, -4.0, -10.0, -9.0, 0.0, -9.0, -9.0, 7.0, -1.0, -14.0, 2.0, 0.0, 0.0, -4.0, 0.0, -2.0, 19.0, 15.0, 6.0, -543.0, 0.0, 14.0, 4.0, 9.0, -1.0, -28.0, 2.0, 1.0, 11.0, 6.0, -360.0, -7.0, 15.0, 3.0, -199.0, 15.0, -10.0, -184.0, 12.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-362.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 15.0, 0.0, -8.0, -12.0, 0.0, 0.0, 13.0, 0.0, -362.0, 0.0, -15.0, 0.0, -15.0, -20.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 13.0, 0.0, 7.0, 9.0, 0.0, 0.0, -2.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 5.0, -20.0, 0.0, 0.0, 0.0, 1.0, 5.0, -19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -10.0, 0.0, -20.0, 0.0, 0.0, 13.0, 15.0, -371.0, 15.0, -386.0, 0.0, -366.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -20.0, 0.0, -374.0, -374.0, 0.0, -359.0, 0.0, 15.0, 0.0, 0.0, -20.0, 0.0, -6.0, 12.0, 0.0, 0.0, -400.0, 0.0, -16.0, -4.0, 15.0, 0.0, 0.0, 12.0, -34.0, 0.0, -20.0, -18.0, 0.0, -16.0, 0.0, 0.0, -16.0, 0.0, 12.0, 15.0, -10.0, 0.0, 1.0, 15.0, -20.0, 13.0, 0.0, 0.0, 0.0, -14.0, -20.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, -19.0, -6.0, -16.0, 0.0, 7.0, -2.0, 0.0, -12.0, -16.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, -6.0, -2.0, 15.0, -16.0, 15.0, 0.0, 6.0, 0.0, -343.0, -400.0, 0.0, 0.0, 0.0, 14.0, 4.0, 0.0, 9.0, 0.0, -3.0, 0.0, -20.0, -38.0, -18.0, 0.0, 0.0, -2.0, 15.0, -8.0, 0.0, 6.0, -372.0, -360.0, 1.0, -16.0, 0.0, 15.0, 3.0, 0.0, 0.0, -398.0, 8.0, 5.0, 0.0, -20.0, -368.0, 0.0, 0.0, 9.0, 0.0, 15.0], "policy_predator_policy_reward": [183.0, 4.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 181.0, 0.0, 10.0, 1.0, 13.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 178.0, 190.0, 10.0, 183.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 181.0, 8.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 19.0, 8.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 3.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 3.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 20.0, 10.0, 10.0, 10.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 186.0, 186.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 2.0, 0.0, 0.0, 10.0, 184.0, 0.0, 3.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8840049049330685, "mean_inference_ms": 2.367284127943112, "mean_action_processing_ms": 0.4256476159843525, "mean_env_wait_ms": 0.3126102732812045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004012942314147949, "StateBufferConnector_ms": 0.0035424232482910156, "ViewRequirementAgentConnector_ms": 0.14410841464996338}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -559.0, "episode_return_mean": -32.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.5898851386003, "num_env_steps_trained_throughput_per_sec": 331.5898851386003, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 2512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2512000, "timers": {"training_iteration_time_ms": 12474.803, "restore_workers_time_ms": 0.018, "training_step_time_ms": 12474.746, "sample_time_ms": 1798.843, "learn_time_ms": 10656.129, "learn_throughput": 375.371, "synch_weights_time_ms": 17.391}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "done": false, "training_iteration": 157, "trial_id": "e1352_00000", "date": "2024-08-13_17-13-59", "timestamp": 1723583639, "time_this_iter_s": 12.09596586227417, "time_total_s": 2154.6866161823273, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1788820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2154.6866161823273, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 48.211764705882345, "ram_util_percent": 83.61176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.22313411100786, "cur_kl_coeff": 6.033951096982495e-06, "cur_lr": 0.009999999999999998, "total_loss": 0.9210605619918733, "policy_loss": 5.765014017621676e-05, "vf_loss": 0.9210029099353407, "vf_explained_var": -6.118148722976604e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.134775984475282, "cur_kl_coeff": 1.4488693459138702e-22, "cur_lr": 0.009999999999999998, "total_loss": 1.0245703295819344, "policy_loss": -8.326439536792576e-05, "vf_loss": 1.024653589347052, "vf_explained_var": -7.505770082826967e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -559.0, "episode_reward_mean": -31.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.045, "predator_policy": 15.355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 0.0, 0.0, -1.0, -5.0, 0.0, 1.0, -4.0, 0.0, 0.0, 0.0, 15.0, 0.0, -10.0, 13.0, -168.0, -171.0, -183.0, 0.0, -5.0, 0.0, -10.0, -559.0, -173.0, 15.0, 0.0, -10.0, 9.0, 0.0, -200.0, -12.0, 15.0, 12.0, -17.0, -19.0, -8.0, 0.0, -8.0, 27.0, -5.0, 16.0, 3.0, 0.0, -4.0, -10.0, -9.0, 0.0, -9.0, -9.0, 7.0, -1.0, -14.0, 2.0, 0.0, 0.0, -4.0, 0.0, -2.0, 19.0, 15.0, 6.0, -543.0, 0.0, 14.0, 4.0, 9.0, -1.0, -28.0, 2.0, 1.0, 11.0, 6.0, -360.0, -7.0, 15.0, 3.0, -199.0, 15.0, -10.0, -184.0, 12.0, 15.0, -7.0, 22.0, -1.0, -1.0, 0.0, -8.0, 0.0, -357.0, 15.0, 11.0, -177.0, 0.0, 11.0, -9.0, 20.0, -5.0, 8.0, 6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 5.0, -20.0, 0.0, 0.0, 0.0, 1.0, 5.0, -19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, -10.0, 0.0, -20.0, 0.0, 0.0, 13.0, 15.0, -371.0, 15.0, -386.0, 0.0, -366.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -20.0, 0.0, -374.0, -374.0, 0.0, -359.0, 0.0, 15.0, 0.0, 0.0, -20.0, 0.0, -6.0, 12.0, 0.0, 0.0, -400.0, 0.0, -16.0, -4.0, 15.0, 0.0, 0.0, 12.0, -34.0, 0.0, -20.0, -18.0, 0.0, -16.0, 0.0, 0.0, -16.0, 0.0, 12.0, 15.0, -10.0, 0.0, 1.0, 15.0, -20.0, 13.0, 0.0, 0.0, 0.0, -14.0, -20.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, -19.0, -6.0, -16.0, 0.0, 7.0, -2.0, 0.0, -12.0, -16.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, -6.0, -2.0, 15.0, -16.0, 15.0, 0.0, 6.0, 0.0, -343.0, -400.0, 0.0, 0.0, 0.0, 14.0, 4.0, 0.0, 9.0, 0.0, -3.0, 0.0, -20.0, -38.0, -18.0, 0.0, 0.0, -2.0, 15.0, -8.0, 0.0, 6.0, -372.0, -360.0, 1.0, -16.0, 0.0, 15.0, 3.0, 0.0, 0.0, -398.0, 8.0, 5.0, 0.0, -20.0, -368.0, 0.0, 0.0, 9.0, 0.0, 15.0, -17.0, 0.0, 11.0, 11.0, -2.0, 0.0, 1.0, -12.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, -361.0, -373.0, 15.0, 0.0, 4.0, 7.0, 0.0, -366.0, 0.0, 0.0, 0.0, 11.0, -26.0, 0.0, 15.0, 5.0, -15.0, 0.0, 8.0, 0.0, -14.0, 10.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 178.0, 190.0, 10.0, 183.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 181.0, 8.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 19.0, 8.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 3.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 3.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 20.0, 10.0, 10.0, 10.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 186.0, 186.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 2.0, 0.0, 0.0, 10.0, 184.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 187.0, 190.0, 0.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8828196317547884, "mean_inference_ms": 2.3658520184955836, "mean_action_processing_ms": 0.42482935993554777, "mean_env_wait_ms": 0.3121481183080216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004060983657836914, "StateBufferConnector_ms": 0.0034008026123046875, "ViewRequirementAgentConnector_ms": 0.1348499059677124}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -559.0, "episode_return_mean": -31.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.8406196664075, "num_env_steps_trained_throughput_per_sec": 326.8406196664075, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 2528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2528000, "timers": {"training_iteration_time_ms": 12458.001, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12457.948, "sample_time_ms": 1790.112, "learn_time_ms": 10647.534, "learn_throughput": 375.674, "synch_weights_time_ms": 17.878}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "done": false, "training_iteration": 158, "trial_id": "e1352_00000", "date": "2024-08-13_17-14-11", "timestamp": 1723583651, "time_this_iter_s": 12.2779541015625, "time_total_s": 2166.9645702838898, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1788b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2166.9645702838898, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 48.747058823529414, "ram_util_percent": 83.6470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3235658675129773, "cur_kl_coeff": 3.0169755484912477e-06, "cur_lr": 0.009999999999999998, "total_loss": 0.4348463253290565, "policy_loss": -7.436101142533873e-05, "vf_loss": 0.43492068593777106, "vf_explained_var": 3.4603176924286698e-06, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.092374361764206, "cur_kl_coeff": 7.244346729569351e-23, "cur_lr": 0.009999999999999998, "total_loss": 0.488169912021686, "policy_loss": -4.6801945273444136e-05, "vf_loss": 0.48821671357899304, "vf_explained_var": 5.0894103983722665e-05, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -559.0, "episode_reward_mean": -28.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -27.645, "predator_policy": 13.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -5.0, 0.0, -10.0, -559.0, -173.0, 15.0, 0.0, -10.0, 9.0, 0.0, -200.0, -12.0, 15.0, 12.0, -17.0, -19.0, -8.0, 0.0, -8.0, 27.0, -5.0, 16.0, 3.0, 0.0, -4.0, -10.0, -9.0, 0.0, -9.0, -9.0, 7.0, -1.0, -14.0, 2.0, 0.0, 0.0, -4.0, 0.0, -2.0, 19.0, 15.0, 6.0, -543.0, 0.0, 14.0, 4.0, 9.0, -1.0, -28.0, 2.0, 1.0, 11.0, 6.0, -360.0, -7.0, 15.0, 3.0, -199.0, 15.0, -10.0, -184.0, 12.0, 15.0, -7.0, 22.0, -1.0, -1.0, 0.0, -8.0, 0.0, -357.0, 15.0, 11.0, -177.0, 0.0, 11.0, -9.0, 20.0, -5.0, 8.0, 6.0, -4.0, -2.0, 28.0, -8.0, 0.0, 0.0, 3.0, 5.0, 0.0, -10.0, 0.0, 0.0, -200.0, 0.0, 12.0, 0.0, -6.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -20.0, 0.0, -374.0, -374.0, 0.0, -359.0, 0.0, 15.0, 0.0, 0.0, -20.0, 0.0, -6.0, 12.0, 0.0, 0.0, -400.0, 0.0, -16.0, -4.0, 15.0, 0.0, 0.0, 12.0, -34.0, 0.0, -20.0, -18.0, 0.0, -16.0, 0.0, 0.0, -16.0, 0.0, 12.0, 15.0, -10.0, 0.0, 1.0, 15.0, -20.0, 13.0, 0.0, 0.0, 0.0, -14.0, -20.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, -19.0, -6.0, -16.0, 0.0, 7.0, -2.0, 0.0, -12.0, -16.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, -6.0, -2.0, 15.0, -16.0, 15.0, 0.0, 6.0, 0.0, -343.0, -400.0, 0.0, 0.0, 0.0, 14.0, 4.0, 0.0, 9.0, 0.0, -3.0, 0.0, -20.0, -38.0, -18.0, 0.0, 0.0, -2.0, 15.0, -8.0, 0.0, 6.0, -372.0, -360.0, 1.0, -16.0, 0.0, 15.0, 3.0, 0.0, 0.0, -398.0, 8.0, 5.0, 0.0, -20.0, -368.0, 0.0, 0.0, 9.0, 0.0, 15.0, -17.0, 0.0, 11.0, 11.0, -2.0, 0.0, 1.0, -12.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, -361.0, -373.0, 15.0, 0.0, 4.0, 7.0, 0.0, -366.0, 0.0, 0.0, 0.0, 11.0, -26.0, 0.0, 15.0, 5.0, -15.0, 0.0, 8.0, 0.0, -14.0, 10.0, 0.0, -8.0, 0.0, -4.0, 15.0, 13.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -10.0, 15.0, 0.0, 0.0, -16.0, 0.0, -8.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 181.0, 8.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 200.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 19.0, 8.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 3.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 3.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 20.0, 10.0, 10.0, 10.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 186.0, 186.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 2.0, 0.0, 0.0, 10.0, 184.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 187.0, 190.0, 0.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8813962184070957, "mean_inference_ms": 2.363582154392528, "mean_action_processing_ms": 0.42387243610873226, "mean_env_wait_ms": 0.3115960720935411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049217939376831055, "StateBufferConnector_ms": 0.003412961959838867, "ViewRequirementAgentConnector_ms": 0.11683452129364014}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -559.0, "episode_return_mean": -28.25, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.6247214768852, "num_env_steps_trained_throughput_per_sec": 329.6247214768852, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 2544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2544000, "timers": {"training_iteration_time_ms": 12472.652, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12472.599, "sample_time_ms": 1797.548, "learn_time_ms": 10654.77, "learn_throughput": 375.419, "synch_weights_time_ms": 17.853}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "done": false, "training_iteration": 159, "trial_id": "e1352_00000", "date": "2024-08-13_17-14-24", "timestamp": 1723583664, "time_this_iter_s": 12.179980039596558, "time_total_s": 2179.1445503234863, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15d8a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2179.1445503234863, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 51.629411764705885, "ram_util_percent": 83.55294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.408789212501142, "cur_kl_coeff": 1.5084877742456238e-06, "cur_lr": 0.009999999999999998, "total_loss": 1.156943464436859, "policy_loss": -0.00019821066830662035, "vf_loss": 1.1571416755990376, "vf_explained_var": -9.240296782639923e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1102460982097977, "cur_kl_coeff": 3.6221733647846754e-23, "cur_lr": 0.009999999999999998, "total_loss": 1.724439205552535, "policy_loss": -0.00040412194677012624, "vf_loss": 1.7248433253437123, "vf_explained_var": -6.307369817501653e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -576.0, "episode_reward_mean": -36.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -33.755, "predator_policy": 15.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, 0.0, -9.0, -9.0, 7.0, -1.0, -14.0, 2.0, 0.0, 0.0, -4.0, 0.0, -2.0, 19.0, 15.0, 6.0, -543.0, 0.0, 14.0, 4.0, 9.0, -1.0, -28.0, 2.0, 1.0, 11.0, 6.0, -360.0, -7.0, 15.0, 3.0, -199.0, 15.0, -10.0, -184.0, 12.0, 15.0, -7.0, 22.0, -1.0, -1.0, 0.0, -8.0, 0.0, -357.0, 15.0, 11.0, -177.0, 0.0, 11.0, -9.0, 20.0, -5.0, 8.0, 6.0, -4.0, -2.0, 28.0, -8.0, 0.0, 0.0, 3.0, 5.0, 0.0, -10.0, 0.0, 0.0, -200.0, 0.0, 12.0, 0.0, -6.0, -4.0, -20.0, 0.0, 11.0, 0.0, -201.0, -576.0, -7.0, 0.0, -10.0, 12.0, 0.0, -189.0, -10.0, 0.0, -573.0, 0.0, 0.0, 4.0, -7.0, -4.0, -10.0, -171.0, 2.0, -6.0, 0.0, -7.0, 7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -19.0, 0.0, 0.0, 0.0, -19.0, -6.0, -16.0, 0.0, 7.0, -2.0, 0.0, -12.0, -16.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, -6.0, -2.0, 15.0, -16.0, 15.0, 0.0, 6.0, 0.0, -343.0, -400.0, 0.0, 0.0, 0.0, 14.0, 4.0, 0.0, 9.0, 0.0, -3.0, 0.0, -20.0, -38.0, -18.0, 0.0, 0.0, -2.0, 15.0, -8.0, 0.0, 6.0, -372.0, -360.0, 1.0, -16.0, 0.0, 15.0, 3.0, 0.0, 0.0, -398.0, 8.0, 5.0, 0.0, -20.0, -368.0, 0.0, 0.0, 9.0, 0.0, 15.0, -17.0, 0.0, 11.0, 11.0, -2.0, 0.0, 1.0, -12.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, -361.0, -373.0, 15.0, 0.0, 4.0, 7.0, 0.0, -366.0, 0.0, 0.0, 0.0, 11.0, -26.0, 0.0, 15.0, 5.0, -15.0, 0.0, 8.0, 0.0, -14.0, 10.0, 0.0, -8.0, 0.0, -4.0, 15.0, 13.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -10.0, 15.0, 0.0, 0.0, -16.0, 0.0, -8.0, 0.0, -18.0, -16.0, 10.0, -20.0, 0.0, 11.0, 0.0, 0.0, -394.0, -10.0, -394.0, -380.0, 7.0, -28.0, 0.0, 0.0, -20.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, -378.0, 0.0, -20.0, 0.0, 0.0, -373.0, -400.0, 0.0, 0.0, 0.0, 0.0, -28.0, 15.0, 0.0, -23.0, -10.0, 0.0, 0.0, -20.0, 13.0, -368.0, 1.0, -8.0, 0.0, -12.0, 0.0, 0.0, -13.0, -8.0, 4.0, 0.0], "policy_predator_policy_reward": [0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 3.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 3.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 20.0, 10.0, 10.0, 10.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 186.0, 186.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 2.0, 0.0, 0.0, 10.0, 184.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 187.0, 190.0, 0.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 198.0, 5.0, 198.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 179.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 6.0, 10.0, 6.0, 0.0, 10.0, 0.0, 184.0, 0.0, 9.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8786187546425909, "mean_inference_ms": 2.360939442949789, "mean_action_processing_ms": 0.42241240184112294, "mean_env_wait_ms": 0.31061542850481627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0080796480178833, "StateBufferConnector_ms": 0.004297375679016113, "ViewRequirementAgentConnector_ms": 0.1292027235031128}, "num_episodes": 27, "episode_return_max": 28.0, "episode_return_min": -576.0, "episode_return_mean": -36.37, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.06908755971347, "num_env_steps_trained_throughput_per_sec": 338.06908755971347, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 12430.148, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12430.094, "sample_time_ms": 1774.633, "learn_time_ms": 10635.0, "learn_throughput": 376.117, "synch_weights_time_ms": 18.006}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 160, "trial_id": "e1352_00000", "date": "2024-08-13_17-14-36", "timestamp": 1723583676, "time_this_iter_s": 11.881721258163452, "time_total_s": 2191.02627158165, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15dbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2191.02627158165, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 48.088235294117645, "ram_util_percent": 83.50588235294119}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.456209796966699, "cur_kl_coeff": 7.542438871228119e-07, "cur_lr": 0.009999999999999998, "total_loss": 0.9117695574407224, "policy_loss": -0.0002332665329237306, "vf_loss": 0.9120028241522729, "vf_explained_var": -8.483412404539724e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.39471792004049, "cur_kl_coeff": 1.8110866823923377e-23, "cur_lr": 0.009999999999999998, "total_loss": 0.9905764024803247, "policy_loss": 6.636104511993902e-06, "vf_loss": 0.9905697644387603, "vf_explained_var": -1.002871800982763e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -576.0, "episode_reward_mean": -37.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.995, "predator_policy": 17.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 4.0, 9.0, -1.0, -28.0, 2.0, 1.0, 11.0, 6.0, -360.0, -7.0, 15.0, 3.0, -199.0, 15.0, -10.0, -184.0, 12.0, 15.0, -7.0, 22.0, -1.0, -1.0, 0.0, -8.0, 0.0, -357.0, 15.0, 11.0, -177.0, 0.0, 11.0, -9.0, 20.0, -5.0, 8.0, 6.0, -4.0, -2.0, 28.0, -8.0, 0.0, 0.0, 3.0, 5.0, 0.0, -10.0, 0.0, 0.0, -200.0, 0.0, 12.0, 0.0, -6.0, -4.0, -20.0, 0.0, 11.0, 0.0, -201.0, -576.0, -7.0, 0.0, -10.0, 12.0, 0.0, -189.0, -10.0, 0.0, -573.0, 0.0, 0.0, 4.0, -7.0, -4.0, -10.0, -171.0, 2.0, -6.0, 0.0, -7.0, 7.0, -15.0, -10.0, 3.0, -19.0, 4.0, -200.0, -10.0, 10.0, 0.0, 0.0, -10.0, -7.0, 0.0, 0.0, 0.0, -10.0, 0.0, -356.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 14.0, 4.0, 0.0, 9.0, 0.0, -3.0, 0.0, -20.0, -38.0, -18.0, 0.0, 0.0, -2.0, 15.0, -8.0, 0.0, 6.0, -372.0, -360.0, 1.0, -16.0, 0.0, 15.0, 3.0, 0.0, 0.0, -398.0, 8.0, 5.0, 0.0, -20.0, -368.0, 0.0, 0.0, 9.0, 0.0, 15.0, -17.0, 0.0, 11.0, 11.0, -2.0, 0.0, 1.0, -12.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, -361.0, -373.0, 15.0, 0.0, 4.0, 7.0, 0.0, -366.0, 0.0, 0.0, 0.0, 11.0, -26.0, 0.0, 15.0, 5.0, -15.0, 0.0, 8.0, 0.0, -14.0, 10.0, 0.0, -8.0, 0.0, -4.0, 15.0, 13.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -10.0, 15.0, 0.0, 0.0, -16.0, 0.0, -8.0, 0.0, -18.0, -16.0, 10.0, -20.0, 0.0, 11.0, 0.0, 0.0, -394.0, -10.0, -394.0, -380.0, 7.0, -28.0, 0.0, 0.0, -20.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, -378.0, 0.0, -20.0, 0.0, 0.0, -373.0, -400.0, 0.0, 0.0, 0.0, 0.0, -28.0, 15.0, 0.0, -23.0, -10.0, 0.0, 0.0, -20.0, 13.0, -368.0, 1.0, -8.0, 0.0, -12.0, 0.0, 0.0, -13.0, -8.0, 4.0, 0.0, -12.0, -18.0, 0.0, -20.0, 3.0, 0.0, -19.0, -20.0, 4.0, 0.0, -400.0, 0.0, -14.0, -7.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -384.0, -343.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 20.0, 10.0, 10.0, 10.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 186.0, 186.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 2.0, 0.0, 0.0, 10.0, 184.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 187.0, 190.0, 0.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 198.0, 5.0, 198.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 179.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 6.0, 10.0, 6.0, 0.0, 10.0, 0.0, 184.0, 0.0, 9.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 3.0, 0.0, 6.0, 9.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 192.0, 179.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8779757238587439, "mean_inference_ms": 2.358237307494275, "mean_action_processing_ms": 0.42150218037041426, "mean_env_wait_ms": 0.3102773608491962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009085536003112793, "StateBufferConnector_ms": 0.004191040992736816, "ViewRequirementAgentConnector_ms": 0.11897933483123779}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -576.0, "episode_return_mean": -37.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.7955849997243, "num_env_steps_trained_throughput_per_sec": 323.7955849997243, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 2576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2576000, "timers": {"training_iteration_time_ms": 12412.018, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12411.964, "sample_time_ms": 1747.858, "learn_time_ms": 10642.938, "learn_throughput": 375.836, "synch_weights_time_ms": 18.306}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "done": false, "training_iteration": 161, "trial_id": "e1352_00000", "date": "2024-08-13_17-14-48", "timestamp": 1723583688, "time_this_iter_s": 12.39444088935852, "time_total_s": 2203.4207124710083, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17acd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2203.4207124710083, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 51.25555555555555, "ram_util_percent": 83.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1630197044629833, "cur_kl_coeff": 3.7712194356140596e-07, "cur_lr": 0.009999999999999998, "total_loss": 0.35861128705046164, "policy_loss": -0.0004387726859440879, "vf_loss": 0.3590500613628842, "vf_explained_var": 0.0024414367776699167, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3175335988155368, "cur_kl_coeff": 9.055433411961689e-24, "cur_lr": 0.009999999999999998, "total_loss": 0.6809626848658635, "policy_loss": 8.0853537533176e-05, "vf_loss": 0.6808818322167826, "vf_explained_var": 3.1536849087508265e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -576.0, "episode_reward_mean": -34.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.98, "predator_policy": 14.545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -7.0, 22.0, -1.0, -1.0, 0.0, -8.0, 0.0, -357.0, 15.0, 11.0, -177.0, 0.0, 11.0, -9.0, 20.0, -5.0, 8.0, 6.0, -4.0, -2.0, 28.0, -8.0, 0.0, 0.0, 3.0, 5.0, 0.0, -10.0, 0.0, 0.0, -200.0, 0.0, 12.0, 0.0, -6.0, -4.0, -20.0, 0.0, 11.0, 0.0, -201.0, -576.0, -7.0, 0.0, -10.0, 12.0, 0.0, -189.0, -10.0, 0.0, -573.0, 0.0, 0.0, 4.0, -7.0, -4.0, -10.0, -171.0, 2.0, -6.0, 0.0, -7.0, 7.0, -15.0, -10.0, 3.0, -19.0, 4.0, -200.0, -10.0, 10.0, 0.0, 0.0, -10.0, -7.0, 0.0, 0.0, 0.0, -10.0, 0.0, -356.0, -2.0, 15.0, 18.0, 0.0, 0.0, 2.0, 15.0, 11.0, 5.0, -3.0, 0.0, -562.0, -10.0, 1.0, 9.0, 15.0, 19.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 15.0, -17.0, 0.0, 11.0, 11.0, -2.0, 0.0, 1.0, -12.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, -361.0, -373.0, 15.0, 0.0, 4.0, 7.0, 0.0, -366.0, 0.0, 0.0, 0.0, 11.0, -26.0, 0.0, 15.0, 5.0, -15.0, 0.0, 8.0, 0.0, -14.0, 10.0, 0.0, -8.0, 0.0, -4.0, 15.0, 13.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -10.0, 15.0, 0.0, 0.0, -16.0, 0.0, -8.0, 0.0, -18.0, -16.0, 10.0, -20.0, 0.0, 11.0, 0.0, 0.0, -394.0, -10.0, -394.0, -380.0, 7.0, -28.0, 0.0, 0.0, -20.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, -378.0, 0.0, -20.0, 0.0, 0.0, -373.0, -400.0, 0.0, 0.0, 0.0, 0.0, -28.0, 15.0, 0.0, -23.0, -10.0, 0.0, 0.0, -20.0, 13.0, -368.0, 1.0, -8.0, 0.0, -12.0, 0.0, 0.0, -13.0, -8.0, 4.0, 0.0, -12.0, -18.0, 0.0, -20.0, 3.0, 0.0, -19.0, -20.0, 4.0, 0.0, -400.0, 0.0, -14.0, -7.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -384.0, -343.0, -4.0, 0.0, 15.0, 0.0, 12.0, 6.0, 7.0, -14.0, 0.0, 0.0, 2.0, 0.0, 0.0, 15.0, 0.0, 11.0, 0.0, 5.0, -6.0, 0.0, 0.0, 0.0, -400.0, -362.0, -20.0, 0.0, 0.0, 1.0, 9.0, 0.0, 0.0, 15.0, -16.0, 15.0, -22.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 187.0, 190.0, 0.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 0.0, 0.0, 0.0, 7.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 198.0, 5.0, 198.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 179.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 6.0, 10.0, 6.0, 0.0, 10.0, 0.0, 184.0, 0.0, 9.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 3.0, 0.0, 6.0, 9.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 192.0, 179.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8766322972228441, "mean_inference_ms": 2.356176006448628, "mean_action_processing_ms": 0.4205621388618536, "mean_env_wait_ms": 0.30974580000921287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009466409683227539, "StateBufferConnector_ms": 0.00435948371887207, "ViewRequirementAgentConnector_ms": 0.11807751655578613}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -576.0, "episode_return_mean": -34.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.99066918206705, "num_env_steps_trained_throughput_per_sec": 326.99066918206705, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 2592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 12356.924, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12356.87, "sample_time_ms": 1626.148, "learn_time_ms": 10710.379, "learn_throughput": 373.47, "synch_weights_time_ms": 17.752}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "done": false, "training_iteration": 162, "trial_id": "e1352_00000", "date": "2024-08-13_17-15-00", "timestamp": 1723583700, "time_this_iter_s": 12.28813910484314, "time_total_s": 2215.7088515758514, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2a5a310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2215.7088515758514, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 51.3, "ram_util_percent": 83.52352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1529825163573992, "cur_kl_coeff": 1.8856097178070298e-07, "cur_lr": 0.009999999999999998, "total_loss": 0.8655646039695336, "policy_loss": 0.00010076323302373999, "vf_loss": 0.8654638382177504, "vf_explained_var": -4.9828221558263064e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8666169935799044, "cur_kl_coeff": 4.527716705980844e-24, "cur_lr": 0.009999999999999998, "total_loss": 1.1640968746806264, "policy_loss": 0.000150821491997078, "vf_loss": 1.1639460507445234, "vf_explained_var": -6.717348855639261e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -576.0, "episode_reward_mean": -37.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -32.54, "predator_policy": 13.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, -4.0, -2.0, 28.0, -8.0, 0.0, 0.0, 3.0, 5.0, 0.0, -10.0, 0.0, 0.0, -200.0, 0.0, 12.0, 0.0, -6.0, -4.0, -20.0, 0.0, 11.0, 0.0, -201.0, -576.0, -7.0, 0.0, -10.0, 12.0, 0.0, -189.0, -10.0, 0.0, -573.0, 0.0, 0.0, 4.0, -7.0, -4.0, -10.0, -171.0, 2.0, -6.0, 0.0, -7.0, 7.0, -15.0, -10.0, 3.0, -19.0, 4.0, -200.0, -10.0, 10.0, 0.0, 0.0, -10.0, -7.0, 0.0, 0.0, 0.0, -10.0, 0.0, -356.0, -2.0, 15.0, 18.0, 0.0, 0.0, 2.0, 15.0, 11.0, 5.0, -3.0, 0.0, -562.0, -10.0, 1.0, 9.0, 15.0, 19.0, -2.0, -8.0, 7.0, 3.0, 0.0, 3.0, 0.0, -10.0, -17.0, 10.0, 15.0, 15.0, -9.0, 1.0, -545.0, -20.0, 0.0, 1.0, -193.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 10.0, 0.0, -8.0, 0.0, -4.0, 15.0, 13.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -10.0, 15.0, 0.0, 0.0, -16.0, 0.0, -8.0, 0.0, -18.0, -16.0, 10.0, -20.0, 0.0, 11.0, 0.0, 0.0, -394.0, -10.0, -394.0, -380.0, 7.0, -28.0, 0.0, 0.0, -20.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, -378.0, 0.0, -20.0, 0.0, 0.0, -373.0, -400.0, 0.0, 0.0, 0.0, 0.0, -28.0, 15.0, 0.0, -23.0, -10.0, 0.0, 0.0, -20.0, 13.0, -368.0, 1.0, -8.0, 0.0, -12.0, 0.0, 0.0, -13.0, -8.0, 4.0, 0.0, -12.0, -18.0, 0.0, -20.0, 3.0, 0.0, -19.0, -20.0, 4.0, 0.0, -400.0, 0.0, -14.0, -7.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -384.0, -343.0, -4.0, 0.0, 15.0, 0.0, 12.0, 6.0, 7.0, -14.0, 0.0, 0.0, 2.0, 0.0, 0.0, 15.0, 0.0, 11.0, 0.0, 5.0, -6.0, 0.0, 0.0, 0.0, -400.0, -362.0, -20.0, 0.0, 0.0, 1.0, 9.0, 0.0, 0.0, 15.0, -16.0, 15.0, -22.0, 0.0, -8.0, -4.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -20.0, -8.0, -20.0, 10.0, 0.0, 15.0, 0.0, 15.0, 0.0, -19.0, 0.0, 1.0, 0.0, -400.0, -345.0, 0.0, -40.0, 0.0, 0.0, -8.0, 5.0, -386.0, 0.0], "policy_predator_policy_reward": [0.0, 10.0, 0.0, 4.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 14.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 198.0, 5.0, 198.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 179.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 6.0, 10.0, 6.0, 0.0, 10.0, 0.0, 184.0, 0.0, 9.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 3.0, 0.0, 6.0, 9.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 192.0, 179.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 4.0, 193.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.875332793524386, "mean_inference_ms": 2.3541512765933392, "mean_action_processing_ms": 0.419633091748539, "mean_env_wait_ms": 0.3092259290181131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010053634643554688, "StateBufferConnector_ms": 0.004402756690979004, "ViewRequirementAgentConnector_ms": 0.11882328987121582}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -576.0, "episode_return_mean": -37.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.16796133741826, "num_env_steps_trained_throughput_per_sec": 329.16796133741826, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 2608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2608000, "timers": {"training_iteration_time_ms": 12300.28, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12300.233, "sample_time_ms": 1526.876, "learn_time_ms": 10755.128, "learn_throughput": 371.916, "synch_weights_time_ms": 15.678}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "done": false, "training_iteration": 163, "trial_id": "e1352_00000", "date": "2024-08-13_17-15-13", "timestamp": 1723583713, "time_this_iter_s": 12.202813863754272, "time_total_s": 2227.9116654396057, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b15dbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2227.9116654396057, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 50.588235294117645, "ram_util_percent": 83.32352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5705222091296314, "cur_kl_coeff": 9.428048589035149e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.0572039481508668, "policy_loss": 9.016342924306633e-05, "vf_loss": 1.0571137839603046, "vf_explained_var": -7.47423323373946e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.531481082807418, "cur_kl_coeff": 2.263858352990422e-24, "cur_lr": 0.009999999999999998, "total_loss": 1.1460734832046366, "policy_loss": 0.0002389948679597447, "vf_loss": 1.1458344873139468, "vf_explained_var": -6.8119594029017855e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -576.0, "episode_reward_mean": -43.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -38.17, "predator_policy": 16.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-201.0, -576.0, -7.0, 0.0, -10.0, 12.0, 0.0, -189.0, -10.0, 0.0, -573.0, 0.0, 0.0, 4.0, -7.0, -4.0, -10.0, -171.0, 2.0, -6.0, 0.0, -7.0, 7.0, -15.0, -10.0, 3.0, -19.0, 4.0, -200.0, -10.0, 10.0, 0.0, 0.0, -10.0, -7.0, 0.0, 0.0, 0.0, -10.0, 0.0, -356.0, -2.0, 15.0, 18.0, 0.0, 0.0, 2.0, 15.0, 11.0, 5.0, -3.0, 0.0, -562.0, -10.0, 1.0, 9.0, 15.0, 19.0, -2.0, -8.0, 7.0, 3.0, 0.0, 3.0, 0.0, -10.0, -17.0, 10.0, 15.0, 15.0, -9.0, 1.0, -545.0, -20.0, 0.0, 1.0, -193.0, -166.0, 0.0, -200.0, -191.0, -3.0, -4.0, 0.0, -2.0, -5.0, -17.0, -2.0, 0.0, 0.0, 3.0, 9.0, -182.0, 2.0, 2.0, -12.0, -10.0, 0.0, 0.0, 8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-394.0, -10.0, -394.0, -380.0, 7.0, -28.0, 0.0, 0.0, -20.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, -378.0, 0.0, -20.0, 0.0, 0.0, -373.0, -400.0, 0.0, 0.0, 0.0, 0.0, -28.0, 15.0, 0.0, -23.0, -10.0, 0.0, 0.0, -20.0, 13.0, -368.0, 1.0, -8.0, 0.0, -12.0, 0.0, 0.0, -13.0, -8.0, 4.0, 0.0, -12.0, -18.0, 0.0, -20.0, 3.0, 0.0, -19.0, -20.0, 4.0, 0.0, -400.0, 0.0, -14.0, -7.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -384.0, -343.0, -4.0, 0.0, 15.0, 0.0, 12.0, 6.0, 7.0, -14.0, 0.0, 0.0, 2.0, 0.0, 0.0, 15.0, 0.0, 11.0, 0.0, 5.0, -6.0, 0.0, 0.0, 0.0, -400.0, -362.0, -20.0, 0.0, 0.0, 1.0, 9.0, 0.0, 0.0, 15.0, -16.0, 15.0, -22.0, 0.0, -8.0, -4.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -20.0, -8.0, -20.0, 10.0, 0.0, 15.0, 0.0, 15.0, 0.0, -19.0, 0.0, 1.0, 0.0, -400.0, -345.0, 0.0, -40.0, 0.0, 0.0, -8.0, 5.0, -386.0, 0.0, 0.0, -347.0, -2.0, 0.0, 0.0, -400.0, -382.0, 0.0, 0.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, -10.0, -14.0, -10.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, -5.0, -366.0, 0.0, 2.0, 2.0, 0.0, -2.0, -20.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0], "policy_predator_policy_reward": [198.0, 5.0, 198.0, 0.0, 4.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 179.0, 10.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 6.0, 10.0, 6.0, 0.0, 10.0, 0.0, 184.0, 0.0, 9.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 3.0, 0.0, 6.0, 9.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 192.0, 179.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 4.0, 193.0, 0.0, 181.0, 0.0, 0.0, 2.0, 200.0, 0.0, 191.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8734108113253427, "mean_inference_ms": 2.351998827985696, "mean_action_processing_ms": 0.4187119960190239, "mean_env_wait_ms": 0.30847226005232403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009067177772521973, "StateBufferConnector_ms": 0.004369974136352539, "ViewRequirementAgentConnector_ms": 0.11802423000335693}, "num_episodes": 23, "episode_return_max": 19.0, "episode_return_min": -576.0, "episode_return_mean": -43.52, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.59095164068356, "num_env_steps_trained_throughput_per_sec": 337.59095164068356, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 2624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2624000, "timers": {"training_iteration_time_ms": 12186.278, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12186.233, "sample_time_ms": 1472.296, "learn_time_ms": 10695.666, "learn_throughput": 373.983, "synch_weights_time_ms": 15.774}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "done": false, "training_iteration": 164, "trial_id": "e1352_00000", "date": "2024-08-13_17-15-24", "timestamp": 1723583724, "time_this_iter_s": 11.888051986694336, "time_total_s": 2239.7997174263, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17ace50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2239.7997174263, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 49.61764705882353, "ram_util_percent": 83.11176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.444950167956718, "cur_kl_coeff": 4.7140242945175745e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.0134174639743472, "policy_loss": -0.00018225207372947976, "vf_loss": 1.0135997167813084, "vf_explained_var": -1.0060254858915137e-08, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5435273146083106, "cur_kl_coeff": 1.131929176495211e-24, "cur_lr": 0.009999999999999998, "total_loss": 1.0932084164370304, "policy_loss": 0.00015647628014444043, "vf_loss": 1.0930519372224807, "vf_explained_var": -7.127327893776868e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -562.0, "episode_reward_mean": -33.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.885, "predator_policy": 15.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, -15.0, -10.0, 3.0, -19.0, 4.0, -200.0, -10.0, 10.0, 0.0, 0.0, -10.0, -7.0, 0.0, 0.0, 0.0, -10.0, 0.0, -356.0, -2.0, 15.0, 18.0, 0.0, 0.0, 2.0, 15.0, 11.0, 5.0, -3.0, 0.0, -562.0, -10.0, 1.0, 9.0, 15.0, 19.0, -2.0, -8.0, 7.0, 3.0, 0.0, 3.0, 0.0, -10.0, -17.0, 10.0, 15.0, 15.0, -9.0, 1.0, -545.0, -20.0, 0.0, 1.0, -193.0, -166.0, 0.0, -200.0, -191.0, -3.0, -4.0, 0.0, -2.0, -5.0, -17.0, -2.0, 0.0, 0.0, 3.0, 9.0, -182.0, 2.0, 2.0, -12.0, -10.0, 0.0, 0.0, 8.0, -158.0, 7.0, 10.0, 0.0, -4.0, 0.0, -4.0, 0.0, 0.0, 0.0, -186.0, -2.0, 5.0, -9.0, 9.0, 0.0, 7.0, -4.0, -400.0, 0.0, 5.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, 0.0, -12.0, -18.0, 0.0, -20.0, 3.0, 0.0, -19.0, -20.0, 4.0, 0.0, -400.0, 0.0, -14.0, -7.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -384.0, -343.0, -4.0, 0.0, 15.0, 0.0, 12.0, 6.0, 7.0, -14.0, 0.0, 0.0, 2.0, 0.0, 0.0, 15.0, 0.0, 11.0, 0.0, 5.0, -6.0, 0.0, 0.0, 0.0, -400.0, -362.0, -20.0, 0.0, 0.0, 1.0, 9.0, 0.0, 0.0, 15.0, -16.0, 15.0, -22.0, 0.0, -8.0, -4.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -20.0, -8.0, -20.0, 10.0, 0.0, 15.0, 0.0, 15.0, 0.0, -19.0, 0.0, 1.0, 0.0, -400.0, -345.0, 0.0, -40.0, 0.0, 0.0, -8.0, 5.0, -386.0, 0.0, 0.0, -347.0, -2.0, 0.0, 0.0, -400.0, -382.0, 0.0, 0.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, -10.0, -14.0, -10.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, -5.0, -366.0, 0.0, 2.0, 2.0, 0.0, -2.0, -20.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, -341.0, 5.0, 0.0, -13.0, 10.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -372.0, 0.0, -4.0, -2.0, 0.0, 0.0, -20.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, -14.0, 0.0, -400.0, -400.0, 0.0, 0.0, -14.0, 9.0, -14.0, 0.0], "policy_predator_policy_reward": [3.0, 0.0, 6.0, 9.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 200.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 192.0, 179.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 4.0, 193.0, 0.0, 181.0, 0.0, 0.0, 2.0, 200.0, 0.0, 191.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 178.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 0.0, 0.0, 2.0, 0.0, 7.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 200.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8722336897319377, "mean_inference_ms": 2.34929491862504, "mean_action_processing_ms": 0.41743407860240206, "mean_env_wait_ms": 0.3079963136627336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062408447265625, "StateBufferConnector_ms": 0.003855109214782715, "ViewRequirementAgentConnector_ms": 0.10939490795135498}, "num_episodes": 22, "episode_return_max": 19.0, "episode_return_min": -562.0, "episode_return_mean": -33.27, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.48141123994213, "num_env_steps_trained_throughput_per_sec": 328.48141123994213, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 12173.031, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12172.986, "sample_time_ms": 1474.349, "learn_time_ms": 10680.43, "learn_throughput": 374.517, "synch_weights_time_ms": 15.814}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 165, "trial_id": "e1352_00000", "date": "2024-08-13_17-15-37", "timestamp": 1723583737, "time_this_iter_s": 12.215869903564453, "time_total_s": 2252.0155873298645, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17acf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2252.0155873298645, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 48.361111111111114, "ram_util_percent": 83.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.203989485059261, "cur_kl_coeff": 2.3570121472587872e-08, "cur_lr": 0.009999999999999998, "total_loss": 1.077974699729334, "policy_loss": 3.7397495372388415e-05, "vf_loss": 1.0779373030971597, "vf_explained_var": -7.190401591951885e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0466077296800753, "cur_kl_coeff": 5.659645882476055e-25, "cur_lr": 0.009999999999999998, "total_loss": 1.1455028403175886, "policy_loss": 0.00013431317133523484, "vf_loss": 1.145368523840551, "vf_explained_var": -9.019538839027365e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -562.0, "episode_reward_mean": -36.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.19, "predator_policy": 17.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-356.0, -2.0, 15.0, 18.0, 0.0, 0.0, 2.0, 15.0, 11.0, 5.0, -3.0, 0.0, -562.0, -10.0, 1.0, 9.0, 15.0, 19.0, -2.0, -8.0, 7.0, 3.0, 0.0, 3.0, 0.0, -10.0, -17.0, 10.0, 15.0, 15.0, -9.0, 1.0, -545.0, -20.0, 0.0, 1.0, -193.0, -166.0, 0.0, -200.0, -191.0, -3.0, -4.0, 0.0, -2.0, -5.0, -17.0, -2.0, 0.0, 0.0, 3.0, 9.0, -182.0, 2.0, 2.0, -12.0, -10.0, 0.0, 0.0, 8.0, -158.0, 7.0, 10.0, 0.0, -4.0, 0.0, -4.0, 0.0, 0.0, 0.0, -186.0, -2.0, 5.0, -9.0, 9.0, 0.0, 7.0, -4.0, -400.0, 0.0, 5.0, -4.0, -7.0, -185.0, 7.0, -12.0, -5.0, -13.0, -189.0, 0.0, 15.0, 0.0, -180.0, 12.0, 10.0, 2.0, 3.0, 6.0, 13.0, -20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-384.0, -343.0, -4.0, 0.0, 15.0, 0.0, 12.0, 6.0, 7.0, -14.0, 0.0, 0.0, 2.0, 0.0, 0.0, 15.0, 0.0, 11.0, 0.0, 5.0, -6.0, 0.0, 0.0, 0.0, -400.0, -362.0, -20.0, 0.0, 0.0, 1.0, 9.0, 0.0, 0.0, 15.0, -16.0, 15.0, -22.0, 0.0, -8.0, -4.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -20.0, -8.0, -20.0, 10.0, 0.0, 15.0, 0.0, 15.0, 0.0, -19.0, 0.0, 1.0, 0.0, -400.0, -345.0, 0.0, -40.0, 0.0, 0.0, -8.0, 5.0, -386.0, 0.0, 0.0, -347.0, -2.0, 0.0, 0.0, -400.0, -382.0, 0.0, 0.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, -10.0, -14.0, -10.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, -5.0, -366.0, 0.0, 2.0, 2.0, 0.0, -2.0, -20.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, -341.0, 5.0, 0.0, -13.0, 10.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -372.0, 0.0, -4.0, -2.0, 0.0, 0.0, -20.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, -14.0, 0.0, -400.0, -400.0, 0.0, 0.0, -14.0, 9.0, -14.0, 0.0, 3.0, -20.0, -370.0, 0.0, 0.0, 7.0, -20.0, -4.0, 0.0, -10.0, -6.0, -20.0, -12.0, -374.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, -388.0, 9.0, 0.0, 12.0, 7.0, 3.0, -8.0, 0.0, 1.0, 0.0, 6.0, 0.0, 13.0, 0.0, -34.0, -8.0], "policy_predator_policy_reward": [192.0, 179.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 4.0, 193.0, 0.0, 181.0, 0.0, 0.0, 2.0, 200.0, 0.0, 191.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 178.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 0.0, 0.0, 2.0, 0.0, 7.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 200.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 185.0, 0.0, 0.0, 12.0, 0.0, 0.0, 5.0, 0.0, 13.0, 10.0, 187.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 189.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8709867263699467, "mean_inference_ms": 2.34730368299025, "mean_action_processing_ms": 0.41653732584810527, "mean_env_wait_ms": 0.30747710965881314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005738735198974609, "StateBufferConnector_ms": 0.00386965274810791, "ViewRequirementAgentConnector_ms": 0.10776472091674805}, "num_episodes": 18, "episode_return_max": 19.0, "episode_return_min": -562.0, "episode_return_mean": -36.13, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.01919529131965, "num_env_steps_trained_throughput_per_sec": 333.01919529131965, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 2656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2656000, "timers": {"training_iteration_time_ms": 12104.377, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12104.332, "sample_time_ms": 1470.673, "learn_time_ms": 10615.185, "learn_throughput": 376.819, "synch_weights_time_ms": 15.987}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "done": false, "training_iteration": 166, "trial_id": "e1352_00000", "date": "2024-08-13_17-15-49", "timestamp": 1723583749, "time_this_iter_s": 12.05932068824768, "time_total_s": 2264.074908018112, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2a95dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2264.074908018112, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 52.2, "ram_util_percent": 83.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2654207187524884, "cur_kl_coeff": 1.1785060736293936e-08, "cur_lr": 0.009999999999999998, "total_loss": 0.7720755082904978, "policy_loss": -0.00034677294950202976, "vf_loss": 0.7724222823425576, "vf_explained_var": -7.631917479177e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4246588355395327, "cur_kl_coeff": 2.8298229412380277e-25, "cur_lr": 0.009999999999999998, "total_loss": 0.8751825648759093, "policy_loss": -0.00019087109409233249, "vf_loss": 0.8753734343463466, "vf_explained_var": -5.897390779364046e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -545.0, "episode_reward_mean": -32.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -33.58, "predator_policy": 17.17}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -8.0, 7.0, 3.0, 0.0, 3.0, 0.0, -10.0, -17.0, 10.0, 15.0, 15.0, -9.0, 1.0, -545.0, -20.0, 0.0, 1.0, -193.0, -166.0, 0.0, -200.0, -191.0, -3.0, -4.0, 0.0, -2.0, -5.0, -17.0, -2.0, 0.0, 0.0, 3.0, 9.0, -182.0, 2.0, 2.0, -12.0, -10.0, 0.0, 0.0, 8.0, -158.0, 7.0, 10.0, 0.0, -4.0, 0.0, -4.0, 0.0, 0.0, 0.0, -186.0, -2.0, 5.0, -9.0, 9.0, 0.0, 7.0, -4.0, -400.0, 0.0, 5.0, -4.0, -7.0, -185.0, 7.0, -12.0, -5.0, -13.0, -189.0, 0.0, 15.0, 0.0, -180.0, 12.0, 10.0, 2.0, 3.0, 6.0, 13.0, -20.0, 3.0, 1.0, -171.0, 2.0, -194.0, 15.0, -1.0, -2.0, 2.0, -4.0, 6.0, 0.0, 7.0, 3.0, -200.0, 17.0, 15.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.0, 0.0, -8.0, -4.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -20.0, -8.0, -20.0, 10.0, 0.0, 15.0, 0.0, 15.0, 0.0, -19.0, 0.0, 1.0, 0.0, -400.0, -345.0, 0.0, -40.0, 0.0, 0.0, -8.0, 5.0, -386.0, 0.0, 0.0, -347.0, -2.0, 0.0, 0.0, -400.0, -382.0, 0.0, 0.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, -10.0, -14.0, -10.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, -5.0, -366.0, 0.0, 2.0, 2.0, 0.0, -2.0, -20.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, -341.0, 5.0, 0.0, -13.0, 10.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -372.0, 0.0, -4.0, -2.0, 0.0, 0.0, -20.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, -14.0, 0.0, -400.0, -400.0, 0.0, 0.0, -14.0, 9.0, -14.0, 0.0, 3.0, -20.0, -370.0, 0.0, 0.0, 7.0, -20.0, -4.0, 0.0, -10.0, -6.0, -20.0, -12.0, -374.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, -388.0, 9.0, 0.0, 12.0, 7.0, 3.0, -8.0, 0.0, 1.0, 0.0, 6.0, 0.0, 13.0, 0.0, -34.0, -8.0, -7.0, 0.0, -2.0, 2.0, -356.0, 0.0, -2.0, 0.0, -391.0, 0.0, 15.0, 0.0, -2.0, 0.0, 0.0, -8.0, 2.0, 0.0, -10.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, -15.0, -400.0, 0.0, 6.0, 8.0, 15.0, 0.0, 0.0, 9.0], "policy_predator_policy_reward": [10.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 4.0, 193.0, 0.0, 181.0, 0.0, 0.0, 2.0, 200.0, 0.0, 191.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 178.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 0.0, 0.0, 2.0, 0.0, 7.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 200.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 185.0, 0.0, 0.0, 12.0, 0.0, 0.0, 5.0, 0.0, 13.0, 10.0, 187.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 189.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 8.0, 0.0, 10.0, 0.0, 1.0, 182.0, 3.0, 0.0, 4.0, 0.0, 197.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8697283438803828, "mean_inference_ms": 2.3453825797767114, "mean_action_processing_ms": 0.41567215939235397, "mean_env_wait_ms": 0.3069776440761278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005237936973571777, "StateBufferConnector_ms": 0.0036810636520385742, "ViewRequirementAgentConnector_ms": 0.10842633247375488}, "num_episodes": 18, "episode_return_max": 17.0, "episode_return_min": -545.0, "episode_return_mean": -32.82, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.50810589584935, "num_env_steps_trained_throughput_per_sec": 230.50810589584935, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2672000, "timers": {"training_iteration_time_ms": 12633.365, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12633.32, "sample_time_ms": 1474.082, "learn_time_ms": 11141.345, "learn_throughput": 359.023, "synch_weights_time_ms": 15.71}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "done": false, "training_iteration": 167, "trial_id": "e1352_00000", "date": "2024-08-13_17-16-06", "timestamp": 1723583766, "time_this_iter_s": 17.492986917495728, "time_total_s": 2281.567894935608, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2a6fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2281.567894935608, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 72.89999999999999, "ram_util_percent": 83.87391304347827}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.307301349829794, "cur_kl_coeff": 5.892530368146968e-09, "cur_lr": 0.009999999999999998, "total_loss": 0.7895232000205883, "policy_loss": 8.848087083568018e-05, "vf_loss": 0.7894347217347887, "vf_explained_var": -5.140506401263848e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.188785300353541, "cur_kl_coeff": 1.4149114706190138e-25, "cur_lr": 0.009999999999999998, "total_loss": 0.9184789053228481, "policy_loss": 2.351519922730784e-05, "vf_loss": 0.9184553868871518, "vf_explained_var": -5.4558748921389304e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -400.0, "episode_reward_mean": -32.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.115, "predator_policy": 18.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-193.0, -166.0, 0.0, -200.0, -191.0, -3.0, -4.0, 0.0, -2.0, -5.0, -17.0, -2.0, 0.0, 0.0, 3.0, 9.0, -182.0, 2.0, 2.0, -12.0, -10.0, 0.0, 0.0, 8.0, -158.0, 7.0, 10.0, 0.0, -4.0, 0.0, -4.0, 0.0, 0.0, 0.0, -186.0, -2.0, 5.0, -9.0, 9.0, 0.0, 7.0, -4.0, -400.0, 0.0, 5.0, -4.0, -7.0, -185.0, 7.0, -12.0, -5.0, -13.0, -189.0, 0.0, 15.0, 0.0, -180.0, 12.0, 10.0, 2.0, 3.0, 6.0, 13.0, -20.0, 3.0, 1.0, -171.0, 2.0, -194.0, 15.0, -1.0, -2.0, 2.0, -4.0, 6.0, 0.0, 7.0, 3.0, -200.0, 17.0, 15.0, 9.0, -200.0, 0.0, 0.0, -7.0, 0.0, 21.0, -174.0, 11.0, -4.0, -2.0, 2.0, -1.0, 22.0, 11.0, -6.0, 0.0, 0.0, -200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-386.0, 0.0, 0.0, -347.0, -2.0, 0.0, 0.0, -400.0, -382.0, 0.0, 0.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, -10.0, -14.0, -10.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, -5.0, -366.0, 0.0, 2.0, 2.0, 0.0, -2.0, -20.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, -341.0, 5.0, 0.0, -13.0, 10.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -372.0, 0.0, -4.0, -2.0, 0.0, 0.0, -20.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, -14.0, 0.0, -400.0, -400.0, 0.0, 0.0, -14.0, 9.0, -14.0, 0.0, 3.0, -20.0, -370.0, 0.0, 0.0, 7.0, -20.0, -4.0, 0.0, -10.0, -6.0, -20.0, -12.0, -374.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, -388.0, 9.0, 0.0, 12.0, 7.0, 3.0, -8.0, 0.0, 1.0, 0.0, 6.0, 0.0, 13.0, 0.0, -34.0, -8.0, -7.0, 0.0, -2.0, 2.0, -356.0, 0.0, -2.0, 0.0, -391.0, 0.0, 15.0, 0.0, -2.0, 0.0, 0.0, -8.0, 2.0, 0.0, -10.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, -15.0, -400.0, 0.0, 6.0, 8.0, 15.0, 0.0, 0.0, 9.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 0.0, 0.0, 0.0, 6.0, 15.0, -360.0, 0.0, -8.0, 15.0, -8.0, 0.0, -6.0, 0.0, 0.0, 2.0, -2.0, 0.0, 14.0, 8.0, 1.0, 10.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0], "policy_predator_policy_reward": [193.0, 0.0, 181.0, 0.0, 0.0, 2.0, 200.0, 0.0, 191.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 7.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 183.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 178.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 0.0, 0.0, 2.0, 0.0, 7.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 200.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 185.0, 0.0, 0.0, 12.0, 0.0, 0.0, 5.0, 0.0, 13.0, 10.0, 187.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 189.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 8.0, 0.0, 10.0, 0.0, 1.0, 182.0, 3.0, 0.0, 4.0, 0.0, 197.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 0.0, 4.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.869638762984279, "mean_inference_ms": 2.34694452907442, "mean_action_processing_ms": 0.4153608646698983, "mean_env_wait_ms": 0.30685208430607447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004882216453552246, "StateBufferConnector_ms": 0.0037783384323120117, "ViewRequirementAgentConnector_ms": 0.11619353294372559}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -400.0, "episode_return_mean": -32.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.7130462657303, "num_env_steps_trained_throughput_per_sec": 267.7130462657303, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2688000, "timers": {"training_iteration_time_ms": 12903.664, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12903.618, "sample_time_ms": 1730.315, "learn_time_ms": 11155.652, "learn_throughput": 358.563, "synch_weights_time_ms": 15.617}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "done": false, "training_iteration": 168, "trial_id": "e1352_00000", "date": "2024-08-13_17-16-21", "timestamp": 1723583781, "time_this_iter_s": 14.985474824905396, "time_total_s": 2296.5533697605133, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17acf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2296.5533697605133, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 61.65238095238095, "ram_util_percent": 83.61904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5751211802139613, "cur_kl_coeff": 2.946265184073484e-09, "cur_lr": 0.009999999999999998, "total_loss": 0.24836922250885182, "policy_loss": 4.8288467670322725e-05, "vf_loss": 0.24832093503585495, "vf_explained_var": 6.931080389275122e-05, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.726566960606182, "cur_kl_coeff": 7.074557353095069e-26, "cur_lr": 0.009999999999999998, "total_loss": 0.34454322473993576, "policy_loss": 0.0001322655416236668, "vf_loss": 0.3444109586116543, "vf_explained_var": 7.913197789873395e-05, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -400.0, "episode_reward_mean": -23.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -25.965, "predator_policy": 14.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -4.0, 0.0, -4.0, 0.0, 0.0, 0.0, -186.0, -2.0, 5.0, -9.0, 9.0, 0.0, 7.0, -4.0, -400.0, 0.0, 5.0, -4.0, -7.0, -185.0, 7.0, -12.0, -5.0, -13.0, -189.0, 0.0, 15.0, 0.0, -180.0, 12.0, 10.0, 2.0, 3.0, 6.0, 13.0, -20.0, 3.0, 1.0, -171.0, 2.0, -194.0, 15.0, -1.0, -2.0, 2.0, -4.0, 6.0, 0.0, 7.0, 3.0, -200.0, 17.0, 15.0, 9.0, -200.0, 0.0, 0.0, -7.0, 0.0, 21.0, -174.0, 11.0, -4.0, -2.0, 2.0, -1.0, 22.0, 11.0, -6.0, 0.0, 0.0, -200.0, -21.0, -4.0, 6.0, 3.0, 0.0, 0.0, 14.0, 5.0, 2.0, 10.0, 5.0, -15.0, -167.0, -9.0, -11.0, -10.0, 14.0, 3.0, -12.0, 0.0, 0.0, 0.0, 0.0, -1.0, 3.0, 0.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -372.0, 0.0, -4.0, -2.0, 0.0, 0.0, -20.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, -14.0, 0.0, -400.0, -400.0, 0.0, 0.0, -14.0, 9.0, -14.0, 0.0, 3.0, -20.0, -370.0, 0.0, 0.0, 7.0, -20.0, -4.0, 0.0, -10.0, -6.0, -20.0, -12.0, -374.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, -388.0, 9.0, 0.0, 12.0, 7.0, 3.0, -8.0, 0.0, 1.0, 0.0, 6.0, 0.0, 13.0, 0.0, -34.0, -8.0, -7.0, 0.0, -2.0, 2.0, -356.0, 0.0, -2.0, 0.0, -391.0, 0.0, 15.0, 0.0, -2.0, 0.0, 0.0, -8.0, 2.0, 0.0, -10.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, -15.0, -400.0, 0.0, 6.0, 8.0, 15.0, 0.0, 0.0, 9.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 0.0, 0.0, 0.0, 6.0, 15.0, -360.0, 0.0, -8.0, 15.0, -8.0, 0.0, -6.0, 0.0, 0.0, 2.0, -2.0, 0.0, 14.0, 8.0, 1.0, 10.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -20.0, -22.0, -16.0, 3.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, -20.0, 15.0, 2.0, 0.0, -6.0, 13.0, 5.0, 0.0, 0.0, -30.0, -355.0, 3.0, 0.0, -18.0, 5.0, -36.0, 0.0, -20.0, 4.0, 10.0, 0.0, 3.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 5.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 0.0, 0.0, 2.0, 0.0, 7.0, 1.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 200.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 185.0, 0.0, 0.0, 12.0, 0.0, 0.0, 5.0, 0.0, 13.0, 10.0, 187.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 189.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 8.0, 0.0, 10.0, 0.0, 1.0, 182.0, 3.0, 0.0, 4.0, 0.0, 197.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 0.0, 4.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 10.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 10.0, 179.0, 6.0, 0.0, 9.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.869827160359021, "mean_inference_ms": 2.3521390906570856, "mean_action_processing_ms": 0.4151209858432074, "mean_env_wait_ms": 0.3067664880182005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005389690399169922, "StateBufferConnector_ms": 0.00494539737701416, "ViewRequirementAgentConnector_ms": 0.14234578609466553}, "num_episodes": 27, "episode_return_max": 22.0, "episode_return_min": -400.0, "episode_return_mean": -23.29, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.2820053802099, "num_env_steps_trained_throughput_per_sec": 269.2820053802099, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2704000, "timers": {"training_iteration_time_ms": 13175.594, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13175.544, "sample_time_ms": 1842.827, "learn_time_ms": 11309.998, "learn_throughput": 353.669, "synch_weights_time_ms": 19.718}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "done": false, "training_iteration": 169, "trial_id": "e1352_00000", "date": "2024-08-13_17-16-36", "timestamp": 1723583796, "time_this_iter_s": 15.070857048034668, "time_total_s": 2311.624226808548, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17824c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2311.624226808548, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 61.32727272727273, "ram_util_percent": 82.39090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9001857274528544, "cur_kl_coeff": 1.473132592036742e-09, "cur_lr": 0.009999999999999998, "total_loss": 1.0148856456632966, "policy_loss": 0.0001006043060293431, "vf_loss": 1.0147850383920645, "vf_explained_var": -7.884212271877066e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0723322440018244, "cur_kl_coeff": 3.5372786765475346e-26, "cur_lr": 0.009999999999999998, "total_loss": 0.8797275269867251, "policy_loss": 0.00012864794449082443, "vf_loss": 0.8795988789311162, "vf_explained_var": -7.158864742864377e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -200.0, "episode_reward_mean": -20.48, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -25.47, "predator_policy": 15.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -7.0, -185.0, 7.0, -12.0, -5.0, -13.0, -189.0, 0.0, 15.0, 0.0, -180.0, 12.0, 10.0, 2.0, 3.0, 6.0, 13.0, -20.0, 3.0, 1.0, -171.0, 2.0, -194.0, 15.0, -1.0, -2.0, 2.0, -4.0, 6.0, 0.0, 7.0, 3.0, -200.0, 17.0, 15.0, 9.0, -200.0, 0.0, 0.0, -7.0, 0.0, 21.0, -174.0, 11.0, -4.0, -2.0, 2.0, -1.0, 22.0, 11.0, -6.0, 0.0, 0.0, -200.0, -21.0, -4.0, 6.0, 3.0, 0.0, 0.0, 14.0, 5.0, 2.0, 10.0, 5.0, -15.0, -167.0, -9.0, -11.0, -10.0, 14.0, 3.0, -12.0, 0.0, 0.0, 0.0, 0.0, -1.0, 3.0, 0.0, 5.0, -4.0, 1.0, 13.0, -10.0, 6.0, 0.0, 0.0, 15.0, -5.0, 0.0, -162.0, 0.0, 15.0, -1.0, 1.0, 26.0, 3.0, -200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 0.0, 3.0, -20.0, -370.0, 0.0, 0.0, 7.0, -20.0, -4.0, 0.0, -10.0, -6.0, -20.0, -12.0, -374.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, -388.0, 9.0, 0.0, 12.0, 7.0, 3.0, -8.0, 0.0, 1.0, 0.0, 6.0, 0.0, 13.0, 0.0, -34.0, -8.0, -7.0, 0.0, -2.0, 2.0, -356.0, 0.0, -2.0, 0.0, -391.0, 0.0, 15.0, 0.0, -2.0, 0.0, 0.0, -8.0, 2.0, 0.0, -10.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, -15.0, -400.0, 0.0, 6.0, 8.0, 15.0, 0.0, 0.0, 9.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 0.0, 0.0, 0.0, 6.0, 15.0, -360.0, 0.0, -8.0, 15.0, -8.0, 0.0, -6.0, 0.0, 0.0, 2.0, -2.0, 0.0, 14.0, 8.0, 1.0, 10.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -20.0, -22.0, -16.0, 3.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, -20.0, 15.0, 2.0, 0.0, -6.0, 13.0, 5.0, 0.0, 0.0, -30.0, -355.0, 3.0, 0.0, -18.0, 5.0, -36.0, 0.0, -20.0, 4.0, 10.0, 0.0, 3.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 5.0, -8.0, 0.0, 2.0, -388.0, 13.0, 0.0, 0.0, -20.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -15.0, 0.0, 0.0, -373.0, 15.0, 0.0, 0.0, 15.0, 0.0, 0.0, -2.0, -1.0, -6.0, 15.0, 11.0, 0.0, -2.0, -400.0, 0.0], "policy_predator_policy_reward": [10.0, 0.0, 0.0, 10.0, 0.0, 185.0, 0.0, 0.0, 12.0, 0.0, 0.0, 5.0, 0.0, 13.0, 10.0, 187.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 189.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 8.0, 0.0, 10.0, 0.0, 1.0, 182.0, 3.0, 0.0, 4.0, 0.0, 197.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 0.0, 4.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 10.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 10.0, 179.0, 6.0, 0.0, 9.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 194.0, 193.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 5.0, 0.0, 0.0, 2.0, 3.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8714592990261127, "mean_inference_ms": 2.3553680477555385, "mean_action_processing_ms": 0.4151507211036784, "mean_env_wait_ms": 0.3070814703281458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005367279052734375, "StateBufferConnector_ms": 0.004857420921325684, "ViewRequirementAgentConnector_ms": 0.1482464075088501}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -200.0, "episode_return_mean": -20.48, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.20950841556174, "num_env_steps_trained_throughput_per_sec": 308.20950841556174, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 13290.223, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13290.171, "sample_time_ms": 1902.014, "learn_time_ms": 11365.852, "learn_throughput": 351.931, "synch_weights_time_ms": 19.337}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 170, "trial_id": "e1352_00000", "date": "2024-08-13_17-16-50", "timestamp": 1723583810, "time_this_iter_s": 13.030295133590698, "time_total_s": 2324.6545219421387, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2a6f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2324.6545219421387, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 55.138888888888886, "ram_util_percent": 81.3111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.29092403045885, "cur_kl_coeff": 7.36566296018371e-10, "cur_lr": 0.009999999999999998, "total_loss": 0.914601812791572, "policy_loss": 0.00014824093856587612, "vf_loss": 0.9144535749362259, "vf_explained_var": -4.0997903813760745e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1360503043874695, "cur_kl_coeff": 1.7686393382737673e-26, "cur_lr": 0.009999999999999998, "total_loss": 1.4068659207965961, "policy_loss": 0.00033041121876704947, "vf_loss": 1.4065355097648329, "vf_explained_var": -7.2850121392144095e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -566.0, "episode_reward_mean": -22.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -25.29, "predator_policy": 14.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, 3.0, 1.0, -171.0, 2.0, -194.0, 15.0, -1.0, -2.0, 2.0, -4.0, 6.0, 0.0, 7.0, 3.0, -200.0, 17.0, 15.0, 9.0, -200.0, 0.0, 0.0, -7.0, 0.0, 21.0, -174.0, 11.0, -4.0, -2.0, 2.0, -1.0, 22.0, 11.0, -6.0, 0.0, 0.0, -200.0, -21.0, -4.0, 6.0, 3.0, 0.0, 0.0, 14.0, 5.0, 2.0, 10.0, 5.0, -15.0, -167.0, -9.0, -11.0, -10.0, 14.0, 3.0, -12.0, 0.0, 0.0, 0.0, 0.0, -1.0, 3.0, 0.0, 5.0, -4.0, 1.0, 13.0, -10.0, 6.0, 0.0, 0.0, 15.0, -5.0, 0.0, -162.0, 0.0, 15.0, -1.0, 1.0, 26.0, 3.0, -200.0, 0.0, -566.0, 8.0, 0.0, -4.0, 8.0, 1.0, 0.0, 2.0, 3.0, 0.0, -178.0, -2.0, 1.0, 8.0, -3.0, -9.0, 18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.0, -8.0, -7.0, 0.0, -2.0, 2.0, -356.0, 0.0, -2.0, 0.0, -391.0, 0.0, 15.0, 0.0, -2.0, 0.0, 0.0, -8.0, 2.0, 0.0, -10.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, -15.0, -400.0, 0.0, 6.0, 8.0, 15.0, 0.0, 0.0, 9.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 0.0, 0.0, 0.0, 6.0, 15.0, -360.0, 0.0, -8.0, 15.0, -8.0, 0.0, -6.0, 0.0, 0.0, 2.0, -2.0, 0.0, 14.0, 8.0, 1.0, 10.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -20.0, -22.0, -16.0, 3.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, -20.0, 15.0, 2.0, 0.0, -6.0, 13.0, 5.0, 0.0, 0.0, -30.0, -355.0, 3.0, 0.0, -18.0, 5.0, -36.0, 0.0, -20.0, 4.0, 10.0, 0.0, 3.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 5.0, -8.0, 0.0, 2.0, -388.0, 13.0, 0.0, 0.0, -20.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -15.0, 0.0, 0.0, -373.0, 15.0, 0.0, 0.0, 15.0, 0.0, 0.0, -2.0, -1.0, -6.0, 15.0, 11.0, 0.0, -2.0, -400.0, 0.0, 0.0, 0.0, -388.0, -372.0, 0.0, 8.0, 0.0, 0.0, 0.0, -14.0, 0.0, 8.0, 6.0, -15.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 0.0, 15.0, -388.0, -4.0, 0.0, 1.0, 0.0, 0.0, 8.0, -6.0, 0.0, 0.0, -19.0, 6.0, 9.0], "policy_predator_policy_reward": [14.0, 8.0, 0.0, 10.0, 0.0, 1.0, 182.0, 3.0, 0.0, 4.0, 0.0, 197.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 200.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 0.0, 4.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 10.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 10.0, 179.0, 6.0, 0.0, 9.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 194.0, 193.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 5.0, 0.0, 0.0, 2.0, 3.0, 0.0, 200.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8724305786338925, "mean_inference_ms": 2.3593436789878997, "mean_action_processing_ms": 0.41517054491379235, "mean_env_wait_ms": 0.3072410740425482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050438642501831055, "StateBufferConnector_ms": 0.007203102111816406, "ViewRequirementAgentConnector_ms": 0.15187251567840576}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -566.0, "episode_return_mean": -22.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.85958431675493, "num_env_steps_trained_throughput_per_sec": 324.85958431675493, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2736000, "timers": {"training_iteration_time_ms": 13286.177, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13286.125, "sample_time_ms": 1912.26, "learn_time_ms": 11352.125, "learn_throughput": 352.357, "synch_weights_time_ms": 18.977}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "done": false, "training_iteration": 171, "trial_id": "e1352_00000", "date": "2024-08-13_17-17-02", "timestamp": 1723583822, "time_this_iter_s": 12.376019954681396, "time_total_s": 2337.03054189682, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17b89d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2337.03054189682, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 50.922222222222224, "ram_util_percent": 81.76666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.612603127947155, "cur_kl_coeff": 3.682831480091855e-10, "cur_lr": 0.009999999999999998, "total_loss": 1.0990266200411256, "policy_loss": -0.00012019198786999498, "vf_loss": 1.099146810647041, "vf_explained_var": -6.7488857047267695e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2399431602499322, "cur_kl_coeff": 8.843196691368836e-27, "cur_lr": 0.009999999999999998, "total_loss": 1.4716969814407763, "policy_loss": -5.6738307374337366e-06, "vf_loss": 1.4717026545572534, "vf_explained_var": -8.262654460927166e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -26.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -27.535, "predator_policy": 14.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, -200.0, 0.0, 0.0, -7.0, 0.0, 21.0, -174.0, 11.0, -4.0, -2.0, 2.0, -1.0, 22.0, 11.0, -6.0, 0.0, 0.0, -200.0, -21.0, -4.0, 6.0, 3.0, 0.0, 0.0, 14.0, 5.0, 2.0, 10.0, 5.0, -15.0, -167.0, -9.0, -11.0, -10.0, 14.0, 3.0, -12.0, 0.0, 0.0, 0.0, 0.0, -1.0, 3.0, 0.0, 5.0, -4.0, 1.0, 13.0, -10.0, 6.0, 0.0, 0.0, 15.0, -5.0, 0.0, -162.0, 0.0, 15.0, -1.0, 1.0, 26.0, 3.0, -200.0, 0.0, -566.0, 8.0, 0.0, -4.0, 8.0, 1.0, 0.0, 2.0, 3.0, 0.0, -178.0, -2.0, 1.0, 8.0, -3.0, -9.0, 18.0, -180.0, 2.0, -600.0, 0.0, -194.0, -12.0, -3.0, -2.0, -5.0, 10.0, 15.0, 9.0, 23.0, 15.0, 0.0, 8.0, -26.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 9.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 0.0, 0.0, 0.0, 6.0, 15.0, -360.0, 0.0, -8.0, 15.0, -8.0, 0.0, -6.0, 0.0, 0.0, 2.0, -2.0, 0.0, 14.0, 8.0, 1.0, 10.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, -20.0, -22.0, -16.0, 3.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, -20.0, 15.0, 2.0, 0.0, -6.0, 13.0, 5.0, 0.0, 0.0, -30.0, -355.0, 3.0, 0.0, -18.0, 5.0, -36.0, 0.0, -20.0, 4.0, 10.0, 0.0, 3.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 5.0, -8.0, 0.0, 2.0, -388.0, 13.0, 0.0, 0.0, -20.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -15.0, 0.0, 0.0, -373.0, 15.0, 0.0, 0.0, 15.0, 0.0, 0.0, -2.0, -1.0, -6.0, 15.0, 11.0, 0.0, -2.0, -400.0, 0.0, 0.0, 0.0, -388.0, -372.0, 0.0, 8.0, 0.0, 0.0, 0.0, -14.0, 0.0, 8.0, 6.0, -15.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 0.0, 15.0, -388.0, -4.0, 0.0, 1.0, 0.0, 0.0, 8.0, -6.0, 0.0, 0.0, -19.0, 6.0, 9.0, 0.0, -360.0, 2.0, 0.0, -400.0, -400.0, 0.0, 0.0, -380.0, -8.0, -19.0, -19.0, 0.0, -6.0, -11.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 15.0, -11.0, 0.0, 7.0, 12.0, 0.0, 15.0, 0.0, 0.0, 8.0, 0.0, -38.0, -18.0, -3.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 186.0, 0.0, 4.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 11.0, 10.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 10.0, 179.0, 6.0, 0.0, 9.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 194.0, 193.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 5.0, 0.0, 0.0, 2.0, 3.0, 0.0, 200.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 3.0, 0.0, 180.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 190.0, 4.0, 10.0, 16.0, 0.0, 3.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8737222018861058, "mean_inference_ms": 2.363980144999358, "mean_action_processing_ms": 0.415287967890168, "mean_env_wait_ms": 0.307467721421879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005339980125427246, "StateBufferConnector_ms": 0.007302403450012207, "ViewRequirementAgentConnector_ms": 0.1633516550064087}, "num_episodes": 18, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -26.51, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.984465009238, "num_env_steps_trained_throughput_per_sec": 314.984465009238, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2752000, "timers": {"training_iteration_time_ms": 13332.805, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13332.752, "sample_time_ms": 1960.829, "learn_time_ms": 11350.454, "learn_throughput": 352.409, "synch_weights_time_ms": 18.703}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "done": false, "training_iteration": 172, "trial_id": "e1352_00000", "date": "2024-08-13_17-17-15", "timestamp": 1723583835, "time_this_iter_s": 12.733987092971802, "time_total_s": 2349.764528989792, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17acb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2349.764528989792, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 52.54444444444445, "ram_util_percent": 81.99444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3560044339871546, "cur_kl_coeff": 1.8414157400459275e-10, "cur_lr": 0.009999999999999998, "total_loss": 1.1060028974656706, "policy_loss": 0.00023258067618207957, "vf_loss": 1.1057703169565352, "vf_explained_var": -8.041896517314608e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2790484550592573, "cur_kl_coeff": 4.421598345684418e-27, "cur_lr": 0.009999999999999998, "total_loss": 1.2541329565147559, "policy_loss": -0.00026010407107788575, "vf_loss": 1.2543930648180543, "vf_explained_var": -7.663454328264508e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -33.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -33.135, "predator_policy": 16.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 14.0, 5.0, 2.0, 10.0, 5.0, -15.0, -167.0, -9.0, -11.0, -10.0, 14.0, 3.0, -12.0, 0.0, 0.0, 0.0, 0.0, -1.0, 3.0, 0.0, 5.0, -4.0, 1.0, 13.0, -10.0, 6.0, 0.0, 0.0, 15.0, -5.0, 0.0, -162.0, 0.0, 15.0, -1.0, 1.0, 26.0, 3.0, -200.0, 0.0, -566.0, 8.0, 0.0, -4.0, 8.0, 1.0, 0.0, 2.0, 3.0, 0.0, -178.0, -2.0, 1.0, 8.0, -3.0, -9.0, 18.0, -180.0, 2.0, -600.0, 0.0, -194.0, -12.0, -3.0, -2.0, -5.0, 10.0, 15.0, 9.0, 23.0, 15.0, 0.0, 8.0, -26.0, 2.0, -518.0, 2.0, -173.0, 6.0, 7.0, 7.0, -165.0, -2.0, 10.0, -193.0, -3.0, 0.0, 0.0, -3.0, 0.0, -2.0, -199.0, -7.0, -9.0, -9.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 13.0, 0.0, -20.0, 15.0, 2.0, 0.0, -6.0, 13.0, 5.0, 0.0, 0.0, -30.0, -355.0, 3.0, 0.0, -18.0, 5.0, -36.0, 0.0, -20.0, 4.0, 10.0, 0.0, 3.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 5.0, -8.0, 0.0, 2.0, -388.0, 13.0, 0.0, 0.0, -20.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -15.0, 0.0, 0.0, -373.0, 15.0, 0.0, 0.0, 15.0, 0.0, 0.0, -2.0, -1.0, -6.0, 15.0, 11.0, 0.0, -2.0, -400.0, 0.0, 0.0, 0.0, -388.0, -372.0, 0.0, 8.0, 0.0, 0.0, 0.0, -14.0, 0.0, 8.0, 6.0, -15.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 0.0, 15.0, -388.0, -4.0, 0.0, 1.0, 0.0, 0.0, 8.0, -6.0, 0.0, 0.0, -19.0, 6.0, 9.0, 0.0, -360.0, 2.0, 0.0, -400.0, -400.0, 0.0, 0.0, -380.0, -8.0, -19.0, -19.0, 0.0, -6.0, -11.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 15.0, -11.0, 0.0, 7.0, 12.0, 0.0, 15.0, 0.0, 0.0, 8.0, 0.0, -38.0, -18.0, -3.0, 0.0, -349.0, -353.0, -7.0, -2.0, 15.0, -376.0, -14.0, 13.0, -8.0, 7.0, 10.0, -6.0, 0.0, -345.0, 0.0, -4.0, 13.0, -13.0, 0.0, -386.0, -13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -12.0, 0.0, 0.0, -12.0, 0.0, -400.0, 0.0, 0.0, -24.0, 0.0, -18.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 5.0, 10.0, 179.0, 6.0, 0.0, 9.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 194.0, 193.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 5.0, 0.0, 0.0, 2.0, 3.0, 0.0, 200.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 3.0, 0.0, 180.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 190.0, 4.0, 10.0, 16.0, 0.0, 3.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 5.0, 0.0, 184.0, 0.0, 1.0, 10.0, 188.0, 0.0, 7.0, 0.0, 0.0, 8.0, 3.0, 0.0, 0.0, 180.0, 2.0, 0.0, 0.0, 10.0, 0.0, 193.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 200.0, 1.0, 10.0, 7.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8735671402507899, "mean_inference_ms": 2.3660427872759264, "mean_action_processing_ms": 0.4149484513171578, "mean_env_wait_ms": 0.3072435252031183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004853963851928711, "StateBufferConnector_ms": 0.006038784980773926, "ViewRequirementAgentConnector_ms": 0.16042828559875488}, "num_episodes": 23, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -33.68, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.3584537584222, "num_env_steps_trained_throughput_per_sec": 322.3584537584222, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2768000, "timers": {"training_iteration_time_ms": 13358.475, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13358.42, "sample_time_ms": 1964.24, "learn_time_ms": 11372.085, "learn_throughput": 351.738, "synch_weights_time_ms": 18.811}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "done": false, "training_iteration": 173, "trial_id": "e1352_00000", "date": "2024-08-13_17-17-27", "timestamp": 1723583847, "time_this_iter_s": 12.464003086090088, "time_total_s": 2362.228532075882, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2a5ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2362.228532075882, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 49.94705882352941, "ram_util_percent": 81.98823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3988132234184176, "cur_kl_coeff": 9.207078700229638e-11, "cur_lr": 0.009999999999999998, "total_loss": 0.5380972947235461, "policy_loss": -0.00013431062719848735, "vf_loss": 0.5382316062384576, "vf_explained_var": 5.658656831771608e-07, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6963663578934587, "cur_kl_coeff": 2.210799172842209e-27, "cur_lr": 0.009999999999999998, "total_loss": 0.7400922285757525, "policy_loss": 3.527430718932202e-05, "vf_loss": 0.7400569508000026, "vf_explained_var": -3.4690533996259093e-10, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "env_runners": {"episode_reward_max": 26.0, "episode_reward_min": -600.0, "episode_reward_mean": -35.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.115, "predator_policy": 17.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, -4.0, 1.0, 13.0, -10.0, 6.0, 0.0, 0.0, 15.0, -5.0, 0.0, -162.0, 0.0, 15.0, -1.0, 1.0, 26.0, 3.0, -200.0, 0.0, -566.0, 8.0, 0.0, -4.0, 8.0, 1.0, 0.0, 2.0, 3.0, 0.0, -178.0, -2.0, 1.0, 8.0, -3.0, -9.0, 18.0, -180.0, 2.0, -600.0, 0.0, -194.0, -12.0, -3.0, -2.0, -5.0, 10.0, 15.0, 9.0, 23.0, 15.0, 0.0, 8.0, -26.0, 2.0, -518.0, 2.0, -173.0, 6.0, 7.0, 7.0, -165.0, -2.0, 10.0, -193.0, -3.0, 0.0, 0.0, -3.0, 0.0, -2.0, -199.0, -7.0, -9.0, -9.0, 0.0, 0.0, 0.0, -193.0, -10.0, 10.0, -16.0, 22.0, 0.0, 12.0, 0.0, 15.0, 0.0, -16.0, 20.0, 0.0, -188.0, 0.0, 0.0, -16.0, -5.0, 11.0, 0.0, -10.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 5.0, -8.0, 0.0, 2.0, -388.0, 13.0, 0.0, 0.0, -20.0, 0.0, -1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, -15.0, 0.0, 0.0, -373.0, 15.0, 0.0, 0.0, 15.0, 0.0, 0.0, -2.0, -1.0, -6.0, 15.0, 11.0, 0.0, -2.0, -400.0, 0.0, 0.0, 0.0, -388.0, -372.0, 0.0, 8.0, 0.0, 0.0, 0.0, -14.0, 0.0, 8.0, 6.0, -15.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 0.0, 15.0, -388.0, -4.0, 0.0, 1.0, 0.0, 0.0, 8.0, -6.0, 0.0, 0.0, -19.0, 6.0, 9.0, 0.0, -360.0, 2.0, 0.0, -400.0, -400.0, 0.0, 0.0, -380.0, -8.0, -19.0, -19.0, 0.0, -6.0, -11.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 15.0, -11.0, 0.0, 7.0, 12.0, 0.0, 15.0, 0.0, 0.0, 8.0, 0.0, -38.0, -18.0, -3.0, 0.0, -349.0, -353.0, -7.0, -2.0, 15.0, -376.0, -14.0, 13.0, -8.0, 7.0, 10.0, -6.0, 0.0, -345.0, 0.0, -4.0, 13.0, -13.0, 0.0, -386.0, -13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -12.0, 0.0, 0.0, -12.0, 0.0, -400.0, 0.0, 0.0, -24.0, 0.0, -18.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, -400.0, 0.0, -20.0, 10.0, 0.0, -20.0, -12.0, 15.0, 1.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -36.0, 15.0, 5.0, 0.0, 0.0, -366.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, -10.0, 0.0, 0.0, 7.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 4.0, 0.0, 194.0, 193.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 186.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 5.0, 0.0, 0.0, 2.0, 3.0, 0.0, 200.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 3.0, 0.0, 180.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 190.0, 4.0, 10.0, 16.0, 0.0, 3.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 5.0, 0.0, 184.0, 0.0, 1.0, 10.0, 188.0, 0.0, 7.0, 0.0, 0.0, 8.0, 3.0, 0.0, 0.0, 180.0, 2.0, 0.0, 0.0, 10.0, 0.0, 193.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 200.0, 1.0, 10.0, 7.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 183.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 5.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733983420913719, "mean_inference_ms": 2.3655286568092375, "mean_action_processing_ms": 0.4141498538570951, "mean_env_wait_ms": 0.30709912297462105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004534244537353516, "StateBufferConnector_ms": 0.006239652633666992, "ViewRequirementAgentConnector_ms": 0.1362541913986206}, "num_episodes": 22, "episode_return_max": 26.0, "episode_return_min": -600.0, "episode_return_mean": -35.63, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.1160648945279, "num_env_steps_trained_throughput_per_sec": 317.1160648945279, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2784000, "timers": {"training_iteration_time_ms": 13434.978, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13434.918, "sample_time_ms": 1975.794, "learn_time_ms": 11436.995, "learn_throughput": 349.742, "synch_weights_time_ms": 18.795}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "done": false, "training_iteration": 174, "trial_id": "e1352_00000", "date": "2024-08-13_17-17-40", "timestamp": 1723583860, "time_this_iter_s": 12.674417734146118, "time_total_s": 2374.902949810028, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1763310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2374.902949810028, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 51.30555555555556, "ram_util_percent": 82.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.219467935206864, "cur_kl_coeff": 4.603539350114819e-11, "cur_lr": 0.009999999999999998, "total_loss": 0.8323841141014503, "policy_loss": -0.00012455789776390824, "vf_loss": 0.8325086692180583, "vf_explained_var": -9.019538839027365e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0831742080759903, "cur_kl_coeff": 1.1053995864211046e-27, "cur_lr": 0.009999999999999998, "total_loss": 0.9357183502858909, "policy_loss": 3.522629282934956e-05, "vf_loss": 0.9356831243468655, "vf_explained_var": -9.871033764390088e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -600.0, "episode_reward_mean": -39.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.18, "predator_policy": 17.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-200.0, 0.0, -566.0, 8.0, 0.0, -4.0, 8.0, 1.0, 0.0, 2.0, 3.0, 0.0, -178.0, -2.0, 1.0, 8.0, -3.0, -9.0, 18.0, -180.0, 2.0, -600.0, 0.0, -194.0, -12.0, -3.0, -2.0, -5.0, 10.0, 15.0, 9.0, 23.0, 15.0, 0.0, 8.0, -26.0, 2.0, -518.0, 2.0, -173.0, 6.0, 7.0, 7.0, -165.0, -2.0, 10.0, -193.0, -3.0, 0.0, 0.0, -3.0, 0.0, -2.0, -199.0, -7.0, -9.0, -9.0, 0.0, 0.0, 0.0, -193.0, -10.0, 10.0, -16.0, 22.0, 0.0, 12.0, 0.0, 15.0, 0.0, -16.0, 20.0, 0.0, -188.0, 0.0, 0.0, -16.0, -5.0, 11.0, 0.0, -10.0, 0.0, 30.0, 1.0, -2.0, -11.0, 12.0, 7.0, 4.0, 15.0, 0.0, 9.0, 28.0, -10.0, 4.0, -10.0, -372.0, -199.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-400.0, 0.0, 0.0, 0.0, -388.0, -372.0, 0.0, 8.0, 0.0, 0.0, 0.0, -14.0, 0.0, 8.0, 6.0, -15.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 0.0, 0.0, 15.0, -388.0, -4.0, 0.0, 1.0, 0.0, 0.0, 8.0, -6.0, 0.0, 0.0, -19.0, 6.0, 9.0, 0.0, -360.0, 2.0, 0.0, -400.0, -400.0, 0.0, 0.0, -380.0, -8.0, -19.0, -19.0, 0.0, -6.0, -11.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 15.0, -11.0, 0.0, 7.0, 12.0, 0.0, 15.0, 0.0, 0.0, 8.0, 0.0, -38.0, -18.0, -3.0, 0.0, -349.0, -353.0, -7.0, -2.0, 15.0, -376.0, -14.0, 13.0, -8.0, 7.0, 10.0, -6.0, 0.0, -345.0, 0.0, -4.0, 13.0, -13.0, 0.0, -386.0, -13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -12.0, 0.0, 0.0, -12.0, 0.0, -400.0, 0.0, 0.0, -24.0, 0.0, -18.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, -400.0, 0.0, -20.0, 10.0, 0.0, -20.0, -12.0, 15.0, 1.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -36.0, 15.0, 5.0, 0.0, 0.0, -366.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, -10.0, 0.0, 0.0, 7.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 1.0, -12.0, 0.0, 0.0, -22.0, 4.0, 8.0, 1.0, 0.0, 0.0, 4.0, 15.0, 0.0, 0.0, 0.0, 0.0, 9.0, 15.0, 13.0, 0.0, -20.0, -22.0, 13.0, 0.0, -20.0, -357.0, -400.0, -398.0, 0.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 200.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 0.0, 0.0, 3.0, 0.0, 180.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 190.0, 4.0, 10.0, 16.0, 0.0, 3.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 5.0, 0.0, 184.0, 0.0, 1.0, 10.0, 188.0, 0.0, 7.0, 0.0, 0.0, 8.0, 3.0, 0.0, 0.0, 180.0, 2.0, 0.0, 0.0, 10.0, 0.0, 193.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 200.0, 1.0, 10.0, 7.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 183.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 5.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 3.0, 10.0, 0.0, 200.0, 185.0, 192.0, 7.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8727453412575552, "mean_inference_ms": 2.364799004108834, "mean_action_processing_ms": 0.4134851394810313, "mean_env_wait_ms": 0.30681741908420196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004502534866333008, "StateBufferConnector_ms": 0.006235361099243164, "ViewRequirementAgentConnector_ms": 0.13264238834381104}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -600.0, "episode_return_mean": -39.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.75658075024415, "num_env_steps_trained_throughput_per_sec": 321.75658075024415, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 13460.428, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13460.369, "sample_time_ms": 1977.792, "learn_time_ms": 11460.574, "learn_throughput": 349.023, "synch_weights_time_ms": 18.522}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 175, "trial_id": "e1352_00000", "date": "2024-08-13_17-17-52", "timestamp": 1723583872, "time_this_iter_s": 12.483605861663818, "time_total_s": 2387.386555671692, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17acb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2387.386555671692, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 54.116666666666674, "ram_util_percent": 83.27777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.043930619744314, "cur_kl_coeff": 2.3017696750574094e-11, "cur_lr": 0.009999999999999998, "total_loss": 0.7642204598617302, "policy_loss": -0.0002348556841117522, "vf_loss": 0.764455315675685, "vf_explained_var": -8.136507064577132e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1978703244641626, "cur_kl_coeff": 5.526997932105523e-28, "cur_lr": 0.009999999999999998, "total_loss": 0.8301394427500705, "policy_loss": -2.7708053864814615e-07, "vf_loss": 0.8301397219931007, "vf_explained_var": -5.5189485903139465e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -600.0, "episode_reward_mean": -34.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -33.485, "predator_policy": 16.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, -180.0, 2.0, -600.0, 0.0, -194.0, -12.0, -3.0, -2.0, -5.0, 10.0, 15.0, 9.0, 23.0, 15.0, 0.0, 8.0, -26.0, 2.0, -518.0, 2.0, -173.0, 6.0, 7.0, 7.0, -165.0, -2.0, 10.0, -193.0, -3.0, 0.0, 0.0, -3.0, 0.0, -2.0, -199.0, -7.0, -9.0, -9.0, 0.0, 0.0, 0.0, -193.0, -10.0, 10.0, -16.0, 22.0, 0.0, 12.0, 0.0, 15.0, 0.0, -16.0, 20.0, 0.0, -188.0, 0.0, 0.0, -16.0, -5.0, 11.0, 0.0, -10.0, 0.0, 30.0, 1.0, -2.0, -11.0, 12.0, 7.0, 4.0, 15.0, 0.0, 9.0, 28.0, -10.0, 4.0, -10.0, -372.0, -199.0, 0.0, 0.0, 0.0, -199.0, 0.0, 3.0, 2.0, 1.0, 6.0, -10.0, -2.0, -5.0, 9.0, 2.0, 29.0, 0.0, -10.0, 0.0, -200.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, 9.0, 0.0, -360.0, 2.0, 0.0, -400.0, -400.0, 0.0, 0.0, -380.0, -8.0, -19.0, -19.0, 0.0, -6.0, -11.0, 0.0, -10.0, 0.0, 10.0, 0.0, 0.0, 15.0, -11.0, 0.0, 7.0, 12.0, 0.0, 15.0, 0.0, 0.0, 8.0, 0.0, -38.0, -18.0, -3.0, 0.0, -349.0, -353.0, -7.0, -2.0, 15.0, -376.0, -14.0, 13.0, -8.0, 7.0, 10.0, -6.0, 0.0, -345.0, 0.0, -4.0, 13.0, -13.0, 0.0, -386.0, -13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -12.0, 0.0, 0.0, -12.0, 0.0, -400.0, 0.0, 0.0, -24.0, 0.0, -18.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, -400.0, 0.0, -20.0, 10.0, 0.0, -20.0, -12.0, 15.0, 1.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -36.0, 15.0, 5.0, 0.0, 0.0, -366.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, -10.0, 0.0, 0.0, 7.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 1.0, -12.0, 0.0, 0.0, -22.0, 4.0, 8.0, 1.0, 0.0, 0.0, 4.0, 15.0, 0.0, 0.0, 0.0, 0.0, 9.0, 15.0, 13.0, 0.0, -20.0, -22.0, 13.0, 0.0, -20.0, -357.0, -400.0, -398.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, 0.0, 0.0, 0.0, 0.0, -5.0, 2.0, 0.0, 1.0, 0.0, 0.0, 6.0, -20.0, 0.0, 0.0, -4.0, -15.0, 0.0, 6.0, 0.0, 0.0, 2.0, 14.0, 15.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 180.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 190.0, 4.0, 10.0, 16.0, 0.0, 3.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 5.0, 0.0, 184.0, 0.0, 1.0, 10.0, 188.0, 0.0, 7.0, 0.0, 0.0, 8.0, 3.0, 0.0, 0.0, 180.0, 2.0, 0.0, 0.0, 10.0, 0.0, 193.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 200.0, 1.0, 10.0, 7.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 183.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 5.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 3.0, 10.0, 0.0, 200.0, 185.0, 192.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720371495106011, "mean_inference_ms": 2.3638728015369996, "mean_action_processing_ms": 0.41281810949556624, "mean_env_wait_ms": 0.30652190658733863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004480719566345215, "StateBufferConnector_ms": 0.0038756132125854492, "ViewRequirementAgentConnector_ms": 0.12974095344543457}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -600.0, "episode_return_mean": -34.03, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.908681964884, "num_env_steps_trained_throughput_per_sec": 332.908681964884, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2816000, "timers": {"training_iteration_time_ms": 13460.827, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13460.767, "sample_time_ms": 1989.715, "learn_time_ms": 11449.826, "learn_throughput": 349.35, "synch_weights_time_ms": 17.864}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "done": false, "training_iteration": 176, "trial_id": "e1352_00000", "date": "2024-08-13_17-18-04", "timestamp": 1723583884, "time_this_iter_s": 12.033632040023804, "time_total_s": 2399.4201877117157, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1763dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2399.4201877117157, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 49.976470588235294, "ram_util_percent": 83.4235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3019027418118196, "cur_kl_coeff": 1.1508848375287047e-11, "cur_lr": 0.009999999999999998, "total_loss": 1.4265882166605146, "policy_loss": -0.00020055945891216793, "vf_loss": 1.4267887720197596, "vf_explained_var": -7.97882281913959e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1179442689532326, "cur_kl_coeff": 2.7634989660527614e-28, "cur_lr": 0.009999999999999998, "total_loss": 2.0528579724528804, "policy_loss": -0.0002033581279671539, "vf_loss": 2.0530613349859044, "vf_explained_var": -6.780422553814277e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -591.0, "episode_reward_mean": -39.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.08, "predator_policy": 17.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -518.0, 2.0, -173.0, 6.0, 7.0, 7.0, -165.0, -2.0, 10.0, -193.0, -3.0, 0.0, 0.0, -3.0, 0.0, -2.0, -199.0, -7.0, -9.0, -9.0, 0.0, 0.0, 0.0, -193.0, -10.0, 10.0, -16.0, 22.0, 0.0, 12.0, 0.0, 15.0, 0.0, -16.0, 20.0, 0.0, -188.0, 0.0, 0.0, -16.0, -5.0, 11.0, 0.0, -10.0, 0.0, 30.0, 1.0, -2.0, -11.0, 12.0, 7.0, 4.0, 15.0, 0.0, 9.0, 28.0, -10.0, 4.0, -10.0, -372.0, -199.0, 0.0, 0.0, 0.0, -199.0, 0.0, 3.0, 2.0, 1.0, 6.0, -10.0, -2.0, -5.0, 9.0, 2.0, 29.0, 0.0, -10.0, 0.0, -200.0, 0.0, 0.0, -591.0, 12.0, 20.0, -1.0, -8.0, -181.0, 25.0, 15.0, -3.0, 0.0, -8.0, 0.0, -562.0, -192.0, -1.0, -9.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0, 0.0, -349.0, -353.0, -7.0, -2.0, 15.0, -376.0, -14.0, 13.0, -8.0, 7.0, 10.0, -6.0, 0.0, -345.0, 0.0, -4.0, 13.0, -13.0, 0.0, -386.0, -13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, -12.0, 0.0, 0.0, -12.0, 0.0, -400.0, 0.0, 0.0, -24.0, 0.0, -18.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, -400.0, 0.0, -20.0, 10.0, 0.0, -20.0, -12.0, 15.0, 1.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -36.0, 15.0, 5.0, 0.0, 0.0, -366.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, -10.0, 0.0, 0.0, 7.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 1.0, -12.0, 0.0, 0.0, -22.0, 4.0, 8.0, 1.0, 0.0, 0.0, 4.0, 15.0, 0.0, 0.0, 0.0, 0.0, 9.0, 15.0, 13.0, 0.0, -20.0, -22.0, 13.0, 0.0, -20.0, -357.0, -400.0, -398.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, 0.0, 0.0, 0.0, 0.0, -5.0, 2.0, 0.0, 1.0, 0.0, 0.0, 6.0, -20.0, 0.0, 0.0, -4.0, -15.0, 0.0, 6.0, 0.0, 0.0, 2.0, 14.0, 15.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, -391.0, -400.0, 3.0, 9.0, 5.0, 15.0, -16.0, 7.0, 0.0, -16.0, -371.0, 0.0, 10.0, 15.0, 15.0, 0.0, -6.0, 0.0, 0.0, 0.0, 2.0, -20.0, 0.0, 0.0, -368.0, -388.0, 0.0, -388.0, -8.0, 3.0, -17.0, -2.0, 0.0, -8.0], "policy_predator_policy_reward": [5.0, 0.0, 184.0, 0.0, 1.0, 10.0, 188.0, 0.0, 7.0, 0.0, 0.0, 8.0, 3.0, 0.0, 0.0, 180.0, 2.0, 0.0, 0.0, 10.0, 0.0, 193.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 10.0, 0.0, 200.0, 1.0, 10.0, 7.0, 0.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 183.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 5.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 3.0, 10.0, 0.0, 200.0, 185.0, 192.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 194.0, 0.0, 0.0, 196.0, 4.0, 0.0, 0.0, 10.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8710391323176728, "mean_inference_ms": 2.3623453886017645, "mean_action_processing_ms": 0.4120536209192127, "mean_env_wait_ms": 0.3061698240606575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256486892700195, "StateBufferConnector_ms": 0.003791213035583496, "ViewRequirementAgentConnector_ms": 0.11873972415924072}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -591.0, "episode_return_mean": -39.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.9365594780293, "num_env_steps_trained_throughput_per_sec": 308.9365594780293, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2832000, "timers": {"training_iteration_time_ms": 13020.294, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13020.233, "sample_time_ms": 1992.236, "learn_time_ms": 11006.251, "learn_throughput": 363.43, "synch_weights_time_ms": 17.774}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "done": false, "training_iteration": 177, "trial_id": "e1352_00000", "date": "2024-08-13_17-18-18", "timestamp": 1723583898, "time_this_iter_s": 12.980066061019897, "time_total_s": 2412.4002537727356, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17c2a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2412.4002537727356, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 53.33157894736843, "ram_util_percent": 83.67894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4019182712744205, "cur_kl_coeff": 5.7544241876435235e-12, "cur_lr": 0.009999999999999998, "total_loss": 1.5668327050234274, "policy_loss": -8.500079900302269e-05, "vf_loss": 1.56691770752271, "vf_explained_var": -8.483412404539724e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3243051983077305, "cur_kl_coeff": 1.3817494830263807e-28, "cur_lr": 0.009999999999999998, "total_loss": 1.8628939124326858, "policy_loss": 1.330792746215901e-05, "vf_loss": 1.8628806095274668, "vf_explained_var": -7.064254195601852e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -591.0, "episode_reward_mean": -44.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.49, "predator_policy": 19.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.0, 22.0, 0.0, 12.0, 0.0, 15.0, 0.0, -16.0, 20.0, 0.0, -188.0, 0.0, 0.0, -16.0, -5.0, 11.0, 0.0, -10.0, 0.0, 30.0, 1.0, -2.0, -11.0, 12.0, 7.0, 4.0, 15.0, 0.0, 9.0, 28.0, -10.0, 4.0, -10.0, -372.0, -199.0, 0.0, 0.0, 0.0, -199.0, 0.0, 3.0, 2.0, 1.0, 6.0, -10.0, -2.0, -5.0, 9.0, 2.0, 29.0, 0.0, -10.0, 0.0, -200.0, 0.0, 0.0, -591.0, 12.0, 20.0, -1.0, -8.0, -181.0, 25.0, 15.0, -3.0, 0.0, -8.0, 0.0, -562.0, -192.0, -1.0, -9.0, 2.0, 12.0, -7.0, 0.0, 9.0, -18.0, 11.0, -362.0, -9.0, -4.0, 2.0, 0.0, -200.0, -157.0, 0.0, 4.0, -3.0, 2.0, -4.0, -25.0, -192.0, 0.0, 0.0, -200.0, 15.0, 0.0, -191.0, -584.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -12.0, 15.0, 1.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, -36.0, 15.0, 5.0, 0.0, 0.0, -366.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, -10.0, 0.0, 0.0, 7.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 15.0, 15.0, 0.0, 1.0, -12.0, 0.0, 0.0, -22.0, 4.0, 8.0, 1.0, 0.0, 0.0, 4.0, 15.0, 0.0, 0.0, 0.0, 0.0, 9.0, 15.0, 13.0, 0.0, -20.0, -22.0, 13.0, 0.0, -20.0, -357.0, -400.0, -398.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, 0.0, 0.0, 0.0, 0.0, -5.0, 2.0, 0.0, 1.0, 0.0, 0.0, 6.0, -20.0, 0.0, 0.0, -4.0, -15.0, 0.0, 6.0, 0.0, 0.0, 2.0, 14.0, 15.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, -391.0, -400.0, 3.0, 9.0, 5.0, 15.0, -16.0, 7.0, 0.0, -16.0, -371.0, 0.0, 10.0, 15.0, 15.0, 0.0, -6.0, 0.0, 0.0, 0.0, 2.0, -20.0, 0.0, 0.0, -368.0, -388.0, 0.0, -388.0, -8.0, 3.0, -17.0, -2.0, 0.0, -8.0, 12.0, 0.0, 0.0, -17.0, -10.0, 0.0, -16.0, 15.0, -17.0, -20.0, 0.0, 11.0, -362.0, -400.0, 0.0, -18.0, 0.0, -8.0, 2.0, 0.0, 0.0, 0.0, -400.0, 0.0, -367.0, 15.0, 0.0, 0.0, 4.0, 0.0, 0.0, -6.0, 2.0, 0.0, -36.0, 12.0, -20.0, -20.0, 6.0, -400.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -382.0, -394.0, -388.0], "policy_predator_policy_reward": [10.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 183.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 5.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 3.0, 10.0, 0.0, 200.0, 185.0, 192.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 194.0, 0.0, 0.0, 196.0, 4.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 9.0, 10.0, 0.0, 0.0, 200.0, 200.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 10.0, 15.0, 0.0, 9.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 10.0, 181.0, 198.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8688902333186248, "mean_inference_ms": 2.3604588319534257, "mean_action_processing_ms": 0.4109554362893528, "mean_env_wait_ms": 0.30539349445962904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038553476333618164, "StateBufferConnector_ms": 0.003782987594604492, "ViewRequirementAgentConnector_ms": 0.11421191692352295}, "num_episodes": 27, "episode_return_max": 30.0, "episode_return_min": -591.0, "episode_return_mean": -44.22, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 93.78398346927783, "num_env_steps_trained_throughput_per_sec": 93.78398346927783, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2848000, "timers": {"training_iteration_time_ms": 15791.278, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15791.216, "sample_time_ms": 1744.957, "learn_time_ms": 14022.351, "learn_throughput": 285.259, "synch_weights_time_ms": 19.444}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "done": false, "training_iteration": 178, "trial_id": "e1352_00000", "date": "2024-08-13_17-19-00", "timestamp": 1723583940, "time_this_iter_s": 42.78995895385742, "time_total_s": 2455.190212726593, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17880d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2455.190212726593, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 70.76, "ram_util_percent": 83.96800000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9278633713011417, "cur_kl_coeff": 2.8772120938217618e-12, "cur_lr": 0.009999999999999998, "total_loss": 0.3338882382899996, "policy_loss": 0.00011533084990722792, "vf_loss": 0.33377290808947735, "vf_explained_var": 3.772541959449728e-05, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2399835697173205, "cur_kl_coeff": 6.908747415131903e-29, "cur_lr": 0.009999999999999998, "total_loss": 0.4893363027444119, "policy_loss": -2.7000836574684376e-05, "vf_loss": 0.4893633006096857, "vf_explained_var": 1.9692680823109136e-05, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -591.0, "episode_reward_mean": -43.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.145, "predator_policy": 19.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 30.0, 1.0, -2.0, -11.0, 12.0, 7.0, 4.0, 15.0, 0.0, 9.0, 28.0, -10.0, 4.0, -10.0, -372.0, -199.0, 0.0, 0.0, 0.0, -199.0, 0.0, 3.0, 2.0, 1.0, 6.0, -10.0, -2.0, -5.0, 9.0, 2.0, 29.0, 0.0, -10.0, 0.0, -200.0, 0.0, 0.0, -591.0, 12.0, 20.0, -1.0, -8.0, -181.0, 25.0, 15.0, -3.0, 0.0, -8.0, 0.0, -562.0, -192.0, -1.0, -9.0, 2.0, 12.0, -7.0, 0.0, 9.0, -18.0, 11.0, -362.0, -9.0, -4.0, 2.0, 0.0, -200.0, -157.0, 0.0, 4.0, -3.0, 2.0, -4.0, -25.0, -192.0, 0.0, 0.0, -200.0, 15.0, 0.0, -191.0, -584.0, 13.0, 0.0, 0.0, 2.0, 0.0, 5.0, 14.0, 0.0, 4.0, 3.0, -162.0, -14.0, 6.0, 15.0, -8.0, 0.0, -15.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 15.0, 15.0, 0.0, 1.0, -12.0, 0.0, 0.0, -22.0, 4.0, 8.0, 1.0, 0.0, 0.0, 4.0, 15.0, 0.0, 0.0, 0.0, 0.0, 9.0, 15.0, 13.0, 0.0, -20.0, -22.0, 13.0, 0.0, -20.0, -357.0, -400.0, -398.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, 0.0, 0.0, 0.0, 0.0, -5.0, 2.0, 0.0, 1.0, 0.0, 0.0, 6.0, -20.0, 0.0, 0.0, -4.0, -15.0, 0.0, 6.0, 0.0, 0.0, 2.0, 14.0, 15.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, -391.0, -400.0, 3.0, 9.0, 5.0, 15.0, -16.0, 7.0, 0.0, -16.0, -371.0, 0.0, 10.0, 15.0, 15.0, 0.0, -6.0, 0.0, 0.0, 0.0, 2.0, -20.0, 0.0, 0.0, -368.0, -388.0, 0.0, -388.0, -8.0, 3.0, -17.0, -2.0, 0.0, -8.0, 12.0, 0.0, 0.0, -17.0, -10.0, 0.0, -16.0, 15.0, -17.0, -20.0, 0.0, 11.0, -362.0, -400.0, 0.0, -18.0, 0.0, -8.0, 2.0, 0.0, 0.0, 0.0, -400.0, 0.0, -367.0, 15.0, 0.0, 0.0, 4.0, 0.0, 0.0, -6.0, 2.0, 0.0, -36.0, 12.0, -20.0, -20.0, 6.0, -400.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -382.0, -394.0, -388.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 2.0, 14.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, -339.0, 0.0, -16.0, -16.0, 0.0, 6.0, 0.0, 15.0, -18.0, 0.0, 0.0, 0.0, 2.0, -35.0, -11.0, -2.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 3.0, 10.0, 0.0, 200.0, 185.0, 192.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 194.0, 0.0, 0.0, 196.0, 4.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 9.0, 10.0, 0.0, 0.0, 200.0, 200.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 10.0, 15.0, 0.0, 9.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 10.0, 181.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 177.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 8.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8708394822996032, "mean_inference_ms": 2.363927878678701, "mean_action_processing_ms": 0.4108584111589842, "mean_env_wait_ms": 0.30594094623060675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01298224925994873, "StateBufferConnector_ms": 0.0042629241943359375, "ViewRequirementAgentConnector_ms": 0.16450929641723633}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -591.0, "episode_return_mean": -43.9, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.2222559955105, "num_env_steps_trained_throughput_per_sec": 195.2222559955105, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2864000, "timers": {"training_iteration_time_ms": 16354.793, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16354.735, "sample_time_ms": 2063.977, "learn_time_ms": 14271.516, "learn_throughput": 280.279, "synch_weights_time_ms": 15.378}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "done": false, "training_iteration": 179, "trial_id": "e1352_00000", "date": "2024-08-13_17-19-21", "timestamp": 1723583961, "time_this_iter_s": 20.538594722747803, "time_total_s": 2475.728807449341, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1782af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2475.728807449341, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 83.2655172413793, "ram_util_percent": 83.79310344827586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4653470745354538, "cur_kl_coeff": 1.4386060469108809e-12, "cur_lr": 0.009999999999999998, "total_loss": 0.7163063304922568, "policy_loss": -0.0004643679155460583, "vf_loss": 0.7167706996320732, "vf_explained_var": -2.6490953233506945e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4320300633902865, "cur_kl_coeff": 3.454373707565952e-29, "cur_lr": 0.009999999999999998, "total_loss": 1.0457370311416014, "policy_loss": -5.5609262306933047e-05, "vf_loss": 1.0457926443171879, "vf_explained_var": -4.951285306738798e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -594.0, "episode_reward_mean": -46.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.325, "predator_policy": 18.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -199.0, 0.0, 3.0, 2.0, 1.0, 6.0, -10.0, -2.0, -5.0, 9.0, 2.0, 29.0, 0.0, -10.0, 0.0, -200.0, 0.0, 0.0, -591.0, 12.0, 20.0, -1.0, -8.0, -181.0, 25.0, 15.0, -3.0, 0.0, -8.0, 0.0, -562.0, -192.0, -1.0, -9.0, 2.0, 12.0, -7.0, 0.0, 9.0, -18.0, 11.0, -362.0, -9.0, -4.0, 2.0, 0.0, -200.0, -157.0, 0.0, 4.0, -3.0, 2.0, -4.0, -25.0, -192.0, 0.0, 0.0, -200.0, 15.0, 0.0, -191.0, -584.0, 13.0, 0.0, 0.0, 2.0, 0.0, 5.0, 14.0, 0.0, 4.0, 3.0, -162.0, -14.0, 6.0, 15.0, -8.0, 0.0, -15.0, -2.0, 15.0, -192.0, -594.0, 26.0, 0.0, -10.0, 0.0, -7.0, 0.0, -5.0, 0.0, 0.0, 14.0, 12.0, 15.0, 25.0, 0.0, -13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, -398.0, 0.0, 0.0, 0.0, 0.0, -5.0, 2.0, 0.0, 1.0, 0.0, 0.0, 6.0, -20.0, 0.0, 0.0, -4.0, -15.0, 0.0, 6.0, 0.0, 0.0, 2.0, 14.0, 15.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, -391.0, -400.0, 3.0, 9.0, 5.0, 15.0, -16.0, 7.0, 0.0, -16.0, -371.0, 0.0, 10.0, 15.0, 15.0, 0.0, -6.0, 0.0, 0.0, 0.0, 2.0, -20.0, 0.0, 0.0, -368.0, -388.0, 0.0, -388.0, -8.0, 3.0, -17.0, -2.0, 0.0, -8.0, 12.0, 0.0, 0.0, -17.0, -10.0, 0.0, -16.0, 15.0, -17.0, -20.0, 0.0, 11.0, -362.0, -400.0, 0.0, -18.0, 0.0, -8.0, 2.0, 0.0, 0.0, 0.0, -400.0, 0.0, -367.0, 15.0, 0.0, 0.0, 4.0, 0.0, 0.0, -6.0, 2.0, 0.0, -36.0, 12.0, -20.0, -20.0, 6.0, -400.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -382.0, -394.0, -388.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 2.0, 14.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, -339.0, 0.0, -16.0, -16.0, 0.0, 6.0, 0.0, 15.0, -18.0, 0.0, 0.0, 0.0, 2.0, -35.0, -11.0, -2.0, 15.0, 0.0, -398.0, 7.0, -400.0, -400.0, 15.0, 11.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -15.0, -4.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, -11.0, 13.0, 0.0, 15.0, 10.0, 15.0, 0.0, 0.0, -6.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 2.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 194.0, 0.0, 0.0, 196.0, 4.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 9.0, 10.0, 0.0, 0.0, 200.0, 200.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 10.0, 15.0, 0.0, 9.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 10.0, 181.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 177.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 8.0, 11.0, 0.0, 0.0, 0.0, 192.0, 7.0, 200.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.872243196808821, "mean_inference_ms": 2.368558468343874, "mean_action_processing_ms": 0.4108783704103712, "mean_env_wait_ms": 0.30633499779841705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013022899627685547, "StateBufferConnector_ms": 0.004270672798156738, "ViewRequirementAgentConnector_ms": 0.172698974609375}, "num_episodes": 18, "episode_return_max": 29.0, "episode_return_min": -594.0, "episode_return_mean": -46.1, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.04498031770396, "num_env_steps_trained_throughput_per_sec": 304.04498031770396, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 16372.569, "restore_workers_time_ms": 0.016, "training_step_time_ms": 16372.513, "sample_time_ms": 2060.463, "learn_time_ms": 14292.766, "learn_throughput": 279.862, "synch_weights_time_ms": 15.29}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 180, "trial_id": "e1352_00000", "date": "2024-08-13_17-19-34", "timestamp": 1723583974, "time_this_iter_s": 13.205506086349487, "time_total_s": 2488.9343135356903, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1782d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2488.9343135356903, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 55.047368421052624, "ram_util_percent": 83.64736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.61178301848319, "cur_kl_coeff": 7.193030234554404e-13, "cur_lr": 0.009999999999999998, "total_loss": 0.7062282041424797, "policy_loss": 2.628997702486616e-05, "vf_loss": 0.706201915273433, "vf_explained_var": 8.158582858938389e-07, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.413108396613798, "cur_kl_coeff": 1.727186853782976e-29, "cur_lr": 0.009999999999999998, "total_loss": 0.8172679894175084, "policy_loss": -0.00030137147710082075, "vf_loss": 0.8175693614264241, "vf_explained_var": 3.511785830139483e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -594.0, "episode_reward_mean": -44.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -39.95, "predator_policy": 17.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -591.0, 12.0, 20.0, -1.0, -8.0, -181.0, 25.0, 15.0, -3.0, 0.0, -8.0, 0.0, -562.0, -192.0, -1.0, -9.0, 2.0, 12.0, -7.0, 0.0, 9.0, -18.0, 11.0, -362.0, -9.0, -4.0, 2.0, 0.0, -200.0, -157.0, 0.0, 4.0, -3.0, 2.0, -4.0, -25.0, -192.0, 0.0, 0.0, -200.0, 15.0, 0.0, -191.0, -584.0, 13.0, 0.0, 0.0, 2.0, 0.0, 5.0, 14.0, 0.0, 4.0, 3.0, -162.0, -14.0, 6.0, 15.0, -8.0, 0.0, -15.0, -2.0, 15.0, -192.0, -594.0, 26.0, 0.0, -10.0, 0.0, -7.0, 0.0, -5.0, 0.0, 0.0, 14.0, 12.0, 15.0, 25.0, 0.0, -13.0, 0.0, 2.0, -3.0, -16.0, -10.0, 5.0, -184.0, -17.0, -5.0, -10.0, 6.0, -8.0, 0.0, -14.0, 11.0, -5.0, 5.0, 27.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, -391.0, -400.0, 3.0, 9.0, 5.0, 15.0, -16.0, 7.0, 0.0, -16.0, -371.0, 0.0, 10.0, 15.0, 15.0, 0.0, -6.0, 0.0, 0.0, 0.0, 2.0, -20.0, 0.0, 0.0, -368.0, -388.0, 0.0, -388.0, -8.0, 3.0, -17.0, -2.0, 0.0, -8.0, 12.0, 0.0, 0.0, -17.0, -10.0, 0.0, -16.0, 15.0, -17.0, -20.0, 0.0, 11.0, -362.0, -400.0, 0.0, -18.0, 0.0, -8.0, 2.0, 0.0, 0.0, 0.0, -400.0, 0.0, -367.0, 15.0, 0.0, 0.0, 4.0, 0.0, 0.0, -6.0, 2.0, 0.0, -36.0, 12.0, -20.0, -20.0, 6.0, -400.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -382.0, -394.0, -388.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 2.0, 14.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, -339.0, 0.0, -16.0, -16.0, 0.0, 6.0, 0.0, 15.0, -18.0, 0.0, 0.0, 0.0, 2.0, -35.0, -11.0, -2.0, 15.0, 0.0, -398.0, 7.0, -400.0, -400.0, 15.0, 11.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -15.0, -4.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, -11.0, 13.0, 0.0, 15.0, 10.0, 15.0, 0.0, 0.0, -6.0, -20.0, 0.0, 0.0, 0.0, -2.0, -8.0, 0.0, -36.0, 0.0, -20.0, 0.0, 0.0, 0.0, -376.0, 0.0, -36.0, 0.0, -10.0, 0.0, 0.0, -20.0, 15.0, -18.0, -6.0, -10.0, 0.0, 0.0, -19.0, -11.0, 0.0, 11.0, -4.0, -13.0, 15.0, -20.0, 12.0, 15.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 194.0, 0.0, 0.0, 196.0, 4.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 9.0, 10.0, 0.0, 0.0, 200.0, 200.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 10.0, 15.0, 0.0, 9.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 10.0, 181.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 177.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 8.0, 11.0, 0.0, 0.0, 0.0, 192.0, 7.0, 200.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 5.0, 0.0, 192.0, 9.0, 10.0, 5.0, 0.0, 0.0, 10.0, 0.0, 9.0, 5.0, 3.0, 0.0, 0.0, 2.0, 14.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.873666271330983, "mean_inference_ms": 2.3732273335857705, "mean_action_processing_ms": 0.41090449727973705, "mean_env_wait_ms": 0.30673305654036187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013389945030212402, "StateBufferConnector_ms": 0.004409909248352051, "ViewRequirementAgentConnector_ms": 0.17399001121520996}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -594.0, "episode_return_mean": -44.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.667803938975927, "num_env_steps_trained_throughput_per_sec": 12.667803938975927, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2896000, "timers": {"training_iteration_time_ms": 46717.38, "restore_workers_time_ms": 0.016, "training_step_time_ms": 46717.324, "sample_time_ms": 2057.582, "learn_time_ms": 44640.704, "learn_throughput": 89.604, "synch_weights_time_ms": 15.214}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "done": false, "training_iteration": 181, "trial_id": "e1352_00000", "date": "2024-08-13_17-24-50", "timestamp": 1723584290, "time_this_iter_s": 315.8161506652832, "time_total_s": 2804.7504642009735, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1782f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2804.7504642009735, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 55.921052631578945, "ram_util_percent": 83.07894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.19095094855419, "cur_kl_coeff": 3.596515117277202e-13, "cur_lr": 0.009999999999999998, "total_loss": 0.9471582074644704, "policy_loss": -0.000383562611406127, "vf_loss": 0.9475417700551805, "vf_explained_var": -4.478232570426174e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3381061412660755, "cur_kl_coeff": 8.63593426891488e-30, "cur_lr": 0.009999999999999998, "total_loss": 1.104893395162764, "policy_loss": 0.00019878504413460929, "vf_loss": 1.104694610061469, "vf_explained_var": -8.830317744502314e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -594.0, "episode_reward_mean": -38.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.88, "predator_policy": 18.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.0, 11.0, -362.0, -9.0, -4.0, 2.0, 0.0, -200.0, -157.0, 0.0, 4.0, -3.0, 2.0, -4.0, -25.0, -192.0, 0.0, 0.0, -200.0, 15.0, 0.0, -191.0, -584.0, 13.0, 0.0, 0.0, 2.0, 0.0, 5.0, 14.0, 0.0, 4.0, 3.0, -162.0, -14.0, 6.0, 15.0, -8.0, 0.0, -15.0, -2.0, 15.0, -192.0, -594.0, 26.0, 0.0, -10.0, 0.0, -7.0, 0.0, -5.0, 0.0, 0.0, 14.0, 12.0, 15.0, 25.0, 0.0, -13.0, 0.0, 2.0, -3.0, -16.0, -10.0, 5.0, -184.0, -17.0, -5.0, -10.0, 6.0, -8.0, 0.0, -14.0, 11.0, -5.0, 5.0, 27.0, 15.0, -2.0, 0.0, -161.0, -185.0, 0.0, 0.0, 1.0, 0.0, 0.0, -3.0, -201.0, 13.0, -185.0, 14.0, 0.0, -199.0, 24.0, 0.0, -18.0, -2.0, 0.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.0, -20.0, 0.0, 11.0, -362.0, -400.0, 0.0, -18.0, 0.0, -8.0, 2.0, 0.0, 0.0, 0.0, -400.0, 0.0, -367.0, 15.0, 0.0, 0.0, 4.0, 0.0, 0.0, -6.0, 2.0, 0.0, -36.0, 12.0, -20.0, -20.0, 6.0, -400.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -382.0, -394.0, -388.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 2.0, 14.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, -339.0, 0.0, -16.0, -16.0, 0.0, 6.0, 0.0, 15.0, -18.0, 0.0, 0.0, 0.0, 2.0, -35.0, -11.0, -2.0, 15.0, 0.0, -398.0, 7.0, -400.0, -400.0, 15.0, 11.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -15.0, -4.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, -11.0, 13.0, 0.0, 15.0, 10.0, 15.0, 0.0, 0.0, -6.0, -20.0, 0.0, 0.0, 0.0, -2.0, -8.0, 0.0, -36.0, 0.0, -20.0, 0.0, 0.0, 0.0, -376.0, 0.0, -36.0, 0.0, -10.0, 0.0, 0.0, -20.0, 15.0, -18.0, -6.0, -10.0, 0.0, 0.0, -19.0, -11.0, 0.0, 11.0, -4.0, -13.0, 15.0, -20.0, 12.0, 15.0, 15.0, 0.0, -4.0, 0.0, 0.0, 0.0, 15.0, -364.0, 0.0, -377.0, 0.0, 0.0, 0.0, 0.0, -18.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -16.0, -386.0, 15.0, -4.0, -400.0, 15.0, 13.0, 0.0, 0.0, 0.0, 0.0, -398.0, 10.0, 14.0, 0.0, 0.0, -16.0, -20.0, -14.0, 0.0, 0.0, 0.0, 7.0, -8.0], "policy_predator_policy_reward": [9.0, 10.0, 0.0, 0.0, 200.0, 200.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 10.0, 10.0, 15.0, 0.0, 9.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 10.0, 181.0, 198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 177.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 8.0, 11.0, 0.0, 0.0, 0.0, 192.0, 7.0, 200.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 5.0, 0.0, 192.0, 9.0, 10.0, 5.0, 0.0, 0.0, 10.0, 0.0, 9.0, 5.0, 3.0, 0.0, 0.0, 2.0, 14.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 188.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 193.0, 2.0, 0.0, 1.0, 199.0, 0.0, 1.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 10.0, 2.0, 0.0, 0.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8757091991467502, "mean_inference_ms": 2.3807801585275206, "mean_action_processing_ms": 0.4113169555833084, "mean_env_wait_ms": 0.30723094792423256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015951037406921387, "StateBufferConnector_ms": 0.004536986351013184, "ViewRequirementAgentConnector_ms": 0.18046116828918457}, "num_episodes": 23, "episode_return_max": 27.0, "episode_return_min": -594.0, "episode_return_mean": -38.7, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.83434896193825, "num_env_steps_trained_throughput_per_sec": 308.83434896193825, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2912000, "timers": {"training_iteration_time_ms": 46742.669, "restore_workers_time_ms": 0.017, "training_step_time_ms": 46742.613, "sample_time_ms": 2091.014, "learn_time_ms": 44629.767, "learn_throughput": 89.626, "synch_weights_time_ms": 17.38}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "done": false, "training_iteration": 182, "trial_id": "e1352_00000", "date": "2024-08-13_17-25-03", "timestamp": 1723584303, "time_this_iter_s": 13.062515020370483, "time_total_s": 2817.812979221344, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1782790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2817.812979221344, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 52.48333333333333, "ram_util_percent": 83.70555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.287726243461295, "cur_kl_coeff": 1.798257558638601e-13, "cur_lr": 0.009999999999999998, "total_loss": 1.3843019445737204, "policy_loss": -0.00010788061559968997, "vf_loss": 1.3844098211596252, "vf_explained_var": -1.0344086500702712e-08, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2027956707370784, "cur_kl_coeff": 4.31796713445744e-30, "cur_lr": 0.009999999999999998, "total_loss": 2.0729470922833397, "policy_loss": 8.438410084674913e-05, "vf_loss": 2.072862707874762, "vf_explained_var": -6.086611873889096e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -594.0, "episode_reward_mean": -41.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.21, "predator_policy": 16.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-584.0, 13.0, 0.0, 0.0, 2.0, 0.0, 5.0, 14.0, 0.0, 4.0, 3.0, -162.0, -14.0, 6.0, 15.0, -8.0, 0.0, -15.0, -2.0, 15.0, -192.0, -594.0, 26.0, 0.0, -10.0, 0.0, -7.0, 0.0, -5.0, 0.0, 0.0, 14.0, 12.0, 15.0, 25.0, 0.0, -13.0, 0.0, 2.0, -3.0, -16.0, -10.0, 5.0, -184.0, -17.0, -5.0, -10.0, 6.0, -8.0, 0.0, -14.0, 11.0, -5.0, 5.0, 27.0, 15.0, -2.0, 0.0, -161.0, -185.0, 0.0, 0.0, 1.0, 0.0, 0.0, -3.0, -201.0, 13.0, -185.0, 14.0, 0.0, -199.0, 24.0, 0.0, -18.0, -2.0, 0.0, 3.0, 13.0, 0.0, 24.0, -12.0, -521.0, 0.0, 15.0, -210.0, -10.0, 5.0, 3.0, 0.0, 0.0, -587.0, 0.0, -181.0, 0.0, -5.0, 23.0, 5.0, 0.0, -185.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-394.0, -388.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 2.0, 14.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, -339.0, 0.0, -16.0, -16.0, 0.0, 6.0, 0.0, 15.0, -18.0, 0.0, 0.0, 0.0, 2.0, -35.0, -11.0, -2.0, 15.0, 0.0, -398.0, 7.0, -400.0, -400.0, 15.0, 11.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -15.0, -4.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, -11.0, 13.0, 0.0, 15.0, 10.0, 15.0, 0.0, 0.0, -6.0, -20.0, 0.0, 0.0, 0.0, -2.0, -8.0, 0.0, -36.0, 0.0, -20.0, 0.0, 0.0, 0.0, -376.0, 0.0, -36.0, 0.0, -10.0, 0.0, 0.0, -20.0, 15.0, -18.0, -6.0, -10.0, 0.0, 0.0, -19.0, -11.0, 0.0, 11.0, -4.0, -13.0, 15.0, -20.0, 12.0, 15.0, 15.0, 0.0, -4.0, 0.0, 0.0, 0.0, 15.0, -364.0, 0.0, -377.0, 0.0, 0.0, 0.0, 0.0, -18.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -16.0, -386.0, 15.0, -4.0, -400.0, 15.0, 13.0, 0.0, 0.0, 0.0, 0.0, -398.0, 10.0, 14.0, 0.0, 0.0, -16.0, -20.0, -14.0, 0.0, 0.0, 0.0, 7.0, -8.0, 13.0, 0.0, 0.0, 0.0, 9.0, 15.0, -12.0, -20.0, -354.0, -349.0, 0.0, 0.0, 15.0, 0.0, -400.0, -20.0, -20.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, -388.0, 0.0, 0.0, -372.0, 1.0, 0.0, 0.0, -2.0, -14.0, 10.0, 13.0, 0.0, -2.0, 0.0, 0.0, 15.0, -400.0], "policy_predator_policy_reward": [198.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 177.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 8.0, 11.0, 0.0, 0.0, 0.0, 192.0, 7.0, 200.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 5.0, 0.0, 192.0, 9.0, 10.0, 5.0, 0.0, 0.0, 10.0, 0.0, 9.0, 5.0, 3.0, 0.0, 0.0, 2.0, 14.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 188.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 193.0, 2.0, 0.0, 1.0, 199.0, 0.0, 1.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 10.0, 2.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8794622723743992, "mean_inference_ms": 2.3904705758040103, "mean_action_processing_ms": 0.41192814629330227, "mean_env_wait_ms": 0.3083305503115295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019230961799621582, "StateBufferConnector_ms": 0.004822254180908203, "ViewRequirementAgentConnector_ms": 0.20893776416778564}, "num_episodes": 22, "episode_return_max": 27.0, "episode_return_min": -594.0, "episode_return_mean": -41.62, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.2393751724713, "num_env_steps_trained_throughput_per_sec": 270.2393751724713, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2928000, "timers": {"training_iteration_time_ms": 46981.983, "restore_workers_time_ms": 0.017, "training_step_time_ms": 46981.929, "sample_time_ms": 2293.662, "learn_time_ms": 44665.805, "learn_throughput": 89.554, "synch_weights_time_ms": 18.327}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "done": false, "training_iteration": 183, "trial_id": "e1352_00000", "date": "2024-08-13_17-25-18", "timestamp": 1723584318, "time_this_iter_s": 14.895763874053955, "time_total_s": 2832.708743095398, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17699d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2832.708743095398, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 60.24285714285715, "ram_util_percent": 83.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.079925041238743, "cur_kl_coeff": 8.991287793193006e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.8879426469878545, "policy_loss": -0.00023680950303084006, "vf_loss": 0.8881794552008311, "vf_explained_var": -4.667453664951224e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1715375239480403, "cur_kl_coeff": 2.15898356722872e-30, "cur_lr": 0.009999999999999998, "total_loss": 1.413657388075319, "policy_loss": 8.71793339866652e-05, "vf_loss": 1.413570204329869, "vf_explained_var": -7.758064875527034e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -594.0, "episode_reward_mean": -47.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.155, "predator_policy": 17.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, 15.0, -192.0, -594.0, 26.0, 0.0, -10.0, 0.0, -7.0, 0.0, -5.0, 0.0, 0.0, 14.0, 12.0, 15.0, 25.0, 0.0, -13.0, 0.0, 2.0, -3.0, -16.0, -10.0, 5.0, -184.0, -17.0, -5.0, -10.0, 6.0, -8.0, 0.0, -14.0, 11.0, -5.0, 5.0, 27.0, 15.0, -2.0, 0.0, -161.0, -185.0, 0.0, 0.0, 1.0, 0.0, 0.0, -3.0, -201.0, 13.0, -185.0, 14.0, 0.0, -199.0, 24.0, 0.0, -18.0, -2.0, 0.0, 3.0, 13.0, 0.0, 24.0, -12.0, -521.0, 0.0, 15.0, -210.0, -10.0, 5.0, 3.0, 0.0, 0.0, -587.0, 0.0, -181.0, 0.0, -5.0, 23.0, 5.0, 0.0, -185.0, -10.0, 2.0, 0.0, -553.0, 15.0, 0.0, -566.0, 0.0, 12.0, 0.0, 8.0, -199.0, 5.0, -17.0, -5.0, 0.0, -3.0, 18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.0, -2.0, 15.0, 0.0, -398.0, 7.0, -400.0, -400.0, 15.0, 11.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -15.0, -4.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, -11.0, 13.0, 0.0, 15.0, 10.0, 15.0, 0.0, 0.0, -6.0, -20.0, 0.0, 0.0, 0.0, -2.0, -8.0, 0.0, -36.0, 0.0, -20.0, 0.0, 0.0, 0.0, -376.0, 0.0, -36.0, 0.0, -10.0, 0.0, 0.0, -20.0, 15.0, -18.0, -6.0, -10.0, 0.0, 0.0, -19.0, -11.0, 0.0, 11.0, -4.0, -13.0, 15.0, -20.0, 12.0, 15.0, 15.0, 0.0, -4.0, 0.0, 0.0, 0.0, 15.0, -364.0, 0.0, -377.0, 0.0, 0.0, 0.0, 0.0, -18.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -16.0, -386.0, 15.0, -4.0, -400.0, 15.0, 13.0, 0.0, 0.0, 0.0, 0.0, -398.0, 10.0, 14.0, 0.0, 0.0, -16.0, -20.0, -14.0, 0.0, 0.0, 0.0, 7.0, -8.0, 13.0, 0.0, 0.0, 0.0, 9.0, 15.0, -12.0, -20.0, -354.0, -349.0, 0.0, 0.0, 15.0, 0.0, -400.0, -20.0, -20.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, -388.0, 0.0, 0.0, -372.0, 1.0, 0.0, 0.0, -2.0, -14.0, 10.0, 13.0, 0.0, -2.0, 0.0, 0.0, 15.0, -400.0, -20.0, 0.0, 1.0, 1.0, 0.0, 0.0, -400.0, -356.0, 15.0, 0.0, 0.0, 0.0, -378.0, -382.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, -398.0, 1.0, 4.0, -20.0, -14.0, -15.0, 0.0, 0.0, 0.0, -2.0, -4.0, 14.0, 4.0], "policy_predator_policy_reward": [11.0, 0.0, 0.0, 0.0, 192.0, 7.0, 200.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 5.0, 0.0, 192.0, 9.0, 10.0, 5.0, 0.0, 0.0, 10.0, 0.0, 9.0, 5.0, 3.0, 0.0, 0.0, 2.0, 14.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 188.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 193.0, 2.0, 0.0, 1.0, 199.0, 0.0, 1.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 10.0, 2.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 200.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 7.0, 192.0, 0.0, 0.0, 0.0, 17.0, 0.0, 10.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8800889374875303, "mean_inference_ms": 2.3934172839843084, "mean_action_processing_ms": 0.411917562270258, "mean_env_wait_ms": 0.30847147052723756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010848164558410645, "StateBufferConnector_ms": 0.004050850868225098, "ViewRequirementAgentConnector_ms": 0.15309250354766846}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -594.0, "episode_return_mean": -47.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.5222933538058, "num_env_steps_trained_throughput_per_sec": 302.5222933538058, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2944000, "timers": {"training_iteration_time_ms": 47042.831, "restore_workers_time_ms": 0.015, "training_step_time_ms": 47042.78, "sample_time_ms": 2289.706, "learn_time_ms": 44729.435, "learn_throughput": 89.427, "synch_weights_time_ms": 18.976}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "done": false, "training_iteration": 184, "trial_id": "e1352_00000", "date": "2024-08-13_17-25-32", "timestamp": 1723584332, "time_this_iter_s": 13.390857934951782, "time_total_s": 2846.0996010303497, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1763e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2846.0996010303497, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 57.51578947368421, "ram_util_percent": 83.63157894736844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3692032635729348, "cur_kl_coeff": 4.495643896596503e-14, "cur_lr": 0.009999999999999998, "total_loss": 1.1039236824190806, "policy_loss": 9.173003059846383e-06, "vf_loss": 1.1039145124415872, "vf_explained_var": -3.8159587395885e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0830040511551986, "cur_kl_coeff": 1.07949178361436e-30, "cur_lr": 0.009999999999999998, "total_loss": 1.3274208365294038, "policy_loss": 0.00010596315731250104, "vf_loss": 1.3273148711711642, "vf_explained_var": -5.676632835751488e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -587.0, "episode_reward_mean": -45.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.14, "predator_policy": 18.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 0.0, 2.0, -3.0, -16.0, -10.0, 5.0, -184.0, -17.0, -5.0, -10.0, 6.0, -8.0, 0.0, -14.0, 11.0, -5.0, 5.0, 27.0, 15.0, -2.0, 0.0, -161.0, -185.0, 0.0, 0.0, 1.0, 0.0, 0.0, -3.0, -201.0, 13.0, -185.0, 14.0, 0.0, -199.0, 24.0, 0.0, -18.0, -2.0, 0.0, 3.0, 13.0, 0.0, 24.0, -12.0, -521.0, 0.0, 15.0, -210.0, -10.0, 5.0, 3.0, 0.0, 0.0, -587.0, 0.0, -181.0, 0.0, -5.0, 23.0, 5.0, 0.0, -185.0, -10.0, 2.0, 0.0, -553.0, 15.0, 0.0, -566.0, 0.0, 12.0, 0.0, 8.0, -199.0, 5.0, -17.0, -5.0, 0.0, -3.0, 18.0, 0.0, 13.0, 12.0, 5.0, -3.0, -5.0, -5.0, -188.0, 0.0, 0.0, 0.0, -187.0, 0.0, 0.0, -176.0, -3.0, -5.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -20.0, 0.0, 0.0, 0.0, -2.0, -8.0, 0.0, -36.0, 0.0, -20.0, 0.0, 0.0, 0.0, -376.0, 0.0, -36.0, 0.0, -10.0, 0.0, 0.0, -20.0, 15.0, -18.0, -6.0, -10.0, 0.0, 0.0, -19.0, -11.0, 0.0, 11.0, -4.0, -13.0, 15.0, -20.0, 12.0, 15.0, 15.0, 0.0, -4.0, 0.0, 0.0, 0.0, 15.0, -364.0, 0.0, -377.0, 0.0, 0.0, 0.0, 0.0, -18.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -16.0, -386.0, 15.0, -4.0, -400.0, 15.0, 13.0, 0.0, 0.0, 0.0, 0.0, -398.0, 10.0, 14.0, 0.0, 0.0, -16.0, -20.0, -14.0, 0.0, 0.0, 0.0, 7.0, -8.0, 13.0, 0.0, 0.0, 0.0, 9.0, 15.0, -12.0, -20.0, -354.0, -349.0, 0.0, 0.0, 15.0, 0.0, -400.0, -20.0, -20.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, -388.0, 0.0, 0.0, -372.0, 1.0, 0.0, 0.0, -2.0, -14.0, 10.0, 13.0, 0.0, -2.0, 0.0, 0.0, 15.0, -400.0, -20.0, 0.0, 1.0, 1.0, 0.0, 0.0, -400.0, -356.0, 15.0, 0.0, 0.0, 0.0, -378.0, -382.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, -398.0, 1.0, 4.0, -20.0, -14.0, -15.0, 0.0, 0.0, 0.0, -2.0, -4.0, 14.0, 4.0, 0.0, 0.0, 13.0, -12.0, 0.0, 12.0, 5.0, 0.0, -21.0, 7.0, -15.0, 0.0, 0.0, -11.0, 0.0, -376.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -380.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, 15.0, -13.0, 0.0, -15.0, 0.0, 15.0, 0.0], "policy_predator_policy_reward": [10.0, 3.0, 0.0, 0.0, 4.0, 0.0, 5.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 5.0, 0.0, 192.0, 9.0, 10.0, 5.0, 0.0, 0.0, 10.0, 0.0, 9.0, 5.0, 3.0, 0.0, 0.0, 2.0, 14.0, 0.0, 0.0, 2.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 188.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 193.0, 2.0, 0.0, 1.0, 199.0, 0.0, 1.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 10.0, 2.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 200.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 7.0, 192.0, 0.0, 0.0, 0.0, 17.0, 0.0, 10.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 10.0, 0.0, 6.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8804745111550346, "mean_inference_ms": 2.3956584675374084, "mean_action_processing_ms": 0.4117924960090212, "mean_env_wait_ms": 0.3085291307790721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011324644088745117, "StateBufferConnector_ms": 0.003975868225097656, "ViewRequirementAgentConnector_ms": 0.13902902603149414}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -587.0, "episode_return_mean": -45.58, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.955669633813933, "num_env_steps_trained_throughput_per_sec": 5.955669633813933, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 112962.548, "restore_workers_time_ms": 0.015, "training_step_time_ms": 112962.497, "sample_time_ms": 2308.678, "learn_time_ms": 110629.723, "learn_throughput": 36.157, "synch_weights_time_ms": 19.468}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 185, "trial_id": "e1352_00000", "date": "2024-08-13_17-36-43", "timestamp": 1723585003, "time_this_iter_s": 671.7028660774231, "time_total_s": 3517.802467107773, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1782790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3517.802467107773, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 84.14999999999999, "ram_util_percent": 82.57857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2224591529404587, "cur_kl_coeff": 2.2478219482982514e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.733938163455832, "policy_loss": 0.00015404224839238895, "vf_loss": 0.7337841216494482, "vf_explained_var": -8.73570719723979e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1611603474859815, "cur_kl_coeff": 5.3974589180718e-31, "cur_lr": 0.009999999999999998, "total_loss": 1.0937412690489539, "policy_loss": -0.00024171714478778462, "vf_loss": 1.0939829875158253, "vf_explained_var": -7.09579104468936e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -587.0, "episode_reward_mean": -50.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -44.13, "predator_policy": 18.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 15.0, -2.0, 0.0, -161.0, -185.0, 0.0, 0.0, 1.0, 0.0, 0.0, -3.0, -201.0, 13.0, -185.0, 14.0, 0.0, -199.0, 24.0, 0.0, -18.0, -2.0, 0.0, 3.0, 13.0, 0.0, 24.0, -12.0, -521.0, 0.0, 15.0, -210.0, -10.0, 5.0, 3.0, 0.0, 0.0, -587.0, 0.0, -181.0, 0.0, -5.0, 23.0, 5.0, 0.0, -185.0, -10.0, 2.0, 0.0, -553.0, 15.0, 0.0, -566.0, 0.0, 12.0, 0.0, 8.0, -199.0, 5.0, -17.0, -5.0, 0.0, -3.0, 18.0, 0.0, 13.0, 12.0, 5.0, -3.0, -5.0, -5.0, -188.0, 0.0, 0.0, 0.0, -187.0, 0.0, 0.0, -176.0, -3.0, -5.0, 15.0, -538.0, 0.0, -18.0, 12.0, 0.0, 3.0, 0.0, -10.0, 0.0, 8.0, -159.0, 1.0, -14.0, 0.0, 10.0, -5.0, -10.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [12.0, 15.0, 15.0, 0.0, -4.0, 0.0, 0.0, 0.0, 15.0, -364.0, 0.0, -377.0, 0.0, 0.0, 0.0, 0.0, -18.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, -16.0, -386.0, 15.0, -4.0, -400.0, 15.0, 13.0, 0.0, 0.0, 0.0, 0.0, -398.0, 10.0, 14.0, 0.0, 0.0, -16.0, -20.0, -14.0, 0.0, 0.0, 0.0, 7.0, -8.0, 13.0, 0.0, 0.0, 0.0, 9.0, 15.0, -12.0, -20.0, -354.0, -349.0, 0.0, 0.0, 15.0, 0.0, -400.0, -20.0, -20.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, -388.0, 0.0, 0.0, -372.0, 1.0, 0.0, 0.0, -2.0, -14.0, 10.0, 13.0, 0.0, -2.0, 0.0, 0.0, 15.0, -400.0, -20.0, 0.0, 1.0, 1.0, 0.0, 0.0, -400.0, -356.0, 15.0, 0.0, 0.0, 0.0, -378.0, -382.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, -398.0, 1.0, 4.0, -20.0, -14.0, -15.0, 0.0, 0.0, 0.0, -2.0, -4.0, 14.0, 4.0, 0.0, 0.0, 13.0, -12.0, 0.0, 12.0, 5.0, 0.0, -21.0, 7.0, -15.0, 0.0, 0.0, -11.0, 0.0, -376.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -380.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, 15.0, -13.0, 0.0, -15.0, 0.0, 15.0, 0.0, -363.0, -362.0, 0.0, 0.0, -14.0, -24.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -1.0, 0.0, 8.0, 8.0, -348.0, 0.0, -9.0, 0.0, -32.0, 0.0, 0.0, -9.0, 9.0, -10.0, 0.0, 0.0, -20.0, 0.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 188.0, 192.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 8.0, 193.0, 2.0, 0.0, 1.0, 199.0, 0.0, 1.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 0.0, 10.0, 8.0, 10.0, 2.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 200.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 7.0, 192.0, 0.0, 0.0, 0.0, 17.0, 0.0, 10.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 10.0, 0.0, 6.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 0.0, 181.0, 0.0, 10.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8813743871536243, "mean_inference_ms": 2.3994001494815893, "mean_action_processing_ms": 0.41189398492701945, "mean_env_wait_ms": 0.30872321136243225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011170625686645508, "StateBufferConnector_ms": 0.003940701484680176, "ViewRequirementAgentConnector_ms": 0.16160082817077637}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -587.0, "episode_return_mean": -50.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.12683945565146, "num_env_steps_trained_throughput_per_sec": 281.12683945565146, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2976000, "timers": {"training_iteration_time_ms": 113183.863, "restore_workers_time_ms": 0.015, "training_step_time_ms": 113183.811, "sample_time_ms": 2427.641, "learn_time_ms": 110729.228, "learn_throughput": 36.124, "synch_weights_time_ms": 22.062}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "done": false, "training_iteration": 186, "trial_id": "e1352_00000", "date": "2024-08-13_17-36-58", "timestamp": 1723585018, "time_this_iter_s": 14.292176961898804, "time_total_s": 3532.0946440696716, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b5f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3532.0946440696716, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 66.65, "ram_util_percent": 83.785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5898312492596687, "cur_kl_coeff": 1.1239109741491257e-14, "cur_lr": 0.009999999999999998, "total_loss": 0.8165370160703936, "policy_loss": -0.0001290633456495704, "vf_loss": 0.8166660785408957, "vf_explained_var": 2.5399778255079156e-07, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.576041660279454, "cur_kl_coeff": 2.6987294590359e-31, "cur_lr": 0.009999999999999998, "total_loss": 1.0398940338620117, "policy_loss": -0.00015399260816001704, "vf_loss": 1.040048029593059, "vf_explained_var": -6.307369817501653e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -587.0, "episode_reward_mean": -53.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -45.03, "predator_policy": 18.335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -521.0, 0.0, 15.0, -210.0, -10.0, 5.0, 3.0, 0.0, 0.0, -587.0, 0.0, -181.0, 0.0, -5.0, 23.0, 5.0, 0.0, -185.0, -10.0, 2.0, 0.0, -553.0, 15.0, 0.0, -566.0, 0.0, 12.0, 0.0, 8.0, -199.0, 5.0, -17.0, -5.0, 0.0, -3.0, 18.0, 0.0, 13.0, 12.0, 5.0, -3.0, -5.0, -5.0, -188.0, 0.0, 0.0, 0.0, -187.0, 0.0, 0.0, -176.0, -3.0, -5.0, 15.0, -538.0, 0.0, -18.0, 12.0, 0.0, 3.0, 0.0, -10.0, 0.0, 8.0, -159.0, 1.0, -14.0, 0.0, 10.0, -5.0, -10.0, -10.0, -549.0, -17.0, -10.0, -4.0, 0.0, 0.0, 2.0, -11.0, 15.0, -4.0, -185.0, 15.0, 5.0, 0.0, 5.0, 0.0, -196.0, 9.0, -7.0, -10.0, 9.0, -189.0, 3.0, 0.0, -10.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, -20.0, -354.0, -349.0, 0.0, 0.0, 15.0, 0.0, -400.0, -20.0, -20.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, -388.0, 0.0, 0.0, -372.0, 1.0, 0.0, 0.0, -2.0, -14.0, 10.0, 13.0, 0.0, -2.0, 0.0, 0.0, 15.0, -400.0, -20.0, 0.0, 1.0, 1.0, 0.0, 0.0, -400.0, -356.0, 15.0, 0.0, 0.0, 0.0, -378.0, -382.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, -398.0, 1.0, 4.0, -20.0, -14.0, -15.0, 0.0, 0.0, 0.0, -2.0, -4.0, 14.0, 4.0, 0.0, 0.0, 13.0, -12.0, 0.0, 12.0, 5.0, 0.0, -21.0, 7.0, -15.0, 0.0, 0.0, -11.0, 0.0, -376.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -380.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, 15.0, -13.0, 0.0, -15.0, 0.0, 15.0, 0.0, -363.0, -362.0, 0.0, 0.0, -14.0, -24.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -1.0, 0.0, 8.0, 8.0, -348.0, 0.0, -9.0, 0.0, -32.0, 0.0, 0.0, -9.0, 9.0, -10.0, 0.0, 0.0, -20.0, 0.0, -20.0, -349.0, -400.0, -10.0, -23.0, -13.0, -14.0, -4.0, -12.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, -16.0, -15.0, 0.0, 15.0, -8.0, 0.0, -382.0, 6.0, 0.0, 15.0, 0.0, 5.0, 0.0, 0.0, -20.0, 15.0, 0.0, 0.0, 0.0, -392.0, 4.0, 0.0, -8.0, -8.0, 0.0, -20.0, 0.0, -2.0, -382.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [10.0, 10.0, 182.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 200.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 200.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 7.0, 192.0, 0.0, 0.0, 0.0, 17.0, 0.0, 10.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 10.0, 0.0, 6.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 0.0, 181.0, 0.0, 10.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 200.0, 12.0, 4.0, 7.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 192.0, 5.0, 0.0, 0.0, 9.0, 10.0, 0.0, 4.0, 7.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8817573131358809, "mean_inference_ms": 2.4049722232864337, "mean_action_processing_ms": 0.417828963353974, "mean_env_wait_ms": 0.3087097591869268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006595492362976074, "StateBufferConnector_ms": 0.006103157997131348, "ViewRequirementAgentConnector_ms": 0.192388653755188}, "num_episodes": 27, "episode_return_max": 23.0, "episode_return_min": -587.0, "episode_return_mean": -53.39, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.844311135978153, "num_env_steps_trained_throughput_per_sec": 15.844311135978153, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2992000, "timers": {"training_iteration_time_ms": 137134.753, "restore_workers_time_ms": 0.014, "training_step_time_ms": 137134.702, "sample_time_ms": 2686.56, "learn_time_ms": 134389.866, "learn_throughput": 29.764, "synch_weights_time_ms": 53.697}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "done": false, "training_iteration": 187, "trial_id": "e1352_00000", "date": "2024-08-13_17-41-10", "timestamp": 1723585270, "time_this_iter_s": 252.55848813056946, "time_total_s": 3784.653132200241, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1763af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3784.653132200241, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 59.22727272727273, "ram_util_percent": 83.79545454545458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2982760477028528, "cur_kl_coeff": 5.6195548707456285e-15, "cur_lr": 0.009999999999999998, "total_loss": 0.5203407004081383, "policy_loss": -0.0002966214666172626, "vf_loss": 0.520637322702105, "vf_explained_var": 1.0094945392911396e-07, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.264675837599798, "cur_kl_coeff": 1.34936472951795e-31, "cur_lr": 0.009999999999999998, "total_loss": 0.8328420751259993, "policy_loss": 1.649625917216615e-05, "vf_loss": 0.8328255794627011, "vf_explained_var": 3.4649536092445334e-07, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "env_runners": {"episode_reward_max": 18.0, "episode_reward_min": -566.0, "episode_reward_mean": -46.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -39.79, "predator_policy": 16.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185.0, -10.0, 2.0, 0.0, -553.0, 15.0, 0.0, -566.0, 0.0, 12.0, 0.0, 8.0, -199.0, 5.0, -17.0, -5.0, 0.0, -3.0, 18.0, 0.0, 13.0, 12.0, 5.0, -3.0, -5.0, -5.0, -188.0, 0.0, 0.0, 0.0, -187.0, 0.0, 0.0, -176.0, -3.0, -5.0, 15.0, -538.0, 0.0, -18.0, 12.0, 0.0, 3.0, 0.0, -10.0, 0.0, 8.0, -159.0, 1.0, -14.0, 0.0, 10.0, -5.0, -10.0, -10.0, -549.0, -17.0, -10.0, -4.0, 0.0, 0.0, 2.0, -11.0, 15.0, -4.0, -185.0, 15.0, 5.0, 0.0, 5.0, 0.0, -196.0, 9.0, -7.0, -10.0, 9.0, -189.0, 3.0, 0.0, -10.0, 0.0, 0.0, 8.0, 15.0, 5.0, -9.0, -195.0, 18.0, -10.0, 0.0, -26.0, -5.0, -556.0, 0.0, -1.0, -6.0, 6.0, 0.0, -2.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, -400.0, -20.0, 0.0, 1.0, 1.0, 0.0, 0.0, -400.0, -356.0, 15.0, 0.0, 0.0, 0.0, -378.0, -382.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, -398.0, 1.0, 4.0, -20.0, -14.0, -15.0, 0.0, 0.0, 0.0, -2.0, -4.0, 14.0, 4.0, 0.0, 0.0, 13.0, -12.0, 0.0, 12.0, 5.0, 0.0, -21.0, 7.0, -15.0, 0.0, 0.0, -11.0, 0.0, -376.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -380.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, 15.0, -13.0, 0.0, -15.0, 0.0, 15.0, 0.0, -363.0, -362.0, 0.0, 0.0, -14.0, -24.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -1.0, 0.0, 8.0, 8.0, -348.0, 0.0, -9.0, 0.0, -32.0, 0.0, 0.0, -9.0, 9.0, -10.0, 0.0, 0.0, -20.0, 0.0, -20.0, -349.0, -400.0, -10.0, -23.0, -13.0, -14.0, -4.0, -12.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, -16.0, -15.0, 0.0, 15.0, -8.0, 0.0, -382.0, 6.0, 0.0, 15.0, 0.0, 5.0, 0.0, 0.0, -20.0, 15.0, 0.0, 0.0, 0.0, -392.0, 4.0, 0.0, -8.0, -8.0, 0.0, -20.0, 0.0, -2.0, -382.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 9.0, -2.0, 15.0, 0.0, -1.0, 0.0, 0.0, -18.0, -400.0, 5.0, 15.0, 3.0, -11.0, -18.0, 0.0, 0.0, -20.0, -20.0, -16.0, 1.0, -373.0, -389.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, -2.0, 7.0, 0.0, 0.0, 0.0, -12.0, -4.0, 0.0], "policy_predator_policy_reward": [0.0, 200.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 200.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 7.0, 192.0, 0.0, 0.0, 0.0, 17.0, 0.0, 10.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 10.0, 0.0, 6.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 0.0, 181.0, 0.0, 10.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 200.0, 12.0, 4.0, 7.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 192.0, 5.0, 0.0, 0.0, 9.0, 10.0, 0.0, 4.0, 7.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 14.0, 2.0, 8.0, 196.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8830024428366952, "mean_inference_ms": 2.4077629985391495, "mean_action_processing_ms": 0.4215868738616372, "mean_env_wait_ms": 0.30915842141842625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005970478057861328, "StateBufferConnector_ms": 0.008641362190246582, "ViewRequirementAgentConnector_ms": 0.19397711753845215}, "num_episodes": 18, "episode_return_max": 18.0, "episode_return_min": -566.0, "episode_return_mean": -46.24, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.92406804091917, "num_env_steps_trained_throughput_per_sec": 280.92406804091917, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 3008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3008000, "timers": {"training_iteration_time_ms": 134293.504, "restore_workers_time_ms": 0.014, "training_step_time_ms": 134293.455, "sample_time_ms": 2866.814, "learn_time_ms": 131371.019, "learn_throughput": 30.448, "synch_weights_time_ms": 51.481}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "done": false, "training_iteration": 188, "trial_id": "e1352_00000", "date": "2024-08-13_17-41-25", "timestamp": 1723585285, "time_this_iter_s": 14.2845778465271, "time_total_s": 3798.937710046768, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1763dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3798.937710046768, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 67.74, "ram_util_percent": 83.77000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1599301344894917, "cur_kl_coeff": 2.8097774353728142e-15, "cur_lr": 0.009999999999999998, "total_loss": 0.40214224459317627, "policy_loss": -2.123546545152311e-06, "vf_loss": 0.40214436866143455, "vf_explained_var": 7.841921357250719e-06, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3023525784028664, "cur_kl_coeff": 6.74682364758975e-32, "cur_lr": 0.009999999999999998, "total_loss": 0.4974914742209924, "policy_loss": -9.52588906758046e-05, "vf_loss": 0.49758673425635724, "vf_explained_var": 2.080958987039233e-06, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "env_runners": {"episode_reward_max": 18.0, "episode_reward_min": -556.0, "episode_reward_mean": -30.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -27.955, "predator_policy": 12.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 0.0, 13.0, 12.0, 5.0, -3.0, -5.0, -5.0, -188.0, 0.0, 0.0, 0.0, -187.0, 0.0, 0.0, -176.0, -3.0, -5.0, 15.0, -538.0, 0.0, -18.0, 12.0, 0.0, 3.0, 0.0, -10.0, 0.0, 8.0, -159.0, 1.0, -14.0, 0.0, 10.0, -5.0, -10.0, -10.0, -549.0, -17.0, -10.0, -4.0, 0.0, 0.0, 2.0, -11.0, 15.0, -4.0, -185.0, 15.0, 5.0, 0.0, 5.0, 0.0, -196.0, 9.0, -7.0, -10.0, 9.0, -189.0, 3.0, 0.0, -10.0, 0.0, 0.0, 8.0, 15.0, 5.0, -9.0, -195.0, 18.0, -10.0, 0.0, -26.0, -5.0, -556.0, 0.0, -1.0, -6.0, 6.0, 0.0, -2.0, -2.0, 17.0, 4.0, 0.0, 5.0, -10.0, 9.0, -1.0, 4.0, 8.0, -6.0, 0.0, 8.0, 15.0, 0.0, 15.0, -9.0, 0.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [14.0, 4.0, 0.0, 0.0, 13.0, -12.0, 0.0, 12.0, 5.0, 0.0, -21.0, 7.0, -15.0, 0.0, 0.0, -11.0, 0.0, -376.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -380.0, 0.0, 0.0, 0.0, 0.0, 0.0, -382.0, 15.0, -13.0, 0.0, -15.0, 0.0, 15.0, 0.0, -363.0, -362.0, 0.0, 0.0, -14.0, -24.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -1.0, 0.0, 8.0, 8.0, -348.0, 0.0, -9.0, 0.0, -32.0, 0.0, 0.0, -9.0, 9.0, -10.0, 0.0, 0.0, -20.0, 0.0, -20.0, -349.0, -400.0, -10.0, -23.0, -13.0, -14.0, -4.0, -12.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, -16.0, -15.0, 0.0, 15.0, -8.0, 0.0, -382.0, 6.0, 0.0, 15.0, 0.0, 5.0, 0.0, 0.0, -20.0, 15.0, 0.0, 0.0, 0.0, -392.0, 4.0, 0.0, -8.0, -8.0, 0.0, -20.0, 0.0, -2.0, -382.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 9.0, -2.0, 15.0, 0.0, -1.0, 0.0, 0.0, -18.0, -400.0, 5.0, 15.0, 3.0, -11.0, -18.0, 0.0, 0.0, -20.0, -20.0, -16.0, 1.0, -373.0, -389.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, -2.0, 7.0, 0.0, 0.0, 0.0, -12.0, -4.0, 0.0, 9.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, -20.0, 0.0, 9.0, 0.0, 0.0, -2.0, 14.0, -20.0, 8.0, 0.0, -16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, 15.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 10.0, 0.0, 6.0, 188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 0.0, 0.0, 0.0, 0.0, 191.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 0.0, 181.0, 0.0, 10.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 200.0, 12.0, 4.0, 7.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 192.0, 5.0, 0.0, 0.0, 9.0, 10.0, 0.0, 4.0, 7.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 14.0, 2.0, 8.0, 196.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8835558389187292, "mean_inference_ms": 2.4112160374529843, "mean_action_processing_ms": 0.4253874230175502, "mean_env_wait_ms": 0.30931285447226015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005385398864746094, "StateBufferConnector_ms": 0.009237289428710938, "ViewRequirementAgentConnector_ms": 0.2024310827255249}, "num_episodes": 18, "episode_return_max": 18.0, "episode_return_min": -556.0, "episode_return_mean": -30.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.1192413287936, "num_env_steps_trained_throughput_per_sec": 323.1192413287936, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 3024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3024000, "timers": {"training_iteration_time_ms": 133482.491, "restore_workers_time_ms": 0.014, "training_step_time_ms": 133482.442, "sample_time_ms": 2451.607, "learn_time_ms": 130975.647, "learn_throughput": 30.54, "synch_weights_time_ms": 51.438}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "done": false, "training_iteration": 189, "trial_id": "e1352_00000", "date": "2024-08-13_17-41-37", "timestamp": 1723585297, "time_this_iter_s": 12.428845167160034, "time_total_s": 3811.366555213928, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17b80d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3811.366555213928, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 56.1888888888889, "ram_util_percent": 83.78333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1447621111409423, "cur_kl_coeff": 1.4048887176864071e-15, "cur_lr": 0.009999999999999998, "total_loss": 1.4397034290291013, "policy_loss": 3.533017816682341e-05, "vf_loss": 1.4396681016715116, "vf_explained_var": -8.3888018572772e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9775421553253192, "cur_kl_coeff": 3.373411823794875e-32, "cur_lr": 0.009999999999999998, "total_loss": 1.8267561458090626, "policy_loss": 6.751959266328308e-05, "vf_loss": 1.8266886274335246, "vf_explained_var": -1.147941306785301e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -600.0, "episode_reward_mean": -38.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -34.0, "predator_policy": 14.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -538.0, 0.0, -18.0, 12.0, 0.0, 3.0, 0.0, -10.0, 0.0, 8.0, -159.0, 1.0, -14.0, 0.0, 10.0, -5.0, -10.0, -10.0, -549.0, -17.0, -10.0, -4.0, 0.0, 0.0, 2.0, -11.0, 15.0, -4.0, -185.0, 15.0, 5.0, 0.0, 5.0, 0.0, -196.0, 9.0, -7.0, -10.0, 9.0, -189.0, 3.0, 0.0, -10.0, 0.0, 0.0, 8.0, 15.0, 5.0, -9.0, -195.0, 18.0, -10.0, 0.0, -26.0, -5.0, -556.0, 0.0, -1.0, -6.0, 6.0, 0.0, -2.0, -2.0, 17.0, 4.0, 0.0, 5.0, -10.0, 9.0, -1.0, 4.0, 8.0, -6.0, 0.0, 8.0, 15.0, 0.0, 15.0, -9.0, 0.0, 15.0, -191.0, 2.0, -200.0, 0.0, 9.0, -600.0, 0.0, -200.0, 1.0, 30.0, 2.0, -194.0, 0.0, 12.0, 0.0, 10.0, 5.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, -363.0, -362.0, 0.0, 0.0, -14.0, -24.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -1.0, 0.0, 8.0, 8.0, -348.0, 0.0, -9.0, 0.0, -32.0, 0.0, 0.0, -9.0, 9.0, -10.0, 0.0, 0.0, -20.0, 0.0, -20.0, -349.0, -400.0, -10.0, -23.0, -13.0, -14.0, -4.0, -12.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, -16.0, -15.0, 0.0, 15.0, -8.0, 0.0, -382.0, 6.0, 0.0, 15.0, 0.0, 5.0, 0.0, 0.0, -20.0, 15.0, 0.0, 0.0, 0.0, -392.0, 4.0, 0.0, -8.0, -8.0, 0.0, -20.0, 0.0, -2.0, -382.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 9.0, -2.0, 15.0, 0.0, -1.0, 0.0, 0.0, -18.0, -400.0, 5.0, 15.0, 3.0, -11.0, -18.0, 0.0, 0.0, -20.0, -20.0, -16.0, 1.0, -373.0, -389.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, -2.0, 7.0, 0.0, 0.0, 0.0, -12.0, -4.0, 0.0, 9.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, -20.0, 0.0, 9.0, 0.0, 0.0, -2.0, 14.0, -20.0, 8.0, 0.0, -16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, 15.0, -10.0, -372.0, 0.0, 2.0, 0.0, -400.0, 0.0, 0.0, 0.0, 4.0, -400.0, -400.0, 0.0, 0.0, -400.0, 0.0, 0.0, -9.0, 15.0, 15.0, 0.0, 2.0, 0.0, -388.0, 0.0, 0.0, 0.0, 12.0, 0.0, -10.0, 15.0, -15.0, -10.0, 5.0, 0.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 187.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 1.0, 0.0, 0.0, 0.0, 181.0, 0.0, 10.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 200.0, 12.0, 4.0, 7.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 192.0, 5.0, 0.0, 0.0, 9.0, 10.0, 0.0, 4.0, 7.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 14.0, 2.0, 8.0, 196.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 186.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8840316776571234, "mean_inference_ms": 2.4143074194285505, "mean_action_processing_ms": 0.4291486635854034, "mean_env_wait_ms": 0.3094345765671077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004957318305969238, "StateBufferConnector_ms": 0.009262323379516602, "ViewRequirementAgentConnector_ms": 0.20357024669647217}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -600.0, "episode_return_mean": -38.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.34651632096956, "num_env_steps_trained_throughput_per_sec": 355.34651632096956, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 133292.558, "restore_workers_time_ms": 0.014, "training_step_time_ms": 133292.509, "sample_time_ms": 2396.993, "learn_time_ms": 130840.527, "learn_throughput": 30.572, "synch_weights_time_ms": 51.38}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 190, "trial_id": "e1352_00000", "date": "2024-08-13_17-41-48", "timestamp": 1723585308, "time_this_iter_s": 11.277018785476685, "time_total_s": 3822.643573999405, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1769790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3822.643573999405, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 47.90625, "ram_util_percent": 82.30624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.360791724184947, "cur_kl_coeff": 7.024443588432036e-16, "cur_lr": 0.009999999999999998, "total_loss": 1.5080436743756451, "policy_loss": -0.00024207906708830878, "vf_loss": 1.5082857546667574, "vf_explained_var": -8.956465140852348e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0300393750889243, "cur_kl_coeff": 1.6867059118974374e-32, "cur_lr": 0.009999999999999998, "total_loss": 1.537916328935396, "policy_loss": -1.8253498686053765e-06, "vf_loss": 1.537918151087231, "vf_explained_var": -8.861854593589824e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -600.0, "episode_reward_mean": -36.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.89, "predator_policy": 17.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.0, -11.0, 15.0, -4.0, -185.0, 15.0, 5.0, 0.0, 5.0, 0.0, -196.0, 9.0, -7.0, -10.0, 9.0, -189.0, 3.0, 0.0, -10.0, 0.0, 0.0, 8.0, 15.0, 5.0, -9.0, -195.0, 18.0, -10.0, 0.0, -26.0, -5.0, -556.0, 0.0, -1.0, -6.0, 6.0, 0.0, -2.0, -2.0, 17.0, 4.0, 0.0, 5.0, -10.0, 9.0, -1.0, 4.0, 8.0, -6.0, 0.0, 8.0, 15.0, 0.0, 15.0, -9.0, 0.0, 15.0, -191.0, 2.0, -200.0, 0.0, 9.0, -600.0, 0.0, -200.0, 1.0, 30.0, 2.0, -194.0, 0.0, 12.0, 0.0, 10.0, 5.0, -10.0, -17.0, -187.0, 7.0, -189.0, 0.0, -178.0, 0.0, 0.0, 10.0, -9.0, 0.0, -166.0, 0.0, -10.0, 0.0, 0.0, -200.0, -196.0, -8.0, -2.0, 0.0, 1.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 2.0, 0.0, -16.0, -15.0, 0.0, 15.0, -8.0, 0.0, -382.0, 6.0, 0.0, 15.0, 0.0, 5.0, 0.0, 0.0, -20.0, 15.0, 0.0, 0.0, 0.0, -392.0, 4.0, 0.0, -8.0, -8.0, 0.0, -20.0, 0.0, -2.0, -382.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 9.0, -2.0, 15.0, 0.0, -1.0, 0.0, 0.0, -18.0, -400.0, 5.0, 15.0, 3.0, -11.0, -18.0, 0.0, 0.0, -20.0, -20.0, -16.0, 1.0, -373.0, -389.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, -2.0, 7.0, 0.0, 0.0, 0.0, -12.0, -4.0, 0.0, 9.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, -20.0, 0.0, 9.0, 0.0, 0.0, -2.0, 14.0, -20.0, 8.0, 0.0, -16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, 15.0, -10.0, -372.0, 0.0, 2.0, 0.0, -400.0, 0.0, 0.0, 0.0, 4.0, -400.0, -400.0, 0.0, 0.0, -400.0, 0.0, 0.0, -9.0, 15.0, 15.0, 0.0, 2.0, 0.0, -388.0, 0.0, 0.0, 0.0, 12.0, 0.0, -10.0, 15.0, -15.0, -10.0, 5.0, 0.0, -20.0, -20.0, -14.0, -13.0, -368.0, -6.0, 10.0, 11.0, -400.0, 0.0, 0.0, -371.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -18.0, 0.0, -18.0, -4.0, 15.0, -362.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -393.0, -37.0, 10.0, 0.0, -4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 192.0, 5.0, 0.0, 0.0, 9.0, 10.0, 0.0, 4.0, 7.0, 193.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 14.0, 2.0, 8.0, 196.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 186.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 7.0, 10.0, 10.0, 184.0, 3.0, 0.0, 200.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 12.0, 10.0, 181.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 197.0, 10.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8835768676678546, "mean_inference_ms": 2.4167665641857803, "mean_action_processing_ms": 0.43300326911818454, "mean_env_wait_ms": 0.3092416418077661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004736065864562988, "StateBufferConnector_ms": 0.009241223335266113, "ViewRequirementAgentConnector_ms": 0.15706121921539307}, "num_episodes": 23, "episode_return_max": 30.0, "episode_return_min": -600.0, "episode_return_mean": -36.93, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.8446322738035408, "num_env_steps_trained_throughput_per_sec": 1.8446322738035408, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 3056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3056000, "timers": {"training_iteration_time_ms": 318561.833, "restore_workers_time_ms": 0.017, "training_step_time_ms": 318561.78, "sample_time_ms": 2393.725, "learn_time_ms": 316111.724, "learn_throughput": 12.654, "synch_weights_time_ms": 52.65}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "done": false, "training_iteration": 191, "trial_id": "e1352_00000", "date": "2024-08-13_18-17-57", "timestamp": 1723587477, "time_this_iter_s": 2168.881744861603, "time_total_s": 5991.525318861008, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d59c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5991.525318861008, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 87.68108108108109, "ram_util_percent": 83.01621621621622}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3144848624021663, "cur_kl_coeff": 3.512221794216018e-16, "cur_lr": 0.009999999999999998, "total_loss": 0.8975378374574046, "policy_loss": -4.160231614988002e-05, "vf_loss": 0.8975794389843941, "vf_explained_var": -8.168043913664641e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.37514570029203, "cur_kl_coeff": 8.433529559487187e-33, "cur_lr": 0.009999999999999998, "total_loss": 0.9956770213330707, "policy_loss": 0.0001832549925893545, "vf_loss": 0.9954937680057747, "vf_explained_var": -8.798780895414807e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -600.0, "episode_reward_mean": -38.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.72, "predator_policy": 18.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 8.0, 15.0, 5.0, -9.0, -195.0, 18.0, -10.0, 0.0, -26.0, -5.0, -556.0, 0.0, -1.0, -6.0, 6.0, 0.0, -2.0, -2.0, 17.0, 4.0, 0.0, 5.0, -10.0, 9.0, -1.0, 4.0, 8.0, -6.0, 0.0, 8.0, 15.0, 0.0, 15.0, -9.0, 0.0, 15.0, -191.0, 2.0, -200.0, 0.0, 9.0, -600.0, 0.0, -200.0, 1.0, 30.0, 2.0, -194.0, 0.0, 12.0, 0.0, 10.0, 5.0, -10.0, -17.0, -187.0, 7.0, -189.0, 0.0, -178.0, 0.0, 0.0, 10.0, -9.0, 0.0, -166.0, 0.0, -10.0, 0.0, 0.0, -200.0, -196.0, -8.0, -2.0, 0.0, 1.0, 10.0, 0.0, -5.0, 9.0, -15.0, -2.0, -180.0, -6.0, -184.0, 0.0, -200.0, -15.0, 5.0, -194.0, 0.0, 0.0, 7.0, 12.0, 0.0, 0.0, 0.0, 3.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 9.0, -2.0, 15.0, 0.0, -1.0, 0.0, 0.0, -18.0, -400.0, 5.0, 15.0, 3.0, -11.0, -18.0, 0.0, 0.0, -20.0, -20.0, -16.0, 1.0, -373.0, -389.0, 0.0, 0.0, 0.0, -2.0, -26.0, 0.0, -2.0, 7.0, 0.0, 0.0, 0.0, -12.0, -4.0, 0.0, 9.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, -20.0, 0.0, 9.0, 0.0, 0.0, -2.0, 14.0, -20.0, 8.0, 0.0, -16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, 15.0, -10.0, -372.0, 0.0, 2.0, 0.0, -400.0, 0.0, 0.0, 0.0, 4.0, -400.0, -400.0, 0.0, 0.0, -400.0, 0.0, 0.0, -9.0, 15.0, 15.0, 0.0, 2.0, 0.0, -388.0, 0.0, 0.0, 0.0, 12.0, 0.0, -10.0, 15.0, -15.0, -10.0, 5.0, 0.0, -20.0, -20.0, -14.0, -13.0, -368.0, -6.0, 10.0, 11.0, -400.0, 0.0, 0.0, -371.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -18.0, 0.0, -18.0, -4.0, 15.0, -362.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -393.0, -37.0, 10.0, 0.0, -4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, -15.0, 0.0, 2.0, 7.0, -20.0, -10.0, 3.0, -18.0, -369.0, 0.0, -16.0, 0.0, -368.0, 0.0, 0.0, 0.0, -400.0, 0.0, -6.0, -18.0, 0.0, 5.0, -388.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 15.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 14.0, 2.0, 8.0, 196.0, 10.0, 0.0, 0.0, 0.0, 1.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 10.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 186.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 7.0, 10.0, 10.0, 184.0, 3.0, 0.0, 200.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 12.0, 10.0, 181.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 197.0, 10.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 4.0, 182.0, 7.0, 10.0, 0.0, 177.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 9.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.88488065898368, "mean_inference_ms": 2.42114716376922, "mean_action_processing_ms": 0.43266458427005206, "mean_env_wait_ms": 0.3098688274398954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007750749588012695, "StateBufferConnector_ms": 0.007994532585144043, "ViewRequirementAgentConnector_ms": 0.220068097114563}, "num_episodes": 22, "episode_return_max": 30.0, "episode_return_min": -600.0, "episode_return_mean": -38.94, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.7492181913646, "num_env_steps_trained_throughput_per_sec": 262.7492181913646, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 3072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 318789.004, "restore_workers_time_ms": 0.017, "training_step_time_ms": 318788.952, "sample_time_ms": 2579.414, "learn_time_ms": 316156.022, "learn_throughput": 12.652, "synch_weights_time_ms": 50.458}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "done": false, "training_iteration": 192, "trial_id": "e1352_00000", "date": "2024-08-13_18-18-13", "timestamp": 1723587493, "time_this_iter_s": 15.285156965255737, "time_total_s": 6006.810475826263, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b635e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6006.810475826263, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 65.48636363636363, "ram_util_percent": 83.9318181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.290722431582226, "cur_kl_coeff": 1.756110897108009e-16, "cur_lr": 0.009999999999999998, "total_loss": 1.512438095719726, "policy_loss": 0.000544697677016889, "vf_loss": 1.511893395992814, "vf_explained_var": -7.758064875527034e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.116392396698939, "cur_kl_coeff": 4.2167647797435934e-33, "cur_lr": 0.009999999999999998, "total_loss": 1.7007617946733873, "policy_loss": 0.00017073968592932616, "vf_loss": 1.700591058831997, "vf_explained_var": -6.622738308376736e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -600.0, "episode_reward_mean": -40.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.19, "predator_policy": 20.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, 17.0, 4.0, 0.0, 5.0, -10.0, 9.0, -1.0, 4.0, 8.0, -6.0, 0.0, 8.0, 15.0, 0.0, 15.0, -9.0, 0.0, 15.0, -191.0, 2.0, -200.0, 0.0, 9.0, -600.0, 0.0, -200.0, 1.0, 30.0, 2.0, -194.0, 0.0, 12.0, 0.0, 10.0, 5.0, -10.0, -17.0, -187.0, 7.0, -189.0, 0.0, -178.0, 0.0, 0.0, 10.0, -9.0, 0.0, -166.0, 0.0, -10.0, 0.0, 0.0, -200.0, -196.0, -8.0, -2.0, 0.0, 1.0, 10.0, 0.0, -5.0, 9.0, -15.0, -2.0, -180.0, -6.0, -184.0, 0.0, -200.0, -15.0, 5.0, -194.0, 0.0, 0.0, 7.0, 12.0, 0.0, 0.0, 0.0, 3.0, 15.0, 0.0, -1.0, 7.0, 18.0, -10.0, 5.0, -8.0, -185.0, -199.0, -200.0, -10.0, -190.0, 0.0, -5.0, 7.0, -10.0, 27.0, -176.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, 0.0, 9.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, -20.0, 0.0, 9.0, 0.0, 0.0, -2.0, 14.0, -20.0, 8.0, 0.0, -16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, 15.0, -10.0, -372.0, 0.0, 2.0, 0.0, -400.0, 0.0, 0.0, 0.0, 4.0, -400.0, -400.0, 0.0, 0.0, -400.0, 0.0, 0.0, -9.0, 15.0, 15.0, 0.0, 2.0, 0.0, -388.0, 0.0, 0.0, 0.0, 12.0, 0.0, -10.0, 15.0, -15.0, -10.0, 5.0, 0.0, -20.0, -20.0, -14.0, -13.0, -368.0, -6.0, 10.0, 11.0, -400.0, 0.0, 0.0, -371.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -18.0, 0.0, -18.0, -4.0, 15.0, -362.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -393.0, -37.0, 10.0, 0.0, -4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, -15.0, 0.0, 2.0, 7.0, -20.0, -10.0, 3.0, -18.0, -369.0, 0.0, -16.0, 0.0, -368.0, 0.0, 0.0, 0.0, -400.0, 0.0, -6.0, -18.0, 0.0, 5.0, -388.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 7.0, 14.0, 4.0, -20.0, 0.0, 0.0, 5.0, -12.0, -2.0, -400.0, 15.0, -398.0, 0.0, -400.0, 0.0, -20.0, 0.0, -380.0, 0.0, 0.0, 0.0, 0.0, -10.0, 7.0, 0.0, 0.0, -20.0, 15.0, 12.0, 0.0, -364.0], "policy_predator_policy_reward": [0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 186.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 7.0, 10.0, 10.0, 184.0, 3.0, 0.0, 200.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 12.0, 10.0, 181.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 197.0, 10.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 4.0, 182.0, 7.0, 10.0, 0.0, 177.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 9.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 200.0, 199.0, 0.0, 200.0, 0.0, 0.0, 10.0, 180.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 183.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8849935842017104, "mean_inference_ms": 2.42272489637082, "mean_action_processing_ms": 0.4322381344088327, "mean_env_wait_ms": 0.3100145543012008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007680058479309082, "StateBufferConnector_ms": 0.00541532039642334, "ViewRequirementAgentConnector_ms": 0.18938159942626953}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -600.0, "episode_return_mean": -40.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.3467328325892836, "num_env_steps_trained_throughput_per_sec": 2.3467328325892836, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 3088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3088000, "timers": {"training_iteration_time_ms": 487758.575, "restore_workers_time_ms": 0.017, "training_step_time_ms": 487758.522, "sample_time_ms": 2370.909, "learn_time_ms": 485333.453, "learn_throughput": 8.242, "synch_weights_time_ms": 51.2}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "done": false, "training_iteration": 193, "trial_id": "e1352_00000", "date": "2024-08-13_18-46-37", "timestamp": 1723589197, "time_this_iter_s": 1704.58838224411, "time_total_s": 7711.3988580703735, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17880d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7711.3988580703735, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 75.37916666666666, "ram_util_percent": 83.62916666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2083400963288216, "cur_kl_coeff": 8.780554485540044e-17, "cur_lr": 0.009999999999999998, "total_loss": 0.48701987857068024, "policy_loss": 8.226889284160087e-05, "vf_loss": 0.4869376069144993, "vf_explained_var": 0.00020899400509223737, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4694786401386075, "cur_kl_coeff": 2.1083823898717967e-33, "cur_lr": 0.009999999999999998, "total_loss": 0.9412792796081809, "policy_loss": 4.821655305999296e-06, "vf_loss": 0.9412744608978746, "vf_explained_var": -6.18122242115162e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -600.0, "episode_reward_mean": -48.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -46.83, "predator_policy": 22.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -191.0, 2.0, -200.0, 0.0, 9.0, -600.0, 0.0, -200.0, 1.0, 30.0, 2.0, -194.0, 0.0, 12.0, 0.0, 10.0, 5.0, -10.0, -17.0, -187.0, 7.0, -189.0, 0.0, -178.0, 0.0, 0.0, 10.0, -9.0, 0.0, -166.0, 0.0, -10.0, 0.0, 0.0, -200.0, -196.0, -8.0, -2.0, 0.0, 1.0, 10.0, 0.0, -5.0, 9.0, -15.0, -2.0, -180.0, -6.0, -184.0, 0.0, -200.0, -15.0, 5.0, -194.0, 0.0, 0.0, 7.0, 12.0, 0.0, 0.0, 0.0, 3.0, 15.0, 0.0, -1.0, 7.0, 18.0, -10.0, 5.0, -8.0, -185.0, -199.0, -200.0, -10.0, -190.0, 0.0, -5.0, 7.0, -10.0, 27.0, -176.0, -179.0, 6.0, -10.0, 0.0, -10.0, 0.0, 17.0, 15.0, -10.0, 11.0, 0.0, 0.0, -550.0, 18.0, 5.0, -2.0, 11.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 15.0, -10.0, -372.0, 0.0, 2.0, 0.0, -400.0, 0.0, 0.0, 0.0, 4.0, -400.0, -400.0, 0.0, 0.0, -400.0, 0.0, 0.0, -9.0, 15.0, 15.0, 0.0, 2.0, 0.0, -388.0, 0.0, 0.0, 0.0, 12.0, 0.0, -10.0, 15.0, -15.0, -10.0, 5.0, 0.0, -20.0, -20.0, -14.0, -13.0, -368.0, -6.0, 10.0, 11.0, -400.0, 0.0, 0.0, -371.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -18.0, 0.0, -18.0, -4.0, 15.0, -362.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -393.0, -37.0, 10.0, 0.0, -4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, -15.0, 0.0, 2.0, 7.0, -20.0, -10.0, 3.0, -18.0, -369.0, 0.0, -16.0, 0.0, -368.0, 0.0, 0.0, 0.0, -400.0, 0.0, -6.0, -18.0, 0.0, 5.0, -388.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 7.0, 14.0, 4.0, -20.0, 0.0, 0.0, 5.0, -12.0, -2.0, -400.0, 15.0, -398.0, 0.0, -400.0, 0.0, -20.0, 0.0, -380.0, 0.0, 0.0, 0.0, 0.0, -10.0, 7.0, 0.0, 0.0, -20.0, 15.0, 12.0, 0.0, -364.0, 0.0, -368.0, -1.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 5.0, 12.0, 8.0, 7.0, -20.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, -356.0, 5.0, 13.0, 0.0, 5.0, -4.0, 0.0, -10.0, 11.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 5.0, 186.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 5.0, 0.0, 0.0, 200.0, 0.0, 0.0, 200.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 7.0, 10.0, 10.0, 184.0, 3.0, 0.0, 200.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 12.0, 10.0, 181.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 197.0, 10.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 4.0, 182.0, 7.0, 10.0, 0.0, 177.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 9.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 200.0, 199.0, 0.0, 200.0, 0.0, 0.0, 10.0, 180.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 183.0, 5.0, 189.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8868124480786761, "mean_inference_ms": 2.4283555284220686, "mean_action_processing_ms": 0.43233681738565993, "mean_env_wait_ms": 0.3106254988057227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019930124282836914, "StateBufferConnector_ms": 0.004779338836669922, "ViewRequirementAgentConnector_ms": 0.2808852195739746}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -600.0, "episode_return_mean": -48.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.05030079611709, "num_env_steps_trained_throughput_per_sec": 230.05030079611709, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 3104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3104000, "timers": {"training_iteration_time_ms": 488175.108, "restore_workers_time_ms": 0.017, "training_step_time_ms": 488175.056, "sample_time_ms": 2722.742, "learn_time_ms": 485399.274, "learn_throughput": 8.241, "synch_weights_time_ms": 50.545}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "done": false, "training_iteration": 194, "trial_id": "e1352_00000", "date": "2024-08-13_18-46-55", "timestamp": 1723589215, "time_this_iter_s": 17.452924013137817, "time_total_s": 7728.851782083511, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1782c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7728.851782083511, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 83.32916666666667, "ram_util_percent": 82.81666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.266112973707452, "cur_kl_coeff": 4.390277242770022e-17, "cur_lr": 0.009999999999999998, "total_loss": 0.3880344650732777, "policy_loss": 1.9778530532247805e-05, "vf_loss": 0.3880146869746063, "vf_explained_var": 6.593888398831483e-05, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.579654440257828, "cur_kl_coeff": 1.0541911949358984e-33, "cur_lr": 0.009999999999999998, "total_loss": 0.6701014413261815, "policy_loss": -0.00016090450118537303, "vf_loss": 0.6702623455457912, "vf_explained_var": 1.735914321172805e-05, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -600.0, "episode_reward_mean": -40.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -39.34, "predator_policy": 19.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -17.0, -187.0, 7.0, -189.0, 0.0, -178.0, 0.0, 0.0, 10.0, -9.0, 0.0, -166.0, 0.0, -10.0, 0.0, 0.0, -200.0, -196.0, -8.0, -2.0, 0.0, 1.0, 10.0, 0.0, -5.0, 9.0, -15.0, -2.0, -180.0, -6.0, -184.0, 0.0, -200.0, -15.0, 5.0, -194.0, 0.0, 0.0, 7.0, 12.0, 0.0, 0.0, 0.0, 3.0, 15.0, 0.0, -1.0, 7.0, 18.0, -10.0, 5.0, -8.0, -185.0, -199.0, -200.0, -10.0, -190.0, 0.0, -5.0, 7.0, -10.0, 27.0, -176.0, -179.0, 6.0, -10.0, 0.0, -10.0, 0.0, 17.0, 15.0, -10.0, 11.0, 0.0, 0.0, -550.0, 18.0, 5.0, -2.0, 11.0, 0.0, 0.0, 0.0, -4.0, -2.0, -3.0, 0.0, 5.0, 2.0, -600.0, 11.0, 0.0, 11.0, 5.0, -7.0, 6.0, -9.0, 7.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -20.0, -20.0, -14.0, -13.0, -368.0, -6.0, 10.0, 11.0, -400.0, 0.0, 0.0, -371.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -18.0, 0.0, -18.0, -4.0, 15.0, -362.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, -393.0, -37.0, 10.0, 0.0, -4.0, 0.0, 0.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, -15.0, 0.0, 2.0, 7.0, -20.0, -10.0, 3.0, -18.0, -369.0, 0.0, -16.0, 0.0, -368.0, 0.0, 0.0, 0.0, -400.0, 0.0, -6.0, -18.0, 0.0, 5.0, -388.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 7.0, 14.0, 4.0, -20.0, 0.0, 0.0, 5.0, -12.0, -2.0, -400.0, 15.0, -398.0, 0.0, -400.0, 0.0, -20.0, 0.0, -380.0, 0.0, 0.0, 0.0, 0.0, -10.0, 7.0, 0.0, 0.0, -20.0, 15.0, 12.0, 0.0, -364.0, 0.0, -368.0, -1.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 5.0, 12.0, 8.0, 7.0, -20.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, -356.0, 5.0, 13.0, 0.0, 5.0, -4.0, 0.0, -10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -4.0, 0.0, -6.0, -4.0, 0.0, 0.0, -4.0, 3.0, 0.0, -4.0, -400.0, -400.0, 11.0, 0.0, 0.0, 0.0, 0.0, 8.0, -20.0, 15.0, -4.0, -20.0, 4.0, 2.0, 1.0, -20.0, 0.0, 7.0, 0.0, 12.0], "policy_predator_policy_reward": [0.0, 10.0, 7.0, 10.0, 10.0, 184.0, 3.0, 0.0, 200.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 9.0, 12.0, 10.0, 181.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 197.0, 10.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 4.0, 182.0, 7.0, 10.0, 0.0, 177.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 9.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 200.0, 199.0, 0.0, 200.0, 0.0, 0.0, 10.0, 180.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 183.0, 5.0, 189.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 6.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 7.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8889554377963378, "mean_inference_ms": 2.435338524311073, "mean_action_processing_ms": 0.4326512069665108, "mean_env_wait_ms": 0.3113889288525861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02000248432159424, "StateBufferConnector_ms": 0.006914734840393066, "ViewRequirementAgentConnector_ms": 0.31037282943725586}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -600.0, "episode_return_mean": -40.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.4580396382507, "num_env_steps_trained_throughput_per_sec": 308.4580396382507, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 422308.991, "restore_workers_time_ms": 0.017, "training_step_time_ms": 422308.936, "sample_time_ms": 2839.178, "learn_time_ms": 419416.768, "learn_throughput": 9.537, "synch_weights_time_ms": 50.523}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 195, "trial_id": "e1352_00000", "date": "2024-08-13_18-47-08", "timestamp": 1723589228, "time_this_iter_s": 13.01826286315918, "time_total_s": 7741.8700449466705, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d59c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7741.8700449466705, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 68.3421052631579, "ram_util_percent": 83.89473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.22755839392597, "cur_kl_coeff": 2.195138621385011e-17, "cur_lr": 0.009999999999999998, "total_loss": 0.6532415049258994, "policy_loss": 5.7883884895730904e-05, "vf_loss": 0.6531836207463313, "vf_explained_var": -4.162864079551091e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.243300270424323, "cur_kl_coeff": 5.270955974679492e-34, "cur_lr": 0.009999999999999998, "total_loss": 0.8029313843243967, "policy_loss": -0.0002978806381443979, "vf_loss": 0.803229263448526, "vf_explained_var": -5.108969552176339e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -600.0, "episode_reward_mean": -33.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -32.955, "predator_policy": 15.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, -2.0, -180.0, -6.0, -184.0, 0.0, -200.0, -15.0, 5.0, -194.0, 0.0, 0.0, 7.0, 12.0, 0.0, 0.0, 0.0, 3.0, 15.0, 0.0, -1.0, 7.0, 18.0, -10.0, 5.0, -8.0, -185.0, -199.0, -200.0, -10.0, -190.0, 0.0, -5.0, 7.0, -10.0, 27.0, -176.0, -179.0, 6.0, -10.0, 0.0, -10.0, 0.0, 17.0, 15.0, -10.0, 11.0, 0.0, 0.0, -550.0, 18.0, 5.0, -2.0, 11.0, 0.0, 0.0, 0.0, -4.0, -2.0, -3.0, 0.0, 5.0, 2.0, -600.0, 11.0, 0.0, 11.0, 5.0, -7.0, 6.0, -9.0, 7.0, 12.0, 26.0, -2.0, -10.0, 0.0, -9.0, 4.0, -9.0, -190.0, 8.0, 6.0, 1.0, 0.0, 15.0, 20.0, 0.0, -9.0, 11.0, -13.0, 27.0, -185.0, 0.0, -178.0, 10.0, 2.0, 0.0, 7.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -10.0, 3.0, -18.0, -369.0, 0.0, -16.0, 0.0, -368.0, 0.0, 0.0, 0.0, -400.0, 0.0, -6.0, -18.0, 0.0, 5.0, -388.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 7.0, 14.0, 4.0, -20.0, 0.0, 0.0, 5.0, -12.0, -2.0, -400.0, 15.0, -398.0, 0.0, -400.0, 0.0, -20.0, 0.0, -380.0, 0.0, 0.0, 0.0, 0.0, -10.0, 7.0, 0.0, 0.0, -20.0, 15.0, 12.0, 0.0, -364.0, 0.0, -368.0, -1.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 5.0, 12.0, 8.0, 7.0, -20.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, -356.0, 5.0, 13.0, 0.0, 5.0, -4.0, 0.0, -10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -4.0, 0.0, -6.0, -4.0, 0.0, 0.0, -4.0, 3.0, 0.0, -4.0, -400.0, -400.0, 11.0, 0.0, 0.0, 0.0, 0.0, 8.0, -20.0, 15.0, -4.0, -20.0, 4.0, 2.0, 1.0, -20.0, 0.0, 7.0, 0.0, 12.0, 15.0, 7.0, -4.0, 0.0, 0.0, -20.0, 0.0, 0.0, -18.0, 0.0, 4.0, 0.0, -12.0, -7.0, 2.0, -384.0, 8.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 12.0, 8.0, 0.0, 0.0, -15.0, -8.0, 0.0, 7.0, -26.0, 0.0, 15.0, 12.0, -400.0, 15.0, 0.0, 0.0, 0.0, -367.0, 10.0, 0.0, 0.0, -8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [15.0, 0.0, 9.0, 4.0, 182.0, 7.0, 10.0, 0.0, 177.0, 7.0, 0.0, 0.0, 0.0, 200.0, 0.0, 9.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 200.0, 199.0, 0.0, 200.0, 0.0, 0.0, 10.0, 180.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 183.0, 5.0, 189.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 6.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 7.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 192.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 4.0, 3.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8913963894361524, "mean_inference_ms": 2.4466190050684435, "mean_action_processing_ms": 0.4330997332485721, "mean_env_wait_ms": 0.3121937934889931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01826179027557373, "StateBufferConnector_ms": 0.006775617599487305, "ViewRequirementAgentConnector_ms": 0.29508090019226074}, "num_episodes": 27, "episode_return_max": 27.0, "episode_return_min": -600.0, "episode_return_mean": -33.96, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.9306844340258, "num_env_steps_trained_throughput_per_sec": 370.9306844340258, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 3136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3136000, "timers": {"training_iteration_time_ms": 421964.514, "restore_workers_time_ms": 0.017, "training_step_time_ms": 421964.46, "sample_time_ms": 2748.239, "learn_time_ms": 419165.132, "learn_throughput": 9.543, "synch_weights_time_ms": 48.799}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "done": false, "training_iteration": 196, "trial_id": "e1352_00000", "date": "2024-08-13_18-47-19", "timestamp": 1723589239, "time_this_iter_s": 10.842790126800537, "time_total_s": 7752.712835073471, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17699d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7752.712835073471, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 60.35333333333334, "ram_util_percent": 83.88666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.206004160092823, "cur_kl_coeff": 1.0975693106925056e-17, "cur_lr": 0.009999999999999998, "total_loss": 0.6302374024239797, "policy_loss": 7.57998316277745e-05, "vf_loss": 0.6301616017051317, "vf_explained_var": 3.642506069607205e-08, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0998318994120897, "cur_kl_coeff": 2.635477987339746e-34, "cur_lr": 0.009999999999999998, "total_loss": 0.7026033358944077, "policy_loss": -0.00026030159092178107, "vf_loss": 0.7028636391476664, "vf_explained_var": -4.257474626813616e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -600.0, "episode_reward_mean": -30.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -29.225, "predator_policy": 14.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 0.0, -1.0, 7.0, 18.0, -10.0, 5.0, -8.0, -185.0, -199.0, -200.0, -10.0, -190.0, 0.0, -5.0, 7.0, -10.0, 27.0, -176.0, -179.0, 6.0, -10.0, 0.0, -10.0, 0.0, 17.0, 15.0, -10.0, 11.0, 0.0, 0.0, -550.0, 18.0, 5.0, -2.0, 11.0, 0.0, 0.0, 0.0, -4.0, -2.0, -3.0, 0.0, 5.0, 2.0, -600.0, 11.0, 0.0, 11.0, 5.0, -7.0, 6.0, -9.0, 7.0, 12.0, 26.0, -2.0, -10.0, 0.0, -9.0, 4.0, -9.0, -190.0, 8.0, 6.0, 1.0, 0.0, 15.0, 20.0, 0.0, -9.0, 11.0, -13.0, 27.0, -185.0, 0.0, -178.0, 10.0, 2.0, 0.0, 7.0, 0.0, -191.0, 15.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, -7.0, -10.0, 12.0, -29.0, 0.0, 1.0, 0.0, -203.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 7.0, 14.0, 4.0, -20.0, 0.0, 0.0, 5.0, -12.0, -2.0, -400.0, 15.0, -398.0, 0.0, -400.0, 0.0, -20.0, 0.0, -380.0, 0.0, 0.0, 0.0, 0.0, -10.0, 7.0, 0.0, 0.0, -20.0, 15.0, 12.0, 0.0, -364.0, 0.0, -368.0, -1.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 5.0, 12.0, 8.0, 7.0, -20.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, -356.0, 5.0, 13.0, 0.0, 5.0, -4.0, 0.0, -10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -4.0, 0.0, -6.0, -4.0, 0.0, 0.0, -4.0, 3.0, 0.0, -4.0, -400.0, -400.0, 11.0, 0.0, 0.0, 0.0, 0.0, 8.0, -20.0, 15.0, -4.0, -20.0, 4.0, 2.0, 1.0, -20.0, 0.0, 7.0, 0.0, 12.0, 15.0, 7.0, -4.0, 0.0, 0.0, -20.0, 0.0, 0.0, -18.0, 0.0, 4.0, 0.0, -12.0, -7.0, 2.0, -384.0, 8.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 12.0, 8.0, 0.0, 0.0, -15.0, -8.0, 0.0, 7.0, -26.0, 0.0, 15.0, 12.0, -400.0, 15.0, 0.0, 0.0, 0.0, -367.0, 10.0, 0.0, 0.0, -8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 9.0, -400.0, 2.0, 13.0, 11.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, -17.0, 0.0, 0.0, -20.0, -6.0, 15.0, -20.0, -20.0, 0.0, 0.0, -3.0, 0.0, 0.0, 0.0, -6.0, -400.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 200.0, 199.0, 0.0, 200.0, 0.0, 0.0, 10.0, 180.0, 10.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 183.0, 5.0, 189.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 6.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 7.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 192.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 4.0, 3.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 3.0, 11.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4096909001253874, "mean_inference_ms": 3.139782489093369, "mean_action_processing_ms": 0.7772882991992773, "mean_env_wait_ms": 0.31315194851923783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01724827289581299, "StateBufferConnector_ms": 0.006067156791687012, "ViewRequirementAgentConnector_ms": 0.2507513761520386}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -600.0, "episode_return_mean": -30.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.194056744719852, "num_env_steps_trained_throughput_per_sec": 5.194056744719852, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 3152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3152000, "timers": {"training_iteration_time_ms": 473729.956, "restore_workers_time_ms": 0.017, "training_step_time_ms": 473729.902, "sample_time_ms": 78006.072, "learn_time_ms": 395704.452, "learn_throughput": 10.109, "synch_weights_time_ms": 16.986}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "done": false, "training_iteration": 197, "trial_id": "e1352_00000", "date": "2024-08-13_19-00-09", "timestamp": 1723590009, "time_this_iter_s": 770.1809639930725, "time_total_s": 8522.893799066544, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1769790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8522.893799066544, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 83.844, "ram_util_percent": 80.796}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.323001353703618, "cur_kl_coeff": 5.487846553462528e-18, "cur_lr": 0.009999999999999998, "total_loss": 0.518974062745218, "policy_loss": 0.00013694436801843857, "vf_loss": 0.5188371175934595, "vf_explained_var": 6.1419905808867604e-06, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.375589478705522, "cur_kl_coeff": 1.317738993669873e-34, "cur_lr": 0.009999999999999998, "total_loss": 0.6322838001583935, "policy_loss": -0.0003362127244669609, "vf_loss": 0.632620015902021, "vf_explained_var": -1.3876213598503637e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -600.0, "episode_reward_mean": -26.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -25.53, "predator_policy": 12.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176.0, -179.0, 6.0, -10.0, 0.0, -10.0, 0.0, 17.0, 15.0, -10.0, 11.0, 0.0, 0.0, -550.0, 18.0, 5.0, -2.0, 11.0, 0.0, 0.0, 0.0, -4.0, -2.0, -3.0, 0.0, 5.0, 2.0, -600.0, 11.0, 0.0, 11.0, 5.0, -7.0, 6.0, -9.0, 7.0, 12.0, 26.0, -2.0, -10.0, 0.0, -9.0, 4.0, -9.0, -190.0, 8.0, 6.0, 1.0, 0.0, 15.0, 20.0, 0.0, -9.0, 11.0, -13.0, 27.0, -185.0, 0.0, -178.0, 10.0, 2.0, 0.0, 7.0, 0.0, -191.0, 15.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, -7.0, -10.0, 12.0, -29.0, 0.0, 1.0, 0.0, -203.0, 4.0, 17.0, 11.0, 2.0, -180.0, -10.0, 0.0, -15.0, -12.0, 0.0, 4.0, -9.0, 0.0, -194.0, 0.0, -3.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -364.0, 0.0, -368.0, -1.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 5.0, 12.0, 8.0, 7.0, -20.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, -388.0, -356.0, 5.0, 13.0, 0.0, 5.0, -4.0, 0.0, -10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -4.0, 0.0, -6.0, -4.0, 0.0, 0.0, -4.0, 3.0, 0.0, -4.0, -400.0, -400.0, 11.0, 0.0, 0.0, 0.0, 0.0, 8.0, -20.0, 15.0, -4.0, -20.0, 4.0, 2.0, 1.0, -20.0, 0.0, 7.0, 0.0, 12.0, 15.0, 7.0, -4.0, 0.0, 0.0, -20.0, 0.0, 0.0, -18.0, 0.0, 4.0, 0.0, -12.0, -7.0, 2.0, -384.0, 8.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 12.0, 8.0, 0.0, 0.0, -15.0, -8.0, 0.0, 7.0, -26.0, 0.0, 15.0, 12.0, -400.0, 15.0, 0.0, 0.0, 0.0, -367.0, 10.0, 0.0, 0.0, -8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 9.0, -400.0, 2.0, 13.0, 11.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, -17.0, 0.0, 0.0, -20.0, -6.0, 15.0, -20.0, -20.0, 0.0, 0.0, -3.0, 0.0, 0.0, 0.0, -6.0, -400.0, 4.0, 0.0, 2.0, 15.0, 15.0, -8.0, 0.0, 1.0, -370.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, -20.0, -14.0, -14.0, 0.0, 0.0, 4.0, 0.0, -20.0, 1.0, 0.0, 0.0, 2.0, -393.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [183.0, 5.0, 189.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 194.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 6.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 7.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 192.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 4.0, 3.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 3.0, 11.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 3.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 184.0, 6.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9246223608526873, "mean_inference_ms": 3.830541337260884, "mean_action_processing_ms": 1.119750291985505, "mean_env_wait_ms": 0.3137844765165075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017304420471191406, "StateBufferConnector_ms": 0.00596010684967041, "ViewRequirementAgentConnector_ms": 0.25638818740844727}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -600.0, "episode_return_mean": -26.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.9396038674235, "num_env_steps_trained_throughput_per_sec": 307.9396038674235, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 3168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3168000, "timers": {"training_iteration_time_ms": 473605.039, "restore_workers_time_ms": 0.017, "training_step_time_ms": 473604.986, "sample_time_ms": 77852.654, "learn_time_ms": 395732.624, "learn_throughput": 10.108, "synch_weights_time_ms": 17.162}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "done": false, "training_iteration": 198, "trial_id": "e1352_00000", "date": "2024-08-13_19-00-22", "timestamp": 1723590022, "time_this_iter_s": 13.031546831130981, "time_total_s": 8535.925345897675, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b5f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8535.925345897675, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 57.48947368421052, "ram_util_percent": 83.8736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.360394788431632, "cur_kl_coeff": 2.743923276731264e-18, "cur_lr": 0.009999999999999998, "total_loss": 0.8605878270807721, "policy_loss": 0.0004138505268625166, "vf_loss": 0.8601739757038929, "vf_explained_var": 2.9581564444082754e-08, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1052649871217675, "cur_kl_coeff": 6.588694968349365e-35, "cur_lr": 0.009999999999999998, "total_loss": 1.1800980187440044, "policy_loss": -1.076099305122933e-05, "vf_loss": 1.1801087836424509, "vf_explained_var": -1.147941306785301e-08, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -600.0, "episode_reward_mean": -25.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -23.96, "predator_policy": 11.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -4.0, -2.0, -3.0, 0.0, 5.0, 2.0, -600.0, 11.0, 0.0, 11.0, 5.0, -7.0, 6.0, -9.0, 7.0, 12.0, 26.0, -2.0, -10.0, 0.0, -9.0, 4.0, -9.0, -190.0, 8.0, 6.0, 1.0, 0.0, 15.0, 20.0, 0.0, -9.0, 11.0, -13.0, 27.0, -185.0, 0.0, -178.0, 10.0, 2.0, 0.0, 7.0, 0.0, -191.0, 15.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, -7.0, -10.0, 12.0, -29.0, 0.0, 1.0, 0.0, -203.0, 4.0, 17.0, 11.0, 2.0, -180.0, -10.0, 0.0, -15.0, -12.0, 0.0, 4.0, -9.0, 0.0, -194.0, 0.0, -3.0, 0.0, 0.0, 4.0, 10.0, 13.0, 14.0, 9.0, 1.0, -5.0, 3.0, -3.0, 4.0, 28.0, 0.0, 0.0, -600.0, -12.0, -5.0, 13.0, -189.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, -4.0, 0.0, -6.0, -4.0, 0.0, 0.0, -4.0, 3.0, 0.0, -4.0, -400.0, -400.0, 11.0, 0.0, 0.0, 0.0, 0.0, 8.0, -20.0, 15.0, -4.0, -20.0, 4.0, 2.0, 1.0, -20.0, 0.0, 7.0, 0.0, 12.0, 15.0, 7.0, -4.0, 0.0, 0.0, -20.0, 0.0, 0.0, -18.0, 0.0, 4.0, 0.0, -12.0, -7.0, 2.0, -384.0, 8.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 12.0, 8.0, 0.0, 0.0, -15.0, -8.0, 0.0, 7.0, -26.0, 0.0, 15.0, 12.0, -400.0, 15.0, 0.0, 0.0, 0.0, -367.0, 10.0, 0.0, 0.0, -8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 9.0, -400.0, 2.0, 13.0, 11.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, -17.0, 0.0, 0.0, -20.0, -6.0, 15.0, -20.0, -20.0, 0.0, 0.0, -3.0, 0.0, 0.0, 0.0, -6.0, -400.0, 4.0, 0.0, 2.0, 15.0, 15.0, -8.0, 0.0, 1.0, -370.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, -20.0, -14.0, -14.0, 0.0, 0.0, 4.0, 0.0, -20.0, 1.0, 0.0, 0.0, 2.0, -393.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 1.0, 4.0, 0.0, 12.0, -6.0, 15.0, 9.0, 0.0, -3.0, 0.0, -17.0, 2.0, 0.0, -7.0, 0.0, -6.0, 4.0, 0.0, 13.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, -400.0, -24.0, 0.0, 0.0, -15.0, 0.0, 13.0, -378.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 6.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 7.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 2.0, 0.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 192.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 4.0, 3.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 3.0, 11.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 3.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 184.0, 6.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 4.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 10.0, 179.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4353187102973264, "mean_inference_ms": 4.513869087187239, "mean_action_processing_ms": 1.460016282325613, "mean_env_wait_ms": 0.3139374634219778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050318241119384766, "StateBufferConnector_ms": 0.005774497985839844, "ViewRequirementAgentConnector_ms": 0.17924833297729492}, "num_episodes": 18, "episode_return_max": 28.0, "episode_return_min": -600.0, "episode_return_mean": -25.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.4949866372146, "num_env_steps_trained_throughput_per_sec": 333.4949866372146, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 3184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3184000, "timers": {"training_iteration_time_ms": 473566.525, "restore_workers_time_ms": 0.017, "training_step_time_ms": 473566.471, "sample_time_ms": 77861.934, "learn_time_ms": 395683.972, "learn_throughput": 10.109, "synch_weights_time_ms": 17.828}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "done": false, "training_iteration": 199, "trial_id": "e1352_00000", "date": "2024-08-13_19-00-34", "timestamp": 1723590034, "time_this_iter_s": 12.020020961761475, "time_total_s": 8547.945366859436, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17699d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8547.945366859436, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 53.223529411764716, "ram_util_percent": 83.80588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1934339181465687, "cur_kl_coeff": 1.371961638365632e-18, "cur_lr": 0.009999999999999998, "total_loss": 2.1687456824161386, "policy_loss": -0.0001422860432987806, "vf_loss": 2.168887968038125, "vf_explained_var": -7.001180497426835e-09, "kl": 0.0, "entropy": 8.88983745767664e-42, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0736415701721813, "cur_kl_coeff": 3.2943474841746824e-35, "cur_lr": 0.009999999999999998, "total_loss": 2.475960986765604, "policy_loss": 0.00010793306396672966, "vf_loss": 2.4758530599099617, "vf_explained_var": -8.956465140852348e-09, "kl": 0.0, "entropy": 0.0, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 28.0, "episode_reward_min": -600.0, "episode_reward_mean": -39.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -38.135, "predator_policy": 18.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.0, 6.0, 1.0, 0.0, 15.0, 20.0, 0.0, -9.0, 11.0, -13.0, 27.0, -185.0, 0.0, -178.0, 10.0, 2.0, 0.0, 7.0, 0.0, -191.0, 15.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, -7.0, -10.0, 12.0, -29.0, 0.0, 1.0, 0.0, -203.0, 4.0, 17.0, 11.0, 2.0, -180.0, -10.0, 0.0, -15.0, -12.0, 0.0, 4.0, -9.0, 0.0, -194.0, 0.0, -3.0, 0.0, 0.0, 4.0, 10.0, 13.0, 14.0, 9.0, 1.0, -5.0, 3.0, -3.0, 4.0, 28.0, 0.0, 0.0, -600.0, -12.0, -5.0, 13.0, -189.0, -10.0, -552.0, -400.0, 6.0, -187.0, 3.0, -5.0, -200.0, -199.0, 1.0, 4.0, 0.0, -4.0, 15.0, -10.0, -27.0, -191.0, -13.0, -200.0, 12.0, -200.0, -1.0, 0.0, -25.0, 0.0, -5.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 12.0, 8.0, 0.0, 0.0, -15.0, -8.0, 0.0, 7.0, -26.0, 0.0, 15.0, 12.0, -400.0, 15.0, 0.0, 0.0, 0.0, -367.0, 10.0, 0.0, 0.0, -8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 9.0, -400.0, 2.0, 13.0, 11.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, -17.0, 0.0, 0.0, -20.0, -6.0, 15.0, -20.0, -20.0, 0.0, 0.0, -3.0, 0.0, 0.0, 0.0, -6.0, -400.0, 4.0, 0.0, 2.0, 15.0, 15.0, -8.0, 0.0, 1.0, -370.0, 0.0, -20.0, 0.0, 0.0, 0.0, -10.0, -20.0, -14.0, -14.0, 0.0, 0.0, 4.0, 0.0, -20.0, 1.0, 0.0, 0.0, 2.0, -393.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 1.0, 4.0, 0.0, 12.0, -6.0, 15.0, 9.0, 0.0, -3.0, 0.0, -17.0, 2.0, 0.0, -7.0, 0.0, -6.0, 4.0, 0.0, 13.0, 15.0, 0.0, 0.0, 0.0, 0.0, -400.0, -400.0, -24.0, 0.0, 0.0, -15.0, 0.0, 13.0, -378.0, 0.0, 0.0, -20.0, -372.0, -380.0, -400.0, -400.0, 6.0, 0.0, -365.0, -20.0, 0.0, 2.0, -10.0, 0.0, 0.0, -400.0, -398.0, 0.0, 0.0, -9.0, 0.0, 4.0, 0.0, 0.0, 0.0, -8.0, 0.0, 15.0, -10.0, -20.0, -20.0, -20.0, -382.0, 0.0, -15.0, -16.0, 0.0, -400.0, 11.0, 1.0, 0.0, -400.0, 5.0, -12.0, 0.0, 0.0, -15.0, -20.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 4.0, 3.0, 10.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 189.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 3.0, 11.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 200.0, 3.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 1.0, 184.0, 6.0, 10.0, 0.0, 0.0, 0.0, 10.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 197.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 4.0, 1.0, 0.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 10.0, 179.0, 0.0, 10.0, 190.0, 10.0, 200.0, 200.0, 0.0, 0.0, 10.0, 188.0, 0.0, 1.0, 5.0, 0.0, 200.0, 0.0, 0.0, 199.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 13.0, 0.0, 191.0, 10.0, 8.0, 0.0, 200.0, 0.0, 0.0, 200.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1973336804679815, "mean_inference_ms": 5.531213064876386, "mean_action_processing_ms": 1.9677945696786008, "mean_env_wait_ms": 0.3139654529610258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004931926727294922, "StateBufferConnector_ms": 0.0036237239837646484, "ViewRequirementAgentConnector_ms": 0.13778889179229736}, "num_episodes": 27, "episode_return_max": 28.0, "episode_return_min": -600.0, "episode_return_mean": -39.61, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.68865463524226, "num_env_steps_trained_throughput_per_sec": 79.68865463524226, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 477460.398, "restore_workers_time_ms": 0.017, "training_step_time_ms": 477460.344, "sample_time_ms": 77876.664, "learn_time_ms": 399562.009, "learn_throughput": 10.011, "synch_weights_time_ms": 18.515}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": true, "training_iteration": 200, "trial_id": "e1352_00000", "date": "2024-08-13_19-01-25", "timestamp": 1723590085, "time_this_iter_s": 50.240126848220825, "time_total_s": 8598.185493707657, "pid": 82779, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.01, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b7b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8598.185493707657, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 55.58888888888889, "ram_util_percent": 83.80555555555557}}
