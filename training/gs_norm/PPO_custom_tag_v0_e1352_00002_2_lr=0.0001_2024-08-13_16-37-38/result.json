{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.17551196695517296, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.5045047114135097, "policy_loss": -0.004579772571811364, "vf_loss": 3.5077445387209534, "vf_explained_var": 0.0020764905308920238, "kl": 0.006699777618302373, "entropy": 1.6026823810168676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.502151715174002, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.301215428397769, "policy_loss": -0.001158324159711363, "vf_loss": 6.30181309659645, "vf_explained_var": 0.005428872758118564, "kl": 0.002803142951395376, "entropy": 1.6065978844329794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -146.0, "episode_reward_mean": 29.333333333333332, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -206.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 88.0}, "policy_reward_mean": {"prey_policy": -10.055555555555555, "predator_policy": 24.72222222222222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -22.0, -3.0, 14.0, -26.0, 77.0, 90.0, -22.0, 15.0, 29.0, -23.0, -146.0, 121.0, 191.0, 294.0, -55.0, -93.0, 71.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 11.0, -111.0, 2.0, 2.0, -22.0, 14.0, 0.0, -118.0, 11.0, 22.0, 52.0, 88.0, 0.0, -175.0, 0.0, 10.0, -46.0, 3.0, 0.0, -62.0, 7.0, -154.0, -138.0, 43.0, 68.0, 191.0, 0.0, 121.0, 169.0, -110.0, 0.0, -46.0, -124.0, -206.0, 131.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 0.0, 0.0, 17.0, 0.0, 0.0, 55.0, 26.0, 3.0, 0.0, 2.0, 0.0, 83.0, 70.0, 51.0, 0.0, 0.0, 26.0, 0.0, 32.0, 69.0, 77.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 55.0, 75.0, 2.0, 88.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9327363342694596, "mean_inference_ms": 2.856286394543577, "mean_action_processing_ms": 0.35634242567929, "mean_env_wait_ms": 0.31965535307825094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017543633778889973, "StateBufferConnector_ms": 0.0034888585408528647, "ViewRequirementAgentConnector_ms": 0.12567241986592612}, "num_episodes": 18, "episode_return_max": 294.0, "episode_return_min": -146.0, "episode_return_mean": 29.333333333333332, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.1568456378977, "num_env_steps_trained_throughput_per_sec": 320.1568456378977, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12493.887, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12493.825, "sample_time_ms": 2071.204, "learn_time_ms": 10404.941, "learn_throughput": 384.433, "synch_weights_time_ms": 15.041}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "e1352_00002", "date": "2024-08-13_19-01-55", "timestamp": 1723590115, "time_this_iter_s": 12.550344228744507, "time_total_s": 12.550344228744507, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b17b8040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.550344228744507, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 57.363157894736844, "ram_util_percent": 83.65789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.26230903708390774, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.571358865026444, "policy_loss": -0.001041236276142102, "vf_loss": 3.5714999361643716, "vf_explained_var": -0.00010158306076413109, "kl": 0.00450080568358087, "entropy": 1.598251101075026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0629363459884804, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.951060342031812, "policy_loss": -0.0019018463765778555, "vf_loss": 6.952372272430904, "vf_explained_var": 0.02484385642425093, "kl": 0.005899226102974545, "entropy": 1.6033630494718198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -305.0, "episode_reward_mean": 27.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -250.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": -16.180555555555557, "predator_policy": 29.930555555555557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -22.0, -3.0, 14.0, -26.0, 77.0, 90.0, -22.0, 15.0, 29.0, -23.0, -146.0, 121.0, 191.0, 294.0, -55.0, -93.0, 71.0, 108.0, 85.0, 46.0, -18.0, 215.0, 88.0, 219.0, -305.0, -295.0, 92.0, 205.0, 19.0, -25.0, 103.0, -26.0, -63.0, -18.0, 32.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 11.0, -111.0, 2.0, 2.0, -22.0, 14.0, 0.0, -118.0, 11.0, 22.0, 52.0, 88.0, 0.0, -175.0, 0.0, 10.0, -46.0, 3.0, 0.0, -62.0, 7.0, -154.0, -138.0, 43.0, 68.0, 191.0, 0.0, 121.0, 169.0, -110.0, 0.0, -46.0, -124.0, -206.0, 131.0, 0.0, 79.0, 16.0, 43.0, 171.0, -250.0, 20.0, -94.0, 27.0, 182.0, 84.0, -7.0, 140.0, 10.0, -224.0, -238.0, -243.0, -214.0, -205.0, 164.0, 149.0, 12.0, -2.0, 9.0, 68.0, -191.0, 77.0, 4.0, -226.0, 51.0, 11.0, -153.0, -44.0, -61.0, 31.0, 1.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 0.0, 0.0, 17.0, 0.0, 0.0, 55.0, 26.0, 3.0, 0.0, 2.0, 0.0, 83.0, 70.0, 51.0, 0.0, 0.0, 26.0, 0.0, 32.0, 69.0, 77.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 55.0, 75.0, 2.0, 88.0, 58.0, 2.0, 27.0, 0.0, 26.0, 125.0, 0.0, 1.0, 55.0, 0.0, 6.0, 0.0, 11.0, 45.0, 24.0, 157.0, 0.0, 40.0, 122.0, 34.0, 99.0, 38.0, 6.0, 1.0, 11.0, 12.0, 86.0, 0.0, 22.0, 31.0, 118.0, 79.0, 0.0, 39.0, 48.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9892626770633153, "mean_inference_ms": 3.0189096290197557, "mean_action_processing_ms": 0.3844352452666823, "mean_env_wait_ms": 0.3397908946473967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043358405431111656, "StateBufferConnector_ms": 0.003599789407518175, "ViewRequirementAgentConnector_ms": 0.2200133270687527}, "num_episodes": 18, "episode_return_max": 294.0, "episode_return_min": -305.0, "episode_return_mean": 27.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.176679004423637, "num_env_steps_trained_throughput_per_sec": 21.176679004423637, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 100690.479, "restore_workers_time_ms": 0.058, "training_step_time_ms": 100690.354, "sample_time_ms": 2311.167, "learn_time_ms": 98363.681, "learn_throughput": 40.665, "synch_weights_time_ms": 13.624}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "e1352_00002", "date": "2024-08-13_19-05-07", "timestamp": 1723590307, "time_this_iter_s": 188.91773414611816, "time_total_s": 201.46807837486267, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1710790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 201.46807837486267, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 64.11739130434783, "ram_util_percent": 83.85217391304349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.23769419197012823, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.837277265578981, "policy_loss": -0.002827627019138721, "vf_loss": 4.839119980701063, "vf_explained_var": 0.00010972218538718248, "kl": 0.009848888107280535, "entropy": 1.5954298010578862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8146404214952357, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.553964360050424, "policy_loss": -0.006216755800599617, "vf_loss": 6.5596132399543885, "vf_explained_var": 0.006686475636467101, "kl": 0.0056785922861425425, "entropy": 1.5989684656814294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -305.0, "episode_reward_mean": 12.333333333333334, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -300.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": -27.796296296296298, "predator_policy": 33.96296296296296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -22.0, -3.0, 14.0, -26.0, 77.0, 90.0, -22.0, 15.0, 29.0, -23.0, -146.0, 121.0, 191.0, 294.0, -55.0, -93.0, 71.0, 108.0, 85.0, 46.0, -18.0, 215.0, 88.0, 219.0, -305.0, -295.0, 92.0, 205.0, 19.0, -25.0, 103.0, -26.0, -63.0, -18.0, 32.0, 231.0, -7.0, 114.0, -111.0, 33.0, -7.0, -112.0, -136.0, -116.0, -128.0, -28.0, -23.0, -38.0, -25.0, 78.0, -67.0, 15.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 11.0, -111.0, 2.0, 2.0, -22.0, 14.0, 0.0, -118.0, 11.0, 22.0, 52.0, 88.0, 0.0, -175.0, 0.0, 10.0, -46.0, 3.0, 0.0, -62.0, 7.0, -154.0, -138.0, 43.0, 68.0, 191.0, 0.0, 121.0, 169.0, -110.0, 0.0, -46.0, -124.0, -206.0, 131.0, 0.0, 79.0, 16.0, 43.0, 171.0, -250.0, 20.0, -94.0, 27.0, 182.0, 84.0, -7.0, 140.0, 10.0, -224.0, -238.0, -243.0, -214.0, -205.0, 164.0, 149.0, 12.0, -2.0, 9.0, 68.0, -191.0, 77.0, 4.0, -226.0, 51.0, 11.0, -153.0, -44.0, -61.0, 31.0, 1.0, 158.0, 73.0, -122.0, 24.0, 15.0, 76.0, -90.0, -140.0, -21.0, -39.0, 14.0, -126.0, -209.0, -20.0, 13.0, -300.0, -273.0, -46.0, -281.0, 6.0, -6.0, -97.0, -128.0, -29.0, -37.0, -68.0, -12.0, -60.0, 2.0, 76.0, -106.0, -68.0, 0.0, -19.0, 0.0, 3.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 0.0, 0.0, 17.0, 0.0, 0.0, 55.0, 26.0, 3.0, 0.0, 2.0, 0.0, 83.0, 70.0, 51.0, 0.0, 0.0, 26.0, 0.0, 32.0, 69.0, 77.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 55.0, 75.0, 2.0, 88.0, 58.0, 2.0, 27.0, 0.0, 26.0, 125.0, 0.0, 1.0, 55.0, 0.0, 6.0, 0.0, 11.0, 45.0, 24.0, 157.0, 0.0, 40.0, 122.0, 34.0, 99.0, 38.0, 6.0, 1.0, 11.0, 12.0, 86.0, 0.0, 22.0, 31.0, 118.0, 79.0, 0.0, 39.0, 48.0, 0.0, 0.0, 0.0, 0.0, 10.0, 81.0, 23.0, 0.0, 54.0, 65.0, 1.0, 92.0, 6.0, 99.0, 10.0, 107.0, 151.0, 0.0, 97.0, 106.0, 3.0, 144.0, 58.0, 17.0, 66.0, 68.0, 0.0, 67.0, 47.0, 0.0, 0.0, 0.0, 34.0, 73.0, 0.0, 34.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9631050811149633, "mean_inference_ms": 2.960207314367767, "mean_action_processing_ms": 0.3775678086569116, "mean_env_wait_ms": 0.33130892195470724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03313068990354185, "StateBufferConnector_ms": 0.0037380942591914426, "ViewRequirementAgentConnector_ms": 0.1917231965948034}, "num_episodes": 18, "episode_return_max": 294.0, "episode_return_min": -305.0, "episode_return_mean": 12.333333333333334, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.9307251365588, "num_env_steps_trained_throughput_per_sec": 352.9307251365588, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 70904.878, "restore_workers_time_ms": 0.043, "training_step_time_ms": 70904.777, "sample_time_ms": 2058.009, "learn_time_ms": 68830.732, "learn_throughput": 58.114, "synch_weights_time_ms": 13.585}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "e1352_00002", "date": "2024-08-13_19-05-18", "timestamp": 1723590318, "time_this_iter_s": 11.375398874282837, "time_total_s": 212.8434772491455, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b7be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 212.8434772491455, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 53.19375, "ram_util_percent": 83.5625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.40984209150509543, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.421496562604551, "policy_loss": -0.0034217777439619775, "vf_loss": 4.423889524596078, "vf_explained_var": 0.0016858856198648927, "kl": 0.010288145584716473, "entropy": 1.5994774359243888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1095201484385937, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 5.459163399348183, "policy_loss": -0.0006348189937256316, "vf_loss": 5.459544081914992, "vf_explained_var": 0.00949819942630788, "kl": 0.002541254363890458, "entropy": 1.5999344096612678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -305.0, "episode_reward_mean": 11.347222222222221, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -300.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": -28.17361111111111, "predator_policy": 33.84722222222222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -22.0, -3.0, 14.0, -26.0, 77.0, 90.0, -22.0, 15.0, 29.0, -23.0, -146.0, 121.0, 191.0, 294.0, -55.0, -93.0, 71.0, 108.0, 85.0, 46.0, -18.0, 215.0, 88.0, 219.0, -305.0, -295.0, 92.0, 205.0, 19.0, -25.0, 103.0, -26.0, -63.0, -18.0, 32.0, 231.0, -7.0, 114.0, -111.0, 33.0, -7.0, -112.0, -136.0, -116.0, -128.0, -28.0, -23.0, -38.0, -25.0, 78.0, -67.0, 15.0, 3.0, -90.0, 50.0, -15.0, -78.0, 126.0, 53.0, -98.0, 16.0, 195.0, -27.0, 127.0, -16.0, -3.0, -46.0, 20.0, 51.0, -108.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 11.0, -111.0, 2.0, 2.0, -22.0, 14.0, 0.0, -118.0, 11.0, 22.0, 52.0, 88.0, 0.0, -175.0, 0.0, 10.0, -46.0, 3.0, 0.0, -62.0, 7.0, -154.0, -138.0, 43.0, 68.0, 191.0, 0.0, 121.0, 169.0, -110.0, 0.0, -46.0, -124.0, -206.0, 131.0, 0.0, 79.0, 16.0, 43.0, 171.0, -250.0, 20.0, -94.0, 27.0, 182.0, 84.0, -7.0, 140.0, 10.0, -224.0, -238.0, -243.0, -214.0, -205.0, 164.0, 149.0, 12.0, -2.0, 9.0, 68.0, -191.0, 77.0, 4.0, -226.0, 51.0, 11.0, -153.0, -44.0, -61.0, 31.0, 1.0, 158.0, 73.0, -122.0, 24.0, 15.0, 76.0, -90.0, -140.0, -21.0, -39.0, 14.0, -126.0, -209.0, -20.0, 13.0, -300.0, -273.0, -46.0, -281.0, 6.0, -6.0, -97.0, -128.0, -29.0, -37.0, -68.0, -12.0, -60.0, 2.0, 76.0, -106.0, -68.0, 0.0, -19.0, 0.0, 3.0, 20.0, -293.0, -20.0, 17.0, 0.0, -80.0, -34.0, -122.0, 0.0, 121.0, 29.0, 0.0, 28.0, -262.0, 16.0, 0.0, 24.0, 171.0, -34.0, -55.0, -87.0, 107.0, -20.0, -28.0, -202.0, 49.0, -154.0, -4.0, 20.0, 0.0, 54.0, -75.0, -97.0, -132.0, 0.0, -12.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 0.0, 0.0, 17.0, 0.0, 0.0, 55.0, 26.0, 3.0, 0.0, 2.0, 0.0, 83.0, 70.0, 51.0, 0.0, 0.0, 26.0, 0.0, 32.0, 69.0, 77.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 55.0, 75.0, 2.0, 88.0, 58.0, 2.0, 27.0, 0.0, 26.0, 125.0, 0.0, 1.0, 55.0, 0.0, 6.0, 0.0, 11.0, 45.0, 24.0, 157.0, 0.0, 40.0, 122.0, 34.0, 99.0, 38.0, 6.0, 1.0, 11.0, 12.0, 86.0, 0.0, 22.0, 31.0, 118.0, 79.0, 0.0, 39.0, 48.0, 0.0, 0.0, 0.0, 0.0, 10.0, 81.0, 23.0, 0.0, 54.0, 65.0, 1.0, 92.0, 6.0, 99.0, 10.0, 107.0, 151.0, 0.0, 97.0, 106.0, 3.0, 144.0, 58.0, 17.0, 66.0, 68.0, 0.0, 67.0, 47.0, 0.0, 0.0, 0.0, 34.0, 73.0, 0.0, 34.0, 0.0, 0.0, 123.0, 60.0, 53.0, 0.0, 0.0, 65.0, 61.0, 17.0, 0.0, 5.0, 20.0, 4.0, 0.0, 136.0, 0.0, 0.0, 0.0, 0.0, 29.0, 33.0, 19.0, 88.0, 24.0, 8.0, 24.0, 126.0, 34.0, 78.0, 0.0, 0.0, 18.0, 54.0, 70.0, 51.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9346587358707524, "mean_inference_ms": 2.885440852917627, "mean_action_processing_ms": 0.36842027081341855, "mean_env_wait_ms": 0.3218989786870537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800093756781684, "StateBufferConnector_ms": 0.003673798508114285, "ViewRequirementAgentConnector_ms": 0.1786775059170193}, "num_episodes": 18, "episode_return_max": 294.0, "episode_return_min": -305.0, "episode_return_mean": 11.347222222222221, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.24904032950786, "num_env_steps_trained_throughput_per_sec": 352.24904032950786, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 56017.56, "restore_workers_time_ms": 0.036, "training_step_time_ms": 56017.476, "sample_time_ms": 1930.05, "learn_time_ms": 54068.83, "learn_throughput": 73.98, "synch_weights_time_ms": 16.295}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "e1352_00002", "date": "2024-08-13_19-05-29", "timestamp": 1723590329, "time_this_iter_s": 11.401735305786133, "time_total_s": 224.24521255493164, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d6bf820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 224.24521255493164, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.69375, "ram_util_percent": 83.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46319115485936874, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 4.217891371313226, "policy_loss": -0.003634406352494523, "vf_loss": 4.220195839392445, "vf_explained_var": -0.000353914530819686, "kl": 0.013299145036163538, "entropy": 1.5846080014945338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0990942548309999, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.294615466758688, "policy_loss": -0.002542857618179547, "vf_loss": 6.296826281623235, "vf_explained_var": 0.007613388066569333, "kl": 0.0066409614023806175, "entropy": 1.5778070042373011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -305.0, "episode_reward_mean": 11.292929292929292, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -300.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": -27.449494949494948, "predator_policy": 33.0959595959596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -22.0, -3.0, 14.0, -26.0, 77.0, 90.0, -22.0, 15.0, 29.0, -23.0, -146.0, 121.0, 191.0, 294.0, -55.0, -93.0, 71.0, 108.0, 85.0, 46.0, -18.0, 215.0, 88.0, 219.0, -305.0, -295.0, 92.0, 205.0, 19.0, -25.0, 103.0, -26.0, -63.0, -18.0, 32.0, 231.0, -7.0, 114.0, -111.0, 33.0, -7.0, -112.0, -136.0, -116.0, -128.0, -28.0, -23.0, -38.0, -25.0, 78.0, -67.0, 15.0, 3.0, -90.0, 50.0, -15.0, -78.0, 126.0, 53.0, -98.0, 16.0, 195.0, -27.0, 127.0, -16.0, -3.0, -46.0, 20.0, 51.0, -108.0, -6.0, -33.0, 262.0, -131.0, -128.0, 79.0, -39.0, 56.0, -165.0, 79.0, 12.0, 128.0, -63.0, -92.0, 94.0, 83.0, -11.0, 29.0, -83.0, 72.0, 54.0, -20.0, 21.0, 33.0, 8.0, 0.0, 15.0, 41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 11.0, -111.0, 2.0, 2.0, -22.0, 14.0, 0.0, -118.0, 11.0, 22.0, 52.0, 88.0, 0.0, -175.0, 0.0, 10.0, -46.0, 3.0, 0.0, -62.0, 7.0, -154.0, -138.0, 43.0, 68.0, 191.0, 0.0, 121.0, 169.0, -110.0, 0.0, -46.0, -124.0, -206.0, 131.0, 0.0, 79.0, 16.0, 43.0, 171.0, -250.0, 20.0, -94.0, 27.0, 182.0, 84.0, -7.0, 140.0, 10.0, -224.0, -238.0, -243.0, -214.0, -205.0, 164.0, 149.0, 12.0, -2.0, 9.0, 68.0, -191.0, 77.0, 4.0, -226.0, 51.0, 11.0, -153.0, -44.0, -61.0, 31.0, 1.0, 158.0, 73.0, -122.0, 24.0, 15.0, 76.0, -90.0, -140.0, -21.0, -39.0, 14.0, -126.0, -209.0, -20.0, 13.0, -300.0, -273.0, -46.0, -281.0, 6.0, -6.0, -97.0, -128.0, -29.0, -37.0, -68.0, -12.0, -60.0, 2.0, 76.0, -106.0, -68.0, 0.0, -19.0, 0.0, 3.0, 20.0, -293.0, -20.0, 17.0, 0.0, -80.0, -34.0, -122.0, 0.0, 121.0, 29.0, 0.0, 28.0, -262.0, 16.0, 0.0, 24.0, 171.0, -34.0, -55.0, -87.0, 107.0, -20.0, -28.0, -202.0, 49.0, -154.0, -4.0, 20.0, 0.0, 54.0, -75.0, -97.0, -132.0, 0.0, -12.0, -76.0, 0.0, 102.0, 160.0, -278.0, -47.0, -125.0, -110.0, 0.0, 28.0, -164.0, 14.0, 21.0, 35.0, -179.0, -93.0, 79.0, 0.0, 0.0, -37.0, 116.0, 12.0, -229.0, 0.0, -184.0, 0.0, -39.0, 109.0, 111.0, -118.0, -70.0, 24.0, 3.0, 4.0, -7.0, -197.0, -54.0, 69.0, 73.0, -109.0, 0.0, -63.0, -138.0, 35.0, 31.0, 0.0, -18.0, -27.0, 0.0, 0.0, 0.0, 15.0, -70.0, 13.0], "policy_predator_policy_reward": [0.0, 0.0, 87.0, 0.0, 0.0, 17.0, 0.0, 0.0, 55.0, 26.0, 3.0, 0.0, 2.0, 0.0, 83.0, 70.0, 51.0, 0.0, 0.0, 26.0, 0.0, 32.0, 69.0, 77.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 55.0, 75.0, 2.0, 88.0, 58.0, 2.0, 27.0, 0.0, 26.0, 125.0, 0.0, 1.0, 55.0, 0.0, 6.0, 0.0, 11.0, 45.0, 24.0, 157.0, 0.0, 40.0, 122.0, 34.0, 99.0, 38.0, 6.0, 1.0, 11.0, 12.0, 86.0, 0.0, 22.0, 31.0, 118.0, 79.0, 0.0, 39.0, 48.0, 0.0, 0.0, 0.0, 0.0, 10.0, 81.0, 23.0, 0.0, 54.0, 65.0, 1.0, 92.0, 6.0, 99.0, 10.0, 107.0, 151.0, 0.0, 97.0, 106.0, 3.0, 144.0, 58.0, 17.0, 66.0, 68.0, 0.0, 67.0, 47.0, 0.0, 0.0, 0.0, 34.0, 73.0, 0.0, 34.0, 0.0, 0.0, 123.0, 60.0, 53.0, 0.0, 0.0, 65.0, 61.0, 17.0, 0.0, 5.0, 20.0, 4.0, 0.0, 136.0, 0.0, 0.0, 0.0, 0.0, 29.0, 33.0, 19.0, 88.0, 24.0, 8.0, 24.0, 126.0, 34.0, 78.0, 0.0, 0.0, 18.0, 54.0, 70.0, 51.0, 6.0, 0.0, 0.0, 43.0, 0.0, 0.0, 116.0, 78.0, 107.0, 0.0, 11.0, 40.0, 60.0, 51.0, 0.0, 0.0, 11.0, 96.0, 0.0, 0.0, 15.0, 34.0, 0.0, 0.0, 111.0, 55.0, 0.0, 92.0, 6.0, 18.0, 31.0, 59.0, 0.0, 35.0, 6.0, 16.0, 81.0, 40.0, 57.0, 0.0, 89.0, 1.0, 0.0, 43.0, 69.0, 55.0, 0.0, 2.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 47.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9087896003912216, "mean_inference_ms": 2.8318704829971857, "mean_action_processing_ms": 0.361290565347513, "mean_env_wait_ms": 0.31379871184853214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023091441453105273, "StateBufferConnector_ms": 0.00361673759691643, "ViewRequirementAgentConnector_ms": 0.1610971460438738}, "num_episodes": 27, "episode_return_max": 294.0, "episode_return_min": -305.0, "episode_return_mean": 11.292929292929292, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.07521200934684, "num_env_steps_trained_throughput_per_sec": 343.07521200934684, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 47145.9, "restore_workers_time_ms": 0.031, "training_step_time_ms": 47145.824, "sample_time_ms": 1939.44, "learn_time_ms": 45189.095, "learn_throughput": 88.517, "synch_weights_time_ms": 15.219}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "e1352_00002", "date": "2024-08-13_19-05-41", "timestamp": 1723590341, "time_this_iter_s": 11.691293954849243, "time_total_s": 235.93650650978088, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1710790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 235.93650650978088, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.45882352941175, "ram_util_percent": 83.71764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38915121383255435, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 3.7589892672483254, "policy_loss": -0.0019129853954331743, "vf_loss": 3.7602027724028897, "vf_explained_var": -0.0015049481202685643, "kl": 0.006994917525694573, "entropy": 1.5738630114409027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5316206271607409, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.109234349689786, "policy_loss": -0.0036751531005378753, "vf_loss": 6.112535842259725, "vf_explained_var": 0.02122262022482655, "kl": 0.0074729315781573, "entropy": 1.5725746063959032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 262.0, "episode_reward_min": -305.0, "episode_reward_mean": 8.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -300.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": -30.02, "predator_policy": 34.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.0, 108.0, 85.0, 46.0, -18.0, 215.0, 88.0, 219.0, -305.0, -295.0, 92.0, 205.0, 19.0, -25.0, 103.0, -26.0, -63.0, -18.0, 32.0, 231.0, -7.0, 114.0, -111.0, 33.0, -7.0, -112.0, -136.0, -116.0, -128.0, -28.0, -23.0, -38.0, -25.0, 78.0, -67.0, 15.0, 3.0, -90.0, 50.0, -15.0, -78.0, 126.0, 53.0, -98.0, 16.0, 195.0, -27.0, 127.0, -16.0, -3.0, -46.0, 20.0, 51.0, -108.0, -6.0, -33.0, 262.0, -131.0, -128.0, 79.0, -39.0, 56.0, -165.0, 79.0, 12.0, 128.0, -63.0, -92.0, 94.0, 83.0, -11.0, 29.0, -83.0, 72.0, 54.0, -20.0, 21.0, 33.0, 8.0, 0.0, 15.0, 41.0, 0.0, 57.0, -28.0, -94.0, 17.0, 66.0, -50.0, -124.0, -13.0, 91.0, -126.0, 218.0, 28.0, -83.0, 86.0, 159.0, -86.0, 108.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-206.0, 131.0, 0.0, 79.0, 16.0, 43.0, 171.0, -250.0, 20.0, -94.0, 27.0, 182.0, 84.0, -7.0, 140.0, 10.0, -224.0, -238.0, -243.0, -214.0, -205.0, 164.0, 149.0, 12.0, -2.0, 9.0, 68.0, -191.0, 77.0, 4.0, -226.0, 51.0, 11.0, -153.0, -44.0, -61.0, 31.0, 1.0, 158.0, 73.0, -122.0, 24.0, 15.0, 76.0, -90.0, -140.0, -21.0, -39.0, 14.0, -126.0, -209.0, -20.0, 13.0, -300.0, -273.0, -46.0, -281.0, 6.0, -6.0, -97.0, -128.0, -29.0, -37.0, -68.0, -12.0, -60.0, 2.0, 76.0, -106.0, -68.0, 0.0, -19.0, 0.0, 3.0, 20.0, -293.0, -20.0, 17.0, 0.0, -80.0, -34.0, -122.0, 0.0, 121.0, 29.0, 0.0, 28.0, -262.0, 16.0, 0.0, 24.0, 171.0, -34.0, -55.0, -87.0, 107.0, -20.0, -28.0, -202.0, 49.0, -154.0, -4.0, 20.0, 0.0, 54.0, -75.0, -97.0, -132.0, 0.0, -12.0, -76.0, 0.0, 102.0, 160.0, -278.0, -47.0, -125.0, -110.0, 0.0, 28.0, -164.0, 14.0, 21.0, 35.0, -179.0, -93.0, 79.0, 0.0, 0.0, -37.0, 116.0, 12.0, -229.0, 0.0, -184.0, 0.0, -39.0, 109.0, 111.0, -118.0, -70.0, 24.0, 3.0, 4.0, -7.0, -197.0, -54.0, 69.0, 73.0, -109.0, 0.0, -63.0, -138.0, 35.0, 31.0, 0.0, -18.0, -27.0, 0.0, 0.0, 0.0, 15.0, -70.0, 13.0, 0.0, 0.0, 0.0, 5.0, -146.0, 5.0, 24.0, -236.0, 4.0, 7.0, 0.0, 5.0, 49.0, -230.0, 0.0, -250.0, -105.0, 0.0, 0.0, 91.0, -124.0, -119.0, -20.0, 186.0, 1.0, 27.0, -123.0, -62.0, 0.0, 67.0, 115.0, 44.0, -58.0, -102.0, 127.0, -38.0], "policy_predator_policy_reward": [88.0, 58.0, 2.0, 27.0, 0.0, 26.0, 125.0, 0.0, 1.0, 55.0, 0.0, 6.0, 0.0, 11.0, 45.0, 24.0, 157.0, 0.0, 40.0, 122.0, 34.0, 99.0, 38.0, 6.0, 1.0, 11.0, 12.0, 86.0, 0.0, 22.0, 31.0, 118.0, 79.0, 0.0, 39.0, 48.0, 0.0, 0.0, 0.0, 0.0, 10.0, 81.0, 23.0, 0.0, 54.0, 65.0, 1.0, 92.0, 6.0, 99.0, 10.0, 107.0, 151.0, 0.0, 97.0, 106.0, 3.0, 144.0, 58.0, 17.0, 66.0, 68.0, 0.0, 67.0, 47.0, 0.0, 0.0, 0.0, 34.0, 73.0, 0.0, 34.0, 0.0, 0.0, 123.0, 60.0, 53.0, 0.0, 0.0, 65.0, 61.0, 17.0, 0.0, 5.0, 20.0, 4.0, 0.0, 136.0, 0.0, 0.0, 0.0, 0.0, 29.0, 33.0, 19.0, 88.0, 24.0, 8.0, 24.0, 126.0, 34.0, 78.0, 0.0, 0.0, 18.0, 54.0, 70.0, 51.0, 6.0, 0.0, 0.0, 43.0, 0.0, 0.0, 116.0, 78.0, 107.0, 0.0, 11.0, 40.0, 60.0, 51.0, 0.0, 0.0, 11.0, 96.0, 0.0, 0.0, 15.0, 34.0, 0.0, 0.0, 111.0, 55.0, 0.0, 92.0, 6.0, 18.0, 31.0, 59.0, 0.0, 35.0, 6.0, 16.0, 81.0, 40.0, 57.0, 0.0, 89.0, 1.0, 0.0, 43.0, 69.0, 55.0, 0.0, 2.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 47.0, 0.0, 0.0, 50.0, 2.0, 113.0, 0.0, 118.0, 0.0, 0.0, 6.0, 55.0, 6.0, 110.0, 21.0, 54.0, 72.0, 92.0, 0.0, 0.0, 0.0, 109.0, 8.0, 52.0, 0.0, 0.0, 0.0, 54.0, 48.0, 19.0, 0.0, 0.0, 0.0, 0.0, 74.0, 0.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8868526940490703, "mean_inference_ms": 2.7891003536732546, "mean_action_processing_ms": 0.3565204164358664, "mean_env_wait_ms": 0.3071500536985848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020436644554138184, "StateBufferConnector_ms": 0.003836989402770996, "ViewRequirementAgentConnector_ms": 0.15585803985595703}, "num_episodes": 18, "episode_return_max": 262.0, "episode_return_min": -305.0, "episode_return_mean": 8.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 5.136611945366632, "num_env_steps_trained_throughput_per_sec": 5.136611945366632, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 169075.487, "restore_workers_time_ms": 0.028, "training_step_time_ms": 169075.414, "sample_time_ms": 1887.721, "learn_time_ms": 167167.601, "learn_throughput": 23.928, "synch_weights_time_ms": 16.928}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "e1352_00002", "date": "2024-08-13_19-18-40", "timestamp": 1723591120, "time_this_iter_s": 778.8205289840698, "time_total_s": 1014.7570354938507, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b63820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1014.7570354938507, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 88.20487804878047, "ram_util_percent": 83.80975609756098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37476111036286786, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 2.72289400100708, "policy_loss": -0.002017106969899956, "vf_loss": 2.7244680448814673, "vf_explained_var": 0.004615889276776995, "kl": 0.004430608157379733, "entropy": 1.5717896098182316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1692018172452374, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.134656545220229, "policy_loss": -0.0034027654237838256, "vf_loss": 5.1377440233079215, "vf_explained_var": 0.03127193148173983, "kl": 0.006306069385769032, "entropy": 1.571804390887104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 262.0, "episode_reward_min": -165.0, "episode_reward_mean": 7.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -300.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": -28.215, "predator_policy": 32.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.0, 231.0, -7.0, 114.0, -111.0, 33.0, -7.0, -112.0, -136.0, -116.0, -128.0, -28.0, -23.0, -38.0, -25.0, 78.0, -67.0, 15.0, 3.0, -90.0, 50.0, -15.0, -78.0, 126.0, 53.0, -98.0, 16.0, 195.0, -27.0, 127.0, -16.0, -3.0, -46.0, 20.0, 51.0, -108.0, -6.0, -33.0, 262.0, -131.0, -128.0, 79.0, -39.0, 56.0, -165.0, 79.0, 12.0, 128.0, -63.0, -92.0, 94.0, 83.0, -11.0, 29.0, -83.0, 72.0, 54.0, -20.0, 21.0, 33.0, 8.0, 0.0, 15.0, 41.0, 0.0, 57.0, -28.0, -94.0, 17.0, 66.0, -50.0, -124.0, -13.0, 91.0, -126.0, 218.0, 28.0, -83.0, 86.0, 159.0, -86.0, 108.0, -76.0, 69.0, 5.0, -58.0, -55.0, -23.0, 121.0, 100.0, -46.0, 30.0, 77.0, 2.0, 79.0, -42.0, 113.0, 81.0, 60.0, -38.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [31.0, 1.0, 158.0, 73.0, -122.0, 24.0, 15.0, 76.0, -90.0, -140.0, -21.0, -39.0, 14.0, -126.0, -209.0, -20.0, 13.0, -300.0, -273.0, -46.0, -281.0, 6.0, -6.0, -97.0, -128.0, -29.0, -37.0, -68.0, -12.0, -60.0, 2.0, 76.0, -106.0, -68.0, 0.0, -19.0, 0.0, 3.0, 20.0, -293.0, -20.0, 17.0, 0.0, -80.0, -34.0, -122.0, 0.0, 121.0, 29.0, 0.0, 28.0, -262.0, 16.0, 0.0, 24.0, 171.0, -34.0, -55.0, -87.0, 107.0, -20.0, -28.0, -202.0, 49.0, -154.0, -4.0, 20.0, 0.0, 54.0, -75.0, -97.0, -132.0, 0.0, -12.0, -76.0, 0.0, 102.0, 160.0, -278.0, -47.0, -125.0, -110.0, 0.0, 28.0, -164.0, 14.0, 21.0, 35.0, -179.0, -93.0, 79.0, 0.0, 0.0, -37.0, 116.0, 12.0, -229.0, 0.0, -184.0, 0.0, -39.0, 109.0, 111.0, -118.0, -70.0, 24.0, 3.0, 4.0, -7.0, -197.0, -54.0, 69.0, 73.0, -109.0, 0.0, -63.0, -138.0, 35.0, 31.0, 0.0, -18.0, -27.0, 0.0, 0.0, 0.0, 15.0, -70.0, 13.0, 0.0, 0.0, 0.0, 5.0, -146.0, 5.0, 24.0, -236.0, 4.0, 7.0, 0.0, 5.0, 49.0, -230.0, 0.0, -250.0, -105.0, 0.0, 0.0, 91.0, -124.0, -119.0, -20.0, 186.0, 1.0, 27.0, -123.0, -62.0, 0.0, 67.0, 115.0, 44.0, -58.0, -102.0, 127.0, -38.0, 8.0, -201.0, -69.0, 101.0, 9.0, -148.0, -21.0, -146.0, 0.0, -110.0, -73.0, 7.0, -55.0, 123.0, -18.0, 40.0, 7.0, -116.0, 29.0, -6.0, 86.0, -48.0, -21.0, -7.0, 31.0, 27.0, -29.0, -54.0, -11.0, 93.0, 28.0, 53.0, 0.0, 43.0, -56.0, -45.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 10.0, 81.0, 23.0, 0.0, 54.0, 65.0, 1.0, 92.0, 6.0, 99.0, 10.0, 107.0, 151.0, 0.0, 97.0, 106.0, 3.0, 144.0, 58.0, 17.0, 66.0, 68.0, 0.0, 67.0, 47.0, 0.0, 0.0, 0.0, 34.0, 73.0, 0.0, 34.0, 0.0, 0.0, 123.0, 60.0, 53.0, 0.0, 0.0, 65.0, 61.0, 17.0, 0.0, 5.0, 20.0, 4.0, 0.0, 136.0, 0.0, 0.0, 0.0, 0.0, 29.0, 33.0, 19.0, 88.0, 24.0, 8.0, 24.0, 126.0, 34.0, 78.0, 0.0, 0.0, 18.0, 54.0, 70.0, 51.0, 6.0, 0.0, 0.0, 43.0, 0.0, 0.0, 116.0, 78.0, 107.0, 0.0, 11.0, 40.0, 60.0, 51.0, 0.0, 0.0, 11.0, 96.0, 0.0, 0.0, 15.0, 34.0, 0.0, 0.0, 111.0, 55.0, 0.0, 92.0, 6.0, 18.0, 31.0, 59.0, 0.0, 35.0, 6.0, 16.0, 81.0, 40.0, 57.0, 0.0, 89.0, 1.0, 0.0, 43.0, 69.0, 55.0, 0.0, 2.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 47.0, 0.0, 0.0, 50.0, 2.0, 113.0, 0.0, 118.0, 0.0, 0.0, 6.0, 55.0, 6.0, 110.0, 21.0, 54.0, 72.0, 92.0, 0.0, 0.0, 0.0, 109.0, 8.0, 52.0, 0.0, 0.0, 0.0, 54.0, 48.0, 19.0, 0.0, 0.0, 0.0, 0.0, 74.0, 0.0, 19.0, 102.0, 15.0, 36.0, 1.0, 59.0, 85.0, 79.0, 30.0, 0.0, 55.0, 43.0, 0.0, 8.0, 45.0, 43.0, 35.0, 5.0, 58.0, 4.0, 3.0, 21.0, 18.0, 30.0, 0.0, 21.0, 0.0, 41.0, 0.0, 31.0, 0.0, 0.0, 0.0, 3.0, 14.0, 53.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8691618957099565, "mean_inference_ms": 2.7530354160306785, "mean_action_processing_ms": 0.35049206876988137, "mean_env_wait_ms": 0.3031373365092555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008849382400512695, "StateBufferConnector_ms": 0.0038466453552246094, "ViewRequirementAgentConnector_ms": 0.14393460750579834}, "num_episodes": 18, "episode_return_max": 262.0, "episode_return_min": -165.0, "episode_return_mean": 7.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.95540948933038, "num_env_steps_trained_throughput_per_sec": 210.95540948933038, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 147630.612, "restore_workers_time_ms": 0.026, "training_step_time_ms": 147630.543, "sample_time_ms": 2156.553, "learn_time_ms": 145454.143, "learn_throughput": 27.5, "synch_weights_time_ms": 16.773}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "e1352_00002", "date": "2024-08-13_19-18-59", "timestamp": 1723591139, "time_this_iter_s": 19.12779211997986, "time_total_s": 1033.8848276138306, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb33a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1033.8848276138306, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 84.29629629629629, "ram_util_percent": 83.94074074074075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.32086549973282863, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 0.8125874215175235, "policy_loss": -0.007181343212280245, "vf_loss": 0.8191221404958654, "vf_explained_var": 0.025576476697568542, "kl": 0.012932446064542814, "entropy": 1.5756422349384853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3548922737557736, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.8700391566311874, "policy_loss": -0.003502597691116746, "vf_loss": 3.8733590276153, "vf_explained_var": 0.053572027393119045, "kl": 0.0036546452724819357, "entropy": 1.5809999220585698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 262.0, "episode_reward_min": -165.0, "episode_reward_mean": 20.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -293.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 136.0}, "policy_reward_mean": {"prey_policy": -15.605, "predator_policy": 25.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -90.0, 50.0, -15.0, -78.0, 126.0, 53.0, -98.0, 16.0, 195.0, -27.0, 127.0, -16.0, -3.0, -46.0, 20.0, 51.0, -108.0, -6.0, -33.0, 262.0, -131.0, -128.0, 79.0, -39.0, 56.0, -165.0, 79.0, 12.0, 128.0, -63.0, -92.0, 94.0, 83.0, -11.0, 29.0, -83.0, 72.0, 54.0, -20.0, 21.0, 33.0, 8.0, 0.0, 15.0, 41.0, 0.0, 57.0, -28.0, -94.0, 17.0, 66.0, -50.0, -124.0, -13.0, 91.0, -126.0, 218.0, 28.0, -83.0, 86.0, 159.0, -86.0, 108.0, -76.0, 69.0, 5.0, -58.0, -55.0, -23.0, 121.0, 100.0, -46.0, 30.0, 77.0, 2.0, 79.0, -42.0, 113.0, 81.0, 60.0, -38.0, 20.0, -36.0, 36.0, 49.0, 17.0, 68.0, -1.0, 71.0, 112.0, 113.0, -37.0, 70.0, 70.0, 41.0, 123.0, 132.0, 48.0, 36.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 3.0, 20.0, -293.0, -20.0, 17.0, 0.0, -80.0, -34.0, -122.0, 0.0, 121.0, 29.0, 0.0, 28.0, -262.0, 16.0, 0.0, 24.0, 171.0, -34.0, -55.0, -87.0, 107.0, -20.0, -28.0, -202.0, 49.0, -154.0, -4.0, 20.0, 0.0, 54.0, -75.0, -97.0, -132.0, 0.0, -12.0, -76.0, 0.0, 102.0, 160.0, -278.0, -47.0, -125.0, -110.0, 0.0, 28.0, -164.0, 14.0, 21.0, 35.0, -179.0, -93.0, 79.0, 0.0, 0.0, -37.0, 116.0, 12.0, -229.0, 0.0, -184.0, 0.0, -39.0, 109.0, 111.0, -118.0, -70.0, 24.0, 3.0, 4.0, -7.0, -197.0, -54.0, 69.0, 73.0, -109.0, 0.0, -63.0, -138.0, 35.0, 31.0, 0.0, -18.0, -27.0, 0.0, 0.0, 0.0, 15.0, -70.0, 13.0, 0.0, 0.0, 0.0, 5.0, -146.0, 5.0, 24.0, -236.0, 4.0, 7.0, 0.0, 5.0, 49.0, -230.0, 0.0, -250.0, -105.0, 0.0, 0.0, 91.0, -124.0, -119.0, -20.0, 186.0, 1.0, 27.0, -123.0, -62.0, 0.0, 67.0, 115.0, 44.0, -58.0, -102.0, 127.0, -38.0, 8.0, -201.0, -69.0, 101.0, 9.0, -148.0, -21.0, -146.0, 0.0, -110.0, -73.0, 7.0, -55.0, 123.0, -18.0, 40.0, 7.0, -116.0, 29.0, -6.0, 86.0, -48.0, -21.0, -7.0, 31.0, 27.0, -29.0, -54.0, -11.0, 93.0, 28.0, 53.0, 0.0, 43.0, -56.0, -45.0, 11.0, 9.0, -37.0, -32.0, -2.0, 27.0, 23.0, 26.0, 8.0, 9.0, 64.0, -18.0, -45.0, 16.0, 67.0, 4.0, 33.0, 50.0, 64.0, 41.0, 19.0, -112.0, 0.0, 70.0, 1.0, 60.0, 41.0, 0.0, 58.0, 65.0, -18.0, 130.0, 12.0, 36.0, 0.0, 34.0], "policy_predator_policy_reward": [0.0, 0.0, 123.0, 60.0, 53.0, 0.0, 0.0, 65.0, 61.0, 17.0, 0.0, 5.0, 20.0, 4.0, 0.0, 136.0, 0.0, 0.0, 0.0, 0.0, 29.0, 33.0, 19.0, 88.0, 24.0, 8.0, 24.0, 126.0, 34.0, 78.0, 0.0, 0.0, 18.0, 54.0, 70.0, 51.0, 6.0, 0.0, 0.0, 43.0, 0.0, 0.0, 116.0, 78.0, 107.0, 0.0, 11.0, 40.0, 60.0, 51.0, 0.0, 0.0, 11.0, 96.0, 0.0, 0.0, 15.0, 34.0, 0.0, 0.0, 111.0, 55.0, 0.0, 92.0, 6.0, 18.0, 31.0, 59.0, 0.0, 35.0, 6.0, 16.0, 81.0, 40.0, 57.0, 0.0, 89.0, 1.0, 0.0, 43.0, 69.0, 55.0, 0.0, 2.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 47.0, 0.0, 0.0, 50.0, 2.0, 113.0, 0.0, 118.0, 0.0, 0.0, 6.0, 55.0, 6.0, 110.0, 21.0, 54.0, 72.0, 92.0, 0.0, 0.0, 0.0, 109.0, 8.0, 52.0, 0.0, 0.0, 0.0, 54.0, 48.0, 19.0, 0.0, 0.0, 0.0, 0.0, 74.0, 0.0, 19.0, 102.0, 15.0, 36.0, 1.0, 59.0, 85.0, 79.0, 30.0, 0.0, 55.0, 43.0, 0.0, 8.0, 45.0, 43.0, 35.0, 5.0, 58.0, 4.0, 3.0, 21.0, 18.0, 30.0, 0.0, 21.0, 0.0, 41.0, 0.0, 31.0, 0.0, 0.0, 0.0, 3.0, 14.0, 53.0, 10.0, 0.0, 0.0, 19.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 29.0, 0.0, 8.0, 0.0, 56.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8703969786374262, "mean_inference_ms": 2.7595440644165863, "mean_action_processing_ms": 0.351188680494916, "mean_env_wait_ms": 0.3042699287099387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007375121116638184, "StateBufferConnector_ms": 0.003901243209838867, "ViewRequirementAgentConnector_ms": 0.14046239852905273}, "num_episodes": 18, "episode_return_max": 262.0, "episode_return_min": -165.0, "episode_return_mean": 20.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 61.548262130867975, "num_env_steps_trained_throughput_per_sec": 61.548262130867975, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 137300.493, "restore_workers_time_ms": 0.025, "training_step_time_ms": 137300.424, "sample_time_ms": 2110.063, "learn_time_ms": 135166.659, "learn_throughput": 29.593, "synch_weights_time_ms": 20.184}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "e1352_00002", "date": "2024-08-13_19-20-04", "timestamp": 1723591204, "time_this_iter_s": 65.03840589523315, "time_total_s": 1098.9232335090637, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb71f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1098.9232335090637, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.12352941176471, "ram_util_percent": 83.74705882352943}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3276178354072192, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.4169581789188284, "policy_loss": -0.005061251013761475, "vf_loss": 3.4214642769445187, "vf_explained_var": 0.0033363370037583447, "kl": 0.011103216198546607, "entropy": 1.5568805055012778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.812736027906575, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 5.405745181078633, "policy_loss": -0.002122211102741184, "vf_loss": 5.407777587572734, "vf_explained_var": 0.007284487366045593, "kl": 0.0035919448293737087, "entropy": 1.5901761247367454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 218.0, "episode_reward_min": -165.0, "episode_reward_mean": 17.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -16.545, "predator_policy": 25.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-128.0, 79.0, -39.0, 56.0, -165.0, 79.0, 12.0, 128.0, -63.0, -92.0, 94.0, 83.0, -11.0, 29.0, -83.0, 72.0, 54.0, -20.0, 21.0, 33.0, 8.0, 0.0, 15.0, 41.0, 0.0, 57.0, -28.0, -94.0, 17.0, 66.0, -50.0, -124.0, -13.0, 91.0, -126.0, 218.0, 28.0, -83.0, 86.0, 159.0, -86.0, 108.0, -76.0, 69.0, 5.0, -58.0, -55.0, -23.0, 121.0, 100.0, -46.0, 30.0, 77.0, 2.0, 79.0, -42.0, 113.0, 81.0, 60.0, -38.0, 20.0, -36.0, 36.0, 49.0, 17.0, 68.0, -1.0, 71.0, 112.0, 113.0, -37.0, 70.0, 70.0, 41.0, 123.0, 132.0, 48.0, 36.0, 30.0, -117.0, -1.0, 37.0, -153.0, -107.0, 55.0, 109.0, 28.0, -57.0, -38.0, 36.0, 40.0, 50.0, -12.0, -16.0, 0.0, 3.0, 104.0, 83.0, -39.0, -65.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-125.0, -110.0, 0.0, 28.0, -164.0, 14.0, 21.0, 35.0, -179.0, -93.0, 79.0, 0.0, 0.0, -37.0, 116.0, 12.0, -229.0, 0.0, -184.0, 0.0, -39.0, 109.0, 111.0, -118.0, -70.0, 24.0, 3.0, 4.0, -7.0, -197.0, -54.0, 69.0, 73.0, -109.0, 0.0, -63.0, -138.0, 35.0, 31.0, 0.0, -18.0, -27.0, 0.0, 0.0, 0.0, 15.0, -70.0, 13.0, 0.0, 0.0, 0.0, 5.0, -146.0, 5.0, 24.0, -236.0, 4.0, 7.0, 0.0, 5.0, 49.0, -230.0, 0.0, -250.0, -105.0, 0.0, 0.0, 91.0, -124.0, -119.0, -20.0, 186.0, 1.0, 27.0, -123.0, -62.0, 0.0, 67.0, 115.0, 44.0, -58.0, -102.0, 127.0, -38.0, 8.0, -201.0, -69.0, 101.0, 9.0, -148.0, -21.0, -146.0, 0.0, -110.0, -73.0, 7.0, -55.0, 123.0, -18.0, 40.0, 7.0, -116.0, 29.0, -6.0, 86.0, -48.0, -21.0, -7.0, 31.0, 27.0, -29.0, -54.0, -11.0, 93.0, 28.0, 53.0, 0.0, 43.0, -56.0, -45.0, 11.0, 9.0, -37.0, -32.0, -2.0, 27.0, 23.0, 26.0, 8.0, 9.0, 64.0, -18.0, -45.0, 16.0, 67.0, 4.0, 33.0, 50.0, 64.0, 41.0, 19.0, -112.0, 0.0, 70.0, 1.0, 60.0, 41.0, 0.0, 58.0, 65.0, -18.0, 130.0, 12.0, 36.0, 0.0, 34.0, 0.0, 25.0, 30.0, -372.0, -75.0, 25.0, 37.0, 0.0, -368.0, 16.0, -211.0, -10.0, 28.0, 22.0, 0.0, 109.0, -18.0, 3.0, -90.0, -54.0, -202.0, 11.0, 43.0, -85.0, -15.0, 27.0, 50.0, 0.0, -23.0, -12.0, -64.0, -31.0, -32.0, 8.0, -56.0, 23.0, 90.0, 0.0, 19.0, 63.0, -73.0, -37.0, -34.0, -146.0], "policy_predator_policy_reward": [107.0, 0.0, 11.0, 40.0, 60.0, 51.0, 0.0, 0.0, 11.0, 96.0, 0.0, 0.0, 15.0, 34.0, 0.0, 0.0, 111.0, 55.0, 0.0, 92.0, 6.0, 18.0, 31.0, 59.0, 0.0, 35.0, 6.0, 16.0, 81.0, 40.0, 57.0, 0.0, 89.0, 1.0, 0.0, 43.0, 69.0, 55.0, 0.0, 2.0, 53.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 47.0, 0.0, 0.0, 50.0, 2.0, 113.0, 0.0, 118.0, 0.0, 0.0, 6.0, 55.0, 6.0, 110.0, 21.0, 54.0, 72.0, 92.0, 0.0, 0.0, 0.0, 109.0, 8.0, 52.0, 0.0, 0.0, 0.0, 54.0, 48.0, 19.0, 0.0, 0.0, 0.0, 0.0, 74.0, 0.0, 19.0, 102.0, 15.0, 36.0, 1.0, 59.0, 85.0, 79.0, 30.0, 0.0, 55.0, 43.0, 0.0, 8.0, 45.0, 43.0, 35.0, 5.0, 58.0, 4.0, 3.0, 21.0, 18.0, 30.0, 0.0, 21.0, 0.0, 41.0, 0.0, 31.0, 0.0, 0.0, 0.0, 3.0, 14.0, 53.0, 10.0, 0.0, 0.0, 19.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 29.0, 0.0, 8.0, 0.0, 56.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 142.0, 83.0, 1.0, 48.0, 0.0, 0.0, 0.0, 199.0, 86.0, 28.0, 5.0, 0.0, 0.0, 0.0, 30.0, 13.0, 72.0, 15.0, 44.0, 109.0, 28.0, 50.0, 11.0, 17.0, 0.0, 0.0, 6.0, 17.0, 0.0, 79.0, 0.0, 24.0, 36.0, 0.0, 11.0, 3.0, 0.0, 1.0, 0.0, 71.0, 95.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8874190478450359, "mean_inference_ms": 2.8041901375163047, "mean_action_processing_ms": 0.35923731070269027, "mean_env_wait_ms": 0.31028372437434903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006012320518493652, "StateBufferConnector_ms": 0.0039032697677612305, "ViewRequirementAgentConnector_ms": 0.15296494960784912}, "num_episodes": 22, "episode_return_max": 218.0, "episode_return_min": -165.0, "episode_return_mean": 17.3, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.6816674416316, "num_env_steps_trained_throughput_per_sec": 332.6816674416316, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 123380.829, "restore_workers_time_ms": 0.024, "training_step_time_ms": 123380.762, "sample_time_ms": 2107.897, "learn_time_ms": 121249.636, "learn_throughput": 32.99, "synch_weights_time_ms": 19.838}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "e1352_00002", "date": "2024-08-13_19-20-16", "timestamp": 1723591216, "time_this_iter_s": 12.121186017990112, "time_total_s": 1111.0444195270538, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbbee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1111.0444195270538, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 49.747058823529414, "ram_util_percent": 83.52941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7113792332943785, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.299626972435643, "policy_loss": -0.0019015069127023693, "vf_loss": 5.3010022392979375, "vf_explained_var": 0.00829413649897096, "kl": 0.010524841392122236, "entropy": 1.5293772438215831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.474137042652047, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 6.985664801875119, "policy_loss": -0.004368974694060704, "vf_loss": 6.989962770068456, "vf_explained_var": 0.03135277155845884, "kl": 0.005680951613922127, "entropy": 1.5709760613542385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 273.0, "episode_reward_min": -167.0, "episode_reward_mean": 15.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -19.795, "predator_policy": 27.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 0.0, 57.0, -28.0, -94.0, 17.0, 66.0, -50.0, -124.0, -13.0, 91.0, -126.0, 218.0, 28.0, -83.0, 86.0, 159.0, -86.0, 108.0, -76.0, 69.0, 5.0, -58.0, -55.0, -23.0, 121.0, 100.0, -46.0, 30.0, 77.0, 2.0, 79.0, -42.0, 113.0, 81.0, 60.0, -38.0, 20.0, -36.0, 36.0, 49.0, 17.0, 68.0, -1.0, 71.0, 112.0, 113.0, -37.0, 70.0, 70.0, 41.0, 123.0, 132.0, 48.0, 36.0, 30.0, -117.0, -1.0, 37.0, -153.0, -107.0, 55.0, 109.0, 28.0, -57.0, -38.0, 36.0, 40.0, 50.0, -12.0, -16.0, 0.0, 3.0, 104.0, 83.0, -39.0, -65.0, -54.0, -132.0, 2.0, -16.0, 174.0, -23.0, -91.0, 25.0, 14.0, -65.0, -62.0, -10.0, -167.0, -24.0, 52.0, -35.0, -13.0, -35.0, 44.0, 273.0, 45.0, 24.0, 43.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-70.0, 13.0, 0.0, 0.0, 0.0, 5.0, -146.0, 5.0, 24.0, -236.0, 4.0, 7.0, 0.0, 5.0, 49.0, -230.0, 0.0, -250.0, -105.0, 0.0, 0.0, 91.0, -124.0, -119.0, -20.0, 186.0, 1.0, 27.0, -123.0, -62.0, 0.0, 67.0, 115.0, 44.0, -58.0, -102.0, 127.0, -38.0, 8.0, -201.0, -69.0, 101.0, 9.0, -148.0, -21.0, -146.0, 0.0, -110.0, -73.0, 7.0, -55.0, 123.0, -18.0, 40.0, 7.0, -116.0, 29.0, -6.0, 86.0, -48.0, -21.0, -7.0, 31.0, 27.0, -29.0, -54.0, -11.0, 93.0, 28.0, 53.0, 0.0, 43.0, -56.0, -45.0, 11.0, 9.0, -37.0, -32.0, -2.0, 27.0, 23.0, 26.0, 8.0, 9.0, 64.0, -18.0, -45.0, 16.0, 67.0, 4.0, 33.0, 50.0, 64.0, 41.0, 19.0, -112.0, 0.0, 70.0, 1.0, 60.0, 41.0, 0.0, 58.0, 65.0, -18.0, 130.0, 12.0, 36.0, 0.0, 34.0, 0.0, 25.0, 30.0, -372.0, -75.0, 25.0, 37.0, 0.0, -368.0, 16.0, -211.0, -10.0, 28.0, 22.0, 0.0, 109.0, -18.0, 3.0, -90.0, -54.0, -202.0, 11.0, 43.0, -85.0, -15.0, 27.0, 50.0, 0.0, -23.0, -12.0, -64.0, -31.0, -32.0, 8.0, -56.0, 23.0, 90.0, 0.0, 19.0, 63.0, -73.0, -37.0, -34.0, -146.0, -15.0, -334.0, -235.0, -56.0, -104.0, 6.0, -38.0, 3.0, 25.0, 145.0, -134.0, 11.0, -75.0, -156.0, 2.0, 17.0, -31.0, 19.0, -131.0, 0.0, -134.0, -59.0, -2.0, -18.0, -200.0, -144.0, 47.0, -250.0, 43.0, 0.0, 11.0, -158.0, -27.0, -18.0, -159.0, 31.0, 62.0, -49.0, 184.0, 69.0, 45.0, 0.0, -98.0, 34.0, 0.0, 39.0], "policy_predator_policy_reward": [51.0, 47.0, 0.0, 0.0, 50.0, 2.0, 113.0, 0.0, 118.0, 0.0, 0.0, 6.0, 55.0, 6.0, 110.0, 21.0, 54.0, 72.0, 92.0, 0.0, 0.0, 0.0, 109.0, 8.0, 52.0, 0.0, 0.0, 0.0, 54.0, 48.0, 19.0, 0.0, 0.0, 0.0, 0.0, 74.0, 0.0, 19.0, 102.0, 15.0, 36.0, 1.0, 59.0, 85.0, 79.0, 30.0, 0.0, 55.0, 43.0, 0.0, 8.0, 45.0, 43.0, 35.0, 5.0, 58.0, 4.0, 3.0, 21.0, 18.0, 30.0, 0.0, 21.0, 0.0, 41.0, 0.0, 31.0, 0.0, 0.0, 0.0, 3.0, 14.0, 53.0, 10.0, 0.0, 0.0, 19.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 29.0, 0.0, 8.0, 0.0, 56.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 142.0, 83.0, 1.0, 48.0, 0.0, 0.0, 0.0, 199.0, 86.0, 28.0, 5.0, 0.0, 0.0, 0.0, 30.0, 13.0, 72.0, 15.0, 44.0, 109.0, 28.0, 50.0, 11.0, 17.0, 0.0, 0.0, 6.0, 17.0, 0.0, 79.0, 0.0, 24.0, 36.0, 0.0, 11.0, 3.0, 0.0, 1.0, 0.0, 71.0, 95.0, 20.0, 148.0, 147.0, 125.0, 34.0, 32.0, 68.0, 19.0, 0.0, 4.0, 0.0, 30.0, 70.0, 57.0, 83.0, 6.0, 0.0, 25.0, 1.0, 0.0, 66.0, 121.0, 10.0, 9.0, 1.0, 72.0, 105.0, 62.0, 117.0, 0.0, 9.0, 32.0, 80.0, 32.0, 0.0, 28.0, 65.0, 2.0, 29.0, 14.0, 6.0, 0.0, 0.0, 49.0, 39.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9143300271414116, "mean_inference_ms": 2.86908275166527, "mean_action_processing_ms": 0.3681765193379376, "mean_env_wait_ms": 0.321930169911704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005413532257080078, "StateBufferConnector_ms": 0.004443168640136719, "ViewRequirementAgentConnector_ms": 0.1662532091140747}, "num_episodes": 23, "episode_return_max": 273.0, "episode_return_min": -167.0, "episode_return_mean": 15.37, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.3128372117103, "num_env_steps_trained_throughput_per_sec": 343.3128372117103, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 112207.866, "restore_workers_time_ms": 0.026, "training_step_time_ms": 112207.798, "sample_time_ms": 2166.03, "learn_time_ms": 110019.161, "learn_throughput": 36.357, "synch_weights_time_ms": 19.441}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "e1352_00002", "date": "2024-08-13_19-20-28", "timestamp": 1723591228, "time_this_iter_s": 11.69543170928955, "time_total_s": 1122.7398512363434, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbb280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1122.7398512363434, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 50.71176470588235, "ram_util_percent": 83.49411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5483019334811067, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 2.219117066721437, "policy_loss": -0.002025638925276263, "vf_loss": 2.220441876328181, "vf_explained_var": 0.007937534524019433, "kl": 0.014016634524807812, "entropy": 1.5599432285500583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8256103338703276, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 4.782643104356433, "policy_loss": -0.002665830118133238, "vf_loss": 4.7852245567967655, "vf_explained_var": 0.04455981554177703, "kl": 0.006750562799904097, "entropy": 1.556285656507684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 273.0, "episode_reward_min": -167.0, "episode_reward_mean": 20.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -15.45, "predator_policy": 25.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.0, -76.0, 69.0, 5.0, -58.0, -55.0, -23.0, 121.0, 100.0, -46.0, 30.0, 77.0, 2.0, 79.0, -42.0, 113.0, 81.0, 60.0, -38.0, 20.0, -36.0, 36.0, 49.0, 17.0, 68.0, -1.0, 71.0, 112.0, 113.0, -37.0, 70.0, 70.0, 41.0, 123.0, 132.0, 48.0, 36.0, 30.0, -117.0, -1.0, 37.0, -153.0, -107.0, 55.0, 109.0, 28.0, -57.0, -38.0, 36.0, 40.0, 50.0, -12.0, -16.0, 0.0, 3.0, 104.0, 83.0, -39.0, -65.0, -54.0, -132.0, 2.0, -16.0, 174.0, -23.0, -91.0, 25.0, 14.0, -65.0, -62.0, -10.0, -167.0, -24.0, 52.0, -35.0, -13.0, -35.0, 44.0, 273.0, 45.0, 24.0, 43.0, 34.0, 5.0, -46.0, 74.0, 65.0, 16.0, 63.0, 125.0, -10.0, 50.0, -50.0, -76.0, 0.0, -3.0, 70.0, 127.0, -5.0, 224.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [127.0, -38.0, 8.0, -201.0, -69.0, 101.0, 9.0, -148.0, -21.0, -146.0, 0.0, -110.0, -73.0, 7.0, -55.0, 123.0, -18.0, 40.0, 7.0, -116.0, 29.0, -6.0, 86.0, -48.0, -21.0, -7.0, 31.0, 27.0, -29.0, -54.0, -11.0, 93.0, 28.0, 53.0, 0.0, 43.0, -56.0, -45.0, 11.0, 9.0, -37.0, -32.0, -2.0, 27.0, 23.0, 26.0, 8.0, 9.0, 64.0, -18.0, -45.0, 16.0, 67.0, 4.0, 33.0, 50.0, 64.0, 41.0, 19.0, -112.0, 0.0, 70.0, 1.0, 60.0, 41.0, 0.0, 58.0, 65.0, -18.0, 130.0, 12.0, 36.0, 0.0, 34.0, 0.0, 25.0, 30.0, -372.0, -75.0, 25.0, 37.0, 0.0, -368.0, 16.0, -211.0, -10.0, 28.0, 22.0, 0.0, 109.0, -18.0, 3.0, -90.0, -54.0, -202.0, 11.0, 43.0, -85.0, -15.0, 27.0, 50.0, 0.0, -23.0, -12.0, -64.0, -31.0, -32.0, 8.0, -56.0, 23.0, 90.0, 0.0, 19.0, 63.0, -73.0, -37.0, -34.0, -146.0, -15.0, -334.0, -235.0, -56.0, -104.0, 6.0, -38.0, 3.0, 25.0, 145.0, -134.0, 11.0, -75.0, -156.0, 2.0, 17.0, -31.0, 19.0, -131.0, 0.0, -134.0, -59.0, -2.0, -18.0, -200.0, -144.0, 47.0, -250.0, 43.0, 0.0, 11.0, -158.0, -27.0, -18.0, -159.0, 31.0, 62.0, -49.0, 184.0, 69.0, 45.0, 0.0, -98.0, 34.0, 0.0, 39.0, -30.0, 0.0, 3.0, 2.0, -51.0, -53.0, 74.0, 0.0, 65.0, 0.0, 5.0, -8.0, -6.0, 66.0, 3.0, 103.0, -170.0, 13.0, 20.0, -18.0, -107.0, -51.0, 1.0, -166.0, 0.0, 0.0, -3.0, -92.0, 50.0, 1.0, 48.0, -42.0, -10.0, 0.0, 103.0, 117.0], "policy_predator_policy_reward": [0.0, 19.0, 102.0, 15.0, 36.0, 1.0, 59.0, 85.0, 79.0, 30.0, 0.0, 55.0, 43.0, 0.0, 8.0, 45.0, 43.0, 35.0, 5.0, 58.0, 4.0, 3.0, 21.0, 18.0, 30.0, 0.0, 21.0, 0.0, 41.0, 0.0, 31.0, 0.0, 0.0, 0.0, 3.0, 14.0, 53.0, 10.0, 0.0, 0.0, 19.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 29.0, 0.0, 8.0, 0.0, 56.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 142.0, 83.0, 1.0, 48.0, 0.0, 0.0, 0.0, 199.0, 86.0, 28.0, 5.0, 0.0, 0.0, 0.0, 30.0, 13.0, 72.0, 15.0, 44.0, 109.0, 28.0, 50.0, 11.0, 17.0, 0.0, 0.0, 6.0, 17.0, 0.0, 79.0, 0.0, 24.0, 36.0, 0.0, 11.0, 3.0, 0.0, 1.0, 0.0, 71.0, 95.0, 20.0, 148.0, 147.0, 125.0, 34.0, 32.0, 68.0, 19.0, 0.0, 4.0, 0.0, 30.0, 70.0, 57.0, 83.0, 6.0, 0.0, 25.0, 1.0, 0.0, 66.0, 121.0, 10.0, 9.0, 1.0, 72.0, 105.0, 62.0, 117.0, 0.0, 9.0, 32.0, 80.0, 32.0, 0.0, 28.0, 65.0, 2.0, 29.0, 14.0, 6.0, 0.0, 0.0, 49.0, 39.0, 4.0, 0.0, 30.0, 34.0, 0.0, 0.0, 26.0, 32.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 3.0, 19.0, 0.0, 49.0, 98.0, 15.0, 33.0, 25.0, 83.0, 83.0, 6.0, 0.0, 0.0, 90.0, 2.0, 7.0, 12.0, 29.0, 92.0, 5.0, 0.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9370594178498024, "mean_inference_ms": 2.92004577384537, "mean_action_processing_ms": 0.3760151038624575, "mean_env_wait_ms": 0.33029617538284095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00556337833404541, "StateBufferConnector_ms": 0.004320263862609863, "ViewRequirementAgentConnector_ms": 0.1712416410446167}, "num_episodes": 18, "episode_return_max": 273.0, "episode_return_min": -167.0, "episode_return_mean": 20.41, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.8234356284198, "num_env_steps_trained_throughput_per_sec": 356.8234356284198, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 112079.48, "restore_workers_time_ms": 0.024, "training_step_time_ms": 112079.414, "sample_time_ms": 2137.021, "learn_time_ms": 109919.856, "learn_throughput": 36.39, "synch_weights_time_ms": 19.237}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "e1352_00002", "date": "2024-08-13_19-20-40", "timestamp": 1723591240, "time_this_iter_s": 11.270370960235596, "time_total_s": 1134.010222196579, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbbe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1134.010222196579, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 50.2375, "ram_util_percent": 83.56875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30948579585544334, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 1.1731384663354782, "policy_loss": -0.00478779653668719, "vf_loss": 1.1770613810372732, "vf_explained_var": 0.0006512105149566812, "kl": 0.01729762885363688, "entropy": 1.5358572805369342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5523807384822734, "cur_kl_coeff": 0.0125, "cur_lr": 0.00010000000000000003, "total_loss": 3.325995627912895, "policy_loss": -0.0015588441936338626, "vf_loss": 3.3275096573526897, "vf_explained_var": 0.07681051741832148, "kl": 0.00358463906875986, "entropy": 1.575740674942259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 273.0, "episode_reward_min": -167.0, "episode_reward_mean": 20.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -12.72, "predator_policy": 23.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.0, 20.0, -36.0, 36.0, 49.0, 17.0, 68.0, -1.0, 71.0, 112.0, 113.0, -37.0, 70.0, 70.0, 41.0, 123.0, 132.0, 48.0, 36.0, 30.0, -117.0, -1.0, 37.0, -153.0, -107.0, 55.0, 109.0, 28.0, -57.0, -38.0, 36.0, 40.0, 50.0, -12.0, -16.0, 0.0, 3.0, 104.0, 83.0, -39.0, -65.0, -54.0, -132.0, 2.0, -16.0, 174.0, -23.0, -91.0, 25.0, 14.0, -65.0, -62.0, -10.0, -167.0, -24.0, 52.0, -35.0, -13.0, -35.0, 44.0, 273.0, 45.0, 24.0, 43.0, 34.0, 5.0, -46.0, 74.0, 65.0, 16.0, 63.0, 125.0, -10.0, 50.0, -50.0, -76.0, 0.0, -3.0, 70.0, 127.0, -5.0, 224.0, 32.0, -27.0, 84.0, 47.0, 36.0, -40.0, 27.0, 0.0, 40.0, 11.0, 23.0, 66.0, 137.0, 0.0, 21.0, -4.0, 17.0, 105.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-56.0, -45.0, 11.0, 9.0, -37.0, -32.0, -2.0, 27.0, 23.0, 26.0, 8.0, 9.0, 64.0, -18.0, -45.0, 16.0, 67.0, 4.0, 33.0, 50.0, 64.0, 41.0, 19.0, -112.0, 0.0, 70.0, 1.0, 60.0, 41.0, 0.0, 58.0, 65.0, -18.0, 130.0, 12.0, 36.0, 0.0, 34.0, 0.0, 25.0, 30.0, -372.0, -75.0, 25.0, 37.0, 0.0, -368.0, 16.0, -211.0, -10.0, 28.0, 22.0, 0.0, 109.0, -18.0, 3.0, -90.0, -54.0, -202.0, 11.0, 43.0, -85.0, -15.0, 27.0, 50.0, 0.0, -23.0, -12.0, -64.0, -31.0, -32.0, 8.0, -56.0, 23.0, 90.0, 0.0, 19.0, 63.0, -73.0, -37.0, -34.0, -146.0, -15.0, -334.0, -235.0, -56.0, -104.0, 6.0, -38.0, 3.0, 25.0, 145.0, -134.0, 11.0, -75.0, -156.0, 2.0, 17.0, -31.0, 19.0, -131.0, 0.0, -134.0, -59.0, -2.0, -18.0, -200.0, -144.0, 47.0, -250.0, 43.0, 0.0, 11.0, -158.0, -27.0, -18.0, -159.0, 31.0, 62.0, -49.0, 184.0, 69.0, 45.0, 0.0, -98.0, 34.0, 0.0, 39.0, -30.0, 0.0, 3.0, 2.0, -51.0, -53.0, 74.0, 0.0, 65.0, 0.0, 5.0, -8.0, -6.0, 66.0, 3.0, 103.0, -170.0, 13.0, 20.0, -18.0, -107.0, -51.0, 1.0, -166.0, 0.0, 0.0, -3.0, -92.0, 50.0, 1.0, 48.0, -42.0, -10.0, 0.0, 103.0, 117.0, 0.0, 8.0, -46.0, -8.0, 54.0, -44.0, -50.0, 72.0, -1.0, 0.0, -18.0, -62.0, -21.0, 0.0, 0.0, 0.0, 4.0, 0.0, -46.0, -10.0, 3.0, 19.0, -4.0, 68.0, 135.0, 2.0, 0.0, 0.0, 0.0, 21.0, -8.0, 0.0, 16.0, 1.0, 64.0, 38.0], "policy_predator_policy_reward": [53.0, 10.0, 0.0, 0.0, 19.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 28.0, 0.0, 0.0, 0.0, 29.0, 0.0, 8.0, 0.0, 56.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 142.0, 83.0, 1.0, 48.0, 0.0, 0.0, 0.0, 199.0, 86.0, 28.0, 5.0, 0.0, 0.0, 0.0, 30.0, 13.0, 72.0, 15.0, 44.0, 109.0, 28.0, 50.0, 11.0, 17.0, 0.0, 0.0, 6.0, 17.0, 0.0, 79.0, 0.0, 24.0, 36.0, 0.0, 11.0, 3.0, 0.0, 1.0, 0.0, 71.0, 95.0, 20.0, 148.0, 147.0, 125.0, 34.0, 32.0, 68.0, 19.0, 0.0, 4.0, 0.0, 30.0, 70.0, 57.0, 83.0, 6.0, 0.0, 25.0, 1.0, 0.0, 66.0, 121.0, 10.0, 9.0, 1.0, 72.0, 105.0, 62.0, 117.0, 0.0, 9.0, 32.0, 80.0, 32.0, 0.0, 28.0, 65.0, 2.0, 29.0, 14.0, 6.0, 0.0, 0.0, 49.0, 39.0, 4.0, 0.0, 30.0, 34.0, 0.0, 0.0, 26.0, 32.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 3.0, 19.0, 0.0, 49.0, 98.0, 15.0, 33.0, 25.0, 83.0, 83.0, 6.0, 0.0, 0.0, 90.0, 2.0, 7.0, 12.0, 29.0, 92.0, 5.0, 0.0, 0.0, 4.0, 24.0, 0.0, 9.0, 18.0, 58.0, 16.0, 0.0, 25.0, 0.0, 37.0, 40.0, 0.0, 45.0, 3.0, 0.0, 0.0, 32.0, 4.0, 36.0, 31.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9339549466054493, "mean_inference_ms": 2.8995107322135345, "mean_action_processing_ms": 0.3746102533291302, "mean_env_wait_ms": 0.3290657294509438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005419254302978516, "StateBufferConnector_ms": 0.004240512847900391, "ViewRequirementAgentConnector_ms": 0.14552748203277588}, "num_episodes": 18, "episode_return_max": 273.0, "episode_return_min": -167.0, "episode_return_mean": 20.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 126.97098594800364, "num_env_steps_trained_throughput_per_sec": 126.97098594800364, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 96341.1, "restore_workers_time_ms": 0.017, "training_step_time_ms": 96341.048, "sample_time_ms": 2029.914, "learn_time_ms": 94288.132, "learn_throughput": 42.423, "synch_weights_time_ms": 19.688}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "e1352_00002", "date": "2024-08-13_19-21-11", "timestamp": 1723591271, "time_this_iter_s": 31.5405170917511, "time_total_s": 1165.55073928833, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbbee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1165.55073928833, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 74.09565217391305, "ram_util_percent": 83.98260869565217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3655893424594844, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 2.4265598599242155, "policy_loss": -0.00537346487608615, "vf_loss": 2.431272154005747, "vf_explained_var": 0.004327812775102242, "kl": 0.013223225692525643, "entropy": 1.5311393813481406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.302735885626898, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 5.207526776904151, "policy_loss": -0.0012285798561399576, "vf_loss": 5.208717569724593, "vf_explained_var": 0.058560682888384216, "kl": 0.0060473176435798135, "entropy": 1.5375648048819688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 273.0, "episode_reward_min": -167.0, "episode_reward_mean": 13.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -19.61, "predator_policy": 26.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.0, 30.0, -117.0, -1.0, 37.0, -153.0, -107.0, 55.0, 109.0, 28.0, -57.0, -38.0, 36.0, 40.0, 50.0, -12.0, -16.0, 0.0, 3.0, 104.0, 83.0, -39.0, -65.0, -54.0, -132.0, 2.0, -16.0, 174.0, -23.0, -91.0, 25.0, 14.0, -65.0, -62.0, -10.0, -167.0, -24.0, 52.0, -35.0, -13.0, -35.0, 44.0, 273.0, 45.0, 24.0, 43.0, 34.0, 5.0, -46.0, 74.0, 65.0, 16.0, 63.0, 125.0, -10.0, 50.0, -50.0, -76.0, 0.0, -3.0, 70.0, 127.0, -5.0, 224.0, 32.0, -27.0, 84.0, 47.0, 36.0, -40.0, 27.0, 0.0, 40.0, 11.0, 23.0, 66.0, 137.0, 0.0, 21.0, -4.0, 17.0, 105.0, -166.0, -10.0, 29.0, 45.0, 118.0, -45.0, 1.0, 201.0, -30.0, 74.0, -5.0, -73.0, 14.0, -37.0, 28.0, 142.0, 35.0, -140.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 34.0, 0.0, 25.0, 30.0, -372.0, -75.0, 25.0, 37.0, 0.0, -368.0, 16.0, -211.0, -10.0, 28.0, 22.0, 0.0, 109.0, -18.0, 3.0, -90.0, -54.0, -202.0, 11.0, 43.0, -85.0, -15.0, 27.0, 50.0, 0.0, -23.0, -12.0, -64.0, -31.0, -32.0, 8.0, -56.0, 23.0, 90.0, 0.0, 19.0, 63.0, -73.0, -37.0, -34.0, -146.0, -15.0, -334.0, -235.0, -56.0, -104.0, 6.0, -38.0, 3.0, 25.0, 145.0, -134.0, 11.0, -75.0, -156.0, 2.0, 17.0, -31.0, 19.0, -131.0, 0.0, -134.0, -59.0, -2.0, -18.0, -200.0, -144.0, 47.0, -250.0, 43.0, 0.0, 11.0, -158.0, -27.0, -18.0, -159.0, 31.0, 62.0, -49.0, 184.0, 69.0, 45.0, 0.0, -98.0, 34.0, 0.0, 39.0, -30.0, 0.0, 3.0, 2.0, -51.0, -53.0, 74.0, 0.0, 65.0, 0.0, 5.0, -8.0, -6.0, 66.0, 3.0, 103.0, -170.0, 13.0, 20.0, -18.0, -107.0, -51.0, 1.0, -166.0, 0.0, 0.0, -3.0, -92.0, 50.0, 1.0, 48.0, -42.0, -10.0, 0.0, 103.0, 117.0, 0.0, 8.0, -46.0, -8.0, 54.0, -44.0, -50.0, 72.0, -1.0, 0.0, -18.0, -62.0, -21.0, 0.0, 0.0, 0.0, 4.0, 0.0, -46.0, -10.0, 3.0, 19.0, -4.0, 68.0, 135.0, 2.0, 0.0, 0.0, 0.0, 21.0, -8.0, 0.0, 16.0, 1.0, 64.0, 38.0, -168.0, -86.0, 45.0, -302.0, -52.0, 22.0, -96.0, 83.0, 27.0, 73.0, -38.0, -52.0, 1.0, 0.0, 6.0, 193.0, -60.0, 0.0, 18.0, 0.0, -2.0, -8.0, -135.0, -20.0, -112.0, 70.0, -38.0, -38.0, 28.0, 0.0, 168.0, -58.0, 0.0, 10.0, -172.0, -106.0], "policy_predator_policy_reward": [2.0, 0.0, 0.0, 5.0, 142.0, 83.0, 1.0, 48.0, 0.0, 0.0, 0.0, 199.0, 86.0, 28.0, 5.0, 0.0, 0.0, 0.0, 30.0, 13.0, 72.0, 15.0, 44.0, 109.0, 28.0, 50.0, 11.0, 17.0, 0.0, 0.0, 6.0, 17.0, 0.0, 79.0, 0.0, 24.0, 36.0, 0.0, 11.0, 3.0, 0.0, 1.0, 0.0, 71.0, 95.0, 20.0, 148.0, 147.0, 125.0, 34.0, 32.0, 68.0, 19.0, 0.0, 4.0, 0.0, 30.0, 70.0, 57.0, 83.0, 6.0, 0.0, 25.0, 1.0, 0.0, 66.0, 121.0, 10.0, 9.0, 1.0, 72.0, 105.0, 62.0, 117.0, 0.0, 9.0, 32.0, 80.0, 32.0, 0.0, 28.0, 65.0, 2.0, 29.0, 14.0, 6.0, 0.0, 0.0, 49.0, 39.0, 4.0, 0.0, 30.0, 34.0, 0.0, 0.0, 26.0, 32.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 3.0, 19.0, 0.0, 49.0, 98.0, 15.0, 33.0, 25.0, 83.0, 83.0, 6.0, 0.0, 0.0, 90.0, 2.0, 7.0, 12.0, 29.0, 92.0, 5.0, 0.0, 0.0, 4.0, 24.0, 0.0, 9.0, 18.0, 58.0, 16.0, 0.0, 25.0, 0.0, 37.0, 40.0, 0.0, 45.0, 3.0, 0.0, 0.0, 32.0, 4.0, 36.0, 31.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 3.0, 0.0, 88.0, 0.0, 165.0, 82.0, 46.0, 13.0, 21.0, 37.0, 17.0, 1.0, 19.0, 26.0, 0.0, 0.0, 0.0, 2.0, 14.0, 16.0, 46.0, 10.0, 4.0, 1.0, 82.0, 0.0, 0.0, 56.0, 13.0, 26.0, 0.0, 0.0, 0.0, 32.0, 0.0, 25.0, 19.0, 119.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9321529886769174, "mean_inference_ms": 2.892717138701167, "mean_action_processing_ms": 0.3740858068932102, "mean_env_wait_ms": 0.3290568419562219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005334377288818359, "StateBufferConnector_ms": 0.004121661186218262, "ViewRequirementAgentConnector_ms": 0.14536702632904053}, "num_episodes": 18, "episode_return_max": 273.0, "episode_return_min": -167.0, "episode_return_mean": 13.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.48740304674794, "num_env_steps_trained_throughput_per_sec": 333.48740304674794, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 96407.179, "restore_workers_time_ms": 0.017, "training_step_time_ms": 96407.127, "sample_time_ms": 2100.86, "learn_time_ms": 94283.33, "learn_throughput": 42.425, "synch_weights_time_ms": 19.632}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "e1352_00002", "date": "2024-08-13_19-21-23", "timestamp": 1723591283, "time_this_iter_s": 12.044506072998047, "time_total_s": 1177.5952453613281, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d6bfaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1177.5952453613281, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 59.95294117647058, "ram_util_percent": 82.0764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.25839674585553074, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 2.54492253197564, "policy_loss": -0.002690864855019504, "vf_loss": 2.5471117574071127, "vf_explained_var": 0.002538568096816855, "kl": 0.01003268645933032, "entropy": 1.5557504035808423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2203401706166686, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 4.75781924283063, "policy_loss": -0.004156782757737255, "vf_loss": 4.76193039164972, "vf_explained_var": 0.045936636224625606, "kl": 0.00730276013774185, "entropy": 1.5759349245873708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -167.0, "episode_reward_mean": 27.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -302.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": -9.135, "predator_policy": 23.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.0, -23.0, -91.0, 25.0, 14.0, -65.0, -62.0, -10.0, -167.0, -24.0, 52.0, -35.0, -13.0, -35.0, 44.0, 273.0, 45.0, 24.0, 43.0, 34.0, 5.0, -46.0, 74.0, 65.0, 16.0, 63.0, 125.0, -10.0, 50.0, -50.0, -76.0, 0.0, -3.0, 70.0, 127.0, -5.0, 224.0, 32.0, -27.0, 84.0, 47.0, 36.0, -40.0, 27.0, 0.0, 40.0, 11.0, 23.0, 66.0, 137.0, 0.0, 21.0, -4.0, 17.0, 105.0, -166.0, -10.0, 29.0, 45.0, 118.0, -45.0, 1.0, 201.0, -30.0, 74.0, -5.0, -73.0, 14.0, -37.0, 28.0, 142.0, 35.0, -140.0, -41.0, -41.0, 84.0, 47.0, 182.0, 0.0, 189.0, 62.0, 12.0, 29.0, 43.0, -32.0, 189.0, 106.0, -65.0, 149.0, 0.0, -88.0, 14.0, -120.0, -44.0, 16.0, 79.0, -16.0, 358.0, 89.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [25.0, 145.0, -134.0, 11.0, -75.0, -156.0, 2.0, 17.0, -31.0, 19.0, -131.0, 0.0, -134.0, -59.0, -2.0, -18.0, -200.0, -144.0, 47.0, -250.0, 43.0, 0.0, 11.0, -158.0, -27.0, -18.0, -159.0, 31.0, 62.0, -49.0, 184.0, 69.0, 45.0, 0.0, -98.0, 34.0, 0.0, 39.0, -30.0, 0.0, 3.0, 2.0, -51.0, -53.0, 74.0, 0.0, 65.0, 0.0, 5.0, -8.0, -6.0, 66.0, 3.0, 103.0, -170.0, 13.0, 20.0, -18.0, -107.0, -51.0, 1.0, -166.0, 0.0, 0.0, -3.0, -92.0, 50.0, 1.0, 48.0, -42.0, -10.0, 0.0, 103.0, 117.0, 0.0, 8.0, -46.0, -8.0, 54.0, -44.0, -50.0, 72.0, -1.0, 0.0, -18.0, -62.0, -21.0, 0.0, 0.0, 0.0, 4.0, 0.0, -46.0, -10.0, 3.0, 19.0, -4.0, 68.0, 135.0, 2.0, 0.0, 0.0, 0.0, 21.0, -8.0, 0.0, 16.0, 1.0, 64.0, 38.0, -168.0, -86.0, 45.0, -302.0, -52.0, 22.0, -96.0, 83.0, 27.0, 73.0, -38.0, -52.0, 1.0, 0.0, 6.0, 193.0, -60.0, 0.0, 18.0, 0.0, -2.0, -8.0, -135.0, -20.0, -112.0, 70.0, -38.0, -38.0, 28.0, 0.0, 168.0, -58.0, 0.0, 10.0, -172.0, -106.0, -140.0, -3.0, -82.0, 0.0, 54.0, 17.0, 24.0, -73.0, 161.0, 9.0, 0.0, 0.0, 120.0, 69.0, 97.0, -266.0, 2.0, -54.0, -11.0, 8.0, 33.0, 10.0, -2.0, -62.0, 172.0, 10.0, 64.0, 0.0, -184.0, 27.0, 86.0, -32.0, 0.0, 0.0, -82.0, -68.0, 0.0, 14.0, -122.0, -128.0, -232.0, 70.0, -22.0, 27.0, -23.0, 86.0, -32.0, 0.0, 158.0, 200.0, 89.0, 0.0, 6.0, -18.0], "policy_predator_policy_reward": [4.0, 0.0, 30.0, 70.0, 57.0, 83.0, 6.0, 0.0, 25.0, 1.0, 0.0, 66.0, 121.0, 10.0, 9.0, 1.0, 72.0, 105.0, 62.0, 117.0, 0.0, 9.0, 32.0, 80.0, 32.0, 0.0, 28.0, 65.0, 2.0, 29.0, 14.0, 6.0, 0.0, 0.0, 49.0, 39.0, 4.0, 0.0, 30.0, 34.0, 0.0, 0.0, 26.0, 32.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 3.0, 19.0, 0.0, 49.0, 98.0, 15.0, 33.0, 25.0, 83.0, 83.0, 6.0, 0.0, 0.0, 90.0, 2.0, 7.0, 12.0, 29.0, 92.0, 5.0, 0.0, 0.0, 4.0, 24.0, 0.0, 9.0, 18.0, 58.0, 16.0, 0.0, 25.0, 0.0, 37.0, 40.0, 0.0, 45.0, 3.0, 0.0, 0.0, 32.0, 4.0, 36.0, 31.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 3.0, 0.0, 88.0, 0.0, 165.0, 82.0, 46.0, 13.0, 21.0, 37.0, 17.0, 1.0, 19.0, 26.0, 0.0, 0.0, 0.0, 2.0, 14.0, 16.0, 46.0, 10.0, 4.0, 1.0, 82.0, 0.0, 0.0, 56.0, 13.0, 26.0, 0.0, 0.0, 0.0, 32.0, 0.0, 25.0, 19.0, 119.0, 41.0, 61.0, 0.0, 41.0, 0.0, 13.0, 46.0, 50.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 85.0, 0.0, 64.0, 4.0, 28.0, 0.0, 0.0, 31.0, 1.0, 7.0, 0.0, 20.0, 22.0, 92.0, 0.0, 41.0, 54.0, 0.0, 0.0, 58.0, 4.0, 0.0, 0.0, 65.0, 65.0, 2.0, 116.0, 11.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9233365025259063, "mean_inference_ms": 2.870826713123134, "mean_action_processing_ms": 0.36953270232914576, "mean_env_wait_ms": 0.3266995524483324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004637360572814941, "StateBufferConnector_ms": 0.003997206687927246, "ViewRequirementAgentConnector_ms": 0.1244276762008667}, "num_episodes": 27, "episode_return_max": 358.0, "episode_return_min": -167.0, "episode_return_mean": 27.86, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.1211576586456, "num_env_steps_trained_throughput_per_sec": 334.1211576586456, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 96468.789, "restore_workers_time_ms": 0.017, "training_step_time_ms": 96468.737, "sample_time_ms": 2106.705, "learn_time_ms": 94339.637, "learn_throughput": 42.4, "synch_weights_time_ms": 18.724}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "e1352_00002", "date": "2024-08-13_19-21-35", "timestamp": 1723591295, "time_this_iter_s": 12.016136884689331, "time_total_s": 1189.6113822460175, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1189.6113822460175, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 52.69411764705882, "ram_util_percent": 82.11176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36799616141924785, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.902432099978129, "policy_loss": -0.005831428653457099, "vf_loss": 3.9072536658988426, "vf_explained_var": 0.005003475165240979, "kl": 0.02019716618065028, "entropy": 1.5111874114899408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.243664260015444, "cur_kl_coeff": 0.00625, "cur_lr": 0.00010000000000000003, "total_loss": 6.203963140457396, "policy_loss": -0.0030382891092572617, "vf_loss": 6.206971337050988, "vf_explained_var": 0.029028286221166138, "kl": 0.004812784223983014, "entropy": 1.5453332188268187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -166.0, "episode_reward_mean": 27.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -302.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": -8.33, "predator_policy": 22.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.0, 34.0, 5.0, -46.0, 74.0, 65.0, 16.0, 63.0, 125.0, -10.0, 50.0, -50.0, -76.0, 0.0, -3.0, 70.0, 127.0, -5.0, 224.0, 32.0, -27.0, 84.0, 47.0, 36.0, -40.0, 27.0, 0.0, 40.0, 11.0, 23.0, 66.0, 137.0, 0.0, 21.0, -4.0, 17.0, 105.0, -166.0, -10.0, 29.0, 45.0, 118.0, -45.0, 1.0, 201.0, -30.0, 74.0, -5.0, -73.0, 14.0, -37.0, 28.0, 142.0, 35.0, -140.0, -41.0, -41.0, 84.0, 47.0, 182.0, 0.0, 189.0, 62.0, 12.0, 29.0, 43.0, -32.0, 189.0, 106.0, -65.0, 149.0, 0.0, -88.0, 14.0, -120.0, -44.0, 16.0, 79.0, -16.0, 358.0, 89.0, -3.0, -14.0, 54.0, -21.0, 13.0, 110.0, 96.0, 225.0, -22.0, -145.0, -45.0, 76.0, -146.0, -106.0, -43.0, 43.0, -11.0, -3.0, 33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 39.0, -30.0, 0.0, 3.0, 2.0, -51.0, -53.0, 74.0, 0.0, 65.0, 0.0, 5.0, -8.0, -6.0, 66.0, 3.0, 103.0, -170.0, 13.0, 20.0, -18.0, -107.0, -51.0, 1.0, -166.0, 0.0, 0.0, -3.0, -92.0, 50.0, 1.0, 48.0, -42.0, -10.0, 0.0, 103.0, 117.0, 0.0, 8.0, -46.0, -8.0, 54.0, -44.0, -50.0, 72.0, -1.0, 0.0, -18.0, -62.0, -21.0, 0.0, 0.0, 0.0, 4.0, 0.0, -46.0, -10.0, 3.0, 19.0, -4.0, 68.0, 135.0, 2.0, 0.0, 0.0, 0.0, 21.0, -8.0, 0.0, 16.0, 1.0, 64.0, 38.0, -168.0, -86.0, 45.0, -302.0, -52.0, 22.0, -96.0, 83.0, 27.0, 73.0, -38.0, -52.0, 1.0, 0.0, 6.0, 193.0, -60.0, 0.0, 18.0, 0.0, -2.0, -8.0, -135.0, -20.0, -112.0, 70.0, -38.0, -38.0, 28.0, 0.0, 168.0, -58.0, 0.0, 10.0, -172.0, -106.0, -140.0, -3.0, -82.0, 0.0, 54.0, 17.0, 24.0, -73.0, 161.0, 9.0, 0.0, 0.0, 120.0, 69.0, 97.0, -266.0, 2.0, -54.0, -11.0, 8.0, 33.0, 10.0, -2.0, -62.0, 172.0, 10.0, 64.0, 0.0, -184.0, 27.0, 86.0, -32.0, 0.0, 0.0, -82.0, -68.0, 0.0, 14.0, -122.0, -128.0, -232.0, 70.0, -22.0, 27.0, -23.0, 86.0, -32.0, 0.0, 158.0, 200.0, 89.0, 0.0, 6.0, -18.0, -192.0, 82.0, -17.0, 16.0, 0.0, -44.0, 0.0, 13.0, 4.0, 80.0, -14.0, 75.0, 122.0, 103.0, -173.0, 51.0, -134.0, -114.0, -82.0, -8.0, 38.0, 14.0, -127.0, -157.0, 0.0, -228.0, -108.0, 0.0, 10.0, -9.0, 4.0, -82.0, 3.0, -33.0, -26.0, -4.0], "policy_predator_policy_reward": [4.0, 0.0, 30.0, 34.0, 0.0, 0.0, 26.0, 32.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 3.0, 19.0, 0.0, 49.0, 98.0, 15.0, 33.0, 25.0, 83.0, 83.0, 6.0, 0.0, 0.0, 90.0, 2.0, 7.0, 12.0, 29.0, 92.0, 5.0, 0.0, 0.0, 4.0, 24.0, 0.0, 9.0, 18.0, 58.0, 16.0, 0.0, 25.0, 0.0, 37.0, 40.0, 0.0, 45.0, 3.0, 0.0, 0.0, 32.0, 4.0, 36.0, 31.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 3.0, 0.0, 88.0, 0.0, 165.0, 82.0, 46.0, 13.0, 21.0, 37.0, 17.0, 1.0, 19.0, 26.0, 0.0, 0.0, 0.0, 2.0, 14.0, 16.0, 46.0, 10.0, 4.0, 1.0, 82.0, 0.0, 0.0, 56.0, 13.0, 26.0, 0.0, 0.0, 0.0, 32.0, 0.0, 25.0, 19.0, 119.0, 41.0, 61.0, 0.0, 41.0, 0.0, 13.0, 46.0, 50.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 85.0, 0.0, 64.0, 4.0, 28.0, 0.0, 0.0, 31.0, 1.0, 7.0, 0.0, 20.0, 22.0, 92.0, 0.0, 41.0, 54.0, 0.0, 0.0, 58.0, 4.0, 0.0, 0.0, 65.0, 65.0, 2.0, 116.0, 11.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 85.0, 11.0, 35.0, 20.0, 23.0, 0.0, 0.0, 0.0, 26.0, 0.0, 35.0, 0.0, 0.0, 0.0, 44.0, 56.0, 44.0, 59.0, 43.0, 2.0, 3.0, 21.0, 46.0, 92.0, 121.0, 1.0, 0.0, 65.0, 0.0, 42.0, 34.0, 33.0, 0.0, 27.0, 36.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9108421723420386, "mean_inference_ms": 2.832562591947093, "mean_action_processing_ms": 0.36463733599609677, "mean_env_wait_ms": 0.3212843252660685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003960609436035156, "StateBufferConnector_ms": 0.003398895263671875, "ViewRequirementAgentConnector_ms": 0.11547982692718506}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -166.0, "episode_return_mean": 27.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.4565623389202, "num_env_steps_trained_throughput_per_sec": 329.4565623389202, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 96516.985, "restore_workers_time_ms": 0.017, "training_step_time_ms": 96516.933, "sample_time_ms": 2059.73, "learn_time_ms": 94434.111, "learn_throughput": 42.358, "synch_weights_time_ms": 19.353}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "e1352_00002", "date": "2024-08-13_19-21-48", "timestamp": 1723591308, "time_this_iter_s": 12.199725866317749, "time_total_s": 1201.8111081123352, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb5a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1201.8111081123352, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 58.66470588235295, "ram_util_percent": 83.22941176470587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3960090740588765, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.773191225087201, "policy_loss": -0.004976053767167426, "vf_loss": 3.7772741720159217, "vf_explained_var": 0.002658479995828457, "kl": 0.011907997081611804, "entropy": 1.4563329744591285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.918543703428337, "cur_kl_coeff": 0.003125, "cur_lr": 0.00010000000000000003, "total_loss": 6.178059595350235, "policy_loss": -0.0013036771293079097, "vf_loss": 6.179343988529589, "vf_explained_var": 0.04929835216078178, "kl": 0.006164992125163687, "entropy": 1.532569136379888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -166.0, "episode_reward_mean": 22.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -302.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": -13.585, "predator_policy": 24.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.0, 32.0, -27.0, 84.0, 47.0, 36.0, -40.0, 27.0, 0.0, 40.0, 11.0, 23.0, 66.0, 137.0, 0.0, 21.0, -4.0, 17.0, 105.0, -166.0, -10.0, 29.0, 45.0, 118.0, -45.0, 1.0, 201.0, -30.0, 74.0, -5.0, -73.0, 14.0, -37.0, 28.0, 142.0, 35.0, -140.0, -41.0, -41.0, 84.0, 47.0, 182.0, 0.0, 189.0, 62.0, 12.0, 29.0, 43.0, -32.0, 189.0, 106.0, -65.0, 149.0, 0.0, -88.0, 14.0, -120.0, -44.0, 16.0, 79.0, -16.0, 358.0, 89.0, -3.0, -14.0, 54.0, -21.0, 13.0, 110.0, 96.0, 225.0, -22.0, -145.0, -45.0, 76.0, -146.0, -106.0, -43.0, 43.0, -11.0, -3.0, 33.0, 42.0, 140.0, 100.0, -121.0, 71.0, -77.0, -13.0, -119.0, -129.0, -109.0, -10.0, 30.0, -146.0, 160.0, -86.0, 125.0, -16.0, 149.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [103.0, 117.0, 0.0, 8.0, -46.0, -8.0, 54.0, -44.0, -50.0, 72.0, -1.0, 0.0, -18.0, -62.0, -21.0, 0.0, 0.0, 0.0, 4.0, 0.0, -46.0, -10.0, 3.0, 19.0, -4.0, 68.0, 135.0, 2.0, 0.0, 0.0, 0.0, 21.0, -8.0, 0.0, 16.0, 1.0, 64.0, 38.0, -168.0, -86.0, 45.0, -302.0, -52.0, 22.0, -96.0, 83.0, 27.0, 73.0, -38.0, -52.0, 1.0, 0.0, 6.0, 193.0, -60.0, 0.0, 18.0, 0.0, -2.0, -8.0, -135.0, -20.0, -112.0, 70.0, -38.0, -38.0, 28.0, 0.0, 168.0, -58.0, 0.0, 10.0, -172.0, -106.0, -140.0, -3.0, -82.0, 0.0, 54.0, 17.0, 24.0, -73.0, 161.0, 9.0, 0.0, 0.0, 120.0, 69.0, 97.0, -266.0, 2.0, -54.0, -11.0, 8.0, 33.0, 10.0, -2.0, -62.0, 172.0, 10.0, 64.0, 0.0, -184.0, 27.0, 86.0, -32.0, 0.0, 0.0, -82.0, -68.0, 0.0, 14.0, -122.0, -128.0, -232.0, 70.0, -22.0, 27.0, -23.0, 86.0, -32.0, 0.0, 158.0, 200.0, 89.0, 0.0, 6.0, -18.0, -192.0, 82.0, -17.0, 16.0, 0.0, -44.0, 0.0, 13.0, 4.0, 80.0, -14.0, 75.0, 122.0, 103.0, -173.0, 51.0, -134.0, -114.0, -82.0, -8.0, 38.0, 14.0, -127.0, -157.0, 0.0, -228.0, -108.0, 0.0, 10.0, -9.0, 4.0, -82.0, 3.0, -33.0, -26.0, -4.0, 37.0, -27.0, 28.0, 92.0, 92.0, 0.0, 5.0, -270.0, 37.0, -1.0, 0.0, -164.0, -156.0, 65.0, 20.0, -278.0, -66.0, -150.0, -82.0, -184.0, -68.0, -2.0, 32.0, -86.0, -219.0, -84.0, 87.0, 54.0, -177.0, 0.0, 20.0, 43.0, 21.0, -108.0, 87.0, 37.0], "policy_predator_policy_reward": [0.0, 4.0, 24.0, 0.0, 9.0, 18.0, 58.0, 16.0, 0.0, 25.0, 0.0, 37.0, 40.0, 0.0, 45.0, 3.0, 0.0, 0.0, 32.0, 4.0, 36.0, 31.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 3.0, 0.0, 88.0, 0.0, 165.0, 82.0, 46.0, 13.0, 21.0, 37.0, 17.0, 1.0, 19.0, 26.0, 0.0, 0.0, 0.0, 2.0, 14.0, 16.0, 46.0, 10.0, 4.0, 1.0, 82.0, 0.0, 0.0, 56.0, 13.0, 26.0, 0.0, 0.0, 0.0, 32.0, 0.0, 25.0, 19.0, 119.0, 41.0, 61.0, 0.0, 41.0, 0.0, 13.0, 46.0, 50.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 85.0, 0.0, 64.0, 4.0, 28.0, 0.0, 0.0, 31.0, 1.0, 7.0, 0.0, 20.0, 22.0, 92.0, 0.0, 41.0, 54.0, 0.0, 0.0, 58.0, 4.0, 0.0, 0.0, 65.0, 65.0, 2.0, 116.0, 11.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 85.0, 11.0, 35.0, 20.0, 23.0, 0.0, 0.0, 0.0, 26.0, 0.0, 35.0, 0.0, 0.0, 0.0, 44.0, 56.0, 44.0, 59.0, 43.0, 2.0, 3.0, 21.0, 46.0, 92.0, 121.0, 1.0, 0.0, 65.0, 0.0, 42.0, 34.0, 33.0, 0.0, 27.0, 36.0, 27.0, 14.0, 18.0, 0.0, 20.0, 8.0, 0.0, 0.0, 144.0, 35.0, 0.0, 84.0, 3.0, 0.0, 78.0, 139.0, 0.0, 75.0, 12.0, 0.0, 157.0, 60.0, 0.0, 25.0, 59.0, 42.0, 115.0, 3.0, 16.0, 0.0, 91.0, 13.0, 49.0, 10.0, 61.0, 25.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8993799173990115, "mean_inference_ms": 2.802493653209067, "mean_action_processing_ms": 0.35996826527572706, "mean_env_wait_ms": 0.31729683142993936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003875255584716797, "StateBufferConnector_ms": 0.003489255905151367, "ViewRequirementAgentConnector_ms": 0.10931897163391113}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -166.0, "episode_return_mean": 22.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.46434668890225, "num_env_steps_trained_throughput_per_sec": 338.46434668890225, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 19826.451, "restore_workers_time_ms": 0.017, "training_step_time_ms": 19826.402, "sample_time_ms": 2073.281, "learn_time_ms": 17731.948, "learn_throughput": 225.582, "synch_weights_time_ms": 18.075}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "e1352_00002", "date": "2024-08-13_19-22-00", "timestamp": 1723591320, "time_this_iter_s": 11.870332956314087, "time_total_s": 1213.6814410686493, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d6bfa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1213.6814410686493, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 57.12941176470587, "ram_util_percent": 83.31764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3809342211989499, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 4.4676725342160175, "policy_loss": -0.0035015459879542943, "vf_loss": 4.4702235142389934, "vf_explained_var": 0.003744326571308116, "kl": 0.012674285581273665, "entropy": 1.4780315418092032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.31532769579263, "cur_kl_coeff": 0.003125, "cur_lr": 0.00010000000000000003, "total_loss": 5.427406833285377, "policy_loss": -0.002259021521688848, "vf_loss": 5.429655469283856, "vf_explained_var": 0.030524443507825256, "kl": 0.003323650391680843, "entropy": 1.5661921625414854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -279.0, "episode_reward_mean": 10.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -302.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": -23.075, "predator_policy": 28.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.0, -166.0, -10.0, 29.0, 45.0, 118.0, -45.0, 1.0, 201.0, -30.0, 74.0, -5.0, -73.0, 14.0, -37.0, 28.0, 142.0, 35.0, -140.0, -41.0, -41.0, 84.0, 47.0, 182.0, 0.0, 189.0, 62.0, 12.0, 29.0, 43.0, -32.0, 189.0, 106.0, -65.0, 149.0, 0.0, -88.0, 14.0, -120.0, -44.0, 16.0, 79.0, -16.0, 358.0, 89.0, -3.0, -14.0, 54.0, -21.0, 13.0, 110.0, 96.0, 225.0, -22.0, -145.0, -45.0, 76.0, -146.0, -106.0, -43.0, 43.0, -11.0, -3.0, 33.0, 42.0, 140.0, 100.0, -121.0, 71.0, -77.0, -13.0, -119.0, -129.0, -109.0, -10.0, 30.0, -146.0, 160.0, -86.0, 125.0, -16.0, 149.0, 24.0, -4.0, 2.0, -165.0, -23.0, -93.0, -279.0, -25.0, 31.0, -13.0, 9.0, 62.0, 129.0, -96.0, 1.0, -148.0, -4.0, 91.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [64.0, 38.0, -168.0, -86.0, 45.0, -302.0, -52.0, 22.0, -96.0, 83.0, 27.0, 73.0, -38.0, -52.0, 1.0, 0.0, 6.0, 193.0, -60.0, 0.0, 18.0, 0.0, -2.0, -8.0, -135.0, -20.0, -112.0, 70.0, -38.0, -38.0, 28.0, 0.0, 168.0, -58.0, 0.0, 10.0, -172.0, -106.0, -140.0, -3.0, -82.0, 0.0, 54.0, 17.0, 24.0, -73.0, 161.0, 9.0, 0.0, 0.0, 120.0, 69.0, 97.0, -266.0, 2.0, -54.0, -11.0, 8.0, 33.0, 10.0, -2.0, -62.0, 172.0, 10.0, 64.0, 0.0, -184.0, 27.0, 86.0, -32.0, 0.0, 0.0, -82.0, -68.0, 0.0, 14.0, -122.0, -128.0, -232.0, 70.0, -22.0, 27.0, -23.0, 86.0, -32.0, 0.0, 158.0, 200.0, 89.0, 0.0, 6.0, -18.0, -192.0, 82.0, -17.0, 16.0, 0.0, -44.0, 0.0, 13.0, 4.0, 80.0, -14.0, 75.0, 122.0, 103.0, -173.0, 51.0, -134.0, -114.0, -82.0, -8.0, 38.0, 14.0, -127.0, -157.0, 0.0, -228.0, -108.0, 0.0, 10.0, -9.0, 4.0, -82.0, 3.0, -33.0, -26.0, -4.0, 37.0, -27.0, 28.0, 92.0, 92.0, 0.0, 5.0, -270.0, 37.0, -1.0, 0.0, -164.0, -156.0, 65.0, 20.0, -278.0, -66.0, -150.0, -82.0, -184.0, -68.0, -2.0, 32.0, -86.0, -219.0, -84.0, 87.0, 54.0, -177.0, 0.0, 20.0, 43.0, 21.0, -108.0, 87.0, 37.0, 13.0, 5.0, -11.0, 0.0, 2.0, 0.0, -132.0, -180.0, -42.0, -4.0, 1.0, -199.0, -152.0, -284.0, -4.0, -54.0, -37.0, 2.0, 0.0, -26.0, -142.0, 33.0, 59.0, 1.0, 109.0, 19.0, -56.0, -136.0, 0.0, 1.0, -270.0, -122.0, 0.0, -35.0, 66.0, -18.0], "policy_predator_policy_reward": [3.0, 0.0, 88.0, 0.0, 165.0, 82.0, 46.0, 13.0, 21.0, 37.0, 17.0, 1.0, 19.0, 26.0, 0.0, 0.0, 0.0, 2.0, 14.0, 16.0, 46.0, 10.0, 4.0, 1.0, 82.0, 0.0, 0.0, 56.0, 13.0, 26.0, 0.0, 0.0, 0.0, 32.0, 0.0, 25.0, 19.0, 119.0, 41.0, 61.0, 0.0, 41.0, 0.0, 13.0, 46.0, 50.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 85.0, 0.0, 64.0, 4.0, 28.0, 0.0, 0.0, 31.0, 1.0, 7.0, 0.0, 20.0, 22.0, 92.0, 0.0, 41.0, 54.0, 0.0, 0.0, 58.0, 4.0, 0.0, 0.0, 65.0, 65.0, 2.0, 116.0, 11.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 85.0, 11.0, 35.0, 20.0, 23.0, 0.0, 0.0, 0.0, 26.0, 0.0, 35.0, 0.0, 0.0, 0.0, 44.0, 56.0, 44.0, 59.0, 43.0, 2.0, 3.0, 21.0, 46.0, 92.0, 121.0, 1.0, 0.0, 65.0, 0.0, 42.0, 34.0, 33.0, 0.0, 27.0, 36.0, 27.0, 14.0, 18.0, 0.0, 20.0, 8.0, 0.0, 0.0, 144.0, 35.0, 0.0, 84.0, 3.0, 0.0, 78.0, 139.0, 0.0, 75.0, 12.0, 0.0, 157.0, 60.0, 0.0, 25.0, 59.0, 42.0, 115.0, 3.0, 16.0, 0.0, 91.0, 13.0, 49.0, 10.0, 61.0, 25.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 61.0, 86.0, 21.0, 2.0, 47.0, 58.0, 156.0, 1.0, 0.0, 33.0, 65.0, 1.0, 13.0, 0.0, 64.0, 54.0, 0.0, 2.0, 0.0, 1.0, 96.0, 0.0, 0.0, 0.0, 80.0, 164.0, 0.0, 31.0, 42.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8910160234910416, "mean_inference_ms": 2.7810699734037057, "mean_action_processing_ms": 0.35659701900269186, "mean_env_wait_ms": 0.3145063066184395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038442611694335938, "StateBufferConnector_ms": 0.003453969955444336, "ViewRequirementAgentConnector_ms": 0.11541581153869629}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -279.0, "episode_return_mean": 10.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.41376737662983, "num_env_steps_trained_throughput_per_sec": 334.41376737662983, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 19126.454, "restore_workers_time_ms": 0.017, "training_step_time_ms": 19126.389, "sample_time_ms": 1870.454, "learn_time_ms": 17234.381, "learn_throughput": 232.094, "synch_weights_time_ms": 18.087}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "e1352_00002", "date": "2024-08-13_19-22-12", "timestamp": 1723591332, "time_this_iter_s": 12.006262063980103, "time_total_s": 1225.6877031326294, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1225.6877031326294, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.14117647058823, "ram_util_percent": 83.52941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4348528181887651, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.2209024966709197, "policy_loss": -0.005560387795909293, "vf_loss": 3.225071039969328, "vf_explained_var": 0.0021709970380894093, "kl": 0.018557897061699424, "entropy": 1.4292072255144674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7512320739488123, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 5.3514478052734695, "policy_loss": -0.004049057898693102, "vf_loss": 5.355484754446322, "vf_explained_var": 0.060680741954732824, "kl": 0.0077674754091009894, "entropy": 1.5090305349814197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -279.0, "episode_reward_mean": 13.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -284.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 164.0}, "policy_reward_mean": {"prey_policy": -22.005, "predator_policy": 28.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.0, 182.0, 0.0, 189.0, 62.0, 12.0, 29.0, 43.0, -32.0, 189.0, 106.0, -65.0, 149.0, 0.0, -88.0, 14.0, -120.0, -44.0, 16.0, 79.0, -16.0, 358.0, 89.0, -3.0, -14.0, 54.0, -21.0, 13.0, 110.0, 96.0, 225.0, -22.0, -145.0, -45.0, 76.0, -146.0, -106.0, -43.0, 43.0, -11.0, -3.0, 33.0, 42.0, 140.0, 100.0, -121.0, 71.0, -77.0, -13.0, -119.0, -129.0, -109.0, -10.0, 30.0, -146.0, 160.0, -86.0, 125.0, -16.0, 149.0, 24.0, -4.0, 2.0, -165.0, -23.0, -93.0, -279.0, -25.0, 31.0, -13.0, 9.0, 62.0, 129.0, -96.0, 1.0, -148.0, -4.0, 91.0, -20.0, 37.0, 123.0, 136.0, 238.0, 3.0, -154.0, 195.0, 134.0, 136.0, -236.0, 6.0, -253.0, -3.0, 53.0, -61.0, 40.0, 0.0, -33.0, 6.0, -106.0, 356.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.0, -73.0, 161.0, 9.0, 0.0, 0.0, 120.0, 69.0, 97.0, -266.0, 2.0, -54.0, -11.0, 8.0, 33.0, 10.0, -2.0, -62.0, 172.0, 10.0, 64.0, 0.0, -184.0, 27.0, 86.0, -32.0, 0.0, 0.0, -82.0, -68.0, 0.0, 14.0, -122.0, -128.0, -232.0, 70.0, -22.0, 27.0, -23.0, 86.0, -32.0, 0.0, 158.0, 200.0, 89.0, 0.0, 6.0, -18.0, -192.0, 82.0, -17.0, 16.0, 0.0, -44.0, 0.0, 13.0, 4.0, 80.0, -14.0, 75.0, 122.0, 103.0, -173.0, 51.0, -134.0, -114.0, -82.0, -8.0, 38.0, 14.0, -127.0, -157.0, 0.0, -228.0, -108.0, 0.0, 10.0, -9.0, 4.0, -82.0, 3.0, -33.0, -26.0, -4.0, 37.0, -27.0, 28.0, 92.0, 92.0, 0.0, 5.0, -270.0, 37.0, -1.0, 0.0, -164.0, -156.0, 65.0, 20.0, -278.0, -66.0, -150.0, -82.0, -184.0, -68.0, -2.0, 32.0, -86.0, -219.0, -84.0, 87.0, 54.0, -177.0, 0.0, 20.0, 43.0, 21.0, -108.0, 87.0, 37.0, 13.0, 5.0, -11.0, 0.0, 2.0, 0.0, -132.0, -180.0, -42.0, -4.0, 1.0, -199.0, -152.0, -284.0, -4.0, -54.0, -37.0, 2.0, 0.0, -26.0, -142.0, 33.0, 59.0, 1.0, 109.0, 19.0, -56.0, -136.0, 0.0, 1.0, -270.0, -122.0, 0.0, -35.0, 66.0, -18.0, -139.0, -38.0, 35.0, -4.0, 109.0, -20.0, 0.0, 136.0, 130.0, 99.0, 0.0, 3.0, -212.0, -108.0, 137.0, 36.0, 23.0, 99.0, 113.0, 0.0, -132.0, -282.0, 0.0, 6.0, -218.0, -226.0, -32.0, 0.0, -59.0, 66.0, -82.0, -128.0, -33.0, 42.0, 0.0, 0.0, -66.0, 0.0, 0.0, 3.0, -47.0, -194.0, 194.0, 152.0], "policy_predator_policy_reward": [46.0, 50.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 146.0, 85.0, 0.0, 64.0, 4.0, 28.0, 0.0, 0.0, 31.0, 1.0, 7.0, 0.0, 20.0, 22.0, 92.0, 0.0, 41.0, 54.0, 0.0, 0.0, 58.0, 4.0, 0.0, 0.0, 65.0, 65.0, 2.0, 116.0, 11.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 8.0, 85.0, 11.0, 35.0, 20.0, 23.0, 0.0, 0.0, 0.0, 26.0, 0.0, 35.0, 0.0, 0.0, 0.0, 44.0, 56.0, 44.0, 59.0, 43.0, 2.0, 3.0, 21.0, 46.0, 92.0, 121.0, 1.0, 0.0, 65.0, 0.0, 42.0, 34.0, 33.0, 0.0, 27.0, 36.0, 27.0, 14.0, 18.0, 0.0, 20.0, 8.0, 0.0, 0.0, 144.0, 35.0, 0.0, 84.0, 3.0, 0.0, 78.0, 139.0, 0.0, 75.0, 12.0, 0.0, 157.0, 60.0, 0.0, 25.0, 59.0, 42.0, 115.0, 3.0, 16.0, 0.0, 91.0, 13.0, 49.0, 10.0, 61.0, 25.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 61.0, 86.0, 21.0, 2.0, 47.0, 58.0, 156.0, 1.0, 0.0, 33.0, 65.0, 1.0, 13.0, 0.0, 64.0, 54.0, 0.0, 2.0, 0.0, 1.0, 96.0, 0.0, 0.0, 0.0, 80.0, 164.0, 0.0, 31.0, 42.0, 1.0, 90.0, 67.0, 0.0, 6.0, 20.0, 14.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 128.0, 38.0, 5.0, 17.0, 10.0, 2.0, 13.0, 10.0, 97.0, 81.0, 0.0, 0.0, 127.0, 64.0, 29.0, 0.0, 2.0, 44.0, 50.0, 99.0, 31.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 3.0, 0.0, 135.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.879641057377127, "mean_inference_ms": 2.742947587319602, "mean_action_processing_ms": 0.3519911422052779, "mean_env_wait_ms": 0.30953654643619805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003847479820251465, "StateBufferConnector_ms": 0.003489255905151367, "ViewRequirementAgentConnector_ms": 0.11307394504547119}, "num_episodes": 22, "episode_return_max": 358.0, "episode_return_min": -279.0, "episode_return_mean": 13.77, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.34339474243217, "num_env_steps_trained_throughput_per_sec": 328.34339474243217, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 13845.726, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13845.661, "sample_time_ms": 1856.185, "learn_time_ms": 11971.668, "learn_throughput": 334.122, "synch_weights_time_ms": 14.797}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "e1352_00002", "date": "2024-08-13_19-22-24", "timestamp": 1723591344, "time_this_iter_s": 12.221426248550415, "time_total_s": 1237.9091293811798, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb7dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1237.9091293811798, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.53529411764706, "ram_util_percent": 83.54117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3599131395439149, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 4.2248519074979916, "policy_loss": 0.00018855480196338796, "vf_loss": 4.224360394982434, "vf_explained_var": -0.0005021426412794325, "kl": 0.004039441701188619, "entropy": 1.418105829897381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9934282097433296, "cur_kl_coeff": 0.0015625, "cur_lr": 0.00010000000000000003, "total_loss": 6.561793158798621, "policy_loss": -0.0022796128625198015, "vf_loss": 6.564065906988881, "vf_explained_var": 0.02911140865119046, "kl": 0.00439281611116359, "entropy": 1.5313299438940784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -279.0, "episode_reward_mean": 5.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -31.27, "predator_policy": 34.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -14.0, 54.0, -21.0, 13.0, 110.0, 96.0, 225.0, -22.0, -145.0, -45.0, 76.0, -146.0, -106.0, -43.0, 43.0, -11.0, -3.0, 33.0, 42.0, 140.0, 100.0, -121.0, 71.0, -77.0, -13.0, -119.0, -129.0, -109.0, -10.0, 30.0, -146.0, 160.0, -86.0, 125.0, -16.0, 149.0, 24.0, -4.0, 2.0, -165.0, -23.0, -93.0, -279.0, -25.0, 31.0, -13.0, 9.0, 62.0, 129.0, -96.0, 1.0, -148.0, -4.0, 91.0, -20.0, 37.0, 123.0, 136.0, 238.0, 3.0, -154.0, 195.0, 134.0, 136.0, -236.0, 6.0, -253.0, -3.0, 53.0, -61.0, 40.0, 0.0, -33.0, 6.0, -106.0, 356.0, 103.0, -65.0, -13.0, -78.0, -19.0, -5.0, -110.0, -130.0, 133.0, 124.0, 6.0, 215.0, 32.0, 166.0, 24.0, 88.0, 51.0, 16.0, -15.0, -15.0, 53.0, -92.0, -55.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, -18.0, -192.0, 82.0, -17.0, 16.0, 0.0, -44.0, 0.0, 13.0, 4.0, 80.0, -14.0, 75.0, 122.0, 103.0, -173.0, 51.0, -134.0, -114.0, -82.0, -8.0, 38.0, 14.0, -127.0, -157.0, 0.0, -228.0, -108.0, 0.0, 10.0, -9.0, 4.0, -82.0, 3.0, -33.0, -26.0, -4.0, 37.0, -27.0, 28.0, 92.0, 92.0, 0.0, 5.0, -270.0, 37.0, -1.0, 0.0, -164.0, -156.0, 65.0, 20.0, -278.0, -66.0, -150.0, -82.0, -184.0, -68.0, -2.0, 32.0, -86.0, -219.0, -84.0, 87.0, 54.0, -177.0, 0.0, 20.0, 43.0, 21.0, -108.0, 87.0, 37.0, 13.0, 5.0, -11.0, 0.0, 2.0, 0.0, -132.0, -180.0, -42.0, -4.0, 1.0, -199.0, -152.0, -284.0, -4.0, -54.0, -37.0, 2.0, 0.0, -26.0, -142.0, 33.0, 59.0, 1.0, 109.0, 19.0, -56.0, -136.0, 0.0, 1.0, -270.0, -122.0, 0.0, -35.0, 66.0, -18.0, -139.0, -38.0, 35.0, -4.0, 109.0, -20.0, 0.0, 136.0, 130.0, 99.0, 0.0, 3.0, -212.0, -108.0, 137.0, 36.0, 23.0, 99.0, 113.0, 0.0, -132.0, -282.0, 0.0, 6.0, -218.0, -226.0, -32.0, 0.0, -59.0, 66.0, -82.0, -128.0, -33.0, 42.0, 0.0, 0.0, -66.0, 0.0, 0.0, 3.0, -47.0, -194.0, 194.0, 152.0, 103.0, 0.0, -2.0, -126.0, -306.0, 83.0, -364.0, 0.0, -69.0, 0.0, -230.0, 95.0, -162.0, -60.0, -296.0, 18.0, 1.0, 89.0, 67.0, 57.0, -139.0, 42.0, 66.0, 144.0, 12.0, -143.0, 96.0, -33.0, -31.0, -77.0, -8.0, 92.0, 49.0, 0.0, 119.0, -206.0, -26.0, -4.0, 85.0, -248.0, 19.0, -15.0, -178.0, -54.0, -80.0, -90.0], "policy_predator_policy_reward": [1.0, 8.0, 85.0, 11.0, 35.0, 20.0, 23.0, 0.0, 0.0, 0.0, 26.0, 0.0, 35.0, 0.0, 0.0, 0.0, 44.0, 56.0, 44.0, 59.0, 43.0, 2.0, 3.0, 21.0, 46.0, 92.0, 121.0, 1.0, 0.0, 65.0, 0.0, 42.0, 34.0, 33.0, 0.0, 27.0, 36.0, 27.0, 14.0, 18.0, 0.0, 20.0, 8.0, 0.0, 0.0, 144.0, 35.0, 0.0, 84.0, 3.0, 0.0, 78.0, 139.0, 0.0, 75.0, 12.0, 0.0, 157.0, 60.0, 0.0, 25.0, 59.0, 42.0, 115.0, 3.0, 16.0, 0.0, 91.0, 13.0, 49.0, 10.0, 61.0, 25.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 61.0, 86.0, 21.0, 2.0, 47.0, 58.0, 156.0, 1.0, 0.0, 33.0, 65.0, 1.0, 13.0, 0.0, 64.0, 54.0, 0.0, 2.0, 0.0, 1.0, 96.0, 0.0, 0.0, 0.0, 80.0, 164.0, 0.0, 31.0, 42.0, 1.0, 90.0, 67.0, 0.0, 6.0, 20.0, 14.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 128.0, 38.0, 5.0, 17.0, 10.0, 2.0, 13.0, 10.0, 97.0, 81.0, 0.0, 0.0, 127.0, 64.0, 29.0, 0.0, 2.0, 44.0, 50.0, 99.0, 31.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 3.0, 0.0, 135.0, 0.0, 10.0, 0.0, 0.0, 0.0, 63.0, 92.0, 118.0, 182.0, 104.0, 47.0, 3.0, 123.0, 7.0, 112.0, 0.0, 148.0, 0.0, 0.0, 43.0, 0.0, 0.0, 103.0, 0.0, 4.0, 1.0, 64.0, 99.0, 45.0, 58.0, 27.0, 105.0, 0.0, 4.0, 0.0, 2.0, 103.0, 0.0, 15.0, 0.0, 148.0, 0.0, 8.0, 41.0, 84.0, 56.0, 115.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8669108388807927, "mean_inference_ms": 2.7110266584098577, "mean_action_processing_ms": 0.34725993487523377, "mean_env_wait_ms": 0.30632204909622035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426479339599609, "StateBufferConnector_ms": 0.0038896799087524414, "ViewRequirementAgentConnector_ms": 0.1231762170791626}, "num_episodes": 23, "episode_return_max": 356.0, "episode_return_min": -279.0, "episode_return_mean": 5.92, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.0239139932574, "num_env_steps_trained_throughput_per_sec": 321.0239139932574, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 13889.388, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13889.324, "sample_time_ms": 1813.322, "learn_time_ms": 12057.751, "learn_throughput": 331.737, "synch_weights_time_ms": 15.003}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "e1352_00002", "date": "2024-08-13_19-22-36", "timestamp": 1723591356, "time_this_iter_s": 12.501116037368774, "time_total_s": 1250.4102454185486, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1250.4102454185486, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 68.03888888888889, "ram_util_percent": 83.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3374468571905579, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 0.00010000000000000003, "total_loss": 2.3103109281529823, "policy_loss": -0.000954967212774569, "vf_loss": 2.3108653418601506, "vf_explained_var": 0.0010739338145684943, "kl": 0.010681335636252965, "entropy": 1.397495925048041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.09963201740116, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 5.596625474899534, "policy_loss": -0.002776607216912366, "vf_loss": 5.599397224093241, "vf_explained_var": 0.07260350342150088, "kl": 0.006214388116501575, "entropy": 1.5157999791796246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -279.0, "episode_reward_mean": 11.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -27.25, "predator_policy": 33.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.0, 42.0, 140.0, 100.0, -121.0, 71.0, -77.0, -13.0, -119.0, -129.0, -109.0, -10.0, 30.0, -146.0, 160.0, -86.0, 125.0, -16.0, 149.0, 24.0, -4.0, 2.0, -165.0, -23.0, -93.0, -279.0, -25.0, 31.0, -13.0, 9.0, 62.0, 129.0, -96.0, 1.0, -148.0, -4.0, 91.0, -20.0, 37.0, 123.0, 136.0, 238.0, 3.0, -154.0, 195.0, 134.0, 136.0, -236.0, 6.0, -253.0, -3.0, 53.0, -61.0, 40.0, 0.0, -33.0, 6.0, -106.0, 356.0, 103.0, -65.0, -13.0, -78.0, -19.0, -5.0, -110.0, -130.0, 133.0, 124.0, 6.0, 215.0, 32.0, 166.0, 24.0, 88.0, 51.0, 16.0, -15.0, -15.0, 53.0, -92.0, -55.0, 6.0, -5.0, 83.0, -2.0, -23.0, 120.0, -25.0, 151.0, 0.0, 37.0, -48.0, 83.0, -150.0, 213.0, -173.0, 151.0, 105.0, 124.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.0, -4.0, 37.0, -27.0, 28.0, 92.0, 92.0, 0.0, 5.0, -270.0, 37.0, -1.0, 0.0, -164.0, -156.0, 65.0, 20.0, -278.0, -66.0, -150.0, -82.0, -184.0, -68.0, -2.0, 32.0, -86.0, -219.0, -84.0, 87.0, 54.0, -177.0, 0.0, 20.0, 43.0, 21.0, -108.0, 87.0, 37.0, 13.0, 5.0, -11.0, 0.0, 2.0, 0.0, -132.0, -180.0, -42.0, -4.0, 1.0, -199.0, -152.0, -284.0, -4.0, -54.0, -37.0, 2.0, 0.0, -26.0, -142.0, 33.0, 59.0, 1.0, 109.0, 19.0, -56.0, -136.0, 0.0, 1.0, -270.0, -122.0, 0.0, -35.0, 66.0, -18.0, -139.0, -38.0, 35.0, -4.0, 109.0, -20.0, 0.0, 136.0, 130.0, 99.0, 0.0, 3.0, -212.0, -108.0, 137.0, 36.0, 23.0, 99.0, 113.0, 0.0, -132.0, -282.0, 0.0, 6.0, -218.0, -226.0, -32.0, 0.0, -59.0, 66.0, -82.0, -128.0, -33.0, 42.0, 0.0, 0.0, -66.0, 0.0, 0.0, 3.0, -47.0, -194.0, 194.0, 152.0, 103.0, 0.0, -2.0, -126.0, -306.0, 83.0, -364.0, 0.0, -69.0, 0.0, -230.0, 95.0, -162.0, -60.0, -296.0, 18.0, 1.0, 89.0, 67.0, 57.0, -139.0, 42.0, 66.0, 144.0, 12.0, -143.0, 96.0, -33.0, -31.0, -77.0, -8.0, 92.0, 49.0, 0.0, 119.0, -206.0, -26.0, -4.0, 85.0, -248.0, 19.0, -15.0, -178.0, -54.0, -80.0, -90.0, -65.0, 0.0, 11.0, -46.0, 78.0, 5.0, -101.0, -15.0, 5.0, -56.0, 153.0, -73.0, -54.0, 0.0, 83.0, 56.0, 0.0, 0.0, -6.0, 40.0, -174.0, 0.0, 86.0, -6.0, -184.0, -69.0, 104.0, 103.0, -128.0, -192.0, 95.0, 29.0, -46.0, 128.0, 62.0, 62.0], "policy_predator_policy_reward": [36.0, 27.0, 14.0, 18.0, 0.0, 20.0, 8.0, 0.0, 0.0, 144.0, 35.0, 0.0, 84.0, 3.0, 0.0, 78.0, 139.0, 0.0, 75.0, 12.0, 0.0, 157.0, 60.0, 0.0, 25.0, 59.0, 42.0, 115.0, 3.0, 16.0, 0.0, 91.0, 13.0, 49.0, 10.0, 61.0, 25.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 61.0, 86.0, 21.0, 2.0, 47.0, 58.0, 156.0, 1.0, 0.0, 33.0, 65.0, 1.0, 13.0, 0.0, 64.0, 54.0, 0.0, 2.0, 0.0, 1.0, 96.0, 0.0, 0.0, 0.0, 80.0, 164.0, 0.0, 31.0, 42.0, 1.0, 90.0, 67.0, 0.0, 6.0, 20.0, 14.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 128.0, 38.0, 5.0, 17.0, 10.0, 2.0, 13.0, 10.0, 97.0, 81.0, 0.0, 0.0, 127.0, 64.0, 29.0, 0.0, 2.0, 44.0, 50.0, 99.0, 31.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 3.0, 0.0, 135.0, 0.0, 10.0, 0.0, 0.0, 0.0, 63.0, 92.0, 118.0, 182.0, 104.0, 47.0, 3.0, 123.0, 7.0, 112.0, 0.0, 148.0, 0.0, 0.0, 43.0, 0.0, 0.0, 103.0, 0.0, 4.0, 1.0, 64.0, 99.0, 45.0, 58.0, 27.0, 105.0, 0.0, 4.0, 0.0, 2.0, 103.0, 0.0, 15.0, 0.0, 148.0, 0.0, 8.0, 41.0, 84.0, 56.0, 115.0, 0.0, 40.0, 31.0, 25.0, 5.0, 0.0, 0.0, 78.0, 36.0, 0.0, 28.0, 17.0, 23.0, 1.0, 28.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 72.0, 54.0, 0.0, 3.0, 103.0, 0.0, 6.0, 0.0, 48.0, 99.0, 1.0, 26.0, 23.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8599828624641924, "mean_inference_ms": 2.6909599750392186, "mean_action_processing_ms": 0.3445997204004256, "mean_env_wait_ms": 0.30396636749092365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005029559135437012, "StateBufferConnector_ms": 0.003995180130004883, "ViewRequirementAgentConnector_ms": 0.13422036170959473}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": -279.0, "episode_return_mean": 11.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.2001769654429, "num_env_steps_trained_throughput_per_sec": 341.2001769654429, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 13896.601, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13896.542, "sample_time_ms": 1720.145, "learn_time_ms": 12154.189, "learn_throughput": 329.105, "synch_weights_time_ms": 18.919}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "e1352_00002", "date": "2024-08-13_19-22-48", "timestamp": 1723591368, "time_this_iter_s": 11.791565895080566, "time_total_s": 1262.2018113136292, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d203a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1262.2018113136292, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 56.27647058823529, "ram_util_percent": 83.42941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47825696688717007, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 0.00010000000000000003, "total_loss": 2.8032408985511337, "policy_loss": -0.011628486772890759, "vf_loss": 2.8139128142563754, "vf_explained_var": 0.012887749438563353, "kl": 0.02550859921122138, "entropy": 1.389057132491359, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.911280597363988, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 5.762307909304503, "policy_loss": -0.0013711279322191205, "vf_loss": 5.763672484039629, "vf_explained_var": 0.06877125826462235, "kl": 0.008413644155066772, "entropy": 1.5039092416485782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -279.0, "episode_reward_mean": 19.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -20.805, "predator_policy": 30.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.0, 24.0, -4.0, 2.0, -165.0, -23.0, -93.0, -279.0, -25.0, 31.0, -13.0, 9.0, 62.0, 129.0, -96.0, 1.0, -148.0, -4.0, 91.0, -20.0, 37.0, 123.0, 136.0, 238.0, 3.0, -154.0, 195.0, 134.0, 136.0, -236.0, 6.0, -253.0, -3.0, 53.0, -61.0, 40.0, 0.0, -33.0, 6.0, -106.0, 356.0, 103.0, -65.0, -13.0, -78.0, -19.0, -5.0, -110.0, -130.0, 133.0, 124.0, 6.0, 215.0, 32.0, 166.0, 24.0, 88.0, 51.0, 16.0, -15.0, -15.0, 53.0, -92.0, -55.0, 6.0, -5.0, 83.0, -2.0, -23.0, 120.0, -25.0, 151.0, 0.0, 37.0, -48.0, 83.0, -150.0, 213.0, -173.0, 151.0, 105.0, 124.0, 145.0, 160.0, -34.0, -156.0, 5.0, -5.0, 138.0, 94.0, -73.0, 19.0, -12.0, 8.0, 78.0, 71.0, -54.0, 32.0, 59.0, 155.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [87.0, 37.0, 13.0, 5.0, -11.0, 0.0, 2.0, 0.0, -132.0, -180.0, -42.0, -4.0, 1.0, -199.0, -152.0, -284.0, -4.0, -54.0, -37.0, 2.0, 0.0, -26.0, -142.0, 33.0, 59.0, 1.0, 109.0, 19.0, -56.0, -136.0, 0.0, 1.0, -270.0, -122.0, 0.0, -35.0, 66.0, -18.0, -139.0, -38.0, 35.0, -4.0, 109.0, -20.0, 0.0, 136.0, 130.0, 99.0, 0.0, 3.0, -212.0, -108.0, 137.0, 36.0, 23.0, 99.0, 113.0, 0.0, -132.0, -282.0, 0.0, 6.0, -218.0, -226.0, -32.0, 0.0, -59.0, 66.0, -82.0, -128.0, -33.0, 42.0, 0.0, 0.0, -66.0, 0.0, 0.0, 3.0, -47.0, -194.0, 194.0, 152.0, 103.0, 0.0, -2.0, -126.0, -306.0, 83.0, -364.0, 0.0, -69.0, 0.0, -230.0, 95.0, -162.0, -60.0, -296.0, 18.0, 1.0, 89.0, 67.0, 57.0, -139.0, 42.0, 66.0, 144.0, 12.0, -143.0, 96.0, -33.0, -31.0, -77.0, -8.0, 92.0, 49.0, 0.0, 119.0, -206.0, -26.0, -4.0, 85.0, -248.0, 19.0, -15.0, -178.0, -54.0, -80.0, -90.0, -65.0, 0.0, 11.0, -46.0, 78.0, 5.0, -101.0, -15.0, 5.0, -56.0, 153.0, -73.0, -54.0, 0.0, 83.0, 56.0, 0.0, 0.0, -6.0, 40.0, -174.0, 0.0, 86.0, -6.0, -184.0, -69.0, 104.0, 103.0, -128.0, -192.0, 95.0, 29.0, -46.0, 128.0, 62.0, 62.0, 145.0, 0.0, 110.0, 50.0, -68.0, 0.0, -84.0, -148.0, -107.0, 42.0, -122.0, 56.0, 173.0, -76.0, -48.0, 56.0, -48.0, -160.0, -42.0, 0.0, 0.0, -41.0, -34.0, 0.0, 0.0, 78.0, 57.0, -14.0, 0.0, -117.0, 6.0, 0.0, 29.0, -42.0, 101.0, 18.0], "policy_predator_policy_reward": [25.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 0.0, 61.0, 86.0, 21.0, 2.0, 47.0, 58.0, 156.0, 1.0, 0.0, 33.0, 65.0, 1.0, 13.0, 0.0, 64.0, 54.0, 0.0, 2.0, 0.0, 1.0, 96.0, 0.0, 0.0, 0.0, 80.0, 164.0, 0.0, 31.0, 42.0, 1.0, 90.0, 67.0, 0.0, 6.0, 20.0, 14.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 128.0, 38.0, 5.0, 17.0, 10.0, 2.0, 13.0, 10.0, 97.0, 81.0, 0.0, 0.0, 127.0, 64.0, 29.0, 0.0, 2.0, 44.0, 50.0, 99.0, 31.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 3.0, 0.0, 135.0, 0.0, 10.0, 0.0, 0.0, 0.0, 63.0, 92.0, 118.0, 182.0, 104.0, 47.0, 3.0, 123.0, 7.0, 112.0, 0.0, 148.0, 0.0, 0.0, 43.0, 0.0, 0.0, 103.0, 0.0, 4.0, 1.0, 64.0, 99.0, 45.0, 58.0, 27.0, 105.0, 0.0, 4.0, 0.0, 2.0, 103.0, 0.0, 15.0, 0.0, 148.0, 0.0, 8.0, 41.0, 84.0, 56.0, 115.0, 0.0, 40.0, 31.0, 25.0, 5.0, 0.0, 0.0, 78.0, 36.0, 0.0, 28.0, 17.0, 23.0, 1.0, 28.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 72.0, 54.0, 0.0, 3.0, 103.0, 0.0, 6.0, 0.0, 48.0, 99.0, 1.0, 26.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 0.0, 76.0, 56.0, 14.0, 0.0, 61.0, 12.0, 29.0, 15.0, 71.0, 20.0, 115.0, 61.0, 0.0, 5.0, 24.0, 5.0, 37.0, 0.0, 0.0, 13.0, 15.0, 0.0, 63.0, 20.0, 6.0, 21.0, 51.0, 22.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8544890575521628, "mean_inference_ms": 2.6747318978875745, "mean_action_processing_ms": 0.34222405097107367, "mean_env_wait_ms": 0.3020648805474794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049591064453125, "StateBufferConnector_ms": 0.0038979053497314453, "ViewRequirementAgentConnector_ms": 0.15523362159729004}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": -279.0, "episode_return_mean": 19.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.49200814330203, "num_env_steps_trained_throughput_per_sec": 242.49200814330203, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 14425.139, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14425.067, "sample_time_ms": 1734.791, "learn_time_ms": 12665.599, "learn_throughput": 315.816, "synch_weights_time_ms": 21.057}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "e1352_00002", "date": "2024-08-13_19-23-05", "timestamp": 1723591385, "time_this_iter_s": 16.6107919216156, "time_total_s": 1278.8126032352448, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cdc820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1278.8126032352448, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 74.14347826086956, "ram_util_percent": 83.93478260869566}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8654899823090071, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 3.6099732082356852, "policy_loss": -0.0008915235384530018, "vf_loss": 3.610060550422265, "vf_explained_var": 0.011500141765705492, "kl": 0.014296537595266771, "entropy": 1.3681998620588314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.557380778630259, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 5.86762818810801, "policy_loss": -6.602088324528523e-05, "vf_loss": 5.867688092731294, "vf_explained_var": 0.02893569343304508, "kl": 0.007828111759781846, "entropy": 1.4731809998315477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -253.0, "episode_reward_mean": 31.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -13.725, "predator_policy": 29.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.0, -20.0, 37.0, 123.0, 136.0, 238.0, 3.0, -154.0, 195.0, 134.0, 136.0, -236.0, 6.0, -253.0, -3.0, 53.0, -61.0, 40.0, 0.0, -33.0, 6.0, -106.0, 356.0, 103.0, -65.0, -13.0, -78.0, -19.0, -5.0, -110.0, -130.0, 133.0, 124.0, 6.0, 215.0, 32.0, 166.0, 24.0, 88.0, 51.0, 16.0, -15.0, -15.0, 53.0, -92.0, -55.0, 6.0, -5.0, 83.0, -2.0, -23.0, 120.0, -25.0, 151.0, 0.0, 37.0, -48.0, 83.0, -150.0, 213.0, -173.0, 151.0, 105.0, 124.0, 145.0, 160.0, -34.0, -156.0, 5.0, -5.0, 138.0, 94.0, -73.0, 19.0, -12.0, 8.0, 78.0, 71.0, -54.0, 32.0, 59.0, 155.0, 32.0, 41.0, 105.0, -42.0, -17.0, 7.0, -15.0, -14.0, 242.0, -40.0, 112.0, 9.0, 83.0, 20.0, -4.0, 163.0, 101.0, -31.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [66.0, -18.0, -139.0, -38.0, 35.0, -4.0, 109.0, -20.0, 0.0, 136.0, 130.0, 99.0, 0.0, 3.0, -212.0, -108.0, 137.0, 36.0, 23.0, 99.0, 113.0, 0.0, -132.0, -282.0, 0.0, 6.0, -218.0, -226.0, -32.0, 0.0, -59.0, 66.0, -82.0, -128.0, -33.0, 42.0, 0.0, 0.0, -66.0, 0.0, 0.0, 3.0, -47.0, -194.0, 194.0, 152.0, 103.0, 0.0, -2.0, -126.0, -306.0, 83.0, -364.0, 0.0, -69.0, 0.0, -230.0, 95.0, -162.0, -60.0, -296.0, 18.0, 1.0, 89.0, 67.0, 57.0, -139.0, 42.0, 66.0, 144.0, 12.0, -143.0, 96.0, -33.0, -31.0, -77.0, -8.0, 92.0, 49.0, 0.0, 119.0, -206.0, -26.0, -4.0, 85.0, -248.0, 19.0, -15.0, -178.0, -54.0, -80.0, -90.0, -65.0, 0.0, 11.0, -46.0, 78.0, 5.0, -101.0, -15.0, 5.0, -56.0, 153.0, -73.0, -54.0, 0.0, 83.0, 56.0, 0.0, 0.0, -6.0, 40.0, -174.0, 0.0, 86.0, -6.0, -184.0, -69.0, 104.0, 103.0, -128.0, -192.0, 95.0, 29.0, -46.0, 128.0, 62.0, 62.0, 145.0, 0.0, 110.0, 50.0, -68.0, 0.0, -84.0, -148.0, -107.0, 42.0, -122.0, 56.0, 173.0, -76.0, -48.0, 56.0, -48.0, -160.0, -42.0, 0.0, 0.0, -41.0, -34.0, 0.0, 0.0, 78.0, 57.0, -14.0, 0.0, -117.0, 6.0, 0.0, 29.0, -42.0, 101.0, 18.0, 3.0, -8.0, 2.0, -9.0, 23.0, 77.0, -72.0, -108.0, -50.0, 0.0, 2.0, -3.0, -130.0, 43.0, -3.0, -46.0, 98.0, 139.0, -134.0, -17.0, 69.0, 14.0, -27.0, 11.0, 5.0, 36.0, -54.0, 33.0, -14.0, -41.0, 118.0, 45.0, 115.0, -120.0, 0.0, -98.0], "policy_predator_policy_reward": [42.0, 1.0, 90.0, 67.0, 0.0, 6.0, 20.0, 14.0, 0.0, 0.0, 2.0, 7.0, 0.0, 0.0, 128.0, 38.0, 5.0, 17.0, 10.0, 2.0, 13.0, 10.0, 97.0, 81.0, 0.0, 0.0, 127.0, 64.0, 29.0, 0.0, 2.0, 44.0, 50.0, 99.0, 31.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 3.0, 0.0, 135.0, 0.0, 10.0, 0.0, 0.0, 0.0, 63.0, 92.0, 118.0, 182.0, 104.0, 47.0, 3.0, 123.0, 7.0, 112.0, 0.0, 148.0, 0.0, 0.0, 43.0, 0.0, 0.0, 103.0, 0.0, 4.0, 1.0, 64.0, 99.0, 45.0, 58.0, 27.0, 105.0, 0.0, 4.0, 0.0, 2.0, 103.0, 0.0, 15.0, 0.0, 148.0, 0.0, 8.0, 41.0, 84.0, 56.0, 115.0, 0.0, 40.0, 31.0, 25.0, 5.0, 0.0, 0.0, 78.0, 36.0, 0.0, 28.0, 17.0, 23.0, 1.0, 28.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 72.0, 54.0, 0.0, 3.0, 103.0, 0.0, 6.0, 0.0, 48.0, 99.0, 1.0, 26.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 0.0, 76.0, 56.0, 14.0, 0.0, 61.0, 12.0, 29.0, 15.0, 71.0, 20.0, 115.0, 61.0, 0.0, 5.0, 24.0, 5.0, 37.0, 0.0, 0.0, 13.0, 15.0, 0.0, 63.0, 20.0, 6.0, 21.0, 51.0, 22.0, 14.0, 37.0, 0.0, 0.0, 48.0, 1.0, 4.0, 81.0, 57.0, 6.0, 27.0, 0.0, 8.0, 70.0, 2.0, 5.0, 30.0, 4.0, 1.0, 97.0, 14.0, 0.0, 29.0, 0.0, 25.0, 0.0, 42.0, 5.0, 36.0, 3.0, 48.0, 0.0, 0.0, 30.0, 76.0, 49.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8614345400783101, "mean_inference_ms": 2.702995253367269, "mean_action_processing_ms": 0.3458583907850926, "mean_env_wait_ms": 0.3060307575649186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005119919776916504, "StateBufferConnector_ms": 0.004055023193359375, "ViewRequirementAgentConnector_ms": 0.1706838607788086}, "num_episodes": 18, "episode_return_max": 356.0, "episode_return_min": -253.0, "episode_return_mean": 31.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.46099275853692, "num_env_steps_trained_throughput_per_sec": 234.46099275853692, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 12980.854, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12980.776, "sample_time_ms": 2142.751, "learn_time_ms": 10813.075, "learn_throughput": 369.923, "synch_weights_time_ms": 21.017}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "e1352_00002", "date": "2024-08-13_19-23-22", "timestamp": 1723591402, "time_this_iter_s": 17.1282901763916, "time_total_s": 1295.9408934116364, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d20e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1295.9408934116364, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 77.64166666666667, "ram_util_percent": 83.89583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9612324330305296, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 4.801230058972798, "policy_loss": -0.0043019916241367655, "vf_loss": 4.80459555557796, "vf_explained_var": 0.018300283018243376, "kl": 0.016648779383183984, "entropy": 1.317153117644093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.289176855413687, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 7.103210375296376, "policy_loss": -0.0010889108441819353, "vf_loss": 7.10429091226487, "vf_explained_var": 0.02003337617904421, "kl": 0.01073400057818093, "entropy": 1.4125236337147062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 312.0, "episode_reward_min": -173.0, "episode_reward_mean": 36.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -296.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 173.0, "predator_policy": 152.0}, "policy_reward_mean": {"prey_policy": -12.615, "predator_policy": 30.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, -5.0, -110.0, -130.0, 133.0, 124.0, 6.0, 215.0, 32.0, 166.0, 24.0, 88.0, 51.0, 16.0, -15.0, -15.0, 53.0, -92.0, -55.0, 6.0, -5.0, 83.0, -2.0, -23.0, 120.0, -25.0, 151.0, 0.0, 37.0, -48.0, 83.0, -150.0, 213.0, -173.0, 151.0, 105.0, 124.0, 145.0, 160.0, -34.0, -156.0, 5.0, -5.0, 138.0, 94.0, -73.0, 19.0, -12.0, 8.0, 78.0, 71.0, -54.0, 32.0, 59.0, 155.0, 32.0, 41.0, 105.0, -42.0, -17.0, 7.0, -15.0, -14.0, 242.0, -40.0, 112.0, 9.0, 83.0, 20.0, -4.0, 163.0, 101.0, -31.0, 129.0, 42.0, 111.0, -22.0, 23.0, 0.0, 61.0, 31.0, 68.0, -1.0, -115.0, 186.0, -95.0, 3.0, 99.0, -22.0, 44.0, 312.0, -56.0, 55.0, -24.0, 137.0, 91.0, 33.0, 65.0, 147.0, -134.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-69.0, 0.0, -230.0, 95.0, -162.0, -60.0, -296.0, 18.0, 1.0, 89.0, 67.0, 57.0, -139.0, 42.0, 66.0, 144.0, 12.0, -143.0, 96.0, -33.0, -31.0, -77.0, -8.0, 92.0, 49.0, 0.0, 119.0, -206.0, -26.0, -4.0, 85.0, -248.0, 19.0, -15.0, -178.0, -54.0, -80.0, -90.0, -65.0, 0.0, 11.0, -46.0, 78.0, 5.0, -101.0, -15.0, 5.0, -56.0, 153.0, -73.0, -54.0, 0.0, 83.0, 56.0, 0.0, 0.0, -6.0, 40.0, -174.0, 0.0, 86.0, -6.0, -184.0, -69.0, 104.0, 103.0, -128.0, -192.0, 95.0, 29.0, -46.0, 128.0, 62.0, 62.0, 145.0, 0.0, 110.0, 50.0, -68.0, 0.0, -84.0, -148.0, -107.0, 42.0, -122.0, 56.0, 173.0, -76.0, -48.0, 56.0, -48.0, -160.0, -42.0, 0.0, 0.0, -41.0, -34.0, 0.0, 0.0, 78.0, 57.0, -14.0, 0.0, -117.0, 6.0, 0.0, 29.0, -42.0, 101.0, 18.0, 3.0, -8.0, 2.0, -9.0, 23.0, 77.0, -72.0, -108.0, -50.0, 0.0, 2.0, -3.0, -130.0, 43.0, -3.0, -46.0, 98.0, 139.0, -134.0, -17.0, 69.0, 14.0, -27.0, 11.0, 5.0, 36.0, -54.0, 33.0, -14.0, -41.0, 118.0, 45.0, 115.0, -120.0, 0.0, -98.0, 27.0, 41.0, 94.0, -136.0, 0.0, 73.0, -54.0, -56.0, -33.0, -16.0, -1.0, 0.0, 79.0, -129.0, -27.0, -21.0, 51.0, -52.0, 9.0, -72.0, -271.0, -62.0, 153.0, -14.0, -275.0, 0.0, 0.0, 3.0, 0.0, 53.0, -15.0, -101.0, 48.0, -98.0, 138.0, 143.0, -111.0, -68.0, 1.0, 14.0, 76.0, -272.0, 9.0, 110.0, 101.0, -75.0, -91.0, 25.0, 28.0, -14.0, -36.0, 96.0, -77.0, -174.0], "policy_predator_policy_reward": [47.0, 3.0, 123.0, 7.0, 112.0, 0.0, 148.0, 0.0, 0.0, 43.0, 0.0, 0.0, 103.0, 0.0, 4.0, 1.0, 64.0, 99.0, 45.0, 58.0, 27.0, 105.0, 0.0, 4.0, 0.0, 2.0, 103.0, 0.0, 15.0, 0.0, 148.0, 0.0, 8.0, 41.0, 84.0, 56.0, 115.0, 0.0, 40.0, 31.0, 25.0, 5.0, 0.0, 0.0, 78.0, 36.0, 0.0, 28.0, 17.0, 23.0, 1.0, 28.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 72.0, 54.0, 0.0, 3.0, 103.0, 0.0, 6.0, 0.0, 48.0, 99.0, 1.0, 26.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 0.0, 76.0, 56.0, 14.0, 0.0, 61.0, 12.0, 29.0, 15.0, 71.0, 20.0, 115.0, 61.0, 0.0, 5.0, 24.0, 5.0, 37.0, 0.0, 0.0, 13.0, 15.0, 0.0, 63.0, 20.0, 6.0, 21.0, 51.0, 22.0, 14.0, 37.0, 0.0, 0.0, 48.0, 1.0, 4.0, 81.0, 57.0, 6.0, 27.0, 0.0, 8.0, 70.0, 2.0, 5.0, 30.0, 4.0, 1.0, 97.0, 14.0, 0.0, 29.0, 0.0, 25.0, 0.0, 42.0, 5.0, 36.0, 3.0, 48.0, 0.0, 0.0, 30.0, 76.0, 49.0, 18.0, 31.0, 30.0, 84.0, 0.0, 0.0, 38.0, 52.0, 36.0, 39.0, 33.0, 1.0, 0.0, 111.0, 0.0, 66.0, 13.0, 67.0, 2.0, 46.0, 16.0, 152.0, 66.0, 16.0, 31.0, 71.0, 109.0, 0.0, 0.0, 8.0, 38.0, 94.0, 0.0, 94.0, 0.0, 14.0, 17.0, 39.0, 84.0, 6.0, 34.0, 136.0, 36.0, 18.0, 0.0, 1.0, 64.0, 99.0, 0.0, 23.0, 28.0, 16.0, 71.0, 0.0, 117.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733054836223377, "mean_inference_ms": 2.7563758703235193, "mean_action_processing_ms": 0.35183970005710136, "mean_env_wait_ms": 0.3131462248283313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00784146785736084, "StateBufferConnector_ms": 0.004193663597106934, "ViewRequirementAgentConnector_ms": 0.18847060203552246}, "num_episodes": 27, "episode_return_max": 312.0, "episode_return_min": -173.0, "episode_return_mean": 36.64, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.61042544056755, "num_env_steps_trained_throughput_per_sec": 314.61042544056755, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 13052.822, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13052.744, "sample_time_ms": 2122.23, "learn_time_ms": 10905.403, "learn_throughput": 366.791, "synch_weights_time_ms": 21.12}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "e1352_00002", "date": "2024-08-13_19-23-35", "timestamp": 1723591415, "time_this_iter_s": 12.777400970458984, "time_total_s": 1308.7182943820953, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1308.7182943820953, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 65.79444444444444, "ram_util_percent": 83.72777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8150469685751925, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 3.5206489786269173, "policy_loss": -0.006097838400848328, "vf_loss": 3.525475469594279, "vf_explained_var": 0.025863829460093583, "kl": 0.02260168734270099, "entropy": 1.3549330163885045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.116225571346977, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 6.126972284014263, "policy_loss": -0.0028814076356067464, "vf_loss": 6.129844811101439, "vf_explained_var": 0.03266096950838805, "kl": 0.011358478014743573, "entropy": 1.3971663785359216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 312.0, "episode_reward_min": -173.0, "episode_reward_mean": 43.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -275.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 173.0, "predator_policy": 152.0}, "policy_reward_mean": {"prey_policy": -7.29, "predator_policy": 28.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.0, 6.0, -5.0, 83.0, -2.0, -23.0, 120.0, -25.0, 151.0, 0.0, 37.0, -48.0, 83.0, -150.0, 213.0, -173.0, 151.0, 105.0, 124.0, 145.0, 160.0, -34.0, -156.0, 5.0, -5.0, 138.0, 94.0, -73.0, 19.0, -12.0, 8.0, 78.0, 71.0, -54.0, 32.0, 59.0, 155.0, 32.0, 41.0, 105.0, -42.0, -17.0, 7.0, -15.0, -14.0, 242.0, -40.0, 112.0, 9.0, 83.0, 20.0, -4.0, 163.0, 101.0, -31.0, 129.0, 42.0, 111.0, -22.0, 23.0, 0.0, 61.0, 31.0, 68.0, -1.0, -115.0, 186.0, -95.0, 3.0, 99.0, -22.0, 44.0, 312.0, -56.0, 55.0, -24.0, 137.0, 91.0, 33.0, 65.0, 147.0, -134.0, -54.0, -3.0, 109.0, 210.0, 56.0, 97.0, 96.0, 244.0, 114.0, -16.0, 65.0, 26.0, 130.0, 86.0, -96.0, 154.0, -52.0, 24.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-80.0, -90.0, -65.0, 0.0, 11.0, -46.0, 78.0, 5.0, -101.0, -15.0, 5.0, -56.0, 153.0, -73.0, -54.0, 0.0, 83.0, 56.0, 0.0, 0.0, -6.0, 40.0, -174.0, 0.0, 86.0, -6.0, -184.0, -69.0, 104.0, 103.0, -128.0, -192.0, 95.0, 29.0, -46.0, 128.0, 62.0, 62.0, 145.0, 0.0, 110.0, 50.0, -68.0, 0.0, -84.0, -148.0, -107.0, 42.0, -122.0, 56.0, 173.0, -76.0, -48.0, 56.0, -48.0, -160.0, -42.0, 0.0, 0.0, -41.0, -34.0, 0.0, 0.0, 78.0, 57.0, -14.0, 0.0, -117.0, 6.0, 0.0, 29.0, -42.0, 101.0, 18.0, 3.0, -8.0, 2.0, -9.0, 23.0, 77.0, -72.0, -108.0, -50.0, 0.0, 2.0, -3.0, -130.0, 43.0, -3.0, -46.0, 98.0, 139.0, -134.0, -17.0, 69.0, 14.0, -27.0, 11.0, 5.0, 36.0, -54.0, 33.0, -14.0, -41.0, 118.0, 45.0, 115.0, -120.0, 0.0, -98.0, 27.0, 41.0, 94.0, -136.0, 0.0, 73.0, -54.0, -56.0, -33.0, -16.0, -1.0, 0.0, 79.0, -129.0, -27.0, -21.0, 51.0, -52.0, 9.0, -72.0, -271.0, -62.0, 153.0, -14.0, -275.0, 0.0, 0.0, 3.0, 0.0, 53.0, -15.0, -101.0, 48.0, -98.0, 138.0, 143.0, -111.0, -68.0, 1.0, 14.0, 76.0, -272.0, 9.0, 110.0, 101.0, -75.0, -91.0, 25.0, 28.0, -14.0, -36.0, 96.0, -77.0, -174.0, 8.0, -200.0, 56.0, -226.0, 0.0, 109.0, 171.0, 4.0, -4.0, -70.0, -38.0, 91.0, 166.0, -181.0, 128.0, 92.0, 95.0, 0.0, 0.0, -67.0, -24.0, 42.0, -4.0, 0.0, -7.0, 70.0, 65.0, 21.0, -58.0, -140.0, 134.0, 12.0, 0.0, -132.0, 24.0, 0.0], "policy_predator_policy_reward": [115.0, 0.0, 40.0, 31.0, 25.0, 5.0, 0.0, 0.0, 78.0, 36.0, 0.0, 28.0, 17.0, 23.0, 1.0, 28.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 72.0, 54.0, 0.0, 3.0, 103.0, 0.0, 6.0, 0.0, 48.0, 99.0, 1.0, 26.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 0.0, 76.0, 56.0, 14.0, 0.0, 61.0, 12.0, 29.0, 15.0, 71.0, 20.0, 115.0, 61.0, 0.0, 5.0, 24.0, 5.0, 37.0, 0.0, 0.0, 13.0, 15.0, 0.0, 63.0, 20.0, 6.0, 21.0, 51.0, 22.0, 14.0, 37.0, 0.0, 0.0, 48.0, 1.0, 4.0, 81.0, 57.0, 6.0, 27.0, 0.0, 8.0, 70.0, 2.0, 5.0, 30.0, 4.0, 1.0, 97.0, 14.0, 0.0, 29.0, 0.0, 25.0, 0.0, 42.0, 5.0, 36.0, 3.0, 48.0, 0.0, 0.0, 30.0, 76.0, 49.0, 18.0, 31.0, 30.0, 84.0, 0.0, 0.0, 38.0, 52.0, 36.0, 39.0, 33.0, 1.0, 0.0, 111.0, 0.0, 66.0, 13.0, 67.0, 2.0, 46.0, 16.0, 152.0, 66.0, 16.0, 31.0, 71.0, 109.0, 0.0, 0.0, 8.0, 38.0, 94.0, 0.0, 94.0, 0.0, 14.0, 17.0, 39.0, 84.0, 6.0, 34.0, 136.0, 36.0, 18.0, 0.0, 1.0, 64.0, 99.0, 0.0, 23.0, 28.0, 16.0, 71.0, 0.0, 117.0, 26.0, 112.0, 134.0, 33.0, 0.0, 0.0, 23.0, 12.0, 90.0, 40.0, 33.0, 11.0, 0.0, 111.0, 24.0, 0.0, 19.0, 0.0, 19.0, 32.0, 12.0, 35.0, 0.0, 30.0, 50.0, 17.0, 0.0, 0.0, 102.0, 0.0, 8.0, 0.0, 69.0, 11.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8846697073486358, "mean_inference_ms": 2.790794872078678, "mean_action_processing_ms": 0.35679480596573643, "mean_env_wait_ms": 0.31817911328414916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007760882377624512, "StateBufferConnector_ms": 0.004304051399230957, "ViewRequirementAgentConnector_ms": 0.18830537796020508}, "num_episodes": 18, "episode_return_max": 312.0, "episode_return_min": -173.0, "episode_return_mean": 43.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.25529273643664, "num_env_steps_trained_throughput_per_sec": 215.25529273643664, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 13713.911, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13713.832, "sample_time_ms": 2171.917, "learn_time_ms": 11516.832, "learn_throughput": 347.318, "synch_weights_time_ms": 21.019}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "e1352_00002", "date": "2024-08-13_19-23-54", "timestamp": 1723591434, "time_this_iter_s": 18.62193989753723, "time_total_s": 1327.3402342796326, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d6bfb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1327.3402342796326, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 90.18076923076923, "ram_util_percent": 83.9076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6539289024338205, "cur_kl_coeff": 0.084375, "cur_lr": 0.00010000000000000003, "total_loss": 5.061857711701166, "policy_loss": -0.008818827764372582, "vf_loss": 5.068656686121825, "vf_explained_var": 0.006069017718077967, "kl": 0.023938906403926798, "entropy": 1.2942721038268357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6225105667871143, "cur_kl_coeff": 0.00078125, "cur_lr": 0.00010000000000000003, "total_loss": 6.3093354411856835, "policy_loss": -0.0006440851645218948, "vf_loss": 6.309976049958083, "vf_explained_var": 0.013909849035676825, "kl": 0.004464614509206789, "entropy": 1.449213479687928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 312.0, "episode_reward_min": -160.0, "episode_reward_mean": 44.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -275.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 152.0}, "policy_reward_mean": {"prey_policy": -9.49, "predator_policy": 31.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.0, 145.0, 160.0, -34.0, -156.0, 5.0, -5.0, 138.0, 94.0, -73.0, 19.0, -12.0, 8.0, 78.0, 71.0, -54.0, 32.0, 59.0, 155.0, 32.0, 41.0, 105.0, -42.0, -17.0, 7.0, -15.0, -14.0, 242.0, -40.0, 112.0, 9.0, 83.0, 20.0, -4.0, 163.0, 101.0, -31.0, 129.0, 42.0, 111.0, -22.0, 23.0, 0.0, 61.0, 31.0, 68.0, -1.0, -115.0, 186.0, -95.0, 3.0, 99.0, -22.0, 44.0, 312.0, -56.0, 55.0, -24.0, 137.0, 91.0, 33.0, 65.0, 147.0, -134.0, -54.0, -3.0, 109.0, 210.0, 56.0, 97.0, 96.0, 244.0, 114.0, -16.0, 65.0, 26.0, 130.0, 86.0, -96.0, 154.0, -52.0, 24.0, 27.0, -65.0, 118.0, 12.0, -3.0, -160.0, 44.0, -92.0, 118.0, 8.0, -123.0, 98.0, 111.0, -55.0, 174.0, 209.0, 66.0, 134.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [62.0, 62.0, 145.0, 0.0, 110.0, 50.0, -68.0, 0.0, -84.0, -148.0, -107.0, 42.0, -122.0, 56.0, 173.0, -76.0, -48.0, 56.0, -48.0, -160.0, -42.0, 0.0, 0.0, -41.0, -34.0, 0.0, 0.0, 78.0, 57.0, -14.0, 0.0, -117.0, 6.0, 0.0, 29.0, -42.0, 101.0, 18.0, 3.0, -8.0, 2.0, -9.0, 23.0, 77.0, -72.0, -108.0, -50.0, 0.0, 2.0, -3.0, -130.0, 43.0, -3.0, -46.0, 98.0, 139.0, -134.0, -17.0, 69.0, 14.0, -27.0, 11.0, 5.0, 36.0, -54.0, 33.0, -14.0, -41.0, 118.0, 45.0, 115.0, -120.0, 0.0, -98.0, 27.0, 41.0, 94.0, -136.0, 0.0, 73.0, -54.0, -56.0, -33.0, -16.0, -1.0, 0.0, 79.0, -129.0, -27.0, -21.0, 51.0, -52.0, 9.0, -72.0, -271.0, -62.0, 153.0, -14.0, -275.0, 0.0, 0.0, 3.0, 0.0, 53.0, -15.0, -101.0, 48.0, -98.0, 138.0, 143.0, -111.0, -68.0, 1.0, 14.0, 76.0, -272.0, 9.0, 110.0, 101.0, -75.0, -91.0, 25.0, 28.0, -14.0, -36.0, 96.0, -77.0, -174.0, 8.0, -200.0, 56.0, -226.0, 0.0, 109.0, 171.0, 4.0, -4.0, -70.0, -38.0, 91.0, 166.0, -181.0, 128.0, 92.0, 95.0, 0.0, 0.0, -67.0, -24.0, 42.0, -4.0, 0.0, -7.0, 70.0, 65.0, 21.0, -58.0, -140.0, 134.0, 12.0, 0.0, -132.0, 24.0, 0.0, 0.0, -76.0, -24.0, -106.0, 83.0, 35.0, 0.0, -103.0, -34.0, 14.0, -90.0, -247.0, 0.0, 33.0, -146.0, -148.0, 200.0, -214.0, -79.0, 0.0, -118.0, -187.0, -156.0, 176.0, 0.0, 67.0, -108.0, -2.0, 155.0, -6.0, 87.0, 86.0, -44.0, 44.0, 108.0, -49.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 0.0, 76.0, 56.0, 14.0, 0.0, 61.0, 12.0, 29.0, 15.0, 71.0, 20.0, 115.0, 61.0, 0.0, 5.0, 24.0, 5.0, 37.0, 0.0, 0.0, 13.0, 15.0, 0.0, 63.0, 20.0, 6.0, 21.0, 51.0, 22.0, 14.0, 37.0, 0.0, 0.0, 48.0, 1.0, 4.0, 81.0, 57.0, 6.0, 27.0, 0.0, 8.0, 70.0, 2.0, 5.0, 30.0, 4.0, 1.0, 97.0, 14.0, 0.0, 29.0, 0.0, 25.0, 0.0, 42.0, 5.0, 36.0, 3.0, 48.0, 0.0, 0.0, 30.0, 76.0, 49.0, 18.0, 31.0, 30.0, 84.0, 0.0, 0.0, 38.0, 52.0, 36.0, 39.0, 33.0, 1.0, 0.0, 111.0, 0.0, 66.0, 13.0, 67.0, 2.0, 46.0, 16.0, 152.0, 66.0, 16.0, 31.0, 71.0, 109.0, 0.0, 0.0, 8.0, 38.0, 94.0, 0.0, 94.0, 0.0, 14.0, 17.0, 39.0, 84.0, 6.0, 34.0, 136.0, 36.0, 18.0, 0.0, 1.0, 64.0, 99.0, 0.0, 23.0, 28.0, 16.0, 71.0, 0.0, 117.0, 26.0, 112.0, 134.0, 33.0, 0.0, 0.0, 23.0, 12.0, 90.0, 40.0, 33.0, 11.0, 0.0, 111.0, 24.0, 0.0, 19.0, 0.0, 19.0, 32.0, 12.0, 35.0, 0.0, 30.0, 50.0, 17.0, 0.0, 0.0, 102.0, 0.0, 8.0, 0.0, 69.0, 11.0, 0.0, 0.0, 13.0, 90.0, 6.0, 59.0, 0.0, 0.0, 70.0, 45.0, 0.0, 17.0, 45.0, 132.0, 3.0, 8.0, 106.0, 96.0, 132.0, 0.0, 39.0, 48.0, 55.0, 127.0, 0.0, 78.0, 44.0, 0.0, 0.0, 55.0, 0.0, 25.0, 24.0, 12.0, 30.0, 36.0, 75.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8948288705154774, "mean_inference_ms": 2.826517252593286, "mean_action_processing_ms": 0.3938500280110743, "mean_env_wait_ms": 0.32323447680515294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00765228271484375, "StateBufferConnector_ms": 0.004266142845153809, "ViewRequirementAgentConnector_ms": 0.17941486835479736}, "num_episodes": 18, "episode_return_max": 312.0, "episode_return_min": -160.0, "episode_return_mean": 44.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.64097224037565, "num_env_steps_trained_throughput_per_sec": 247.64097224037565, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 14115.032, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14114.953, "sample_time_ms": 2414.072, "learn_time_ms": 11675.795, "learn_throughput": 342.589, "synch_weights_time_ms": 20.64}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "e1352_00002", "date": "2024-08-13_19-24-10", "timestamp": 1723591450, "time_this_iter_s": 16.214452981948853, "time_total_s": 1343.5546872615814, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1343.5546872615814, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 66.07499999999999, "ram_util_percent": 83.60833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4859677514228871, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.00010000000000000003, "total_loss": 4.84450270700707, "policy_loss": 0.0006288907483279232, "vf_loss": 4.843516578371562, "vf_explained_var": 0.0037765136471501104, "kl": 0.002822750899651517, "entropy": 1.29249352923146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.320570210292541, "cur_kl_coeff": 0.000390625, "cur_lr": 0.00010000000000000003, "total_loss": 8.60550865016917, "policy_loss": -0.0013994479854960763, "vf_loss": 8.606899872028007, "vf_explained_var": 0.0718811447658236, "kl": 0.021068297974149205, "entropy": 1.3802730138970432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 312.0, "episode_reward_min": -211.0, "episode_reward_mean": 44.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -275.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 152.0}, "policy_reward_mean": {"prey_policy": -13.57, "predator_policy": 35.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0, 32.0, 41.0, 105.0, -42.0, -17.0, 7.0, -15.0, -14.0, 242.0, -40.0, 112.0, 9.0, 83.0, 20.0, -4.0, 163.0, 101.0, -31.0, 129.0, 42.0, 111.0, -22.0, 23.0, 0.0, 61.0, 31.0, 68.0, -1.0, -115.0, 186.0, -95.0, 3.0, 99.0, -22.0, 44.0, 312.0, -56.0, 55.0, -24.0, 137.0, 91.0, 33.0, 65.0, 147.0, -134.0, -54.0, -3.0, 109.0, 210.0, 56.0, 97.0, 96.0, 244.0, 114.0, -16.0, 65.0, 26.0, 130.0, 86.0, -96.0, 154.0, -52.0, 24.0, 27.0, -65.0, 118.0, 12.0, -3.0, -160.0, 44.0, -92.0, 118.0, 8.0, -123.0, 98.0, 111.0, -55.0, 174.0, 209.0, 66.0, 134.0, 47.0, 198.0, -15.0, -12.0, -183.0, 216.0, -116.0, 88.0, -116.0, 137.0, -81.0, 100.0, 263.0, 172.0, 36.0, -24.0, -211.0, 26.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.0, 18.0, 3.0, -8.0, 2.0, -9.0, 23.0, 77.0, -72.0, -108.0, -50.0, 0.0, 2.0, -3.0, -130.0, 43.0, -3.0, -46.0, 98.0, 139.0, -134.0, -17.0, 69.0, 14.0, -27.0, 11.0, 5.0, 36.0, -54.0, 33.0, -14.0, -41.0, 118.0, 45.0, 115.0, -120.0, 0.0, -98.0, 27.0, 41.0, 94.0, -136.0, 0.0, 73.0, -54.0, -56.0, -33.0, -16.0, -1.0, 0.0, 79.0, -129.0, -27.0, -21.0, 51.0, -52.0, 9.0, -72.0, -271.0, -62.0, 153.0, -14.0, -275.0, 0.0, 0.0, 3.0, 0.0, 53.0, -15.0, -101.0, 48.0, -98.0, 138.0, 143.0, -111.0, -68.0, 1.0, 14.0, 76.0, -272.0, 9.0, 110.0, 101.0, -75.0, -91.0, 25.0, 28.0, -14.0, -36.0, 96.0, -77.0, -174.0, 8.0, -200.0, 56.0, -226.0, 0.0, 109.0, 171.0, 4.0, -4.0, -70.0, -38.0, 91.0, 166.0, -181.0, 128.0, 92.0, 95.0, 0.0, 0.0, -67.0, -24.0, 42.0, -4.0, 0.0, -7.0, 70.0, 65.0, 21.0, -58.0, -140.0, 134.0, 12.0, 0.0, -132.0, 24.0, 0.0, 0.0, -76.0, -24.0, -106.0, 83.0, 35.0, 0.0, -103.0, -34.0, 14.0, -90.0, -247.0, 0.0, 33.0, -146.0, -148.0, 200.0, -214.0, -79.0, 0.0, -118.0, -187.0, -156.0, 176.0, 0.0, 67.0, -108.0, -2.0, 155.0, -6.0, 87.0, 86.0, -44.0, 44.0, 108.0, -49.0, -52.0, 64.0, 167.0, -28.0, -11.0, -129.0, 100.0, -245.0, -167.0, -168.0, 142.0, 54.0, -238.0, -44.0, 52.0, -16.0, -112.0, -62.0, 173.0, -82.0, -8.0, -214.0, 121.0, -42.0, 103.0, 122.0, 16.0, 102.0, -37.0, -10.0, 12.0, -229.0, -138.0, -146.0, 143.0, -234.0], "policy_predator_policy_reward": [22.0, 14.0, 37.0, 0.0, 0.0, 48.0, 1.0, 4.0, 81.0, 57.0, 6.0, 27.0, 0.0, 8.0, 70.0, 2.0, 5.0, 30.0, 4.0, 1.0, 97.0, 14.0, 0.0, 29.0, 0.0, 25.0, 0.0, 42.0, 5.0, 36.0, 3.0, 48.0, 0.0, 0.0, 30.0, 76.0, 49.0, 18.0, 31.0, 30.0, 84.0, 0.0, 0.0, 38.0, 52.0, 36.0, 39.0, 33.0, 1.0, 0.0, 111.0, 0.0, 66.0, 13.0, 67.0, 2.0, 46.0, 16.0, 152.0, 66.0, 16.0, 31.0, 71.0, 109.0, 0.0, 0.0, 8.0, 38.0, 94.0, 0.0, 94.0, 0.0, 14.0, 17.0, 39.0, 84.0, 6.0, 34.0, 136.0, 36.0, 18.0, 0.0, 1.0, 64.0, 99.0, 0.0, 23.0, 28.0, 16.0, 71.0, 0.0, 117.0, 26.0, 112.0, 134.0, 33.0, 0.0, 0.0, 23.0, 12.0, 90.0, 40.0, 33.0, 11.0, 0.0, 111.0, 24.0, 0.0, 19.0, 0.0, 19.0, 32.0, 12.0, 35.0, 0.0, 30.0, 50.0, 17.0, 0.0, 0.0, 102.0, 0.0, 8.0, 0.0, 69.0, 11.0, 0.0, 0.0, 13.0, 90.0, 6.0, 59.0, 0.0, 0.0, 70.0, 45.0, 0.0, 17.0, 45.0, 132.0, 3.0, 8.0, 106.0, 96.0, 132.0, 0.0, 39.0, 48.0, 55.0, 127.0, 0.0, 78.0, 44.0, 0.0, 0.0, 55.0, 0.0, 25.0, 24.0, 12.0, 30.0, 36.0, 75.0, 0.0, 26.0, 9.0, 55.0, 4.0, 10.0, 115.0, 21.0, 112.0, 32.0, 120.0, 0.0, 20.0, 50.0, 116.0, 17.0, 35.0, 46.0, 12.0, 44.0, 2.0, 85.0, 56.0, 21.0, 0.0, 2.0, 36.0, 31.0, 23.0, 78.0, 5.0, 95.0, 98.0, 73.0, 0.0, 117.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9045466968029098, "mean_inference_ms": 2.8601852135590504, "mean_action_processing_ms": 0.4296207344786401, "mean_env_wait_ms": 0.3280020498003288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008940696716308594, "StateBufferConnector_ms": 0.0045462846755981445, "ViewRequirementAgentConnector_ms": 0.15639090538024902}, "num_episodes": 18, "episode_return_max": 312.0, "episode_return_min": -211.0, "episode_return_mean": 44.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.5895929502268, "num_env_steps_trained_throughput_per_sec": 327.5895929502268, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 14154.263, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14154.184, "sample_time_ms": 2424.846, "learn_time_ms": 11704.427, "learn_throughput": 341.751, "synch_weights_time_ms": 20.539}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "e1352_00002", "date": "2024-08-13_19-24-22", "timestamp": 1723591462, "time_this_iter_s": 12.286274671554565, "time_total_s": 1355.840961933136, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1355.840961933136, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 62.77058823529411, "ram_util_percent": 83.3235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41249470977437874, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.6064404661693272, "policy_loss": -0.0017442325744827195, "vf_loss": 2.6079472702016275, "vf_explained_var": -0.00016778363752617407, "kl": 0.0037519609632113943, "entropy": 1.2697051135320512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.982721146625816, "cur_kl_coeff": 0.0005859374999999999, "cur_lr": 0.00010000000000000003, "total_loss": 7.218504963728486, "policy_loss": -0.004119684948418388, "vf_loss": 7.222612539927165, "vf_explained_var": 0.09752092380372304, "kl": 0.020722908988637326, "entropy": 1.3591973999189952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 335.0, "episode_reward_min": -223.0, "episode_reward_mean": 52.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 259.0}, "policy_reward_mean": {"prey_policy": -13.89, "predator_policy": 40.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.0, 23.0, 0.0, 61.0, 31.0, 68.0, -1.0, -115.0, 186.0, -95.0, 3.0, 99.0, -22.0, 44.0, 312.0, -56.0, 55.0, -24.0, 137.0, 91.0, 33.0, 65.0, 147.0, -134.0, -54.0, -3.0, 109.0, 210.0, 56.0, 97.0, 96.0, 244.0, 114.0, -16.0, 65.0, 26.0, 130.0, 86.0, -96.0, 154.0, -52.0, 24.0, 27.0, -65.0, 118.0, 12.0, -3.0, -160.0, 44.0, -92.0, 118.0, 8.0, -123.0, 98.0, 111.0, -55.0, 174.0, 209.0, 66.0, 134.0, 47.0, 198.0, -15.0, -12.0, -183.0, 216.0, -116.0, 88.0, -116.0, 137.0, -81.0, 100.0, 263.0, 172.0, 36.0, -24.0, -211.0, 26.0, 75.0, 25.0, -73.0, 0.0, 57.0, 217.0, 214.0, 183.0, -223.0, -92.0, 146.0, 277.0, -35.0, 220.0, 335.0, 0.0, 68.0, -33.0, 211.0, 193.0, 86.0, 159.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.0, -56.0, -33.0, -16.0, -1.0, 0.0, 79.0, -129.0, -27.0, -21.0, 51.0, -52.0, 9.0, -72.0, -271.0, -62.0, 153.0, -14.0, -275.0, 0.0, 0.0, 3.0, 0.0, 53.0, -15.0, -101.0, 48.0, -98.0, 138.0, 143.0, -111.0, -68.0, 1.0, 14.0, 76.0, -272.0, 9.0, 110.0, 101.0, -75.0, -91.0, 25.0, 28.0, -14.0, -36.0, 96.0, -77.0, -174.0, 8.0, -200.0, 56.0, -226.0, 0.0, 109.0, 171.0, 4.0, -4.0, -70.0, -38.0, 91.0, 166.0, -181.0, 128.0, 92.0, 95.0, 0.0, 0.0, -67.0, -24.0, 42.0, -4.0, 0.0, -7.0, 70.0, 65.0, 21.0, -58.0, -140.0, 134.0, 12.0, 0.0, -132.0, 24.0, 0.0, 0.0, -76.0, -24.0, -106.0, 83.0, 35.0, 0.0, -103.0, -34.0, 14.0, -90.0, -247.0, 0.0, 33.0, -146.0, -148.0, 200.0, -214.0, -79.0, 0.0, -118.0, -187.0, -156.0, 176.0, 0.0, 67.0, -108.0, -2.0, 155.0, -6.0, 87.0, 86.0, -44.0, 44.0, 108.0, -49.0, -52.0, 64.0, 167.0, -28.0, -11.0, -129.0, 100.0, -245.0, -167.0, -168.0, 142.0, 54.0, -238.0, -44.0, 52.0, -16.0, -112.0, -62.0, 173.0, -82.0, -8.0, -214.0, 121.0, -42.0, 103.0, 122.0, 16.0, 102.0, -37.0, -10.0, 12.0, -229.0, -138.0, -146.0, 143.0, -234.0, -58.0, 104.0, 154.0, -258.0, -354.0, 104.0, 0.0, 0.0, 141.0, -180.0, 24.0, 192.0, -95.0, 161.0, 28.0, 155.0, -210.0, -155.0, -261.0, -16.0, 0.0, 122.0, 121.0, 156.0, 112.0, -294.0, 145.0, 75.0, 180.0, 154.0, 0.0, 0.0, 124.0, -300.0, 55.0, -176.0, 123.0, 81.0, 94.0, 48.0, 17.0, -24.0, 190.0, -426.0], "policy_predator_policy_reward": [52.0, 36.0, 39.0, 33.0, 1.0, 0.0, 111.0, 0.0, 66.0, 13.0, 67.0, 2.0, 46.0, 16.0, 152.0, 66.0, 16.0, 31.0, 71.0, 109.0, 0.0, 0.0, 8.0, 38.0, 94.0, 0.0, 94.0, 0.0, 14.0, 17.0, 39.0, 84.0, 6.0, 34.0, 136.0, 36.0, 18.0, 0.0, 1.0, 64.0, 99.0, 0.0, 23.0, 28.0, 16.0, 71.0, 0.0, 117.0, 26.0, 112.0, 134.0, 33.0, 0.0, 0.0, 23.0, 12.0, 90.0, 40.0, 33.0, 11.0, 0.0, 111.0, 24.0, 0.0, 19.0, 0.0, 19.0, 32.0, 12.0, 35.0, 0.0, 30.0, 50.0, 17.0, 0.0, 0.0, 102.0, 0.0, 8.0, 0.0, 69.0, 11.0, 0.0, 0.0, 13.0, 90.0, 6.0, 59.0, 0.0, 0.0, 70.0, 45.0, 0.0, 17.0, 45.0, 132.0, 3.0, 8.0, 106.0, 96.0, 132.0, 0.0, 39.0, 48.0, 55.0, 127.0, 0.0, 78.0, 44.0, 0.0, 0.0, 55.0, 0.0, 25.0, 24.0, 12.0, 30.0, 36.0, 75.0, 0.0, 26.0, 9.0, 55.0, 4.0, 10.0, 115.0, 21.0, 112.0, 32.0, 120.0, 0.0, 20.0, 50.0, 116.0, 17.0, 35.0, 46.0, 12.0, 44.0, 2.0, 85.0, 56.0, 21.0, 0.0, 2.0, 36.0, 31.0, 23.0, 78.0, 5.0, 95.0, 98.0, 73.0, 0.0, 117.0, 0.0, 0.0, 29.0, 105.0, 24.0, 177.0, 0.0, 0.0, 0.0, 90.0, 6.0, 1.0, 0.0, 77.0, 71.0, 0.0, 0.0, 123.0, 19.0, 128.0, 57.0, 11.0, 13.0, 0.0, 0.0, 45.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 122.0, 122.0, 1.0, 87.0, 0.0, 7.0, 47.0, 4.0, 1.0, 92.0, 259.0, 136.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9025709906727488, "mean_inference_ms": 2.8483453689263714, "mean_action_processing_ms": 0.4649403130886215, "mean_env_wait_ms": 0.3268909813182584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009711146354675293, "StateBufferConnector_ms": 0.005166888236999512, "ViewRequirementAgentConnector_ms": 0.14240515232086182}, "num_episodes": 22, "episode_return_max": 335.0, "episode_return_min": -223.0, "episode_return_mean": 52.32, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.2062980402888, "num_env_steps_trained_throughput_per_sec": 333.2062980402888, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 14158.583, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14158.518, "sample_time_ms": 2431.351, "learn_time_ms": 11703.052, "learn_throughput": 341.791, "synch_weights_time_ms": 20.179}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "e1352_00002", "date": "2024-08-13_19-24-34", "timestamp": 1723591474, "time_this_iter_s": 12.053610801696777, "time_total_s": 1367.8945727348328, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d008b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1367.8945727348328, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 60.75882352941177, "ram_util_percent": 83.71176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5036281885727057, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 0.00010000000000000003, "total_loss": 2.6650378900230245, "policy_loss": -0.0010351886328497024, "vf_loss": 2.665758337167205, "vf_explained_var": 0.003831736751334377, "kl": 0.009947163258211373, "entropy": 1.2098363535114067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.4434906259100275, "cur_kl_coeff": 0.0008789062500000002, "cur_lr": 0.00010000000000000003, "total_loss": 8.38637875400523, "policy_loss": -0.0052616780819667005, "vf_loss": 8.391621922437476, "vf_explained_var": 0.1485220989222249, "kl": 0.021045485451460528, "entropy": 1.182277171952384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -223.0, "episode_reward_mean": 81.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 259.0}, "policy_reward_mean": {"prey_policy": 4.395, "predator_policy": 36.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.0, -54.0, -3.0, 109.0, 210.0, 56.0, 97.0, 96.0, 244.0, 114.0, -16.0, 65.0, 26.0, 130.0, 86.0, -96.0, 154.0, -52.0, 24.0, 27.0, -65.0, 118.0, 12.0, -3.0, -160.0, 44.0, -92.0, 118.0, 8.0, -123.0, 98.0, 111.0, -55.0, 174.0, 209.0, 66.0, 134.0, 47.0, 198.0, -15.0, -12.0, -183.0, 216.0, -116.0, 88.0, -116.0, 137.0, -81.0, 100.0, 263.0, 172.0, 36.0, -24.0, -211.0, 26.0, 75.0, 25.0, -73.0, 0.0, 57.0, 217.0, 214.0, 183.0, -223.0, -92.0, 146.0, 277.0, -35.0, 220.0, 335.0, 0.0, 68.0, -33.0, 211.0, 193.0, 86.0, 159.0, -36.0, 169.0, 187.0, 323.0, 194.0, 198.0, 312.0, -4.0, 227.0, 203.0, 319.0, -4.0, 194.0, 370.0, 104.0, 105.0, 265.0, 124.0, 36.0, 146.0, 138.0, 279.0, 73.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-77.0, -174.0, 8.0, -200.0, 56.0, -226.0, 0.0, 109.0, 171.0, 4.0, -4.0, -70.0, -38.0, 91.0, 166.0, -181.0, 128.0, 92.0, 95.0, 0.0, 0.0, -67.0, -24.0, 42.0, -4.0, 0.0, -7.0, 70.0, 65.0, 21.0, -58.0, -140.0, 134.0, 12.0, 0.0, -132.0, 24.0, 0.0, 0.0, -76.0, -24.0, -106.0, 83.0, 35.0, 0.0, -103.0, -34.0, 14.0, -90.0, -247.0, 0.0, 33.0, -146.0, -148.0, 200.0, -214.0, -79.0, 0.0, -118.0, -187.0, -156.0, 176.0, 0.0, 67.0, -108.0, -2.0, 155.0, -6.0, 87.0, 86.0, -44.0, 44.0, 108.0, -49.0, -52.0, 64.0, 167.0, -28.0, -11.0, -129.0, 100.0, -245.0, -167.0, -168.0, 142.0, 54.0, -238.0, -44.0, 52.0, -16.0, -112.0, -62.0, 173.0, -82.0, -8.0, -214.0, 121.0, -42.0, 103.0, 122.0, 16.0, 102.0, -37.0, -10.0, 12.0, -229.0, -138.0, -146.0, 143.0, -234.0, -58.0, 104.0, 154.0, -258.0, -354.0, 104.0, 0.0, 0.0, 141.0, -180.0, 24.0, 192.0, -95.0, 161.0, 28.0, 155.0, -210.0, -155.0, -261.0, -16.0, 0.0, 122.0, 121.0, 156.0, 112.0, -294.0, 145.0, 75.0, 180.0, 154.0, 0.0, 0.0, 124.0, -300.0, 55.0, -176.0, 123.0, 81.0, 94.0, 48.0, 17.0, -24.0, 190.0, -426.0, 22.0, -340.0, 0.0, 167.0, 0.0, 187.0, 123.0, 200.0, 148.0, -8.0, 89.0, 106.0, 185.0, 100.0, 1.0, -32.0, 76.0, 149.0, 101.0, 63.0, 125.0, 194.0, 0.0, -8.0, 170.0, -51.0, 170.0, 198.0, 74.0, 0.0, -88.0, 106.0, 77.0, 166.0, 124.0, 0.0, -34.0, -114.0, 24.0, 83.0, 15.0, 123.0, 154.0, 109.0, 178.0, -302.0], "policy_predator_policy_reward": [0.0, 117.0, 26.0, 112.0, 134.0, 33.0, 0.0, 0.0, 23.0, 12.0, 90.0, 40.0, 33.0, 11.0, 0.0, 111.0, 24.0, 0.0, 19.0, 0.0, 19.0, 32.0, 12.0, 35.0, 0.0, 30.0, 50.0, 17.0, 0.0, 0.0, 102.0, 0.0, 8.0, 0.0, 69.0, 11.0, 0.0, 0.0, 13.0, 90.0, 6.0, 59.0, 0.0, 0.0, 70.0, 45.0, 0.0, 17.0, 45.0, 132.0, 3.0, 8.0, 106.0, 96.0, 132.0, 0.0, 39.0, 48.0, 55.0, 127.0, 0.0, 78.0, 44.0, 0.0, 0.0, 55.0, 0.0, 25.0, 24.0, 12.0, 30.0, 36.0, 75.0, 0.0, 26.0, 9.0, 55.0, 4.0, 10.0, 115.0, 21.0, 112.0, 32.0, 120.0, 0.0, 20.0, 50.0, 116.0, 17.0, 35.0, 46.0, 12.0, 44.0, 2.0, 85.0, 56.0, 21.0, 0.0, 2.0, 36.0, 31.0, 23.0, 78.0, 5.0, 95.0, 98.0, 73.0, 0.0, 117.0, 0.0, 0.0, 29.0, 105.0, 24.0, 177.0, 0.0, 0.0, 0.0, 90.0, 6.0, 1.0, 0.0, 77.0, 71.0, 0.0, 0.0, 123.0, 19.0, 128.0, 57.0, 11.0, 13.0, 0.0, 0.0, 45.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 122.0, 122.0, 1.0, 87.0, 0.0, 7.0, 47.0, 4.0, 1.0, 92.0, 259.0, 136.0, 110.0, 172.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 28.0, 26.0, 0.0, 3.0, 27.0, 0.0, 12.0, 15.0, 0.0, 2.0, 30.0, 9.0, 0.0, 0.0, 4.0, 0.0, 47.0, 28.0, 0.0, 2.0, 21.0, 9.0, 11.0, 76.0, 0.0, 22.0, 0.0, 0.0, 81.0, 103.0, 6.0, 33.0, 0.0, 0.0, 0.0, 16.0, 138.0, 59.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8999115417019847, "mean_inference_ms": 2.8351277397579, "mean_action_processing_ms": 0.5005511195234816, "mean_env_wait_ms": 0.3258765418918886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011705994606018066, "StateBufferConnector_ms": 0.005024552345275879, "ViewRequirementAgentConnector_ms": 0.13125503063201904}, "num_episodes": 23, "episode_return_max": 370.0, "episode_return_min": -223.0, "episode_return_mean": 81.34, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.4895006069839, "num_env_steps_trained_throughput_per_sec": 346.4895006069839, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 14094.782, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14094.719, "sample_time_ms": 2448.89, "learn_time_ms": 11621.657, "learn_throughput": 344.185, "synch_weights_time_ms": 20.329}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "e1352_00002", "date": "2024-08-13_19-24-46", "timestamp": 1723591486, "time_this_iter_s": 11.599526166915894, "time_total_s": 1379.4940989017487, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1379.4940989017487, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 57.82941176470588, "ram_util_percent": 83.82941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47916245243497313, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 0.00010000000000000003, "total_loss": 0.7754025435163862, "policy_loss": -0.0024324887747526483, "vf_loss": 0.7775700385095896, "vf_explained_var": 0.008995495492188388, "kl": 0.008375154676713237, "entropy": 1.1990022323118947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.257232211143883, "cur_kl_coeff": 0.001318359375, "cur_lr": 0.00010000000000000003, "total_loss": 6.650618005177331, "policy_loss": -0.002443975109234945, "vf_loss": 6.653043892774632, "vf_explained_var": 0.34289831796651166, "kl": 0.013720814874660658, "entropy": 1.0980254982514357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -223.0, "episode_reward_mean": 108.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 259.0}, "policy_reward_mean": {"prey_policy": 20.835, "predator_policy": 33.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.0, 27.0, -65.0, 118.0, 12.0, -3.0, -160.0, 44.0, -92.0, 118.0, 8.0, -123.0, 98.0, 111.0, -55.0, 174.0, 209.0, 66.0, 134.0, 47.0, 198.0, -15.0, -12.0, -183.0, 216.0, -116.0, 88.0, -116.0, 137.0, -81.0, 100.0, 263.0, 172.0, 36.0, -24.0, -211.0, 26.0, 75.0, 25.0, -73.0, 0.0, 57.0, 217.0, 214.0, 183.0, -223.0, -92.0, 146.0, 277.0, -35.0, 220.0, 335.0, 0.0, 68.0, -33.0, 211.0, 193.0, 86.0, 159.0, -36.0, 169.0, 187.0, 323.0, 194.0, 198.0, 312.0, -4.0, 227.0, 203.0, 319.0, -4.0, 194.0, 370.0, 104.0, 105.0, 265.0, 124.0, 36.0, 146.0, 138.0, 279.0, 73.0, 384.0, 360.0, 246.0, 306.0, -11.0, 142.0, 345.0, 75.0, 209.0, 0.0, 174.0, 14.0, 321.0, 171.0, 319.0, 317.0, 158.0, 174.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.0, 0.0, 0.0, -76.0, -24.0, -106.0, 83.0, 35.0, 0.0, -103.0, -34.0, 14.0, -90.0, -247.0, 0.0, 33.0, -146.0, -148.0, 200.0, -214.0, -79.0, 0.0, -118.0, -187.0, -156.0, 176.0, 0.0, 67.0, -108.0, -2.0, 155.0, -6.0, 87.0, 86.0, -44.0, 44.0, 108.0, -49.0, -52.0, 64.0, 167.0, -28.0, -11.0, -129.0, 100.0, -245.0, -167.0, -168.0, 142.0, 54.0, -238.0, -44.0, 52.0, -16.0, -112.0, -62.0, 173.0, -82.0, -8.0, -214.0, 121.0, -42.0, 103.0, 122.0, 16.0, 102.0, -37.0, -10.0, 12.0, -229.0, -138.0, -146.0, 143.0, -234.0, -58.0, 104.0, 154.0, -258.0, -354.0, 104.0, 0.0, 0.0, 141.0, -180.0, 24.0, 192.0, -95.0, 161.0, 28.0, 155.0, -210.0, -155.0, -261.0, -16.0, 0.0, 122.0, 121.0, 156.0, 112.0, -294.0, 145.0, 75.0, 180.0, 154.0, 0.0, 0.0, 124.0, -300.0, 55.0, -176.0, 123.0, 81.0, 94.0, 48.0, 17.0, -24.0, 190.0, -426.0, 22.0, -340.0, 0.0, 167.0, 0.0, 187.0, 123.0, 200.0, 148.0, -8.0, 89.0, 106.0, 185.0, 100.0, 1.0, -32.0, 76.0, 149.0, 101.0, 63.0, 125.0, 194.0, 0.0, -8.0, 170.0, -51.0, 170.0, 198.0, 74.0, 0.0, -88.0, 106.0, 77.0, 166.0, 124.0, 0.0, -34.0, -114.0, 24.0, 83.0, 15.0, 123.0, 154.0, 109.0, 178.0, -302.0, 184.0, 200.0, 157.0, 191.0, 101.0, 86.0, 93.0, 179.0, 0.0, -270.0, 113.0, -4.0, 171.0, 173.0, 0.0, 75.0, 128.0, 53.0, 0.0, 0.0, 174.0, 0.0, 9.0, 0.0, 104.0, 186.0, 167.0, 0.0, 197.0, 63.0, 133.0, 176.0, 0.0, 137.0, 174.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 13.0, 90.0, 6.0, 59.0, 0.0, 0.0, 70.0, 45.0, 0.0, 17.0, 45.0, 132.0, 3.0, 8.0, 106.0, 96.0, 132.0, 0.0, 39.0, 48.0, 55.0, 127.0, 0.0, 78.0, 44.0, 0.0, 0.0, 55.0, 0.0, 25.0, 24.0, 12.0, 30.0, 36.0, 75.0, 0.0, 26.0, 9.0, 55.0, 4.0, 10.0, 115.0, 21.0, 112.0, 32.0, 120.0, 0.0, 20.0, 50.0, 116.0, 17.0, 35.0, 46.0, 12.0, 44.0, 2.0, 85.0, 56.0, 21.0, 0.0, 2.0, 36.0, 31.0, 23.0, 78.0, 5.0, 95.0, 98.0, 73.0, 0.0, 117.0, 0.0, 0.0, 29.0, 105.0, 24.0, 177.0, 0.0, 0.0, 0.0, 90.0, 6.0, 1.0, 0.0, 77.0, 71.0, 0.0, 0.0, 123.0, 19.0, 128.0, 57.0, 11.0, 13.0, 0.0, 0.0, 45.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 122.0, 122.0, 1.0, 87.0, 0.0, 7.0, 47.0, 4.0, 1.0, 92.0, 259.0, 136.0, 110.0, 172.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 28.0, 26.0, 0.0, 3.0, 27.0, 0.0, 12.0, 15.0, 0.0, 2.0, 30.0, 9.0, 0.0, 0.0, 4.0, 0.0, 47.0, 28.0, 0.0, 2.0, 21.0, 9.0, 11.0, 76.0, 0.0, 22.0, 0.0, 0.0, 81.0, 103.0, 6.0, 33.0, 0.0, 0.0, 0.0, 16.0, 138.0, 59.0, 0.0, 0.0, 0.0, 12.0, 38.0, 21.0, 34.0, 0.0, 135.0, 124.0, 19.0, 14.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 14.0, 17.0, 4.0, 0.0, 29.0, 30.0, 0.0, 8.0, 20.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8964880314012325, "mean_inference_ms": 2.824038763475514, "mean_action_processing_ms": 0.5272592508212729, "mean_env_wait_ms": 0.32464270105666765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011345386505126953, "StateBufferConnector_ms": 0.005777478218078613, "ViewRequirementAgentConnector_ms": 0.13033783435821533}, "num_episodes": 18, "episode_return_max": 384.0, "episode_return_min": -223.0, "episode_return_mean": 108.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.79740886797833, "num_env_steps_trained_throughput_per_sec": 329.79740886797833, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 14061.635, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14061.571, "sample_time_ms": 2482.734, "learn_time_ms": 11554.511, "learn_throughput": 346.185, "synch_weights_time_ms": 20.725}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "e1352_00002", "date": "2024-08-13_19-24-58", "timestamp": 1723591498, "time_this_iter_s": 12.180699825286865, "time_total_s": 1391.6747987270355, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb58b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1391.6747987270355, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 60.81764705882353, "ram_util_percent": 83.9235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8483270960273566, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 0.00010000000000000003, "total_loss": 1.2026755149717685, "policy_loss": -0.0023261373360005636, "vf_loss": 1.2048976466926948, "vf_explained_var": 0.07376614408518271, "kl": 0.0032869969676244046, "entropy": 1.1913695202933416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.658180367867782, "cur_kl_coeff": 0.001318359375, "cur_lr": 0.00010000000000000003, "total_loss": 6.636309320712216, "policy_loss": -0.00046774843022739763, "vf_loss": 6.636765188893313, "vf_explained_var": 0.38192838512400473, "kl": 0.009009635714329504, "entropy": 1.0672179569327642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -223.0, "episode_reward_mean": 140.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 259.0}, "policy_reward_mean": {"prey_policy": 42.485, "predator_policy": 27.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0, 47.0, 198.0, -15.0, -12.0, -183.0, 216.0, -116.0, 88.0, -116.0, 137.0, -81.0, 100.0, 263.0, 172.0, 36.0, -24.0, -211.0, 26.0, 75.0, 25.0, -73.0, 0.0, 57.0, 217.0, 214.0, 183.0, -223.0, -92.0, 146.0, 277.0, -35.0, 220.0, 335.0, 0.0, 68.0, -33.0, 211.0, 193.0, 86.0, 159.0, -36.0, 169.0, 187.0, 323.0, 194.0, 198.0, 312.0, -4.0, 227.0, 203.0, 319.0, -4.0, 194.0, 370.0, 104.0, 105.0, 265.0, 124.0, 36.0, 146.0, 138.0, 279.0, 73.0, 384.0, 360.0, 246.0, 306.0, -11.0, 142.0, 345.0, 75.0, 209.0, 0.0, 174.0, 14.0, 321.0, 171.0, 319.0, 317.0, 158.0, 174.0, 308.0, 0.0, 321.0, 227.0, 155.0, 323.0, 283.0, 182.0, 191.0, 81.0, 361.0, 161.0, 128.0, 54.0, 194.0, 347.0, 124.0, 356.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [108.0, -49.0, -52.0, 64.0, 167.0, -28.0, -11.0, -129.0, 100.0, -245.0, -167.0, -168.0, 142.0, 54.0, -238.0, -44.0, 52.0, -16.0, -112.0, -62.0, 173.0, -82.0, -8.0, -214.0, 121.0, -42.0, 103.0, 122.0, 16.0, 102.0, -37.0, -10.0, 12.0, -229.0, -138.0, -146.0, 143.0, -234.0, -58.0, 104.0, 154.0, -258.0, -354.0, 104.0, 0.0, 0.0, 141.0, -180.0, 24.0, 192.0, -95.0, 161.0, 28.0, 155.0, -210.0, -155.0, -261.0, -16.0, 0.0, 122.0, 121.0, 156.0, 112.0, -294.0, 145.0, 75.0, 180.0, 154.0, 0.0, 0.0, 124.0, -300.0, 55.0, -176.0, 123.0, 81.0, 94.0, 48.0, 17.0, -24.0, 190.0, -426.0, 22.0, -340.0, 0.0, 167.0, 0.0, 187.0, 123.0, 200.0, 148.0, -8.0, 89.0, 106.0, 185.0, 100.0, 1.0, -32.0, 76.0, 149.0, 101.0, 63.0, 125.0, 194.0, 0.0, -8.0, 170.0, -51.0, 170.0, 198.0, 74.0, 0.0, -88.0, 106.0, 77.0, 166.0, 124.0, 0.0, -34.0, -114.0, 24.0, 83.0, 15.0, 123.0, 154.0, 109.0, 178.0, -302.0, 184.0, 200.0, 157.0, 191.0, 101.0, 86.0, 93.0, 179.0, 0.0, -270.0, 113.0, -4.0, 171.0, 173.0, 0.0, 75.0, 128.0, 53.0, 0.0, 0.0, 174.0, 0.0, 9.0, 0.0, 104.0, 186.0, 167.0, 0.0, 197.0, 63.0, 133.0, 176.0, 0.0, 137.0, 174.0, 0.0, 155.0, 153.0, 0.0, 0.0, 132.0, 189.0, -31.0, 158.0, 149.0, -6.0, 196.0, 97.0, 197.0, 86.0, 0.0, 176.0, 187.0, 0.0, 23.0, -2.0, 200.0, 156.0, -12.0, 167.0, 0.0, 111.0, 0.0, 0.0, 0.0, 194.0, 169.0, 167.0, 88.0, 0.0, 181.0, 166.0], "policy_predator_policy_reward": [75.0, 0.0, 26.0, 9.0, 55.0, 4.0, 10.0, 115.0, 21.0, 112.0, 32.0, 120.0, 0.0, 20.0, 50.0, 116.0, 17.0, 35.0, 46.0, 12.0, 44.0, 2.0, 85.0, 56.0, 21.0, 0.0, 2.0, 36.0, 31.0, 23.0, 78.0, 5.0, 95.0, 98.0, 73.0, 0.0, 117.0, 0.0, 0.0, 29.0, 105.0, 24.0, 177.0, 0.0, 0.0, 0.0, 90.0, 6.0, 1.0, 0.0, 77.0, 71.0, 0.0, 0.0, 123.0, 19.0, 128.0, 57.0, 11.0, 13.0, 0.0, 0.0, 45.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 122.0, 122.0, 1.0, 87.0, 0.0, 7.0, 47.0, 4.0, 1.0, 92.0, 259.0, 136.0, 110.0, 172.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 28.0, 26.0, 0.0, 3.0, 27.0, 0.0, 12.0, 15.0, 0.0, 2.0, 30.0, 9.0, 0.0, 0.0, 4.0, 0.0, 47.0, 28.0, 0.0, 2.0, 21.0, 9.0, 11.0, 76.0, 0.0, 22.0, 0.0, 0.0, 81.0, 103.0, 6.0, 33.0, 0.0, 0.0, 0.0, 16.0, 138.0, 59.0, 0.0, 0.0, 0.0, 12.0, 38.0, 21.0, 34.0, 0.0, 135.0, 124.0, 19.0, 14.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 14.0, 17.0, 4.0, 0.0, 29.0, 30.0, 0.0, 8.0, 20.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 48.0, 9.0, 3.0, 30.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 5.0, 55.0, 5.0, 0.0, 0.0, 6.0, 17.0, 0.0, 12.0, 42.0, 0.0, 0.0, 0.0, 11.0, 36.0, 0.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8934070565779308, "mean_inference_ms": 2.814526849569072, "mean_action_processing_ms": 0.5224617420130212, "mean_env_wait_ms": 0.32352999591710785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018758654594421387, "StateBufferConnector_ms": 0.009446501731872559, "ViewRequirementAgentConnector_ms": 0.13229167461395264}, "num_episodes": 18, "episode_return_max": 384.0, "episode_return_min": -223.0, "episode_return_mean": 140.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 339.0336475195988, "num_env_steps_trained_throughput_per_sec": 339.0336475195988, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 14069.126, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14069.063, "sample_time_ms": 2488.843, "learn_time_ms": 11559.756, "learn_throughput": 346.028, "synch_weights_time_ms": 16.716}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "e1352_00002", "date": "2024-08-13_19-25-10", "timestamp": 1723591510, "time_this_iter_s": 11.85657811164856, "time_total_s": 1403.531376838684, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1403.531376838684, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 56.51764705882353, "ram_util_percent": 83.93529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7424090140553379, "cur_kl_coeff": 0.015820312499999996, "cur_lr": 0.00010000000000000003, "total_loss": 1.3494070451884044, "policy_loss": -0.006491619987393576, "vf_loss": 1.35570223390583, "vf_explained_var": 0.005849190868397869, "kl": 0.012416437440257194, "entropy": 1.1743153029648716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.532950738387765, "cur_kl_coeff": 0.001318359375, "cur_lr": 0.00010000000000000003, "total_loss": 5.461166372753325, "policy_loss": -0.0025375517887166804, "vf_loss": 5.463692660811086, "vf_explained_var": 0.47424606346579457, "kl": 0.008540795729960634, "entropy": 1.1747325214128645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -223.0, "episode_reward_mean": 164.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 259.0}, "policy_reward_mean": {"prey_policy": 59.955, "predator_policy": 22.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.0, 75.0, 25.0, -73.0, 0.0, 57.0, 217.0, 214.0, 183.0, -223.0, -92.0, 146.0, 277.0, -35.0, 220.0, 335.0, 0.0, 68.0, -33.0, 211.0, 193.0, 86.0, 159.0, -36.0, 169.0, 187.0, 323.0, 194.0, 198.0, 312.0, -4.0, 227.0, 203.0, 319.0, -4.0, 194.0, 370.0, 104.0, 105.0, 265.0, 124.0, 36.0, 146.0, 138.0, 279.0, 73.0, 384.0, 360.0, 246.0, 306.0, -11.0, 142.0, 345.0, 75.0, 209.0, 0.0, 174.0, 14.0, 321.0, 171.0, 319.0, 317.0, 158.0, 174.0, 308.0, 0.0, 321.0, 227.0, 155.0, 323.0, 283.0, 182.0, 191.0, 81.0, 361.0, 161.0, 128.0, 54.0, 194.0, 347.0, 124.0, 356.0, 300.0, 138.0, 334.0, 175.0, 88.0, 134.0, 79.0, 22.0, 184.0, -7.0, 196.0, 330.0, 185.0, 365.0, 338.0, 5.0, 170.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [143.0, -234.0, -58.0, 104.0, 154.0, -258.0, -354.0, 104.0, 0.0, 0.0, 141.0, -180.0, 24.0, 192.0, -95.0, 161.0, 28.0, 155.0, -210.0, -155.0, -261.0, -16.0, 0.0, 122.0, 121.0, 156.0, 112.0, -294.0, 145.0, 75.0, 180.0, 154.0, 0.0, 0.0, 124.0, -300.0, 55.0, -176.0, 123.0, 81.0, 94.0, 48.0, 17.0, -24.0, 190.0, -426.0, 22.0, -340.0, 0.0, 167.0, 0.0, 187.0, 123.0, 200.0, 148.0, -8.0, 89.0, 106.0, 185.0, 100.0, 1.0, -32.0, 76.0, 149.0, 101.0, 63.0, 125.0, 194.0, 0.0, -8.0, 170.0, -51.0, 170.0, 198.0, 74.0, 0.0, -88.0, 106.0, 77.0, 166.0, 124.0, 0.0, -34.0, -114.0, 24.0, 83.0, 15.0, 123.0, 154.0, 109.0, 178.0, -302.0, 184.0, 200.0, 157.0, 191.0, 101.0, 86.0, 93.0, 179.0, 0.0, -270.0, 113.0, -4.0, 171.0, 173.0, 0.0, 75.0, 128.0, 53.0, 0.0, 0.0, 174.0, 0.0, 9.0, 0.0, 104.0, 186.0, 167.0, 0.0, 197.0, 63.0, 133.0, 176.0, 0.0, 137.0, 174.0, 0.0, 155.0, 153.0, 0.0, 0.0, 132.0, 189.0, -31.0, 158.0, 149.0, -6.0, 196.0, 97.0, 197.0, 86.0, 0.0, 176.0, 187.0, 0.0, 23.0, -2.0, 200.0, 156.0, -12.0, 167.0, 0.0, 111.0, 0.0, 0.0, 0.0, 194.0, 169.0, 167.0, 88.0, 0.0, 181.0, 166.0, 177.0, 117.0, 101.0, 0.0, 125.0, 189.0, -38.0, 193.0, 37.0, -4.0, 0.0, 124.0, 31.0, 0.0, -23.0, -79.0, 43.0, 98.0, -14.0, 0.0, 196.0, 0.0, 133.0, 180.0, 185.0, 0.0, 188.0, 168.0, 119.0, 200.0, 0.0, 2.0, 155.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [117.0, 0.0, 0.0, 29.0, 105.0, 24.0, 177.0, 0.0, 0.0, 0.0, 90.0, 6.0, 1.0, 0.0, 77.0, 71.0, 0.0, 0.0, 123.0, 19.0, 128.0, 57.0, 11.0, 13.0, 0.0, 0.0, 45.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 122.0, 122.0, 1.0, 87.0, 0.0, 7.0, 47.0, 4.0, 1.0, 92.0, 259.0, 136.0, 110.0, 172.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 28.0, 26.0, 0.0, 3.0, 27.0, 0.0, 12.0, 15.0, 0.0, 2.0, 30.0, 9.0, 0.0, 0.0, 4.0, 0.0, 47.0, 28.0, 0.0, 2.0, 21.0, 9.0, 11.0, 76.0, 0.0, 22.0, 0.0, 0.0, 81.0, 103.0, 6.0, 33.0, 0.0, 0.0, 0.0, 16.0, 138.0, 59.0, 0.0, 0.0, 0.0, 12.0, 38.0, 21.0, 34.0, 0.0, 135.0, 124.0, 19.0, 14.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 14.0, 17.0, 4.0, 0.0, 29.0, 30.0, 0.0, 8.0, 20.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 48.0, 9.0, 3.0, 30.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 5.0, 55.0, 5.0, 0.0, 0.0, 6.0, 17.0, 0.0, 12.0, 42.0, 0.0, 0.0, 0.0, 11.0, 36.0, 0.0, 0.0, 9.0, 1.0, 5.0, 33.0, 4.0, 6.0, 14.0, 19.0, 1.0, 0.0, 55.0, 0.0, 10.0, 27.0, 21.0, 68.0, 56.0, 39.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, 0.0, 19.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8930769321475726, "mean_inference_ms": 2.813137026165455, "mean_action_processing_ms": 0.5173074609705429, "mean_env_wait_ms": 0.32354467651799346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017597317695617676, "StateBufferConnector_ms": 0.010835647583007812, "ViewRequirementAgentConnector_ms": 0.14150583744049072}, "num_episodes": 18, "episode_return_max": 384.0, "episode_return_min": -223.0, "episode_return_mean": 164.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.28623017249794, "num_env_steps_trained_throughput_per_sec": 299.28623017249794, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 13756.099, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13756.049, "sample_time_ms": 2589.849, "learn_time_ms": 11148.263, "learn_throughput": 358.8, "synch_weights_time_ms": 14.626}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "e1352_00002", "date": "2024-08-13_19-25-24", "timestamp": 1723591524, "time_this_iter_s": 13.41770887374878, "time_total_s": 1416.9490857124329, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1416.9490857124329, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 61.415789473684214, "ram_util_percent": 84.02105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7698780049446714, "cur_kl_coeff": 0.015820312499999996, "cur_lr": 0.00010000000000000003, "total_loss": 2.628095508630944, "policy_loss": -0.0037287418246417054, "vf_loss": 2.6316967661418613, "vf_explained_var": 0.0137581070579549, "kl": 0.008058402224578464, "entropy": 1.1647382796756804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.436335852355867, "cur_kl_coeff": 0.001318359375, "cur_lr": 0.00010000000000000003, "total_loss": 6.714715444726288, "policy_loss": -0.000412405357159004, "vf_loss": 6.715123724306702, "vf_explained_var": 0.11492807310094279, "kl": 0.003130205223450137, "entropy": 1.1173854177591032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 384.0, "episode_reward_min": -104.0, "episode_reward_mean": 169.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -343.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": 67.57, "predator_policy": 16.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194.0, 198.0, 312.0, -4.0, 227.0, 203.0, 319.0, -4.0, 194.0, 370.0, 104.0, 105.0, 265.0, 124.0, 36.0, 146.0, 138.0, 279.0, 73.0, 384.0, 360.0, 246.0, 306.0, -11.0, 142.0, 345.0, 75.0, 209.0, 0.0, 174.0, 14.0, 321.0, 171.0, 319.0, 317.0, 158.0, 174.0, 308.0, 0.0, 321.0, 227.0, 155.0, 323.0, 283.0, 182.0, 191.0, 81.0, 361.0, 161.0, 128.0, 54.0, 194.0, 347.0, 124.0, 356.0, 300.0, 138.0, 334.0, 175.0, 88.0, 134.0, 79.0, 22.0, 184.0, -7.0, 196.0, 330.0, 185.0, 365.0, 338.0, 5.0, 170.0, 0.0, 277.0, 63.0, 167.0, 191.0, 164.0, -25.0, 0.0, 189.0, -104.0, 213.0, 264.0, -12.0, 77.0, 102.0, 293.0, 117.0, 197.0, 203.0, -55.0, 19.0, 90.0, 216.0, 0.0, -57.0, 0.0, 309.0, 188.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [148.0, -8.0, 89.0, 106.0, 185.0, 100.0, 1.0, -32.0, 76.0, 149.0, 101.0, 63.0, 125.0, 194.0, 0.0, -8.0, 170.0, -51.0, 170.0, 198.0, 74.0, 0.0, -88.0, 106.0, 77.0, 166.0, 124.0, 0.0, -34.0, -114.0, 24.0, 83.0, 15.0, 123.0, 154.0, 109.0, 178.0, -302.0, 184.0, 200.0, 157.0, 191.0, 101.0, 86.0, 93.0, 179.0, 0.0, -270.0, 113.0, -4.0, 171.0, 173.0, 0.0, 75.0, 128.0, 53.0, 0.0, 0.0, 174.0, 0.0, 9.0, 0.0, 104.0, 186.0, 167.0, 0.0, 197.0, 63.0, 133.0, 176.0, 0.0, 137.0, 174.0, 0.0, 155.0, 153.0, 0.0, 0.0, 132.0, 189.0, -31.0, 158.0, 149.0, -6.0, 196.0, 97.0, 197.0, 86.0, 0.0, 176.0, 187.0, 0.0, 23.0, -2.0, 200.0, 156.0, -12.0, 167.0, 0.0, 111.0, 0.0, 0.0, 0.0, 194.0, 169.0, 167.0, 88.0, 0.0, 181.0, 166.0, 177.0, 117.0, 101.0, 0.0, 125.0, 189.0, -38.0, 193.0, 37.0, -4.0, 0.0, 124.0, 31.0, 0.0, -23.0, -79.0, 43.0, 98.0, -14.0, 0.0, 196.0, 0.0, 133.0, 180.0, 185.0, 0.0, 188.0, 168.0, 119.0, 200.0, 0.0, 2.0, 155.0, 0.0, 0.0, 0.0, 173.0, 52.0, 0.0, 61.0, 151.0, 0.0, -8.0, 188.0, 157.0, -48.0, 0.0, -50.0, 0.0, 0.0, 189.0, 0.0, -343.0, -7.0, 13.0, 200.0, 112.0, 92.0, -86.0, -38.0, -22.0, 47.0, -2.0, 98.0, 150.0, 143.0, -127.0, 173.0, 200.0, -6.0, 6.0, 151.0, -62.0, -24.0, -2.0, -69.0, -38.0, 8.0, -1.0, 129.0, 0.0, 0.0, -123.0, -79.0, 0.0, 0.0, 119.0, 186.0, -14.0, 195.0], "policy_predator_policy_reward": [28.0, 26.0, 0.0, 3.0, 27.0, 0.0, 12.0, 15.0, 0.0, 2.0, 30.0, 9.0, 0.0, 0.0, 4.0, 0.0, 47.0, 28.0, 0.0, 2.0, 21.0, 9.0, 11.0, 76.0, 0.0, 22.0, 0.0, 0.0, 81.0, 103.0, 6.0, 33.0, 0.0, 0.0, 0.0, 16.0, 138.0, 59.0, 0.0, 0.0, 0.0, 12.0, 38.0, 21.0, 34.0, 0.0, 135.0, 124.0, 19.0, 14.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 14.0, 17.0, 4.0, 0.0, 29.0, 30.0, 0.0, 8.0, 20.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 48.0, 9.0, 3.0, 30.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 5.0, 55.0, 5.0, 0.0, 0.0, 6.0, 17.0, 0.0, 12.0, 42.0, 0.0, 0.0, 0.0, 11.0, 36.0, 0.0, 0.0, 9.0, 1.0, 5.0, 33.0, 4.0, 6.0, 14.0, 19.0, 1.0, 0.0, 55.0, 0.0, 10.0, 27.0, 21.0, 68.0, 56.0, 39.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, 0.0, 19.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, 52.0, 0.0, 2.0, 0.0, 1.0, 15.0, 7.0, 4.0, 55.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 157.0, 89.0, 0.0, 0.0, 0.0, 60.0, 112.0, 0.0, 36.0, 16.0, 1.0, 5.0, 0.0, 0.0, 71.0, 0.0, 3.0, 0.0, 12.0, 34.0, 0.0, 31.0, 0.0, 90.0, 48.0, 72.0, 56.0, 32.0, 0.0, 0.0, 1.0, 144.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8931011569207373, "mean_inference_ms": 2.8143529116062593, "mean_action_processing_ms": 0.5115639771196525, "mean_env_wait_ms": 0.32417387267316966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019200444221496582, "StateBufferConnector_ms": 0.020696163177490234, "ViewRequirementAgentConnector_ms": 0.14359724521636963}, "num_episodes": 27, "episode_return_max": 384.0, "episode_return_min": -104.0, "episode_return_mean": 169.01, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.0452719492819, "num_env_steps_trained_throughput_per_sec": 318.0452719492819, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 13307.741, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13307.697, "sample_time_ms": 2217.435, "learn_time_ms": 11072.997, "learn_throughput": 361.239, "synch_weights_time_ms": 14.288}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "e1352_00002", "date": "2024-08-13_19-25-36", "timestamp": 1723591536, "time_this_iter_s": 12.626714706420898, "time_total_s": 1429.5758004188538, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d000d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1429.5758004188538, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 59.83888888888888, "ram_util_percent": 83.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0591461621106617, "cur_kl_coeff": 0.015820312499999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.322535378970797, "policy_loss": -0.005839005503655663, "vf_loss": 3.328023001882765, "vf_explained_var": 0.0649078609451415, "kl": 0.022210118029950238, "entropy": 1.2570428160763292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.085333349654285, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.8846448184321165, "policy_loss": -0.0021372278336750923, "vf_loss": 7.886773491662646, "vf_explained_var": 0.0004946643082553117, "kl": 0.012990108328746081, "entropy": 1.0131042418971894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -104.0, "episode_reward_mean": 160.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -343.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 61.165, "predator_policy": 19.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [73.0, 384.0, 360.0, 246.0, 306.0, -11.0, 142.0, 345.0, 75.0, 209.0, 0.0, 174.0, 14.0, 321.0, 171.0, 319.0, 317.0, 158.0, 174.0, 308.0, 0.0, 321.0, 227.0, 155.0, 323.0, 283.0, 182.0, 191.0, 81.0, 361.0, 161.0, 128.0, 54.0, 194.0, 347.0, 124.0, 356.0, 300.0, 138.0, 334.0, 175.0, 88.0, 134.0, 79.0, 22.0, 184.0, -7.0, 196.0, 330.0, 185.0, 365.0, 338.0, 5.0, 170.0, 0.0, 277.0, 63.0, 167.0, 191.0, 164.0, -25.0, 0.0, 189.0, -104.0, 213.0, 264.0, -12.0, 77.0, 102.0, 293.0, 117.0, 197.0, 203.0, -55.0, 19.0, 90.0, 216.0, 0.0, -57.0, 0.0, 309.0, 188.0, 32.0, 188.0, -66.0, 242.0, -7.0, 266.0, 86.0, -52.0, 287.0, 150.0, 391.0, -98.0, 180.0, 44.0, 211.0, 357.0, 194.0, -36.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, -302.0, 184.0, 200.0, 157.0, 191.0, 101.0, 86.0, 93.0, 179.0, 0.0, -270.0, 113.0, -4.0, 171.0, 173.0, 0.0, 75.0, 128.0, 53.0, 0.0, 0.0, 174.0, 0.0, 9.0, 0.0, 104.0, 186.0, 167.0, 0.0, 197.0, 63.0, 133.0, 176.0, 0.0, 137.0, 174.0, 0.0, 155.0, 153.0, 0.0, 0.0, 132.0, 189.0, -31.0, 158.0, 149.0, -6.0, 196.0, 97.0, 197.0, 86.0, 0.0, 176.0, 187.0, 0.0, 23.0, -2.0, 200.0, 156.0, -12.0, 167.0, 0.0, 111.0, 0.0, 0.0, 0.0, 194.0, 169.0, 167.0, 88.0, 0.0, 181.0, 166.0, 177.0, 117.0, 101.0, 0.0, 125.0, 189.0, -38.0, 193.0, 37.0, -4.0, 0.0, 124.0, 31.0, 0.0, -23.0, -79.0, 43.0, 98.0, -14.0, 0.0, 196.0, 0.0, 133.0, 180.0, 185.0, 0.0, 188.0, 168.0, 119.0, 200.0, 0.0, 2.0, 155.0, 0.0, 0.0, 0.0, 173.0, 52.0, 0.0, 61.0, 151.0, 0.0, -8.0, 188.0, 157.0, -48.0, 0.0, -50.0, 0.0, 0.0, 189.0, 0.0, -343.0, -7.0, 13.0, 200.0, 112.0, 92.0, -86.0, -38.0, -22.0, 47.0, -2.0, 98.0, 150.0, 143.0, -127.0, 173.0, 200.0, -6.0, 6.0, 151.0, -62.0, -24.0, -2.0, -69.0, -38.0, 8.0, -1.0, 129.0, 0.0, 0.0, -123.0, -79.0, 0.0, 0.0, 119.0, 186.0, -14.0, 195.0, -44.0, -10.0, 38.0, 112.0, -241.0, -4.0, 115.0, 115.0, -22.0, -91.0, 88.0, 155.0, -49.0, 65.0, -178.0, 0.0, 87.0, 170.0, 101.0, 21.0, 199.0, 192.0, -93.0, -110.0, 187.0, -16.0, -325.0, 194.0, 179.0, 32.0, 190.0, 167.0, 199.0, -10.0, -99.0, 0.0], "policy_predator_policy_reward": [138.0, 59.0, 0.0, 0.0, 0.0, 12.0, 38.0, 21.0, 34.0, 0.0, 135.0, 124.0, 19.0, 14.0, 0.0, 1.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 14.0, 17.0, 4.0, 0.0, 29.0, 30.0, 0.0, 8.0, 20.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 48.0, 9.0, 3.0, 30.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 5.0, 55.0, 5.0, 0.0, 0.0, 6.0, 17.0, 0.0, 12.0, 42.0, 0.0, 0.0, 0.0, 11.0, 36.0, 0.0, 0.0, 9.0, 1.0, 5.0, 33.0, 4.0, 6.0, 14.0, 19.0, 1.0, 0.0, 55.0, 0.0, 10.0, 27.0, 21.0, 68.0, 56.0, 39.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, 0.0, 19.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, 52.0, 0.0, 2.0, 0.0, 1.0, 15.0, 7.0, 4.0, 55.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 157.0, 89.0, 0.0, 0.0, 0.0, 60.0, 112.0, 0.0, 36.0, 16.0, 1.0, 5.0, 0.0, 0.0, 71.0, 0.0, 3.0, 0.0, 12.0, 34.0, 0.0, 31.0, 0.0, 90.0, 48.0, 72.0, 56.0, 32.0, 0.0, 0.0, 1.0, 144.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 5.0, 81.0, 2.0, 36.0, 122.0, 57.0, 0.0, 12.0, 97.0, 9.0, 3.0, 20.0, 5.0, 65.0, 2.0, 124.0, 30.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 105.0, 9.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 63.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8933932231985665, "mean_inference_ms": 2.814971113187981, "mean_action_processing_ms": 0.5062787116706211, "mean_env_wait_ms": 0.32399018839660215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014674186706542969, "StateBufferConnector_ms": 0.020574212074279785, "ViewRequirementAgentConnector_ms": 0.13795912265777588}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -104.0, "episode_return_mean": 160.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.448723822685, "num_env_steps_trained_throughput_per_sec": 335.448723822685, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 13228.76, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13228.717, "sample_time_ms": 2207.101, "learn_time_ms": 11004.794, "learn_throughput": 363.478, "synch_weights_time_ms": 14.15}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "e1352_00002", "date": "2024-08-13_19-25-48", "timestamp": 1723591548, "time_this_iter_s": 11.943128824234009, "time_total_s": 1441.5189292430878, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1441.5189292430878, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 58.99999999999999, "ram_util_percent": 80.61764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6158592223372095, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 0.00010000000000000003, "total_loss": 3.82950536838915, "policy_loss": -0.003307438598546599, "vf_loss": 3.8325133747524687, "vf_explained_var": 0.07492189284354922, "kl": 0.012618222602446237, "entropy": 1.2120095551329315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.553910775238244, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.97493253258801, "policy_loss": -0.0008780740580900952, "vf_loss": 7.975806120211486, "vf_explained_var": -0.039009890669868104, "kl": 0.00676725704336703, "entropy": 1.017564205013255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -223.0, "episode_reward_mean": 134.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -343.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 43.725, "predator_policy": 23.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.0, 308.0, 0.0, 321.0, 227.0, 155.0, 323.0, 283.0, 182.0, 191.0, 81.0, 361.0, 161.0, 128.0, 54.0, 194.0, 347.0, 124.0, 356.0, 300.0, 138.0, 334.0, 175.0, 88.0, 134.0, 79.0, 22.0, 184.0, -7.0, 196.0, 330.0, 185.0, 365.0, 338.0, 5.0, 170.0, 0.0, 277.0, 63.0, 167.0, 191.0, 164.0, -25.0, 0.0, 189.0, -104.0, 213.0, 264.0, -12.0, 77.0, 102.0, 293.0, 117.0, 197.0, 203.0, -55.0, 19.0, 90.0, 216.0, 0.0, -57.0, 0.0, 309.0, 188.0, 32.0, 188.0, -66.0, 242.0, -7.0, 266.0, 86.0, -52.0, 287.0, 150.0, 391.0, -98.0, 180.0, 44.0, 211.0, 357.0, 194.0, -36.0, 301.0, 67.0, 140.0, -223.0, -129.0, 278.0, 161.0, 140.0, 178.0, -156.0, -181.0, 191.0, 191.0, -96.0, -158.0, 163.0, -43.0, 129.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [174.0, 0.0, 155.0, 153.0, 0.0, 0.0, 132.0, 189.0, -31.0, 158.0, 149.0, -6.0, 196.0, 97.0, 197.0, 86.0, 0.0, 176.0, 187.0, 0.0, 23.0, -2.0, 200.0, 156.0, -12.0, 167.0, 0.0, 111.0, 0.0, 0.0, 0.0, 194.0, 169.0, 167.0, 88.0, 0.0, 181.0, 166.0, 177.0, 117.0, 101.0, 0.0, 125.0, 189.0, -38.0, 193.0, 37.0, -4.0, 0.0, 124.0, 31.0, 0.0, -23.0, -79.0, 43.0, 98.0, -14.0, 0.0, 196.0, 0.0, 133.0, 180.0, 185.0, 0.0, 188.0, 168.0, 119.0, 200.0, 0.0, 2.0, 155.0, 0.0, 0.0, 0.0, 173.0, 52.0, 0.0, 61.0, 151.0, 0.0, -8.0, 188.0, 157.0, -48.0, 0.0, -50.0, 0.0, 0.0, 189.0, 0.0, -343.0, -7.0, 13.0, 200.0, 112.0, 92.0, -86.0, -38.0, -22.0, 47.0, -2.0, 98.0, 150.0, 143.0, -127.0, 173.0, 200.0, -6.0, 6.0, 151.0, -62.0, -24.0, -2.0, -69.0, -38.0, 8.0, -1.0, 129.0, 0.0, 0.0, -123.0, -79.0, 0.0, 0.0, 119.0, 186.0, -14.0, 195.0, -44.0, -10.0, 38.0, 112.0, -241.0, -4.0, 115.0, 115.0, -22.0, -91.0, 88.0, 155.0, -49.0, 65.0, -178.0, 0.0, 87.0, 170.0, 101.0, 21.0, 199.0, 192.0, -93.0, -110.0, 187.0, -16.0, -325.0, 194.0, 179.0, 32.0, 190.0, 167.0, 199.0, -10.0, -99.0, 0.0, 198.0, 89.0, -28.0, 0.0, -3.0, 51.0, -229.0, -153.0, -139.0, -141.0, 196.0, 82.0, 33.0, 53.0, 128.0, -82.0, -1.0, 108.0, -128.0, -173.0, -211.0, -167.0, 0.0, 191.0, 191.0, 0.0, -229.0, -14.0, -11.0, -319.0, 54.0, 59.0, 0.0, -150.0, -40.0, 149.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 52.0, 48.0, 9.0, 3.0, 30.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 0.0, 5.0, 55.0, 5.0, 0.0, 0.0, 6.0, 17.0, 0.0, 12.0, 42.0, 0.0, 0.0, 0.0, 11.0, 36.0, 0.0, 0.0, 9.0, 1.0, 5.0, 33.0, 4.0, 6.0, 14.0, 19.0, 1.0, 0.0, 55.0, 0.0, 10.0, 27.0, 21.0, 68.0, 56.0, 39.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, 0.0, 19.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, 52.0, 0.0, 2.0, 0.0, 1.0, 15.0, 7.0, 4.0, 55.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 157.0, 89.0, 0.0, 0.0, 0.0, 60.0, 112.0, 0.0, 36.0, 16.0, 1.0, 5.0, 0.0, 0.0, 71.0, 0.0, 3.0, 0.0, 12.0, 34.0, 0.0, 31.0, 0.0, 90.0, 48.0, 72.0, 56.0, 32.0, 0.0, 0.0, 1.0, 144.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 5.0, 81.0, 2.0, 36.0, 122.0, 57.0, 0.0, 12.0, 97.0, 9.0, 3.0, 20.0, 5.0, 65.0, 2.0, 124.0, 30.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 105.0, 9.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 63.0, 13.0, 1.0, 51.0, 44.0, 92.0, 0.0, 158.0, 1.0, 15.0, 136.0, 0.0, 0.0, 30.0, 45.0, 0.0, 94.0, 71.0, 0.0, 145.0, 0.0, 37.0, 160.0, 0.0, 0.0, 0.0, 0.0, 7.0, 140.0, 172.0, 0.0, 50.0, 0.0, 107.0, 0.0, 6.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.892496985640185, "mean_inference_ms": 2.8132632216526416, "mean_action_processing_ms": 0.5018636614176155, "mean_env_wait_ms": 0.3237011259680705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014661073684692383, "StateBufferConnector_ms": 0.019344687461853027, "ViewRequirementAgentConnector_ms": 0.13388144969940186}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -223.0, "episode_return_mean": 134.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.08000905677955, "num_env_steps_trained_throughput_per_sec": 349.08000905677955, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 12516.37, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12516.328, "sample_time_ms": 2141.856, "learn_time_ms": 10358.094, "learn_throughput": 386.171, "synch_weights_time_ms": 14.258}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "e1352_00002", "date": "2024-08-13_19-26-00", "timestamp": 1723591560, "time_this_iter_s": 11.464735984802246, "time_total_s": 1452.98366522789, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d20280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1452.98366522789, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 54.54375, "ram_util_percent": 76.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7435834040796316, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 0.00010000000000000003, "total_loss": 3.554458185478493, "policy_loss": -0.0028654231682478906, "vf_loss": 3.557069287098274, "vf_explained_var": 0.10182245247578495, "kl": 0.010717183798334562, "entropy": 1.1835429933336046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.82849082781209, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.984354224028411, "policy_loss": -0.001967179107051047, "vf_loss": 7.9863180670157945, "vf_explained_var": 0.008967433278522794, "kl": 0.005088259715181208, "entropy": 1.0303104563049539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -314.0, "episode_reward_mean": 112.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": 26.82, "predator_policy": 29.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.0, 300.0, 138.0, 334.0, 175.0, 88.0, 134.0, 79.0, 22.0, 184.0, -7.0, 196.0, 330.0, 185.0, 365.0, 338.0, 5.0, 170.0, 0.0, 277.0, 63.0, 167.0, 191.0, 164.0, -25.0, 0.0, 189.0, -104.0, 213.0, 264.0, -12.0, 77.0, 102.0, 293.0, 117.0, 197.0, 203.0, -55.0, 19.0, 90.0, 216.0, 0.0, -57.0, 0.0, 309.0, 188.0, 32.0, 188.0, -66.0, 242.0, -7.0, 266.0, 86.0, -52.0, 287.0, 150.0, 391.0, -98.0, 180.0, 44.0, 211.0, 357.0, 194.0, -36.0, 301.0, 67.0, 140.0, -223.0, -129.0, 278.0, 161.0, 140.0, 178.0, -156.0, -181.0, 191.0, 191.0, -96.0, -158.0, 163.0, -43.0, 129.0, 188.0, 261.0, 177.0, -208.0, 291.0, 138.0, -143.0, 389.0, -69.0, 51.0, 107.0, -232.0, -314.0, 36.0, 248.0, 151.0, 295.0, 46.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [181.0, 166.0, 177.0, 117.0, 101.0, 0.0, 125.0, 189.0, -38.0, 193.0, 37.0, -4.0, 0.0, 124.0, 31.0, 0.0, -23.0, -79.0, 43.0, 98.0, -14.0, 0.0, 196.0, 0.0, 133.0, 180.0, 185.0, 0.0, 188.0, 168.0, 119.0, 200.0, 0.0, 2.0, 155.0, 0.0, 0.0, 0.0, 173.0, 52.0, 0.0, 61.0, 151.0, 0.0, -8.0, 188.0, 157.0, -48.0, 0.0, -50.0, 0.0, 0.0, 189.0, 0.0, -343.0, -7.0, 13.0, 200.0, 112.0, 92.0, -86.0, -38.0, -22.0, 47.0, -2.0, 98.0, 150.0, 143.0, -127.0, 173.0, 200.0, -6.0, 6.0, 151.0, -62.0, -24.0, -2.0, -69.0, -38.0, 8.0, -1.0, 129.0, 0.0, 0.0, -123.0, -79.0, 0.0, 0.0, 119.0, 186.0, -14.0, 195.0, -44.0, -10.0, 38.0, 112.0, -241.0, -4.0, 115.0, 115.0, -22.0, -91.0, 88.0, 155.0, -49.0, 65.0, -178.0, 0.0, 87.0, 170.0, 101.0, 21.0, 199.0, 192.0, -93.0, -110.0, 187.0, -16.0, -325.0, 194.0, 179.0, 32.0, 190.0, 167.0, 199.0, -10.0, -99.0, 0.0, 198.0, 89.0, -28.0, 0.0, -3.0, 51.0, -229.0, -153.0, -139.0, -141.0, 196.0, 82.0, 33.0, 53.0, 128.0, -82.0, -1.0, 108.0, -128.0, -173.0, -211.0, -167.0, 0.0, 191.0, 191.0, 0.0, -229.0, -14.0, -11.0, -319.0, 54.0, 59.0, 0.0, -150.0, -40.0, 149.0, -10.0, 193.0, 89.0, 172.0, 1.0, 152.0, -337.0, -57.0, 116.0, 175.0, -24.0, 125.0, -131.0, -161.0, 191.0, 198.0, 3.0, -216.0, -242.0, 145.0, 68.0, -58.0, -181.0, -355.0, -271.0, -247.0, -30.0, 0.0, 77.0, 138.0, 133.0, 0.0, 148.0, 115.0, 0.0, -27.0], "policy_predator_policy_reward": [0.0, 9.0, 1.0, 5.0, 33.0, 4.0, 6.0, 14.0, 19.0, 1.0, 0.0, 55.0, 0.0, 10.0, 27.0, 21.0, 68.0, 56.0, 39.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, 0.0, 19.0, 3.0, 0.0, 0.0, 15.0, 0.0, 0.0, 52.0, 0.0, 2.0, 0.0, 1.0, 15.0, 7.0, 4.0, 55.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 157.0, 89.0, 0.0, 0.0, 0.0, 60.0, 112.0, 0.0, 36.0, 16.0, 1.0, 5.0, 0.0, 0.0, 71.0, 0.0, 3.0, 0.0, 12.0, 34.0, 0.0, 31.0, 0.0, 90.0, 48.0, 72.0, 56.0, 32.0, 0.0, 0.0, 1.0, 144.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 5.0, 81.0, 2.0, 36.0, 122.0, 57.0, 0.0, 12.0, 97.0, 9.0, 3.0, 20.0, 5.0, 65.0, 2.0, 124.0, 30.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 105.0, 9.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 63.0, 13.0, 1.0, 51.0, 44.0, 92.0, 0.0, 158.0, 1.0, 15.0, 136.0, 0.0, 0.0, 30.0, 45.0, 0.0, 94.0, 71.0, 0.0, 145.0, 0.0, 37.0, 160.0, 0.0, 0.0, 0.0, 0.0, 7.0, 140.0, 172.0, 0.0, 50.0, 0.0, 107.0, 0.0, 6.0, 14.0, 0.0, 5.0, 0.0, 0.0, 8.0, 16.0, 186.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 149.0, 0.0, 0.0, 11.0, 133.0, 147.0, 1.0, 0.0, 97.0, 137.0, 167.0, 55.0, 149.0, 21.0, 45.0, 5.0, 28.0, 0.0, 18.0, 0.0, 32.0, 8.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8914264599433959, "mean_inference_ms": 2.809471491121416, "mean_action_processing_ms": 0.497430760101119, "mean_env_wait_ms": 0.3230474702018425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006795406341552734, "StateBufferConnector_ms": 0.01923549175262451, "ViewRequirementAgentConnector_ms": 0.13163363933563232}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -314.0, "episode_return_mean": 112.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.25819439386765, "num_env_steps_trained_throughput_per_sec": 357.25819439386765, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 12020.767, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12020.725, "sample_time_ms": 1901.434, "learn_time_ms": 10103.557, "learn_throughput": 395.9, "synch_weights_time_ms": 14.058}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "e1352_00002", "date": "2024-08-13_19-26-11", "timestamp": 1723591571, "time_this_iter_s": 11.201253890991211, "time_total_s": 1464.1849191188812, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d20430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1464.1849191188812, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 51.5125, "ram_util_percent": 76.45625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.225615306277439, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 0.00010000000000000003, "total_loss": 3.4128529398529617, "policy_loss": -0.0026090593722762254, "vf_loss": 3.4153041554506496, "vf_explained_var": 0.05314754673412868, "kl": 0.006651805127328551, "entropy": 1.169453722774667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.481934087207076, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.020653169874161, "policy_loss": -0.0008218177354022387, "vf_loss": 7.02147107830754, "vf_explained_var": 0.045947718935668784, "kl": 0.005945737192692473, "entropy": 1.0852405649959727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -314.0, "episode_reward_mean": 96.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": 14.74, "predator_policy": 33.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0, 164.0, -25.0, 0.0, 189.0, -104.0, 213.0, 264.0, -12.0, 77.0, 102.0, 293.0, 117.0, 197.0, 203.0, -55.0, 19.0, 90.0, 216.0, 0.0, -57.0, 0.0, 309.0, 188.0, 32.0, 188.0, -66.0, 242.0, -7.0, 266.0, 86.0, -52.0, 287.0, 150.0, 391.0, -98.0, 180.0, 44.0, 211.0, 357.0, 194.0, -36.0, 301.0, 67.0, 140.0, -223.0, -129.0, 278.0, 161.0, 140.0, 178.0, -156.0, -181.0, 191.0, 191.0, -96.0, -158.0, 163.0, -43.0, 129.0, 188.0, 261.0, 177.0, -208.0, 291.0, 138.0, -143.0, 389.0, -69.0, 51.0, 107.0, -232.0, -314.0, 36.0, 248.0, 151.0, 295.0, 46.0, -49.0, -2.0, 76.0, 274.0, 196.0, 122.0, 361.0, 169.0, -308.0, 190.0, 75.0, 194.0, 68.0, 292.0, 263.0, -147.0, 7.0, 150.0, -29.0, -39.0, 371.0, 54.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, 188.0, 157.0, -48.0, 0.0, -50.0, 0.0, 0.0, 189.0, 0.0, -343.0, -7.0, 13.0, 200.0, 112.0, 92.0, -86.0, -38.0, -22.0, 47.0, -2.0, 98.0, 150.0, 143.0, -127.0, 173.0, 200.0, -6.0, 6.0, 151.0, -62.0, -24.0, -2.0, -69.0, -38.0, 8.0, -1.0, 129.0, 0.0, 0.0, -123.0, -79.0, 0.0, 0.0, 119.0, 186.0, -14.0, 195.0, -44.0, -10.0, 38.0, 112.0, -241.0, -4.0, 115.0, 115.0, -22.0, -91.0, 88.0, 155.0, -49.0, 65.0, -178.0, 0.0, 87.0, 170.0, 101.0, 21.0, 199.0, 192.0, -93.0, -110.0, 187.0, -16.0, -325.0, 194.0, 179.0, 32.0, 190.0, 167.0, 199.0, -10.0, -99.0, 0.0, 198.0, 89.0, -28.0, 0.0, -3.0, 51.0, -229.0, -153.0, -139.0, -141.0, 196.0, 82.0, 33.0, 53.0, 128.0, -82.0, -1.0, 108.0, -128.0, -173.0, -211.0, -167.0, 0.0, 191.0, 191.0, 0.0, -229.0, -14.0, -11.0, -319.0, 54.0, 59.0, 0.0, -150.0, -40.0, 149.0, -10.0, 193.0, 89.0, 172.0, 1.0, 152.0, -337.0, -57.0, 116.0, 175.0, -24.0, 125.0, -131.0, -161.0, 191.0, 198.0, 3.0, -216.0, -242.0, 145.0, 68.0, -58.0, -181.0, -355.0, -271.0, -247.0, -30.0, 0.0, 77.0, 138.0, 133.0, 0.0, 148.0, 115.0, 0.0, -27.0, -131.0, 0.0, 0.0, -101.0, 34.0, 0.0, 42.0, 192.0, 0.0, 196.0, 101.0, -14.0, 172.0, 189.0, 156.0, -14.0, -311.0, -194.0, 44.0, 92.0, 0.0, 18.0, 194.0, 0.0, -13.0, 5.0, 142.0, 124.0, 109.0, 126.0, 0.0, -306.0, -236.0, 96.0, 142.0, -90.0, -4.0, -54.0, -154.0, -2.0, 176.0, 193.0, 52.0, 0.0], "policy_predator_policy_reward": [7.0, 4.0, 55.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 157.0, 89.0, 0.0, 0.0, 0.0, 60.0, 112.0, 0.0, 36.0, 16.0, 1.0, 5.0, 0.0, 0.0, 71.0, 0.0, 3.0, 0.0, 12.0, 34.0, 0.0, 31.0, 0.0, 90.0, 48.0, 72.0, 56.0, 32.0, 0.0, 0.0, 1.0, 144.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 5.0, 81.0, 2.0, 36.0, 122.0, 57.0, 0.0, 12.0, 97.0, 9.0, 3.0, 20.0, 5.0, 65.0, 2.0, 124.0, 30.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 105.0, 9.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 63.0, 13.0, 1.0, 51.0, 44.0, 92.0, 0.0, 158.0, 1.0, 15.0, 136.0, 0.0, 0.0, 30.0, 45.0, 0.0, 94.0, 71.0, 0.0, 145.0, 0.0, 37.0, 160.0, 0.0, 0.0, 0.0, 0.0, 7.0, 140.0, 172.0, 0.0, 50.0, 0.0, 107.0, 0.0, 6.0, 14.0, 0.0, 5.0, 0.0, 0.0, 8.0, 16.0, 186.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 149.0, 0.0, 0.0, 11.0, 133.0, 147.0, 1.0, 0.0, 97.0, 137.0, 167.0, 55.0, 149.0, 21.0, 45.0, 5.0, 28.0, 0.0, 18.0, 0.0, 32.0, 8.0, 65.0, 82.0, 0.0, 0.0, 99.0, 42.0, 0.0, 40.0, 0.0, 0.0, 0.0, 28.0, 7.0, 0.0, 0.0, 16.0, 11.0, 19.0, 178.0, 54.0, 0.0, 57.0, 0.0, 0.0, 0.0, 43.0, 33.0, 13.0, 13.0, 28.0, 0.0, 0.0, 159.0, 9.0, 138.0, 11.0, 87.0, 24.0, 5.0, 5.0, 112.0, 0.0, 2.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8861029430087083, "mean_inference_ms": 2.7908111025954794, "mean_action_processing_ms": 0.49092276695210996, "mean_env_wait_ms": 0.3203782203907854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007034420967102051, "StateBufferConnector_ms": 0.013830304145812988, "ViewRequirementAgentConnector_ms": 0.11430370807647705}, "num_episodes": 22, "episode_return_max": 391.0, "episode_return_min": -314.0, "episode_return_mean": 96.01, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.96003511536685, "num_env_steps_trained_throughput_per_sec": 347.96003511536685, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 11949.284, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11949.239, "sample_time_ms": 1865.317, "learn_time_ms": 10067.778, "learn_throughput": 397.307, "synch_weights_time_ms": 14.544}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "e1352_00002", "date": "2024-08-13_19-26-22", "timestamp": 1723591582, "time_this_iter_s": 11.503257036209106, "time_total_s": 1475.6881761550903, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1475.6881761550903, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 50.2375, "ram_util_percent": 76.88125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9267327389862172, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 0.00010000000000000003, "total_loss": 3.913899923758532, "policy_loss": -0.007466496212319249, "vf_loss": 3.920789254279364, "vf_explained_var": 0.07124278207935353, "kl": 0.024322036189236555, "entropy": 1.1658816747564487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.85277719183889, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.47872780643443, "policy_loss": -0.0019284093461773067, "vf_loss": 7.480649714999728, "vf_explained_var": -0.06692490325402961, "kl": 0.009867903860296665, "entropy": 1.060682105071961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -314.0, "episode_reward_mean": 94.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 11.42, "predator_policy": 35.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.0, 32.0, 188.0, -66.0, 242.0, -7.0, 266.0, 86.0, -52.0, 287.0, 150.0, 391.0, -98.0, 180.0, 44.0, 211.0, 357.0, 194.0, -36.0, 301.0, 67.0, 140.0, -223.0, -129.0, 278.0, 161.0, 140.0, 178.0, -156.0, -181.0, 191.0, 191.0, -96.0, -158.0, 163.0, -43.0, 129.0, 188.0, 261.0, 177.0, -208.0, 291.0, 138.0, -143.0, 389.0, -69.0, 51.0, 107.0, -232.0, -314.0, 36.0, 248.0, 151.0, 295.0, 46.0, -49.0, -2.0, 76.0, 274.0, 196.0, 122.0, 361.0, 169.0, -308.0, 190.0, 75.0, 194.0, 68.0, 292.0, 263.0, -147.0, 7.0, 150.0, -29.0, -39.0, 371.0, 54.0, 199.0, 129.0, -200.0, -31.0, -79.0, -72.0, 112.0, 72.0, 244.0, 370.0, -55.0, 117.0, 144.0, 184.0, -101.0, 187.0, 134.0, 241.0, -24.0, 385.0, 110.0, 180.0, 23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 195.0, -44.0, -10.0, 38.0, 112.0, -241.0, -4.0, 115.0, 115.0, -22.0, -91.0, 88.0, 155.0, -49.0, 65.0, -178.0, 0.0, 87.0, 170.0, 101.0, 21.0, 199.0, 192.0, -93.0, -110.0, 187.0, -16.0, -325.0, 194.0, 179.0, 32.0, 190.0, 167.0, 199.0, -10.0, -99.0, 0.0, 198.0, 89.0, -28.0, 0.0, -3.0, 51.0, -229.0, -153.0, -139.0, -141.0, 196.0, 82.0, 33.0, 53.0, 128.0, -82.0, -1.0, 108.0, -128.0, -173.0, -211.0, -167.0, 0.0, 191.0, 191.0, 0.0, -229.0, -14.0, -11.0, -319.0, 54.0, 59.0, 0.0, -150.0, -40.0, 149.0, -10.0, 193.0, 89.0, 172.0, 1.0, 152.0, -337.0, -57.0, 116.0, 175.0, -24.0, 125.0, -131.0, -161.0, 191.0, 198.0, 3.0, -216.0, -242.0, 145.0, 68.0, -58.0, -181.0, -355.0, -271.0, -247.0, -30.0, 0.0, 77.0, 138.0, 133.0, 0.0, 148.0, 115.0, 0.0, -27.0, -131.0, 0.0, 0.0, -101.0, 34.0, 0.0, 42.0, 192.0, 0.0, 196.0, 101.0, -14.0, 172.0, 189.0, 156.0, -14.0, -311.0, -194.0, 44.0, 92.0, 0.0, 18.0, 194.0, 0.0, -13.0, 5.0, 142.0, 124.0, 109.0, 126.0, 0.0, -306.0, -236.0, 96.0, 142.0, -90.0, -4.0, -54.0, -154.0, -2.0, 176.0, 193.0, 52.0, 0.0, 0.0, 199.0, -2.0, 104.0, -130.0, -264.0, 0.0, -158.0, 0.0, -192.0, 106.0, -379.0, 0.0, 112.0, 20.0, -4.0, 116.0, 107.0, 200.0, 155.0, 67.0, -362.0, 0.0, 89.0, 50.0, 72.0, 14.0, 110.0, -153.0, -85.0, 187.0, 0.0, -115.0, 132.0, 156.0, 11.0, -81.0, -59.0, 193.0, 192.0, -26.0, 64.0, 0.0, 180.0, -64.0, 0.0], "policy_predator_policy_reward": [0.0, 7.0, 5.0, 81.0, 2.0, 36.0, 122.0, 57.0, 0.0, 12.0, 97.0, 9.0, 3.0, 20.0, 5.0, 65.0, 2.0, 124.0, 30.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 105.0, 9.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 63.0, 13.0, 1.0, 51.0, 44.0, 92.0, 0.0, 158.0, 1.0, 15.0, 136.0, 0.0, 0.0, 30.0, 45.0, 0.0, 94.0, 71.0, 0.0, 145.0, 0.0, 37.0, 160.0, 0.0, 0.0, 0.0, 0.0, 7.0, 140.0, 172.0, 0.0, 50.0, 0.0, 107.0, 0.0, 6.0, 14.0, 0.0, 5.0, 0.0, 0.0, 8.0, 16.0, 186.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 149.0, 0.0, 0.0, 11.0, 133.0, 147.0, 1.0, 0.0, 97.0, 137.0, 167.0, 55.0, 149.0, 21.0, 45.0, 5.0, 28.0, 0.0, 18.0, 0.0, 32.0, 8.0, 65.0, 82.0, 0.0, 0.0, 99.0, 42.0, 0.0, 40.0, 0.0, 0.0, 0.0, 28.0, 7.0, 0.0, 0.0, 16.0, 11.0, 19.0, 178.0, 54.0, 0.0, 57.0, 0.0, 0.0, 0.0, 43.0, 33.0, 13.0, 13.0, 28.0, 0.0, 0.0, 159.0, 9.0, 138.0, 11.0, 87.0, 24.0, 5.0, 5.0, 112.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 1.0, 26.0, 2.0, 192.0, 17.0, 110.0, 0.0, 113.0, 5.0, 196.0, 0.0, 0.0, 13.0, 43.0, 0.0, 21.0, 0.0, 15.0, 193.0, 47.0, 28.0, 0.0, 22.0, 0.0, 0.0, 60.0, 106.0, 31.0, 0.0, 0.0, 0.0, 117.0, 63.0, 11.0, 20.0, 96.0, 0.0, 0.0, 0.0, 72.0, 0.0, 0.0, 87.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.879708815839549, "mean_inference_ms": 2.774371389652178, "mean_action_processing_ms": 0.48361073460761567, "mean_env_wait_ms": 0.3177069958632748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004513144493103027, "StateBufferConnector_ms": 0.0033730268478393555, "ViewRequirementAgentConnector_ms": 0.11471354961395264}, "num_episodes": 23, "episode_return_max": 391.0, "episode_return_min": -314.0, "episode_return_mean": 94.79, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.89630739765613, "num_env_steps_trained_throughput_per_sec": 346.89630739765613, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 11901.909, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11901.863, "sample_time_ms": 1838.973, "learn_time_ms": 10046.107, "learn_throughput": 398.164, "synch_weights_time_ms": 15.052}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "e1352_00002", "date": "2024-08-13_19-26-34", "timestamp": 1723591594, "time_this_iter_s": 11.582118034362793, "time_total_s": 1487.2702941894531, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb34c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1487.2702941894531, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 51.11176470588236, "ram_util_percent": 79.61176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9102136341115785, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 3.3399710050966376, "policy_loss": -0.0023196529434432113, "vf_loss": 3.3419420339443064, "vf_explained_var": 0.09012554508668405, "kl": 0.009793997860761346, "entropy": 1.2415223110920537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.650626410315276, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.419246124590515, "policy_loss": -0.0013628751454658058, "vf_loss": 8.420601584671667, "vf_explained_var": 0.05342808201830223, "kl": 0.011234832367367331, "entropy": 0.9399519355839523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -314.0, "episode_reward_mean": 99.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 13.03, "predator_policy": 36.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.0, 301.0, 67.0, 140.0, -223.0, -129.0, 278.0, 161.0, 140.0, 178.0, -156.0, -181.0, 191.0, 191.0, -96.0, -158.0, 163.0, -43.0, 129.0, 188.0, 261.0, 177.0, -208.0, 291.0, 138.0, -143.0, 389.0, -69.0, 51.0, 107.0, -232.0, -314.0, 36.0, 248.0, 151.0, 295.0, 46.0, -49.0, -2.0, 76.0, 274.0, 196.0, 122.0, 361.0, 169.0, -308.0, 190.0, 75.0, 194.0, 68.0, 292.0, 263.0, -147.0, 7.0, 150.0, -29.0, -39.0, 371.0, 54.0, 199.0, 129.0, -200.0, -31.0, -79.0, -72.0, 112.0, 72.0, 244.0, 370.0, -55.0, 117.0, 144.0, 184.0, -101.0, 187.0, 134.0, 241.0, -24.0, 385.0, 110.0, 180.0, 23.0, 371.0, 133.0, 225.0, 388.0, 140.0, 310.0, -26.0, 142.0, 93.0, 206.0, 162.0, 245.0, 108.0, 309.0, 159.0, 190.0, -243.0, 139.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-99.0, 0.0, 198.0, 89.0, -28.0, 0.0, -3.0, 51.0, -229.0, -153.0, -139.0, -141.0, 196.0, 82.0, 33.0, 53.0, 128.0, -82.0, -1.0, 108.0, -128.0, -173.0, -211.0, -167.0, 0.0, 191.0, 191.0, 0.0, -229.0, -14.0, -11.0, -319.0, 54.0, 59.0, 0.0, -150.0, -40.0, 149.0, -10.0, 193.0, 89.0, 172.0, 1.0, 152.0, -337.0, -57.0, 116.0, 175.0, -24.0, 125.0, -131.0, -161.0, 191.0, 198.0, 3.0, -216.0, -242.0, 145.0, 68.0, -58.0, -181.0, -355.0, -271.0, -247.0, -30.0, 0.0, 77.0, 138.0, 133.0, 0.0, 148.0, 115.0, 0.0, -27.0, -131.0, 0.0, 0.0, -101.0, 34.0, 0.0, 42.0, 192.0, 0.0, 196.0, 101.0, -14.0, 172.0, 189.0, 156.0, -14.0, -311.0, -194.0, 44.0, 92.0, 0.0, 18.0, 194.0, 0.0, -13.0, 5.0, 142.0, 124.0, 109.0, 126.0, 0.0, -306.0, -236.0, 96.0, 142.0, -90.0, -4.0, -54.0, -154.0, -2.0, 176.0, 193.0, 52.0, 0.0, 0.0, 199.0, -2.0, 104.0, -130.0, -264.0, 0.0, -158.0, 0.0, -192.0, 106.0, -379.0, 0.0, 112.0, 20.0, -4.0, 116.0, 107.0, 200.0, 155.0, 67.0, -362.0, 0.0, 89.0, 50.0, 72.0, 14.0, 110.0, -153.0, -85.0, 187.0, 0.0, -115.0, 132.0, 156.0, 11.0, -81.0, -59.0, 193.0, 192.0, -26.0, 64.0, 0.0, 180.0, -64.0, 0.0, 199.0, 172.0, 160.0, -132.0, 105.0, 97.0, 200.0, 188.0, -55.0, 110.0, 184.0, 94.0, -214.0, 50.0, 175.0, -128.0, 40.0, 0.0, 63.0, 78.0, 162.0, 0.0, 27.0, 175.0, 94.0, -70.0, 121.0, 152.0, 162.0, -26.0, 119.0, 71.0, -249.0, -343.0, 135.0, 0.0], "policy_predator_policy_reward": [0.0, 63.0, 13.0, 1.0, 51.0, 44.0, 92.0, 0.0, 158.0, 1.0, 15.0, 136.0, 0.0, 0.0, 30.0, 45.0, 0.0, 94.0, 71.0, 0.0, 145.0, 0.0, 37.0, 160.0, 0.0, 0.0, 0.0, 0.0, 7.0, 140.0, 172.0, 0.0, 50.0, 0.0, 107.0, 0.0, 6.0, 14.0, 0.0, 5.0, 0.0, 0.0, 8.0, 16.0, 186.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 149.0, 0.0, 0.0, 11.0, 133.0, 147.0, 1.0, 0.0, 97.0, 137.0, 167.0, 55.0, 149.0, 21.0, 45.0, 5.0, 28.0, 0.0, 18.0, 0.0, 32.0, 8.0, 65.0, 82.0, 0.0, 0.0, 99.0, 42.0, 0.0, 40.0, 0.0, 0.0, 0.0, 28.0, 7.0, 0.0, 0.0, 16.0, 11.0, 19.0, 178.0, 54.0, 0.0, 57.0, 0.0, 0.0, 0.0, 43.0, 33.0, 13.0, 13.0, 28.0, 0.0, 0.0, 159.0, 9.0, 138.0, 11.0, 87.0, 24.0, 5.0, 5.0, 112.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 1.0, 26.0, 2.0, 192.0, 17.0, 110.0, 0.0, 113.0, 5.0, 196.0, 0.0, 0.0, 13.0, 43.0, 0.0, 21.0, 0.0, 15.0, 193.0, 47.0, 28.0, 0.0, 22.0, 0.0, 0.0, 60.0, 106.0, 31.0, 0.0, 0.0, 0.0, 117.0, 63.0, 11.0, 20.0, 96.0, 0.0, 0.0, 0.0, 72.0, 0.0, 0.0, 87.0, 0.0, 0.0, 0.0, 14.0, 91.0, 0.0, 23.0, 0.0, 0.0, 85.0, 0.0, 0.0, 32.0, 1.0, 137.0, 18.0, 77.0, 53.0, 0.0, 55.0, 10.0, 0.0, 0.0, 1.0, 42.0, 84.0, 0.0, 0.0, 36.0, 10.0, 13.0, 0.0, 0.0, 179.0, 170.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8741507678822709, "mean_inference_ms": 2.7566518006715706, "mean_action_processing_ms": 0.47803818105124085, "mean_env_wait_ms": 0.3152193743741603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004485726356506348, "StateBufferConnector_ms": 0.0033701658248901367, "ViewRequirementAgentConnector_ms": 0.11456084251403809}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": -314.0, "episode_return_mean": 99.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.56958824155714, "num_env_steps_trained_throughput_per_sec": 338.56958824155714, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 11928.914, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11928.868, "sample_time_ms": 1812.608, "learn_time_ms": 10098.63, "learn_throughput": 396.093, "synch_weights_time_ms": 15.737}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "e1352_00002", "date": "2024-08-13_19-26-46", "timestamp": 1723591606, "time_this_iter_s": 11.907110214233398, "time_total_s": 1499.1774044036865, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d62670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1499.1774044036865, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 50.25882352941176, "ram_util_percent": 81.07058823529411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.258101441478603, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 3.3785299293578617, "policy_loss": -0.002487109817327961, "vf_loss": 3.3803792525851537, "vf_explained_var": 0.0990759326036645, "kl": 0.017917592179009064, "entropy": 1.2079641503631753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.094139042496682, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.265491218920107, "policy_loss": -0.0005988847796938249, "vf_loss": 7.266082643327259, "vf_explained_var": 0.11055686726141228, "kl": 0.01135261049386123, "entropy": 1.0042761233748583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -314.0, "episode_reward_mean": 115.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 23.825, "predator_policy": 33.835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.0, 188.0, 261.0, 177.0, -208.0, 291.0, 138.0, -143.0, 389.0, -69.0, 51.0, 107.0, -232.0, -314.0, 36.0, 248.0, 151.0, 295.0, 46.0, -49.0, -2.0, 76.0, 274.0, 196.0, 122.0, 361.0, 169.0, -308.0, 190.0, 75.0, 194.0, 68.0, 292.0, 263.0, -147.0, 7.0, 150.0, -29.0, -39.0, 371.0, 54.0, 199.0, 129.0, -200.0, -31.0, -79.0, -72.0, 112.0, 72.0, 244.0, 370.0, -55.0, 117.0, 144.0, 184.0, -101.0, 187.0, 134.0, 241.0, -24.0, 385.0, 110.0, 180.0, 23.0, 371.0, 133.0, 225.0, 388.0, 140.0, 310.0, -26.0, 142.0, 93.0, 206.0, 162.0, 245.0, 108.0, 309.0, 159.0, 190.0, -243.0, 139.0, -179.0, 335.0, 314.0, 158.0, 318.0, -22.0, -107.0, 54.0, 132.0, 58.0, 264.0, 199.0, 161.0, 263.0, 255.0, 92.0, -192.0, 280.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.0, 149.0, -10.0, 193.0, 89.0, 172.0, 1.0, 152.0, -337.0, -57.0, 116.0, 175.0, -24.0, 125.0, -131.0, -161.0, 191.0, 198.0, 3.0, -216.0, -242.0, 145.0, 68.0, -58.0, -181.0, -355.0, -271.0, -247.0, -30.0, 0.0, 77.0, 138.0, 133.0, 0.0, 148.0, 115.0, 0.0, -27.0, -131.0, 0.0, 0.0, -101.0, 34.0, 0.0, 42.0, 192.0, 0.0, 196.0, 101.0, -14.0, 172.0, 189.0, 156.0, -14.0, -311.0, -194.0, 44.0, 92.0, 0.0, 18.0, 194.0, 0.0, -13.0, 5.0, 142.0, 124.0, 109.0, 126.0, 0.0, -306.0, -236.0, 96.0, 142.0, -90.0, -4.0, -54.0, -154.0, -2.0, 176.0, 193.0, 52.0, 0.0, 0.0, 199.0, -2.0, 104.0, -130.0, -264.0, 0.0, -158.0, 0.0, -192.0, 106.0, -379.0, 0.0, 112.0, 20.0, -4.0, 116.0, 107.0, 200.0, 155.0, 67.0, -362.0, 0.0, 89.0, 50.0, 72.0, 14.0, 110.0, -153.0, -85.0, 187.0, 0.0, -115.0, 132.0, 156.0, 11.0, -81.0, -59.0, 193.0, 192.0, -26.0, 64.0, 0.0, 180.0, -64.0, 0.0, 199.0, 172.0, 160.0, -132.0, 105.0, 97.0, 200.0, 188.0, -55.0, 110.0, 184.0, 94.0, -214.0, 50.0, 175.0, -128.0, 40.0, 0.0, 63.0, 78.0, 162.0, 0.0, 27.0, 175.0, 94.0, -70.0, 121.0, 152.0, 162.0, -26.0, 119.0, 71.0, -249.0, -343.0, 135.0, 0.0, -138.0, -225.0, 179.0, 134.0, 110.0, 165.0, 139.0, 0.0, 200.0, 118.0, -44.0, 0.0, -102.0, -180.0, -19.0, 0.0, 0.0, 123.0, 0.0, 0.0, 78.0, 179.0, 187.0, 12.0, 0.0, 142.0, 121.0, 113.0, 157.0, 47.0, -140.0, 162.0, -355.0, -82.0, 68.0, 166.0], "policy_predator_policy_reward": [6.0, 14.0, 0.0, 5.0, 0.0, 0.0, 8.0, 16.0, 186.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 149.0, 0.0, 0.0, 11.0, 133.0, 147.0, 1.0, 0.0, 97.0, 137.0, 167.0, 55.0, 149.0, 21.0, 45.0, 5.0, 28.0, 0.0, 18.0, 0.0, 32.0, 8.0, 65.0, 82.0, 0.0, 0.0, 99.0, 42.0, 0.0, 40.0, 0.0, 0.0, 0.0, 28.0, 7.0, 0.0, 0.0, 16.0, 11.0, 19.0, 178.0, 54.0, 0.0, 57.0, 0.0, 0.0, 0.0, 43.0, 33.0, 13.0, 13.0, 28.0, 0.0, 0.0, 159.0, 9.0, 138.0, 11.0, 87.0, 24.0, 5.0, 5.0, 112.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 1.0, 26.0, 2.0, 192.0, 17.0, 110.0, 0.0, 113.0, 5.0, 196.0, 0.0, 0.0, 13.0, 43.0, 0.0, 21.0, 0.0, 15.0, 193.0, 47.0, 28.0, 0.0, 22.0, 0.0, 0.0, 60.0, 106.0, 31.0, 0.0, 0.0, 0.0, 117.0, 63.0, 11.0, 20.0, 96.0, 0.0, 0.0, 0.0, 72.0, 0.0, 0.0, 87.0, 0.0, 0.0, 0.0, 14.0, 91.0, 0.0, 23.0, 0.0, 0.0, 85.0, 0.0, 0.0, 32.0, 1.0, 137.0, 18.0, 77.0, 53.0, 0.0, 55.0, 10.0, 0.0, 0.0, 1.0, 42.0, 84.0, 0.0, 0.0, 36.0, 10.0, 13.0, 0.0, 0.0, 179.0, 170.0, 0.0, 4.0, 63.0, 121.0, 22.0, 0.0, 31.0, 8.0, 7.0, 12.0, 0.0, 0.0, 0.0, 22.0, 36.0, 139.0, 0.0, 73.0, 1.0, 8.0, 0.0, 58.0, 0.0, 7.0, 0.0, 0.0, 6.0, 13.0, 0.0, 29.0, 0.0, 51.0, 70.0, 0.0, 193.0, 52.0, 46.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8701297475518903, "mean_inference_ms": 2.7456960626158433, "mean_action_processing_ms": 0.47343757391609853, "mean_env_wait_ms": 0.3137148583675435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00480961799621582, "StateBufferConnector_ms": 0.003406047821044922, "ViewRequirementAgentConnector_ms": 0.11556732654571533}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": -314.0, "episode_return_mean": 115.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.54353805076227, "num_env_steps_trained_throughput_per_sec": 278.54353805076227, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 12152.089, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12152.04, "sample_time_ms": 1846.367, "learn_time_ms": 10288.469, "learn_throughput": 388.785, "synch_weights_time_ms": 14.857}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "e1352_00002", "date": "2024-08-13_19-27-00", "timestamp": 1723591620, "time_this_iter_s": 14.413019895553589, "time_total_s": 1513.59042429924, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d628b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1513.59042429924, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 66.82000000000001, "ram_util_percent": 83.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4437829436685043, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 4.365152885800316, "policy_loss": -0.002377941527418674, "vf_loss": 4.367069002307912, "vf_explained_var": 0.09006165707552874, "kl": 0.012973793066856656, "entropy": 1.1311682792567703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.688661138926232, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.85566269380075, "policy_loss": -0.0002323949062782857, "vf_loss": 7.855889771476624, "vf_explained_var": -0.13736392578119955, "kl": 0.008071512460804139, "entropy": 0.9646273152222709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -318.0, "episode_reward_mean": 121.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 28.005, "predator_policy": 32.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.0, 196.0, 122.0, 361.0, 169.0, -308.0, 190.0, 75.0, 194.0, 68.0, 292.0, 263.0, -147.0, 7.0, 150.0, -29.0, -39.0, 371.0, 54.0, 199.0, 129.0, -200.0, -31.0, -79.0, -72.0, 112.0, 72.0, 244.0, 370.0, -55.0, 117.0, 144.0, 184.0, -101.0, 187.0, 134.0, 241.0, -24.0, 385.0, 110.0, 180.0, 23.0, 371.0, 133.0, 225.0, 388.0, 140.0, 310.0, -26.0, 142.0, 93.0, 206.0, 162.0, 245.0, 108.0, 309.0, 159.0, 190.0, -243.0, 139.0, -179.0, 335.0, 314.0, 158.0, 318.0, -22.0, -107.0, 54.0, 132.0, 58.0, 264.0, 199.0, 161.0, 263.0, 255.0, 92.0, -192.0, 280.0, 270.0, 59.0, 255.0, -318.0, -8.0, 158.0, 344.0, 257.0, 81.0, 193.0, -111.0, 75.0, 221.0, 35.0, 19.0, -21.0, 298.0, 131.0, 46.0, 67.0, 123.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [42.0, 192.0, 0.0, 196.0, 101.0, -14.0, 172.0, 189.0, 156.0, -14.0, -311.0, -194.0, 44.0, 92.0, 0.0, 18.0, 194.0, 0.0, -13.0, 5.0, 142.0, 124.0, 109.0, 126.0, 0.0, -306.0, -236.0, 96.0, 142.0, -90.0, -4.0, -54.0, -154.0, -2.0, 176.0, 193.0, 52.0, 0.0, 0.0, 199.0, -2.0, 104.0, -130.0, -264.0, 0.0, -158.0, 0.0, -192.0, 106.0, -379.0, 0.0, 112.0, 20.0, -4.0, 116.0, 107.0, 200.0, 155.0, 67.0, -362.0, 0.0, 89.0, 50.0, 72.0, 14.0, 110.0, -153.0, -85.0, 187.0, 0.0, -115.0, 132.0, 156.0, 11.0, -81.0, -59.0, 193.0, 192.0, -26.0, 64.0, 0.0, 180.0, -64.0, 0.0, 199.0, 172.0, 160.0, -132.0, 105.0, 97.0, 200.0, 188.0, -55.0, 110.0, 184.0, 94.0, -214.0, 50.0, 175.0, -128.0, 40.0, 0.0, 63.0, 78.0, 162.0, 0.0, 27.0, 175.0, 94.0, -70.0, 121.0, 152.0, 162.0, -26.0, 119.0, 71.0, -249.0, -343.0, 135.0, 0.0, -138.0, -225.0, 179.0, 134.0, 110.0, 165.0, 139.0, 0.0, 200.0, 118.0, -44.0, 0.0, -102.0, -180.0, -19.0, 0.0, 0.0, 123.0, 0.0, 0.0, 78.0, 179.0, 187.0, 12.0, 0.0, 142.0, 121.0, 113.0, 157.0, 47.0, -140.0, 162.0, -355.0, -82.0, 68.0, 166.0, 115.0, 126.0, -180.0, 101.0, 164.0, 43.0, -367.0, -145.0, -103.0, -26.0, 107.0, -28.0, 145.0, 199.0, 118.0, 97.0, 44.0, -12.0, 135.0, 36.0, -324.0, 41.0, 48.0, 0.0, 143.0, 14.0, -241.0, 125.0, -84.0, 0.0, -104.0, 9.0, 139.0, 134.0, 37.0, 25.0, 0.0, -7.0, 2.0, 33.0, 0.0, 103.0, -23.0, 0.0], "policy_predator_policy_reward": [40.0, 0.0, 0.0, 0.0, 28.0, 7.0, 0.0, 0.0, 16.0, 11.0, 19.0, 178.0, 54.0, 0.0, 57.0, 0.0, 0.0, 0.0, 43.0, 33.0, 13.0, 13.0, 28.0, 0.0, 0.0, 159.0, 9.0, 138.0, 11.0, 87.0, 24.0, 5.0, 5.0, 112.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 1.0, 26.0, 2.0, 192.0, 17.0, 110.0, 0.0, 113.0, 5.0, 196.0, 0.0, 0.0, 13.0, 43.0, 0.0, 21.0, 0.0, 15.0, 193.0, 47.0, 28.0, 0.0, 22.0, 0.0, 0.0, 60.0, 106.0, 31.0, 0.0, 0.0, 0.0, 117.0, 63.0, 11.0, 20.0, 96.0, 0.0, 0.0, 0.0, 72.0, 0.0, 0.0, 87.0, 0.0, 0.0, 0.0, 14.0, 91.0, 0.0, 23.0, 0.0, 0.0, 85.0, 0.0, 0.0, 32.0, 1.0, 137.0, 18.0, 77.0, 53.0, 0.0, 55.0, 10.0, 0.0, 0.0, 1.0, 42.0, 84.0, 0.0, 0.0, 36.0, 10.0, 13.0, 0.0, 0.0, 179.0, 170.0, 0.0, 4.0, 63.0, 121.0, 22.0, 0.0, 31.0, 8.0, 7.0, 12.0, 0.0, 0.0, 0.0, 22.0, 36.0, 139.0, 0.0, 73.0, 1.0, 8.0, 0.0, 58.0, 0.0, 7.0, 0.0, 0.0, 6.0, 13.0, 0.0, 29.0, 0.0, 51.0, 70.0, 0.0, 193.0, 52.0, 46.0, 0.0, 25.0, 4.0, 138.0, 0.0, 7.0, 41.0, 0.0, 194.0, 121.0, 0.0, 65.0, 14.0, 0.0, 0.0, 0.0, 42.0, 6.0, 43.0, 18.0, 4.0, 172.0, 0.0, 0.0, 27.0, 0.0, 64.0, 4.0, 147.0, 9.0, 94.0, 74.0, 0.0, 0.0, 25.0, 0.0, 69.0, 0.0, 53.0, 32.0, 0.0, 6.0, 14.0, 0.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8657574577515966, "mean_inference_ms": 2.73341072353351, "mean_action_processing_ms": 0.4687065776622655, "mean_env_wait_ms": 0.3122426008923334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004994750022888184, "StateBufferConnector_ms": 0.008098721504211426, "ViewRequirementAgentConnector_ms": 0.1212693452835083}, "num_episodes": 22, "episode_return_max": 388.0, "episode_return_min": -318.0, "episode_return_mean": 121.42, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.2181087022026, "num_env_steps_trained_throughput_per_sec": 349.2181087022026, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 12117.681, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12117.632, "sample_time_ms": 1837.514, "learn_time_ms": 10261.341, "learn_throughput": 389.813, "synch_weights_time_ms": 16.54}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "e1352_00002", "date": "2024-08-13_19-27-12", "timestamp": 1723591632, "time_this_iter_s": 11.61387300491333, "time_total_s": 1525.2042973041534, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cdcdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1525.2042973041534, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 49.15882352941177, "ram_util_percent": 81.51764705882351}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.709431518448724, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 5.263352288140191, "policy_loss": -0.003909443753707425, "vf_loss": 5.266724226083705, "vf_explained_var": 0.06660263462672159, "kl": 0.01510023626573626, "entropy": 1.1110708021613025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.146952336017417, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.698728084059619, "policy_loss": -0.0009517672978016355, "vf_loss": 8.699674042696675, "vf_explained_var": -0.0766886212207653, "kl": 0.008744302578564197, "entropy": 0.940209441620206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -346.0, "episode_reward_mean": 120.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -379.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 23.785, "predator_policy": 36.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.0, -72.0, 112.0, 72.0, 244.0, 370.0, -55.0, 117.0, 144.0, 184.0, -101.0, 187.0, 134.0, 241.0, -24.0, 385.0, 110.0, 180.0, 23.0, 371.0, 133.0, 225.0, 388.0, 140.0, 310.0, -26.0, 142.0, 93.0, 206.0, 162.0, 245.0, 108.0, 309.0, 159.0, 190.0, -243.0, 139.0, -179.0, 335.0, 314.0, 158.0, 318.0, -22.0, -107.0, 54.0, 132.0, 58.0, 264.0, 199.0, 161.0, 263.0, 255.0, 92.0, -192.0, 280.0, 270.0, 59.0, 255.0, -318.0, -8.0, 158.0, 344.0, 257.0, 81.0, 193.0, -111.0, 75.0, 221.0, 35.0, 19.0, -21.0, 298.0, 131.0, 46.0, 67.0, 123.0, 2.0, -50.0, 229.0, -43.0, 202.0, 218.0, -346.0, 200.0, -15.0, -49.0, 7.0, 3.0, -33.0, 382.0, -1.0, 200.0, 335.0, 237.0, 138.0, 286.0, 157.0, 289.0, -43.0, -41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -192.0, 106.0, -379.0, 0.0, 112.0, 20.0, -4.0, 116.0, 107.0, 200.0, 155.0, 67.0, -362.0, 0.0, 89.0, 50.0, 72.0, 14.0, 110.0, -153.0, -85.0, 187.0, 0.0, -115.0, 132.0, 156.0, 11.0, -81.0, -59.0, 193.0, 192.0, -26.0, 64.0, 0.0, 180.0, -64.0, 0.0, 199.0, 172.0, 160.0, -132.0, 105.0, 97.0, 200.0, 188.0, -55.0, 110.0, 184.0, 94.0, -214.0, 50.0, 175.0, -128.0, 40.0, 0.0, 63.0, 78.0, 162.0, 0.0, 27.0, 175.0, 94.0, -70.0, 121.0, 152.0, 162.0, -26.0, 119.0, 71.0, -249.0, -343.0, 135.0, 0.0, -138.0, -225.0, 179.0, 134.0, 110.0, 165.0, 139.0, 0.0, 200.0, 118.0, -44.0, 0.0, -102.0, -180.0, -19.0, 0.0, 0.0, 123.0, 0.0, 0.0, 78.0, 179.0, 187.0, 12.0, 0.0, 142.0, 121.0, 113.0, 157.0, 47.0, -140.0, 162.0, -355.0, -82.0, 68.0, 166.0, 115.0, 126.0, -180.0, 101.0, 164.0, 43.0, -367.0, -145.0, -103.0, -26.0, 107.0, -28.0, 145.0, 199.0, 118.0, 97.0, 44.0, -12.0, 135.0, 36.0, -324.0, 41.0, 48.0, 0.0, 143.0, 14.0, -241.0, 125.0, -84.0, 0.0, -104.0, 9.0, 139.0, 134.0, 37.0, 25.0, 0.0, -7.0, 2.0, 33.0, 0.0, 103.0, -23.0, 0.0, -14.0, -347.0, 108.0, 46.0, -18.0, -106.0, -11.0, 176.0, 145.0, 23.0, -365.0, -356.0, 87.0, 103.0, -4.0, -160.0, 43.0, -236.0, 0.0, -44.0, -85.0, -31.0, -69.0, -121.0, 200.0, 173.0, 0.0, -100.0, 0.0, 200.0, 162.0, 157.0, 89.0, 139.0, 112.0, 17.0, 93.0, 157.0, 107.0, -28.0, 100.0, 162.0, -70.0, -125.0, -254.0, 19.0], "policy_predator_policy_reward": [0.0, 113.0, 5.0, 196.0, 0.0, 0.0, 13.0, 43.0, 0.0, 21.0, 0.0, 15.0, 193.0, 47.0, 28.0, 0.0, 22.0, 0.0, 0.0, 60.0, 106.0, 31.0, 0.0, 0.0, 0.0, 117.0, 63.0, 11.0, 20.0, 96.0, 0.0, 0.0, 0.0, 72.0, 0.0, 0.0, 87.0, 0.0, 0.0, 0.0, 14.0, 91.0, 0.0, 23.0, 0.0, 0.0, 85.0, 0.0, 0.0, 32.0, 1.0, 137.0, 18.0, 77.0, 53.0, 0.0, 55.0, 10.0, 0.0, 0.0, 1.0, 42.0, 84.0, 0.0, 0.0, 36.0, 10.0, 13.0, 0.0, 0.0, 179.0, 170.0, 0.0, 4.0, 63.0, 121.0, 22.0, 0.0, 31.0, 8.0, 7.0, 12.0, 0.0, 0.0, 0.0, 22.0, 36.0, 139.0, 0.0, 73.0, 1.0, 8.0, 0.0, 58.0, 0.0, 7.0, 0.0, 0.0, 6.0, 13.0, 0.0, 29.0, 0.0, 51.0, 70.0, 0.0, 193.0, 52.0, 46.0, 0.0, 25.0, 4.0, 138.0, 0.0, 7.0, 41.0, 0.0, 194.0, 121.0, 0.0, 65.0, 14.0, 0.0, 0.0, 0.0, 42.0, 6.0, 43.0, 18.0, 4.0, 172.0, 0.0, 0.0, 27.0, 0.0, 64.0, 4.0, 147.0, 9.0, 94.0, 74.0, 0.0, 0.0, 25.0, 0.0, 69.0, 0.0, 53.0, 32.0, 0.0, 6.0, 14.0, 0.0, 25.0, 137.0, 174.0, 75.0, 0.0, 0.0, 81.0, 22.0, 15.0, 42.0, 8.0, 192.0, 183.0, 10.0, 0.0, 69.0, 80.0, 144.0, 0.0, 46.0, 5.0, 119.0, 0.0, 52.0, 105.0, 2.0, 7.0, 11.0, 88.0, 0.0, 0.0, 15.0, 1.0, 9.0, 0.0, 7.0, 2.0, 29.0, 7.0, 53.0, 25.0, 27.0, 0.0, 0.0, 152.0, 130.0, 64.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8655920129512592, "mean_inference_ms": 2.7430766637203927, "mean_action_processing_ms": 0.4668667808806767, "mean_env_wait_ms": 0.3136210331882566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005009055137634277, "StateBufferConnector_ms": 0.010664939880371094, "ViewRequirementAgentConnector_ms": 0.1509990692138672}, "num_episodes": 23, "episode_return_max": 388.0, "episode_return_min": -346.0, "episode_return_mean": 120.44, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.8101239295936, "num_env_steps_trained_throughput_per_sec": 300.8101239295936, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 12110.91, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12110.861, "sample_time_ms": 1875.756, "learn_time_ms": 10216.652, "learn_throughput": 391.518, "synch_weights_time_ms": 16.379}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "e1352_00002", "date": "2024-08-13_19-27-25", "timestamp": 1723591645, "time_this_iter_s": 13.340625286102295, "time_total_s": 1538.5449225902557, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1538.5449225902557, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 56.373684210526314, "ram_util_percent": 82.47894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.41546161101451, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 3.671934123518606, "policy_loss": -0.0021739453185724202, "vf_loss": 3.673795805154023, "vf_explained_var": 0.037338302217463336, "kl": 0.008772351325189042, "entropy": 1.1246460645917862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.73854212123881, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.8691297137548055, "policy_loss": -0.003053562230031405, "vf_loss": 7.872172368771185, "vf_explained_var": 0.1690066968953168, "kl": 0.016516982791470576, "entropy": 1.045919053832059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -346.0, "episode_reward_mean": 122.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -367.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 26.635, "predator_policy": 34.77}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 371.0, 133.0, 225.0, 388.0, 140.0, 310.0, -26.0, 142.0, 93.0, 206.0, 162.0, 245.0, 108.0, 309.0, 159.0, 190.0, -243.0, 139.0, -179.0, 335.0, 314.0, 158.0, 318.0, -22.0, -107.0, 54.0, 132.0, 58.0, 264.0, 199.0, 161.0, 263.0, 255.0, 92.0, -192.0, 280.0, 270.0, 59.0, 255.0, -318.0, -8.0, 158.0, 344.0, 257.0, 81.0, 193.0, -111.0, 75.0, 221.0, 35.0, 19.0, -21.0, 298.0, 131.0, 46.0, 67.0, 123.0, 2.0, -50.0, 229.0, -43.0, 202.0, 218.0, -346.0, 200.0, -15.0, -49.0, 7.0, 3.0, -33.0, 382.0, -1.0, 200.0, 335.0, 237.0, 138.0, 286.0, 157.0, 289.0, -43.0, -41.0, 107.0, 126.0, -117.0, 188.0, 112.0, 0.0, 85.0, 245.0, -13.0, 44.0, 37.0, 281.0, -53.0, 249.0, 333.0, 141.0, 286.0, 335.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-64.0, 0.0, 199.0, 172.0, 160.0, -132.0, 105.0, 97.0, 200.0, 188.0, -55.0, 110.0, 184.0, 94.0, -214.0, 50.0, 175.0, -128.0, 40.0, 0.0, 63.0, 78.0, 162.0, 0.0, 27.0, 175.0, 94.0, -70.0, 121.0, 152.0, 162.0, -26.0, 119.0, 71.0, -249.0, -343.0, 135.0, 0.0, -138.0, -225.0, 179.0, 134.0, 110.0, 165.0, 139.0, 0.0, 200.0, 118.0, -44.0, 0.0, -102.0, -180.0, -19.0, 0.0, 0.0, 123.0, 0.0, 0.0, 78.0, 179.0, 187.0, 12.0, 0.0, 142.0, 121.0, 113.0, 157.0, 47.0, -140.0, 162.0, -355.0, -82.0, 68.0, 166.0, 115.0, 126.0, -180.0, 101.0, 164.0, 43.0, -367.0, -145.0, -103.0, -26.0, 107.0, -28.0, 145.0, 199.0, 118.0, 97.0, 44.0, -12.0, 135.0, 36.0, -324.0, 41.0, 48.0, 0.0, 143.0, 14.0, -241.0, 125.0, -84.0, 0.0, -104.0, 9.0, 139.0, 134.0, 37.0, 25.0, 0.0, -7.0, 2.0, 33.0, 0.0, 103.0, -23.0, 0.0, -14.0, -347.0, 108.0, 46.0, -18.0, -106.0, -11.0, 176.0, 145.0, 23.0, -365.0, -356.0, 87.0, 103.0, -4.0, -160.0, 43.0, -236.0, 0.0, -44.0, -85.0, -31.0, -69.0, -121.0, 200.0, 173.0, 0.0, -100.0, 0.0, 200.0, 162.0, 157.0, 89.0, 139.0, 112.0, 17.0, 93.0, 157.0, 107.0, -28.0, 100.0, 162.0, -70.0, -125.0, -254.0, 19.0, 89.0, 0.0, -98.0, 121.0, -218.0, -74.0, 123.0, -4.0, 0.0, 108.0, 0.0, 0.0, 0.0, 68.0, 176.0, 68.0, -179.0, 32.0, 3.0, 41.0, -160.0, 57.0, 149.0, 94.0, 48.0, -222.0, 135.0, 71.0, 140.0, 172.0, 0.0, 114.0, 116.0, 170.0, 188.0, 119.0], "policy_predator_policy_reward": [87.0, 0.0, 0.0, 0.0, 14.0, 91.0, 0.0, 23.0, 0.0, 0.0, 85.0, 0.0, 0.0, 32.0, 1.0, 137.0, 18.0, 77.0, 53.0, 0.0, 55.0, 10.0, 0.0, 0.0, 1.0, 42.0, 84.0, 0.0, 0.0, 36.0, 10.0, 13.0, 0.0, 0.0, 179.0, 170.0, 0.0, 4.0, 63.0, 121.0, 22.0, 0.0, 31.0, 8.0, 7.0, 12.0, 0.0, 0.0, 0.0, 22.0, 36.0, 139.0, 0.0, 73.0, 1.0, 8.0, 0.0, 58.0, 0.0, 7.0, 0.0, 0.0, 6.0, 13.0, 0.0, 29.0, 0.0, 51.0, 70.0, 0.0, 193.0, 52.0, 46.0, 0.0, 25.0, 4.0, 138.0, 0.0, 7.0, 41.0, 0.0, 194.0, 121.0, 0.0, 65.0, 14.0, 0.0, 0.0, 0.0, 42.0, 6.0, 43.0, 18.0, 4.0, 172.0, 0.0, 0.0, 27.0, 0.0, 64.0, 4.0, 147.0, 9.0, 94.0, 74.0, 0.0, 0.0, 25.0, 0.0, 69.0, 0.0, 53.0, 32.0, 0.0, 6.0, 14.0, 0.0, 25.0, 137.0, 174.0, 75.0, 0.0, 0.0, 81.0, 22.0, 15.0, 42.0, 8.0, 192.0, 183.0, 10.0, 0.0, 69.0, 80.0, 144.0, 0.0, 46.0, 5.0, 119.0, 0.0, 52.0, 105.0, 2.0, 7.0, 11.0, 88.0, 0.0, 0.0, 15.0, 1.0, 9.0, 0.0, 7.0, 2.0, 29.0, 7.0, 53.0, 25.0, 27.0, 0.0, 0.0, 152.0, 130.0, 64.0, 0.0, 18.0, 81.0, 22.0, 37.0, 138.0, 8.0, 61.0, 4.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 1.0, 134.0, 0.0, 0.0, 0.0, 20.0, 120.0, 38.0, 0.0, 111.0, 10.0, 0.0, 43.0, 21.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 28.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8674929761472379, "mean_inference_ms": 2.748395879065706, "mean_action_processing_ms": 0.4651547165947364, "mean_env_wait_ms": 0.31483526934733946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00615847110748291, "StateBufferConnector_ms": 0.010532259941101074, "ViewRequirementAgentConnector_ms": 0.1528630256652832}, "num_episodes": 18, "episode_return_max": 388.0, "episode_return_min": -346.0, "episode_return_mean": 122.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.38167802652265, "num_env_steps_trained_throughput_per_sec": 319.38167802652265, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 12105.648, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12105.595, "sample_time_ms": 1929.152, "learn_time_ms": 10157.142, "learn_throughput": 393.812, "synch_weights_time_ms": 16.628}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "e1352_00002", "date": "2024-08-13_19-27-38", "timestamp": 1723591658, "time_this_iter_s": 12.55257272720337, "time_total_s": 1551.097495317459, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb3430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1551.097495317459, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 54.05, "ram_util_percent": 82.23888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1719763353703514, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 4.000257625024785, "policy_loss": -0.0008427397875243394, "vf_loss": 4.000674589979585, "vf_explained_var": 0.05484277019425044, "kl": 0.011961302949356389, "entropy": 1.1412736620852557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.973743974169096, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.645676761203342, "policy_loss": -0.0013808566510243707, "vf_loss": 8.647051957549241, "vf_explained_var": -0.14497482208978563, "kl": 0.008580016390398668, "entropy": 0.9482291061096091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 382.0, "episode_reward_min": -417.0, "episode_reward_mean": 109.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -371.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 18.745, "predator_policy": 35.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.0, -179.0, 335.0, 314.0, 158.0, 318.0, -22.0, -107.0, 54.0, 132.0, 58.0, 264.0, 199.0, 161.0, 263.0, 255.0, 92.0, -192.0, 280.0, 270.0, 59.0, 255.0, -318.0, -8.0, 158.0, 344.0, 257.0, 81.0, 193.0, -111.0, 75.0, 221.0, 35.0, 19.0, -21.0, 298.0, 131.0, 46.0, 67.0, 123.0, 2.0, -50.0, 229.0, -43.0, 202.0, 218.0, -346.0, 200.0, -15.0, -49.0, 7.0, 3.0, -33.0, 382.0, -1.0, 200.0, 335.0, 237.0, 138.0, 286.0, 157.0, 289.0, -43.0, -41.0, 107.0, 126.0, -117.0, 188.0, 112.0, 0.0, 85.0, 245.0, -13.0, 44.0, 37.0, 281.0, -53.0, 249.0, 333.0, 141.0, 286.0, 335.0, 108.0, 247.0, 87.0, 194.0, 144.0, 378.0, 298.0, 59.0, 293.0, 313.0, 76.0, 175.0, -58.0, -417.0, 31.0, -134.0, 80.0, -314.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [135.0, 0.0, -138.0, -225.0, 179.0, 134.0, 110.0, 165.0, 139.0, 0.0, 200.0, 118.0, -44.0, 0.0, -102.0, -180.0, -19.0, 0.0, 0.0, 123.0, 0.0, 0.0, 78.0, 179.0, 187.0, 12.0, 0.0, 142.0, 121.0, 113.0, 157.0, 47.0, -140.0, 162.0, -355.0, -82.0, 68.0, 166.0, 115.0, 126.0, -180.0, 101.0, 164.0, 43.0, -367.0, -145.0, -103.0, -26.0, 107.0, -28.0, 145.0, 199.0, 118.0, 97.0, 44.0, -12.0, 135.0, 36.0, -324.0, 41.0, 48.0, 0.0, 143.0, 14.0, -241.0, 125.0, -84.0, 0.0, -104.0, 9.0, 139.0, 134.0, 37.0, 25.0, 0.0, -7.0, 2.0, 33.0, 0.0, 103.0, -23.0, 0.0, -14.0, -347.0, 108.0, 46.0, -18.0, -106.0, -11.0, 176.0, 145.0, 23.0, -365.0, -356.0, 87.0, 103.0, -4.0, -160.0, 43.0, -236.0, 0.0, -44.0, -85.0, -31.0, -69.0, -121.0, 200.0, 173.0, 0.0, -100.0, 0.0, 200.0, 162.0, 157.0, 89.0, 139.0, 112.0, 17.0, 93.0, 157.0, 107.0, -28.0, 100.0, 162.0, -70.0, -125.0, -254.0, 19.0, 89.0, 0.0, -98.0, 121.0, -218.0, -74.0, 123.0, -4.0, 0.0, 108.0, 0.0, 0.0, 0.0, 68.0, 176.0, 68.0, -179.0, 32.0, 3.0, 41.0, -160.0, 57.0, 149.0, 94.0, 48.0, -222.0, 135.0, 71.0, 140.0, 172.0, 0.0, 114.0, 116.0, 170.0, 188.0, 119.0, 56.0, -28.0, 139.0, 108.0, 0.0, 62.0, -12.0, 200.0, 7.0, 69.0, 180.0, 198.0, 156.0, 121.0, 7.0, 10.0, 137.0, 146.0, 113.0, 168.0, 0.0, 14.0, 131.0, 10.0, -89.0, -111.0, -371.0, -334.0, 121.0, -262.0, -83.0, -254.0, 30.0, 0.0, -256.0, -244.0], "policy_predator_policy_reward": [0.0, 4.0, 63.0, 121.0, 22.0, 0.0, 31.0, 8.0, 7.0, 12.0, 0.0, 0.0, 0.0, 22.0, 36.0, 139.0, 0.0, 73.0, 1.0, 8.0, 0.0, 58.0, 0.0, 7.0, 0.0, 0.0, 6.0, 13.0, 0.0, 29.0, 0.0, 51.0, 70.0, 0.0, 193.0, 52.0, 46.0, 0.0, 25.0, 4.0, 138.0, 0.0, 7.0, 41.0, 0.0, 194.0, 121.0, 0.0, 65.0, 14.0, 0.0, 0.0, 0.0, 42.0, 6.0, 43.0, 18.0, 4.0, 172.0, 0.0, 0.0, 27.0, 0.0, 64.0, 4.0, 147.0, 9.0, 94.0, 74.0, 0.0, 0.0, 25.0, 0.0, 69.0, 0.0, 53.0, 32.0, 0.0, 6.0, 14.0, 0.0, 25.0, 137.0, 174.0, 75.0, 0.0, 0.0, 81.0, 22.0, 15.0, 42.0, 8.0, 192.0, 183.0, 10.0, 0.0, 69.0, 80.0, 144.0, 0.0, 46.0, 5.0, 119.0, 0.0, 52.0, 105.0, 2.0, 7.0, 11.0, 88.0, 0.0, 0.0, 15.0, 1.0, 9.0, 0.0, 7.0, 2.0, 29.0, 7.0, 53.0, 25.0, 27.0, 0.0, 0.0, 152.0, 130.0, 64.0, 0.0, 18.0, 81.0, 22.0, 37.0, 138.0, 8.0, 61.0, 4.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 1.0, 134.0, 0.0, 0.0, 0.0, 20.0, 120.0, 38.0, 0.0, 111.0, 10.0, 0.0, 43.0, 21.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 28.0, 0.0, 80.0, 0.0, 0.0, 25.0, 0.0, 6.0, 0.0, 18.0, 50.0, 0.0, 0.0, 9.0, 12.0, 40.0, 2.0, 10.0, 0.0, 24.0, 8.0, 41.0, 21.0, 34.0, 0.0, 142.0, 0.0, 116.0, 172.0, 158.0, 14.0, 162.0, 41.0, 43.0, 7.0, 0.0, 186.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8703303840848677, "mean_inference_ms": 2.7577319238707076, "mean_action_processing_ms": 0.46462231179863595, "mean_env_wait_ms": 0.31653832375992097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00634157657623291, "StateBufferConnector_ms": 0.0105743408203125, "ViewRequirementAgentConnector_ms": 0.17033231258392334}, "num_episodes": 18, "episode_return_max": 382.0, "episode_return_min": -417.0, "episode_return_mean": 109.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.28778517840178, "num_env_steps_trained_throughput_per_sec": 206.28778517840178, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 12852.254, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12852.201, "sample_time_ms": 1934.196, "learn_time_ms": 10898.392, "learn_throughput": 367.027, "synch_weights_time_ms": 16.827}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "e1352_00002", "date": "2024-08-13_19-27-58", "timestamp": 1723591678, "time_this_iter_s": 19.447241067886353, "time_total_s": 1570.5447363853455, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1570.5447363853455, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 88.75185185185185, "ram_util_percent": 83.46666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0762646005424874, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 5.117654723086685, "policy_loss": -0.004360938312426683, "vf_loss": 5.121566213375677, "vf_explained_var": 0.03379849353164592, "kl": 0.01262635342527232, "entropy": 1.1406541549339497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.54283288786651, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.08542608912029, "policy_loss": -0.00332745131716211, "vf_loss": 8.088743654382291, "vf_explained_var": -0.07062014650415491, "kl": 0.015027269540263918, "entropy": 0.9947852496432249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -417.0, "episode_reward_mean": 105.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 13.335, "predator_policy": 39.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0, 270.0, 59.0, 255.0, -318.0, -8.0, 158.0, 344.0, 257.0, 81.0, 193.0, -111.0, 75.0, 221.0, 35.0, 19.0, -21.0, 298.0, 131.0, 46.0, 67.0, 123.0, 2.0, -50.0, 229.0, -43.0, 202.0, 218.0, -346.0, 200.0, -15.0, -49.0, 7.0, 3.0, -33.0, 382.0, -1.0, 200.0, 335.0, 237.0, 138.0, 286.0, 157.0, 289.0, -43.0, -41.0, 107.0, 126.0, -117.0, 188.0, 112.0, 0.0, 85.0, 245.0, -13.0, 44.0, 37.0, 281.0, -53.0, 249.0, 333.0, 141.0, 286.0, 335.0, 108.0, 247.0, 87.0, 194.0, 144.0, 378.0, 298.0, 59.0, 293.0, 313.0, 76.0, 175.0, -58.0, -417.0, 31.0, -134.0, 80.0, -314.0, 297.0, 162.0, 132.0, 157.0, -95.0, 84.0, -58.0, 13.0, 393.0, 163.0, 304.0, 188.0, -15.0, 36.0, 81.0, -73.0, 130.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [68.0, 166.0, 115.0, 126.0, -180.0, 101.0, 164.0, 43.0, -367.0, -145.0, -103.0, -26.0, 107.0, -28.0, 145.0, 199.0, 118.0, 97.0, 44.0, -12.0, 135.0, 36.0, -324.0, 41.0, 48.0, 0.0, 143.0, 14.0, -241.0, 125.0, -84.0, 0.0, -104.0, 9.0, 139.0, 134.0, 37.0, 25.0, 0.0, -7.0, 2.0, 33.0, 0.0, 103.0, -23.0, 0.0, -14.0, -347.0, 108.0, 46.0, -18.0, -106.0, -11.0, 176.0, 145.0, 23.0, -365.0, -356.0, 87.0, 103.0, -4.0, -160.0, 43.0, -236.0, 0.0, -44.0, -85.0, -31.0, -69.0, -121.0, 200.0, 173.0, 0.0, -100.0, 0.0, 200.0, 162.0, 157.0, 89.0, 139.0, 112.0, 17.0, 93.0, 157.0, 107.0, -28.0, 100.0, 162.0, -70.0, -125.0, -254.0, 19.0, 89.0, 0.0, -98.0, 121.0, -218.0, -74.0, 123.0, -4.0, 0.0, 108.0, 0.0, 0.0, 0.0, 68.0, 176.0, 68.0, -179.0, 32.0, 3.0, 41.0, -160.0, 57.0, 149.0, 94.0, 48.0, -222.0, 135.0, 71.0, 140.0, 172.0, 0.0, 114.0, 116.0, 170.0, 188.0, 119.0, 56.0, -28.0, 139.0, 108.0, 0.0, 62.0, -12.0, 200.0, 7.0, 69.0, 180.0, 198.0, 156.0, 121.0, 7.0, 10.0, 137.0, 146.0, 113.0, 168.0, 0.0, 14.0, 131.0, 10.0, -89.0, -111.0, -371.0, -334.0, 121.0, -262.0, -83.0, -254.0, 30.0, 0.0, -256.0, -244.0, 144.0, 153.0, 64.0, -4.0, 97.0, -7.0, 197.0, -152.0, -161.0, -129.0, -172.0, 129.0, -82.0, -107.0, 0.0, -28.0, 195.0, 197.0, 97.0, 65.0, 144.0, 160.0, -12.0, 124.0, -102.0, -48.0, -166.0, 55.0, -334.0, 116.0, -394.0, 0.0, 95.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [46.0, 0.0, 25.0, 4.0, 138.0, 0.0, 7.0, 41.0, 0.0, 194.0, 121.0, 0.0, 65.0, 14.0, 0.0, 0.0, 0.0, 42.0, 6.0, 43.0, 18.0, 4.0, 172.0, 0.0, 0.0, 27.0, 0.0, 64.0, 4.0, 147.0, 9.0, 94.0, 74.0, 0.0, 0.0, 25.0, 0.0, 69.0, 0.0, 53.0, 32.0, 0.0, 6.0, 14.0, 0.0, 25.0, 137.0, 174.0, 75.0, 0.0, 0.0, 81.0, 22.0, 15.0, 42.0, 8.0, 192.0, 183.0, 10.0, 0.0, 69.0, 80.0, 144.0, 0.0, 46.0, 5.0, 119.0, 0.0, 52.0, 105.0, 2.0, 7.0, 11.0, 88.0, 0.0, 0.0, 15.0, 1.0, 9.0, 0.0, 7.0, 2.0, 29.0, 7.0, 53.0, 25.0, 27.0, 0.0, 0.0, 152.0, 130.0, 64.0, 0.0, 18.0, 81.0, 22.0, 37.0, 138.0, 8.0, 61.0, 4.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 1.0, 134.0, 0.0, 0.0, 0.0, 20.0, 120.0, 38.0, 0.0, 111.0, 10.0, 0.0, 43.0, 21.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 28.0, 0.0, 80.0, 0.0, 0.0, 25.0, 0.0, 6.0, 0.0, 18.0, 50.0, 0.0, 0.0, 9.0, 12.0, 40.0, 2.0, 10.0, 0.0, 24.0, 8.0, 41.0, 21.0, 34.0, 0.0, 142.0, 0.0, 116.0, 172.0, 158.0, 14.0, 162.0, 41.0, 43.0, 7.0, 0.0, 186.0, 0.0, 0.0, 65.0, 37.0, 0.0, 42.0, 112.0, 0.0, 71.0, 124.0, 127.0, 0.0, 119.0, 12.0, 21.0, 20.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 38.0, 38.0, 45.0, 90.0, 74.0, 73.0, 134.0, 165.0, 179.0, 142.0, 35.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733061020885142, "mean_inference_ms": 2.766350068640014, "mean_action_processing_ms": 0.46420998375890465, "mean_env_wait_ms": 0.31798592322683367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010003209114074707, "StateBufferConnector_ms": 0.010644793510437012, "ViewRequirementAgentConnector_ms": 0.1758732795715332}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": -417.0, "episode_return_mean": 105.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.8003370114825, "num_env_steps_trained_throughput_per_sec": 299.8003370114825, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 13040.607, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13040.55, "sample_time_ms": 2016.82, "learn_time_ms": 11004.149, "learn_throughput": 363.499, "synch_weights_time_ms": 16.514}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "e1352_00002", "date": "2024-08-13_19-28-11", "timestamp": 1723591691, "time_this_iter_s": 13.388627290725708, "time_total_s": 1583.9333636760712, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d008b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1583.9333636760712, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 66.5578947368421, "ram_util_percent": 84.08421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0093544071707776, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 2.988477550360261, "policy_loss": -0.003277837158865714, "vf_loss": 2.99138131677789, "vf_explained_var": 0.02202490454628354, "kl": 0.010508890869643081, "entropy": 1.1846337457182545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.78071917793738, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.171988382289019, "policy_loss": -0.001162606020576306, "vf_loss": 7.173144645034951, "vf_explained_var": 0.23480310900501472, "kl": 0.009637607212279664, "entropy": 1.1426914186073989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -417.0, "episode_reward_mean": 96.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 7.89, "predator_policy": 40.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -50.0, 229.0, -43.0, 202.0, 218.0, -346.0, 200.0, -15.0, -49.0, 7.0, 3.0, -33.0, 382.0, -1.0, 200.0, 335.0, 237.0, 138.0, 286.0, 157.0, 289.0, -43.0, -41.0, 107.0, 126.0, -117.0, 188.0, 112.0, 0.0, 85.0, 245.0, -13.0, 44.0, 37.0, 281.0, -53.0, 249.0, 333.0, 141.0, 286.0, 335.0, 108.0, 247.0, 87.0, 194.0, 144.0, 378.0, 298.0, 59.0, 293.0, 313.0, 76.0, 175.0, -58.0, -417.0, 31.0, -134.0, 80.0, -314.0, 297.0, 162.0, 132.0, 157.0, -95.0, 84.0, -58.0, 13.0, 393.0, 163.0, 304.0, 188.0, -15.0, 36.0, 81.0, -73.0, 130.0, 0.0, 236.0, -123.0, 0.0, 72.0, 156.0, 26.0, 83.0, -35.0, 9.0, 80.0, 240.0, 302.0, 100.0, 112.0, 104.0, 99.0, 120.0, 15.0, 94.0, -130.0, 14.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.0, 0.0, -14.0, -347.0, 108.0, 46.0, -18.0, -106.0, -11.0, 176.0, 145.0, 23.0, -365.0, -356.0, 87.0, 103.0, -4.0, -160.0, 43.0, -236.0, 0.0, -44.0, -85.0, -31.0, -69.0, -121.0, 200.0, 173.0, 0.0, -100.0, 0.0, 200.0, 162.0, 157.0, 89.0, 139.0, 112.0, 17.0, 93.0, 157.0, 107.0, -28.0, 100.0, 162.0, -70.0, -125.0, -254.0, 19.0, 89.0, 0.0, -98.0, 121.0, -218.0, -74.0, 123.0, -4.0, 0.0, 108.0, 0.0, 0.0, 0.0, 68.0, 176.0, 68.0, -179.0, 32.0, 3.0, 41.0, -160.0, 57.0, 149.0, 94.0, 48.0, -222.0, 135.0, 71.0, 140.0, 172.0, 0.0, 114.0, 116.0, 170.0, 188.0, 119.0, 56.0, -28.0, 139.0, 108.0, 0.0, 62.0, -12.0, 200.0, 7.0, 69.0, 180.0, 198.0, 156.0, 121.0, 7.0, 10.0, 137.0, 146.0, 113.0, 168.0, 0.0, 14.0, 131.0, 10.0, -89.0, -111.0, -371.0, -334.0, 121.0, -262.0, -83.0, -254.0, 30.0, 0.0, -256.0, -244.0, 144.0, 153.0, 64.0, -4.0, 97.0, -7.0, 197.0, -152.0, -161.0, -129.0, -172.0, 129.0, -82.0, -107.0, 0.0, -28.0, 195.0, 197.0, 97.0, 65.0, 144.0, 160.0, -12.0, 124.0, -102.0, -48.0, -166.0, 55.0, -334.0, 116.0, -394.0, 0.0, 95.0, 0.0, 0.0, 0.0, 56.0, 171.0, -22.0, -255.0, 0.0, 0.0, -56.0, -5.0, 0.0, 139.0, 0.0, -48.0, 0.0, 80.0, 0.0, -113.0, -121.0, -18.0, 60.0, -63.0, 196.0, -18.0, 118.0, 172.0, -400.0, 117.0, 0.0, 68.0, -64.0, 85.0, 97.0, 0.0, 0.0, 75.0, 23.0, -112.0, 122.0, -62.0, -35.0, -316.0, 92.0, -156.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 25.0, 137.0, 174.0, 75.0, 0.0, 0.0, 81.0, 22.0, 15.0, 42.0, 8.0, 192.0, 183.0, 10.0, 0.0, 69.0, 80.0, 144.0, 0.0, 46.0, 5.0, 119.0, 0.0, 52.0, 105.0, 2.0, 7.0, 11.0, 88.0, 0.0, 0.0, 15.0, 1.0, 9.0, 0.0, 7.0, 2.0, 29.0, 7.0, 53.0, 25.0, 27.0, 0.0, 0.0, 152.0, 130.0, 64.0, 0.0, 18.0, 81.0, 22.0, 37.0, 138.0, 8.0, 61.0, 4.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 1.0, 134.0, 0.0, 0.0, 0.0, 20.0, 120.0, 38.0, 0.0, 111.0, 10.0, 0.0, 43.0, 21.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 28.0, 0.0, 80.0, 0.0, 0.0, 25.0, 0.0, 6.0, 0.0, 18.0, 50.0, 0.0, 0.0, 9.0, 12.0, 40.0, 2.0, 10.0, 0.0, 24.0, 8.0, 41.0, 21.0, 34.0, 0.0, 142.0, 0.0, 116.0, 172.0, 158.0, 14.0, 162.0, 41.0, 43.0, 7.0, 0.0, 186.0, 0.0, 0.0, 65.0, 37.0, 0.0, 42.0, 112.0, 0.0, 71.0, 124.0, 127.0, 0.0, 119.0, 12.0, 21.0, 20.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 38.0, 38.0, 45.0, 90.0, 74.0, 73.0, 134.0, 165.0, 179.0, 142.0, 35.0, 0.0, 0.0, 0.0, 9.0, 0.0, 119.0, 35.0, 0.0, 0.0, 0.0, 133.0, 16.0, 1.0, 41.0, 33.0, 3.0, 0.0, 75.0, 3.0, 16.0, 132.0, 83.0, 0.0, 62.0, 0.0, 0.0, 12.0, 183.0, 200.0, 3.0, 41.0, 38.0, 45.0, 2.0, 0.0, 30.0, 15.0, 103.0, 1.0, 3.0, 31.0, 168.0, 53.0, 78.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8776731606511098, "mean_inference_ms": 2.7781368786292058, "mean_action_processing_ms": 0.46402507917456903, "mean_env_wait_ms": 0.31978882951156185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010597944259643555, "StateBufferConnector_ms": 0.007020711898803711, "ViewRequirementAgentConnector_ms": 0.16984808444976807}, "num_episodes": 22, "episode_return_max": 393.0, "episode_return_min": -417.0, "episode_return_mean": 96.83, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.98297139822506, "num_env_steps_trained_throughput_per_sec": 324.98297139822506, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 13151.802, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13151.746, "sample_time_ms": 2065.194, "learn_time_ms": 11066.909, "learn_throughput": 361.438, "synch_weights_time_ms": 16.531}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "e1352_00002", "date": "2024-08-13_19-28-23", "timestamp": 1723591703, "time_this_iter_s": 12.373318195343018, "time_total_s": 1596.3066818714142, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb3430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1596.3066818714142, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 66.14444444444445, "ram_util_percent": 84.05555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7770420807063896, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 4.1318048522585915, "policy_loss": -0.0016717734576631633, "vf_loss": 4.133078031438999, "vf_explained_var": 0.03488503962597519, "kl": 0.011197722121001905, "entropy": 1.1408786178896666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.40856411627361, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.069199547187361, "policy_loss": -0.0021625277238883195, "vf_loss": 8.071352744733215, "vf_explained_var": -0.05853008094918791, "kl": 0.014180718920372986, "entropy": 0.9516244816401648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -417.0, "episode_reward_mean": 98.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 12.16, "predator_policy": 37.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.0, 107.0, 126.0, -117.0, 188.0, 112.0, 0.0, 85.0, 245.0, -13.0, 44.0, 37.0, 281.0, -53.0, 249.0, 333.0, 141.0, 286.0, 335.0, 108.0, 247.0, 87.0, 194.0, 144.0, 378.0, 298.0, 59.0, 293.0, 313.0, 76.0, 175.0, -58.0, -417.0, 31.0, -134.0, 80.0, -314.0, 297.0, 162.0, 132.0, 157.0, -95.0, 84.0, -58.0, 13.0, 393.0, 163.0, 304.0, 188.0, -15.0, 36.0, 81.0, -73.0, 130.0, 0.0, 236.0, -123.0, 0.0, 72.0, 156.0, 26.0, 83.0, -35.0, 9.0, 80.0, 240.0, 302.0, 100.0, 112.0, 104.0, 99.0, 120.0, 15.0, 94.0, -130.0, 14.0, 0.0, 339.0, 211.0, 190.0, 304.0, -4.0, 81.0, 40.0, 275.0, 367.0, -300.0, 205.0, 132.0, -93.0, 63.0, 103.0, 169.0, 27.0, 121.0, -335.0, 165.0, 85.0, 146.0, 191.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-254.0, 19.0, 89.0, 0.0, -98.0, 121.0, -218.0, -74.0, 123.0, -4.0, 0.0, 108.0, 0.0, 0.0, 0.0, 68.0, 176.0, 68.0, -179.0, 32.0, 3.0, 41.0, -160.0, 57.0, 149.0, 94.0, 48.0, -222.0, 135.0, 71.0, 140.0, 172.0, 0.0, 114.0, 116.0, 170.0, 188.0, 119.0, 56.0, -28.0, 139.0, 108.0, 0.0, 62.0, -12.0, 200.0, 7.0, 69.0, 180.0, 198.0, 156.0, 121.0, 7.0, 10.0, 137.0, 146.0, 113.0, 168.0, 0.0, 14.0, 131.0, 10.0, -89.0, -111.0, -371.0, -334.0, 121.0, -262.0, -83.0, -254.0, 30.0, 0.0, -256.0, -244.0, 144.0, 153.0, 64.0, -4.0, 97.0, -7.0, 197.0, -152.0, -161.0, -129.0, -172.0, 129.0, -82.0, -107.0, 0.0, -28.0, 195.0, 197.0, 97.0, 65.0, 144.0, 160.0, -12.0, 124.0, -102.0, -48.0, -166.0, 55.0, -334.0, 116.0, -394.0, 0.0, 95.0, 0.0, 0.0, 0.0, 56.0, 171.0, -22.0, -255.0, 0.0, 0.0, -56.0, -5.0, 0.0, 139.0, 0.0, -48.0, 0.0, 80.0, 0.0, -113.0, -121.0, -18.0, 60.0, -63.0, 196.0, -18.0, 118.0, 172.0, -400.0, 117.0, 0.0, 68.0, -64.0, 85.0, 97.0, 0.0, 0.0, 75.0, 23.0, -112.0, 122.0, -62.0, -35.0, -316.0, 92.0, -156.0, 0.0, 0.0, 140.0, 199.0, 60.0, 136.0, 102.0, 88.0, 139.0, 140.0, -48.0, -31.0, -19.0, -28.0, -7.0, -7.0, 174.0, 72.0, 198.0, 169.0, -147.0, -385.0, 180.0, 25.0, 113.0, 19.0, -221.0, -56.0, 42.0, 0.0, -49.0, 55.0, 66.0, 69.0, 0.0, -53.0, 0.0, 121.0, -337.0, -239.0, 67.0, 61.0, 85.0, 0.0, 22.0, 38.0, 193.0, -6.0], "policy_predator_policy_reward": [130.0, 64.0, 0.0, 18.0, 81.0, 22.0, 37.0, 138.0, 8.0, 61.0, 4.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 1.0, 134.0, 0.0, 0.0, 0.0, 20.0, 120.0, 38.0, 0.0, 111.0, 10.0, 0.0, 43.0, 21.0, 0.0, 0.0, 27.0, 0.0, 0.0, 0.0, 28.0, 0.0, 80.0, 0.0, 0.0, 25.0, 0.0, 6.0, 0.0, 18.0, 50.0, 0.0, 0.0, 9.0, 12.0, 40.0, 2.0, 10.0, 0.0, 24.0, 8.0, 41.0, 21.0, 34.0, 0.0, 142.0, 0.0, 116.0, 172.0, 158.0, 14.0, 162.0, 41.0, 43.0, 7.0, 0.0, 186.0, 0.0, 0.0, 65.0, 37.0, 0.0, 42.0, 112.0, 0.0, 71.0, 124.0, 127.0, 0.0, 119.0, 12.0, 21.0, 20.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 38.0, 38.0, 45.0, 90.0, 74.0, 73.0, 134.0, 165.0, 179.0, 142.0, 35.0, 0.0, 0.0, 0.0, 9.0, 0.0, 119.0, 35.0, 0.0, 0.0, 0.0, 133.0, 16.0, 1.0, 41.0, 33.0, 3.0, 0.0, 75.0, 3.0, 16.0, 132.0, 83.0, 0.0, 62.0, 0.0, 0.0, 12.0, 183.0, 200.0, 3.0, 41.0, 38.0, 45.0, 2.0, 0.0, 30.0, 15.0, 103.0, 1.0, 3.0, 31.0, 168.0, 53.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 8.0, 27.0, 48.0, 0.0, 128.0, 49.0, 5.0, 29.0, 0.0, 0.0, 0.0, 54.0, 178.0, 0.0, 0.0, 0.0, 0.0, 91.0, 93.0, 21.0, 0.0, 78.0, 19.0, 28.0, 6.0, 0.0, 80.0, 0.0, 0.0, 61.0, 180.0, 26.0, 11.0, 0.0, 0.0, 19.0, 67.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8792952439599913, "mean_inference_ms": 2.779445219027208, "mean_action_processing_ms": 0.46220649993996754, "mean_env_wait_ms": 0.3200628780060603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013389110565185547, "StateBufferConnector_ms": 0.004518747329711914, "ViewRequirementAgentConnector_ms": 0.1459214687347412}, "num_episodes": 23, "episode_return_max": 393.0, "episode_return_min": -417.0, "episode_return_mean": 98.6, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.02373041110036, "num_env_steps_trained_throughput_per_sec": 334.02373041110036, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 13199.764, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13199.711, "sample_time_ms": 2104.54, "learn_time_ms": 11075.907, "learn_throughput": 361.144, "synch_weights_time_ms": 16.03}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "e1352_00002", "date": "2024-08-13_19-28-35", "timestamp": 1723591715, "time_this_iter_s": 12.023632049560547, "time_total_s": 1608.3303139209747, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1608.3303139209747, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 67.01764705882354, "ram_util_percent": 83.65882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7983674947389219, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 6.285280363143436, "policy_loss": -0.0024038064825747693, "vf_loss": 6.287395661722416, "vf_explained_var": 0.037438749667828675, "kl": 0.008105203840607781, "entropy": 1.075930628448567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.102539401458053, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 9.11081231536058, "policy_loss": -0.0020676472037045096, "vf_loss": 9.112871707431854, "vf_explained_var": -0.10493794534572218, "kl": 0.0125590114716383, "entropy": 0.9416294107046077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -417.0, "episode_reward_mean": 85.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -0.385, "predator_policy": 43.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [335.0, 108.0, 247.0, 87.0, 194.0, 144.0, 378.0, 298.0, 59.0, 293.0, 313.0, 76.0, 175.0, -58.0, -417.0, 31.0, -134.0, 80.0, -314.0, 297.0, 162.0, 132.0, 157.0, -95.0, 84.0, -58.0, 13.0, 393.0, 163.0, 304.0, 188.0, -15.0, 36.0, 81.0, -73.0, 130.0, 0.0, 236.0, -123.0, 0.0, 72.0, 156.0, 26.0, 83.0, -35.0, 9.0, 80.0, 240.0, 302.0, 100.0, 112.0, 104.0, 99.0, 120.0, 15.0, 94.0, -130.0, 14.0, 0.0, 339.0, 211.0, 190.0, 304.0, -4.0, 81.0, 40.0, 275.0, 367.0, -300.0, 205.0, 132.0, -93.0, 63.0, 103.0, 169.0, 27.0, 121.0, -335.0, 165.0, 85.0, 146.0, 191.0, -31.0, 32.0, -50.0, 260.0, 70.0, -338.0, 171.0, -108.0, 210.0, 23.0, 139.0, -93.0, 109.0, 14.0, 61.0, -16.0, 12.0, 250.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 119.0, 56.0, -28.0, 139.0, 108.0, 0.0, 62.0, -12.0, 200.0, 7.0, 69.0, 180.0, 198.0, 156.0, 121.0, 7.0, 10.0, 137.0, 146.0, 113.0, 168.0, 0.0, 14.0, 131.0, 10.0, -89.0, -111.0, -371.0, -334.0, 121.0, -262.0, -83.0, -254.0, 30.0, 0.0, -256.0, -244.0, 144.0, 153.0, 64.0, -4.0, 97.0, -7.0, 197.0, -152.0, -161.0, -129.0, -172.0, 129.0, -82.0, -107.0, 0.0, -28.0, 195.0, 197.0, 97.0, 65.0, 144.0, 160.0, -12.0, 124.0, -102.0, -48.0, -166.0, 55.0, -334.0, 116.0, -394.0, 0.0, 95.0, 0.0, 0.0, 0.0, 56.0, 171.0, -22.0, -255.0, 0.0, 0.0, -56.0, -5.0, 0.0, 139.0, 0.0, -48.0, 0.0, 80.0, 0.0, -113.0, -121.0, -18.0, 60.0, -63.0, 196.0, -18.0, 118.0, 172.0, -400.0, 117.0, 0.0, 68.0, -64.0, 85.0, 97.0, 0.0, 0.0, 75.0, 23.0, -112.0, 122.0, -62.0, -35.0, -316.0, 92.0, -156.0, 0.0, 0.0, 140.0, 199.0, 60.0, 136.0, 102.0, 88.0, 139.0, 140.0, -48.0, -31.0, -19.0, -28.0, -7.0, -7.0, 174.0, 72.0, 198.0, 169.0, -147.0, -385.0, 180.0, 25.0, 113.0, 19.0, -221.0, -56.0, 42.0, 0.0, -49.0, 55.0, 66.0, 69.0, 0.0, -53.0, 0.0, 121.0, -337.0, -239.0, 67.0, 61.0, 85.0, 0.0, 22.0, 38.0, 193.0, -6.0, -251.0, 70.0, -36.0, -156.0, -8.0, -162.0, 183.0, 77.0, 26.0, -123.0, -315.0, -200.0, 20.0, 121.0, -268.0, -87.0, 75.0, 55.0, -43.0, -50.0, -199.0, 139.0, -104.0, -244.0, 0.0, 87.0, -116.0, 19.0, -112.0, 62.0, -116.0, 0.0, -102.0, -89.0, 186.0, 57.0], "policy_predator_policy_reward": [0.0, 28.0, 0.0, 80.0, 0.0, 0.0, 25.0, 0.0, 6.0, 0.0, 18.0, 50.0, 0.0, 0.0, 9.0, 12.0, 40.0, 2.0, 10.0, 0.0, 24.0, 8.0, 41.0, 21.0, 34.0, 0.0, 142.0, 0.0, 116.0, 172.0, 158.0, 14.0, 162.0, 41.0, 43.0, 7.0, 0.0, 186.0, 0.0, 0.0, 65.0, 37.0, 0.0, 42.0, 112.0, 0.0, 71.0, 124.0, 127.0, 0.0, 119.0, 12.0, 21.0, 20.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 38.0, 38.0, 45.0, 90.0, 74.0, 73.0, 134.0, 165.0, 179.0, 142.0, 35.0, 0.0, 0.0, 0.0, 9.0, 0.0, 119.0, 35.0, 0.0, 0.0, 0.0, 133.0, 16.0, 1.0, 41.0, 33.0, 3.0, 0.0, 75.0, 3.0, 16.0, 132.0, 83.0, 0.0, 62.0, 0.0, 0.0, 12.0, 183.0, 200.0, 3.0, 41.0, 38.0, 45.0, 2.0, 0.0, 30.0, 15.0, 103.0, 1.0, 3.0, 31.0, 168.0, 53.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 8.0, 27.0, 48.0, 0.0, 128.0, 49.0, 5.0, 29.0, 0.0, 0.0, 0.0, 54.0, 178.0, 0.0, 0.0, 0.0, 0.0, 91.0, 93.0, 21.0, 0.0, 78.0, 19.0, 28.0, 6.0, 0.0, 80.0, 0.0, 0.0, 61.0, 180.0, 26.0, 11.0, 0.0, 0.0, 19.0, 67.0, 4.0, 0.0, 150.0, 0.0, 112.0, 112.0, 0.0, 120.0, 0.0, 0.0, 86.0, 81.0, 177.0, 0.0, 0.0, 30.0, 106.0, 141.0, 1.0, 79.0, 66.0, 50.0, 76.0, 123.0, 127.0, 128.0, 22.0, 0.0, 0.0, 111.0, 68.0, 43.0, 45.0, 55.0, 92.0, 111.0, 1.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8799371777280435, "mean_inference_ms": 2.7789968026826206, "mean_action_processing_ms": 0.46045788265415977, "mean_env_wait_ms": 0.3201361359884385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012903571128845215, "StateBufferConnector_ms": 0.004919886589050293, "ViewRequirementAgentConnector_ms": 0.15630614757537842}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": -417.0, "episode_return_mean": 85.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.22679201515416, "num_env_steps_trained_throughput_per_sec": 331.22679201515416, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 13254.314, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13254.262, "sample_time_ms": 2153.738, "learn_time_ms": 11081.905, "learn_throughput": 360.949, "synch_weights_time_ms": 15.586}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "e1352_00002", "date": "2024-08-13_19-28-48", "timestamp": 1723591728, "time_this_iter_s": 12.122168779373169, "time_total_s": 1620.452482700348, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbb280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1620.452482700348, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 65.54705882352941, "ram_util_percent": 83.45294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9718694029267503, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 5.174970536004929, "policy_loss": -0.0014234348620342278, "vf_loss": 5.176128699665978, "vf_explained_var": 0.01630975219307753, "kl": 0.0074522607646273055, "entropy": 1.0881160797265472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.5715589477587, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 8.179797806815495, "policy_loss": -0.004770221250752608, "vf_loss": 8.184556553855774, "vf_explained_var": -0.060897090163811174, "kl": 0.017400246379086236, "entropy": 0.9586674828062612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 393.0, "episode_reward_min": -373.0, "episode_reward_mean": 69.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -468.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 294.0}, "policy_reward_mean": {"prey_policy": -13.265, "predator_policy": 47.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314.0, 297.0, 162.0, 132.0, 157.0, -95.0, 84.0, -58.0, 13.0, 393.0, 163.0, 304.0, 188.0, -15.0, 36.0, 81.0, -73.0, 130.0, 0.0, 236.0, -123.0, 0.0, 72.0, 156.0, 26.0, 83.0, -35.0, 9.0, 80.0, 240.0, 302.0, 100.0, 112.0, 104.0, 99.0, 120.0, 15.0, 94.0, -130.0, 14.0, 0.0, 339.0, 211.0, 190.0, 304.0, -4.0, 81.0, 40.0, 275.0, 367.0, -300.0, 205.0, 132.0, -93.0, 63.0, 103.0, 169.0, 27.0, 121.0, -335.0, 165.0, 85.0, 146.0, 191.0, -31.0, 32.0, -50.0, 260.0, 70.0, -338.0, 171.0, -108.0, 210.0, 23.0, 139.0, -93.0, 109.0, 14.0, 61.0, -16.0, 12.0, 250.0, 212.0, 21.0, -373.0, 132.0, 187.0, 140.0, 53.0, -85.0, -227.0, 160.0, 52.0, 61.0, 166.0, -4.0, -30.0, 28.0, 37.0, 22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-256.0, -244.0, 144.0, 153.0, 64.0, -4.0, 97.0, -7.0, 197.0, -152.0, -161.0, -129.0, -172.0, 129.0, -82.0, -107.0, 0.0, -28.0, 195.0, 197.0, 97.0, 65.0, 144.0, 160.0, -12.0, 124.0, -102.0, -48.0, -166.0, 55.0, -334.0, 116.0, -394.0, 0.0, 95.0, 0.0, 0.0, 0.0, 56.0, 171.0, -22.0, -255.0, 0.0, 0.0, -56.0, -5.0, 0.0, 139.0, 0.0, -48.0, 0.0, 80.0, 0.0, -113.0, -121.0, -18.0, 60.0, -63.0, 196.0, -18.0, 118.0, 172.0, -400.0, 117.0, 0.0, 68.0, -64.0, 85.0, 97.0, 0.0, 0.0, 75.0, 23.0, -112.0, 122.0, -62.0, -35.0, -316.0, 92.0, -156.0, 0.0, 0.0, 140.0, 199.0, 60.0, 136.0, 102.0, 88.0, 139.0, 140.0, -48.0, -31.0, -19.0, -28.0, -7.0, -7.0, 174.0, 72.0, 198.0, 169.0, -147.0, -385.0, 180.0, 25.0, 113.0, 19.0, -221.0, -56.0, 42.0, 0.0, -49.0, 55.0, 66.0, 69.0, 0.0, -53.0, 0.0, 121.0, -337.0, -239.0, 67.0, 61.0, 85.0, 0.0, 22.0, 38.0, 193.0, -6.0, -251.0, 70.0, -36.0, -156.0, -8.0, -162.0, 183.0, 77.0, 26.0, -123.0, -315.0, -200.0, 20.0, 121.0, -268.0, -87.0, 75.0, 55.0, -43.0, -50.0, -199.0, 139.0, -104.0, -244.0, 0.0, 87.0, -116.0, 19.0, -112.0, 62.0, -116.0, 0.0, -102.0, -89.0, 186.0, 57.0, 184.0, -20.0, 142.0, -273.0, -334.0, -238.0, 98.0, -84.0, 176.0, 0.0, 98.0, -61.0, -266.0, 117.0, -468.0, 87.0, -301.0, -112.0, 158.0, 0.0, -43.0, 14.0, -107.0, 98.0, 31.0, 105.0, -160.0, 0.0, -60.0, -111.0, -39.0, 5.0, -35.0, -62.0, 58.0, -227.0], "policy_predator_policy_reward": [0.0, 186.0, 0.0, 0.0, 65.0, 37.0, 0.0, 42.0, 112.0, 0.0, 71.0, 124.0, 127.0, 0.0, 119.0, 12.0, 21.0, 20.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 38.0, 38.0, 45.0, 90.0, 74.0, 73.0, 134.0, 165.0, 179.0, 142.0, 35.0, 0.0, 0.0, 0.0, 9.0, 0.0, 119.0, 35.0, 0.0, 0.0, 0.0, 133.0, 16.0, 1.0, 41.0, 33.0, 3.0, 0.0, 75.0, 3.0, 16.0, 132.0, 83.0, 0.0, 62.0, 0.0, 0.0, 12.0, 183.0, 200.0, 3.0, 41.0, 38.0, 45.0, 2.0, 0.0, 30.0, 15.0, 103.0, 1.0, 3.0, 31.0, 168.0, 53.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 8.0, 27.0, 48.0, 0.0, 128.0, 49.0, 5.0, 29.0, 0.0, 0.0, 0.0, 54.0, 178.0, 0.0, 0.0, 0.0, 0.0, 91.0, 93.0, 21.0, 0.0, 78.0, 19.0, 28.0, 6.0, 0.0, 80.0, 0.0, 0.0, 61.0, 180.0, 26.0, 11.0, 0.0, 0.0, 19.0, 67.0, 4.0, 0.0, 150.0, 0.0, 112.0, 112.0, 0.0, 120.0, 0.0, 0.0, 86.0, 81.0, 177.0, 0.0, 0.0, 30.0, 106.0, 141.0, 1.0, 79.0, 66.0, 50.0, 76.0, 123.0, 127.0, 128.0, 22.0, 0.0, 0.0, 111.0, 68.0, 43.0, 45.0, 55.0, 92.0, 111.0, 1.0, 6.0, 19.0, 29.0, 0.0, 152.0, 191.0, 8.0, 92.0, 26.0, 6.0, 5.0, 88.0, 15.0, 134.0, 68.0, 2.0, 294.0, 18.0, 168.0, 2.0, 0.0, 0.0, 81.0, 52.0, 18.0, 30.0, 0.0, 80.0, 76.0, 39.0, 102.0, 42.0, 20.0, 125.0, 9.0, 89.0, 102.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8799690493614309, "mean_inference_ms": 2.77880134207067, "mean_action_processing_ms": 0.45854010244111115, "mean_env_wait_ms": 0.32016725639054605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013264179229736328, "StateBufferConnector_ms": 0.005295515060424805, "ViewRequirementAgentConnector_ms": 0.14153432846069336}, "num_episodes": 18, "episode_return_max": 393.0, "episode_return_min": -373.0, "episode_return_mean": 69.08, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.92065573264233, "num_env_steps_trained_throughput_per_sec": 315.92065573264233, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 13339.014, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13338.961, "sample_time_ms": 2192.769, "learn_time_ms": 11128.174, "learn_throughput": 359.448, "synch_weights_time_ms": 15.037}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "e1352_00002", "date": "2024-08-13_19-29-00", "timestamp": 1723591740, "time_this_iter_s": 12.702776193618774, "time_total_s": 1633.1552588939667, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32d6bf940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1633.1552588939667, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 64.56666666666666, "ram_util_percent": 82.48333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6873371416771854, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 4.493126728295018, "policy_loss": -0.0020936492148037784, "vf_loss": 4.4947896418748075, "vf_explained_var": 0.029265017641915216, "kl": 0.012100856066787031, "entropy": 1.102545986036775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.61841211924477, "cur_kl_coeff": 0.0006591796875, "cur_lr": 0.00010000000000000003, "total_loss": 7.893317497344244, "policy_loss": -0.00020690661702285368, "vf_loss": 7.8935218700025445, "vf_explained_var": -0.0530991895488961, "kl": 0.0038660400943309283, "entropy": 0.9268512283683454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -389.0, "episode_reward_mean": 80.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -468.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 294.0}, "policy_reward_mean": {"prey_policy": -5.83, "predator_policy": 45.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.0, 156.0, 26.0, 83.0, -35.0, 9.0, 80.0, 240.0, 302.0, 100.0, 112.0, 104.0, 99.0, 120.0, 15.0, 94.0, -130.0, 14.0, 0.0, 339.0, 211.0, 190.0, 304.0, -4.0, 81.0, 40.0, 275.0, 367.0, -300.0, 205.0, 132.0, -93.0, 63.0, 103.0, 169.0, 27.0, 121.0, -335.0, 165.0, 85.0, 146.0, 191.0, -31.0, 32.0, -50.0, 260.0, 70.0, -338.0, 171.0, -108.0, 210.0, 23.0, 139.0, -93.0, 109.0, 14.0, 61.0, -16.0, 12.0, 250.0, 212.0, 21.0, -373.0, 132.0, 187.0, 140.0, 53.0, -85.0, -227.0, 160.0, 52.0, 61.0, 166.0, -4.0, -30.0, 28.0, 37.0, 22.0, -389.0, 176.0, 279.0, 42.0, 40.0, 189.0, 81.0, 18.0, 0.0, 49.0, 350.0, 215.0, 376.0, 326.0, 380.0, 139.0, 156.0, -130.0, 122.0, 92.0, -35.0, 337.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-56.0, -5.0, 0.0, 139.0, 0.0, -48.0, 0.0, 80.0, 0.0, -113.0, -121.0, -18.0, 60.0, -63.0, 196.0, -18.0, 118.0, 172.0, -400.0, 117.0, 0.0, 68.0, -64.0, 85.0, 97.0, 0.0, 0.0, 75.0, 23.0, -112.0, 122.0, -62.0, -35.0, -316.0, 92.0, -156.0, 0.0, 0.0, 140.0, 199.0, 60.0, 136.0, 102.0, 88.0, 139.0, 140.0, -48.0, -31.0, -19.0, -28.0, -7.0, -7.0, 174.0, 72.0, 198.0, 169.0, -147.0, -385.0, 180.0, 25.0, 113.0, 19.0, -221.0, -56.0, 42.0, 0.0, -49.0, 55.0, 66.0, 69.0, 0.0, -53.0, 0.0, 121.0, -337.0, -239.0, 67.0, 61.0, 85.0, 0.0, 22.0, 38.0, 193.0, -6.0, -251.0, 70.0, -36.0, -156.0, -8.0, -162.0, 183.0, 77.0, 26.0, -123.0, -315.0, -200.0, 20.0, 121.0, -268.0, -87.0, 75.0, 55.0, -43.0, -50.0, -199.0, 139.0, -104.0, -244.0, 0.0, 87.0, -116.0, 19.0, -112.0, 62.0, -116.0, 0.0, -102.0, -89.0, 186.0, 57.0, 184.0, -20.0, 142.0, -273.0, -334.0, -238.0, 98.0, -84.0, 176.0, 0.0, 98.0, -61.0, -266.0, 117.0, -468.0, 87.0, -301.0, -112.0, 158.0, 0.0, -43.0, 14.0, -107.0, 98.0, 31.0, 105.0, -160.0, 0.0, -60.0, -111.0, -39.0, 5.0, -35.0, -62.0, 58.0, -227.0, -346.0, -280.0, 105.0, 51.0, 64.0, 166.0, 99.0, -190.0, -301.0, 82.0, 19.0, 170.0, 57.0, -51.0, 18.0, 0.0, 0.0, 0.0, 65.0, -52.0, 155.0, 195.0, 96.0, 71.0, 199.0, 166.0, 99.0, 164.0, 190.0, 188.0, 111.0, -61.0, 20.0, 100.0, -147.0, -207.0, 121.0, -12.0, 140.0, -232.0, -68.0, -201.0, 167.0, 141.0], "policy_predator_policy_reward": [0.0, 133.0, 16.0, 1.0, 41.0, 33.0, 3.0, 0.0, 75.0, 3.0, 16.0, 132.0, 83.0, 0.0, 62.0, 0.0, 0.0, 12.0, 183.0, 200.0, 3.0, 41.0, 38.0, 45.0, 2.0, 0.0, 30.0, 15.0, 103.0, 1.0, 3.0, 31.0, 168.0, 53.0, 78.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 17.0, 8.0, 27.0, 48.0, 0.0, 128.0, 49.0, 5.0, 29.0, 0.0, 0.0, 0.0, 54.0, 178.0, 0.0, 0.0, 0.0, 0.0, 91.0, 93.0, 21.0, 0.0, 78.0, 19.0, 28.0, 6.0, 0.0, 80.0, 0.0, 0.0, 61.0, 180.0, 26.0, 11.0, 0.0, 0.0, 19.0, 67.0, 4.0, 0.0, 150.0, 0.0, 112.0, 112.0, 0.0, 120.0, 0.0, 0.0, 86.0, 81.0, 177.0, 0.0, 0.0, 30.0, 106.0, 141.0, 1.0, 79.0, 66.0, 50.0, 76.0, 123.0, 127.0, 128.0, 22.0, 0.0, 0.0, 111.0, 68.0, 43.0, 45.0, 55.0, 92.0, 111.0, 1.0, 6.0, 19.0, 29.0, 0.0, 152.0, 191.0, 8.0, 92.0, 26.0, 6.0, 5.0, 88.0, 15.0, 134.0, 68.0, 2.0, 294.0, 18.0, 168.0, 2.0, 0.0, 0.0, 81.0, 52.0, 18.0, 30.0, 0.0, 80.0, 76.0, 39.0, 102.0, 42.0, 20.0, 125.0, 9.0, 89.0, 102.0, 127.0, 110.0, 1.0, 19.0, 44.0, 5.0, 12.0, 121.0, 163.0, 96.0, 0.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 26.0, 10.0, 0.0, 0.0, 19.0, 29.0, 0.0, 11.0, 31.0, 32.0, 2.0, 0.0, 48.0, 41.0, 36.0, 0.0, 92.0, 132.0, 7.0, 6.0, 144.0, 40.0, 78.0, 156.0, 29.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8802047695706403, "mean_inference_ms": 2.776394699634795, "mean_action_processing_ms": 0.4566188358506718, "mean_env_wait_ms": 0.3204867716726647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011065125465393066, "StateBufferConnector_ms": 0.00536501407623291, "ViewRequirementAgentConnector_ms": 0.1392606496810913}, "num_episodes": 22, "episode_return_max": 380.0, "episode_return_min": -389.0, "episode_return_mean": 80.23, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.50487416791117, "num_env_steps_trained_throughput_per_sec": 317.50487416791117, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 13162.795, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13162.748, "sample_time_ms": 2199.83, "learn_time_ms": 10943.569, "learn_throughput": 365.511, "synch_weights_time_ms": 16.489}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "e1352_00002", "date": "2024-08-13_19-29-13", "timestamp": 1723591753, "time_this_iter_s": 12.641398668289185, "time_total_s": 1645.7966575622559, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1645.7966575622559, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 59.905555555555566, "ram_util_percent": 83.32222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1287584011832243, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 0.00010000000000000003, "total_loss": 5.351703136434, "policy_loss": -0.003790555979376511, "vf_loss": 5.354644873154857, "vf_explained_var": 0.08624833506881875, "kl": 0.023846277272608407, "entropy": 1.170523177757465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.996302068296565, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.83647291698153, "policy_loss": 0.00016308070084070244, "vf_loss": 7.836306914324483, "vf_explained_var": -0.1810068562863365, "kl": 0.008848458475205202, "entropy": 0.9339425071206673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -389.0, "episode_reward_mean": 72.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -468.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 294.0}, "policy_reward_mean": {"prey_policy": -15.035, "predator_policy": 51.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, 81.0, 40.0, 275.0, 367.0, -300.0, 205.0, 132.0, -93.0, 63.0, 103.0, 169.0, 27.0, 121.0, -335.0, 165.0, 85.0, 146.0, 191.0, -31.0, 32.0, -50.0, 260.0, 70.0, -338.0, 171.0, -108.0, 210.0, 23.0, 139.0, -93.0, 109.0, 14.0, 61.0, -16.0, 12.0, 250.0, 212.0, 21.0, -373.0, 132.0, 187.0, 140.0, 53.0, -85.0, -227.0, 160.0, 52.0, 61.0, 166.0, -4.0, -30.0, 28.0, 37.0, 22.0, -389.0, 176.0, 279.0, 42.0, 40.0, 189.0, 81.0, 18.0, 0.0, 49.0, 350.0, 215.0, 376.0, 326.0, 380.0, 139.0, 156.0, -130.0, 122.0, 92.0, -35.0, 337.0, -145.0, 298.0, -127.0, 35.0, 96.0, 52.0, 149.0, 193.0, 230.0, 166.0, -348.0, -43.0, 214.0, 248.0, -96.0, 102.0, -4.0, 335.0, 3.0, -132.0, 200.0, 201.0, 74.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-48.0, -31.0, -19.0, -28.0, -7.0, -7.0, 174.0, 72.0, 198.0, 169.0, -147.0, -385.0, 180.0, 25.0, 113.0, 19.0, -221.0, -56.0, 42.0, 0.0, -49.0, 55.0, 66.0, 69.0, 0.0, -53.0, 0.0, 121.0, -337.0, -239.0, 67.0, 61.0, 85.0, 0.0, 22.0, 38.0, 193.0, -6.0, -251.0, 70.0, -36.0, -156.0, -8.0, -162.0, 183.0, 77.0, 26.0, -123.0, -315.0, -200.0, 20.0, 121.0, -268.0, -87.0, 75.0, 55.0, -43.0, -50.0, -199.0, 139.0, -104.0, -244.0, 0.0, 87.0, -116.0, 19.0, -112.0, 62.0, -116.0, 0.0, -102.0, -89.0, 186.0, 57.0, 184.0, -20.0, 142.0, -273.0, -334.0, -238.0, 98.0, -84.0, 176.0, 0.0, 98.0, -61.0, -266.0, 117.0, -468.0, 87.0, -301.0, -112.0, 158.0, 0.0, -43.0, 14.0, -107.0, 98.0, 31.0, 105.0, -160.0, 0.0, -60.0, -111.0, -39.0, 5.0, -35.0, -62.0, 58.0, -227.0, -346.0, -280.0, 105.0, 51.0, 64.0, 166.0, 99.0, -190.0, -301.0, 82.0, 19.0, 170.0, 57.0, -51.0, 18.0, 0.0, 0.0, 0.0, 65.0, -52.0, 155.0, 195.0, 96.0, 71.0, 199.0, 166.0, 99.0, 164.0, 190.0, 188.0, 111.0, -61.0, 20.0, 100.0, -147.0, -207.0, 121.0, -12.0, 140.0, -232.0, -68.0, -201.0, 167.0, 141.0, -280.0, -115.0, 147.0, 117.0, -53.0, -304.0, -247.0, 130.0, -118.0, 67.0, -12.0, 0.0, 130.0, 0.0, 0.0, 190.0, 95.0, 130.0, -53.0, 118.0, -232.0, -307.0, -373.0, 25.0, 129.0, 8.0, 140.0, 76.0, -223.0, -180.0, -209.0, 168.0, -90.0, -13.0, 172.0, 156.0, -224.0, 0.0, -298.0, 0.0, 200.0, 0.0, 22.0, 141.0, 26.0, -36.0], "policy_predator_policy_reward": [27.0, 48.0, 0.0, 128.0, 49.0, 5.0, 29.0, 0.0, 0.0, 0.0, 54.0, 178.0, 0.0, 0.0, 0.0, 0.0, 91.0, 93.0, 21.0, 0.0, 78.0, 19.0, 28.0, 6.0, 0.0, 80.0, 0.0, 0.0, 61.0, 180.0, 26.0, 11.0, 0.0, 0.0, 19.0, 67.0, 4.0, 0.0, 150.0, 0.0, 112.0, 112.0, 0.0, 120.0, 0.0, 0.0, 86.0, 81.0, 177.0, 0.0, 0.0, 30.0, 106.0, 141.0, 1.0, 79.0, 66.0, 50.0, 76.0, 123.0, 127.0, 128.0, 22.0, 0.0, 0.0, 111.0, 68.0, 43.0, 45.0, 55.0, 92.0, 111.0, 1.0, 6.0, 19.0, 29.0, 0.0, 152.0, 191.0, 8.0, 92.0, 26.0, 6.0, 5.0, 88.0, 15.0, 134.0, 68.0, 2.0, 294.0, 18.0, 168.0, 2.0, 0.0, 0.0, 81.0, 52.0, 18.0, 30.0, 0.0, 80.0, 76.0, 39.0, 102.0, 42.0, 20.0, 125.0, 9.0, 89.0, 102.0, 127.0, 110.0, 1.0, 19.0, 44.0, 5.0, 12.0, 121.0, 163.0, 96.0, 0.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 26.0, 10.0, 0.0, 0.0, 19.0, 29.0, 0.0, 11.0, 31.0, 32.0, 2.0, 0.0, 48.0, 41.0, 36.0, 0.0, 92.0, 132.0, 7.0, 6.0, 144.0, 40.0, 78.0, 156.0, 29.0, 0.0, 92.0, 158.0, 34.0, 0.0, 74.0, 156.0, 0.0, 152.0, 84.0, 63.0, 64.0, 0.0, 19.0, 0.0, 3.0, 0.0, 0.0, 5.0, 101.0, 0.0, 17.0, 174.0, 163.0, 142.0, 77.0, 0.0, 27.0, 5.0, 150.0, 157.0, 143.0, 0.0, 99.0, 0.0, 5.0, 2.0, 140.0, 87.0, 0.0, 166.0, 0.0, 0.0, 0.0, 38.0, 84.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8832349278310656, "mean_inference_ms": 2.7904207532693595, "mean_action_processing_ms": 0.4558568359946388, "mean_env_wait_ms": 0.32171151208981746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010123014450073242, "StateBufferConnector_ms": 0.0044248104095458984, "ViewRequirementAgentConnector_ms": 0.16822147369384766}, "num_episodes": 23, "episode_return_max": 380.0, "episode_return_min": -389.0, "episode_return_mean": 72.19, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.17387236354875, "num_env_steps_trained_throughput_per_sec": 288.17387236354875, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 13405.431, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13405.379, "sample_time_ms": 2362.891, "learn_time_ms": 11024.78, "learn_throughput": 362.819, "synch_weights_time_ms": 14.912}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "e1352_00002", "date": "2024-08-13_19-29-27", "timestamp": 1723591767, "time_this_iter_s": 13.901051998138428, "time_total_s": 1659.6977095603943, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1659.6977095603943, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 62.19500000000001, "ram_util_percent": 75.76500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.312484098679174, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 5.771536771330253, "policy_loss": -0.005587425724499755, "vf_loss": 5.776286511698728, "vf_explained_var": 0.07984123952174313, "kl": 0.01568881958377792, "entropy": 1.0926429437581824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.770748354707447, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.733732495484528, "policy_loss": -0.0019757463937999787, "vf_loss": 8.735703409790363, "vf_explained_var": -0.13906070583711858, "kl": 0.014610401576300249, "entropy": 0.8190032538282808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -389.0, "episode_reward_mean": 76.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -468.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 294.0}, "policy_reward_mean": {"prey_policy": -17.78, "predator_policy": 56.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0, -31.0, 32.0, -50.0, 260.0, 70.0, -338.0, 171.0, -108.0, 210.0, 23.0, 139.0, -93.0, 109.0, 14.0, 61.0, -16.0, 12.0, 250.0, 212.0, 21.0, -373.0, 132.0, 187.0, 140.0, 53.0, -85.0, -227.0, 160.0, 52.0, 61.0, 166.0, -4.0, -30.0, 28.0, 37.0, 22.0, -389.0, 176.0, 279.0, 42.0, 40.0, 189.0, 81.0, 18.0, 0.0, 49.0, 350.0, 215.0, 376.0, 326.0, 380.0, 139.0, 156.0, -130.0, 122.0, 92.0, -35.0, 337.0, -145.0, 298.0, -127.0, 35.0, 96.0, 52.0, 149.0, 193.0, 230.0, 166.0, -348.0, -43.0, 214.0, 248.0, -96.0, 102.0, -4.0, 335.0, 3.0, -132.0, 200.0, 201.0, 74.0, 117.0, -46.0, 88.0, 148.0, 296.0, 243.0, 11.0, -281.0, 132.0, 104.0, 347.0, -58.0, 8.0, 18.0, 230.0, 181.0, 76.0, 112.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [193.0, -6.0, -251.0, 70.0, -36.0, -156.0, -8.0, -162.0, 183.0, 77.0, 26.0, -123.0, -315.0, -200.0, 20.0, 121.0, -268.0, -87.0, 75.0, 55.0, -43.0, -50.0, -199.0, 139.0, -104.0, -244.0, 0.0, 87.0, -116.0, 19.0, -112.0, 62.0, -116.0, 0.0, -102.0, -89.0, 186.0, 57.0, 184.0, -20.0, 142.0, -273.0, -334.0, -238.0, 98.0, -84.0, 176.0, 0.0, 98.0, -61.0, -266.0, 117.0, -468.0, 87.0, -301.0, -112.0, 158.0, 0.0, -43.0, 14.0, -107.0, 98.0, 31.0, 105.0, -160.0, 0.0, -60.0, -111.0, -39.0, 5.0, -35.0, -62.0, 58.0, -227.0, -346.0, -280.0, 105.0, 51.0, 64.0, 166.0, 99.0, -190.0, -301.0, 82.0, 19.0, 170.0, 57.0, -51.0, 18.0, 0.0, 0.0, 0.0, 65.0, -52.0, 155.0, 195.0, 96.0, 71.0, 199.0, 166.0, 99.0, 164.0, 190.0, 188.0, 111.0, -61.0, 20.0, 100.0, -147.0, -207.0, 121.0, -12.0, 140.0, -232.0, -68.0, -201.0, 167.0, 141.0, -280.0, -115.0, 147.0, 117.0, -53.0, -304.0, -247.0, 130.0, -118.0, 67.0, -12.0, 0.0, 130.0, 0.0, 0.0, 190.0, 95.0, 130.0, -53.0, 118.0, -232.0, -307.0, -373.0, 25.0, 129.0, 8.0, 140.0, 76.0, -223.0, -180.0, -209.0, 168.0, -90.0, -13.0, 172.0, 156.0, -224.0, 0.0, -298.0, 0.0, 200.0, 0.0, 22.0, 141.0, 26.0, -36.0, -113.0, 135.0, -259.0, -112.0, 67.0, -124.0, 0.0, 144.0, 67.0, 177.0, 39.0, 136.0, -70.0, -10.0, -298.0, -170.0, 157.0, -141.0, -200.0, 91.0, 156.0, 189.0, -10.0, -152.0, -322.0, 53.0, -145.0, 17.0, 123.0, 10.0, -66.0, 143.0, -42.0, 30.0, -54.0, -46.0], "policy_predator_policy_reward": [4.0, 0.0, 150.0, 0.0, 112.0, 112.0, 0.0, 120.0, 0.0, 0.0, 86.0, 81.0, 177.0, 0.0, 0.0, 30.0, 106.0, 141.0, 1.0, 79.0, 66.0, 50.0, 76.0, 123.0, 127.0, 128.0, 22.0, 0.0, 0.0, 111.0, 68.0, 43.0, 45.0, 55.0, 92.0, 111.0, 1.0, 6.0, 19.0, 29.0, 0.0, 152.0, 191.0, 8.0, 92.0, 26.0, 6.0, 5.0, 88.0, 15.0, 134.0, 68.0, 2.0, 294.0, 18.0, 168.0, 2.0, 0.0, 0.0, 81.0, 52.0, 18.0, 30.0, 0.0, 80.0, 76.0, 39.0, 102.0, 42.0, 20.0, 125.0, 9.0, 89.0, 102.0, 127.0, 110.0, 1.0, 19.0, 44.0, 5.0, 12.0, 121.0, 163.0, 96.0, 0.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 26.0, 10.0, 0.0, 0.0, 19.0, 29.0, 0.0, 11.0, 31.0, 32.0, 2.0, 0.0, 48.0, 41.0, 36.0, 0.0, 92.0, 132.0, 7.0, 6.0, 144.0, 40.0, 78.0, 156.0, 29.0, 0.0, 92.0, 158.0, 34.0, 0.0, 74.0, 156.0, 0.0, 152.0, 84.0, 63.0, 64.0, 0.0, 19.0, 0.0, 3.0, 0.0, 0.0, 5.0, 101.0, 0.0, 17.0, 174.0, 163.0, 142.0, 77.0, 0.0, 27.0, 5.0, 150.0, 157.0, 143.0, 0.0, 99.0, 0.0, 5.0, 2.0, 140.0, 87.0, 0.0, 166.0, 0.0, 0.0, 0.0, 38.0, 84.0, 0.0, 95.0, 0.0, 155.0, 170.0, 145.0, 0.0, 0.0, 4.0, 10.0, 42.0, 13.0, 55.0, 91.0, 0.0, 0.0, 187.0, 112.0, 4.0, 97.0, 116.0, 0.0, 2.0, 0.0, 104.0, 172.0, 105.0, 113.0, 33.0, 63.0, 34.0, 94.0, 10.0, 0.0, 88.0, 98.0, 114.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8880558169039429, "mean_inference_ms": 2.8012745767136478, "mean_action_processing_ms": 0.45579976139592643, "mean_env_wait_ms": 0.3228154855649274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00813746452331543, "StateBufferConnector_ms": 0.0047986507415771484, "ViewRequirementAgentConnector_ms": 0.18776893615722656}, "num_episodes": 18, "episode_return_max": 380.0, "episode_return_min": -389.0, "episode_return_mean": 76.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.25852741691043, "num_env_steps_trained_throughput_per_sec": 217.25852741691043, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 13916.813, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13916.759, "sample_time_ms": 2345.536, "learn_time_ms": 11552.216, "learn_throughput": 346.254, "synch_weights_time_ms": 15.777}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "e1352_00002", "date": "2024-08-13_19-29-46", "timestamp": 1723591786, "time_this_iter_s": 18.485755920410156, "time_total_s": 1678.1834654808044, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1678.1834654808044, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 86.96538461538461, "ram_util_percent": 81.63846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.518785017452858, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 0.00010000000000000003, "total_loss": 5.093400248396334, "policy_loss": -0.0054147768179299656, "vf_loss": 5.0974199843785115, "vf_explained_var": 0.05234293811535709, "kl": 0.02612757469551053, "entropy": 1.091532540132129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.070500898266594, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.103649594039513, "policy_loss": -0.0004929984413412591, "vf_loss": 8.104139827798914, "vf_explained_var": -0.14849224497401525, "kl": 0.008315980875232238, "entropy": 0.8462360465021991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -389.0, "episode_reward_mean": 91.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -468.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 294.0}, "policy_reward_mean": {"prey_policy": -7.4, "predator_policy": 53.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0, 212.0, 21.0, -373.0, 132.0, 187.0, 140.0, 53.0, -85.0, -227.0, 160.0, 52.0, 61.0, 166.0, -4.0, -30.0, 28.0, 37.0, 22.0, -389.0, 176.0, 279.0, 42.0, 40.0, 189.0, 81.0, 18.0, 0.0, 49.0, 350.0, 215.0, 376.0, 326.0, 380.0, 139.0, 156.0, -130.0, 122.0, 92.0, -35.0, 337.0, -145.0, 298.0, -127.0, 35.0, 96.0, 52.0, 149.0, 193.0, 230.0, 166.0, -348.0, -43.0, 214.0, 248.0, -96.0, 102.0, -4.0, 335.0, 3.0, -132.0, 200.0, 201.0, 74.0, 117.0, -46.0, 88.0, 148.0, 296.0, 243.0, 11.0, -281.0, 132.0, 104.0, 347.0, -58.0, 8.0, 18.0, 230.0, 181.0, 76.0, 112.0, 39.0, 120.0, 71.0, -61.0, 264.0, -92.0, 120.0, 195.0, 228.0, 194.0, 253.0, 68.0, 86.0, 162.0, 339.0, -121.0, 66.0, 210.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [186.0, 57.0, 184.0, -20.0, 142.0, -273.0, -334.0, -238.0, 98.0, -84.0, 176.0, 0.0, 98.0, -61.0, -266.0, 117.0, -468.0, 87.0, -301.0, -112.0, 158.0, 0.0, -43.0, 14.0, -107.0, 98.0, 31.0, 105.0, -160.0, 0.0, -60.0, -111.0, -39.0, 5.0, -35.0, -62.0, 58.0, -227.0, -346.0, -280.0, 105.0, 51.0, 64.0, 166.0, 99.0, -190.0, -301.0, 82.0, 19.0, 170.0, 57.0, -51.0, 18.0, 0.0, 0.0, 0.0, 65.0, -52.0, 155.0, 195.0, 96.0, 71.0, 199.0, 166.0, 99.0, 164.0, 190.0, 188.0, 111.0, -61.0, 20.0, 100.0, -147.0, -207.0, 121.0, -12.0, 140.0, -232.0, -68.0, -201.0, 167.0, 141.0, -280.0, -115.0, 147.0, 117.0, -53.0, -304.0, -247.0, 130.0, -118.0, 67.0, -12.0, 0.0, 130.0, 0.0, 0.0, 190.0, 95.0, 130.0, -53.0, 118.0, -232.0, -307.0, -373.0, 25.0, 129.0, 8.0, 140.0, 76.0, -223.0, -180.0, -209.0, 168.0, -90.0, -13.0, 172.0, 156.0, -224.0, 0.0, -298.0, 0.0, 200.0, 0.0, 22.0, 141.0, 26.0, -36.0, -113.0, 135.0, -259.0, -112.0, 67.0, -124.0, 0.0, 144.0, 67.0, 177.0, 39.0, 136.0, -70.0, -10.0, -298.0, -170.0, 157.0, -141.0, -200.0, 91.0, 156.0, 189.0, -10.0, -152.0, -322.0, 53.0, -145.0, 17.0, 123.0, 10.0, -66.0, 143.0, -42.0, 30.0, -54.0, -46.0, 128.0, -245.0, 0.0, 116.0, 114.0, -176.0, -191.0, 0.0, 105.0, 135.0, -319.0, -116.0, 105.0, -118.0, 0.0, 195.0, 127.0, 71.0, -9.0, 120.0, 149.0, 89.0, 61.0, -129.0, -36.0, 104.0, -139.0, 191.0, 182.0, 147.0, -390.0, -18.0, -34.0, 23.0, 85.0, 89.0], "policy_predator_policy_reward": [1.0, 6.0, 19.0, 29.0, 0.0, 152.0, 191.0, 8.0, 92.0, 26.0, 6.0, 5.0, 88.0, 15.0, 134.0, 68.0, 2.0, 294.0, 18.0, 168.0, 2.0, 0.0, 0.0, 81.0, 52.0, 18.0, 30.0, 0.0, 80.0, 76.0, 39.0, 102.0, 42.0, 20.0, 125.0, 9.0, 89.0, 102.0, 127.0, 110.0, 1.0, 19.0, 44.0, 5.0, 12.0, 121.0, 163.0, 96.0, 0.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 26.0, 10.0, 0.0, 0.0, 19.0, 29.0, 0.0, 11.0, 31.0, 32.0, 2.0, 0.0, 48.0, 41.0, 36.0, 0.0, 92.0, 132.0, 7.0, 6.0, 144.0, 40.0, 78.0, 156.0, 29.0, 0.0, 92.0, 158.0, 34.0, 0.0, 74.0, 156.0, 0.0, 152.0, 84.0, 63.0, 64.0, 0.0, 19.0, 0.0, 3.0, 0.0, 0.0, 5.0, 101.0, 0.0, 17.0, 174.0, 163.0, 142.0, 77.0, 0.0, 27.0, 5.0, 150.0, 157.0, 143.0, 0.0, 99.0, 0.0, 5.0, 2.0, 140.0, 87.0, 0.0, 166.0, 0.0, 0.0, 0.0, 38.0, 84.0, 0.0, 95.0, 0.0, 155.0, 170.0, 145.0, 0.0, 0.0, 4.0, 10.0, 42.0, 13.0, 55.0, 91.0, 0.0, 0.0, 187.0, 112.0, 4.0, 97.0, 116.0, 0.0, 2.0, 0.0, 104.0, 172.0, 105.0, 113.0, 33.0, 63.0, 34.0, 94.0, 10.0, 0.0, 88.0, 98.0, 114.0, 153.0, 3.0, 4.0, 0.0, 83.0, 50.0, 0.0, 130.0, 0.0, 24.0, 159.0, 184.0, 0.0, 133.0, 0.0, 0.0, 7.0, 23.0, 83.0, 0.0, 15.0, 0.0, 135.0, 1.0, 18.0, 0.0, 15.0, 95.0, 2.0, 8.0, 91.0, 196.0, 29.0, 48.0, 35.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8938999366619447, "mean_inference_ms": 2.8193317228947836, "mean_action_processing_ms": 0.4566735047781464, "mean_env_wait_ms": 0.3247031383807903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008098602294921875, "StateBufferConnector_ms": 0.004841804504394531, "ViewRequirementAgentConnector_ms": 0.18870234489440918}, "num_episodes": 18, "episode_return_max": 380.0, "episode_return_min": -389.0, "episode_return_mean": 91.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.2508866480446, "num_env_steps_trained_throughput_per_sec": 294.2508866480446, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 14023.777, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14023.726, "sample_time_ms": 2427.959, "learn_time_ms": 11577.754, "learn_throughput": 345.49, "synch_weights_time_ms": 15.398}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "e1352_00002", "date": "2024-08-13_19-29-59", "timestamp": 1723591799, "time_this_iter_s": 13.60247802734375, "time_total_s": 1691.7859435081482, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1691.7859435081482, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 57.931578947368415, "ram_util_percent": 77.5421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.564994019679922, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 5.94547119191084, "policy_loss": -0.0015313872495892817, "vf_loss": 5.94616898153194, "vf_explained_var": 0.003149792693910145, "kl": 0.010408154786081841, "entropy": 0.9847789237738918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.03139821401349, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.3039532383913714, "policy_loss": -0.0003932596228661991, "vf_loss": 7.304342671803066, "vf_explained_var": -0.25798245283661697, "kl": 0.011589572344619055, "entropy": 1.0133430704237922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -389.0, "episode_reward_mean": 95.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -5.98, "predator_policy": 53.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, -389.0, 176.0, 279.0, 42.0, 40.0, 189.0, 81.0, 18.0, 0.0, 49.0, 350.0, 215.0, 376.0, 326.0, 380.0, 139.0, 156.0, -130.0, 122.0, 92.0, -35.0, 337.0, -145.0, 298.0, -127.0, 35.0, 96.0, 52.0, 149.0, 193.0, 230.0, 166.0, -348.0, -43.0, 214.0, 248.0, -96.0, 102.0, -4.0, 335.0, 3.0, -132.0, 200.0, 201.0, 74.0, 117.0, -46.0, 88.0, 148.0, 296.0, 243.0, 11.0, -281.0, 132.0, 104.0, 347.0, -58.0, 8.0, 18.0, 230.0, 181.0, 76.0, 112.0, 39.0, 120.0, 71.0, -61.0, 264.0, -92.0, 120.0, 195.0, 228.0, 194.0, 253.0, 68.0, 86.0, 162.0, 339.0, -121.0, 66.0, 210.0, 81.0, 108.0, 182.0, 126.0, -45.0, 121.0, 289.0, 134.0, -172.0, 12.0, 162.0, 0.0, 37.0, 39.0, -100.0, -58.0, -2.0, 220.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [58.0, -227.0, -346.0, -280.0, 105.0, 51.0, 64.0, 166.0, 99.0, -190.0, -301.0, 82.0, 19.0, 170.0, 57.0, -51.0, 18.0, 0.0, 0.0, 0.0, 65.0, -52.0, 155.0, 195.0, 96.0, 71.0, 199.0, 166.0, 99.0, 164.0, 190.0, 188.0, 111.0, -61.0, 20.0, 100.0, -147.0, -207.0, 121.0, -12.0, 140.0, -232.0, -68.0, -201.0, 167.0, 141.0, -280.0, -115.0, 147.0, 117.0, -53.0, -304.0, -247.0, 130.0, -118.0, 67.0, -12.0, 0.0, 130.0, 0.0, 0.0, 190.0, 95.0, 130.0, -53.0, 118.0, -232.0, -307.0, -373.0, 25.0, 129.0, 8.0, 140.0, 76.0, -223.0, -180.0, -209.0, 168.0, -90.0, -13.0, 172.0, 156.0, -224.0, 0.0, -298.0, 0.0, 200.0, 0.0, 22.0, 141.0, 26.0, -36.0, -113.0, 135.0, -259.0, -112.0, 67.0, -124.0, 0.0, 144.0, 67.0, 177.0, 39.0, 136.0, -70.0, -10.0, -298.0, -170.0, 157.0, -141.0, -200.0, 91.0, 156.0, 189.0, -10.0, -152.0, -322.0, 53.0, -145.0, 17.0, 123.0, 10.0, -66.0, 143.0, -42.0, 30.0, -54.0, -46.0, 128.0, -245.0, 0.0, 116.0, 114.0, -176.0, -191.0, 0.0, 105.0, 135.0, -319.0, -116.0, 105.0, -118.0, 0.0, 195.0, 127.0, 71.0, -9.0, 120.0, 149.0, 89.0, 61.0, -129.0, -36.0, 104.0, -139.0, 191.0, 182.0, 147.0, -390.0, -18.0, -34.0, 23.0, 85.0, 89.0, -220.0, 102.0, 0.0, 108.0, -155.0, 176.0, 0.0, 97.0, -292.0, 65.0, 24.0, 47.0, 110.0, 179.0, -46.0, 107.0, -214.0, -158.0, -18.0, -44.0, -131.0, 151.0, 0.0, 0.0, -17.0, -42.0, 116.0, -280.0, -311.0, -34.0, -337.0, 71.0, 61.0, -245.0, 164.0, 32.0], "policy_predator_policy_reward": [89.0, 102.0, 127.0, 110.0, 1.0, 19.0, 44.0, 5.0, 12.0, 121.0, 163.0, 96.0, 0.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 26.0, 10.0, 0.0, 0.0, 19.0, 29.0, 0.0, 11.0, 31.0, 32.0, 2.0, 0.0, 48.0, 41.0, 36.0, 0.0, 92.0, 132.0, 7.0, 6.0, 144.0, 40.0, 78.0, 156.0, 29.0, 0.0, 92.0, 158.0, 34.0, 0.0, 74.0, 156.0, 0.0, 152.0, 84.0, 63.0, 64.0, 0.0, 19.0, 0.0, 3.0, 0.0, 0.0, 5.0, 101.0, 0.0, 17.0, 174.0, 163.0, 142.0, 77.0, 0.0, 27.0, 5.0, 150.0, 157.0, 143.0, 0.0, 99.0, 0.0, 5.0, 2.0, 140.0, 87.0, 0.0, 166.0, 0.0, 0.0, 0.0, 38.0, 84.0, 0.0, 95.0, 0.0, 155.0, 170.0, 145.0, 0.0, 0.0, 4.0, 10.0, 42.0, 13.0, 55.0, 91.0, 0.0, 0.0, 187.0, 112.0, 4.0, 97.0, 116.0, 0.0, 2.0, 0.0, 104.0, 172.0, 105.0, 113.0, 33.0, 63.0, 34.0, 94.0, 10.0, 0.0, 88.0, 98.0, 114.0, 153.0, 3.0, 4.0, 0.0, 83.0, 50.0, 0.0, 130.0, 0.0, 24.0, 159.0, 184.0, 0.0, 133.0, 0.0, 0.0, 7.0, 23.0, 83.0, 0.0, 15.0, 0.0, 135.0, 1.0, 18.0, 0.0, 15.0, 95.0, 2.0, 8.0, 91.0, 196.0, 29.0, 48.0, 35.0, 1.0, 60.0, 139.0, 0.0, 0.0, 44.0, 117.0, 26.0, 3.0, 0.0, 182.0, 15.0, 35.0, 0.0, 0.0, 37.0, 36.0, 168.0, 32.0, 9.0, 65.0, 81.0, 61.0, 0.0, 0.0, 59.0, 37.0, 100.0, 103.0, 82.0, 163.0, 35.0, 173.0, 75.0, 107.0, 22.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9022688472770577, "mean_inference_ms": 2.8435045581886764, "mean_action_processing_ms": 0.4583203738096712, "mean_env_wait_ms": 0.32711459591835707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010002493858337402, "StateBufferConnector_ms": 0.004907727241516113, "ViewRequirementAgentConnector_ms": 0.20854127407073975}, "num_episodes": 18, "episode_return_max": 380.0, "episode_return_min": -389.0, "episode_return_mean": 95.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.93661346466206, "num_env_steps_trained_throughput_per_sec": 256.93661346466206, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 13641.542, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13641.492, "sample_time_ms": 2559.138, "learn_time_ms": 11064.344, "learn_throughput": 361.522, "synch_weights_time_ms": 15.416}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "e1352_00002", "date": "2024-08-13_19-30-15", "timestamp": 1723591815, "time_this_iter_s": 15.611905097961426, "time_total_s": 1707.3978486061096, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1707.3978486061096, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 65.36363636363637, "ram_util_percent": 76.22727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.466123281230056, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 5.337950469198681, "policy_loss": -0.004074200098131779, "vf_loss": 5.340947282503522, "vf_explained_var": 0.007561156358668413, "kl": 0.013452137471090673, "entropy": 1.0184010627723876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.10047388937738, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.916431227184478, "policy_loss": -0.0019924248561322216, "vf_loss": 7.918419524601528, "vf_explained_var": -0.39857160493179605, "kl": 0.012502818258948396, "entropy": 0.984081947866571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 347.0, "episode_reward_min": -348.0, "episode_reward_mean": 80.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -13.135, "predator_policy": 53.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.0, -145.0, 298.0, -127.0, 35.0, 96.0, 52.0, 149.0, 193.0, 230.0, 166.0, -348.0, -43.0, 214.0, 248.0, -96.0, 102.0, -4.0, 335.0, 3.0, -132.0, 200.0, 201.0, 74.0, 117.0, -46.0, 88.0, 148.0, 296.0, 243.0, 11.0, -281.0, 132.0, 104.0, 347.0, -58.0, 8.0, 18.0, 230.0, 181.0, 76.0, 112.0, 39.0, 120.0, 71.0, -61.0, 264.0, -92.0, 120.0, 195.0, 228.0, 194.0, 253.0, 68.0, 86.0, 162.0, 339.0, -121.0, 66.0, 210.0, 81.0, 108.0, 182.0, 126.0, -45.0, 121.0, 289.0, 134.0, -172.0, 12.0, 162.0, 0.0, 37.0, 39.0, -100.0, -58.0, -2.0, 220.0, 75.0, 209.0, 21.0, 12.0, 72.0, 133.0, 41.0, 154.0, -7.0, 96.0, -11.0, 207.0, 11.0, 169.0, -110.0, -215.0, 45.0, 93.0, 7.0, -49.0, 10.0, 37.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, 141.0, -280.0, -115.0, 147.0, 117.0, -53.0, -304.0, -247.0, 130.0, -118.0, 67.0, -12.0, 0.0, 130.0, 0.0, 0.0, 190.0, 95.0, 130.0, -53.0, 118.0, -232.0, -307.0, -373.0, 25.0, 129.0, 8.0, 140.0, 76.0, -223.0, -180.0, -209.0, 168.0, -90.0, -13.0, 172.0, 156.0, -224.0, 0.0, -298.0, 0.0, 200.0, 0.0, 22.0, 141.0, 26.0, -36.0, -113.0, 135.0, -259.0, -112.0, 67.0, -124.0, 0.0, 144.0, 67.0, 177.0, 39.0, 136.0, -70.0, -10.0, -298.0, -170.0, 157.0, -141.0, -200.0, 91.0, 156.0, 189.0, -10.0, -152.0, -322.0, 53.0, -145.0, 17.0, 123.0, 10.0, -66.0, 143.0, -42.0, 30.0, -54.0, -46.0, 128.0, -245.0, 0.0, 116.0, 114.0, -176.0, -191.0, 0.0, 105.0, 135.0, -319.0, -116.0, 105.0, -118.0, 0.0, 195.0, 127.0, 71.0, -9.0, 120.0, 149.0, 89.0, 61.0, -129.0, -36.0, 104.0, -139.0, 191.0, 182.0, 147.0, -390.0, -18.0, -34.0, 23.0, 85.0, 89.0, -220.0, 102.0, 0.0, 108.0, -155.0, 176.0, 0.0, 97.0, -292.0, 65.0, 24.0, 47.0, 110.0, 179.0, -46.0, 107.0, -214.0, -158.0, -18.0, -44.0, -131.0, 151.0, 0.0, 0.0, -17.0, -42.0, 116.0, -280.0, -311.0, -34.0, -337.0, 71.0, 61.0, -245.0, 164.0, 32.0, 20.0, -61.0, 86.0, 63.0, 147.0, -285.0, -92.0, 0.0, 24.0, 30.0, 100.0, 0.0, -52.0, 0.0, 128.0, 26.0, -175.0, 29.0, 91.0, 0.0, -187.0, 29.0, 127.0, 40.0, 11.0, 0.0, 5.0, 99.0, -265.0, -2.0, -54.0, -349.0, -11.0, 37.0, 89.0, -2.0, -151.0, 8.0, 0.0, -167.0, 93.0, -224.0, -2.0, -40.0], "policy_predator_policy_reward": [29.0, 0.0, 92.0, 158.0, 34.0, 0.0, 74.0, 156.0, 0.0, 152.0, 84.0, 63.0, 64.0, 0.0, 19.0, 0.0, 3.0, 0.0, 0.0, 5.0, 101.0, 0.0, 17.0, 174.0, 163.0, 142.0, 77.0, 0.0, 27.0, 5.0, 150.0, 157.0, 143.0, 0.0, 99.0, 0.0, 5.0, 2.0, 140.0, 87.0, 0.0, 166.0, 0.0, 0.0, 0.0, 38.0, 84.0, 0.0, 95.0, 0.0, 155.0, 170.0, 145.0, 0.0, 0.0, 4.0, 10.0, 42.0, 13.0, 55.0, 91.0, 0.0, 0.0, 187.0, 112.0, 4.0, 97.0, 116.0, 0.0, 2.0, 0.0, 104.0, 172.0, 105.0, 113.0, 33.0, 63.0, 34.0, 94.0, 10.0, 0.0, 88.0, 98.0, 114.0, 153.0, 3.0, 4.0, 0.0, 83.0, 50.0, 0.0, 130.0, 0.0, 24.0, 159.0, 184.0, 0.0, 133.0, 0.0, 0.0, 7.0, 23.0, 83.0, 0.0, 15.0, 0.0, 135.0, 1.0, 18.0, 0.0, 15.0, 95.0, 2.0, 8.0, 91.0, 196.0, 29.0, 48.0, 35.0, 1.0, 60.0, 139.0, 0.0, 0.0, 44.0, 117.0, 26.0, 3.0, 0.0, 182.0, 15.0, 35.0, 0.0, 0.0, 37.0, 36.0, 168.0, 32.0, 9.0, 65.0, 81.0, 61.0, 0.0, 0.0, 59.0, 37.0, 100.0, 103.0, 82.0, 163.0, 35.0, 173.0, 75.0, 107.0, 22.0, 2.0, 83.0, 33.0, 6.0, 54.0, 156.0, 3.0, 28.0, 76.0, 0.0, 18.0, 0.0, 33.0, 38.0, 55.0, 0.0, 0.0, 56.0, 83.0, 4.0, 1.0, 147.0, 0.0, 29.0, 11.0, 0.0, 0.0, 64.0, 1.0, 3.0, 154.0, 10.0, 178.0, 8.0, 11.0, 5.0, 1.0, 83.0, 67.0, 1.0, 117.0, 119.0, 22.0, 22.0, 57.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9194631435974169, "mean_inference_ms": 2.89035473684988, "mean_action_processing_ms": 0.46253558108443615, "mean_env_wait_ms": 0.33305962306820625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008625268936157227, "StateBufferConnector_ms": 0.005997776985168457, "ViewRequirementAgentConnector_ms": 0.3536198139190674}, "num_episodes": 22, "episode_return_max": 347.0, "episode_return_min": -348.0, "episode_return_mean": 80.39, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.93979728694848, "num_env_steps_trained_throughput_per_sec": 226.93979728694848, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 14069.903, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14069.853, "sample_time_ms": 2927.146, "learn_time_ms": 11124.102, "learn_throughput": 359.58, "synch_weights_time_ms": 15.789}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "e1352_00002", "date": "2024-08-13_19-30-33", "timestamp": 1723591833, "time_this_iter_s": 17.664931058883667, "time_total_s": 1725.0627796649933, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d205e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1725.0627796649933, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 70.584, "ram_util_percent": 82.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.009900332191003, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 8.160125682972096, "policy_loss": -0.0008761521261283961, "vf_loss": 8.159885184222428, "vf_explained_var": 0.013378367852912378, "kl": 0.013942160815769399, "entropy": 0.9896902189999031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.27426818274947, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 9.114265604120083, "policy_loss": -0.003899637382063601, "vf_loss": 9.118159798718004, "vf_explained_var": -0.4239520788823486, "kl": 0.01657115461957777, "entropy": 0.9086400156614011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 347.0, "episode_reward_min": -409.0, "episode_reward_mean": 61.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -26.365, "predator_policy": 56.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.0, 117.0, -46.0, 88.0, 148.0, 296.0, 243.0, 11.0, -281.0, 132.0, 104.0, 347.0, -58.0, 8.0, 18.0, 230.0, 181.0, 76.0, 112.0, 39.0, 120.0, 71.0, -61.0, 264.0, -92.0, 120.0, 195.0, 228.0, 194.0, 253.0, 68.0, 86.0, 162.0, 339.0, -121.0, 66.0, 210.0, 81.0, 108.0, 182.0, 126.0, -45.0, 121.0, 289.0, 134.0, -172.0, 12.0, 162.0, 0.0, 37.0, 39.0, -100.0, -58.0, -2.0, 220.0, 75.0, 209.0, 21.0, 12.0, 72.0, 133.0, 41.0, 154.0, -7.0, 96.0, -11.0, 207.0, 11.0, 169.0, -110.0, -215.0, 45.0, 93.0, 7.0, -49.0, 10.0, 37.0, 56.0, -116.0, -80.0, 15.0, 25.0, -236.0, 50.0, -409.0, 134.0, 255.0, -82.0, 293.0, -112.0, 11.0, -117.0, 107.0, 51.0, 138.0, 55.0, 87.0, 53.0, -107.0, -39.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [26.0, -36.0, -113.0, 135.0, -259.0, -112.0, 67.0, -124.0, 0.0, 144.0, 67.0, 177.0, 39.0, 136.0, -70.0, -10.0, -298.0, -170.0, 157.0, -141.0, -200.0, 91.0, 156.0, 189.0, -10.0, -152.0, -322.0, 53.0, -145.0, 17.0, 123.0, 10.0, -66.0, 143.0, -42.0, 30.0, -54.0, -46.0, 128.0, -245.0, 0.0, 116.0, 114.0, -176.0, -191.0, 0.0, 105.0, 135.0, -319.0, -116.0, 105.0, -118.0, 0.0, 195.0, 127.0, 71.0, -9.0, 120.0, 149.0, 89.0, 61.0, -129.0, -36.0, 104.0, -139.0, 191.0, 182.0, 147.0, -390.0, -18.0, -34.0, 23.0, 85.0, 89.0, -220.0, 102.0, 0.0, 108.0, -155.0, 176.0, 0.0, 97.0, -292.0, 65.0, 24.0, 47.0, 110.0, 179.0, -46.0, 107.0, -214.0, -158.0, -18.0, -44.0, -131.0, 151.0, 0.0, 0.0, -17.0, -42.0, 116.0, -280.0, -311.0, -34.0, -337.0, 71.0, 61.0, -245.0, 164.0, 32.0, 20.0, -61.0, 86.0, 63.0, 147.0, -285.0, -92.0, 0.0, 24.0, 30.0, 100.0, 0.0, -52.0, 0.0, 128.0, 26.0, -175.0, 29.0, 91.0, 0.0, -187.0, 29.0, 127.0, 40.0, 11.0, 0.0, 5.0, 99.0, -265.0, -2.0, -54.0, -349.0, -11.0, 37.0, 89.0, -2.0, -151.0, 8.0, 0.0, -167.0, 93.0, -224.0, -2.0, -40.0, 4.0, -164.0, -195.0, -116.0, -111.0, -78.0, 26.0, -33.0, -106.0, -49.0, -349.0, -193.0, -58.0, -31.0, -382.0, -253.0, -9.0, 97.0, 18.0, 164.0, -6.0, -302.0, 129.0, 97.0, -317.0, 2.0, -305.0, 59.0, -88.0, -216.0, -19.0, 55.0, 47.0, -136.0, -19.0, 35.0, -4.0, 28.0, 18.0, 1.0, 0.0, 24.0, -175.0, -155.0, -265.0, 22.0], "policy_predator_policy_reward": [84.0, 0.0, 95.0, 0.0, 155.0, 170.0, 145.0, 0.0, 0.0, 4.0, 10.0, 42.0, 13.0, 55.0, 91.0, 0.0, 0.0, 187.0, 112.0, 4.0, 97.0, 116.0, 0.0, 2.0, 0.0, 104.0, 172.0, 105.0, 113.0, 33.0, 63.0, 34.0, 94.0, 10.0, 0.0, 88.0, 98.0, 114.0, 153.0, 3.0, 4.0, 0.0, 83.0, 50.0, 0.0, 130.0, 0.0, 24.0, 159.0, 184.0, 0.0, 133.0, 0.0, 0.0, 7.0, 23.0, 83.0, 0.0, 15.0, 0.0, 135.0, 1.0, 18.0, 0.0, 15.0, 95.0, 2.0, 8.0, 91.0, 196.0, 29.0, 48.0, 35.0, 1.0, 60.0, 139.0, 0.0, 0.0, 44.0, 117.0, 26.0, 3.0, 0.0, 182.0, 15.0, 35.0, 0.0, 0.0, 37.0, 36.0, 168.0, 32.0, 9.0, 65.0, 81.0, 61.0, 0.0, 0.0, 59.0, 37.0, 100.0, 103.0, 82.0, 163.0, 35.0, 173.0, 75.0, 107.0, 22.0, 2.0, 83.0, 33.0, 6.0, 54.0, 156.0, 3.0, 28.0, 76.0, 0.0, 18.0, 0.0, 33.0, 38.0, 55.0, 0.0, 0.0, 56.0, 83.0, 4.0, 1.0, 147.0, 0.0, 29.0, 11.0, 0.0, 0.0, 64.0, 1.0, 3.0, 154.0, 10.0, 178.0, 8.0, 11.0, 5.0, 1.0, 83.0, 67.0, 1.0, 117.0, 119.0, 22.0, 22.0, 57.0, 91.0, 125.0, 163.0, 32.0, 66.0, 43.0, 6.0, 16.0, 66.0, 114.0, 135.0, 171.0, 56.0, 83.0, 190.0, 36.0, 8.0, 38.0, 46.0, 27.0, 83.0, 143.0, 24.0, 43.0, 27.0, 176.0, 100.0, 157.0, 0.0, 187.0, 33.0, 38.0, 103.0, 37.0, 95.0, 27.0, 24.0, 7.0, 20.0, 48.0, 29.0, 0.0, 119.0, 104.0, 65.0, 139.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.93262635611088, "mean_inference_ms": 2.9289667468035883, "mean_action_processing_ms": 0.4656253545660292, "mean_env_wait_ms": 0.33813411658656095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007759690284729004, "StateBufferConnector_ms": 0.005976438522338867, "ViewRequirementAgentConnector_ms": 0.3293572664260864}, "num_episodes": 23, "episode_return_max": 347.0, "episode_return_min": -409.0, "episode_return_mean": 61.07, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.17006349590076, "num_env_steps_trained_throughput_per_sec": 316.17006349590076, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 14104.211, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14104.161, "sample_time_ms": 2888.814, "learn_time_ms": 11196.706, "learn_throughput": 357.248, "synch_weights_time_ms": 15.855}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "e1352_00002", "date": "2024-08-13_19-30-45", "timestamp": 1723591845, "time_this_iter_s": 12.708206176757812, "time_total_s": 1737.770985841751, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1737.770985841751, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 58.79999999999999, "ram_util_percent": 82.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2184235897959854, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.449671348440584, "policy_loss": -0.0017427193982743475, "vf_loss": 6.450754514320818, "vf_explained_var": 0.032573615716247964, "kl": 0.0082349811743731, "entropy": 1.04347454624832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.76758995822498, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.266118316297177, "policy_loss": -0.0015412772537539245, "vf_loss": 8.267655728355287, "vf_explained_var": -0.1942588147032198, "kl": 0.011759757727158256, "entropy": 0.9330283666098559, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 339.0, "episode_reward_min": -409.0, "episode_reward_mean": 51.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -30.335, "predator_policy": 56.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.0, 39.0, 120.0, 71.0, -61.0, 264.0, -92.0, 120.0, 195.0, 228.0, 194.0, 253.0, 68.0, 86.0, 162.0, 339.0, -121.0, 66.0, 210.0, 81.0, 108.0, 182.0, 126.0, -45.0, 121.0, 289.0, 134.0, -172.0, 12.0, 162.0, 0.0, 37.0, 39.0, -100.0, -58.0, -2.0, 220.0, 75.0, 209.0, 21.0, 12.0, 72.0, 133.0, 41.0, 154.0, -7.0, 96.0, -11.0, 207.0, 11.0, 169.0, -110.0, -215.0, 45.0, 93.0, 7.0, -49.0, 10.0, 37.0, 56.0, -116.0, -80.0, 15.0, 25.0, -236.0, 50.0, -409.0, 134.0, 255.0, -82.0, 293.0, -112.0, 11.0, -117.0, 107.0, 51.0, 138.0, 55.0, 87.0, 53.0, -107.0, -39.0, 301.0, 220.0, 62.0, -246.0, 78.0, -206.0, -118.0, 175.0, -10.0, -8.0, 163.0, 82.0, 269.0, 43.0, -269.0, 126.0, 119.0, -60.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.0, -46.0, 128.0, -245.0, 0.0, 116.0, 114.0, -176.0, -191.0, 0.0, 105.0, 135.0, -319.0, -116.0, 105.0, -118.0, 0.0, 195.0, 127.0, 71.0, -9.0, 120.0, 149.0, 89.0, 61.0, -129.0, -36.0, 104.0, -139.0, 191.0, 182.0, 147.0, -390.0, -18.0, -34.0, 23.0, 85.0, 89.0, -220.0, 102.0, 0.0, 108.0, -155.0, 176.0, 0.0, 97.0, -292.0, 65.0, 24.0, 47.0, 110.0, 179.0, -46.0, 107.0, -214.0, -158.0, -18.0, -44.0, -131.0, 151.0, 0.0, 0.0, -17.0, -42.0, 116.0, -280.0, -311.0, -34.0, -337.0, 71.0, 61.0, -245.0, 164.0, 32.0, 20.0, -61.0, 86.0, 63.0, 147.0, -285.0, -92.0, 0.0, 24.0, 30.0, 100.0, 0.0, -52.0, 0.0, 128.0, 26.0, -175.0, 29.0, 91.0, 0.0, -187.0, 29.0, 127.0, 40.0, 11.0, 0.0, 5.0, 99.0, -265.0, -2.0, -54.0, -349.0, -11.0, 37.0, 89.0, -2.0, -151.0, 8.0, 0.0, -167.0, 93.0, -224.0, -2.0, -40.0, 4.0, -164.0, -195.0, -116.0, -111.0, -78.0, 26.0, -33.0, -106.0, -49.0, -349.0, -193.0, -58.0, -31.0, -382.0, -253.0, -9.0, 97.0, 18.0, 164.0, -6.0, -302.0, 129.0, 97.0, -317.0, 2.0, -305.0, 59.0, -88.0, -216.0, -19.0, 55.0, 47.0, -136.0, -19.0, 35.0, -4.0, 28.0, 18.0, 1.0, 0.0, 24.0, -175.0, -155.0, -265.0, 22.0, 77.0, 185.0, -32.0, 180.0, 23.0, -22.0, -95.0, -329.0, 0.0, 38.0, -114.0, -348.0, -376.0, -52.0, 41.0, 0.0, -128.0, 0.0, 34.0, -172.0, 56.0, 56.0, 35.0, 0.0, 160.0, -2.0, -37.0, -4.0, -264.0, -241.0, 96.0, 0.0, 1.0, 56.0, 0.0, -126.0], "policy_predator_policy_reward": [98.0, 114.0, 153.0, 3.0, 4.0, 0.0, 83.0, 50.0, 0.0, 130.0, 0.0, 24.0, 159.0, 184.0, 0.0, 133.0, 0.0, 0.0, 7.0, 23.0, 83.0, 0.0, 15.0, 0.0, 135.0, 1.0, 18.0, 0.0, 15.0, 95.0, 2.0, 8.0, 91.0, 196.0, 29.0, 48.0, 35.0, 1.0, 60.0, 139.0, 0.0, 0.0, 44.0, 117.0, 26.0, 3.0, 0.0, 182.0, 15.0, 35.0, 0.0, 0.0, 37.0, 36.0, 168.0, 32.0, 9.0, 65.0, 81.0, 61.0, 0.0, 0.0, 59.0, 37.0, 100.0, 103.0, 82.0, 163.0, 35.0, 173.0, 75.0, 107.0, 22.0, 2.0, 83.0, 33.0, 6.0, 54.0, 156.0, 3.0, 28.0, 76.0, 0.0, 18.0, 0.0, 33.0, 38.0, 55.0, 0.0, 0.0, 56.0, 83.0, 4.0, 1.0, 147.0, 0.0, 29.0, 11.0, 0.0, 0.0, 64.0, 1.0, 3.0, 154.0, 10.0, 178.0, 8.0, 11.0, 5.0, 1.0, 83.0, 67.0, 1.0, 117.0, 119.0, 22.0, 22.0, 57.0, 91.0, 125.0, 163.0, 32.0, 66.0, 43.0, 6.0, 16.0, 66.0, 114.0, 135.0, 171.0, 56.0, 83.0, 190.0, 36.0, 8.0, 38.0, 46.0, 27.0, 83.0, 143.0, 24.0, 43.0, 27.0, 176.0, 100.0, 157.0, 0.0, 187.0, 33.0, 38.0, 103.0, 37.0, 95.0, 27.0, 24.0, 7.0, 20.0, 48.0, 29.0, 0.0, 119.0, 104.0, 65.0, 139.0, 27.0, 12.0, 6.0, 66.0, 57.0, 4.0, 176.0, 2.0, 0.0, 40.0, 116.0, 140.0, 127.0, 183.0, 78.0, 56.0, 104.0, 14.0, 119.0, 11.0, 4.0, 47.0, 14.0, 33.0, 56.0, 55.0, 73.0, 11.0, 149.0, 87.0, 30.0, 0.0, 61.0, 1.0, 21.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9411805871676424, "mean_inference_ms": 2.951869655645064, "mean_action_processing_ms": 0.466907880334435, "mean_env_wait_ms": 0.34123963761667125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007768988609313965, "StateBufferConnector_ms": 0.005687355995178223, "ViewRequirementAgentConnector_ms": 0.3114023208618164}, "num_episodes": 18, "episode_return_max": 339.0, "episode_return_min": -409.0, "episode_return_mean": 51.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.4823255199263, "num_env_steps_trained_throughput_per_sec": 290.4823255199263, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 14283.711, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14283.662, "sample_time_ms": 2879.598, "learn_time_ms": 11383.744, "learn_throughput": 351.378, "synch_weights_time_ms": 16.737}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "e1352_00002", "date": "2024-08-13_19-30-59", "timestamp": 1723591859, "time_this_iter_s": 13.907940864562988, "time_total_s": 1751.678926706314, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf53a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1751.678926706314, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 63.32500000000001, "ram_util_percent": 82.545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.095470619643176, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 5.275034329374001, "policy_loss": -0.0018447720709320887, "vf_loss": 5.2761630086041, "vf_explained_var": 0.04968275594963598, "kl": 0.008941061018757076, "entropy": 1.0470394728360353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.98130931220357, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.318439846694785, "policy_loss": -0.0008644549256170948, "vf_loss": 8.319301825225669, "vf_explained_var": -0.18266337460311002, "kl": 0.007492502838456415, "entropy": 0.9762342170432762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -409.0, "episode_reward_mean": 46.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -31.535, "predator_policy": 54.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 81.0, 108.0, 182.0, 126.0, -45.0, 121.0, 289.0, 134.0, -172.0, 12.0, 162.0, 0.0, 37.0, 39.0, -100.0, -58.0, -2.0, 220.0, 75.0, 209.0, 21.0, 12.0, 72.0, 133.0, 41.0, 154.0, -7.0, 96.0, -11.0, 207.0, 11.0, 169.0, -110.0, -215.0, 45.0, 93.0, 7.0, -49.0, 10.0, 37.0, 56.0, -116.0, -80.0, 15.0, 25.0, -236.0, 50.0, -409.0, 134.0, 255.0, -82.0, 293.0, -112.0, 11.0, -117.0, 107.0, 51.0, 138.0, 55.0, 87.0, 53.0, -107.0, -39.0, 301.0, 220.0, 62.0, -246.0, 78.0, -206.0, -118.0, 175.0, -10.0, -8.0, 163.0, 82.0, 269.0, 43.0, -269.0, 126.0, 119.0, -60.0, 343.0, 149.0, 37.0, 56.0, -54.0, -276.0, 283.0, 224.0, -165.0, 328.0, -15.0, 189.0, -33.0, -63.0, 292.0, 32.0, 367.0, -142.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.0, 89.0, -220.0, 102.0, 0.0, 108.0, -155.0, 176.0, 0.0, 97.0, -292.0, 65.0, 24.0, 47.0, 110.0, 179.0, -46.0, 107.0, -214.0, -158.0, -18.0, -44.0, -131.0, 151.0, 0.0, 0.0, -17.0, -42.0, 116.0, -280.0, -311.0, -34.0, -337.0, 71.0, 61.0, -245.0, 164.0, 32.0, 20.0, -61.0, 86.0, 63.0, 147.0, -285.0, -92.0, 0.0, 24.0, 30.0, 100.0, 0.0, -52.0, 0.0, 128.0, 26.0, -175.0, 29.0, 91.0, 0.0, -187.0, 29.0, 127.0, 40.0, 11.0, 0.0, 5.0, 99.0, -265.0, -2.0, -54.0, -349.0, -11.0, 37.0, 89.0, -2.0, -151.0, 8.0, 0.0, -167.0, 93.0, -224.0, -2.0, -40.0, 4.0, -164.0, -195.0, -116.0, -111.0, -78.0, 26.0, -33.0, -106.0, -49.0, -349.0, -193.0, -58.0, -31.0, -382.0, -253.0, -9.0, 97.0, 18.0, 164.0, -6.0, -302.0, 129.0, 97.0, -317.0, 2.0, -305.0, 59.0, -88.0, -216.0, -19.0, 55.0, 47.0, -136.0, -19.0, 35.0, -4.0, 28.0, 18.0, 1.0, 0.0, 24.0, -175.0, -155.0, -265.0, 22.0, 77.0, 185.0, -32.0, 180.0, 23.0, -22.0, -95.0, -329.0, 0.0, 38.0, -114.0, -348.0, -376.0, -52.0, 41.0, 0.0, -128.0, 0.0, 34.0, -172.0, 56.0, 56.0, 35.0, 0.0, 160.0, -2.0, -37.0, -4.0, -264.0, -241.0, 96.0, 0.0, 1.0, 56.0, 0.0, -126.0, 195.0, 115.0, 14.0, 111.0, -29.0, -89.0, 56.0, 0.0, -183.0, -27.0, -108.0, -365.0, 143.0, 118.0, 25.0, 195.0, 0.0, -349.0, 185.0, 139.0, 151.0, -369.0, 159.0, 8.0, 0.0, -89.0, 0.0, -206.0, 65.0, 169.0, 123.0, -274.0, 168.0, 189.0, -338.0, 0.0], "policy_predator_policy_reward": [35.0, 1.0, 60.0, 139.0, 0.0, 0.0, 44.0, 117.0, 26.0, 3.0, 0.0, 182.0, 15.0, 35.0, 0.0, 0.0, 37.0, 36.0, 168.0, 32.0, 9.0, 65.0, 81.0, 61.0, 0.0, 0.0, 59.0, 37.0, 100.0, 103.0, 82.0, 163.0, 35.0, 173.0, 75.0, 107.0, 22.0, 2.0, 83.0, 33.0, 6.0, 54.0, 156.0, 3.0, 28.0, 76.0, 0.0, 18.0, 0.0, 33.0, 38.0, 55.0, 0.0, 0.0, 56.0, 83.0, 4.0, 1.0, 147.0, 0.0, 29.0, 11.0, 0.0, 0.0, 64.0, 1.0, 3.0, 154.0, 10.0, 178.0, 8.0, 11.0, 5.0, 1.0, 83.0, 67.0, 1.0, 117.0, 119.0, 22.0, 22.0, 57.0, 91.0, 125.0, 163.0, 32.0, 66.0, 43.0, 6.0, 16.0, 66.0, 114.0, 135.0, 171.0, 56.0, 83.0, 190.0, 36.0, 8.0, 38.0, 46.0, 27.0, 83.0, 143.0, 24.0, 43.0, 27.0, 176.0, 100.0, 157.0, 0.0, 187.0, 33.0, 38.0, 103.0, 37.0, 95.0, 27.0, 24.0, 7.0, 20.0, 48.0, 29.0, 0.0, 119.0, 104.0, 65.0, 139.0, 27.0, 12.0, 6.0, 66.0, 57.0, 4.0, 176.0, 2.0, 0.0, 40.0, 116.0, 140.0, 127.0, 183.0, 78.0, 56.0, 104.0, 14.0, 119.0, 11.0, 4.0, 47.0, 14.0, 33.0, 56.0, 55.0, 73.0, 11.0, 149.0, 87.0, 30.0, 0.0, 61.0, 1.0, 21.0, 45.0, 7.0, 26.0, 8.0, 16.0, 67.0, 88.0, 0.0, 0.0, 25.0, 131.0, 16.0, 181.0, 13.0, 9.0, 4.0, 0.0, 16.0, 168.0, 0.0, 4.0, 197.0, 6.0, 0.0, 22.0, 0.0, 56.0, 33.0, 110.0, 30.0, 28.0, 59.0, 124.0, 9.0, 1.0, 18.0, 178.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9490858375829814, "mean_inference_ms": 2.97201979299791, "mean_action_processing_ms": 0.46768538397263193, "mean_env_wait_ms": 0.3444585071260042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008310198783874512, "StateBufferConnector_ms": 0.006985664367675781, "ViewRequirementAgentConnector_ms": 0.3484848737716675}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -409.0, "episode_return_mean": 46.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.42480870757936, "num_env_steps_trained_throughput_per_sec": 252.42480870757936, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 14660.71, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14660.656, "sample_time_ms": 2944.525, "learn_time_ms": 11691.336, "learn_throughput": 342.134, "synch_weights_time_ms": 19.956}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "e1352_00002", "date": "2024-08-13_19-31-15", "timestamp": 1723591875, "time_this_iter_s": 16.05944585800171, "time_total_s": 1767.7383725643158, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d205e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1767.7383725643158, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 78.43636363636365, "ram_util_percent": 83.83181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9408054072863212, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.266116203328289, "policy_loss": -0.00272005084488127, "vf_loss": 6.267812288627423, "vf_explained_var": 0.025145338830493746, "kl": 0.012785186243704309, "entropy": 1.0103871438553724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.223867226230404, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 9.065296783144511, "policy_loss": -0.002329557491515679, "vf_loss": 9.067620878875571, "vf_explained_var": -0.2158993871439071, "kl": 0.016528658510883233, "entropy": 0.8586984294432181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -409.0, "episode_reward_mean": 44.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -32.65, "predator_policy": 55.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 72.0, 133.0, 41.0, 154.0, -7.0, 96.0, -11.0, 207.0, 11.0, 169.0, -110.0, -215.0, 45.0, 93.0, 7.0, -49.0, 10.0, 37.0, 56.0, -116.0, -80.0, 15.0, 25.0, -236.0, 50.0, -409.0, 134.0, 255.0, -82.0, 293.0, -112.0, 11.0, -117.0, 107.0, 51.0, 138.0, 55.0, 87.0, 53.0, -107.0, -39.0, 301.0, 220.0, 62.0, -246.0, 78.0, -206.0, -118.0, 175.0, -10.0, -8.0, 163.0, 82.0, 269.0, 43.0, -269.0, 126.0, 119.0, -60.0, 343.0, 149.0, 37.0, 56.0, -54.0, -276.0, 283.0, 224.0, -165.0, 328.0, -15.0, 189.0, -33.0, -63.0, 292.0, 32.0, 367.0, -142.0, -16.0, -191.0, 143.0, 136.0, 309.0, 175.0, -82.0, -143.0, 217.0, 35.0, -61.0, -11.0, 301.0, -3.0, 149.0, 309.0, 59.0, 167.0, -78.0, -161.0, 62.0, 163.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-92.0, 0.0, 24.0, 30.0, 100.0, 0.0, -52.0, 0.0, 128.0, 26.0, -175.0, 29.0, 91.0, 0.0, -187.0, 29.0, 127.0, 40.0, 11.0, 0.0, 5.0, 99.0, -265.0, -2.0, -54.0, -349.0, -11.0, 37.0, 89.0, -2.0, -151.0, 8.0, 0.0, -167.0, 93.0, -224.0, -2.0, -40.0, 4.0, -164.0, -195.0, -116.0, -111.0, -78.0, 26.0, -33.0, -106.0, -49.0, -349.0, -193.0, -58.0, -31.0, -382.0, -253.0, -9.0, 97.0, 18.0, 164.0, -6.0, -302.0, 129.0, 97.0, -317.0, 2.0, -305.0, 59.0, -88.0, -216.0, -19.0, 55.0, 47.0, -136.0, -19.0, 35.0, -4.0, 28.0, 18.0, 1.0, 0.0, 24.0, -175.0, -155.0, -265.0, 22.0, 77.0, 185.0, -32.0, 180.0, 23.0, -22.0, -95.0, -329.0, 0.0, 38.0, -114.0, -348.0, -376.0, -52.0, 41.0, 0.0, -128.0, 0.0, 34.0, -172.0, 56.0, 56.0, 35.0, 0.0, 160.0, -2.0, -37.0, -4.0, -264.0, -241.0, 96.0, 0.0, 1.0, 56.0, 0.0, -126.0, 195.0, 115.0, 14.0, 111.0, -29.0, -89.0, 56.0, 0.0, -183.0, -27.0, -108.0, -365.0, 143.0, 118.0, 25.0, 195.0, 0.0, -349.0, 185.0, 139.0, 151.0, -369.0, 159.0, 8.0, 0.0, -89.0, 0.0, -206.0, 65.0, 169.0, 123.0, -274.0, 168.0, 189.0, -338.0, 0.0, 0.0, -32.0, -162.0, -310.0, 107.0, 5.0, -71.0, 133.0, 150.0, 116.0, 144.0, 20.0, -347.0, -64.0, -16.0, -298.0, 68.0, 97.0, 29.0, 0.0, -153.0, -53.0, -4.0, -24.0, 90.0, 122.0, -235.0, 27.0, 173.0, -324.0, 156.0, 122.0, -80.0, 32.0, 10.0, 141.0, -84.0, -152.0, -346.0, -27.0, -104.0, -13.0, 143.0, 1.0], "policy_predator_policy_reward": [28.0, 76.0, 0.0, 18.0, 0.0, 33.0, 38.0, 55.0, 0.0, 0.0, 56.0, 83.0, 4.0, 1.0, 147.0, 0.0, 29.0, 11.0, 0.0, 0.0, 64.0, 1.0, 3.0, 154.0, 10.0, 178.0, 8.0, 11.0, 5.0, 1.0, 83.0, 67.0, 1.0, 117.0, 119.0, 22.0, 22.0, 57.0, 91.0, 125.0, 163.0, 32.0, 66.0, 43.0, 6.0, 16.0, 66.0, 114.0, 135.0, 171.0, 56.0, 83.0, 190.0, 36.0, 8.0, 38.0, 46.0, 27.0, 83.0, 143.0, 24.0, 43.0, 27.0, 176.0, 100.0, 157.0, 0.0, 187.0, 33.0, 38.0, 103.0, 37.0, 95.0, 27.0, 24.0, 7.0, 20.0, 48.0, 29.0, 0.0, 119.0, 104.0, 65.0, 139.0, 27.0, 12.0, 6.0, 66.0, 57.0, 4.0, 176.0, 2.0, 0.0, 40.0, 116.0, 140.0, 127.0, 183.0, 78.0, 56.0, 104.0, 14.0, 119.0, 11.0, 4.0, 47.0, 14.0, 33.0, 56.0, 55.0, 73.0, 11.0, 149.0, 87.0, 30.0, 0.0, 61.0, 1.0, 21.0, 45.0, 7.0, 26.0, 8.0, 16.0, 67.0, 88.0, 0.0, 0.0, 25.0, 131.0, 16.0, 181.0, 13.0, 9.0, 4.0, 0.0, 16.0, 168.0, 0.0, 4.0, 197.0, 6.0, 0.0, 22.0, 0.0, 56.0, 33.0, 110.0, 30.0, 28.0, 59.0, 124.0, 9.0, 1.0, 18.0, 178.0, 0.0, 16.0, 141.0, 140.0, 31.0, 0.0, 53.0, 21.0, 16.0, 27.0, 9.0, 2.0, 143.0, 186.0, 144.0, 27.0, 15.0, 37.0, 6.0, 0.0, 0.0, 145.0, 16.0, 1.0, 54.0, 35.0, 133.0, 72.0, 146.0, 154.0, 18.0, 13.0, 2.0, 105.0, 14.0, 2.0, 124.0, 34.0, 190.0, 22.0, 104.0, 75.0, 0.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9583011841985396, "mean_inference_ms": 2.9943199906072278, "mean_action_processing_ms": 0.46910253823935977, "mean_env_wait_ms": 0.3488947394570566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005897164344787598, "StateBufferConnector_ms": 0.006587982177734375, "ViewRequirementAgentConnector_ms": 0.37582337856292725}, "num_episodes": 22, "episode_return_max": 367.0, "episode_return_min": -409.0, "episode_return_mean": 44.79, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.77648649602554, "num_env_steps_trained_throughput_per_sec": 221.77648649602554, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 15198.188, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15198.13, "sample_time_ms": 3167.202, "learn_time_ms": 12004.551, "learn_throughput": 333.207, "synch_weights_time_ms": 20.903}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "e1352_00002", "date": "2024-08-13_19-31-34", "timestamp": 1723591894, "time_this_iter_s": 18.122509956359863, "time_total_s": 1785.8608825206757, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1785.8608825206757, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 85.69999999999997, "ram_util_percent": 83.84230769230768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5463801562155366, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 7.360209653491066, "policy_loss": -0.003385165933194378, "vf_loss": 7.362450004759289, "vf_explained_var": 0.01934862770731487, "kl": 0.014294206649313248, "entropy": 1.0123090567727568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.348054932318036, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.523668520034306, "policy_loss": -0.0019320002894986559, "vf_loss": 8.525595377361963, "vf_explained_var": -0.13546625744728816, "kl": 0.015534821209438159, "entropy": 0.9047486964987699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -409.0, "episode_reward_mean": 44.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -382.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -35.775, "predator_policy": 57.835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 56.0, -116.0, -80.0, 15.0, 25.0, -236.0, 50.0, -409.0, 134.0, 255.0, -82.0, 293.0, -112.0, 11.0, -117.0, 107.0, 51.0, 138.0, 55.0, 87.0, 53.0, -107.0, -39.0, 301.0, 220.0, 62.0, -246.0, 78.0, -206.0, -118.0, 175.0, -10.0, -8.0, 163.0, 82.0, 269.0, 43.0, -269.0, 126.0, 119.0, -60.0, 343.0, 149.0, 37.0, 56.0, -54.0, -276.0, 283.0, 224.0, -165.0, 328.0, -15.0, 189.0, -33.0, -63.0, 292.0, 32.0, 367.0, -142.0, -16.0, -191.0, 143.0, 136.0, 309.0, 175.0, -82.0, -143.0, 217.0, 35.0, -61.0, -11.0, 301.0, -3.0, 149.0, 309.0, 59.0, 167.0, -78.0, -161.0, 62.0, 163.0, 209.0, 40.0, 205.0, -199.0, 116.0, 116.0, 79.0, 186.0, 0.0, 116.0, 36.0, -23.0, 108.0, 2.0, 20.0, -380.0, -179.0, 139.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, -40.0, 4.0, -164.0, -195.0, -116.0, -111.0, -78.0, 26.0, -33.0, -106.0, -49.0, -349.0, -193.0, -58.0, -31.0, -382.0, -253.0, -9.0, 97.0, 18.0, 164.0, -6.0, -302.0, 129.0, 97.0, -317.0, 2.0, -305.0, 59.0, -88.0, -216.0, -19.0, 55.0, 47.0, -136.0, -19.0, 35.0, -4.0, 28.0, 18.0, 1.0, 0.0, 24.0, -175.0, -155.0, -265.0, 22.0, 77.0, 185.0, -32.0, 180.0, 23.0, -22.0, -95.0, -329.0, 0.0, 38.0, -114.0, -348.0, -376.0, -52.0, 41.0, 0.0, -128.0, 0.0, 34.0, -172.0, 56.0, 56.0, 35.0, 0.0, 160.0, -2.0, -37.0, -4.0, -264.0, -241.0, 96.0, 0.0, 1.0, 56.0, 0.0, -126.0, 195.0, 115.0, 14.0, 111.0, -29.0, -89.0, 56.0, 0.0, -183.0, -27.0, -108.0, -365.0, 143.0, 118.0, 25.0, 195.0, 0.0, -349.0, 185.0, 139.0, 151.0, -369.0, 159.0, 8.0, 0.0, -89.0, 0.0, -206.0, 65.0, 169.0, 123.0, -274.0, 168.0, 189.0, -338.0, 0.0, 0.0, -32.0, -162.0, -310.0, 107.0, 5.0, -71.0, 133.0, 150.0, 116.0, 144.0, 20.0, -347.0, -64.0, -16.0, -298.0, 68.0, 97.0, 29.0, 0.0, -153.0, -53.0, -4.0, -24.0, 90.0, 122.0, -235.0, 27.0, 173.0, -324.0, 156.0, 122.0, -80.0, 32.0, 10.0, 141.0, -84.0, -152.0, -346.0, -27.0, -104.0, -13.0, 143.0, 1.0, 89.0, 74.0, -250.0, 129.0, 38.0, 111.0, -103.0, -248.0, 113.0, -77.0, 7.0, 11.0, -62.0, -8.0, 144.0, 22.0, 0.0, 0.0, 58.0, -43.0, 37.0, -175.0, 0.0, -49.0, 147.0, -182.0, 0.0, -96.0, 72.0, -181.0, -287.0, -362.0, -59.0, -329.0, 59.0, 10.0], "policy_predator_policy_reward": [22.0, 57.0, 91.0, 125.0, 163.0, 32.0, 66.0, 43.0, 6.0, 16.0, 66.0, 114.0, 135.0, 171.0, 56.0, 83.0, 190.0, 36.0, 8.0, 38.0, 46.0, 27.0, 83.0, 143.0, 24.0, 43.0, 27.0, 176.0, 100.0, 157.0, 0.0, 187.0, 33.0, 38.0, 103.0, 37.0, 95.0, 27.0, 24.0, 7.0, 20.0, 48.0, 29.0, 0.0, 119.0, 104.0, 65.0, 139.0, 27.0, 12.0, 6.0, 66.0, 57.0, 4.0, 176.0, 2.0, 0.0, 40.0, 116.0, 140.0, 127.0, 183.0, 78.0, 56.0, 104.0, 14.0, 119.0, 11.0, 4.0, 47.0, 14.0, 33.0, 56.0, 55.0, 73.0, 11.0, 149.0, 87.0, 30.0, 0.0, 61.0, 1.0, 21.0, 45.0, 7.0, 26.0, 8.0, 16.0, 67.0, 88.0, 0.0, 0.0, 25.0, 131.0, 16.0, 181.0, 13.0, 9.0, 4.0, 0.0, 16.0, 168.0, 0.0, 4.0, 197.0, 6.0, 0.0, 22.0, 0.0, 56.0, 33.0, 110.0, 30.0, 28.0, 59.0, 124.0, 9.0, 1.0, 18.0, 178.0, 0.0, 16.0, 141.0, 140.0, 31.0, 0.0, 53.0, 21.0, 16.0, 27.0, 9.0, 2.0, 143.0, 186.0, 144.0, 27.0, 15.0, 37.0, 6.0, 0.0, 0.0, 145.0, 16.0, 1.0, 54.0, 35.0, 133.0, 72.0, 146.0, 154.0, 18.0, 13.0, 2.0, 105.0, 14.0, 2.0, 124.0, 34.0, 190.0, 22.0, 104.0, 75.0, 0.0, 19.0, 18.0, 28.0, 11.0, 150.0, 21.0, 35.0, 111.0, 41.0, 21.0, 59.0, 32.0, 66.0, 67.0, 82.0, 11.0, 9.0, 0.0, 0.0, 57.0, 44.0, 165.0, 9.0, 0.0, 26.0, 118.0, 25.0, 70.0, 28.0, 124.0, 5.0, 191.0, 78.0, 185.0, 24.0, 41.0, 29.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9618285031464211, "mean_inference_ms": 3.00568729308463, "mean_action_processing_ms": 0.4688372654102338, "mean_env_wait_ms": 0.34999655929883566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00612485408782959, "StateBufferConnector_ms": 0.005876421928405762, "ViewRequirementAgentConnector_ms": 0.30089831352233887}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -409.0, "episode_return_mean": 44.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.56710145021367, "num_env_steps_trained_throughput_per_sec": 293.56710145021367, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 15300.916, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15300.857, "sample_time_ms": 3209.262, "learn_time_ms": 12067.19, "learn_throughput": 331.477, "synch_weights_time_ms": 19.364}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "e1352_00002", "date": "2024-08-13_19-31-47", "timestamp": 1723591907, "time_this_iter_s": 13.668597221374512, "time_total_s": 1799.5294797420502, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d62700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1799.5294797420502, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 68.74736842105263, "ram_util_percent": 81.27368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.48213575547019, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.450202139344795, "policy_loss": -0.0010494461191926526, "vf_loss": 6.449975419675232, "vf_explained_var": 0.060463965853686054, "kl": 0.01593419289398551, "entropy": 1.0175682169419749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.08529315401638, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.761236642655872, "policy_loss": 3.253879966756339e-05, "vf_loss": 8.76120109583335, "vf_explained_var": -0.364703562650731, "kl": 0.009167873518431357, "entropy": 0.903226001079751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -380.0, "episode_reward_mean": 52.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -376.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -29.465, "predator_policy": 55.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.0, 301.0, 220.0, 62.0, -246.0, 78.0, -206.0, -118.0, 175.0, -10.0, -8.0, 163.0, 82.0, 269.0, 43.0, -269.0, 126.0, 119.0, -60.0, 343.0, 149.0, 37.0, 56.0, -54.0, -276.0, 283.0, 224.0, -165.0, 328.0, -15.0, 189.0, -33.0, -63.0, 292.0, 32.0, 367.0, -142.0, -16.0, -191.0, 143.0, 136.0, 309.0, 175.0, -82.0, -143.0, 217.0, 35.0, -61.0, -11.0, 301.0, -3.0, 149.0, 309.0, 59.0, 167.0, -78.0, -161.0, 62.0, 163.0, 209.0, 40.0, 205.0, -199.0, 116.0, 116.0, 79.0, 186.0, 0.0, 116.0, 36.0, -23.0, 108.0, 2.0, 20.0, -380.0, -179.0, 139.0, 73.0, 73.0, 10.0, 10.0, -63.0, -69.0, 88.0, -36.0, 123.0, 94.0, -8.0, 101.0, 23.0, 307.0, -9.0, 106.0, -130.0, 43.0, 64.0, -43.0, -40.0, 233.0, -47.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-265.0, 22.0, 77.0, 185.0, -32.0, 180.0, 23.0, -22.0, -95.0, -329.0, 0.0, 38.0, -114.0, -348.0, -376.0, -52.0, 41.0, 0.0, -128.0, 0.0, 34.0, -172.0, 56.0, 56.0, 35.0, 0.0, 160.0, -2.0, -37.0, -4.0, -264.0, -241.0, 96.0, 0.0, 1.0, 56.0, 0.0, -126.0, 195.0, 115.0, 14.0, 111.0, -29.0, -89.0, 56.0, 0.0, -183.0, -27.0, -108.0, -365.0, 143.0, 118.0, 25.0, 195.0, 0.0, -349.0, 185.0, 139.0, 151.0, -369.0, 159.0, 8.0, 0.0, -89.0, 0.0, -206.0, 65.0, 169.0, 123.0, -274.0, 168.0, 189.0, -338.0, 0.0, 0.0, -32.0, -162.0, -310.0, 107.0, 5.0, -71.0, 133.0, 150.0, 116.0, 144.0, 20.0, -347.0, -64.0, -16.0, -298.0, 68.0, 97.0, 29.0, 0.0, -153.0, -53.0, -4.0, -24.0, 90.0, 122.0, -235.0, 27.0, 173.0, -324.0, 156.0, 122.0, -80.0, 32.0, 10.0, 141.0, -84.0, -152.0, -346.0, -27.0, -104.0, -13.0, 143.0, 1.0, 89.0, 74.0, -250.0, 129.0, 38.0, 111.0, -103.0, -248.0, 113.0, -77.0, 7.0, 11.0, -62.0, -8.0, 144.0, 22.0, 0.0, 0.0, 58.0, -43.0, 37.0, -175.0, 0.0, -49.0, 147.0, -182.0, 0.0, -96.0, 72.0, -181.0, -287.0, -362.0, -59.0, -329.0, 59.0, 10.0, -153.0, 107.0, -2.0, 61.0, -61.0, -88.0, -22.0, 8.0, -6.0, -292.0, -109.0, -133.0, -136.0, 130.0, 52.0, -297.0, 30.0, -17.0, -40.0, 74.0, -150.0, 50.0, 0.0, 53.0, -55.0, -131.0, 138.0, 146.0, -22.0, -142.0, -155.0, 130.0, -247.0, -54.0, -28.0, -18.0, 104.0, -178.0, -211.0, 0.0, 0.0, -80.0, -28.0, 181.0, -346.0, 92.0], "policy_predator_policy_reward": [65.0, 139.0, 27.0, 12.0, 6.0, 66.0, 57.0, 4.0, 176.0, 2.0, 0.0, 40.0, 116.0, 140.0, 127.0, 183.0, 78.0, 56.0, 104.0, 14.0, 119.0, 11.0, 4.0, 47.0, 14.0, 33.0, 56.0, 55.0, 73.0, 11.0, 149.0, 87.0, 30.0, 0.0, 61.0, 1.0, 21.0, 45.0, 7.0, 26.0, 8.0, 16.0, 67.0, 88.0, 0.0, 0.0, 25.0, 131.0, 16.0, 181.0, 13.0, 9.0, 4.0, 0.0, 16.0, 168.0, 0.0, 4.0, 197.0, 6.0, 0.0, 22.0, 0.0, 56.0, 33.0, 110.0, 30.0, 28.0, 59.0, 124.0, 9.0, 1.0, 18.0, 178.0, 0.0, 16.0, 141.0, 140.0, 31.0, 0.0, 53.0, 21.0, 16.0, 27.0, 9.0, 2.0, 143.0, 186.0, 144.0, 27.0, 15.0, 37.0, 6.0, 0.0, 0.0, 145.0, 16.0, 1.0, 54.0, 35.0, 133.0, 72.0, 146.0, 154.0, 18.0, 13.0, 2.0, 105.0, 14.0, 2.0, 124.0, 34.0, 190.0, 22.0, 104.0, 75.0, 0.0, 19.0, 18.0, 28.0, 11.0, 150.0, 21.0, 35.0, 111.0, 41.0, 21.0, 59.0, 32.0, 66.0, 67.0, 82.0, 11.0, 9.0, 0.0, 0.0, 57.0, 44.0, 165.0, 9.0, 0.0, 26.0, 118.0, 25.0, 70.0, 28.0, 124.0, 5.0, 191.0, 78.0, 185.0, 24.0, 41.0, 29.0, 118.0, 1.0, 8.0, 6.0, 22.0, 137.0, 16.0, 8.0, 98.0, 137.0, 165.0, 8.0, 32.0, 62.0, 102.0, 107.0, 51.0, 59.0, 40.0, 20.0, 87.0, 5.0, 4.0, 44.0, 81.0, 128.0, 21.0, 2.0, 11.0, 144.0, 75.0, 56.0, 65.0, 106.0, 44.0, 45.0, 45.0, 93.0, 95.0, 73.0, 0.0, 40.0, 0.0, 80.0, 181.0, 26.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9675323612227062, "mean_inference_ms": 3.0202619251392373, "mean_action_processing_ms": 0.4690669911500116, "mean_env_wait_ms": 0.3519820219492489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069735050201416016, "StateBufferConnector_ms": 0.006125807762145996, "ViewRequirementAgentConnector_ms": 0.34777259826660156}, "num_episodes": 23, "episode_return_max": 367.0, "episode_return_min": -380.0, "episode_return_mean": 52.07, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.7379103831908, "num_env_steps_trained_throughput_per_sec": 315.7379103831908, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 15179.737, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15179.683, "sample_time_ms": 3100.944, "learn_time_ms": 12054.009, "learn_throughput": 331.84, "synch_weights_time_ms": 19.335}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "e1352_00002", "date": "2024-08-13_19-32-00", "timestamp": 1723591920, "time_this_iter_s": 12.719864845275879, "time_total_s": 1812.249344587326, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d62160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1812.249344587326, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 64.09444444444445, "ram_util_percent": 78.80555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.534394659015237, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.358068616301925, "policy_loss": -0.00319369937312942, "vf_loss": 6.360411211044069, "vf_explained_var": 0.011459073156276077, "kl": 0.010626474144240252, "entropy": 0.9462956030848165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.223926629559706, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.39428333655867, "policy_loss": -0.0021112862654109163, "vf_loss": 8.396389083256798, "vf_explained_var": -0.18525760176951292, "kl": 0.01685000282221192, "entropy": 0.8623328046823936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -380.0, "episode_reward_mean": 45.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -369.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -32.14, "predator_policy": 54.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.0, 343.0, 149.0, 37.0, 56.0, -54.0, -276.0, 283.0, 224.0, -165.0, 328.0, -15.0, 189.0, -33.0, -63.0, 292.0, 32.0, 367.0, -142.0, -16.0, -191.0, 143.0, 136.0, 309.0, 175.0, -82.0, -143.0, 217.0, 35.0, -61.0, -11.0, 301.0, -3.0, 149.0, 309.0, 59.0, 167.0, -78.0, -161.0, 62.0, 163.0, 209.0, 40.0, 205.0, -199.0, 116.0, 116.0, 79.0, 186.0, 0.0, 116.0, 36.0, -23.0, 108.0, 2.0, 20.0, -380.0, -179.0, 139.0, 73.0, 73.0, 10.0, 10.0, -63.0, -69.0, 88.0, -36.0, 123.0, 94.0, -8.0, 101.0, 23.0, 307.0, -9.0, 106.0, -130.0, 43.0, 64.0, -43.0, -40.0, 233.0, -47.0, -88.0, 345.0, -5.0, -25.0, 133.0, -57.0, -29.0, 202.0, -47.0, -291.0, -224.0, -106.0, 126.0, 78.0, 48.0, 42.0, -18.0, -16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -126.0, 195.0, 115.0, 14.0, 111.0, -29.0, -89.0, 56.0, 0.0, -183.0, -27.0, -108.0, -365.0, 143.0, 118.0, 25.0, 195.0, 0.0, -349.0, 185.0, 139.0, 151.0, -369.0, 159.0, 8.0, 0.0, -89.0, 0.0, -206.0, 65.0, 169.0, 123.0, -274.0, 168.0, 189.0, -338.0, 0.0, 0.0, -32.0, -162.0, -310.0, 107.0, 5.0, -71.0, 133.0, 150.0, 116.0, 144.0, 20.0, -347.0, -64.0, -16.0, -298.0, 68.0, 97.0, 29.0, 0.0, -153.0, -53.0, -4.0, -24.0, 90.0, 122.0, -235.0, 27.0, 173.0, -324.0, 156.0, 122.0, -80.0, 32.0, 10.0, 141.0, -84.0, -152.0, -346.0, -27.0, -104.0, -13.0, 143.0, 1.0, 89.0, 74.0, -250.0, 129.0, 38.0, 111.0, -103.0, -248.0, 113.0, -77.0, 7.0, 11.0, -62.0, -8.0, 144.0, 22.0, 0.0, 0.0, 58.0, -43.0, 37.0, -175.0, 0.0, -49.0, 147.0, -182.0, 0.0, -96.0, 72.0, -181.0, -287.0, -362.0, -59.0, -329.0, 59.0, 10.0, -153.0, 107.0, -2.0, 61.0, -61.0, -88.0, -22.0, 8.0, -6.0, -292.0, -109.0, -133.0, -136.0, 130.0, 52.0, -297.0, 30.0, -17.0, -40.0, 74.0, -150.0, 50.0, 0.0, 53.0, -55.0, -131.0, 138.0, 146.0, -22.0, -142.0, -155.0, 130.0, -247.0, -54.0, -28.0, -18.0, 104.0, -178.0, -211.0, 0.0, 0.0, -80.0, -28.0, 181.0, -346.0, 92.0, -2.0, -179.0, 136.0, 191.0, 0.0, -10.0, -76.0, -52.0, 135.0, -10.0, -166.0, -28.0, -47.0, -175.0, 60.0, 137.0, -273.0, 66.0, -313.0, -208.0, -317.0, -158.0, -91.0, -173.0, 192.0, -136.0, 70.0, -70.0, -112.0, 76.0, -48.0, 0.0, -267.0, 81.0, -38.0, -151.0], "policy_predator_policy_reward": [21.0, 45.0, 7.0, 26.0, 8.0, 16.0, 67.0, 88.0, 0.0, 0.0, 25.0, 131.0, 16.0, 181.0, 13.0, 9.0, 4.0, 0.0, 16.0, 168.0, 0.0, 4.0, 197.0, 6.0, 0.0, 22.0, 0.0, 56.0, 33.0, 110.0, 30.0, 28.0, 59.0, 124.0, 9.0, 1.0, 18.0, 178.0, 0.0, 16.0, 141.0, 140.0, 31.0, 0.0, 53.0, 21.0, 16.0, 27.0, 9.0, 2.0, 143.0, 186.0, 144.0, 27.0, 15.0, 37.0, 6.0, 0.0, 0.0, 145.0, 16.0, 1.0, 54.0, 35.0, 133.0, 72.0, 146.0, 154.0, 18.0, 13.0, 2.0, 105.0, 14.0, 2.0, 124.0, 34.0, 190.0, 22.0, 104.0, 75.0, 0.0, 19.0, 18.0, 28.0, 11.0, 150.0, 21.0, 35.0, 111.0, 41.0, 21.0, 59.0, 32.0, 66.0, 67.0, 82.0, 11.0, 9.0, 0.0, 0.0, 57.0, 44.0, 165.0, 9.0, 0.0, 26.0, 118.0, 25.0, 70.0, 28.0, 124.0, 5.0, 191.0, 78.0, 185.0, 24.0, 41.0, 29.0, 118.0, 1.0, 8.0, 6.0, 22.0, 137.0, 16.0, 8.0, 98.0, 137.0, 165.0, 8.0, 32.0, 62.0, 102.0, 107.0, 51.0, 59.0, 40.0, 20.0, 87.0, 5.0, 4.0, 44.0, 81.0, 128.0, 21.0, 2.0, 11.0, 144.0, 75.0, 56.0, 65.0, 106.0, 44.0, 45.0, 45.0, 93.0, 95.0, 73.0, 0.0, 40.0, 0.0, 80.0, 181.0, 26.0, 1.0, 92.0, 18.0, 0.0, 0.0, 5.0, 3.0, 100.0, 3.0, 5.0, 51.0, 86.0, 97.0, 96.0, 0.0, 5.0, 58.0, 102.0, 66.0, 164.0, 161.0, 90.0, 34.0, 124.0, 69.0, 1.0, 1.0, 77.0, 55.0, 29.0, 80.0, 10.0, 160.0, 8.0, 116.0, 57.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9720977337854267, "mean_inference_ms": 3.0333896056659237, "mean_action_processing_ms": 0.46932672069478515, "mean_env_wait_ms": 0.3537377960490629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006895184516906738, "StateBufferConnector_ms": 0.00592350959777832, "ViewRequirementAgentConnector_ms": 0.34628474712371826}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -380.0, "episode_return_mean": 45.33, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.4653247381674, "num_env_steps_trained_throughput_per_sec": 287.4653247381674, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 14730.085, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14730.033, "sample_time_ms": 2996.938, "learn_time_ms": 11709.438, "learn_throughput": 341.605, "synch_weights_time_ms": 18.422}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "e1352_00002", "date": "2024-08-13_19-32-14", "timestamp": 1723591934, "time_this_iter_s": 13.983306169509888, "time_total_s": 1826.232650756836, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d00c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1826.232650756836, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 65.535, "ram_util_percent": 81.705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.591793049927111, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 4.606985528759225, "policy_loss": -0.002531441944902615, "vf_loss": 4.6084606463316256, "vf_explained_var": 0.00027510211581275576, "kl": 0.013189101952636865, "entropy": 0.8922230226652963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.974982648614855, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.40782703899202, "policy_loss": -0.0027081768215688135, "vf_loss": 8.410530700128545, "vf_explained_var": -0.307761940312764, "kl": 0.01366752566469258, "entropy": 0.9498954881120611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 346.0, "episode_reward_min": -380.0, "episode_reward_mean": 47.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -362.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": -31.815, "predator_policy": 55.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-142.0, -16.0, -191.0, 143.0, 136.0, 309.0, 175.0, -82.0, -143.0, 217.0, 35.0, -61.0, -11.0, 301.0, -3.0, 149.0, 309.0, 59.0, 167.0, -78.0, -161.0, 62.0, 163.0, 209.0, 40.0, 205.0, -199.0, 116.0, 116.0, 79.0, 186.0, 0.0, 116.0, 36.0, -23.0, 108.0, 2.0, 20.0, -380.0, -179.0, 139.0, 73.0, 73.0, 10.0, 10.0, -63.0, -69.0, 88.0, -36.0, 123.0, 94.0, -8.0, 101.0, 23.0, 307.0, -9.0, 106.0, -130.0, 43.0, 64.0, -43.0, -40.0, 233.0, -47.0, -88.0, 345.0, -5.0, -25.0, 133.0, -57.0, -29.0, 202.0, -47.0, -291.0, -224.0, -106.0, 126.0, 78.0, 48.0, 42.0, -18.0, -16.0, 70.0, 167.0, 127.0, 44.0, 261.0, 230.0, 346.0, -13.0, 12.0, -193.0, 9.0, 240.0, -13.0, -26.0, 214.0, 159.0, 171.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-338.0, 0.0, 0.0, -32.0, -162.0, -310.0, 107.0, 5.0, -71.0, 133.0, 150.0, 116.0, 144.0, 20.0, -347.0, -64.0, -16.0, -298.0, 68.0, 97.0, 29.0, 0.0, -153.0, -53.0, -4.0, -24.0, 90.0, 122.0, -235.0, 27.0, 173.0, -324.0, 156.0, 122.0, -80.0, 32.0, 10.0, 141.0, -84.0, -152.0, -346.0, -27.0, -104.0, -13.0, 143.0, 1.0, 89.0, 74.0, -250.0, 129.0, 38.0, 111.0, -103.0, -248.0, 113.0, -77.0, 7.0, 11.0, -62.0, -8.0, 144.0, 22.0, 0.0, 0.0, 58.0, -43.0, 37.0, -175.0, 0.0, -49.0, 147.0, -182.0, 0.0, -96.0, 72.0, -181.0, -287.0, -362.0, -59.0, -329.0, 59.0, 10.0, -153.0, 107.0, -2.0, 61.0, -61.0, -88.0, -22.0, 8.0, -6.0, -292.0, -109.0, -133.0, -136.0, 130.0, 52.0, -297.0, 30.0, -17.0, -40.0, 74.0, -150.0, 50.0, 0.0, 53.0, -55.0, -131.0, 138.0, 146.0, -22.0, -142.0, -155.0, 130.0, -247.0, -54.0, -28.0, -18.0, 104.0, -178.0, -211.0, 0.0, 0.0, -80.0, -28.0, 181.0, -346.0, 92.0, -2.0, -179.0, 136.0, 191.0, 0.0, -10.0, -76.0, -52.0, 135.0, -10.0, -166.0, -28.0, -47.0, -175.0, 60.0, 137.0, -273.0, 66.0, -313.0, -208.0, -317.0, -158.0, -91.0, -173.0, 192.0, -136.0, 70.0, -70.0, -112.0, 76.0, -48.0, 0.0, -267.0, 81.0, -38.0, -151.0, 90.0, -130.0, 0.0, 149.0, 9.0, 77.0, 0.0, 42.0, 45.0, 157.0, 14.0, 118.0, 193.0, 131.0, -53.0, -196.0, -36.0, -55.0, -80.0, -318.0, -190.0, 28.0, 122.0, 90.0, -108.0, 0.0, 0.0, -135.0, 40.0, 110.0, 25.0, 117.0, 67.0, 18.0, -132.0, -30.0], "policy_predator_policy_reward": [18.0, 178.0, 0.0, 16.0, 141.0, 140.0, 31.0, 0.0, 53.0, 21.0, 16.0, 27.0, 9.0, 2.0, 143.0, 186.0, 144.0, 27.0, 15.0, 37.0, 6.0, 0.0, 0.0, 145.0, 16.0, 1.0, 54.0, 35.0, 133.0, 72.0, 146.0, 154.0, 18.0, 13.0, 2.0, 105.0, 14.0, 2.0, 124.0, 34.0, 190.0, 22.0, 104.0, 75.0, 0.0, 19.0, 18.0, 28.0, 11.0, 150.0, 21.0, 35.0, 111.0, 41.0, 21.0, 59.0, 32.0, 66.0, 67.0, 82.0, 11.0, 9.0, 0.0, 0.0, 57.0, 44.0, 165.0, 9.0, 0.0, 26.0, 118.0, 25.0, 70.0, 28.0, 124.0, 5.0, 191.0, 78.0, 185.0, 24.0, 41.0, 29.0, 118.0, 1.0, 8.0, 6.0, 22.0, 137.0, 16.0, 8.0, 98.0, 137.0, 165.0, 8.0, 32.0, 62.0, 102.0, 107.0, 51.0, 59.0, 40.0, 20.0, 87.0, 5.0, 4.0, 44.0, 81.0, 128.0, 21.0, 2.0, 11.0, 144.0, 75.0, 56.0, 65.0, 106.0, 44.0, 45.0, 45.0, 93.0, 95.0, 73.0, 0.0, 40.0, 0.0, 80.0, 181.0, 26.0, 1.0, 92.0, 18.0, 0.0, 0.0, 5.0, 3.0, 100.0, 3.0, 5.0, 51.0, 86.0, 97.0, 96.0, 0.0, 5.0, 58.0, 102.0, 66.0, 164.0, 161.0, 90.0, 34.0, 124.0, 69.0, 1.0, 1.0, 77.0, 55.0, 29.0, 80.0, 10.0, 160.0, 8.0, 116.0, 57.0, 9.0, 101.0, 3.0, 15.0, 0.0, 41.0, 0.0, 2.0, 23.0, 36.0, 48.0, 50.0, 22.0, 0.0, 162.0, 74.0, 9.0, 94.0, 50.0, 155.0, 11.0, 160.0, 12.0, 16.0, 0.0, 95.0, 108.0, 1.0, 45.0, 19.0, 0.0, 17.0, 54.0, 32.0, 66.0, 92.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9750725704139239, "mean_inference_ms": 3.042768222726295, "mean_action_processing_ms": 0.4693194986702027, "mean_env_wait_ms": 0.35473502767983617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005685687065124512, "StateBufferConnector_ms": 0.0043839216232299805, "ViewRequirementAgentConnector_ms": 0.29303884506225586}, "num_episodes": 18, "episode_return_max": 346.0, "episode_return_min": -380.0, "episode_return_mean": 47.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.0979359906825, "num_env_steps_trained_throughput_per_sec": 348.0979359906825, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 14519.803, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14519.751, "sample_time_ms": 2851.66, "learn_time_ms": 11644.135, "learn_throughput": 343.521, "synch_weights_time_ms": 18.639}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "e1352_00002", "date": "2024-08-13_19-32-26", "timestamp": 1723591946, "time_this_iter_s": 11.54401159286499, "time_total_s": 1837.776662349701, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1837.776662349701, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 57.34117647058823, "ram_util_percent": 82.4764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.203546986480554, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 7.6518309623476055, "policy_loss": -0.002061077875513879, "vf_loss": 7.653425704108344, "vf_explained_var": -0.00675342597027935, "kl": 0.005822934704482617, "entropy": 0.8867821857096657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.955154256467466, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.75280929646164, "policy_loss": -0.0013840122404631483, "vf_loss": 8.754189259413058, "vf_explained_var": -0.2861998330348383, "kl": 0.012306299615283744, "entropy": 0.8729636114741128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 346.0, "episode_reward_min": -380.0, "episode_reward_mean": 32.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -362.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": -40.86, "predator_policy": 57.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.0, 209.0, 40.0, 205.0, -199.0, 116.0, 116.0, 79.0, 186.0, 0.0, 116.0, 36.0, -23.0, 108.0, 2.0, 20.0, -380.0, -179.0, 139.0, 73.0, 73.0, 10.0, 10.0, -63.0, -69.0, 88.0, -36.0, 123.0, 94.0, -8.0, 101.0, 23.0, 307.0, -9.0, 106.0, -130.0, 43.0, 64.0, -43.0, -40.0, 233.0, -47.0, -88.0, 345.0, -5.0, -25.0, 133.0, -57.0, -29.0, 202.0, -47.0, -291.0, -224.0, -106.0, 126.0, 78.0, 48.0, 42.0, -18.0, -16.0, 70.0, 167.0, 127.0, 44.0, 261.0, 230.0, 346.0, -13.0, 12.0, -193.0, 9.0, 240.0, -13.0, -26.0, 214.0, 159.0, 171.0, -4.0, -51.0, 232.0, -22.0, 173.0, -154.0, -49.0, 58.0, 100.0, -54.0, -109.0, -175.0, 94.0, 152.0, 130.0, -97.0, -46.0, -27.0, -54.0, -33.0, -55.0, -112.0, -181.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [143.0, 1.0, 89.0, 74.0, -250.0, 129.0, 38.0, 111.0, -103.0, -248.0, 113.0, -77.0, 7.0, 11.0, -62.0, -8.0, 144.0, 22.0, 0.0, 0.0, 58.0, -43.0, 37.0, -175.0, 0.0, -49.0, 147.0, -182.0, 0.0, -96.0, 72.0, -181.0, -287.0, -362.0, -59.0, -329.0, 59.0, 10.0, -153.0, 107.0, -2.0, 61.0, -61.0, -88.0, -22.0, 8.0, -6.0, -292.0, -109.0, -133.0, -136.0, 130.0, 52.0, -297.0, 30.0, -17.0, -40.0, 74.0, -150.0, 50.0, 0.0, 53.0, -55.0, -131.0, 138.0, 146.0, -22.0, -142.0, -155.0, 130.0, -247.0, -54.0, -28.0, -18.0, 104.0, -178.0, -211.0, 0.0, 0.0, -80.0, -28.0, 181.0, -346.0, 92.0, -2.0, -179.0, 136.0, 191.0, 0.0, -10.0, -76.0, -52.0, 135.0, -10.0, -166.0, -28.0, -47.0, -175.0, 60.0, 137.0, -273.0, 66.0, -313.0, -208.0, -317.0, -158.0, -91.0, -173.0, 192.0, -136.0, 70.0, -70.0, -112.0, 76.0, -48.0, 0.0, -267.0, 81.0, -38.0, -151.0, 90.0, -130.0, 0.0, 149.0, 9.0, 77.0, 0.0, 42.0, 45.0, 157.0, 14.0, 118.0, 193.0, 131.0, -53.0, -196.0, -36.0, -55.0, -80.0, -318.0, -190.0, 28.0, 122.0, 90.0, -108.0, 0.0, 0.0, -135.0, 40.0, 110.0, 25.0, 117.0, 67.0, 18.0, -132.0, -30.0, -152.0, -3.0, 82.0, 110.0, -224.0, -5.0, 133.0, 40.0, -85.0, -231.0, -311.0, 0.0, -93.0, 79.0, 95.0, 0.0, -91.0, -28.0, -119.0, -123.0, -149.0, -323.0, -79.0, 65.0, 17.0, 133.0, 161.0, -203.0, -154.0, -91.0, -193.0, -10.0, -168.0, -44.0, -34.0, -349.0, 12.0, -151.0, -118.0, -57.0, -206.0, -83.0, -264.0, -90.0], "policy_predator_policy_reward": [0.0, 19.0, 18.0, 28.0, 11.0, 150.0, 21.0, 35.0, 111.0, 41.0, 21.0, 59.0, 32.0, 66.0, 67.0, 82.0, 11.0, 9.0, 0.0, 0.0, 57.0, 44.0, 165.0, 9.0, 0.0, 26.0, 118.0, 25.0, 70.0, 28.0, 124.0, 5.0, 191.0, 78.0, 185.0, 24.0, 41.0, 29.0, 118.0, 1.0, 8.0, 6.0, 22.0, 137.0, 16.0, 8.0, 98.0, 137.0, 165.0, 8.0, 32.0, 62.0, 102.0, 107.0, 51.0, 59.0, 40.0, 20.0, 87.0, 5.0, 4.0, 44.0, 81.0, 128.0, 21.0, 2.0, 11.0, 144.0, 75.0, 56.0, 65.0, 106.0, 44.0, 45.0, 45.0, 93.0, 95.0, 73.0, 0.0, 40.0, 0.0, 80.0, 181.0, 26.0, 1.0, 92.0, 18.0, 0.0, 0.0, 5.0, 3.0, 100.0, 3.0, 5.0, 51.0, 86.0, 97.0, 96.0, 0.0, 5.0, 58.0, 102.0, 66.0, 164.0, 161.0, 90.0, 34.0, 124.0, 69.0, 1.0, 1.0, 77.0, 55.0, 29.0, 80.0, 10.0, 160.0, 8.0, 116.0, 57.0, 9.0, 101.0, 3.0, 15.0, 0.0, 41.0, 0.0, 2.0, 23.0, 36.0, 48.0, 50.0, 22.0, 0.0, 162.0, 74.0, 9.0, 94.0, 50.0, 155.0, 11.0, 160.0, 12.0, 16.0, 0.0, 95.0, 108.0, 1.0, 45.0, 19.0, 0.0, 17.0, 54.0, 32.0, 66.0, 92.0, 0.0, 104.0, 18.0, 22.0, 93.0, 114.0, 0.0, 0.0, 34.0, 128.0, 158.0, 104.0, 0.0, 72.0, 0.0, 5.0, 11.0, 54.0, 119.0, 14.0, 183.0, 114.0, 6.0, 102.0, 0.0, 2.0, 88.0, 84.0, 19.0, 129.0, 86.0, 71.0, 52.0, 133.0, 152.0, 177.0, 0.0, 106.0, 38.0, 82.0, 32.0, 145.0, 20.0, 153.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9753760038225444, "mean_inference_ms": 3.043665368379259, "mean_action_processing_ms": 0.46781233853078347, "mean_env_wait_ms": 0.3546595666478956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008862853050231934, "StateBufferConnector_ms": 0.006265997886657715, "ViewRequirementAgentConnector_ms": 0.28598928451538086}, "num_episodes": 22, "episode_return_max": 346.0, "episode_return_min": -380.0, "episode_return_mean": 32.46, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.851391089829, "num_env_steps_trained_throughput_per_sec": 318.851391089829, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 14217.501, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14217.449, "sample_time_ms": 2728.975, "learn_time_ms": 11464.766, "learn_throughput": 348.895, "synch_weights_time_ms": 18.451}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "e1352_00002", "date": "2024-08-13_19-32-38", "timestamp": 1723591958, "time_this_iter_s": 12.610205888748169, "time_total_s": 1850.386868238449, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d41ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1850.386868238449, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 62.294444444444444, "ram_util_percent": 82.8888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.833464541353246, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 4.99134850993989, "policy_loss": -0.0016200432648744295, "vf_loss": 4.992130762180954, "vf_explained_var": -0.004286002765887629, "kl": 0.010460511704086642, "entropy": 0.88409767109881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.97608895349124, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.210132660941472, "policy_loss": -0.0009257420967702591, "vf_loss": 8.21105423352075, "vf_explained_var": -0.19074912178453315, "kl": 0.01264349830871268, "entropy": 0.9121579346833406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 346.0, "episode_reward_min": -291.0, "episode_reward_mean": 44.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 183.0}, "policy_reward_mean": {"prey_policy": -37.11, "predator_policy": 59.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.0, -69.0, 88.0, -36.0, 123.0, 94.0, -8.0, 101.0, 23.0, 307.0, -9.0, 106.0, -130.0, 43.0, 64.0, -43.0, -40.0, 233.0, -47.0, -88.0, 345.0, -5.0, -25.0, 133.0, -57.0, -29.0, 202.0, -47.0, -291.0, -224.0, -106.0, 126.0, 78.0, 48.0, 42.0, -18.0, -16.0, 70.0, 167.0, 127.0, 44.0, 261.0, 230.0, 346.0, -13.0, 12.0, -193.0, 9.0, 240.0, -13.0, -26.0, 214.0, 159.0, 171.0, -4.0, -51.0, 232.0, -22.0, 173.0, -154.0, -49.0, 58.0, 100.0, -54.0, -109.0, -175.0, 94.0, 152.0, 130.0, -97.0, -46.0, -27.0, -54.0, -33.0, -55.0, -112.0, -181.0, 186.0, 166.0, 144.0, 213.0, -55.0, 228.0, 176.0, 90.0, -6.0, 72.0, 72.0, 39.0, -93.0, -153.0, 262.0, 0.0, 280.0, 116.0, -82.0, 143.0, 167.0, -71.0, 216.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -292.0, -109.0, -133.0, -136.0, 130.0, 52.0, -297.0, 30.0, -17.0, -40.0, 74.0, -150.0, 50.0, 0.0, 53.0, -55.0, -131.0, 138.0, 146.0, -22.0, -142.0, -155.0, 130.0, -247.0, -54.0, -28.0, -18.0, 104.0, -178.0, -211.0, 0.0, 0.0, -80.0, -28.0, 181.0, -346.0, 92.0, -2.0, -179.0, 136.0, 191.0, 0.0, -10.0, -76.0, -52.0, 135.0, -10.0, -166.0, -28.0, -47.0, -175.0, 60.0, 137.0, -273.0, 66.0, -313.0, -208.0, -317.0, -158.0, -91.0, -173.0, 192.0, -136.0, 70.0, -70.0, -112.0, 76.0, -48.0, 0.0, -267.0, 81.0, -38.0, -151.0, 90.0, -130.0, 0.0, 149.0, 9.0, 77.0, 0.0, 42.0, 45.0, 157.0, 14.0, 118.0, 193.0, 131.0, -53.0, -196.0, -36.0, -55.0, -80.0, -318.0, -190.0, 28.0, 122.0, 90.0, -108.0, 0.0, 0.0, -135.0, 40.0, 110.0, 25.0, 117.0, 67.0, 18.0, -132.0, -30.0, -152.0, -3.0, 82.0, 110.0, -224.0, -5.0, 133.0, 40.0, -85.0, -231.0, -311.0, 0.0, -93.0, 79.0, 95.0, 0.0, -91.0, -28.0, -119.0, -123.0, -149.0, -323.0, -79.0, 65.0, 17.0, 133.0, 161.0, -203.0, -154.0, -91.0, -193.0, -10.0, -168.0, -44.0, -34.0, -349.0, 12.0, -151.0, -118.0, -57.0, -206.0, -83.0, -264.0, -90.0, 77.0, 21.0, 97.0, 21.0, 2.0, 111.0, 86.0, 124.0, -175.0, 0.0, 136.0, 17.0, -15.0, 100.0, -331.0, 81.0, -275.0, 102.0, 0.0, 56.0, 38.0, 8.0, -65.0, -12.0, -64.0, -235.0, 10.0, -350.0, 185.0, -39.0, -282.0, 126.0, 123.0, 129.0, 119.0, -174.0, -215.0, 8.0, 160.0, -125.0, -181.0, 150.0, -347.0, -48.0, 107.0, 93.0], "policy_predator_policy_reward": [98.0, 137.0, 165.0, 8.0, 32.0, 62.0, 102.0, 107.0, 51.0, 59.0, 40.0, 20.0, 87.0, 5.0, 4.0, 44.0, 81.0, 128.0, 21.0, 2.0, 11.0, 144.0, 75.0, 56.0, 65.0, 106.0, 44.0, 45.0, 45.0, 93.0, 95.0, 73.0, 0.0, 40.0, 0.0, 80.0, 181.0, 26.0, 1.0, 92.0, 18.0, 0.0, 0.0, 5.0, 3.0, 100.0, 3.0, 5.0, 51.0, 86.0, 97.0, 96.0, 0.0, 5.0, 58.0, 102.0, 66.0, 164.0, 161.0, 90.0, 34.0, 124.0, 69.0, 1.0, 1.0, 77.0, 55.0, 29.0, 80.0, 10.0, 160.0, 8.0, 116.0, 57.0, 9.0, 101.0, 3.0, 15.0, 0.0, 41.0, 0.0, 2.0, 23.0, 36.0, 48.0, 50.0, 22.0, 0.0, 162.0, 74.0, 9.0, 94.0, 50.0, 155.0, 11.0, 160.0, 12.0, 16.0, 0.0, 95.0, 108.0, 1.0, 45.0, 19.0, 0.0, 17.0, 54.0, 32.0, 66.0, 92.0, 0.0, 104.0, 18.0, 22.0, 93.0, 114.0, 0.0, 0.0, 34.0, 128.0, 158.0, 104.0, 0.0, 72.0, 0.0, 5.0, 11.0, 54.0, 119.0, 14.0, 183.0, 114.0, 6.0, 102.0, 0.0, 2.0, 88.0, 84.0, 19.0, 129.0, 86.0, 71.0, 52.0, 133.0, 152.0, 177.0, 0.0, 106.0, 38.0, 82.0, 32.0, 145.0, 20.0, 153.0, 41.0, 47.0, 21.0, 27.0, 31.0, 0.0, 3.0, 0.0, 0.0, 120.0, 40.0, 35.0, 17.0, 74.0, 177.0, 163.0, 11.0, 156.0, 8.0, 8.0, 19.0, 7.0, 56.0, 60.0, 124.0, 82.0, 167.0, 20.0, 59.0, 57.0, 150.0, 6.0, 2.0, 26.0, 88.0, 83.0, 0.0, 125.0, 4.0, 104.0, 104.0, 94.0, 145.0, 179.0, 5.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9733545860694887, "mean_inference_ms": 3.0449522247325223, "mean_action_processing_ms": 0.46642669863691466, "mean_env_wait_ms": 0.3545857307334503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009256601333618164, "StateBufferConnector_ms": 0.005859255790710449, "ViewRequirementAgentConnector_ms": 0.2644556760787964}, "num_episodes": 23, "episode_return_max": 346.0, "episode_return_min": -291.0, "episode_return_mean": 44.36, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.34816217764876, "num_env_steps_trained_throughput_per_sec": 261.34816217764876, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 13985.445, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13985.393, "sample_time_ms": 2380.764, "learn_time_ms": 11577.928, "learn_throughput": 345.485, "synch_weights_time_ms": 21.311}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "e1352_00002", "date": "2024-08-13_19-32-54", "timestamp": 1723591974, "time_this_iter_s": 15.431123971939087, "time_total_s": 1865.8179922103882, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1865.8179922103882, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 72.7818181818182, "ram_util_percent": 83.38636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8229102059489204, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 3.9554510165774635, "policy_loss": -0.0014906536561077235, "vf_loss": 3.956277081827638, "vf_explained_var": -0.0027035388996992163, "kl": 0.008297967762858538, "entropy": 0.8753371109407415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.34857218508367, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.593598353168952, "policy_loss": -0.0026706907342597054, "vf_loss": 7.596264961030748, "vf_explained_var": -0.5508289153613741, "kl": 0.012379851064764249, "entropy": 1.1072464694737127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 346.0, "episode_reward_min": -291.0, "episode_reward_mean": 36.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -350.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -37.71, "predator_policy": 55.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-47.0, -88.0, 345.0, -5.0, -25.0, 133.0, -57.0, -29.0, 202.0, -47.0, -291.0, -224.0, -106.0, 126.0, 78.0, 48.0, 42.0, -18.0, -16.0, 70.0, 167.0, 127.0, 44.0, 261.0, 230.0, 346.0, -13.0, 12.0, -193.0, 9.0, 240.0, -13.0, -26.0, 214.0, 159.0, 171.0, -4.0, -51.0, 232.0, -22.0, 173.0, -154.0, -49.0, 58.0, 100.0, -54.0, -109.0, -175.0, 94.0, 152.0, 130.0, -97.0, -46.0, -27.0, -54.0, -33.0, -55.0, -112.0, -181.0, 186.0, 166.0, 144.0, 213.0, -55.0, 228.0, 176.0, 90.0, -6.0, 72.0, 72.0, 39.0, -93.0, -153.0, 262.0, 0.0, 280.0, 116.0, -82.0, 143.0, 167.0, -71.0, 216.0, -48.0, 1.0, 116.0, -183.0, 0.0, -3.0, 11.0, -3.0, 13.0, -1.0, 132.0, -181.0, -17.0, 36.0, 121.0, 2.0, -3.0, -29.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-346.0, 92.0, -2.0, -179.0, 136.0, 191.0, 0.0, -10.0, -76.0, -52.0, 135.0, -10.0, -166.0, -28.0, -47.0, -175.0, 60.0, 137.0, -273.0, 66.0, -313.0, -208.0, -317.0, -158.0, -91.0, -173.0, 192.0, -136.0, 70.0, -70.0, -112.0, 76.0, -48.0, 0.0, -267.0, 81.0, -38.0, -151.0, 90.0, -130.0, 0.0, 149.0, 9.0, 77.0, 0.0, 42.0, 45.0, 157.0, 14.0, 118.0, 193.0, 131.0, -53.0, -196.0, -36.0, -55.0, -80.0, -318.0, -190.0, 28.0, 122.0, 90.0, -108.0, 0.0, 0.0, -135.0, 40.0, 110.0, 25.0, 117.0, 67.0, 18.0, -132.0, -30.0, -152.0, -3.0, 82.0, 110.0, -224.0, -5.0, 133.0, 40.0, -85.0, -231.0, -311.0, 0.0, -93.0, 79.0, 95.0, 0.0, -91.0, -28.0, -119.0, -123.0, -149.0, -323.0, -79.0, 65.0, 17.0, 133.0, 161.0, -203.0, -154.0, -91.0, -193.0, -10.0, -168.0, -44.0, -34.0, -349.0, 12.0, -151.0, -118.0, -57.0, -206.0, -83.0, -264.0, -90.0, 77.0, 21.0, 97.0, 21.0, 2.0, 111.0, 86.0, 124.0, -175.0, 0.0, 136.0, 17.0, -15.0, 100.0, -331.0, 81.0, -275.0, 102.0, 0.0, 56.0, 38.0, 8.0, -65.0, -12.0, -64.0, -235.0, 10.0, -350.0, 185.0, -39.0, -282.0, 126.0, 123.0, 129.0, 119.0, -174.0, -215.0, 8.0, 160.0, -125.0, -181.0, 150.0, -347.0, -48.0, 107.0, 93.0, -79.0, -97.0, 0.0, -11.0, 0.0, 115.0, -178.0, -173.0, 0.0, 0.0, -68.0, -220.0, 0.0, -11.0, -167.0, 48.0, 0.0, 8.0, -12.0, 0.0, 0.0, 132.0, -259.0, -286.0, -74.0, -35.0, -17.0, 1.0, 59.0, 55.0, 0.0, 2.0, -64.0, -60.0, -217.0, 47.0], "policy_predator_policy_reward": [181.0, 26.0, 1.0, 92.0, 18.0, 0.0, 0.0, 5.0, 3.0, 100.0, 3.0, 5.0, 51.0, 86.0, 97.0, 96.0, 0.0, 5.0, 58.0, 102.0, 66.0, 164.0, 161.0, 90.0, 34.0, 124.0, 69.0, 1.0, 1.0, 77.0, 55.0, 29.0, 80.0, 10.0, 160.0, 8.0, 116.0, 57.0, 9.0, 101.0, 3.0, 15.0, 0.0, 41.0, 0.0, 2.0, 23.0, 36.0, 48.0, 50.0, 22.0, 0.0, 162.0, 74.0, 9.0, 94.0, 50.0, 155.0, 11.0, 160.0, 12.0, 16.0, 0.0, 95.0, 108.0, 1.0, 45.0, 19.0, 0.0, 17.0, 54.0, 32.0, 66.0, 92.0, 0.0, 104.0, 18.0, 22.0, 93.0, 114.0, 0.0, 0.0, 34.0, 128.0, 158.0, 104.0, 0.0, 72.0, 0.0, 5.0, 11.0, 54.0, 119.0, 14.0, 183.0, 114.0, 6.0, 102.0, 0.0, 2.0, 88.0, 84.0, 19.0, 129.0, 86.0, 71.0, 52.0, 133.0, 152.0, 177.0, 0.0, 106.0, 38.0, 82.0, 32.0, 145.0, 20.0, 153.0, 41.0, 47.0, 21.0, 27.0, 31.0, 0.0, 3.0, 0.0, 0.0, 120.0, 40.0, 35.0, 17.0, 74.0, 177.0, 163.0, 11.0, 156.0, 8.0, 8.0, 19.0, 7.0, 56.0, 60.0, 124.0, 82.0, 167.0, 20.0, 59.0, 57.0, 150.0, 6.0, 2.0, 26.0, 88.0, 83.0, 0.0, 125.0, 4.0, 104.0, 104.0, 94.0, 145.0, 179.0, 5.0, 11.0, 121.0, 7.0, 0.0, 12.0, 1.0, 0.0, 156.0, 12.0, 0.0, 0.0, 141.0, 144.0, 1.0, 21.0, 0.0, 116.0, 5.0, 0.0, 11.0, 0.0, 0.0, 0.0, 186.0, 178.0, 92.0, 0.0, 0.0, 52.0, 3.0, 4.0, 0.0, 0.0, 91.0, 30.0, 141.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9814346627375968, "mean_inference_ms": 3.060150168610077, "mean_action_processing_ms": 0.46663847931470165, "mean_env_wait_ms": 0.3559602370827629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008524656295776367, "StateBufferConnector_ms": 0.005756497383117676, "ViewRequirementAgentConnector_ms": 0.29975879192352295}, "num_episodes": 18, "episode_return_max": 346.0, "episode_return_min": -291.0, "episode_return_mean": 36.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.90324514995595, "num_env_steps_trained_throughput_per_sec": 174.90324514995595, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 15007.283, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15007.226, "sample_time_ms": 2995.914, "learn_time_ms": 11983.078, "learn_throughput": 333.804, "synch_weights_time_ms": 22.673}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "e1352_00002", "date": "2024-08-13_19-33-17", "timestamp": 1723591997, "time_this_iter_s": 22.948580741882324, "time_total_s": 1888.7665729522705, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb30d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1888.7665729522705, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 89.353125, "ram_util_percent": 83.61874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.565729622534974, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 3.772575230825515, "policy_loss": -0.0030625222773764224, "vf_loss": 3.775073317623643, "vf_explained_var": 0.015060164657219377, "kl": 0.007047356502776715, "entropy": 0.8739505373611652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.75357162608672, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 6.428453674013652, "policy_loss": -0.002397789677269954, "vf_loss": 6.430849252176032, "vf_explained_var": -0.13242899693509258, "kl": 0.006780810615563417, "entropy": 1.0794009508279265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 346.0, "episode_reward_min": -193.0, "episode_reward_mean": 50.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -383.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -25.86, "predator_policy": 51.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.0, 70.0, 167.0, 127.0, 44.0, 261.0, 230.0, 346.0, -13.0, 12.0, -193.0, 9.0, 240.0, -13.0, -26.0, 214.0, 159.0, 171.0, -4.0, -51.0, 232.0, -22.0, 173.0, -154.0, -49.0, 58.0, 100.0, -54.0, -109.0, -175.0, 94.0, 152.0, 130.0, -97.0, -46.0, -27.0, -54.0, -33.0, -55.0, -112.0, -181.0, 186.0, 166.0, 144.0, 213.0, -55.0, 228.0, 176.0, 90.0, -6.0, 72.0, 72.0, 39.0, -93.0, -153.0, 262.0, 0.0, 280.0, 116.0, -82.0, 143.0, 167.0, -71.0, 216.0, -48.0, 1.0, 116.0, -183.0, 0.0, -3.0, 11.0, -3.0, 13.0, -1.0, 132.0, -181.0, -17.0, 36.0, 121.0, 2.0, -3.0, -29.0, 94.0, -24.0, 25.0, 120.0, 221.0, 121.0, 17.0, 123.0, 20.0, 85.0, -13.0, -27.0, 9.0, 125.0, 90.0, 22.0, 310.0, 155.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.0, -151.0, 90.0, -130.0, 0.0, 149.0, 9.0, 77.0, 0.0, 42.0, 45.0, 157.0, 14.0, 118.0, 193.0, 131.0, -53.0, -196.0, -36.0, -55.0, -80.0, -318.0, -190.0, 28.0, 122.0, 90.0, -108.0, 0.0, 0.0, -135.0, 40.0, 110.0, 25.0, 117.0, 67.0, 18.0, -132.0, -30.0, -152.0, -3.0, 82.0, 110.0, -224.0, -5.0, 133.0, 40.0, -85.0, -231.0, -311.0, 0.0, -93.0, 79.0, 95.0, 0.0, -91.0, -28.0, -119.0, -123.0, -149.0, -323.0, -79.0, 65.0, 17.0, 133.0, 161.0, -203.0, -154.0, -91.0, -193.0, -10.0, -168.0, -44.0, -34.0, -349.0, 12.0, -151.0, -118.0, -57.0, -206.0, -83.0, -264.0, -90.0, 77.0, 21.0, 97.0, 21.0, 2.0, 111.0, 86.0, 124.0, -175.0, 0.0, 136.0, 17.0, -15.0, 100.0, -331.0, 81.0, -275.0, 102.0, 0.0, 56.0, 38.0, 8.0, -65.0, -12.0, -64.0, -235.0, 10.0, -350.0, 185.0, -39.0, -282.0, 126.0, 123.0, 129.0, 119.0, -174.0, -215.0, 8.0, 160.0, -125.0, -181.0, 150.0, -347.0, -48.0, 107.0, 93.0, -79.0, -97.0, 0.0, -11.0, 0.0, 115.0, -178.0, -173.0, 0.0, 0.0, -68.0, -220.0, 0.0, -11.0, -167.0, 48.0, 0.0, 8.0, -12.0, 0.0, 0.0, 132.0, -259.0, -286.0, -74.0, -35.0, -17.0, 1.0, 59.0, 55.0, 0.0, 2.0, -64.0, -60.0, -217.0, 47.0, 0.0, 73.0, -135.0, 10.0, -13.0, 18.0, 55.0, 30.0, 79.0, 92.0, 0.0, 100.0, 139.0, -320.0, 0.0, 117.0, 0.0, 11.0, -8.0, 55.0, -113.0, -8.0, -383.0, 91.0, -244.0, 56.0, 121.0, 0.0, 58.0, 0.0, 0.0, 16.0, 133.0, 170.0, 149.0, 0.0], "policy_predator_policy_reward": [116.0, 57.0, 9.0, 101.0, 3.0, 15.0, 0.0, 41.0, 0.0, 2.0, 23.0, 36.0, 48.0, 50.0, 22.0, 0.0, 162.0, 74.0, 9.0, 94.0, 50.0, 155.0, 11.0, 160.0, 12.0, 16.0, 0.0, 95.0, 108.0, 1.0, 45.0, 19.0, 0.0, 17.0, 54.0, 32.0, 66.0, 92.0, 0.0, 104.0, 18.0, 22.0, 93.0, 114.0, 0.0, 0.0, 34.0, 128.0, 158.0, 104.0, 0.0, 72.0, 0.0, 5.0, 11.0, 54.0, 119.0, 14.0, 183.0, 114.0, 6.0, 102.0, 0.0, 2.0, 88.0, 84.0, 19.0, 129.0, 86.0, 71.0, 52.0, 133.0, 152.0, 177.0, 0.0, 106.0, 38.0, 82.0, 32.0, 145.0, 20.0, 153.0, 41.0, 47.0, 21.0, 27.0, 31.0, 0.0, 3.0, 0.0, 0.0, 120.0, 40.0, 35.0, 17.0, 74.0, 177.0, 163.0, 11.0, 156.0, 8.0, 8.0, 19.0, 7.0, 56.0, 60.0, 124.0, 82.0, 167.0, 20.0, 59.0, 57.0, 150.0, 6.0, 2.0, 26.0, 88.0, 83.0, 0.0, 125.0, 4.0, 104.0, 104.0, 94.0, 145.0, 179.0, 5.0, 11.0, 121.0, 7.0, 0.0, 12.0, 1.0, 0.0, 156.0, 12.0, 0.0, 0.0, 141.0, 144.0, 1.0, 21.0, 0.0, 116.0, 5.0, 0.0, 11.0, 0.0, 0.0, 0.0, 186.0, 178.0, 92.0, 0.0, 0.0, 52.0, 3.0, 4.0, 0.0, 0.0, 91.0, 30.0, 141.0, 0.0, 18.0, 3.0, 0.0, 101.0, 7.0, 13.0, 3.0, 32.0, 37.0, 13.0, 1.0, 20.0, 33.0, 165.0, 6.0, 0.0, 9.0, 0.0, 22.0, 16.0, 108.0, 0.0, 177.0, 88.0, 68.0, 129.0, 0.0, 4.0, 18.0, 14.0, 0.0, 6.0, 0.0, 7.0, 1.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.990781084785491, "mean_inference_ms": 3.0881790079944254, "mean_action_processing_ms": 0.4687376453751206, "mean_env_wait_ms": 0.35863441911409233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009293079376220703, "StateBufferConnector_ms": 0.006053805351257324, "ViewRequirementAgentConnector_ms": 0.3638947010040283}, "num_episodes": 18, "episode_return_max": 346.0, "episode_return_min": -193.0, "episode_return_mean": 50.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.15576982697573, "num_env_steps_trained_throughput_per_sec": 208.15576982697573, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 15551.901, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15551.844, "sample_time_ms": 3295.431, "learn_time_ms": 12225.288, "learn_throughput": 327.191, "synch_weights_time_ms": 25.776}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "e1352_00002", "date": "2024-08-13_19-33-36", "timestamp": 1723592016, "time_this_iter_s": 19.48508906364441, "time_total_s": 1908.251662015915, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1908.251662015915, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 83.46296296296298, "ram_util_percent": 82.53703703703704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.642260679405518, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 5.851062442638256, "policy_loss": -0.0030943513467227893, "vf_loss": 5.853485890040322, "vf_explained_var": 0.02583216422449344, "kl": 0.008376947489206261, "entropy": 0.820440590854675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.61853611417233, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.017879870581249, "policy_loss": -0.00038168342961441903, "vf_loss": 8.018259318165047, "vf_explained_var": -0.40720569645916976, "kl": 0.006821666563000069, "entropy": 0.938342241067735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -499.0, "episode_reward_mean": 20.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -44.685, "predator_policy": 54.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [173.0, -154.0, -49.0, 58.0, 100.0, -54.0, -109.0, -175.0, 94.0, 152.0, 130.0, -97.0, -46.0, -27.0, -54.0, -33.0, -55.0, -112.0, -181.0, 186.0, 166.0, 144.0, 213.0, -55.0, 228.0, 176.0, 90.0, -6.0, 72.0, 72.0, 39.0, -93.0, -153.0, 262.0, 0.0, 280.0, 116.0, -82.0, 143.0, 167.0, -71.0, 216.0, -48.0, 1.0, 116.0, -183.0, 0.0, -3.0, 11.0, -3.0, 13.0, -1.0, 132.0, -181.0, -17.0, 36.0, 121.0, 2.0, -3.0, -29.0, 94.0, -24.0, 25.0, 120.0, 221.0, 121.0, 17.0, 123.0, 20.0, 85.0, -13.0, -27.0, 9.0, 125.0, 90.0, 22.0, 310.0, 155.0, 131.0, -273.0, -308.0, -396.0, 4.0, 25.0, 244.0, 5.0, -42.0, 13.0, -71.0, -499.0, 154.0, 99.0, 120.0, -38.0, 144.0, 28.0, -154.0, -177.0, -14.0, -49.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [133.0, 40.0, -85.0, -231.0, -311.0, 0.0, -93.0, 79.0, 95.0, 0.0, -91.0, -28.0, -119.0, -123.0, -149.0, -323.0, -79.0, 65.0, 17.0, 133.0, 161.0, -203.0, -154.0, -91.0, -193.0, -10.0, -168.0, -44.0, -34.0, -349.0, 12.0, -151.0, -118.0, -57.0, -206.0, -83.0, -264.0, -90.0, 77.0, 21.0, 97.0, 21.0, 2.0, 111.0, 86.0, 124.0, -175.0, 0.0, 136.0, 17.0, -15.0, 100.0, -331.0, 81.0, -275.0, 102.0, 0.0, 56.0, 38.0, 8.0, -65.0, -12.0, -64.0, -235.0, 10.0, -350.0, 185.0, -39.0, -282.0, 126.0, 123.0, 129.0, 119.0, -174.0, -215.0, 8.0, 160.0, -125.0, -181.0, 150.0, -347.0, -48.0, 107.0, 93.0, -79.0, -97.0, 0.0, -11.0, 0.0, 115.0, -178.0, -173.0, 0.0, 0.0, -68.0, -220.0, 0.0, -11.0, -167.0, 48.0, 0.0, 8.0, -12.0, 0.0, 0.0, 132.0, -259.0, -286.0, -74.0, -35.0, -17.0, 1.0, 59.0, 55.0, 0.0, 2.0, -64.0, -60.0, -217.0, 47.0, 0.0, 73.0, -135.0, 10.0, -13.0, 18.0, 55.0, 30.0, 79.0, 92.0, 0.0, 100.0, 139.0, -320.0, 0.0, 117.0, 0.0, 11.0, -8.0, 55.0, -113.0, -8.0, -383.0, 91.0, -244.0, 56.0, 121.0, 0.0, 58.0, 0.0, 0.0, 16.0, 133.0, 170.0, 149.0, 0.0, 115.0, -24.0, -385.0, -238.0, -234.0, -391.0, -354.0, -319.0, -26.0, 0.0, -23.0, -6.0, 90.0, 154.0, -60.0, 12.0, -165.0, -9.0, 44.0, -85.0, -67.0, -296.0, -355.0, -341.0, 113.0, -4.0, -2.0, 40.0, 17.0, 84.0, -227.0, 0.0, 0.0, 128.0, 0.0, -90.0, 0.0, -331.0, -46.0, -311.0, -25.0, -137.0, -298.0, 85.0], "policy_predator_policy_reward": [0.0, 0.0, 34.0, 128.0, 158.0, 104.0, 0.0, 72.0, 0.0, 5.0, 11.0, 54.0, 119.0, 14.0, 183.0, 114.0, 6.0, 102.0, 0.0, 2.0, 88.0, 84.0, 19.0, 129.0, 86.0, 71.0, 52.0, 133.0, 152.0, 177.0, 0.0, 106.0, 38.0, 82.0, 32.0, 145.0, 20.0, 153.0, 41.0, 47.0, 21.0, 27.0, 31.0, 0.0, 3.0, 0.0, 0.0, 120.0, 40.0, 35.0, 17.0, 74.0, 177.0, 163.0, 11.0, 156.0, 8.0, 8.0, 19.0, 7.0, 56.0, 60.0, 124.0, 82.0, 167.0, 20.0, 59.0, 57.0, 150.0, 6.0, 2.0, 26.0, 88.0, 83.0, 0.0, 125.0, 4.0, 104.0, 104.0, 94.0, 145.0, 179.0, 5.0, 11.0, 121.0, 7.0, 0.0, 12.0, 1.0, 0.0, 156.0, 12.0, 0.0, 0.0, 141.0, 144.0, 1.0, 21.0, 0.0, 116.0, 5.0, 0.0, 11.0, 0.0, 0.0, 0.0, 186.0, 178.0, 92.0, 0.0, 0.0, 52.0, 3.0, 4.0, 0.0, 0.0, 91.0, 30.0, 141.0, 0.0, 18.0, 3.0, 0.0, 101.0, 7.0, 13.0, 3.0, 32.0, 37.0, 13.0, 1.0, 20.0, 33.0, 165.0, 6.0, 0.0, 9.0, 0.0, 22.0, 16.0, 108.0, 0.0, 177.0, 88.0, 68.0, 129.0, 0.0, 4.0, 18.0, 14.0, 0.0, 6.0, 0.0, 7.0, 1.0, 5.0, 18.0, 22.0, 200.0, 150.0, 197.0, 120.0, 92.0, 185.0, 25.0, 5.0, 51.0, 3.0, 0.0, 0.0, 2.0, 51.0, 94.0, 38.0, 6.0, 48.0, 164.0, 128.0, 2.0, 195.0, 0.0, 45.0, 1.0, 60.0, 6.0, 13.0, 74.0, 115.0, 3.0, 13.0, 55.0, 63.0, 177.0, 0.0, 178.0, 2.0, 28.0, 120.0, 3.0, 161.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0064314270291284, "mean_inference_ms": 3.1365972014821737, "mean_action_processing_ms": 0.47371767294287964, "mean_env_wait_ms": 0.3639297215233262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009954214096069336, "StateBufferConnector_ms": 0.006334066390991211, "ViewRequirementAgentConnector_ms": 0.541236162185669}, "num_episodes": 22, "episode_return_max": 310.0, "episode_return_min": -499.0, "episode_return_mean": 20.54, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.43566364762404, "num_env_steps_trained_throughput_per_sec": 217.43566364762404, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 15806.896, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15806.839, "sample_time_ms": 3559.94, "learn_time_ms": 12219.404, "learn_throughput": 327.348, "synch_weights_time_ms": 23.28}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "e1352_00002", "date": "2024-08-13_19-33-55", "timestamp": 1723592035, "time_this_iter_s": 18.51758885383606, "time_total_s": 1926.769250869751, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d138b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1926.769250869751, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 75.0111111111111, "ram_util_percent": 83.91481481481482}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.329612841058976, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 4.9497672951410685, "policy_loss": -0.0038557217219874025, "vf_loss": 4.95261695687733, "vf_explained_var": 0.015375038713374466, "kl": 0.012561503910846742, "entropy": 0.8871074357676128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71.4608460292299, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.310221200771433, "policy_loss": -0.005967431143911742, "vf_loss": 7.316183449225451, "vf_explained_var": -0.2659317234836558, "kl": 0.01573759923113458, "entropy": 1.0668700190448257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -499.0, "episode_reward_mean": 32.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -32.74, "predator_policy": 48.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.0, 186.0, 166.0, 144.0, 213.0, -55.0, 228.0, 176.0, 90.0, -6.0, 72.0, 72.0, 39.0, -93.0, -153.0, 262.0, 0.0, 280.0, 116.0, -82.0, 143.0, 167.0, -71.0, 216.0, -48.0, 1.0, 116.0, -183.0, 0.0, -3.0, 11.0, -3.0, 13.0, -1.0, 132.0, -181.0, -17.0, 36.0, 121.0, 2.0, -3.0, -29.0, 94.0, -24.0, 25.0, 120.0, 221.0, 121.0, 17.0, 123.0, 20.0, 85.0, -13.0, -27.0, 9.0, 125.0, 90.0, 22.0, 310.0, 155.0, 131.0, -273.0, -308.0, -396.0, 4.0, 25.0, 244.0, 5.0, -42.0, 13.0, -71.0, -499.0, 154.0, 99.0, 120.0, -38.0, 144.0, 28.0, -154.0, -177.0, -14.0, -49.0, 172.0, 81.0, 99.0, 32.0, -73.0, 23.0, 131.0, 48.0, 37.0, -100.0, 94.0, 19.0, 142.0, 41.0, 89.0, 62.0, 151.0, -114.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-264.0, -90.0, 77.0, 21.0, 97.0, 21.0, 2.0, 111.0, 86.0, 124.0, -175.0, 0.0, 136.0, 17.0, -15.0, 100.0, -331.0, 81.0, -275.0, 102.0, 0.0, 56.0, 38.0, 8.0, -65.0, -12.0, -64.0, -235.0, 10.0, -350.0, 185.0, -39.0, -282.0, 126.0, 123.0, 129.0, 119.0, -174.0, -215.0, 8.0, 160.0, -125.0, -181.0, 150.0, -347.0, -48.0, 107.0, 93.0, -79.0, -97.0, 0.0, -11.0, 0.0, 115.0, -178.0, -173.0, 0.0, 0.0, -68.0, -220.0, 0.0, -11.0, -167.0, 48.0, 0.0, 8.0, -12.0, 0.0, 0.0, 132.0, -259.0, -286.0, -74.0, -35.0, -17.0, 1.0, 59.0, 55.0, 0.0, 2.0, -64.0, -60.0, -217.0, 47.0, 0.0, 73.0, -135.0, 10.0, -13.0, 18.0, 55.0, 30.0, 79.0, 92.0, 0.0, 100.0, 139.0, -320.0, 0.0, 117.0, 0.0, 11.0, -8.0, 55.0, -113.0, -8.0, -383.0, 91.0, -244.0, 56.0, 121.0, 0.0, 58.0, 0.0, 0.0, 16.0, 133.0, 170.0, 149.0, 0.0, 115.0, -24.0, -385.0, -238.0, -234.0, -391.0, -354.0, -319.0, -26.0, 0.0, -23.0, -6.0, 90.0, 154.0, -60.0, 12.0, -165.0, -9.0, 44.0, -85.0, -67.0, -296.0, -355.0, -341.0, 113.0, -4.0, -2.0, 40.0, 17.0, 84.0, -227.0, 0.0, 0.0, 128.0, 0.0, -90.0, 0.0, -331.0, -46.0, -311.0, -25.0, -137.0, -298.0, 85.0, 170.0, 0.0, -82.0, 36.0, -3.0, 31.0, 29.0, -32.0, -120.0, -52.0, 0.0, -30.0, 10.0, 36.0, 48.0, 0.0, -35.0, -3.0, -191.0, -104.0, 120.0, -120.0, -69.0, 0.0, 60.0, 42.0, -21.0, 19.0, 83.0, -63.0, -18.0, 65.0, -10.0, 149.0, -117.0, -197.0], "policy_predator_policy_reward": [20.0, 153.0, 41.0, 47.0, 21.0, 27.0, 31.0, 0.0, 3.0, 0.0, 0.0, 120.0, 40.0, 35.0, 17.0, 74.0, 177.0, 163.0, 11.0, 156.0, 8.0, 8.0, 19.0, 7.0, 56.0, 60.0, 124.0, 82.0, 167.0, 20.0, 59.0, 57.0, 150.0, 6.0, 2.0, 26.0, 88.0, 83.0, 0.0, 125.0, 4.0, 104.0, 104.0, 94.0, 145.0, 179.0, 5.0, 11.0, 121.0, 7.0, 0.0, 12.0, 1.0, 0.0, 156.0, 12.0, 0.0, 0.0, 141.0, 144.0, 1.0, 21.0, 0.0, 116.0, 5.0, 0.0, 11.0, 0.0, 0.0, 0.0, 186.0, 178.0, 92.0, 0.0, 0.0, 52.0, 3.0, 4.0, 0.0, 0.0, 91.0, 30.0, 141.0, 0.0, 18.0, 3.0, 0.0, 101.0, 7.0, 13.0, 3.0, 32.0, 37.0, 13.0, 1.0, 20.0, 33.0, 165.0, 6.0, 0.0, 9.0, 0.0, 22.0, 16.0, 108.0, 0.0, 177.0, 88.0, 68.0, 129.0, 0.0, 4.0, 18.0, 14.0, 0.0, 6.0, 0.0, 7.0, 1.0, 5.0, 18.0, 22.0, 200.0, 150.0, 197.0, 120.0, 92.0, 185.0, 25.0, 5.0, 51.0, 3.0, 0.0, 0.0, 2.0, 51.0, 94.0, 38.0, 6.0, 48.0, 164.0, 128.0, 2.0, 195.0, 0.0, 45.0, 1.0, 60.0, 6.0, 13.0, 74.0, 115.0, 3.0, 13.0, 55.0, 63.0, 177.0, 0.0, 178.0, 2.0, 28.0, 120.0, 3.0, 161.0, 0.0, 2.0, 54.0, 73.0, 22.0, 49.0, 35.0, 0.0, 0.0, 99.0, 46.0, 7.0, 82.0, 3.0, 0.0, 0.0, 9.0, 66.0, 125.0, 70.0, 1.0, 93.0, 82.0, 6.0, 40.0, 0.0, 2.0, 41.0, 8.0, 61.0, 3.0, 12.0, 12.0, 0.0, 142.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0220104563088257, "mean_inference_ms": 3.191671120893559, "mean_action_processing_ms": 0.4788889439913895, "mean_env_wait_ms": 0.3689595669982487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007009625434875488, "StateBufferConnector_ms": 0.00474393367767334, "ViewRequirementAgentConnector_ms": 0.5087707042694092}, "num_episodes": 18, "episode_return_max": 310.0, "episode_return_min": -499.0, "episode_return_mean": 32.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.64549144835954, "num_env_steps_trained_throughput_per_sec": 215.64549144835954, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 15858.177, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15858.118, "sample_time_ms": 3625.262, "learn_time_ms": 12207.044, "learn_throughput": 327.68, "synch_weights_time_ms": 22.127}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "e1352_00002", "date": "2024-08-13_19-34-14", "timestamp": 1723592054, "time_this_iter_s": 18.58482789993286, "time_total_s": 1945.3540787696838, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d5b1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1945.3540787696838, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 81.82692307692308, "ram_util_percent": 83.2346153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.782902041779309, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 5.538801650143174, "policy_loss": -0.003138661153722929, "vf_loss": 5.541205540409795, "vf_explained_var": 0.004354900594741579, "kl": 0.009174265632368447, "entropy": 0.8789932448397237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.6591612583115, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 7.689777052844012, "policy_loss": -0.0011713017666436455, "vf_loss": 7.69094642886409, "vf_explained_var": -0.3924156282944654, "kl": 0.005853342808215345, "entropy": 1.0617011795598994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 310.0, "episode_reward_min": -499.0, "episode_reward_mean": 18.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -37.215, "predator_policy": 46.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [216.0, -48.0, 1.0, 116.0, -183.0, 0.0, -3.0, 11.0, -3.0, 13.0, -1.0, 132.0, -181.0, -17.0, 36.0, 121.0, 2.0, -3.0, -29.0, 94.0, -24.0, 25.0, 120.0, 221.0, 121.0, 17.0, 123.0, 20.0, 85.0, -13.0, -27.0, 9.0, 125.0, 90.0, 22.0, 310.0, 155.0, 131.0, -273.0, -308.0, -396.0, 4.0, 25.0, 244.0, 5.0, -42.0, 13.0, -71.0, -499.0, 154.0, 99.0, 120.0, -38.0, 144.0, 28.0, -154.0, -177.0, -14.0, -49.0, 172.0, 81.0, 99.0, 32.0, -73.0, 23.0, 131.0, 48.0, 37.0, -100.0, 94.0, 19.0, 142.0, 41.0, 89.0, 62.0, 151.0, -114.0, -40.0, -14.0, -156.0, 90.0, 79.0, 40.0, -154.0, 127.0, -36.0, -85.0, 60.0, 120.0, -26.0, 97.0, -64.0, 58.0, -153.0, 245.0, 208.0, 18.0, 208.0, -216.0, -89.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [107.0, 93.0, -79.0, -97.0, 0.0, -11.0, 0.0, 115.0, -178.0, -173.0, 0.0, 0.0, -68.0, -220.0, 0.0, -11.0, -167.0, 48.0, 0.0, 8.0, -12.0, 0.0, 0.0, 132.0, -259.0, -286.0, -74.0, -35.0, -17.0, 1.0, 59.0, 55.0, 0.0, 2.0, -64.0, -60.0, -217.0, 47.0, 0.0, 73.0, -135.0, 10.0, -13.0, 18.0, 55.0, 30.0, 79.0, 92.0, 0.0, 100.0, 139.0, -320.0, 0.0, 117.0, 0.0, 11.0, -8.0, 55.0, -113.0, -8.0, -383.0, 91.0, -244.0, 56.0, 121.0, 0.0, 58.0, 0.0, 0.0, 16.0, 133.0, 170.0, 149.0, 0.0, 115.0, -24.0, -385.0, -238.0, -234.0, -391.0, -354.0, -319.0, -26.0, 0.0, -23.0, -6.0, 90.0, 154.0, -60.0, 12.0, -165.0, -9.0, 44.0, -85.0, -67.0, -296.0, -355.0, -341.0, 113.0, -4.0, -2.0, 40.0, 17.0, 84.0, -227.0, 0.0, 0.0, 128.0, 0.0, -90.0, 0.0, -331.0, -46.0, -311.0, -25.0, -137.0, -298.0, 85.0, 170.0, 0.0, -82.0, 36.0, -3.0, 31.0, 29.0, -32.0, -120.0, -52.0, 0.0, -30.0, 10.0, 36.0, 48.0, 0.0, -35.0, -3.0, -191.0, -104.0, 120.0, -120.0, -69.0, 0.0, 60.0, 42.0, -21.0, 19.0, 83.0, -63.0, -18.0, 65.0, -10.0, 149.0, -117.0, -197.0, -317.0, 3.0, 0.0, -78.0, -185.0, -126.0, 66.0, -67.0, 7.0, 21.0, -18.0, 0.0, -180.0, -152.0, 45.0, 5.0, -180.0, -46.0, 0.0, -196.0, -38.0, 50.0, 88.0, 28.0, -20.0, -18.0, 94.0, 0.0, -376.0, -13.0, 28.0, -55.0, -118.0, -328.0, 147.0, 74.0, 24.0, 184.0, -2.0, 19.0, 126.0, 73.0, -369.0, -57.0, -238.0, 0.0], "policy_predator_policy_reward": [5.0, 11.0, 121.0, 7.0, 0.0, 12.0, 1.0, 0.0, 156.0, 12.0, 0.0, 0.0, 141.0, 144.0, 1.0, 21.0, 0.0, 116.0, 5.0, 0.0, 11.0, 0.0, 0.0, 0.0, 186.0, 178.0, 92.0, 0.0, 0.0, 52.0, 3.0, 4.0, 0.0, 0.0, 91.0, 30.0, 141.0, 0.0, 18.0, 3.0, 0.0, 101.0, 7.0, 13.0, 3.0, 32.0, 37.0, 13.0, 1.0, 20.0, 33.0, 165.0, 6.0, 0.0, 9.0, 0.0, 22.0, 16.0, 108.0, 0.0, 177.0, 88.0, 68.0, 129.0, 0.0, 4.0, 18.0, 14.0, 0.0, 6.0, 0.0, 7.0, 1.0, 5.0, 18.0, 22.0, 200.0, 150.0, 197.0, 120.0, 92.0, 185.0, 25.0, 5.0, 51.0, 3.0, 0.0, 0.0, 2.0, 51.0, 94.0, 38.0, 6.0, 48.0, 164.0, 128.0, 2.0, 195.0, 0.0, 45.0, 1.0, 60.0, 6.0, 13.0, 74.0, 115.0, 3.0, 13.0, 55.0, 63.0, 177.0, 0.0, 178.0, 2.0, 28.0, 120.0, 3.0, 161.0, 0.0, 2.0, 54.0, 73.0, 22.0, 49.0, 35.0, 0.0, 0.0, 99.0, 46.0, 7.0, 82.0, 3.0, 0.0, 0.0, 9.0, 66.0, 125.0, 70.0, 1.0, 93.0, 82.0, 6.0, 40.0, 0.0, 2.0, 41.0, 8.0, 61.0, 3.0, 12.0, 12.0, 0.0, 142.0, 58.0, 135.0, 139.0, 4.0, 60.0, 62.0, 93.0, 75.0, 16.0, 44.0, 7.0, 0.0, 58.0, 100.0, 78.0, 8.0, 69.0, 87.0, 103.0, 106.0, 5.0, 0.0, 48.0, 1.0, 3.0, 10.0, 2.0, 1.0, 2.0, 187.0, 138.0, 80.0, 5.0, 170.0, 123.0, 0.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 189.0, 21.0, 142.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0408490561602326, "mean_inference_ms": 3.2561608331219185, "mean_action_processing_ms": 0.4851781107249185, "mean_env_wait_ms": 0.3752560379871973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010454177856445312, "StateBufferConnector_ms": 0.004991888999938965, "ViewRequirementAgentConnector_ms": 0.5078274011611938}, "num_episodes": 23, "episode_return_max": 310.0, "episode_return_min": -499.0, "episode_return_mean": 18.5, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.61731119535585, "num_env_steps_trained_throughput_per_sec": 327.61731119535585, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 15716.563, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15716.504, "sample_time_ms": 3549.017, "learn_time_ms": 12140.668, "learn_throughput": 329.471, "synch_weights_time_ms": 22.5}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "e1352_00002", "date": "2024-08-13_19-34-26", "timestamp": 1723592066, "time_this_iter_s": 12.266775846481323, "time_total_s": 1957.6208546161652, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d41040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1957.6208546161652, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 62.10000000000001, "ram_util_percent": 80.07222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.839578068216957, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.764849839387117, "policy_loss": -0.002444676295533855, "vf_loss": 6.766452652310568, "vf_explained_var": -0.0016054287789359926, "kl": 0.010511345334492588, "entropy": 0.8317220965075114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.11215416637678, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.5110445749192, "policy_loss": -0.004011462852802305, "vf_loss": 8.51504992934131, "vf_explained_var": -0.2702022566997185, "kl": 0.018559024352886207, "entropy": 0.8671183884774566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -499.0, "episode_reward_mean": 13.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -47.185, "predator_policy": 53.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.0, 94.0, -24.0, 25.0, 120.0, 221.0, 121.0, 17.0, 123.0, 20.0, 85.0, -13.0, -27.0, 9.0, 125.0, 90.0, 22.0, 310.0, 155.0, 131.0, -273.0, -308.0, -396.0, 4.0, 25.0, 244.0, 5.0, -42.0, 13.0, -71.0, -499.0, 154.0, 99.0, 120.0, -38.0, 144.0, 28.0, -154.0, -177.0, -14.0, -49.0, 172.0, 81.0, 99.0, 32.0, -73.0, 23.0, 131.0, 48.0, 37.0, -100.0, 94.0, 19.0, 142.0, 41.0, 89.0, 62.0, 151.0, -114.0, -40.0, -14.0, -156.0, 90.0, 79.0, 40.0, -154.0, 127.0, -36.0, -85.0, 60.0, 120.0, -26.0, 97.0, -64.0, 58.0, -153.0, 245.0, 208.0, 18.0, 208.0, -216.0, -89.0, -379.0, 79.0, 50.0, 233.0, 135.0, 104.0, 311.0, -227.0, -143.0, -398.0, 33.0, 292.0, 94.0, -158.0, -183.0, 1.0, -282.0, 142.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-217.0, 47.0, 0.0, 73.0, -135.0, 10.0, -13.0, 18.0, 55.0, 30.0, 79.0, 92.0, 0.0, 100.0, 139.0, -320.0, 0.0, 117.0, 0.0, 11.0, -8.0, 55.0, -113.0, -8.0, -383.0, 91.0, -244.0, 56.0, 121.0, 0.0, 58.0, 0.0, 0.0, 16.0, 133.0, 170.0, 149.0, 0.0, 115.0, -24.0, -385.0, -238.0, -234.0, -391.0, -354.0, -319.0, -26.0, 0.0, -23.0, -6.0, 90.0, 154.0, -60.0, 12.0, -165.0, -9.0, 44.0, -85.0, -67.0, -296.0, -355.0, -341.0, 113.0, -4.0, -2.0, 40.0, 17.0, 84.0, -227.0, 0.0, 0.0, 128.0, 0.0, -90.0, 0.0, -331.0, -46.0, -311.0, -25.0, -137.0, -298.0, 85.0, 170.0, 0.0, -82.0, 36.0, -3.0, 31.0, 29.0, -32.0, -120.0, -52.0, 0.0, -30.0, 10.0, 36.0, 48.0, 0.0, -35.0, -3.0, -191.0, -104.0, 120.0, -120.0, -69.0, 0.0, 60.0, 42.0, -21.0, 19.0, 83.0, -63.0, -18.0, 65.0, -10.0, 149.0, -117.0, -197.0, -317.0, 3.0, 0.0, -78.0, -185.0, -126.0, 66.0, -67.0, 7.0, 21.0, -18.0, 0.0, -180.0, -152.0, 45.0, 5.0, -180.0, -46.0, 0.0, -196.0, -38.0, 50.0, 88.0, 28.0, -20.0, -18.0, 94.0, 0.0, -376.0, -13.0, 28.0, -55.0, -118.0, -328.0, 147.0, 74.0, 24.0, 184.0, -2.0, 19.0, 126.0, 73.0, -369.0, -57.0, -238.0, 0.0, -379.0, -388.0, 79.0, -75.0, 41.0, -79.0, 47.0, 179.0, -81.0, 171.0, -132.0, 129.0, 187.0, 124.0, -201.0, -370.0, -331.0, -4.0, -382.0, -373.0, 75.0, -265.0, 100.0, 188.0, 66.0, 0.0, -35.0, -308.0, -347.0, -132.0, -116.0, -5.0, -322.0, -305.0, 49.0, 10.0], "policy_predator_policy_reward": [141.0, 0.0, 18.0, 3.0, 0.0, 101.0, 7.0, 13.0, 3.0, 32.0, 37.0, 13.0, 1.0, 20.0, 33.0, 165.0, 6.0, 0.0, 9.0, 0.0, 22.0, 16.0, 108.0, 0.0, 177.0, 88.0, 68.0, 129.0, 0.0, 4.0, 18.0, 14.0, 0.0, 6.0, 0.0, 7.0, 1.0, 5.0, 18.0, 22.0, 200.0, 150.0, 197.0, 120.0, 92.0, 185.0, 25.0, 5.0, 51.0, 3.0, 0.0, 0.0, 2.0, 51.0, 94.0, 38.0, 6.0, 48.0, 164.0, 128.0, 2.0, 195.0, 0.0, 45.0, 1.0, 60.0, 6.0, 13.0, 74.0, 115.0, 3.0, 13.0, 55.0, 63.0, 177.0, 0.0, 178.0, 2.0, 28.0, 120.0, 3.0, 161.0, 0.0, 2.0, 54.0, 73.0, 22.0, 49.0, 35.0, 0.0, 0.0, 99.0, 46.0, 7.0, 82.0, 3.0, 0.0, 0.0, 9.0, 66.0, 125.0, 70.0, 1.0, 93.0, 82.0, 6.0, 40.0, 0.0, 2.0, 41.0, 8.0, 61.0, 3.0, 12.0, 12.0, 0.0, 142.0, 58.0, 135.0, 139.0, 4.0, 60.0, 62.0, 93.0, 75.0, 16.0, 44.0, 7.0, 0.0, 58.0, 100.0, 78.0, 8.0, 69.0, 87.0, 103.0, 106.0, 5.0, 0.0, 48.0, 1.0, 3.0, 10.0, 2.0, 1.0, 2.0, 187.0, 138.0, 80.0, 5.0, 170.0, 123.0, 0.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 189.0, 21.0, 142.0, 7.0, 199.0, 189.0, 53.0, 22.0, 66.0, 22.0, 7.0, 0.0, 0.0, 45.0, 103.0, 4.0, 0.0, 0.0, 184.0, 160.0, 174.0, 18.0, 163.0, 194.0, 112.0, 111.0, 4.0, 0.0, 12.0, 16.0, 163.0, 22.0, 171.0, 125.0, 1.0, 121.0, 193.0, 152.0, 80.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0482939198837709, "mean_inference_ms": 3.284303253365624, "mean_action_processing_ms": 0.487661115512191, "mean_env_wait_ms": 0.3780695347622154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01074671745300293, "StateBufferConnector_ms": 0.004942059516906738, "ViewRequirementAgentConnector_ms": 0.4176034927368164}, "num_episodes": 18, "episode_return_max": 311.0, "episode_return_min": -499.0, "episode_return_mean": 13.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.96364726276, "num_env_steps_trained_throughput_per_sec": 348.96364726276, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 15595.941, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15595.882, "sample_time_ms": 3495.277, "learn_time_ms": 12074.267, "learn_throughput": 331.283, "synch_weights_time_ms": 22.294}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "e1352_00002", "date": "2024-08-13_19-34-38", "timestamp": 1723592078, "time_this_iter_s": 11.516019105911255, "time_total_s": 1969.1368737220764, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d139d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1969.1368737220764, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 55.9625, "ram_util_percent": 80.21249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.447568840119574, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.83657527196975, "policy_loss": -0.00018079129722777497, "vf_loss": 6.836237494907682, "vf_explained_var": 0.009213383834828776, "kl": 0.006474704944005959, "entropy": 0.8765533270974638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.42950990247348, "cur_kl_coeff": 0.00032958984375, "cur_lr": 0.00010000000000000003, "total_loss": 8.486524703262974, "policy_loss": 0.00017423321192384396, "vf_loss": 8.486348850764925, "vf_explained_var": -0.2389242481302332, "kl": 0.004866485501376449, "entropy": 0.8566500454668015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -499.0, "episode_reward_mean": 5.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -58.69, "predator_policy": 61.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0, 131.0, -273.0, -308.0, -396.0, 4.0, 25.0, 244.0, 5.0, -42.0, 13.0, -71.0, -499.0, 154.0, 99.0, 120.0, -38.0, 144.0, 28.0, -154.0, -177.0, -14.0, -49.0, 172.0, 81.0, 99.0, 32.0, -73.0, 23.0, 131.0, 48.0, 37.0, -100.0, 94.0, 19.0, 142.0, 41.0, 89.0, 62.0, 151.0, -114.0, -40.0, -14.0, -156.0, 90.0, 79.0, 40.0, -154.0, 127.0, -36.0, -85.0, 60.0, 120.0, -26.0, 97.0, -64.0, 58.0, -153.0, 245.0, 208.0, 18.0, 208.0, -216.0, -89.0, -379.0, 79.0, 50.0, 233.0, 135.0, 104.0, 311.0, -227.0, -143.0, -398.0, 33.0, 292.0, 94.0, -158.0, -183.0, 1.0, -282.0, 142.0, -126.0, 45.0, 155.0, 283.0, 93.0, 36.0, -183.0, 284.0, -81.0, -139.0, 66.0, -156.0, 153.0, 251.0, -151.0, 52.0, -69.0, -41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [149.0, 0.0, 115.0, -24.0, -385.0, -238.0, -234.0, -391.0, -354.0, -319.0, -26.0, 0.0, -23.0, -6.0, 90.0, 154.0, -60.0, 12.0, -165.0, -9.0, 44.0, -85.0, -67.0, -296.0, -355.0, -341.0, 113.0, -4.0, -2.0, 40.0, 17.0, 84.0, -227.0, 0.0, 0.0, 128.0, 0.0, -90.0, 0.0, -331.0, -46.0, -311.0, -25.0, -137.0, -298.0, 85.0, 170.0, 0.0, -82.0, 36.0, -3.0, 31.0, 29.0, -32.0, -120.0, -52.0, 0.0, -30.0, 10.0, 36.0, 48.0, 0.0, -35.0, -3.0, -191.0, -104.0, 120.0, -120.0, -69.0, 0.0, 60.0, 42.0, -21.0, 19.0, 83.0, -63.0, -18.0, 65.0, -10.0, 149.0, -117.0, -197.0, -317.0, 3.0, 0.0, -78.0, -185.0, -126.0, 66.0, -67.0, 7.0, 21.0, -18.0, 0.0, -180.0, -152.0, 45.0, 5.0, -180.0, -46.0, 0.0, -196.0, -38.0, 50.0, 88.0, 28.0, -20.0, -18.0, 94.0, 0.0, -376.0, -13.0, 28.0, -55.0, -118.0, -328.0, 147.0, 74.0, 24.0, 184.0, -2.0, 19.0, 126.0, 73.0, -369.0, -57.0, -238.0, 0.0, -379.0, -388.0, 79.0, -75.0, 41.0, -79.0, 47.0, 179.0, -81.0, 171.0, -132.0, 129.0, 187.0, 124.0, -201.0, -370.0, -331.0, -4.0, -382.0, -373.0, 75.0, -265.0, 100.0, 188.0, 66.0, 0.0, -35.0, -308.0, -347.0, -132.0, -116.0, -5.0, -322.0, -305.0, 49.0, 10.0, -334.0, -61.0, -158.0, 33.0, -86.0, 134.0, 79.0, 123.0, 92.0, 0.0, -70.0, -51.0, -136.0, -301.0, 138.0, 101.0, -64.0, -294.0, -85.0, -338.0, -94.0, 50.0, 0.0, -352.0, -40.0, 17.0, 122.0, 91.0, -153.0, -193.0, 62.0, -137.0, 0.0, -205.0, -161.0, 0.0], "policy_predator_policy_reward": [1.0, 5.0, 18.0, 22.0, 200.0, 150.0, 197.0, 120.0, 92.0, 185.0, 25.0, 5.0, 51.0, 3.0, 0.0, 0.0, 2.0, 51.0, 94.0, 38.0, 6.0, 48.0, 164.0, 128.0, 2.0, 195.0, 0.0, 45.0, 1.0, 60.0, 6.0, 13.0, 74.0, 115.0, 3.0, 13.0, 55.0, 63.0, 177.0, 0.0, 178.0, 2.0, 28.0, 120.0, 3.0, 161.0, 0.0, 2.0, 54.0, 73.0, 22.0, 49.0, 35.0, 0.0, 0.0, 99.0, 46.0, 7.0, 82.0, 3.0, 0.0, 0.0, 9.0, 66.0, 125.0, 70.0, 1.0, 93.0, 82.0, 6.0, 40.0, 0.0, 2.0, 41.0, 8.0, 61.0, 3.0, 12.0, 12.0, 0.0, 142.0, 58.0, 135.0, 139.0, 4.0, 60.0, 62.0, 93.0, 75.0, 16.0, 44.0, 7.0, 0.0, 58.0, 100.0, 78.0, 8.0, 69.0, 87.0, 103.0, 106.0, 5.0, 0.0, 48.0, 1.0, 3.0, 10.0, 2.0, 1.0, 2.0, 187.0, 138.0, 80.0, 5.0, 170.0, 123.0, 0.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 189.0, 21.0, 142.0, 7.0, 199.0, 189.0, 53.0, 22.0, 66.0, 22.0, 7.0, 0.0, 0.0, 45.0, 103.0, 4.0, 0.0, 0.0, 184.0, 160.0, 174.0, 18.0, 163.0, 194.0, 112.0, 111.0, 4.0, 0.0, 12.0, 16.0, 163.0, 22.0, 171.0, 125.0, 1.0, 121.0, 193.0, 152.0, 80.0, 3.0, 109.0, 160.0, 82.0, 88.0, 53.0, 54.0, 38.0, 43.0, 1.0, 0.0, 110.0, 47.0, 113.0, 141.0, 2.0, 43.0, 125.0, 152.0, 180.0, 104.0, 86.0, 24.0, 92.0, 104.0, 93.0, 83.0, 38.0, 0.0, 125.0, 70.0, 71.0, 56.0, 96.0, 40.0, 0.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.052161592924149, "mean_inference_ms": 3.3010408314982955, "mean_action_processing_ms": 0.48858842204270014, "mean_env_wait_ms": 0.3797702658948103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011760473251342773, "StateBufferConnector_ms": 0.004779934883117676, "ViewRequirementAgentConnector_ms": 0.3515826463699341}, "num_episodes": 18, "episode_return_max": 311.0, "episode_return_min": -499.0, "episode_return_mean": 5.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.3992354292854, "num_env_steps_trained_throughput_per_sec": 313.3992354292854, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 15480.796, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15480.737, "sample_time_ms": 3476.124, "learn_time_ms": 11977.045, "learn_throughput": 333.972, "synch_weights_time_ms": 23.629}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "e1352_00002", "date": "2024-08-13_19-34-51", "timestamp": 1723592091, "time_this_iter_s": 12.822508096694946, "time_total_s": 1981.9593818187714, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1981.9593818187714, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 66.77777777777777, "ram_util_percent": 81.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.52115680092857, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 7.005091045016334, "policy_loss": -0.0019439285285968, "vf_loss": 7.006170145165983, "vf_explained_var": 0.014180260329019456, "kl": 0.010798146189396054, "entropy": 0.9121335661915875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.491153691464632, "cur_kl_coeff": 0.000164794921875, "cur_lr": 0.00010000000000000003, "total_loss": 8.946779158758739, "policy_loss": -0.0016365086029052104, "vf_loss": 8.948413099561419, "vf_explained_var": -0.17631120713299545, "kl": 0.01545077781310134, "entropy": 0.8208837459327052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 311.0, "episode_reward_min": -398.0, "episode_reward_mean": 32.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -388.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -43.905, "predator_policy": 60.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.0, 172.0, 81.0, 99.0, 32.0, -73.0, 23.0, 131.0, 48.0, 37.0, -100.0, 94.0, 19.0, 142.0, 41.0, 89.0, 62.0, 151.0, -114.0, -40.0, -14.0, -156.0, 90.0, 79.0, 40.0, -154.0, 127.0, -36.0, -85.0, 60.0, 120.0, -26.0, 97.0, -64.0, 58.0, -153.0, 245.0, 208.0, 18.0, 208.0, -216.0, -89.0, -379.0, 79.0, 50.0, 233.0, 135.0, 104.0, 311.0, -227.0, -143.0, -398.0, 33.0, 292.0, 94.0, -158.0, -183.0, 1.0, -282.0, 142.0, -126.0, 45.0, 155.0, 283.0, 93.0, 36.0, -183.0, 284.0, -81.0, -139.0, 66.0, -156.0, 153.0, 251.0, -151.0, 52.0, -69.0, -41.0, 215.0, 55.0, -33.0, 27.0, 34.0, 105.0, 225.0, 233.0, 258.0, -20.0, -49.0, -188.0, -117.0, 129.0, 307.0, -41.0, 59.0, 236.0, 231.0, 293.0, -24.0, -69.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-298.0, 85.0, 170.0, 0.0, -82.0, 36.0, -3.0, 31.0, 29.0, -32.0, -120.0, -52.0, 0.0, -30.0, 10.0, 36.0, 48.0, 0.0, -35.0, -3.0, -191.0, -104.0, 120.0, -120.0, -69.0, 0.0, 60.0, 42.0, -21.0, 19.0, 83.0, -63.0, -18.0, 65.0, -10.0, 149.0, -117.0, -197.0, -317.0, 3.0, 0.0, -78.0, -185.0, -126.0, 66.0, -67.0, 7.0, 21.0, -18.0, 0.0, -180.0, -152.0, 45.0, 5.0, -180.0, -46.0, 0.0, -196.0, -38.0, 50.0, 88.0, 28.0, -20.0, -18.0, 94.0, 0.0, -376.0, -13.0, 28.0, -55.0, -118.0, -328.0, 147.0, 74.0, 24.0, 184.0, -2.0, 19.0, 126.0, 73.0, -369.0, -57.0, -238.0, 0.0, -379.0, -388.0, 79.0, -75.0, 41.0, -79.0, 47.0, 179.0, -81.0, 171.0, -132.0, 129.0, 187.0, 124.0, -201.0, -370.0, -331.0, -4.0, -382.0, -373.0, 75.0, -265.0, 100.0, 188.0, 66.0, 0.0, -35.0, -308.0, -347.0, -132.0, -116.0, -5.0, -322.0, -305.0, 49.0, 10.0, -334.0, -61.0, -158.0, 33.0, -86.0, 134.0, 79.0, 123.0, 92.0, 0.0, -70.0, -51.0, -136.0, -301.0, 138.0, 101.0, -64.0, -294.0, -85.0, -338.0, -94.0, 50.0, 0.0, -352.0, -40.0, 17.0, 122.0, 91.0, -153.0, -193.0, 62.0, -137.0, 0.0, -205.0, -161.0, 0.0, 55.0, 46.0, -75.0, 34.0, -346.0, 112.0, -90.0, 38.0, -243.0, 124.0, -216.0, 163.0, 126.0, 74.0, -75.0, 193.0, 139.0, 117.0, 20.0, -227.0, -119.0, -73.0, -93.0, -295.0, -235.0, -75.0, 23.0, 39.0, 188.0, 116.0, -208.0, 31.0, 148.0, -247.0, 104.0, 108.0, 176.0, 55.0, 175.0, 63.0, -125.0, 0.0, -388.0, 15.0], "policy_predator_policy_reward": [3.0, 161.0, 0.0, 2.0, 54.0, 73.0, 22.0, 49.0, 35.0, 0.0, 0.0, 99.0, 46.0, 7.0, 82.0, 3.0, 0.0, 0.0, 9.0, 66.0, 125.0, 70.0, 1.0, 93.0, 82.0, 6.0, 40.0, 0.0, 2.0, 41.0, 8.0, 61.0, 3.0, 12.0, 12.0, 0.0, 142.0, 58.0, 135.0, 139.0, 4.0, 60.0, 62.0, 93.0, 75.0, 16.0, 44.0, 7.0, 0.0, 58.0, 100.0, 78.0, 8.0, 69.0, 87.0, 103.0, 106.0, 5.0, 0.0, 48.0, 1.0, 3.0, 10.0, 2.0, 1.0, 2.0, 187.0, 138.0, 80.0, 5.0, 170.0, 123.0, 0.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 189.0, 21.0, 142.0, 7.0, 199.0, 189.0, 53.0, 22.0, 66.0, 22.0, 7.0, 0.0, 0.0, 45.0, 103.0, 4.0, 0.0, 0.0, 184.0, 160.0, 174.0, 18.0, 163.0, 194.0, 112.0, 111.0, 4.0, 0.0, 12.0, 16.0, 163.0, 22.0, 171.0, 125.0, 1.0, 121.0, 193.0, 152.0, 80.0, 3.0, 109.0, 160.0, 82.0, 88.0, 53.0, 54.0, 38.0, 43.0, 1.0, 0.0, 110.0, 47.0, 113.0, 141.0, 2.0, 43.0, 125.0, 152.0, 180.0, 104.0, 86.0, 24.0, 92.0, 104.0, 93.0, 83.0, 38.0, 0.0, 125.0, 70.0, 71.0, 56.0, 96.0, 40.0, 0.0, 120.0, 63.0, 51.0, 0.0, 96.0, 171.0, 30.0, 1.0, 78.0, 142.0, 11.0, 45.0, 113.0, 12.0, 13.0, 72.0, 43.0, 2.0, 0.0, 116.0, 71.0, 80.0, 63.0, 74.0, 126.0, 126.0, 67.0, 2.0, 65.0, 1.0, 2.0, 136.0, 0.0, 14.0, 144.0, 21.0, 3.0, 0.0, 0.0, 25.0, 30.0, 11.0, 90.0, 176.0, 128.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0542893473802935, "mean_inference_ms": 3.3098796476043812, "mean_action_processing_ms": 0.48807396431560696, "mean_env_wait_ms": 0.38068686986199635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014838576316833496, "StateBufferConnector_ms": 0.004595279693603516, "ViewRequirementAgentConnector_ms": 0.20361673831939697}, "num_episodes": 22, "episode_return_max": 311.0, "episode_return_min": -398.0, "episode_return_mean": 32.44, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.89006988018565, "num_env_steps_trained_throughput_per_sec": 263.89006988018565, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 15847.477, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15847.417, "sample_time_ms": 3612.718, "learn_time_ms": 12205.133, "learn_throughput": 327.731, "synch_weights_time_ms": 25.299}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "e1352_00002", "date": "2024-08-13_19-35-06", "timestamp": 1723592106, "time_this_iter_s": 15.22286581993103, "time_total_s": 1997.1822476387024, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cdcca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1997.1822476387024, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 72.92727272727274, "ram_util_percent": 82.50909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.537057673465953, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 6.459138711293538, "policy_loss": 0.00015403097766456466, "vf_loss": 6.45856482667267, "vf_explained_var": 0.01635111478901414, "kl": 0.005242254095498528, "entropy": 0.8808227307897396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.50595709410294, "cur_kl_coeff": 0.000164794921875, "cur_lr": 0.00010000000000000003, "total_loss": 8.809454216023601, "policy_loss": -0.0026689313693346564, "vf_loss": 8.812120482782838, "vf_explained_var": -0.2248809813822388, "kl": 0.01638860603946053, "entropy": 0.844210395075026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 321.0, "episode_reward_min": -421.0, "episode_reward_mean": 29.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -388.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -54.035, "predator_policy": 68.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.0, 40.0, -154.0, 127.0, -36.0, -85.0, 60.0, 120.0, -26.0, 97.0, -64.0, 58.0, -153.0, 245.0, 208.0, 18.0, 208.0, -216.0, -89.0, -379.0, 79.0, 50.0, 233.0, 135.0, 104.0, 311.0, -227.0, -143.0, -398.0, 33.0, 292.0, 94.0, -158.0, -183.0, 1.0, -282.0, 142.0, -126.0, 45.0, 155.0, 283.0, 93.0, 36.0, -183.0, 284.0, -81.0, -139.0, 66.0, -156.0, 153.0, 251.0, -151.0, 52.0, -69.0, -41.0, 215.0, 55.0, -33.0, 27.0, 34.0, 105.0, 225.0, 233.0, 258.0, -20.0, -49.0, -188.0, -117.0, 129.0, 307.0, -41.0, 59.0, 236.0, 231.0, 293.0, -24.0, -69.0, -313.0, -30.0, 36.0, 260.0, 321.0, 127.0, 93.0, -421.0, 111.0, 35.0, 3.0, 144.0, -27.0, 288.0, -417.0, -97.0, -9.0, 21.0, 119.0, 14.0, 274.0, -241.0, 185.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [7.0, 21.0, -18.0, 0.0, -180.0, -152.0, 45.0, 5.0, -180.0, -46.0, 0.0, -196.0, -38.0, 50.0, 88.0, 28.0, -20.0, -18.0, 94.0, 0.0, -376.0, -13.0, 28.0, -55.0, -118.0, -328.0, 147.0, 74.0, 24.0, 184.0, -2.0, 19.0, 126.0, 73.0, -369.0, -57.0, -238.0, 0.0, -379.0, -388.0, 79.0, -75.0, 41.0, -79.0, 47.0, 179.0, -81.0, 171.0, -132.0, 129.0, 187.0, 124.0, -201.0, -370.0, -331.0, -4.0, -382.0, -373.0, 75.0, -265.0, 100.0, 188.0, 66.0, 0.0, -35.0, -308.0, -347.0, -132.0, -116.0, -5.0, -322.0, -305.0, 49.0, 10.0, -334.0, -61.0, -158.0, 33.0, -86.0, 134.0, 79.0, 123.0, 92.0, 0.0, -70.0, -51.0, -136.0, -301.0, 138.0, 101.0, -64.0, -294.0, -85.0, -338.0, -94.0, 50.0, 0.0, -352.0, -40.0, 17.0, 122.0, 91.0, -153.0, -193.0, 62.0, -137.0, 0.0, -205.0, -161.0, 0.0, 55.0, 46.0, -75.0, 34.0, -346.0, 112.0, -90.0, 38.0, -243.0, 124.0, -216.0, 163.0, 126.0, 74.0, -75.0, 193.0, 139.0, 117.0, 20.0, -227.0, -119.0, -73.0, -93.0, -295.0, -235.0, -75.0, 23.0, 39.0, 188.0, 116.0, -208.0, 31.0, 148.0, -247.0, 104.0, 108.0, 176.0, 55.0, 175.0, 63.0, -125.0, 0.0, -388.0, 15.0, -290.0, -280.0, -358.0, 0.0, -28.0, -24.0, 56.0, 160.0, 137.0, 167.0, 83.0, 0.0, -54.0, 87.0, -352.0, -289.0, -10.0, 26.0, 43.0, -112.0, -320.0, 0.0, -362.0, 134.0, -352.0, 119.0, 150.0, 126.0, -291.0, -383.0, -58.0, -214.0, -194.0, 54.0, -2.0, -208.0, 9.0, 68.0, -346.0, 181.0, -34.0, 171.0, -259.0, -354.0, -86.0, 177.0], "policy_predator_policy_reward": [44.0, 7.0, 0.0, 58.0, 100.0, 78.0, 8.0, 69.0, 87.0, 103.0, 106.0, 5.0, 0.0, 48.0, 1.0, 3.0, 10.0, 2.0, 1.0, 2.0, 187.0, 138.0, 80.0, 5.0, 170.0, 123.0, 0.0, 24.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 189.0, 21.0, 142.0, 7.0, 199.0, 189.0, 53.0, 22.0, 66.0, 22.0, 7.0, 0.0, 0.0, 45.0, 103.0, 4.0, 0.0, 0.0, 184.0, 160.0, 174.0, 18.0, 163.0, 194.0, 112.0, 111.0, 4.0, 0.0, 12.0, 16.0, 163.0, 22.0, 171.0, 125.0, 1.0, 121.0, 193.0, 152.0, 80.0, 3.0, 109.0, 160.0, 82.0, 88.0, 53.0, 54.0, 38.0, 43.0, 1.0, 0.0, 110.0, 47.0, 113.0, 141.0, 2.0, 43.0, 125.0, 152.0, 180.0, 104.0, 86.0, 24.0, 92.0, 104.0, 93.0, 83.0, 38.0, 0.0, 125.0, 70.0, 71.0, 56.0, 96.0, 40.0, 0.0, 120.0, 63.0, 51.0, 0.0, 96.0, 171.0, 30.0, 1.0, 78.0, 142.0, 11.0, 45.0, 113.0, 12.0, 13.0, 72.0, 43.0, 2.0, 0.0, 116.0, 71.0, 80.0, 63.0, 74.0, 126.0, 126.0, 67.0, 2.0, 65.0, 1.0, 2.0, 136.0, 0.0, 14.0, 144.0, 21.0, 3.0, 0.0, 0.0, 25.0, 30.0, 11.0, 90.0, 176.0, 128.0, 85.0, 172.0, 185.0, 143.0, 7.0, 81.0, 12.0, 32.0, 6.0, 11.0, 26.0, 18.0, 27.0, 33.0, 30.0, 190.0, 0.0, 95.0, 0.0, 104.0, 171.0, 152.0, 186.0, 186.0, 184.0, 22.0, 2.0, 10.0, 65.0, 192.0, 127.0, 48.0, 123.0, 8.0, 117.0, 114.0, 42.0, 0.0, 6.0, 173.0, 78.0, 59.0, 182.0, 190.0, 8.0, 86.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0521892393293095, "mean_inference_ms": 3.3128149744707462, "mean_action_processing_ms": 0.4871004982440478, "mean_env_wait_ms": 0.3806596283614945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01746344566345215, "StateBufferConnector_ms": 0.004365205764770508, "ViewRequirementAgentConnector_ms": 0.20442044734954834}, "num_episodes": 23, "episode_return_max": 321.0, "episode_return_min": -421.0, "episode_return_mean": 29.55, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.32271898523976, "num_env_steps_trained_throughput_per_sec": 221.32271898523976, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 16400.289, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16400.23, "sample_time_ms": 3693.564, "learn_time_ms": 12677.143, "learn_throughput": 315.529, "synch_weights_time_ms": 25.253}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "e1352_00002", "date": "2024-08-13_19-35-24", "timestamp": 1723592124, "time_this_iter_s": 18.176164865493774, "time_total_s": 2015.3584125041962, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d988b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2015.3584125041962, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 91.88400000000001, "ram_util_percent": 83.836}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5484660377893498, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 0.00010000000000000003, "total_loss": 4.872006337100236, "policy_loss": -0.0022221876132159086, "vf_loss": 4.873829062653597, "vf_explained_var": 0.004205175682350441, "kl": 0.0049878987036498495, "entropy": 0.8925758627672044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.90856400157409, "cur_kl_coeff": 0.000164794921875, "cur_lr": 0.00010000000000000003, "total_loss": 8.964502554091196, "policy_loss": -0.0002342336182852113, "vf_loss": 8.964734583052378, "vf_explained_var": -0.10795491725679428, "kl": 0.013445204761771471, "entropy": 0.8152499233919477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -421.0, "episode_reward_mean": 34.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -53.86, "predator_policy": 71.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.0, -379.0, 79.0, 50.0, 233.0, 135.0, 104.0, 311.0, -227.0, -143.0, -398.0, 33.0, 292.0, 94.0, -158.0, -183.0, 1.0, -282.0, 142.0, -126.0, 45.0, 155.0, 283.0, 93.0, 36.0, -183.0, 284.0, -81.0, -139.0, 66.0, -156.0, 153.0, 251.0, -151.0, 52.0, -69.0, -41.0, 215.0, 55.0, -33.0, 27.0, 34.0, 105.0, 225.0, 233.0, 258.0, -20.0, -49.0, -188.0, -117.0, 129.0, 307.0, -41.0, 59.0, 236.0, 231.0, 293.0, -24.0, -69.0, -313.0, -30.0, 36.0, 260.0, 321.0, 127.0, 93.0, -421.0, 111.0, 35.0, 3.0, 144.0, -27.0, 288.0, -417.0, -97.0, -9.0, 21.0, 119.0, 14.0, 274.0, -241.0, 185.0, 142.0, -152.0, 28.0, -345.0, -153.0, 152.0, 36.0, -2.0, 92.0, 215.0, -167.0, 114.0, 221.0, -169.0, 348.0, -11.0, 311.0, 385.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-238.0, 0.0, -379.0, -388.0, 79.0, -75.0, 41.0, -79.0, 47.0, 179.0, -81.0, 171.0, -132.0, 129.0, 187.0, 124.0, -201.0, -370.0, -331.0, -4.0, -382.0, -373.0, 75.0, -265.0, 100.0, 188.0, 66.0, 0.0, -35.0, -308.0, -347.0, -132.0, -116.0, -5.0, -322.0, -305.0, 49.0, 10.0, -334.0, -61.0, -158.0, 33.0, -86.0, 134.0, 79.0, 123.0, 92.0, 0.0, -70.0, -51.0, -136.0, -301.0, 138.0, 101.0, -64.0, -294.0, -85.0, -338.0, -94.0, 50.0, 0.0, -352.0, -40.0, 17.0, 122.0, 91.0, -153.0, -193.0, 62.0, -137.0, 0.0, -205.0, -161.0, 0.0, 55.0, 46.0, -75.0, 34.0, -346.0, 112.0, -90.0, 38.0, -243.0, 124.0, -216.0, 163.0, 126.0, 74.0, -75.0, 193.0, 139.0, 117.0, 20.0, -227.0, -119.0, -73.0, -93.0, -295.0, -235.0, -75.0, 23.0, 39.0, 188.0, 116.0, -208.0, 31.0, 148.0, -247.0, 104.0, 108.0, 176.0, 55.0, 175.0, 63.0, -125.0, 0.0, -388.0, 15.0, -290.0, -280.0, -358.0, 0.0, -28.0, -24.0, 56.0, 160.0, 137.0, 167.0, 83.0, 0.0, -54.0, 87.0, -352.0, -289.0, -10.0, 26.0, 43.0, -112.0, -320.0, 0.0, -362.0, 134.0, -352.0, 119.0, 150.0, 126.0, -291.0, -383.0, -58.0, -214.0, -194.0, 54.0, -2.0, -208.0, 9.0, 68.0, -346.0, 181.0, -34.0, 171.0, -259.0, -354.0, -86.0, 177.0, 73.0, 51.0, -160.0, -363.0, -154.0, 65.0, -391.0, -345.0, -202.0, -120.0, 53.0, 32.0, 110.0, -241.0, -160.0, -16.0, 132.0, -84.0, 17.0, 185.0, -325.0, -35.0, -134.0, 179.0, 109.0, 78.0, -148.0, -188.0, 190.0, 145.0, -168.0, 13.0, 188.0, 114.0, 191.0, 191.0], "policy_predator_policy_reward": [142.0, 7.0, 199.0, 189.0, 53.0, 22.0, 66.0, 22.0, 7.0, 0.0, 0.0, 45.0, 103.0, 4.0, 0.0, 0.0, 184.0, 160.0, 174.0, 18.0, 163.0, 194.0, 112.0, 111.0, 4.0, 0.0, 12.0, 16.0, 163.0, 22.0, 171.0, 125.0, 1.0, 121.0, 193.0, 152.0, 80.0, 3.0, 109.0, 160.0, 82.0, 88.0, 53.0, 54.0, 38.0, 43.0, 1.0, 0.0, 110.0, 47.0, 113.0, 141.0, 2.0, 43.0, 125.0, 152.0, 180.0, 104.0, 86.0, 24.0, 92.0, 104.0, 93.0, 83.0, 38.0, 0.0, 125.0, 70.0, 71.0, 56.0, 96.0, 40.0, 0.0, 120.0, 63.0, 51.0, 0.0, 96.0, 171.0, 30.0, 1.0, 78.0, 142.0, 11.0, 45.0, 113.0, 12.0, 13.0, 72.0, 43.0, 2.0, 0.0, 116.0, 71.0, 80.0, 63.0, 74.0, 126.0, 126.0, 67.0, 2.0, 65.0, 1.0, 2.0, 136.0, 0.0, 14.0, 144.0, 21.0, 3.0, 0.0, 0.0, 25.0, 30.0, 11.0, 90.0, 176.0, 128.0, 85.0, 172.0, 185.0, 143.0, 7.0, 81.0, 12.0, 32.0, 6.0, 11.0, 26.0, 18.0, 27.0, 33.0, 30.0, 190.0, 0.0, 95.0, 0.0, 104.0, 171.0, 152.0, 186.0, 186.0, 184.0, 22.0, 2.0, 10.0, 65.0, 192.0, 127.0, 48.0, 123.0, 8.0, 117.0, 114.0, 42.0, 0.0, 6.0, 173.0, 78.0, 59.0, 182.0, 190.0, 8.0, 86.0, 0.0, 18.0, 187.0, 184.0, 109.0, 8.0, 193.0, 198.0, 159.0, 10.0, 24.0, 43.0, 167.0, 0.0, 174.0, 0.0, 44.0, 0.0, 0.0, 13.0, 176.0, 17.0, 1.0, 68.0, 29.0, 5.0, 155.0, 12.0, 13.0, 0.0, 139.0, 5.0, 6.0, 3.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.053476446493626, "mean_inference_ms": 3.3077239431554886, "mean_action_processing_ms": 0.486035891397249, "mean_env_wait_ms": 0.3806608643552147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013675212860107422, "StateBufferConnector_ms": 0.004022359848022461, "ViewRequirementAgentConnector_ms": 0.2090367078781128}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -421.0, "episode_return_mean": 34.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.96870903744184, "num_env_steps_trained_throughput_per_sec": 299.96870903744184, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 16203.236, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16203.177, "sample_time_ms": 3670.379, "learn_time_ms": 12506.578, "learn_throughput": 319.832, "synch_weights_time_ms": 22.477}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "e1352_00002", "date": "2024-08-13_19-35-38", "timestamp": 1723592138, "time_this_iter_s": 13.355082988739014, "time_total_s": 2028.7134954929352, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2028.7134954929352, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 67.34210526315789, "ram_util_percent": 80.55263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7346076061801305, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.508122291514482, "policy_loss": -0.0037257192678572166, "vf_loss": 6.511273766573144, "vf_explained_var": 0.003700049055947198, "kl": 0.014340118598612549, "entropy": 0.8897811092081525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.22913602366649, "cur_kl_coeff": 0.000164794921875, "cur_lr": 0.00010000000000000003, "total_loss": 8.892421141629496, "policy_loss": -0.0021232060612568623, "vf_loss": 8.894541429590296, "vf_explained_var": -0.14039222500311635, "kl": 0.01774361199994248, "entropy": 0.793027175481988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -421.0, "episode_reward_mean": 56.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -38.745, "predator_policy": 66.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.0, -126.0, 45.0, 155.0, 283.0, 93.0, 36.0, -183.0, 284.0, -81.0, -139.0, 66.0, -156.0, 153.0, 251.0, -151.0, 52.0, -69.0, -41.0, 215.0, 55.0, -33.0, 27.0, 34.0, 105.0, 225.0, 233.0, 258.0, -20.0, -49.0, -188.0, -117.0, 129.0, 307.0, -41.0, 59.0, 236.0, 231.0, 293.0, -24.0, -69.0, -313.0, -30.0, 36.0, 260.0, 321.0, 127.0, 93.0, -421.0, 111.0, 35.0, 3.0, 144.0, -27.0, 288.0, -417.0, -97.0, -9.0, 21.0, 119.0, 14.0, 274.0, -241.0, 185.0, 142.0, -152.0, 28.0, -345.0, -153.0, 152.0, 36.0, -2.0, 92.0, 215.0, -167.0, 114.0, 221.0, -169.0, 348.0, -11.0, 311.0, 385.0, -358.0, -12.0, 199.0, 364.0, 289.0, -24.0, 232.0, 105.0, -5.0, -4.0, 96.0, 18.0, 284.0, 184.0, 24.0, 45.0, 40.0, 135.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [49.0, 10.0, -334.0, -61.0, -158.0, 33.0, -86.0, 134.0, 79.0, 123.0, 92.0, 0.0, -70.0, -51.0, -136.0, -301.0, 138.0, 101.0, -64.0, -294.0, -85.0, -338.0, -94.0, 50.0, 0.0, -352.0, -40.0, 17.0, 122.0, 91.0, -153.0, -193.0, 62.0, -137.0, 0.0, -205.0, -161.0, 0.0, 55.0, 46.0, -75.0, 34.0, -346.0, 112.0, -90.0, 38.0, -243.0, 124.0, -216.0, 163.0, 126.0, 74.0, -75.0, 193.0, 139.0, 117.0, 20.0, -227.0, -119.0, -73.0, -93.0, -295.0, -235.0, -75.0, 23.0, 39.0, 188.0, 116.0, -208.0, 31.0, 148.0, -247.0, 104.0, 108.0, 176.0, 55.0, 175.0, 63.0, -125.0, 0.0, -388.0, 15.0, -290.0, -280.0, -358.0, 0.0, -28.0, -24.0, 56.0, 160.0, 137.0, 167.0, 83.0, 0.0, -54.0, 87.0, -352.0, -289.0, -10.0, 26.0, 43.0, -112.0, -320.0, 0.0, -362.0, 134.0, -352.0, 119.0, 150.0, 126.0, -291.0, -383.0, -58.0, -214.0, -194.0, 54.0, -2.0, -208.0, 9.0, 68.0, -346.0, 181.0, -34.0, 171.0, -259.0, -354.0, -86.0, 177.0, 73.0, 51.0, -160.0, -363.0, -154.0, 65.0, -391.0, -345.0, -202.0, -120.0, 53.0, 32.0, 110.0, -241.0, -160.0, -16.0, 132.0, -84.0, 17.0, 185.0, -325.0, -35.0, -134.0, 179.0, 109.0, 78.0, -148.0, -188.0, 190.0, 145.0, -168.0, 13.0, 188.0, 114.0, 191.0, 191.0, -377.0, -178.0, -315.0, 136.0, 59.0, 107.0, 163.0, 191.0, 67.0, 178.0, -258.0, 68.0, 116.0, 87.0, -171.0, 118.0, -300.0, 133.0, 67.0, -217.0, 58.0, -62.0, 36.0, -118.0, 91.0, 129.0, 142.0, -51.0, 112.0, -382.0, 29.0, -85.0, 98.0, -186.0, -125.0, 181.0], "policy_predator_policy_reward": [80.0, 3.0, 109.0, 160.0, 82.0, 88.0, 53.0, 54.0, 38.0, 43.0, 1.0, 0.0, 110.0, 47.0, 113.0, 141.0, 2.0, 43.0, 125.0, 152.0, 180.0, 104.0, 86.0, 24.0, 92.0, 104.0, 93.0, 83.0, 38.0, 0.0, 125.0, 70.0, 71.0, 56.0, 96.0, 40.0, 0.0, 120.0, 63.0, 51.0, 0.0, 96.0, 171.0, 30.0, 1.0, 78.0, 142.0, 11.0, 45.0, 113.0, 12.0, 13.0, 72.0, 43.0, 2.0, 0.0, 116.0, 71.0, 80.0, 63.0, 74.0, 126.0, 126.0, 67.0, 2.0, 65.0, 1.0, 2.0, 136.0, 0.0, 14.0, 144.0, 21.0, 3.0, 0.0, 0.0, 25.0, 30.0, 11.0, 90.0, 176.0, 128.0, 85.0, 172.0, 185.0, 143.0, 7.0, 81.0, 12.0, 32.0, 6.0, 11.0, 26.0, 18.0, 27.0, 33.0, 30.0, 190.0, 0.0, 95.0, 0.0, 104.0, 171.0, 152.0, 186.0, 186.0, 184.0, 22.0, 2.0, 10.0, 65.0, 192.0, 127.0, 48.0, 123.0, 8.0, 117.0, 114.0, 42.0, 0.0, 6.0, 173.0, 78.0, 59.0, 182.0, 190.0, 8.0, 86.0, 0.0, 18.0, 187.0, 184.0, 109.0, 8.0, 193.0, 198.0, 159.0, 10.0, 24.0, 43.0, 167.0, 0.0, 174.0, 0.0, 44.0, 0.0, 0.0, 13.0, 176.0, 17.0, 1.0, 68.0, 29.0, 5.0, 155.0, 12.0, 13.0, 0.0, 139.0, 5.0, 6.0, 3.0, 3.0, 0.0, 3.0, 194.0, 167.0, 0.0, 30.0, 3.0, 0.0, 10.0, 44.0, 0.0, 149.0, 17.0, 0.0, 29.0, 66.0, 92.0, 13.0, 149.0, 4.0, 142.0, 83.0, 17.0, 10.0, 90.0, 31.0, 33.0, 75.0, 18.0, 134.0, 160.0, 11.0, 90.0, 0.0, 128.0, 68.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0532131316507178, "mean_inference_ms": 3.307237206856844, "mean_action_processing_ms": 0.48522974090524157, "mean_env_wait_ms": 0.3807446361248546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013285398483276367, "StateBufferConnector_ms": 0.0040215253829956055, "ViewRequirementAgentConnector_ms": 0.21224558353424072}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -421.0, "episode_return_mean": 56.13, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.82605840594977, "num_env_steps_trained_throughput_per_sec": 326.82605840594977, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 15140.149, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15140.096, "sample_time_ms": 3073.378, "learn_time_ms": 12041.984, "learn_throughput": 332.171, "synch_weights_time_ms": 21.229}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "e1352_00002", "date": "2024-08-13_19-35-50", "timestamp": 1723592150, "time_this_iter_s": 12.245903730392456, "time_total_s": 2040.9593992233276, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2040.9593992233276, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 61.45555555555555, "ram_util_percent": 74.34444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.104161035210367, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.405583800714482, "policy_loss": -0.002456019404245708, "vf_loss": 6.407731224998595, "vf_explained_var": -0.0005535082526938626, "kl": 0.0077062012960878905, "entropy": 0.9094652555606983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.407834885833125, "cur_kl_coeff": 0.000164794921875, "cur_lr": 0.00010000000000000003, "total_loss": 9.032331670528997, "policy_loss": -0.001042943455835696, "vf_loss": 9.033370978239352, "vf_explained_var": -0.15244177576726076, "kl": 0.022030583840267518, "entropy": 0.8302157962448382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -421.0, "episode_reward_mean": 64.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -31.005, "predator_policy": 63.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 34.0, 105.0, 225.0, 233.0, 258.0, -20.0, -49.0, -188.0, -117.0, 129.0, 307.0, -41.0, 59.0, 236.0, 231.0, 293.0, -24.0, -69.0, -313.0, -30.0, 36.0, 260.0, 321.0, 127.0, 93.0, -421.0, 111.0, 35.0, 3.0, 144.0, -27.0, 288.0, -417.0, -97.0, -9.0, 21.0, 119.0, 14.0, 274.0, -241.0, 185.0, 142.0, -152.0, 28.0, -345.0, -153.0, 152.0, 36.0, -2.0, 92.0, 215.0, -167.0, 114.0, 221.0, -169.0, 348.0, -11.0, 311.0, 385.0, -358.0, -12.0, 199.0, 364.0, 289.0, -24.0, 232.0, 105.0, -5.0, -4.0, 96.0, 18.0, 284.0, 184.0, 24.0, 45.0, 40.0, 135.0, 154.0, -135.0, 67.0, 95.0, 1.0, -38.0, 32.0, 159.0, 276.0, -323.0, 213.0, -29.0, -105.0, 180.0, 327.0, -154.0, 87.0, 84.0, 235.0, 122.0, 332.0, 66.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-90.0, 38.0, -243.0, 124.0, -216.0, 163.0, 126.0, 74.0, -75.0, 193.0, 139.0, 117.0, 20.0, -227.0, -119.0, -73.0, -93.0, -295.0, -235.0, -75.0, 23.0, 39.0, 188.0, 116.0, -208.0, 31.0, 148.0, -247.0, 104.0, 108.0, 176.0, 55.0, 175.0, 63.0, -125.0, 0.0, -388.0, 15.0, -290.0, -280.0, -358.0, 0.0, -28.0, -24.0, 56.0, 160.0, 137.0, 167.0, 83.0, 0.0, -54.0, 87.0, -352.0, -289.0, -10.0, 26.0, 43.0, -112.0, -320.0, 0.0, -362.0, 134.0, -352.0, 119.0, 150.0, 126.0, -291.0, -383.0, -58.0, -214.0, -194.0, 54.0, -2.0, -208.0, 9.0, 68.0, -346.0, 181.0, -34.0, 171.0, -259.0, -354.0, -86.0, 177.0, 73.0, 51.0, -160.0, -363.0, -154.0, 65.0, -391.0, -345.0, -202.0, -120.0, 53.0, 32.0, 110.0, -241.0, -160.0, -16.0, 132.0, -84.0, 17.0, 185.0, -325.0, -35.0, -134.0, 179.0, 109.0, 78.0, -148.0, -188.0, 190.0, 145.0, -168.0, 13.0, 188.0, 114.0, 191.0, 191.0, -377.0, -178.0, -315.0, 136.0, 59.0, 107.0, 163.0, 191.0, 67.0, 178.0, -258.0, 68.0, 116.0, 87.0, -171.0, 118.0, -300.0, 133.0, 67.0, -217.0, 58.0, -62.0, 36.0, -118.0, 91.0, 129.0, 142.0, -51.0, 112.0, -382.0, 29.0, -85.0, 98.0, -186.0, -125.0, 181.0, -95.0, 194.0, -350.0, 12.0, 30.0, -23.0, 5.0, 33.0, -83.0, 0.0, 45.0, -217.0, -214.0, 76.0, -32.0, 99.0, 92.0, 160.0, -377.0, -199.0, 143.0, 33.0, -250.0, 49.0, -136.0, -198.0, 113.0, -65.0, 179.0, 126.0, -154.0, -177.0, 120.0, -123.0, -127.0, 101.0, 136.0, -46.0, 29.0, 47.0, 167.0, 140.0, -258.0, 157.0], "policy_predator_policy_reward": [1.0, 78.0, 142.0, 11.0, 45.0, 113.0, 12.0, 13.0, 72.0, 43.0, 2.0, 0.0, 116.0, 71.0, 80.0, 63.0, 74.0, 126.0, 126.0, 67.0, 2.0, 65.0, 1.0, 2.0, 136.0, 0.0, 14.0, 144.0, 21.0, 3.0, 0.0, 0.0, 25.0, 30.0, 11.0, 90.0, 176.0, 128.0, 85.0, 172.0, 185.0, 143.0, 7.0, 81.0, 12.0, 32.0, 6.0, 11.0, 26.0, 18.0, 27.0, 33.0, 30.0, 190.0, 0.0, 95.0, 0.0, 104.0, 171.0, 152.0, 186.0, 186.0, 184.0, 22.0, 2.0, 10.0, 65.0, 192.0, 127.0, 48.0, 123.0, 8.0, 117.0, 114.0, 42.0, 0.0, 6.0, 173.0, 78.0, 59.0, 182.0, 190.0, 8.0, 86.0, 0.0, 18.0, 187.0, 184.0, 109.0, 8.0, 193.0, 198.0, 159.0, 10.0, 24.0, 43.0, 167.0, 0.0, 174.0, 0.0, 44.0, 0.0, 0.0, 13.0, 176.0, 17.0, 1.0, 68.0, 29.0, 5.0, 155.0, 12.0, 13.0, 0.0, 139.0, 5.0, 6.0, 3.0, 3.0, 0.0, 3.0, 194.0, 167.0, 0.0, 30.0, 3.0, 0.0, 10.0, 44.0, 0.0, 149.0, 17.0, 0.0, 29.0, 66.0, 92.0, 13.0, 149.0, 4.0, 142.0, 83.0, 17.0, 10.0, 90.0, 31.0, 33.0, 75.0, 18.0, 134.0, 160.0, 11.0, 90.0, 0.0, 128.0, 68.0, 11.0, 7.0, 48.0, 30.0, 173.0, 53.0, 7.0, 57.0, 0.0, 27.0, 57.0, 12.0, 122.0, 34.0, 136.0, 92.0, 0.0, 0.0, 24.0, 68.0, 185.0, 0.0, 37.0, 12.0, 160.0, 64.0, 165.0, 69.0, 63.0, 4.0, 18.0, 38.0, 139.0, 0.0, 90.0, 2.0, 108.0, 81.0, 64.0, 8.0, 38.0, 22.0, 3.0, 115.0, 52.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0526737438906393, "mean_inference_ms": 3.3035751786887446, "mean_action_processing_ms": 0.48422956204216805, "mean_env_wait_ms": 0.38097726586096753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011932134628295898, "StateBufferConnector_ms": 0.004372000694274902, "ViewRequirementAgentConnector_ms": 0.21252930164337158}, "num_episodes": 22, "episode_return_max": 385.0, "episode_return_min": -421.0, "episode_return_mean": 64.08, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.4316195799053, "num_env_steps_trained_throughput_per_sec": 346.4316195799053, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 14373.14, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14373.088, "sample_time_ms": 2775.938, "learn_time_ms": 11576.911, "learn_throughput": 345.515, "synch_weights_time_ms": 17.427}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "e1352_00002", "date": "2024-08-13_19-36-02", "timestamp": 1723592162, "time_this_iter_s": 11.560864925384521, "time_total_s": 2052.520264148712, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2052.520264148712, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 57.787499999999994, "ram_util_percent": 75.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9461784714744206, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.87860886306359, "policy_loss": -0.001769776270779037, "vf_loss": 6.880015874287439, "vf_explained_var": 0.00682739533444561, "kl": 0.009058719809264763, "entropy": 0.91431430726455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.58037771557374, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 0.00010000000000000003, "total_loss": 8.548663148425874, "policy_loss": 0.002630736354107737, "vf_loss": 8.546029590929626, "vf_explained_var": -0.24412556375776018, "kl": 0.011246367355957175, "entropy": 0.8375869779044358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -453.0, "episode_reward_mean": 50.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -42.25, "predator_policy": 67.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-69.0, -313.0, -30.0, 36.0, 260.0, 321.0, 127.0, 93.0, -421.0, 111.0, 35.0, 3.0, 144.0, -27.0, 288.0, -417.0, -97.0, -9.0, 21.0, 119.0, 14.0, 274.0, -241.0, 185.0, 142.0, -152.0, 28.0, -345.0, -153.0, 152.0, 36.0, -2.0, 92.0, 215.0, -167.0, 114.0, 221.0, -169.0, 348.0, -11.0, 311.0, 385.0, -358.0, -12.0, 199.0, 364.0, 289.0, -24.0, 232.0, 105.0, -5.0, -4.0, 96.0, 18.0, 284.0, 184.0, 24.0, 45.0, 40.0, 135.0, 154.0, -135.0, 67.0, 95.0, 1.0, -38.0, 32.0, 159.0, 276.0, -323.0, 213.0, -29.0, -105.0, 180.0, 327.0, -154.0, 87.0, 84.0, 235.0, 122.0, 332.0, 66.0, -453.0, -102.0, 48.0, 214.0, 157.0, -119.0, 208.0, 30.0, 143.0, 251.0, 166.0, -305.0, 84.0, 170.0, 80.0, -35.0, 107.0, -287.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-388.0, 15.0, -290.0, -280.0, -358.0, 0.0, -28.0, -24.0, 56.0, 160.0, 137.0, 167.0, 83.0, 0.0, -54.0, 87.0, -352.0, -289.0, -10.0, 26.0, 43.0, -112.0, -320.0, 0.0, -362.0, 134.0, -352.0, 119.0, 150.0, 126.0, -291.0, -383.0, -58.0, -214.0, -194.0, 54.0, -2.0, -208.0, 9.0, 68.0, -346.0, 181.0, -34.0, 171.0, -259.0, -354.0, -86.0, 177.0, 73.0, 51.0, -160.0, -363.0, -154.0, 65.0, -391.0, -345.0, -202.0, -120.0, 53.0, 32.0, 110.0, -241.0, -160.0, -16.0, 132.0, -84.0, 17.0, 185.0, -325.0, -35.0, -134.0, 179.0, 109.0, 78.0, -148.0, -188.0, 190.0, 145.0, -168.0, 13.0, 188.0, 114.0, 191.0, 191.0, -377.0, -178.0, -315.0, 136.0, 59.0, 107.0, 163.0, 191.0, 67.0, 178.0, -258.0, 68.0, 116.0, 87.0, -171.0, 118.0, -300.0, 133.0, 67.0, -217.0, 58.0, -62.0, 36.0, -118.0, 91.0, 129.0, 142.0, -51.0, 112.0, -382.0, 29.0, -85.0, 98.0, -186.0, -125.0, 181.0, -95.0, 194.0, -350.0, 12.0, 30.0, -23.0, 5.0, 33.0, -83.0, 0.0, 45.0, -217.0, -214.0, 76.0, -32.0, 99.0, 92.0, 160.0, -377.0, -199.0, 143.0, 33.0, -250.0, 49.0, -136.0, -198.0, 113.0, -65.0, 179.0, 126.0, -154.0, -177.0, 120.0, -123.0, -127.0, 101.0, 136.0, -46.0, 29.0, 47.0, 167.0, 140.0, -258.0, 157.0, -370.0, -374.0, -40.0, -238.0, 137.0, -243.0, -84.0, 197.0, 156.0, 0.0, -150.0, -174.0, 76.0, 117.0, -337.0, 169.0, 127.0, -91.0, 172.0, -11.0, -5.0, 103.0, -337.0, -268.0, 47.0, -112.0, 35.0, 122.0, 58.0, -202.0, -265.0, 0.0, 26.0, -50.0, -289.0, -252.0], "policy_predator_policy_reward": [176.0, 128.0, 85.0, 172.0, 185.0, 143.0, 7.0, 81.0, 12.0, 32.0, 6.0, 11.0, 26.0, 18.0, 27.0, 33.0, 30.0, 190.0, 0.0, 95.0, 0.0, 104.0, 171.0, 152.0, 186.0, 186.0, 184.0, 22.0, 2.0, 10.0, 65.0, 192.0, 127.0, 48.0, 123.0, 8.0, 117.0, 114.0, 42.0, 0.0, 6.0, 173.0, 78.0, 59.0, 182.0, 190.0, 8.0, 86.0, 0.0, 18.0, 187.0, 184.0, 109.0, 8.0, 193.0, 198.0, 159.0, 10.0, 24.0, 43.0, 167.0, 0.0, 174.0, 0.0, 44.0, 0.0, 0.0, 13.0, 176.0, 17.0, 1.0, 68.0, 29.0, 5.0, 155.0, 12.0, 13.0, 0.0, 139.0, 5.0, 6.0, 3.0, 3.0, 0.0, 3.0, 194.0, 167.0, 0.0, 30.0, 3.0, 0.0, 10.0, 44.0, 0.0, 149.0, 17.0, 0.0, 29.0, 66.0, 92.0, 13.0, 149.0, 4.0, 142.0, 83.0, 17.0, 10.0, 90.0, 31.0, 33.0, 75.0, 18.0, 134.0, 160.0, 11.0, 90.0, 0.0, 128.0, 68.0, 11.0, 7.0, 48.0, 30.0, 173.0, 53.0, 7.0, 57.0, 0.0, 27.0, 57.0, 12.0, 122.0, 34.0, 136.0, 92.0, 0.0, 0.0, 24.0, 68.0, 185.0, 0.0, 37.0, 12.0, 160.0, 64.0, 165.0, 69.0, 63.0, 4.0, 18.0, 38.0, 139.0, 0.0, 90.0, 2.0, 108.0, 81.0, 64.0, 8.0, 38.0, 22.0, 3.0, 115.0, 52.0, 199.0, 92.0, 19.0, 157.0, 126.0, 28.0, 49.0, 52.0, 1.0, 0.0, 95.0, 110.0, 1.0, 14.0, 85.0, 113.0, 96.0, 11.0, 30.0, 60.0, 2.0, 66.0, 164.0, 136.0, 75.0, 74.0, 0.0, 13.0, 85.0, 139.0, 75.0, 155.0, 60.0, 71.0, 85.0, 169.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0510669093086404, "mean_inference_ms": 3.3014892712940225, "mean_action_processing_ms": 0.4832321585781009, "mean_env_wait_ms": 0.3801335572950126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009411096572875977, "StateBufferConnector_ms": 0.004136919975280762, "ViewRequirementAgentConnector_ms": 0.20452940464019775}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -453.0, "episode_return_mean": 50.67, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.0568968400521, "num_env_steps_trained_throughput_per_sec": 345.0568968400521, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 13692.744, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13692.695, "sample_time_ms": 2419.743, "learn_time_ms": 11253.494, "learn_throughput": 355.445, "synch_weights_time_ms": 16.563}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "e1352_00002", "date": "2024-08-13_19-36-13", "timestamp": 1723592173, "time_this_iter_s": 11.638406991958618, "time_total_s": 2064.158671140671, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2064.158671140671, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 57.111764705882344, "ram_util_percent": 77.61176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6885247707051576, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.52989932241894, "policy_loss": -0.004084225539019499, "vf_loss": 6.533400807809578, "vf_explained_var": 0.014149486419385073, "kl": 0.014551987165566094, "entropy": 0.9598989020895075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.628628607196784, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 0.00010000000000000003, "total_loss": 8.701011836591851, "policy_loss": 0.0015505531138774974, "vf_loss": 8.69945135267954, "vf_explained_var": -0.20071604974055415, "kl": 0.04019054911135646, "entropy": 0.7757378892608421, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -453.0, "episode_reward_mean": 69.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -26.99, "predator_policy": 61.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.0, 142.0, -152.0, 28.0, -345.0, -153.0, 152.0, 36.0, -2.0, 92.0, 215.0, -167.0, 114.0, 221.0, -169.0, 348.0, -11.0, 311.0, 385.0, -358.0, -12.0, 199.0, 364.0, 289.0, -24.0, 232.0, 105.0, -5.0, -4.0, 96.0, 18.0, 284.0, 184.0, 24.0, 45.0, 40.0, 135.0, 154.0, -135.0, 67.0, 95.0, 1.0, -38.0, 32.0, 159.0, 276.0, -323.0, 213.0, -29.0, -105.0, 180.0, 327.0, -154.0, 87.0, 84.0, 235.0, 122.0, 332.0, 66.0, -453.0, -102.0, 48.0, 214.0, 157.0, -119.0, 208.0, 30.0, 143.0, 251.0, 166.0, -305.0, 84.0, 170.0, 80.0, -35.0, 107.0, -287.0, -1.0, 131.0, -72.0, 157.0, 141.0, 168.0, 157.0, 284.0, 52.0, 99.0, 221.0, 71.0, 328.0, 125.0, 89.0, -384.0, 39.0, 175.0, 60.0, -143.0, -23.0, 262.0, 191.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-86.0, 177.0, 73.0, 51.0, -160.0, -363.0, -154.0, 65.0, -391.0, -345.0, -202.0, -120.0, 53.0, 32.0, 110.0, -241.0, -160.0, -16.0, 132.0, -84.0, 17.0, 185.0, -325.0, -35.0, -134.0, 179.0, 109.0, 78.0, -148.0, -188.0, 190.0, 145.0, -168.0, 13.0, 188.0, 114.0, 191.0, 191.0, -377.0, -178.0, -315.0, 136.0, 59.0, 107.0, 163.0, 191.0, 67.0, 178.0, -258.0, 68.0, 116.0, 87.0, -171.0, 118.0, -300.0, 133.0, 67.0, -217.0, 58.0, -62.0, 36.0, -118.0, 91.0, 129.0, 142.0, -51.0, 112.0, -382.0, 29.0, -85.0, 98.0, -186.0, -125.0, 181.0, -95.0, 194.0, -350.0, 12.0, 30.0, -23.0, 5.0, 33.0, -83.0, 0.0, 45.0, -217.0, -214.0, 76.0, -32.0, 99.0, 92.0, 160.0, -377.0, -199.0, 143.0, 33.0, -250.0, 49.0, -136.0, -198.0, 113.0, -65.0, 179.0, 126.0, -154.0, -177.0, 120.0, -123.0, -127.0, 101.0, 136.0, -46.0, 29.0, 47.0, 167.0, 140.0, -258.0, 157.0, -370.0, -374.0, -40.0, -238.0, 137.0, -243.0, -84.0, 197.0, 156.0, 0.0, -150.0, -174.0, 76.0, 117.0, -337.0, 169.0, 127.0, -91.0, 172.0, -11.0, -5.0, 103.0, -337.0, -268.0, 47.0, -112.0, 35.0, 122.0, 58.0, -202.0, -265.0, 0.0, 26.0, -50.0, -289.0, -252.0, -242.0, 80.0, -93.0, 120.0, -109.0, -186.0, -70.0, 137.0, -145.0, 186.0, 157.0, -111.0, 67.0, 35.0, 66.0, 186.0, 165.0, -271.0, -372.0, 108.0, 94.0, 127.0, 5.0, -46.0, 156.0, 163.0, -106.0, 129.0, -109.0, 59.0, -394.0, -329.0, 83.0, -175.0, 159.0, 16.0, -201.0, 151.0, -145.0, -303.0, -127.0, 0.0, -19.0, 189.0, 123.0, 68.0], "policy_predator_policy_reward": [8.0, 86.0, 0.0, 18.0, 187.0, 184.0, 109.0, 8.0, 193.0, 198.0, 159.0, 10.0, 24.0, 43.0, 167.0, 0.0, 174.0, 0.0, 44.0, 0.0, 0.0, 13.0, 176.0, 17.0, 1.0, 68.0, 29.0, 5.0, 155.0, 12.0, 13.0, 0.0, 139.0, 5.0, 6.0, 3.0, 3.0, 0.0, 3.0, 194.0, 167.0, 0.0, 30.0, 3.0, 0.0, 10.0, 44.0, 0.0, 149.0, 17.0, 0.0, 29.0, 66.0, 92.0, 13.0, 149.0, 4.0, 142.0, 83.0, 17.0, 10.0, 90.0, 31.0, 33.0, 75.0, 18.0, 134.0, 160.0, 11.0, 90.0, 0.0, 128.0, 68.0, 11.0, 7.0, 48.0, 30.0, 173.0, 53.0, 7.0, 57.0, 0.0, 27.0, 57.0, 12.0, 122.0, 34.0, 136.0, 92.0, 0.0, 0.0, 24.0, 68.0, 185.0, 0.0, 37.0, 12.0, 160.0, 64.0, 165.0, 69.0, 63.0, 4.0, 18.0, 38.0, 139.0, 0.0, 90.0, 2.0, 108.0, 81.0, 64.0, 8.0, 38.0, 22.0, 3.0, 115.0, 52.0, 199.0, 92.0, 19.0, 157.0, 126.0, 28.0, 49.0, 52.0, 1.0, 0.0, 95.0, 110.0, 1.0, 14.0, 85.0, 113.0, 96.0, 11.0, 30.0, 60.0, 2.0, 66.0, 164.0, 136.0, 75.0, 74.0, 0.0, 13.0, 85.0, 139.0, 75.0, 155.0, 60.0, 71.0, 85.0, 169.0, 150.0, 11.0, 95.0, 9.0, 97.0, 126.0, 1.0, 89.0, 14.0, 86.0, 49.0, 73.0, 50.0, 5.0, 2.0, 30.0, 31.0, 127.0, 184.0, 179.0, 0.0, 0.0, 89.0, 23.0, 0.0, 9.0, 98.0, 4.0, 48.0, 91.0, 185.0, 154.0, 111.0, 20.0, 0.0, 0.0, 26.0, 84.0, 143.0, 162.0, 0.0, 104.0, 47.0, 45.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.049650705534866, "mean_inference_ms": 3.295970303150005, "mean_action_processing_ms": 0.48149356576952146, "mean_env_wait_ms": 0.3793112218274296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068552494049072266, "StateBufferConnector_ms": 0.004114866256713867, "ViewRequirementAgentConnector_ms": 0.1659764051437378}, "num_episodes": 23, "episode_return_max": 385.0, "episode_return_min": -453.0, "episode_return_mean": 69.72, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.70177996431823, "num_env_steps_trained_throughput_per_sec": 270.70177996431823, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 13315.484, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13315.442, "sample_time_ms": 2239.762, "learn_time_ms": 11053.437, "learn_throughput": 361.878, "synch_weights_time_ms": 18.989}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "e1352_00002", "date": "2024-08-13_19-36-28", "timestamp": 1723592188, "time_this_iter_s": 14.911602973937988, "time_total_s": 2079.0702741146088, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2079.0702741146088, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 67.54761904761907, "ram_util_percent": 81.65238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.985150432523596, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.58368145700485, "policy_loss": -0.0023792466234967666, "vf_loss": 6.585548565375111, "vf_explained_var": -0.011194459912638184, "kl": 0.012789018406687001, "entropy": 0.9409286718204539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.874509476322345, "cur_kl_coeff": 0.0003707885742187501, "cur_lr": 0.00010000000000000003, "total_loss": 8.697372815217921, "policy_loss": 0.00535656650570374, "vf_loss": 8.692005175635929, "vf_explained_var": -0.2749850402118037, "kl": 0.029861829758754944, "entropy": 0.8060869252555585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -453.0, "episode_reward_mean": 71.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -26.435, "predator_policy": 61.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [385.0, -358.0, -12.0, 199.0, 364.0, 289.0, -24.0, 232.0, 105.0, -5.0, -4.0, 96.0, 18.0, 284.0, 184.0, 24.0, 45.0, 40.0, 135.0, 154.0, -135.0, 67.0, 95.0, 1.0, -38.0, 32.0, 159.0, 276.0, -323.0, 213.0, -29.0, -105.0, 180.0, 327.0, -154.0, 87.0, 84.0, 235.0, 122.0, 332.0, 66.0, -453.0, -102.0, 48.0, 214.0, 157.0, -119.0, 208.0, 30.0, 143.0, 251.0, 166.0, -305.0, 84.0, 170.0, 80.0, -35.0, 107.0, -287.0, -1.0, 131.0, -72.0, 157.0, 141.0, 168.0, 157.0, 284.0, 52.0, 99.0, 221.0, 71.0, 328.0, 125.0, 89.0, -384.0, 39.0, 175.0, 60.0, -143.0, -23.0, 262.0, 191.0, -4.0, -159.0, 239.0, -108.0, -16.0, -103.0, 130.0, 214.0, 302.0, 204.0, 267.0, 114.0, -48.0, 106.0, -295.0, 140.0, -195.0, 194.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.0, 191.0, -377.0, -178.0, -315.0, 136.0, 59.0, 107.0, 163.0, 191.0, 67.0, 178.0, -258.0, 68.0, 116.0, 87.0, -171.0, 118.0, -300.0, 133.0, 67.0, -217.0, 58.0, -62.0, 36.0, -118.0, 91.0, 129.0, 142.0, -51.0, 112.0, -382.0, 29.0, -85.0, 98.0, -186.0, -125.0, 181.0, -95.0, 194.0, -350.0, 12.0, 30.0, -23.0, 5.0, 33.0, -83.0, 0.0, 45.0, -217.0, -214.0, 76.0, -32.0, 99.0, 92.0, 160.0, -377.0, -199.0, 143.0, 33.0, -250.0, 49.0, -136.0, -198.0, 113.0, -65.0, 179.0, 126.0, -154.0, -177.0, 120.0, -123.0, -127.0, 101.0, 136.0, -46.0, 29.0, 47.0, 167.0, 140.0, -258.0, 157.0, -370.0, -374.0, -40.0, -238.0, 137.0, -243.0, -84.0, 197.0, 156.0, 0.0, -150.0, -174.0, 76.0, 117.0, -337.0, 169.0, 127.0, -91.0, 172.0, -11.0, -5.0, 103.0, -337.0, -268.0, 47.0, -112.0, 35.0, 122.0, 58.0, -202.0, -265.0, 0.0, 26.0, -50.0, -289.0, -252.0, -242.0, 80.0, -93.0, 120.0, -109.0, -186.0, -70.0, 137.0, -145.0, 186.0, 157.0, -111.0, 67.0, 35.0, 66.0, 186.0, 165.0, -271.0, -372.0, 108.0, 94.0, 127.0, 5.0, -46.0, 156.0, 163.0, -106.0, 129.0, -109.0, 59.0, -394.0, -329.0, 83.0, -175.0, 159.0, 16.0, -201.0, 151.0, -145.0, -303.0, -127.0, 0.0, -19.0, 189.0, 123.0, 68.0, 68.0, -370.0, -299.0, -36.0, 170.0, 55.0, 0.0, -268.0, -189.0, 16.0, -193.0, -232.0, -12.0, 56.0, 118.0, 87.0, 62.0, 185.0, -84.0, 192.0, 109.0, 95.0, 100.0, 0.0, -59.0, -309.0, 0.0, 92.0, -226.0, -248.0, 111.0, 0.0, -247.0, -187.0, 78.0, 67.0], "policy_predator_policy_reward": [3.0, 0.0, 3.0, 194.0, 167.0, 0.0, 30.0, 3.0, 0.0, 10.0, 44.0, 0.0, 149.0, 17.0, 0.0, 29.0, 66.0, 92.0, 13.0, 149.0, 4.0, 142.0, 83.0, 17.0, 10.0, 90.0, 31.0, 33.0, 75.0, 18.0, 134.0, 160.0, 11.0, 90.0, 0.0, 128.0, 68.0, 11.0, 7.0, 48.0, 30.0, 173.0, 53.0, 7.0, 57.0, 0.0, 27.0, 57.0, 12.0, 122.0, 34.0, 136.0, 92.0, 0.0, 0.0, 24.0, 68.0, 185.0, 0.0, 37.0, 12.0, 160.0, 64.0, 165.0, 69.0, 63.0, 4.0, 18.0, 38.0, 139.0, 0.0, 90.0, 2.0, 108.0, 81.0, 64.0, 8.0, 38.0, 22.0, 3.0, 115.0, 52.0, 199.0, 92.0, 19.0, 157.0, 126.0, 28.0, 49.0, 52.0, 1.0, 0.0, 95.0, 110.0, 1.0, 14.0, 85.0, 113.0, 96.0, 11.0, 30.0, 60.0, 2.0, 66.0, 164.0, 136.0, 75.0, 74.0, 0.0, 13.0, 85.0, 139.0, 75.0, 155.0, 60.0, 71.0, 85.0, 169.0, 150.0, 11.0, 95.0, 9.0, 97.0, 126.0, 1.0, 89.0, 14.0, 86.0, 49.0, 73.0, 50.0, 5.0, 2.0, 30.0, 31.0, 127.0, 184.0, 179.0, 0.0, 0.0, 89.0, 23.0, 0.0, 9.0, 98.0, 4.0, 48.0, 91.0, 185.0, 154.0, 111.0, 20.0, 0.0, 0.0, 26.0, 84.0, 143.0, 162.0, 0.0, 104.0, 47.0, 45.0, 0.0, 0.0, 136.0, 162.0, 135.0, 41.0, 7.0, 7.0, 26.0, 134.0, 101.0, 56.0, 147.0, 175.0, 47.0, 39.0, 0.0, 9.0, 44.0, 11.0, 81.0, 15.0, 26.0, 37.0, 14.0, 0.0, 167.0, 153.0, 7.0, 7.0, 24.0, 155.0, 0.0, 29.0, 175.0, 64.0, 30.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0496419673088768, "mean_inference_ms": 3.294907060058305, "mean_action_processing_ms": 0.4807684573275441, "mean_env_wait_ms": 0.3789210461070537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006618618965148926, "StateBufferConnector_ms": 0.004140019416809082, "ViewRequirementAgentConnector_ms": 0.16728007793426514}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -453.0, "episode_return_mean": 71.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.36623606993436, "num_env_steps_trained_throughput_per_sec": 283.36623606993436, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 13506.148, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13506.107, "sample_time_ms": 2394.127, "learn_time_ms": 11090.365, "learn_throughput": 360.673, "synch_weights_time_ms": 19.003}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "e1352_00002", "date": "2024-08-13_19-36-43", "timestamp": 1723592203, "time_this_iter_s": 14.137221813201904, "time_total_s": 2093.2074959278107, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e22670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2093.2074959278107, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 68.425, "ram_util_percent": 83.345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.550159266922209, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.776584606322031, "policy_loss": -0.0013010982916784033, "vf_loss": 6.777413211550031, "vf_explained_var": -0.005652558866632048, "kl": 0.011798483225062856, "entropy": 0.924848824581772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.24097530942745, "cur_kl_coeff": 0.0005561828613281247, "cur_lr": 0.00010000000000000003, "total_loss": 9.053701056626739, "policy_loss": 0.00434972513996794, "vf_loss": 9.049336786118765, "vf_explained_var": -0.18333229482489288, "kl": 0.026162036260738448, "entropy": 0.7956145118153285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 332.0, "episode_reward_min": -453.0, "episode_reward_mean": 60.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -35.4, "predator_policy": 65.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.0, 1.0, -38.0, 32.0, 159.0, 276.0, -323.0, 213.0, -29.0, -105.0, 180.0, 327.0, -154.0, 87.0, 84.0, 235.0, 122.0, 332.0, 66.0, -453.0, -102.0, 48.0, 214.0, 157.0, -119.0, 208.0, 30.0, 143.0, 251.0, 166.0, -305.0, 84.0, 170.0, 80.0, -35.0, 107.0, -287.0, -1.0, 131.0, -72.0, 157.0, 141.0, 168.0, 157.0, 284.0, 52.0, 99.0, 221.0, 71.0, 328.0, 125.0, 89.0, -384.0, 39.0, 175.0, 60.0, -143.0, -23.0, 262.0, 191.0, -4.0, -159.0, 239.0, -108.0, -16.0, -103.0, 130.0, 214.0, 302.0, 204.0, 267.0, 114.0, -48.0, 106.0, -295.0, 140.0, -195.0, 194.0, 199.0, 77.0, 116.0, -69.0, 157.0, -126.0, 63.0, 37.0, -89.0, 224.0, 91.0, -37.0, 112.0, 135.0, -271.0, 286.0, 3.0, -80.0, 55.0, -223.0, 63.0, 331.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 33.0, -83.0, 0.0, 45.0, -217.0, -214.0, 76.0, -32.0, 99.0, 92.0, 160.0, -377.0, -199.0, 143.0, 33.0, -250.0, 49.0, -136.0, -198.0, 113.0, -65.0, 179.0, 126.0, -154.0, -177.0, 120.0, -123.0, -127.0, 101.0, 136.0, -46.0, 29.0, 47.0, 167.0, 140.0, -258.0, 157.0, -370.0, -374.0, -40.0, -238.0, 137.0, -243.0, -84.0, 197.0, 156.0, 0.0, -150.0, -174.0, 76.0, 117.0, -337.0, 169.0, 127.0, -91.0, 172.0, -11.0, -5.0, 103.0, -337.0, -268.0, 47.0, -112.0, 35.0, 122.0, 58.0, -202.0, -265.0, 0.0, 26.0, -50.0, -289.0, -252.0, -242.0, 80.0, -93.0, 120.0, -109.0, -186.0, -70.0, 137.0, -145.0, 186.0, 157.0, -111.0, 67.0, 35.0, 66.0, 186.0, 165.0, -271.0, -372.0, 108.0, 94.0, 127.0, 5.0, -46.0, 156.0, 163.0, -106.0, 129.0, -109.0, 59.0, -394.0, -329.0, 83.0, -175.0, 159.0, 16.0, -201.0, 151.0, -145.0, -303.0, -127.0, 0.0, -19.0, 189.0, 123.0, 68.0, 68.0, -370.0, -299.0, -36.0, 170.0, 55.0, 0.0, -268.0, -189.0, 16.0, -193.0, -232.0, -12.0, 56.0, 118.0, 87.0, 62.0, 185.0, -84.0, 192.0, 109.0, 95.0, 100.0, 0.0, -59.0, -309.0, 0.0, 92.0, -226.0, -248.0, 111.0, 0.0, -247.0, -187.0, 78.0, 67.0, 165.0, -243.0, -148.0, 118.0, 178.0, -372.0, -302.0, 29.0, 112.0, -104.0, -10.0, -307.0, -46.0, -32.0, 6.0, -11.0, -203.0, -16.0, 70.0, 110.0, -4.0, 21.0, -17.0, -236.0, 106.0, -108.0, 14.0, 121.0, -253.0, -242.0, 127.0, 150.0, -296.0, 108.0, -310.0, -9.0, -4.0, -15.0, -375.0, -110.0, 61.0, -151.0, 144.0, 182.0], "policy_predator_policy_reward": [57.0, 0.0, 27.0, 57.0, 12.0, 122.0, 34.0, 136.0, 92.0, 0.0, 0.0, 24.0, 68.0, 185.0, 0.0, 37.0, 12.0, 160.0, 64.0, 165.0, 69.0, 63.0, 4.0, 18.0, 38.0, 139.0, 0.0, 90.0, 2.0, 108.0, 81.0, 64.0, 8.0, 38.0, 22.0, 3.0, 115.0, 52.0, 199.0, 92.0, 19.0, 157.0, 126.0, 28.0, 49.0, 52.0, 1.0, 0.0, 95.0, 110.0, 1.0, 14.0, 85.0, 113.0, 96.0, 11.0, 30.0, 60.0, 2.0, 66.0, 164.0, 136.0, 75.0, 74.0, 0.0, 13.0, 85.0, 139.0, 75.0, 155.0, 60.0, 71.0, 85.0, 169.0, 150.0, 11.0, 95.0, 9.0, 97.0, 126.0, 1.0, 89.0, 14.0, 86.0, 49.0, 73.0, 50.0, 5.0, 2.0, 30.0, 31.0, 127.0, 184.0, 179.0, 0.0, 0.0, 89.0, 23.0, 0.0, 9.0, 98.0, 4.0, 48.0, 91.0, 185.0, 154.0, 111.0, 20.0, 0.0, 0.0, 26.0, 84.0, 143.0, 162.0, 0.0, 104.0, 47.0, 45.0, 0.0, 0.0, 136.0, 162.0, 135.0, 41.0, 7.0, 7.0, 26.0, 134.0, 101.0, 56.0, 147.0, 175.0, 47.0, 39.0, 0.0, 9.0, 44.0, 11.0, 81.0, 15.0, 26.0, 37.0, 14.0, 0.0, 167.0, 153.0, 7.0, 7.0, 24.0, 155.0, 0.0, 29.0, 175.0, 64.0, 30.0, 19.0, 131.0, 146.0, 52.0, 55.0, 123.0, 187.0, 58.0, 146.0, 76.0, 73.0, 162.0, 29.0, 67.0, 74.0, 0.0, 42.0, 4.0, 126.0, 32.0, 12.0, 74.0, 0.0, 74.0, 142.0, 89.0, 25.0, 0.0, 0.0, 128.0, 96.0, 9.0, 0.0, 85.0, 106.0, 174.0, 65.0, 73.0, 1.0, 138.0, 124.0, 103.0, 50.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0497817294531913, "mean_inference_ms": 3.2919089407639173, "mean_action_processing_ms": 0.4800572650963406, "mean_env_wait_ms": 0.3788351762908806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006628632545471191, "StateBufferConnector_ms": 0.0040607452392578125, "ViewRequirementAgentConnector_ms": 0.16640925407409668}, "num_episodes": 22, "episode_return_max": 332.0, "episode_return_min": -453.0, "episode_return_mean": 60.8, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.01890781258084, "num_env_steps_trained_throughput_per_sec": 343.01890781258084, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 13526.014, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13525.95, "sample_time_ms": 2411.872, "learn_time_ms": 11091.497, "learn_throughput": 360.637, "synch_weights_time_ms": 19.728}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "e1352_00002", "date": "2024-08-13_19-36-54", "timestamp": 1723592214, "time_this_iter_s": 11.714420795440674, "time_total_s": 2104.9219167232513, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e228b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2104.9219167232513, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 58.12352941176471, "ram_util_percent": 83.24117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5093275230870677, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 6.23542284587073, "policy_loss": -0.002638226016498511, "vf_loss": 6.237440065605931, "vf_explained_var": 6.650831333543889e-05, "kl": 0.0155075343907162, "entropy": 0.979278034507913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.673187656629654, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 8.756764745459986, "policy_loss": -0.0002522023681738468, "vf_loss": 8.757005977126026, "vf_explained_var": -0.055588929016123376, "kl": 0.013142279818671141, "entropy": 0.7540288660892103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 344.0, "episode_reward_min": -460.0, "episode_reward_mean": 56.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -40.755, "predator_policy": 68.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.0, -453.0, -102.0, 48.0, 214.0, 157.0, -119.0, 208.0, 30.0, 143.0, 251.0, 166.0, -305.0, 84.0, 170.0, 80.0, -35.0, 107.0, -287.0, -1.0, 131.0, -72.0, 157.0, 141.0, 168.0, 157.0, 284.0, 52.0, 99.0, 221.0, 71.0, 328.0, 125.0, 89.0, -384.0, 39.0, 175.0, 60.0, -143.0, -23.0, 262.0, 191.0, -4.0, -159.0, 239.0, -108.0, -16.0, -103.0, 130.0, 214.0, 302.0, 204.0, 267.0, 114.0, -48.0, 106.0, -295.0, 140.0, -195.0, 194.0, 199.0, 77.0, 116.0, -69.0, 157.0, -126.0, 63.0, 37.0, -89.0, 224.0, 91.0, -37.0, 112.0, 135.0, -271.0, 286.0, 3.0, -80.0, 55.0, -223.0, 63.0, 331.0, 229.0, 142.0, -194.0, 344.0, 66.0, -89.0, -120.0, 93.0, 258.0, 37.0, 233.0, 337.0, 72.0, 86.0, -181.0, -460.0, 34.0, 150.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-258.0, 157.0, -370.0, -374.0, -40.0, -238.0, 137.0, -243.0, -84.0, 197.0, 156.0, 0.0, -150.0, -174.0, 76.0, 117.0, -337.0, 169.0, 127.0, -91.0, 172.0, -11.0, -5.0, 103.0, -337.0, -268.0, 47.0, -112.0, 35.0, 122.0, 58.0, -202.0, -265.0, 0.0, 26.0, -50.0, -289.0, -252.0, -242.0, 80.0, -93.0, 120.0, -109.0, -186.0, -70.0, 137.0, -145.0, 186.0, 157.0, -111.0, 67.0, 35.0, 66.0, 186.0, 165.0, -271.0, -372.0, 108.0, 94.0, 127.0, 5.0, -46.0, 156.0, 163.0, -106.0, 129.0, -109.0, 59.0, -394.0, -329.0, 83.0, -175.0, 159.0, 16.0, -201.0, 151.0, -145.0, -303.0, -127.0, 0.0, -19.0, 189.0, 123.0, 68.0, 68.0, -370.0, -299.0, -36.0, 170.0, 55.0, 0.0, -268.0, -189.0, 16.0, -193.0, -232.0, -12.0, 56.0, 118.0, 87.0, 62.0, 185.0, -84.0, 192.0, 109.0, 95.0, 100.0, 0.0, -59.0, -309.0, 0.0, 92.0, -226.0, -248.0, 111.0, 0.0, -247.0, -187.0, 78.0, 67.0, 165.0, -243.0, -148.0, 118.0, 178.0, -372.0, -302.0, 29.0, 112.0, -104.0, -10.0, -307.0, -46.0, -32.0, 6.0, -11.0, -203.0, -16.0, 70.0, 110.0, -4.0, 21.0, -17.0, -236.0, 106.0, -108.0, 14.0, 121.0, -253.0, -242.0, 127.0, 150.0, -296.0, 108.0, -310.0, -9.0, -4.0, -15.0, -375.0, -110.0, 61.0, -151.0, 144.0, 182.0, 80.0, 115.0, -112.0, 95.0, -368.0, -214.0, 163.0, 181.0, -91.0, -2.0, -400.0, 52.0, -27.0, -282.0, -44.0, 65.0, 96.0, 137.0, -318.0, 171.0, 87.0, 93.0, 168.0, 169.0, -174.0, 89.0, 50.0, -136.0, -329.0, -115.0, -365.0, -350.0, -170.0, -12.0, -8.0, 130.0], "policy_predator_policy_reward": [115.0, 52.0, 199.0, 92.0, 19.0, 157.0, 126.0, 28.0, 49.0, 52.0, 1.0, 0.0, 95.0, 110.0, 1.0, 14.0, 85.0, 113.0, 96.0, 11.0, 30.0, 60.0, 2.0, 66.0, 164.0, 136.0, 75.0, 74.0, 0.0, 13.0, 85.0, 139.0, 75.0, 155.0, 60.0, 71.0, 85.0, 169.0, 150.0, 11.0, 95.0, 9.0, 97.0, 126.0, 1.0, 89.0, 14.0, 86.0, 49.0, 73.0, 50.0, 5.0, 2.0, 30.0, 31.0, 127.0, 184.0, 179.0, 0.0, 0.0, 89.0, 23.0, 0.0, 9.0, 98.0, 4.0, 48.0, 91.0, 185.0, 154.0, 111.0, 20.0, 0.0, 0.0, 26.0, 84.0, 143.0, 162.0, 0.0, 104.0, 47.0, 45.0, 0.0, 0.0, 136.0, 162.0, 135.0, 41.0, 7.0, 7.0, 26.0, 134.0, 101.0, 56.0, 147.0, 175.0, 47.0, 39.0, 0.0, 9.0, 44.0, 11.0, 81.0, 15.0, 26.0, 37.0, 14.0, 0.0, 167.0, 153.0, 7.0, 7.0, 24.0, 155.0, 0.0, 29.0, 175.0, 64.0, 30.0, 19.0, 131.0, 146.0, 52.0, 55.0, 123.0, 187.0, 58.0, 146.0, 76.0, 73.0, 162.0, 29.0, 67.0, 74.0, 0.0, 42.0, 4.0, 126.0, 32.0, 12.0, 74.0, 0.0, 74.0, 142.0, 89.0, 25.0, 0.0, 0.0, 128.0, 96.0, 9.0, 0.0, 85.0, 106.0, 174.0, 65.0, 73.0, 1.0, 138.0, 124.0, 103.0, 50.0, 5.0, 0.0, 27.0, 7.0, 126.0, 33.0, 196.0, 192.0, 0.0, 0.0, 74.0, 85.0, 132.0, 127.0, 170.0, 19.0, 0.0, 72.0, 7.0, 18.0, 144.0, 40.0, 24.0, 29.0, 0.0, 0.0, 65.0, 92.0, 95.0, 77.0, 91.0, 172.0, 192.0, 63.0, 100.0, 116.0, 28.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.050234485739129, "mean_inference_ms": 3.2944419764429034, "mean_action_processing_ms": 0.4795110414592979, "mean_env_wait_ms": 0.37829451799171726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006722450256347656, "StateBufferConnector_ms": 0.004139900207519531, "ViewRequirementAgentConnector_ms": 0.16960477828979492}, "num_episodes": 18, "episode_return_max": 344.0, "episode_return_min": -460.0, "episode_return_mean": 56.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.6654280864536, "num_env_steps_trained_throughput_per_sec": 335.6654280864536, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 13441.35, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13441.278, "sample_time_ms": 2414.674, "learn_time_ms": 11005.246, "learn_throughput": 363.463, "synch_weights_time_ms": 18.537}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "e1352_00002", "date": "2024-08-13_19-37-06", "timestamp": 1723592226, "time_this_iter_s": 11.951304912567139, "time_total_s": 2116.8732216358185, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e22c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2116.8732216358185, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 57.576470588235296, "ram_util_percent": 83.31764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6456514432001366, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 5.863942258067863, "policy_loss": -0.0015263627915244017, "vf_loss": 5.865099256000821, "vf_explained_var": -0.0010775146030244374, "kl": 0.009223880828280927, "entropy": 0.9451966548722888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.38797569587117, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 8.62517971008543, "policy_loss": 0.006443133124608606, "vf_loss": 8.618723137668832, "vf_explained_var": -0.10622125217523525, "kl": 0.01612441871115932, "entropy": 0.8112930303212826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -460.0, "episode_reward_mean": 60.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -36.36, "predator_policy": 66.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, 168.0, 157.0, 284.0, 52.0, 99.0, 221.0, 71.0, 328.0, 125.0, 89.0, -384.0, 39.0, 175.0, 60.0, -143.0, -23.0, 262.0, 191.0, -4.0, -159.0, 239.0, -108.0, -16.0, -103.0, 130.0, 214.0, 302.0, 204.0, 267.0, 114.0, -48.0, 106.0, -295.0, 140.0, -195.0, 194.0, 199.0, 77.0, 116.0, -69.0, 157.0, -126.0, 63.0, 37.0, -89.0, 224.0, 91.0, -37.0, 112.0, 135.0, -271.0, 286.0, 3.0, -80.0, 55.0, -223.0, 63.0, 331.0, 229.0, 142.0, -194.0, 344.0, 66.0, -89.0, -120.0, 93.0, 258.0, 37.0, 233.0, 337.0, 72.0, 86.0, -181.0, -460.0, 34.0, 150.0, -181.0, -145.0, 179.0, -201.0, -128.0, 113.0, -244.0, 338.0, 232.0, -123.0, -77.0, 9.0, -87.0, -97.0, 101.0, 359.0, 378.0, 166.0, 251.0, 42.0, 33.0, -74.0, 227.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-145.0, 186.0, 157.0, -111.0, 67.0, 35.0, 66.0, 186.0, 165.0, -271.0, -372.0, 108.0, 94.0, 127.0, 5.0, -46.0, 156.0, 163.0, -106.0, 129.0, -109.0, 59.0, -394.0, -329.0, 83.0, -175.0, 159.0, 16.0, -201.0, 151.0, -145.0, -303.0, -127.0, 0.0, -19.0, 189.0, 123.0, 68.0, 68.0, -370.0, -299.0, -36.0, 170.0, 55.0, 0.0, -268.0, -189.0, 16.0, -193.0, -232.0, -12.0, 56.0, 118.0, 87.0, 62.0, 185.0, -84.0, 192.0, 109.0, 95.0, 100.0, 0.0, -59.0, -309.0, 0.0, 92.0, -226.0, -248.0, 111.0, 0.0, -247.0, -187.0, 78.0, 67.0, 165.0, -243.0, -148.0, 118.0, 178.0, -372.0, -302.0, 29.0, 112.0, -104.0, -10.0, -307.0, -46.0, -32.0, 6.0, -11.0, -203.0, -16.0, 70.0, 110.0, -4.0, 21.0, -17.0, -236.0, 106.0, -108.0, 14.0, 121.0, -253.0, -242.0, 127.0, 150.0, -296.0, 108.0, -310.0, -9.0, -4.0, -15.0, -375.0, -110.0, 61.0, -151.0, 144.0, 182.0, 80.0, 115.0, -112.0, 95.0, -368.0, -214.0, 163.0, 181.0, -91.0, -2.0, -400.0, 52.0, -27.0, -282.0, -44.0, 65.0, 96.0, 137.0, -318.0, 171.0, 87.0, 93.0, 168.0, 169.0, -174.0, 89.0, 50.0, -136.0, -329.0, -115.0, -365.0, -350.0, -170.0, -12.0, -8.0, 130.0, -28.0, -344.0, -379.0, 28.0, 113.0, 66.0, -132.0, -247.0, -126.0, -228.0, 0.0, 99.0, -290.0, -231.0, 126.0, 197.0, 188.0, -34.0, -130.0, -170.0, 0.0, -373.0, 177.0, -350.0, -17.0, -253.0, 0.0, -249.0, -154.0, 137.0, 182.0, 177.0, 200.0, 152.0, 180.0, -243.0, 88.0, 163.0, -65.0, 0.0, 62.0, -145.0, -143.0, -136.0, 43.0, 154.0], "policy_predator_policy_reward": [14.0, 86.0, 49.0, 73.0, 50.0, 5.0, 2.0, 30.0, 31.0, 127.0, 184.0, 179.0, 0.0, 0.0, 89.0, 23.0, 0.0, 9.0, 98.0, 4.0, 48.0, 91.0, 185.0, 154.0, 111.0, 20.0, 0.0, 0.0, 26.0, 84.0, 143.0, 162.0, 0.0, 104.0, 47.0, 45.0, 0.0, 0.0, 136.0, 162.0, 135.0, 41.0, 7.0, 7.0, 26.0, 134.0, 101.0, 56.0, 147.0, 175.0, 47.0, 39.0, 0.0, 9.0, 44.0, 11.0, 81.0, 15.0, 26.0, 37.0, 14.0, 0.0, 167.0, 153.0, 7.0, 7.0, 24.0, 155.0, 0.0, 29.0, 175.0, 64.0, 30.0, 19.0, 131.0, 146.0, 52.0, 55.0, 123.0, 187.0, 58.0, 146.0, 76.0, 73.0, 162.0, 29.0, 67.0, 74.0, 0.0, 42.0, 4.0, 126.0, 32.0, 12.0, 74.0, 0.0, 74.0, 142.0, 89.0, 25.0, 0.0, 0.0, 128.0, 96.0, 9.0, 0.0, 85.0, 106.0, 174.0, 65.0, 73.0, 1.0, 138.0, 124.0, 103.0, 50.0, 5.0, 0.0, 27.0, 7.0, 126.0, 33.0, 196.0, 192.0, 0.0, 0.0, 74.0, 85.0, 132.0, 127.0, 170.0, 19.0, 0.0, 72.0, 7.0, 18.0, 144.0, 40.0, 24.0, 29.0, 0.0, 0.0, 65.0, 92.0, 95.0, 77.0, 91.0, 172.0, 192.0, 63.0, 100.0, 116.0, 28.0, 0.0, 14.0, 177.0, 187.0, 19.0, 0.0, 0.0, 169.0, 9.0, 106.0, 120.0, 1.0, 13.0, 126.0, 151.0, 12.0, 3.0, 78.0, 0.0, 158.0, 19.0, 122.0, 174.0, 164.0, 18.0, 183.0, 0.0, 141.0, 11.0, 0.0, 118.0, 0.0, 0.0, 16.0, 10.0, 118.0, 111.0, 0.0, 0.0, 52.0, 55.0, 0.0, 116.0, 111.0, 94.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0496040727434037, "mean_inference_ms": 3.2986804415314634, "mean_action_processing_ms": 0.4789084862321767, "mean_env_wait_ms": 0.3780528908015425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005490899085998535, "StateBufferConnector_ms": 0.004099488258361816, "ViewRequirementAgentConnector_ms": 0.16987431049346924}, "num_episodes": 23, "episode_return_max": 378.0, "episode_return_min": -460.0, "episode_return_mean": 60.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.8567258686075, "num_env_steps_trained_throughput_per_sec": 323.8567258686075, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 13160.681, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13160.609, "sample_time_ms": 2305.657, "learn_time_ms": 10835.401, "learn_throughput": 369.16, "synch_weights_time_ms": 17.023}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "e1352_00002", "date": "2024-08-13_19-37-19", "timestamp": 1723592239, "time_this_iter_s": 12.411672830581665, "time_total_s": 2129.2848944664, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d41ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2129.2848944664, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 60.98888888888889, "ram_util_percent": 83.60555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1386096626835527, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 5.990587585439127, "policy_loss": -0.0020081633625542205, "vf_loss": 5.99216550166014, "vf_explained_var": 0.0017871911878939027, "kl": 0.010744247452927666, "entropy": 0.9255322374679424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.108276749382576, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 8.653789763728147, "policy_loss": 9.861901037828632e-05, "vf_loss": 8.653681577198089, "vf_explained_var": -0.08384728712379617, "kl": 0.011443986904658799, "entropy": 0.7361049157286447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -460.0, "episode_reward_mean": 54.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.735, "predator_policy": 69.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0, -4.0, -159.0, 239.0, -108.0, -16.0, -103.0, 130.0, 214.0, 302.0, 204.0, 267.0, 114.0, -48.0, 106.0, -295.0, 140.0, -195.0, 194.0, 199.0, 77.0, 116.0, -69.0, 157.0, -126.0, 63.0, 37.0, -89.0, 224.0, 91.0, -37.0, 112.0, 135.0, -271.0, 286.0, 3.0, -80.0, 55.0, -223.0, 63.0, 331.0, 229.0, 142.0, -194.0, 344.0, 66.0, -89.0, -120.0, 93.0, 258.0, 37.0, 233.0, 337.0, 72.0, 86.0, -181.0, -460.0, 34.0, 150.0, -181.0, -145.0, 179.0, -201.0, -128.0, 113.0, -244.0, 338.0, 232.0, -123.0, -77.0, 9.0, -87.0, -97.0, 101.0, 359.0, 378.0, 166.0, 251.0, 42.0, 33.0, -74.0, 227.0, 145.0, 86.0, -80.0, 185.0, -222.0, 167.0, 54.0, 58.0, 120.0, -27.0, -210.0, 11.0, 271.0, 165.0, -107.0, 204.0, 287.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [123.0, 68.0, 68.0, -370.0, -299.0, -36.0, 170.0, 55.0, 0.0, -268.0, -189.0, 16.0, -193.0, -232.0, -12.0, 56.0, 118.0, 87.0, 62.0, 185.0, -84.0, 192.0, 109.0, 95.0, 100.0, 0.0, -59.0, -309.0, 0.0, 92.0, -226.0, -248.0, 111.0, 0.0, -247.0, -187.0, 78.0, 67.0, 165.0, -243.0, -148.0, 118.0, 178.0, -372.0, -302.0, 29.0, 112.0, -104.0, -10.0, -307.0, -46.0, -32.0, 6.0, -11.0, -203.0, -16.0, 70.0, 110.0, -4.0, 21.0, -17.0, -236.0, 106.0, -108.0, 14.0, 121.0, -253.0, -242.0, 127.0, 150.0, -296.0, 108.0, -310.0, -9.0, -4.0, -15.0, -375.0, -110.0, 61.0, -151.0, 144.0, 182.0, 80.0, 115.0, -112.0, 95.0, -368.0, -214.0, 163.0, 181.0, -91.0, -2.0, -400.0, 52.0, -27.0, -282.0, -44.0, 65.0, 96.0, 137.0, -318.0, 171.0, 87.0, 93.0, 168.0, 169.0, -174.0, 89.0, 50.0, -136.0, -329.0, -115.0, -365.0, -350.0, -170.0, -12.0, -8.0, 130.0, -28.0, -344.0, -379.0, 28.0, 113.0, 66.0, -132.0, -247.0, -126.0, -228.0, 0.0, 99.0, -290.0, -231.0, 126.0, 197.0, 188.0, -34.0, -130.0, -170.0, 0.0, -373.0, 177.0, -350.0, -17.0, -253.0, 0.0, -249.0, -154.0, 137.0, 182.0, 177.0, 200.0, 152.0, 180.0, -243.0, 88.0, 163.0, -65.0, 0.0, 62.0, -145.0, -143.0, -136.0, 43.0, 154.0, 86.0, -22.0, 85.0, 0.0, -261.0, -1.0, 179.0, -345.0, -151.0, -379.0, 159.0, -2.0, -24.0, 13.0, 98.0, -238.0, -6.0, -25.0, -63.0, -103.0, -397.0, -190.0, 38.0, -334.0, 81.0, 178.0, 1.0, 147.0, -397.0, -52.0, 20.0, 123.0, 198.0, 89.0, 50.0, -182.0], "policy_predator_policy_reward": [0.0, 0.0, 136.0, 162.0, 135.0, 41.0, 7.0, 7.0, 26.0, 134.0, 101.0, 56.0, 147.0, 175.0, 47.0, 39.0, 0.0, 9.0, 44.0, 11.0, 81.0, 15.0, 26.0, 37.0, 14.0, 0.0, 167.0, 153.0, 7.0, 7.0, 24.0, 155.0, 0.0, 29.0, 175.0, 64.0, 30.0, 19.0, 131.0, 146.0, 52.0, 55.0, 123.0, 187.0, 58.0, 146.0, 76.0, 73.0, 162.0, 29.0, 67.0, 74.0, 0.0, 42.0, 4.0, 126.0, 32.0, 12.0, 74.0, 0.0, 74.0, 142.0, 89.0, 25.0, 0.0, 0.0, 128.0, 96.0, 9.0, 0.0, 85.0, 106.0, 174.0, 65.0, 73.0, 1.0, 138.0, 124.0, 103.0, 50.0, 5.0, 0.0, 27.0, 7.0, 126.0, 33.0, 196.0, 192.0, 0.0, 0.0, 74.0, 85.0, 132.0, 127.0, 170.0, 19.0, 0.0, 72.0, 7.0, 18.0, 144.0, 40.0, 24.0, 29.0, 0.0, 0.0, 65.0, 92.0, 95.0, 77.0, 91.0, 172.0, 192.0, 63.0, 100.0, 116.0, 28.0, 0.0, 14.0, 177.0, 187.0, 19.0, 0.0, 0.0, 169.0, 9.0, 106.0, 120.0, 1.0, 13.0, 126.0, 151.0, 12.0, 3.0, 78.0, 0.0, 158.0, 19.0, 122.0, 174.0, 164.0, 18.0, 183.0, 0.0, 141.0, 11.0, 0.0, 118.0, 0.0, 0.0, 16.0, 10.0, 118.0, 111.0, 0.0, 0.0, 52.0, 55.0, 0.0, 116.0, 111.0, 94.0, 30.0, 0.0, 8.0, 73.0, 1.0, 0.0, 124.0, 58.0, 182.0, 169.0, 184.0, 124.0, 2.0, 8.0, 57.0, 8.0, 116.0, 82.0, 60.0, 91.0, 138.0, 1.0, 178.0, 199.0, 153.0, 154.0, 5.0, 7.0, 3.0, 14.0, 142.0, 200.0, 10.0, 51.0, 0.0, 0.0, 5.0, 138.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0499736813126226, "mean_inference_ms": 3.2920353254192194, "mean_action_processing_ms": 0.47801568472836337, "mean_env_wait_ms": 0.3774499701227178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005399465560913086, "StateBufferConnector_ms": 0.004082679748535156, "ViewRequirementAgentConnector_ms": 0.14263010025024414}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -460.0, "episode_return_mean": 54.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.53894755823563, "num_env_steps_trained_throughput_per_sec": 280.53894755823563, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 12779.193, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12779.121, "sample_time_ms": 2198.323, "learn_time_ms": 10560.185, "learn_throughput": 378.781, "synch_weights_time_ms": 18.043}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "e1352_00002", "date": "2024-08-13_19-37-33", "timestamp": 1723592253, "time_this_iter_s": 14.310841083526611, "time_total_s": 2143.5957355499268, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2143.5957355499268, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 74.60999999999999, "ram_util_percent": 83.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7708433033770354, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 5.108422762628585, "policy_loss": -0.004045742522757599, "vf_loss": 5.1119983959450295, "vf_explained_var": 0.0052898013087176775, "kl": 0.011739538644178454, "entropy": 0.9402179195451988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.181586257143625, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 8.799516493428952, "policy_loss": 0.0001519235857471666, "vf_loss": 8.799356602613257, "vf_explained_var": 0.018736291751659737, "kl": 0.009548473421934899, "entropy": 0.7617455566686298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -460.0, "episode_reward_mean": 57.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -38.765, "predator_policy": 67.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194.0, 199.0, 77.0, 116.0, -69.0, 157.0, -126.0, 63.0, 37.0, -89.0, 224.0, 91.0, -37.0, 112.0, 135.0, -271.0, 286.0, 3.0, -80.0, 55.0, -223.0, 63.0, 331.0, 229.0, 142.0, -194.0, 344.0, 66.0, -89.0, -120.0, 93.0, 258.0, 37.0, 233.0, 337.0, 72.0, 86.0, -181.0, -460.0, 34.0, 150.0, -181.0, -145.0, 179.0, -201.0, -128.0, 113.0, -244.0, 338.0, 232.0, -123.0, -77.0, 9.0, -87.0, -97.0, 101.0, 359.0, 378.0, 166.0, 251.0, 42.0, 33.0, -74.0, 227.0, 145.0, 86.0, -80.0, 185.0, -222.0, 167.0, 54.0, 58.0, 120.0, -27.0, -210.0, 11.0, 271.0, 165.0, -107.0, 204.0, 287.0, 11.0, 139.0, 299.0, 86.0, 322.0, 263.0, -119.0, 157.0, -76.0, -449.0, 241.0, 176.0, -115.0, -63.0, 107.0, 43.0, 328.0, -261.0, 247.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [78.0, 67.0, 165.0, -243.0, -148.0, 118.0, 178.0, -372.0, -302.0, 29.0, 112.0, -104.0, -10.0, -307.0, -46.0, -32.0, 6.0, -11.0, -203.0, -16.0, 70.0, 110.0, -4.0, 21.0, -17.0, -236.0, 106.0, -108.0, 14.0, 121.0, -253.0, -242.0, 127.0, 150.0, -296.0, 108.0, -310.0, -9.0, -4.0, -15.0, -375.0, -110.0, 61.0, -151.0, 144.0, 182.0, 80.0, 115.0, -112.0, 95.0, -368.0, -214.0, 163.0, 181.0, -91.0, -2.0, -400.0, 52.0, -27.0, -282.0, -44.0, 65.0, 96.0, 137.0, -318.0, 171.0, 87.0, 93.0, 168.0, 169.0, -174.0, 89.0, 50.0, -136.0, -329.0, -115.0, -365.0, -350.0, -170.0, -12.0, -8.0, 130.0, -28.0, -344.0, -379.0, 28.0, 113.0, 66.0, -132.0, -247.0, -126.0, -228.0, 0.0, 99.0, -290.0, -231.0, 126.0, 197.0, 188.0, -34.0, -130.0, -170.0, 0.0, -373.0, 177.0, -350.0, -17.0, -253.0, 0.0, -249.0, -154.0, 137.0, 182.0, 177.0, 200.0, 152.0, 180.0, -243.0, 88.0, 163.0, -65.0, 0.0, 62.0, -145.0, -143.0, -136.0, 43.0, 154.0, 86.0, -22.0, 85.0, 0.0, -261.0, -1.0, 179.0, -345.0, -151.0, -379.0, 159.0, -2.0, -24.0, 13.0, 98.0, -238.0, -6.0, -25.0, -63.0, -103.0, -397.0, -190.0, 38.0, -334.0, 81.0, 178.0, 1.0, 147.0, -397.0, -52.0, 20.0, 123.0, 198.0, 89.0, 50.0, -182.0, -1.0, 35.0, 193.0, 56.0, 0.0, 29.0, 129.0, 192.0, 176.0, 80.0, -76.0, -128.0, 64.0, -37.0, -161.0, -225.0, -299.0, -384.0, 121.0, 80.0, 41.0, 58.0, -93.0, -301.0, -78.0, -136.0, 89.0, -90.0, 200.0, -330.0, 170.0, 140.0, -188.0, -231.0, 62.0, 185.0], "policy_predator_policy_reward": [30.0, 19.0, 131.0, 146.0, 52.0, 55.0, 123.0, 187.0, 58.0, 146.0, 76.0, 73.0, 162.0, 29.0, 67.0, 74.0, 0.0, 42.0, 4.0, 126.0, 32.0, 12.0, 74.0, 0.0, 74.0, 142.0, 89.0, 25.0, 0.0, 0.0, 128.0, 96.0, 9.0, 0.0, 85.0, 106.0, 174.0, 65.0, 73.0, 1.0, 138.0, 124.0, 103.0, 50.0, 5.0, 0.0, 27.0, 7.0, 126.0, 33.0, 196.0, 192.0, 0.0, 0.0, 74.0, 85.0, 132.0, 127.0, 170.0, 19.0, 0.0, 72.0, 7.0, 18.0, 144.0, 40.0, 24.0, 29.0, 0.0, 0.0, 65.0, 92.0, 95.0, 77.0, 91.0, 172.0, 192.0, 63.0, 100.0, 116.0, 28.0, 0.0, 14.0, 177.0, 187.0, 19.0, 0.0, 0.0, 169.0, 9.0, 106.0, 120.0, 1.0, 13.0, 126.0, 151.0, 12.0, 3.0, 78.0, 0.0, 158.0, 19.0, 122.0, 174.0, 164.0, 18.0, 183.0, 0.0, 141.0, 11.0, 0.0, 118.0, 0.0, 0.0, 16.0, 10.0, 118.0, 111.0, 0.0, 0.0, 52.0, 55.0, 0.0, 116.0, 111.0, 94.0, 30.0, 0.0, 8.0, 73.0, 1.0, 0.0, 124.0, 58.0, 182.0, 169.0, 184.0, 124.0, 2.0, 8.0, 57.0, 8.0, 116.0, 82.0, 60.0, 91.0, 138.0, 1.0, 178.0, 199.0, 153.0, 154.0, 5.0, 7.0, 3.0, 14.0, 142.0, 200.0, 10.0, 51.0, 0.0, 0.0, 5.0, 138.0, 0.0, 105.0, 21.0, 29.0, 56.0, 1.0, 1.0, 0.0, 0.0, 7.0, 82.0, 3.0, 39.0, 91.0, 131.0, 179.0, 169.0, 65.0, 40.0, 0.0, 74.0, 3.0, 181.0, 98.0, 120.0, 31.0, 102.0, 6.0, 172.0, 1.0, 18.0, 0.0, 0.0, 158.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0480982802976175, "mean_inference_ms": 3.2868835492937922, "mean_action_processing_ms": 0.47676478191962623, "mean_env_wait_ms": 0.37658011889493326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006853222846984863, "StateBufferConnector_ms": 0.004132866859436035, "ViewRequirementAgentConnector_ms": 0.15053391456604004}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -460.0, "episode_return_mean": 57.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.01687970528474, "num_env_steps_trained_throughput_per_sec": 332.01687970528474, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 12650.478, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12650.394, "sample_time_ms": 2215.631, "learn_time_ms": 10412.768, "learn_throughput": 384.144, "synch_weights_time_ms": 19.133}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "e1352_00002", "date": "2024-08-13_19-37-45", "timestamp": 1723592265, "time_this_iter_s": 12.080504655838013, "time_total_s": 2155.6762402057648, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2155.6762402057648, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 60.15882352941178, "ram_util_percent": 83.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6422323521482882, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 5.361097407719446, "policy_loss": -0.005106195282417709, "vf_loss": 5.36579839994037, "vf_explained_var": 0.0015052351371321099, "kl": 0.010118425232822944, "entropy": 0.9354485822417749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.443231086787726, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 0.00010000000000000003, "total_loss": 8.645325679627677, "policy_loss": 0.002663755579112423, "vf_loss": 8.642643096459606, "vf_explained_var": -0.010756956774090963, "kl": 0.022576459789761597, "entropy": 0.8215225127954332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -460.0, "episode_reward_mean": 69.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -28.675, "predator_policy": 63.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [331.0, 229.0, 142.0, -194.0, 344.0, 66.0, -89.0, -120.0, 93.0, 258.0, 37.0, 233.0, 337.0, 72.0, 86.0, -181.0, -460.0, 34.0, 150.0, -181.0, -145.0, 179.0, -201.0, -128.0, 113.0, -244.0, 338.0, 232.0, -123.0, -77.0, 9.0, -87.0, -97.0, 101.0, 359.0, 378.0, 166.0, 251.0, 42.0, 33.0, -74.0, 227.0, 145.0, 86.0, -80.0, 185.0, -222.0, 167.0, 54.0, 58.0, 120.0, -27.0, -210.0, 11.0, 271.0, 165.0, -107.0, 204.0, 287.0, 11.0, 139.0, 299.0, 86.0, 322.0, 263.0, -119.0, 157.0, -76.0, -449.0, 241.0, 176.0, -115.0, -63.0, 107.0, 43.0, 328.0, -261.0, 247.0, -140.0, 121.0, 131.0, -94.0, 287.0, 364.0, 357.0, 32.0, 195.0, 0.0, 12.0, 147.0, 111.0, -12.0, 331.0, 0.0, -167.0, 239.0, -61.0, 125.0, -37.0, 129.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [144.0, 182.0, 80.0, 115.0, -112.0, 95.0, -368.0, -214.0, 163.0, 181.0, -91.0, -2.0, -400.0, 52.0, -27.0, -282.0, -44.0, 65.0, 96.0, 137.0, -318.0, 171.0, 87.0, 93.0, 168.0, 169.0, -174.0, 89.0, 50.0, -136.0, -329.0, -115.0, -365.0, -350.0, -170.0, -12.0, -8.0, 130.0, -28.0, -344.0, -379.0, 28.0, 113.0, 66.0, -132.0, -247.0, -126.0, -228.0, 0.0, 99.0, -290.0, -231.0, 126.0, 197.0, 188.0, -34.0, -130.0, -170.0, 0.0, -373.0, 177.0, -350.0, -17.0, -253.0, 0.0, -249.0, -154.0, 137.0, 182.0, 177.0, 200.0, 152.0, 180.0, -243.0, 88.0, 163.0, -65.0, 0.0, 62.0, -145.0, -143.0, -136.0, 43.0, 154.0, 86.0, -22.0, 85.0, 0.0, -261.0, -1.0, 179.0, -345.0, -151.0, -379.0, 159.0, -2.0, -24.0, 13.0, 98.0, -238.0, -6.0, -25.0, -63.0, -103.0, -397.0, -190.0, 38.0, -334.0, 81.0, 178.0, 1.0, 147.0, -397.0, -52.0, 20.0, 123.0, 198.0, 89.0, 50.0, -182.0, -1.0, 35.0, 193.0, 56.0, 0.0, 29.0, 129.0, 192.0, 176.0, 80.0, -76.0, -128.0, 64.0, -37.0, -161.0, -225.0, -299.0, -384.0, 121.0, 80.0, 41.0, 58.0, -93.0, -301.0, -78.0, -136.0, 89.0, -90.0, 200.0, -330.0, 170.0, 140.0, -188.0, -231.0, 62.0, 185.0, -154.0, -302.0, 133.0, -30.0, 74.0, -4.0, -8.0, -224.0, 161.0, 113.0, 163.0, 189.0, 157.0, 177.0, -50.0, 0.0, 154.0, 21.0, 0.0, 0.0, -380.0, 70.0, 161.0, -58.0, 111.0, 0.0, -50.0, -106.0, 141.0, 184.0, 0.0, 0.0, -2.0, -382.0, 62.0, 166.0, -284.0, -49.0, -176.0, 148.0, -40.0, -182.0, -49.0, -120.0], "policy_predator_policy_reward": [5.0, 0.0, 27.0, 7.0, 126.0, 33.0, 196.0, 192.0, 0.0, 0.0, 74.0, 85.0, 132.0, 127.0, 170.0, 19.0, 0.0, 72.0, 7.0, 18.0, 144.0, 40.0, 24.0, 29.0, 0.0, 0.0, 65.0, 92.0, 95.0, 77.0, 91.0, 172.0, 192.0, 63.0, 100.0, 116.0, 28.0, 0.0, 14.0, 177.0, 187.0, 19.0, 0.0, 0.0, 169.0, 9.0, 106.0, 120.0, 1.0, 13.0, 126.0, 151.0, 12.0, 3.0, 78.0, 0.0, 158.0, 19.0, 122.0, 174.0, 164.0, 18.0, 183.0, 0.0, 141.0, 11.0, 0.0, 118.0, 0.0, 0.0, 16.0, 10.0, 118.0, 111.0, 0.0, 0.0, 52.0, 55.0, 0.0, 116.0, 111.0, 94.0, 30.0, 0.0, 8.0, 73.0, 1.0, 0.0, 124.0, 58.0, 182.0, 169.0, 184.0, 124.0, 2.0, 8.0, 57.0, 8.0, 116.0, 82.0, 60.0, 91.0, 138.0, 1.0, 178.0, 199.0, 153.0, 154.0, 5.0, 7.0, 3.0, 14.0, 142.0, 200.0, 10.0, 51.0, 0.0, 0.0, 5.0, 138.0, 0.0, 105.0, 21.0, 29.0, 56.0, 1.0, 1.0, 0.0, 0.0, 7.0, 82.0, 3.0, 39.0, 91.0, 131.0, 179.0, 169.0, 65.0, 40.0, 0.0, 74.0, 3.0, 181.0, 98.0, 120.0, 31.0, 102.0, 6.0, 172.0, 1.0, 18.0, 0.0, 0.0, 158.0, 0.0, 0.0, 191.0, 125.0, 9.0, 9.0, 12.0, 49.0, 0.0, 138.0, 3.0, 10.0, 0.0, 12.0, 21.0, 2.0, 48.0, 34.0, 10.0, 10.0, 0.0, 0.0, 177.0, 145.0, 2.0, 42.0, 0.0, 0.0, 46.0, 98.0, 2.0, 4.0, 0.0, 0.0, 163.0, 54.0, 0.0, 11.0, 134.0, 138.0, 124.0, 29.0, 80.0, 105.0, 167.0, 131.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0457629322925959, "mean_inference_ms": 3.280397733671387, "mean_action_processing_ms": 0.475197637634799, "mean_env_wait_ms": 0.3754658060334666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069724321365356445, "StateBufferConnector_ms": 0.004856705665588379, "ViewRequirementAgentConnector_ms": 0.15310704708099365}, "num_episodes": 22, "episode_return_max": 378.0, "episode_return_min": -460.0, "episode_return_mean": 69.52, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.36714338378886, "num_env_steps_trained_throughput_per_sec": 286.36714338378886, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 12823.394, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12823.309, "sample_time_ms": 2223.544, "learn_time_ms": 10576.405, "learn_throughput": 378.2, "synch_weights_time_ms": 19.617}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "e1352_00002", "date": "2024-08-13_19-38-00", "timestamp": 1723592280, "time_this_iter_s": 14.187634229660034, "time_total_s": 2169.863874435425, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2169.863874435425, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 69.75000000000001, "ram_util_percent": 83.31}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.626665529332779, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 5.554525975827818, "policy_loss": -0.0014381515416538432, "vf_loss": 5.555667377527429, "vf_explained_var": -0.0010381148921118843, "kl": 0.00741016226153026, "entropy": 0.9458568293581564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.986730096043736, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.691181935456695, "policy_loss": -0.001806244980691681, "vf_loss": 8.692969690302693, "vf_explained_var": -0.12023784584469266, "kl": 0.01475884801310836, "entropy": 0.7808627765960794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -449.0, "episode_reward_mean": 69.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -27.5, "predator_policy": 62.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, -181.0, -145.0, 179.0, -201.0, -128.0, 113.0, -244.0, 338.0, 232.0, -123.0, -77.0, 9.0, -87.0, -97.0, 101.0, 359.0, 378.0, 166.0, 251.0, 42.0, 33.0, -74.0, 227.0, 145.0, 86.0, -80.0, 185.0, -222.0, 167.0, 54.0, 58.0, 120.0, -27.0, -210.0, 11.0, 271.0, 165.0, -107.0, 204.0, 287.0, 11.0, 139.0, 299.0, 86.0, 322.0, 263.0, -119.0, 157.0, -76.0, -449.0, 241.0, 176.0, -115.0, -63.0, 107.0, 43.0, 328.0, -261.0, 247.0, -140.0, 121.0, 131.0, -94.0, 287.0, 364.0, 357.0, 32.0, 195.0, 0.0, 12.0, 147.0, 111.0, -12.0, 331.0, 0.0, -167.0, 239.0, -61.0, 125.0, -37.0, 129.0, 46.0, -80.0, -50.0, 254.0, 31.0, -32.0, 51.0, 19.0, 196.0, 118.0, 173.0, 87.0, 0.0, 345.0, -23.0, -49.0, 14.0, 162.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, 130.0, -28.0, -344.0, -379.0, 28.0, 113.0, 66.0, -132.0, -247.0, -126.0, -228.0, 0.0, 99.0, -290.0, -231.0, 126.0, 197.0, 188.0, -34.0, -130.0, -170.0, 0.0, -373.0, 177.0, -350.0, -17.0, -253.0, 0.0, -249.0, -154.0, 137.0, 182.0, 177.0, 200.0, 152.0, 180.0, -243.0, 88.0, 163.0, -65.0, 0.0, 62.0, -145.0, -143.0, -136.0, 43.0, 154.0, 86.0, -22.0, 85.0, 0.0, -261.0, -1.0, 179.0, -345.0, -151.0, -379.0, 159.0, -2.0, -24.0, 13.0, 98.0, -238.0, -6.0, -25.0, -63.0, -103.0, -397.0, -190.0, 38.0, -334.0, 81.0, 178.0, 1.0, 147.0, -397.0, -52.0, 20.0, 123.0, 198.0, 89.0, 50.0, -182.0, -1.0, 35.0, 193.0, 56.0, 0.0, 29.0, 129.0, 192.0, 176.0, 80.0, -76.0, -128.0, 64.0, -37.0, -161.0, -225.0, -299.0, -384.0, 121.0, 80.0, 41.0, 58.0, -93.0, -301.0, -78.0, -136.0, 89.0, -90.0, 200.0, -330.0, 170.0, 140.0, -188.0, -231.0, 62.0, 185.0, -154.0, -302.0, 133.0, -30.0, 74.0, -4.0, -8.0, -224.0, 161.0, 113.0, 163.0, 189.0, 157.0, 177.0, -50.0, 0.0, 154.0, 21.0, 0.0, 0.0, -380.0, 70.0, 161.0, -58.0, 111.0, 0.0, -50.0, -106.0, 141.0, 184.0, 0.0, 0.0, -2.0, -382.0, 62.0, 166.0, -284.0, -49.0, -176.0, 148.0, -40.0, -182.0, -49.0, -120.0, -155.0, 0.0, -268.0, 6.0, -179.0, -25.0, 117.0, 109.0, -305.0, -20.0, -60.0, -36.0, -220.0, 128.0, -189.0, 34.0, 146.0, -51.0, -26.0, -12.0, 151.0, -103.0, 130.0, -106.0, 0.0, 0.0, 140.0, 169.0, -119.0, 0.0, -264.0, 61.0, 0.0, 14.0, 194.0, -398.0], "policy_predator_policy_reward": [28.0, 0.0, 14.0, 177.0, 187.0, 19.0, 0.0, 0.0, 169.0, 9.0, 106.0, 120.0, 1.0, 13.0, 126.0, 151.0, 12.0, 3.0, 78.0, 0.0, 158.0, 19.0, 122.0, 174.0, 164.0, 18.0, 183.0, 0.0, 141.0, 11.0, 0.0, 118.0, 0.0, 0.0, 16.0, 10.0, 118.0, 111.0, 0.0, 0.0, 52.0, 55.0, 0.0, 116.0, 111.0, 94.0, 30.0, 0.0, 8.0, 73.0, 1.0, 0.0, 124.0, 58.0, 182.0, 169.0, 184.0, 124.0, 2.0, 8.0, 57.0, 8.0, 116.0, 82.0, 60.0, 91.0, 138.0, 1.0, 178.0, 199.0, 153.0, 154.0, 5.0, 7.0, 3.0, 14.0, 142.0, 200.0, 10.0, 51.0, 0.0, 0.0, 5.0, 138.0, 0.0, 105.0, 21.0, 29.0, 56.0, 1.0, 1.0, 0.0, 0.0, 7.0, 82.0, 3.0, 39.0, 91.0, 131.0, 179.0, 169.0, 65.0, 40.0, 0.0, 74.0, 3.0, 181.0, 98.0, 120.0, 31.0, 102.0, 6.0, 172.0, 1.0, 18.0, 0.0, 0.0, 158.0, 0.0, 0.0, 191.0, 125.0, 9.0, 9.0, 12.0, 49.0, 0.0, 138.0, 3.0, 10.0, 0.0, 12.0, 21.0, 2.0, 48.0, 34.0, 10.0, 10.0, 0.0, 0.0, 177.0, 145.0, 2.0, 42.0, 0.0, 0.0, 46.0, 98.0, 2.0, 4.0, 0.0, 0.0, 163.0, 54.0, 0.0, 11.0, 134.0, 138.0, 124.0, 29.0, 80.0, 105.0, 167.0, 131.0, 91.0, 110.0, 151.0, 31.0, 127.0, 27.0, 23.0, 5.0, 163.0, 193.0, 0.0, 64.0, 133.0, 10.0, 2.0, 172.0, 35.0, 66.0, 86.0, 70.0, 18.0, 107.0, 2.0, 61.0, 0.0, 0.0, 17.0, 19.0, 3.0, 93.0, 154.0, 0.0, 0.0, 0.0, 170.0, 196.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0455210438867644, "mean_inference_ms": 3.2793508895057357, "mean_action_processing_ms": 0.47446678779191237, "mean_env_wait_ms": 0.37524100749267225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006852626800537109, "StateBufferConnector_ms": 0.0045174360275268555, "ViewRequirementAgentConnector_ms": 0.16161584854125977}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -449.0, "episode_return_mean": 69.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.17510689975762, "num_env_steps_trained_throughput_per_sec": 250.17510689975762, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 13267.645, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13267.559, "sample_time_ms": 2402.765, "learn_time_ms": 10841.487, "learn_throughput": 368.953, "synch_weights_time_ms": 19.459}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "e1352_00002", "date": "2024-08-13_19-38-16", "timestamp": 1723592296, "time_this_iter_s": 16.007541179656982, "time_total_s": 2185.871415615082, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2185.871415615082, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 81.63333333333333, "ram_util_percent": 81.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7661471693840607, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 3.6610026288915565, "policy_loss": -0.0025418222775909476, "vf_loss": 3.6631590107761363, "vf_explained_var": 0.0018805471362260283, "kl": 0.009625312922974581, "entropy": 0.9221271581119961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.67906148774283, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.387972569591785, "policy_loss": 7.492424230332728e-05, "vf_loss": 8.387889783849161, "vf_explained_var": -0.26080322003869155, "kl": 0.0062845736071544785, "entropy": 0.9289703425276217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -449.0, "episode_reward_mean": 72.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -21.74, "predator_policy": 57.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.0, 145.0, 86.0, -80.0, 185.0, -222.0, 167.0, 54.0, 58.0, 120.0, -27.0, -210.0, 11.0, 271.0, 165.0, -107.0, 204.0, 287.0, 11.0, 139.0, 299.0, 86.0, 322.0, 263.0, -119.0, 157.0, -76.0, -449.0, 241.0, 176.0, -115.0, -63.0, 107.0, 43.0, 328.0, -261.0, 247.0, -140.0, 121.0, 131.0, -94.0, 287.0, 364.0, 357.0, 32.0, 195.0, 0.0, 12.0, 147.0, 111.0, -12.0, 331.0, 0.0, -167.0, 239.0, -61.0, 125.0, -37.0, 129.0, 46.0, -80.0, -50.0, 254.0, 31.0, -32.0, 51.0, 19.0, 196.0, 118.0, 173.0, 87.0, 0.0, 345.0, -23.0, -49.0, 14.0, 162.0, -115.0, -121.0, -25.0, -155.0, 168.0, 337.0, -51.0, 83.0, 15.0, 72.0, -14.0, 292.0, 70.0, -89.0, 370.0, 64.0, 132.0, -24.0, 7.0, 0.0, -9.0, 27.0, 186.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [43.0, 154.0, 86.0, -22.0, 85.0, 0.0, -261.0, -1.0, 179.0, -345.0, -151.0, -379.0, 159.0, -2.0, -24.0, 13.0, 98.0, -238.0, -6.0, -25.0, -63.0, -103.0, -397.0, -190.0, 38.0, -334.0, 81.0, 178.0, 1.0, 147.0, -397.0, -52.0, 20.0, 123.0, 198.0, 89.0, 50.0, -182.0, -1.0, 35.0, 193.0, 56.0, 0.0, 29.0, 129.0, 192.0, 176.0, 80.0, -76.0, -128.0, 64.0, -37.0, -161.0, -225.0, -299.0, -384.0, 121.0, 80.0, 41.0, 58.0, -93.0, -301.0, -78.0, -136.0, 89.0, -90.0, 200.0, -330.0, 170.0, 140.0, -188.0, -231.0, 62.0, 185.0, -154.0, -302.0, 133.0, -30.0, 74.0, -4.0, -8.0, -224.0, 161.0, 113.0, 163.0, 189.0, 157.0, 177.0, -50.0, 0.0, 154.0, 21.0, 0.0, 0.0, -380.0, 70.0, 161.0, -58.0, 111.0, 0.0, -50.0, -106.0, 141.0, 184.0, 0.0, 0.0, -2.0, -382.0, 62.0, 166.0, -284.0, -49.0, -176.0, 148.0, -40.0, -182.0, -49.0, -120.0, -155.0, 0.0, -268.0, 6.0, -179.0, -25.0, 117.0, 109.0, -305.0, -20.0, -60.0, -36.0, -220.0, 128.0, -189.0, 34.0, 146.0, -51.0, -26.0, -12.0, 151.0, -103.0, 130.0, -106.0, 0.0, 0.0, 140.0, 169.0, -119.0, 0.0, -264.0, 61.0, 0.0, 14.0, 194.0, -398.0, 0.0, -272.0, -117.0, -320.0, -32.0, -364.0, -324.0, 0.0, 0.0, 168.0, 184.0, 136.0, -107.0, 0.0, 0.0, 82.0, 0.0, -60.0, -309.0, 116.0, -28.0, 0.0, 108.0, 166.0, 0.0, 68.0, -7.0, -225.0, 177.0, 190.0, -32.0, 80.0, 123.0, -12.0, -87.0, -80.0, 0.0, 0.0, 0.0, 0.0, -277.0, 100.0, 1.0, 0.0, -51.0, 147.0], "policy_predator_policy_reward": [30.0, 0.0, 8.0, 73.0, 1.0, 0.0, 124.0, 58.0, 182.0, 169.0, 184.0, 124.0, 2.0, 8.0, 57.0, 8.0, 116.0, 82.0, 60.0, 91.0, 138.0, 1.0, 178.0, 199.0, 153.0, 154.0, 5.0, 7.0, 3.0, 14.0, 142.0, 200.0, 10.0, 51.0, 0.0, 0.0, 5.0, 138.0, 0.0, 105.0, 21.0, 29.0, 56.0, 1.0, 1.0, 0.0, 0.0, 7.0, 82.0, 3.0, 39.0, 91.0, 131.0, 179.0, 169.0, 65.0, 40.0, 0.0, 74.0, 3.0, 181.0, 98.0, 120.0, 31.0, 102.0, 6.0, 172.0, 1.0, 18.0, 0.0, 0.0, 158.0, 0.0, 0.0, 191.0, 125.0, 9.0, 9.0, 12.0, 49.0, 0.0, 138.0, 3.0, 10.0, 0.0, 12.0, 21.0, 2.0, 48.0, 34.0, 10.0, 10.0, 0.0, 0.0, 177.0, 145.0, 2.0, 42.0, 0.0, 0.0, 46.0, 98.0, 2.0, 4.0, 0.0, 0.0, 163.0, 54.0, 0.0, 11.0, 134.0, 138.0, 124.0, 29.0, 80.0, 105.0, 167.0, 131.0, 91.0, 110.0, 151.0, 31.0, 127.0, 27.0, 23.0, 5.0, 163.0, 193.0, 0.0, 64.0, 133.0, 10.0, 2.0, 172.0, 35.0, 66.0, 86.0, 70.0, 18.0, 107.0, 2.0, 61.0, 0.0, 0.0, 17.0, 19.0, 3.0, 93.0, 154.0, 0.0, 0.0, 0.0, 170.0, 196.0, 156.0, 1.0, 144.0, 172.0, 184.0, 187.0, 0.0, 169.0, 0.0, 0.0, 17.0, 0.0, 0.0, 56.0, 1.0, 0.0, 75.0, 0.0, 133.0, 132.0, 5.0, 9.0, 10.0, 8.0, 2.0, 0.0, 134.0, 9.0, 3.0, 0.0, 16.0, 0.0, 8.0, 13.0, 7.0, 136.0, 3.0, 4.0, 0.0, 0.0, 151.0, 17.0, 14.0, 12.0, 42.0, 48.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0449365084313713, "mean_inference_ms": 3.2773134126696335, "mean_action_processing_ms": 0.47360086221424874, "mean_env_wait_ms": 0.37487110944117596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006453275680541992, "StateBufferConnector_ms": 0.004522442817687988, "ViewRequirementAgentConnector_ms": 0.18719613552093506}, "num_episodes": 23, "episode_return_max": 370.0, "episode_return_min": -449.0, "episode_return_mean": 72.22, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.59837147370956, "num_env_steps_trained_throughput_per_sec": 335.59837147370956, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 13300.317, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13300.231, "sample_time_ms": 2405.677, "learn_time_ms": 10870.042, "learn_throughput": 367.984, "synch_weights_time_ms": 20.733}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "e1352_00002", "date": "2024-08-13_19-38-28", "timestamp": 1723592308, "time_this_iter_s": 11.92698884010315, "time_total_s": 2197.798404455185, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e68670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2197.798404455185, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 57.694117647058825, "ram_util_percent": 76.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9096883616513676, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 4.3964125071883835, "policy_loss": -0.0020921359203322225, "vf_loss": 4.398030020194079, "vf_explained_var": 0.009235766987321238, "kl": 0.011852064366084287, "entropy": 0.952539322237489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.65111115981662, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.13739735436818, "policy_loss": -2.041421005275672e-05, "vf_loss": 8.137410262778953, "vf_explained_var": 0.0010192387318484998, "kl": 0.005981884810941265, "entropy": 0.8523415402129845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -449.0, "episode_reward_mean": 76.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -14.27, "predator_policy": 52.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 139.0, 299.0, 86.0, 322.0, 263.0, -119.0, 157.0, -76.0, -449.0, 241.0, 176.0, -115.0, -63.0, 107.0, 43.0, 328.0, -261.0, 247.0, -140.0, 121.0, 131.0, -94.0, 287.0, 364.0, 357.0, 32.0, 195.0, 0.0, 12.0, 147.0, 111.0, -12.0, 331.0, 0.0, -167.0, 239.0, -61.0, 125.0, -37.0, 129.0, 46.0, -80.0, -50.0, 254.0, 31.0, -32.0, 51.0, 19.0, 196.0, 118.0, 173.0, 87.0, 0.0, 345.0, -23.0, -49.0, 14.0, 162.0, -115.0, -121.0, -25.0, -155.0, 168.0, 337.0, -51.0, 83.0, 15.0, 72.0, -14.0, 292.0, 70.0, -89.0, 370.0, 64.0, 132.0, -24.0, 7.0, 0.0, -9.0, 27.0, 186.0, -155.0, 25.0, 314.0, 217.0, -97.0, 73.0, -85.0, 0.0, 230.0, 154.0, 131.0, 167.0, 0.0, 272.0, -134.0, 265.0, 357.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [50.0, -182.0, -1.0, 35.0, 193.0, 56.0, 0.0, 29.0, 129.0, 192.0, 176.0, 80.0, -76.0, -128.0, 64.0, -37.0, -161.0, -225.0, -299.0, -384.0, 121.0, 80.0, 41.0, 58.0, -93.0, -301.0, -78.0, -136.0, 89.0, -90.0, 200.0, -330.0, 170.0, 140.0, -188.0, -231.0, 62.0, 185.0, -154.0, -302.0, 133.0, -30.0, 74.0, -4.0, -8.0, -224.0, 161.0, 113.0, 163.0, 189.0, 157.0, 177.0, -50.0, 0.0, 154.0, 21.0, 0.0, 0.0, -380.0, 70.0, 161.0, -58.0, 111.0, 0.0, -50.0, -106.0, 141.0, 184.0, 0.0, 0.0, -2.0, -382.0, 62.0, 166.0, -284.0, -49.0, -176.0, 148.0, -40.0, -182.0, -49.0, -120.0, -155.0, 0.0, -268.0, 6.0, -179.0, -25.0, 117.0, 109.0, -305.0, -20.0, -60.0, -36.0, -220.0, 128.0, -189.0, 34.0, 146.0, -51.0, -26.0, -12.0, 151.0, -103.0, 130.0, -106.0, 0.0, 0.0, 140.0, 169.0, -119.0, 0.0, -264.0, 61.0, 0.0, 14.0, 194.0, -398.0, 0.0, -272.0, -117.0, -320.0, -32.0, -364.0, -324.0, 0.0, 0.0, 168.0, 184.0, 136.0, -107.0, 0.0, 0.0, 82.0, 0.0, -60.0, -309.0, 116.0, -28.0, 0.0, 108.0, 166.0, 0.0, 68.0, -7.0, -225.0, 177.0, 190.0, -32.0, 80.0, 123.0, -12.0, -87.0, -80.0, 0.0, 0.0, 0.0, 0.0, -277.0, 100.0, 1.0, 0.0, -51.0, 147.0, -71.0, -348.0, -292.0, 151.0, 170.0, 125.0, 167.0, -19.0, -66.0, -76.0, 184.0, -286.0, -2.0, -395.0, 0.0, 0.0, 29.0, 120.0, -32.0, 159.0, -66.0, 145.0, 167.0, 0.0, 0.0, 0.0, 108.0, 142.0, -92.0, -98.0, 158.0, 95.0, 180.0, 166.0, -261.0, 34.0], "policy_predator_policy_reward": [5.0, 138.0, 0.0, 105.0, 21.0, 29.0, 56.0, 1.0, 1.0, 0.0, 0.0, 7.0, 82.0, 3.0, 39.0, 91.0, 131.0, 179.0, 169.0, 65.0, 40.0, 0.0, 74.0, 3.0, 181.0, 98.0, 120.0, 31.0, 102.0, 6.0, 172.0, 1.0, 18.0, 0.0, 0.0, 158.0, 0.0, 0.0, 191.0, 125.0, 9.0, 9.0, 12.0, 49.0, 0.0, 138.0, 3.0, 10.0, 0.0, 12.0, 21.0, 2.0, 48.0, 34.0, 10.0, 10.0, 0.0, 0.0, 177.0, 145.0, 2.0, 42.0, 0.0, 0.0, 46.0, 98.0, 2.0, 4.0, 0.0, 0.0, 163.0, 54.0, 0.0, 11.0, 134.0, 138.0, 124.0, 29.0, 80.0, 105.0, 167.0, 131.0, 91.0, 110.0, 151.0, 31.0, 127.0, 27.0, 23.0, 5.0, 163.0, 193.0, 0.0, 64.0, 133.0, 10.0, 2.0, 172.0, 35.0, 66.0, 86.0, 70.0, 18.0, 107.0, 2.0, 61.0, 0.0, 0.0, 17.0, 19.0, 3.0, 93.0, 154.0, 0.0, 0.0, 0.0, 170.0, 196.0, 156.0, 1.0, 144.0, 172.0, 184.0, 187.0, 0.0, 169.0, 0.0, 0.0, 17.0, 0.0, 0.0, 56.0, 1.0, 0.0, 75.0, 0.0, 133.0, 132.0, 5.0, 9.0, 10.0, 8.0, 2.0, 0.0, 134.0, 9.0, 3.0, 0.0, 16.0, 0.0, 8.0, 13.0, 7.0, 136.0, 3.0, 4.0, 0.0, 0.0, 151.0, 17.0, 14.0, 12.0, 42.0, 48.0, 154.0, 110.0, 159.0, 7.0, 16.0, 3.0, 68.0, 1.0, 45.0, 0.0, 128.0, 47.0, 126.0, 186.0, 0.0, 0.0, 54.0, 27.0, 17.0, 10.0, 1.0, 51.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 56.0, 0.0, 0.0, 12.0, 5.0, 6.0, 94.0, 129.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0443911611688879, "mean_inference_ms": 3.2758133088047954, "mean_action_processing_ms": 0.4728500766607069, "mean_env_wait_ms": 0.37463481831392387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006843686103820801, "StateBufferConnector_ms": 0.004538059234619141, "ViewRequirementAgentConnector_ms": 0.1969548463821411}, "num_episodes": 18, "episode_return_max": 370.0, "episode_return_min": -449.0, "episode_return_mean": 76.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.3262637903789, "num_env_steps_trained_throughput_per_sec": 317.3262637903789, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 13083.21, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13083.12, "sample_time_ms": 2283.876, "learn_time_ms": 10777.296, "learn_throughput": 371.151, "synch_weights_time_ms": 18.747}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "e1352_00002", "date": "2024-08-13_19-38-40", "timestamp": 1723592320, "time_this_iter_s": 12.624917030334473, "time_total_s": 2210.4233214855194, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2cf5160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2210.4233214855194, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 62.03888888888888, "ram_util_percent": 76.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1220047949010103, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 0.00010000000000000003, "total_loss": 4.6671356955533305, "policy_loss": -0.007434227992287743, "vf_loss": 4.673386585901654, "vf_explained_var": 0.0031656360500073306, "kl": 0.029550214041286958, "entropy": 0.9710101973127436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69.21183780122686, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.632783784815874, "policy_loss": -0.00038639894248080004, "vf_loss": 8.633163702677166, "vf_explained_var": -0.24198433671678815, "kl": 0.005193247738781298, "entropy": 0.8874054523687515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -311.0, "episode_reward_mean": 66.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -20.115, "predator_policy": 53.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.0, 287.0, 364.0, 357.0, 32.0, 195.0, 0.0, 12.0, 147.0, 111.0, -12.0, 331.0, 0.0, -167.0, 239.0, -61.0, 125.0, -37.0, 129.0, 46.0, -80.0, -50.0, 254.0, 31.0, -32.0, 51.0, 19.0, 196.0, 118.0, 173.0, 87.0, 0.0, 345.0, -23.0, -49.0, 14.0, 162.0, -115.0, -121.0, -25.0, -155.0, 168.0, 337.0, -51.0, 83.0, 15.0, 72.0, -14.0, 292.0, 70.0, -89.0, 370.0, 64.0, 132.0, -24.0, 7.0, 0.0, -9.0, 27.0, 186.0, -155.0, 25.0, 314.0, 217.0, -97.0, 73.0, -85.0, 0.0, 230.0, 154.0, 131.0, 167.0, 0.0, 272.0, -134.0, 265.0, 357.0, -4.0, -128.0, -41.0, 84.0, 6.0, 198.0, -12.0, 59.0, -272.0, -154.0, 163.0, -34.0, 9.0, 245.0, 190.0, 9.0, 305.0, 164.0, -15.0, -311.0, 14.0, 27.0, -72.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, -224.0, 161.0, 113.0, 163.0, 189.0, 157.0, 177.0, -50.0, 0.0, 154.0, 21.0, 0.0, 0.0, -380.0, 70.0, 161.0, -58.0, 111.0, 0.0, -50.0, -106.0, 141.0, 184.0, 0.0, 0.0, -2.0, -382.0, 62.0, 166.0, -284.0, -49.0, -176.0, 148.0, -40.0, -182.0, -49.0, -120.0, -155.0, 0.0, -268.0, 6.0, -179.0, -25.0, 117.0, 109.0, -305.0, -20.0, -60.0, -36.0, -220.0, 128.0, -189.0, 34.0, 146.0, -51.0, -26.0, -12.0, 151.0, -103.0, 130.0, -106.0, 0.0, 0.0, 140.0, 169.0, -119.0, 0.0, -264.0, 61.0, 0.0, 14.0, 194.0, -398.0, 0.0, -272.0, -117.0, -320.0, -32.0, -364.0, -324.0, 0.0, 0.0, 168.0, 184.0, 136.0, -107.0, 0.0, 0.0, 82.0, 0.0, -60.0, -309.0, 116.0, -28.0, 0.0, 108.0, 166.0, 0.0, 68.0, -7.0, -225.0, 177.0, 190.0, -32.0, 80.0, 123.0, -12.0, -87.0, -80.0, 0.0, 0.0, 0.0, 0.0, -277.0, 100.0, 1.0, 0.0, -51.0, 147.0, -71.0, -348.0, -292.0, 151.0, 170.0, 125.0, 167.0, -19.0, -66.0, -76.0, 184.0, -286.0, -2.0, -395.0, 0.0, 0.0, 29.0, 120.0, -32.0, 159.0, -66.0, 145.0, 167.0, 0.0, 0.0, 0.0, 108.0, 142.0, -92.0, -98.0, 158.0, 95.0, 180.0, 166.0, -261.0, 34.0, -52.0, -388.0, -179.0, -21.0, 9.0, 45.0, -179.0, 55.0, 119.0, 49.0, -24.0, 0.0, -392.0, 91.0, -287.0, -337.0, -80.0, -260.0, 153.0, 0.0, -42.0, -14.0, 9.0, 0.0, 140.0, 97.0, 25.0, 165.0, -38.0, -32.0, 176.0, 105.0, 151.0, 0.0, -374.0, 12.0, -328.0, -177.0, 20.0, -79.0, 51.0, -228.0, 20.0, -223.0], "policy_predator_policy_reward": [0.0, 138.0, 3.0, 10.0, 0.0, 12.0, 21.0, 2.0, 48.0, 34.0, 10.0, 10.0, 0.0, 0.0, 177.0, 145.0, 2.0, 42.0, 0.0, 0.0, 46.0, 98.0, 2.0, 4.0, 0.0, 0.0, 163.0, 54.0, 0.0, 11.0, 134.0, 138.0, 124.0, 29.0, 80.0, 105.0, 167.0, 131.0, 91.0, 110.0, 151.0, 31.0, 127.0, 27.0, 23.0, 5.0, 163.0, 193.0, 0.0, 64.0, 133.0, 10.0, 2.0, 172.0, 35.0, 66.0, 86.0, 70.0, 18.0, 107.0, 2.0, 61.0, 0.0, 0.0, 17.0, 19.0, 3.0, 93.0, 154.0, 0.0, 0.0, 0.0, 170.0, 196.0, 156.0, 1.0, 144.0, 172.0, 184.0, 187.0, 0.0, 169.0, 0.0, 0.0, 17.0, 0.0, 0.0, 56.0, 1.0, 0.0, 75.0, 0.0, 133.0, 132.0, 5.0, 9.0, 10.0, 8.0, 2.0, 0.0, 134.0, 9.0, 3.0, 0.0, 16.0, 0.0, 8.0, 13.0, 7.0, 136.0, 3.0, 4.0, 0.0, 0.0, 151.0, 17.0, 14.0, 12.0, 42.0, 48.0, 154.0, 110.0, 159.0, 7.0, 16.0, 3.0, 68.0, 1.0, 45.0, 0.0, 128.0, 47.0, 126.0, 186.0, 0.0, 0.0, 54.0, 27.0, 17.0, 10.0, 1.0, 51.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 56.0, 0.0, 0.0, 12.0, 5.0, 6.0, 94.0, 129.0, 156.0, 156.0, 80.0, 79.0, 1.0, 29.0, 120.0, 10.0, 9.0, 21.0, 0.0, 12.0, 193.0, 167.0, 175.0, 177.0, 177.0, 9.0, 6.0, 4.0, 0.0, 22.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 18.0, 61.0, 9.0, 15.0, 0.0, 13.0, 162.0, 185.0, 179.0, 15.0, 17.0, 56.0, 118.0, 86.0, 131.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0431820018242268, "mean_inference_ms": 3.269726645585209, "mean_action_processing_ms": 0.4717747013769797, "mean_env_wait_ms": 0.3744087816438094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005793571472167969, "StateBufferConnector_ms": 0.006734490394592285, "ViewRequirementAgentConnector_ms": 0.18319451808929443}, "num_episodes": 22, "episode_return_max": 370.0, "episode_return_min": -311.0, "episode_return_mean": 66.04, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.4808365997237, "num_env_steps_trained_throughput_per_sec": 325.4808365997237, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 12900.56, "restore_workers_time_ms": 0.019, "training_step_time_ms": 12900.47, "sample_time_ms": 2103.151, "learn_time_ms": 10775.328, "learn_throughput": 371.218, "synch_weights_time_ms": 18.755}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "e1352_00002", "date": "2024-08-13_19-38-53", "timestamp": 1723592333, "time_this_iter_s": 12.336185216903687, "time_total_s": 2222.759506702423, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2db8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2222.759506702423, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 64.35882352941177, "ram_util_percent": 76.97058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2298845680302413, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 5.747108933534571, "policy_loss": -0.0031973091405003316, "vf_loss": 5.749664146685727, "vf_explained_var": -0.006840789412695264, "kl": 0.010689449357486768, "entropy": 0.9904024304851653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.00143332295318, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.289169282004947, "policy_loss": -0.002016698272662267, "vf_loss": 8.291174008858897, "vf_explained_var": -0.2721521821286943, "kl": 0.009563889899622719, "entropy": 0.8970709695702508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -311.0, "episode_reward_mean": 52.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -28.125, "predator_policy": 54.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.0, 46.0, -80.0, -50.0, 254.0, 31.0, -32.0, 51.0, 19.0, 196.0, 118.0, 173.0, 87.0, 0.0, 345.0, -23.0, -49.0, 14.0, 162.0, -115.0, -121.0, -25.0, -155.0, 168.0, 337.0, -51.0, 83.0, 15.0, 72.0, -14.0, 292.0, 70.0, -89.0, 370.0, 64.0, 132.0, -24.0, 7.0, 0.0, -9.0, 27.0, 186.0, -155.0, 25.0, 314.0, 217.0, -97.0, 73.0, -85.0, 0.0, 230.0, 154.0, 131.0, 167.0, 0.0, 272.0, -134.0, 265.0, 357.0, -4.0, -128.0, -41.0, 84.0, 6.0, 198.0, -12.0, 59.0, -272.0, -154.0, 163.0, -34.0, 9.0, 245.0, 190.0, 9.0, 305.0, 164.0, -15.0, -311.0, 14.0, 27.0, -72.0, 94.0, 39.0, 107.0, 181.0, -64.0, -96.0, 148.0, 60.0, -8.0, -24.0, 31.0, 21.0, 4.0, 94.0, -119.0, 81.0, 57.0, -154.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-49.0, -120.0, -155.0, 0.0, -268.0, 6.0, -179.0, -25.0, 117.0, 109.0, -305.0, -20.0, -60.0, -36.0, -220.0, 128.0, -189.0, 34.0, 146.0, -51.0, -26.0, -12.0, 151.0, -103.0, 130.0, -106.0, 0.0, 0.0, 140.0, 169.0, -119.0, 0.0, -264.0, 61.0, 0.0, 14.0, 194.0, -398.0, 0.0, -272.0, -117.0, -320.0, -32.0, -364.0, -324.0, 0.0, 0.0, 168.0, 184.0, 136.0, -107.0, 0.0, 0.0, 82.0, 0.0, -60.0, -309.0, 116.0, -28.0, 0.0, 108.0, 166.0, 0.0, 68.0, -7.0, -225.0, 177.0, 190.0, -32.0, 80.0, 123.0, -12.0, -87.0, -80.0, 0.0, 0.0, 0.0, 0.0, -277.0, 100.0, 1.0, 0.0, -51.0, 147.0, -71.0, -348.0, -292.0, 151.0, 170.0, 125.0, 167.0, -19.0, -66.0, -76.0, 184.0, -286.0, -2.0, -395.0, 0.0, 0.0, 29.0, 120.0, -32.0, 159.0, -66.0, 145.0, 167.0, 0.0, 0.0, 0.0, 108.0, 142.0, -92.0, -98.0, 158.0, 95.0, 180.0, 166.0, -261.0, 34.0, -52.0, -388.0, -179.0, -21.0, 9.0, 45.0, -179.0, 55.0, 119.0, 49.0, -24.0, 0.0, -392.0, 91.0, -287.0, -337.0, -80.0, -260.0, 153.0, 0.0, -42.0, -14.0, 9.0, 0.0, 140.0, 97.0, 25.0, 165.0, -38.0, -32.0, 176.0, 105.0, 151.0, 0.0, -374.0, 12.0, -328.0, -177.0, 20.0, -79.0, 51.0, -228.0, 20.0, -223.0, 48.0, 0.0, 0.0, -6.0, -24.0, 9.0, 33.0, 78.0, -239.0, -41.0, -26.0, -312.0, -14.0, 144.0, 0.0, 43.0, -35.0, 0.0, 6.0, -118.0, -74.0, -26.0, -20.0, -53.0, 0.0, -14.0, -187.0, 123.0, 45.0, -350.0, 40.0, 0.0, 0.0, -11.0, -34.0, -400.0], "policy_predator_policy_reward": [167.0, 131.0, 91.0, 110.0, 151.0, 31.0, 127.0, 27.0, 23.0, 5.0, 163.0, 193.0, 0.0, 64.0, 133.0, 10.0, 2.0, 172.0, 35.0, 66.0, 86.0, 70.0, 18.0, 107.0, 2.0, 61.0, 0.0, 0.0, 17.0, 19.0, 3.0, 93.0, 154.0, 0.0, 0.0, 0.0, 170.0, 196.0, 156.0, 1.0, 144.0, 172.0, 184.0, 187.0, 0.0, 169.0, 0.0, 0.0, 17.0, 0.0, 0.0, 56.0, 1.0, 0.0, 75.0, 0.0, 133.0, 132.0, 5.0, 9.0, 10.0, 8.0, 2.0, 0.0, 134.0, 9.0, 3.0, 0.0, 16.0, 0.0, 8.0, 13.0, 7.0, 136.0, 3.0, 4.0, 0.0, 0.0, 151.0, 17.0, 14.0, 12.0, 42.0, 48.0, 154.0, 110.0, 159.0, 7.0, 16.0, 3.0, 68.0, 1.0, 45.0, 0.0, 128.0, 47.0, 126.0, 186.0, 0.0, 0.0, 54.0, 27.0, 17.0, 10.0, 1.0, 51.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 56.0, 0.0, 0.0, 12.0, 5.0, 6.0, 94.0, 129.0, 156.0, 156.0, 80.0, 79.0, 1.0, 29.0, 120.0, 10.0, 9.0, 21.0, 0.0, 12.0, 193.0, 167.0, 175.0, 177.0, 177.0, 9.0, 6.0, 4.0, 0.0, 22.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 18.0, 61.0, 9.0, 15.0, 0.0, 13.0, 162.0, 185.0, 179.0, 15.0, 17.0, 56.0, 118.0, 86.0, 131.0, 0.0, 31.0, 15.0, 30.0, 15.0, 58.0, 64.0, 15.0, 55.0, 113.0, 103.0, 157.0, 85.0, 7.0, 11.0, 0.0, 17.0, 0.0, 27.0, 88.0, 0.0, 36.0, 95.0, 81.0, 13.0, 0.0, 18.0, 66.0, 92.0, 167.0, 19.0, 36.0, 5.0, 14.0, 54.0, 83.0, 197.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0427205829230313, "mean_inference_ms": 3.2708369383938494, "mean_action_processing_ms": 0.4709494452061053, "mean_env_wait_ms": 0.3739364565451884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006425142288208008, "StateBufferConnector_ms": 0.0069893598556518555, "ViewRequirementAgentConnector_ms": 0.18582308292388916}, "num_episodes": 18, "episode_return_max": 370.0, "episode_return_min": -311.0, "episode_return_mean": 52.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.25895067053756, "num_env_steps_trained_throughput_per_sec": 305.25895067053756, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 13044.806, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13044.737, "sample_time_ms": 2150.948, "learn_time_ms": 10872.058, "learn_throughput": 367.916, "synch_weights_time_ms": 18.781}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "e1352_00002", "date": "2024-08-13_19-39-06", "timestamp": 1723592346, "time_this_iter_s": 13.145562887191772, "time_total_s": 2235.905069589615, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d130d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2235.905069589615, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 67.85789473684211, "ram_util_percent": 77.3157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0092456658681233, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 7.542898316105838, "policy_loss": -0.0005530371118790258, "vf_loss": 7.542830472270017, "vf_explained_var": -0.011506031146125188, "kl": 0.010336060527134053, "entropy": 0.8826225477236288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.19313325238606, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.517241929321692, "policy_loss": -0.0017082715848037017, "vf_loss": 8.518933171317691, "vf_explained_var": -0.501006193829592, "kl": 0.013617997778164288, "entropy": 0.8601687756480363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 370.0, "episode_reward_min": -345.0, "episode_reward_mean": 35.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -34.255, "predator_policy": 52.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.0, 337.0, -51.0, 83.0, 15.0, 72.0, -14.0, 292.0, 70.0, -89.0, 370.0, 64.0, 132.0, -24.0, 7.0, 0.0, -9.0, 27.0, 186.0, -155.0, 25.0, 314.0, 217.0, -97.0, 73.0, -85.0, 0.0, 230.0, 154.0, 131.0, 167.0, 0.0, 272.0, -134.0, 265.0, 357.0, -4.0, -128.0, -41.0, 84.0, 6.0, 198.0, -12.0, 59.0, -272.0, -154.0, 163.0, -34.0, 9.0, 245.0, 190.0, 9.0, 305.0, 164.0, -15.0, -311.0, 14.0, 27.0, -72.0, 94.0, 39.0, 107.0, 181.0, -64.0, -96.0, 148.0, 60.0, -8.0, -24.0, 31.0, 21.0, 4.0, 94.0, -119.0, 81.0, 57.0, -154.0, -5.0, -96.0, -96.0, 60.0, 177.0, -209.0, 31.0, 127.0, -103.0, -237.0, -298.0, 292.0, 103.0, -122.0, 77.0, -138.0, -345.0, -1.0, -30.0, 57.0, 141.0, -69.0, -18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 168.0, 184.0, 136.0, -107.0, 0.0, 0.0, 82.0, 0.0, -60.0, -309.0, 116.0, -28.0, 0.0, 108.0, 166.0, 0.0, 68.0, -7.0, -225.0, 177.0, 190.0, -32.0, 80.0, 123.0, -12.0, -87.0, -80.0, 0.0, 0.0, 0.0, 0.0, -277.0, 100.0, 1.0, 0.0, -51.0, 147.0, -71.0, -348.0, -292.0, 151.0, 170.0, 125.0, 167.0, -19.0, -66.0, -76.0, 184.0, -286.0, -2.0, -395.0, 0.0, 0.0, 29.0, 120.0, -32.0, 159.0, -66.0, 145.0, 167.0, 0.0, 0.0, 0.0, 108.0, 142.0, -92.0, -98.0, 158.0, 95.0, 180.0, 166.0, -261.0, 34.0, -52.0, -388.0, -179.0, -21.0, 9.0, 45.0, -179.0, 55.0, 119.0, 49.0, -24.0, 0.0, -392.0, 91.0, -287.0, -337.0, -80.0, -260.0, 153.0, 0.0, -42.0, -14.0, 9.0, 0.0, 140.0, 97.0, 25.0, 165.0, -38.0, -32.0, 176.0, 105.0, 151.0, 0.0, -374.0, 12.0, -328.0, -177.0, 20.0, -79.0, 51.0, -228.0, 20.0, -223.0, 48.0, 0.0, 0.0, -6.0, -24.0, 9.0, 33.0, 78.0, -239.0, -41.0, -26.0, -312.0, -14.0, 144.0, 0.0, 43.0, -35.0, 0.0, 6.0, -118.0, -74.0, -26.0, -20.0, -53.0, 0.0, -14.0, -187.0, 123.0, 45.0, -350.0, 40.0, 0.0, 0.0, -11.0, -34.0, -400.0, -15.0, -132.0, 0.0, -246.0, -181.0, -75.0, 0.0, -46.0, -45.0, 89.0, -301.0, -219.0, -158.0, 19.0, 12.0, 105.0, 0.0, -400.0, -233.0, -185.0, -360.0, -229.0, 142.0, 134.0, 51.0, -11.0, 7.0, -376.0, 0.0, 49.0, -321.0, 0.0, -350.0, -269.0, 0.0, -2.0, 0.0, -70.0, -63.0, 17.0, -40.0, 95.0, -63.0, -174.0, -18.0, -99.0], "policy_predator_policy_reward": [0.0, 0.0, 17.0, 0.0, 0.0, 56.0, 1.0, 0.0, 75.0, 0.0, 133.0, 132.0, 5.0, 9.0, 10.0, 8.0, 2.0, 0.0, 134.0, 9.0, 3.0, 0.0, 16.0, 0.0, 8.0, 13.0, 7.0, 136.0, 3.0, 4.0, 0.0, 0.0, 151.0, 17.0, 14.0, 12.0, 42.0, 48.0, 154.0, 110.0, 159.0, 7.0, 16.0, 3.0, 68.0, 1.0, 45.0, 0.0, 128.0, 47.0, 126.0, 186.0, 0.0, 0.0, 54.0, 27.0, 17.0, 10.0, 1.0, 51.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 56.0, 0.0, 0.0, 12.0, 5.0, 6.0, 94.0, 129.0, 156.0, 156.0, 80.0, 79.0, 1.0, 29.0, 120.0, 10.0, 9.0, 21.0, 0.0, 12.0, 193.0, 167.0, 175.0, 177.0, 177.0, 9.0, 6.0, 4.0, 0.0, 22.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 18.0, 61.0, 9.0, 15.0, 0.0, 13.0, 162.0, 185.0, 179.0, 15.0, 17.0, 56.0, 118.0, 86.0, 131.0, 0.0, 31.0, 15.0, 30.0, 15.0, 58.0, 64.0, 15.0, 55.0, 113.0, 103.0, 157.0, 85.0, 7.0, 11.0, 0.0, 17.0, 0.0, 27.0, 88.0, 0.0, 36.0, 95.0, 81.0, 13.0, 0.0, 18.0, 66.0, 92.0, 167.0, 19.0, 36.0, 5.0, 14.0, 54.0, 83.0, 197.0, 124.0, 18.0, 96.0, 54.0, 106.0, 54.0, 57.0, 49.0, 67.0, 66.0, 148.0, 163.0, 56.0, 114.0, 9.0, 1.0, 97.0, 200.0, 13.0, 168.0, 111.0, 180.0, 5.0, 11.0, 48.0, 15.0, 53.0, 194.0, 28.0, 0.0, 167.0, 16.0, 182.0, 92.0, 1.0, 0.0, 13.0, 27.0, 79.0, 24.0, 46.0, 40.0, 75.0, 93.0, 23.0, 76.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0391882212490922, "mean_inference_ms": 3.270222758781279, "mean_action_processing_ms": 0.4696581763163055, "mean_env_wait_ms": 0.37317362171236307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010677933692932129, "StateBufferConnector_ms": 0.00688934326171875, "ViewRequirementAgentConnector_ms": 0.17960405349731445}, "num_episodes": 23, "episode_return_max": 370.0, "episode_return_min": -345.0, "episode_return_mean": 35.5, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.9121928673913, "num_env_steps_trained_throughput_per_sec": 254.9121928673913, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 13422.31, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13422.25, "sample_time_ms": 2201.888, "learn_time_ms": 11198.02, "learn_throughput": 357.206, "synch_weights_time_ms": 18.745}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "e1352_00002", "date": "2024-08-13_19-39-22", "timestamp": 1723592362, "time_this_iter_s": 15.774235010147095, "time_total_s": 2251.679304599762, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e7c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2251.679304599762, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 90.23636363636363, "ram_util_percent": 82.74090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.177231510590624, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 0.00010000000000000003, "total_loss": 6.846078627197831, "policy_loss": 6.775918919297438e-05, "vf_loss": 6.845745994678881, "vf_explained_var": -0.005367960847874798, "kl": 0.004409675862431324, "entropy": 0.9429384497738389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 79.42505250393398, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 7.904281681302994, "policy_loss": 0.0018877376275008948, "vf_loss": 7.902378134500413, "vf_explained_var": -0.6989765607490741, "kl": 0.012634657582626945, "entropy": 0.9717167983925532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 357.0, "episode_reward_min": -352.0, "episode_reward_mean": 5.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -59.57, "predator_policy": 62.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [186.0, -155.0, 25.0, 314.0, 217.0, -97.0, 73.0, -85.0, 0.0, 230.0, 154.0, 131.0, 167.0, 0.0, 272.0, -134.0, 265.0, 357.0, -4.0, -128.0, -41.0, 84.0, 6.0, 198.0, -12.0, 59.0, -272.0, -154.0, 163.0, -34.0, 9.0, 245.0, 190.0, 9.0, 305.0, 164.0, -15.0, -311.0, 14.0, 27.0, -72.0, 94.0, 39.0, 107.0, 181.0, -64.0, -96.0, 148.0, 60.0, -8.0, -24.0, 31.0, 21.0, 4.0, 94.0, -119.0, 81.0, 57.0, -154.0, -5.0, -96.0, -96.0, 60.0, 177.0, -209.0, 31.0, 127.0, -103.0, -237.0, -298.0, 292.0, 103.0, -122.0, 77.0, -138.0, -345.0, -1.0, -30.0, 57.0, 141.0, -69.0, -18.0, 44.0, -268.0, 26.0, -48.0, -54.0, 23.0, -352.0, -66.0, 0.0, -95.0, -57.0, 0.0, -303.0, -238.0, 0.0, -75.0, -134.0, 58.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-51.0, 147.0, -71.0, -348.0, -292.0, 151.0, 170.0, 125.0, 167.0, -19.0, -66.0, -76.0, 184.0, -286.0, -2.0, -395.0, 0.0, 0.0, 29.0, 120.0, -32.0, 159.0, -66.0, 145.0, 167.0, 0.0, 0.0, 0.0, 108.0, 142.0, -92.0, -98.0, 158.0, 95.0, 180.0, 166.0, -261.0, 34.0, -52.0, -388.0, -179.0, -21.0, 9.0, 45.0, -179.0, 55.0, 119.0, 49.0, -24.0, 0.0, -392.0, 91.0, -287.0, -337.0, -80.0, -260.0, 153.0, 0.0, -42.0, -14.0, 9.0, 0.0, 140.0, 97.0, 25.0, 165.0, -38.0, -32.0, 176.0, 105.0, 151.0, 0.0, -374.0, 12.0, -328.0, -177.0, 20.0, -79.0, 51.0, -228.0, 20.0, -223.0, 48.0, 0.0, 0.0, -6.0, -24.0, 9.0, 33.0, 78.0, -239.0, -41.0, -26.0, -312.0, -14.0, 144.0, 0.0, 43.0, -35.0, 0.0, 6.0, -118.0, -74.0, -26.0, -20.0, -53.0, 0.0, -14.0, -187.0, 123.0, 45.0, -350.0, 40.0, 0.0, 0.0, -11.0, -34.0, -400.0, -15.0, -132.0, 0.0, -246.0, -181.0, -75.0, 0.0, -46.0, -45.0, 89.0, -301.0, -219.0, -158.0, 19.0, 12.0, 105.0, 0.0, -400.0, -233.0, -185.0, -360.0, -229.0, 142.0, 134.0, 51.0, -11.0, 7.0, -376.0, 0.0, 49.0, -321.0, 0.0, -350.0, -269.0, 0.0, -2.0, 0.0, -70.0, -63.0, 17.0, -40.0, 95.0, -63.0, -174.0, -18.0, -99.0, 8.0, 0.0, -136.0, -302.0, -72.0, 0.0, 0.0, -395.0, -128.0, -155.0, -178.0, 56.0, -346.0, -373.0, 0.0, -251.0, 0.0, 0.0, -8.0, -332.0, -158.0, -23.0, 0.0, 0.0, -392.0, -180.0, -200.0, -142.0, 0.0, 0.0, -141.0, -109.0, -400.0, -95.0, 0.0, -136.0], "policy_predator_policy_reward": [42.0, 48.0, 154.0, 110.0, 159.0, 7.0, 16.0, 3.0, 68.0, 1.0, 45.0, 0.0, 128.0, 47.0, 126.0, 186.0, 0.0, 0.0, 54.0, 27.0, 17.0, 10.0, 1.0, 51.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 56.0, 0.0, 0.0, 12.0, 5.0, 6.0, 94.0, 129.0, 156.0, 156.0, 80.0, 79.0, 1.0, 29.0, 120.0, 10.0, 9.0, 21.0, 0.0, 12.0, 193.0, 167.0, 175.0, 177.0, 177.0, 9.0, 6.0, 4.0, 0.0, 22.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 18.0, 61.0, 9.0, 15.0, 0.0, 13.0, 162.0, 185.0, 179.0, 15.0, 17.0, 56.0, 118.0, 86.0, 131.0, 0.0, 31.0, 15.0, 30.0, 15.0, 58.0, 64.0, 15.0, 55.0, 113.0, 103.0, 157.0, 85.0, 7.0, 11.0, 0.0, 17.0, 0.0, 27.0, 88.0, 0.0, 36.0, 95.0, 81.0, 13.0, 0.0, 18.0, 66.0, 92.0, 167.0, 19.0, 36.0, 5.0, 14.0, 54.0, 83.0, 197.0, 124.0, 18.0, 96.0, 54.0, 106.0, 54.0, 57.0, 49.0, 67.0, 66.0, 148.0, 163.0, 56.0, 114.0, 9.0, 1.0, 97.0, 200.0, 13.0, 168.0, 111.0, 180.0, 5.0, 11.0, 48.0, 15.0, 53.0, 194.0, 28.0, 0.0, 167.0, 16.0, 182.0, 92.0, 1.0, 0.0, 13.0, 27.0, 79.0, 24.0, 46.0, 40.0, 75.0, 93.0, 23.0, 76.0, 6.0, 30.0, 0.0, 170.0, 30.0, 68.0, 194.0, 153.0, 170.0, 59.0, 107.0, 38.0, 199.0, 168.0, 50.0, 135.0, 0.0, 0.0, 167.0, 78.0, 93.0, 31.0, 0.0, 0.0, 84.0, 185.0, 104.0, 0.0, 0.0, 0.0, 81.0, 94.0, 165.0, 196.0, 83.0, 111.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0401578296598084, "mean_inference_ms": 3.2675263951117226, "mean_action_processing_ms": 0.4688684604715581, "mean_env_wait_ms": 0.3728593300003274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011356830596923828, "StateBufferConnector_ms": 0.008800625801086426, "ViewRequirementAgentConnector_ms": 0.1737685203552246}, "num_episodes": 18, "episode_return_max": 357.0, "episode_return_min": -352.0, "episode_return_mean": 5.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.4430379073781, "num_env_steps_trained_throughput_per_sec": 293.4430379073781, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 13550.323, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13550.263, "sample_time_ms": 2355.967, "learn_time_ms": 11172.178, "learn_throughput": 358.032, "synch_weights_time_ms": 18.58}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "e1352_00002", "date": "2024-08-13_19-39-36", "timestamp": 1723592376, "time_this_iter_s": 13.647126913070679, "time_total_s": 2265.3264315128326, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e7ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2265.3264315128326, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 62.425, "ram_util_percent": 79.74499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.296621088833405, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 7.575393084874229, "policy_loss": -0.0004754133010036731, "vf_loss": 7.575603632699876, "vf_explained_var": -0.0098023220975563, "kl": 0.008818746625171566, "entropy": 0.884290102076909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.88257908351207, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.362744626797065, "policy_loss": 0.00013050622006178532, "vf_loss": 8.362604122313241, "vf_explained_var": -0.6216672006107512, "kl": 0.00799053851753074, "entropy": 0.8413794589105738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 305.0, "episode_reward_min": -352.0, "episode_reward_mean": -22.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -81.885, "predator_policy": 70.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -128.0, -41.0, 84.0, 6.0, 198.0, -12.0, 59.0, -272.0, -154.0, 163.0, -34.0, 9.0, 245.0, 190.0, 9.0, 305.0, 164.0, -15.0, -311.0, 14.0, 27.0, -72.0, 94.0, 39.0, 107.0, 181.0, -64.0, -96.0, 148.0, 60.0, -8.0, -24.0, 31.0, 21.0, 4.0, 94.0, -119.0, 81.0, 57.0, -154.0, -5.0, -96.0, -96.0, 60.0, 177.0, -209.0, 31.0, 127.0, -103.0, -237.0, -298.0, 292.0, 103.0, -122.0, 77.0, -138.0, -345.0, -1.0, -30.0, 57.0, 141.0, -69.0, -18.0, 44.0, -268.0, 26.0, -48.0, -54.0, 23.0, -352.0, -66.0, 0.0, -95.0, -57.0, 0.0, -303.0, -238.0, 0.0, -75.0, -134.0, 58.0, -221.0, -270.0, -127.0, -118.0, 1.0, -31.0, 30.0, 30.0, -78.0, 36.0, 55.0, -100.0, -66.0, 111.0, -58.0, -21.0, -182.0, 137.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-261.0, 34.0, -52.0, -388.0, -179.0, -21.0, 9.0, 45.0, -179.0, 55.0, 119.0, 49.0, -24.0, 0.0, -392.0, 91.0, -287.0, -337.0, -80.0, -260.0, 153.0, 0.0, -42.0, -14.0, 9.0, 0.0, 140.0, 97.0, 25.0, 165.0, -38.0, -32.0, 176.0, 105.0, 151.0, 0.0, -374.0, 12.0, -328.0, -177.0, 20.0, -79.0, 51.0, -228.0, 20.0, -223.0, 48.0, 0.0, 0.0, -6.0, -24.0, 9.0, 33.0, 78.0, -239.0, -41.0, -26.0, -312.0, -14.0, 144.0, 0.0, 43.0, -35.0, 0.0, 6.0, -118.0, -74.0, -26.0, -20.0, -53.0, 0.0, -14.0, -187.0, 123.0, 45.0, -350.0, 40.0, 0.0, 0.0, -11.0, -34.0, -400.0, -15.0, -132.0, 0.0, -246.0, -181.0, -75.0, 0.0, -46.0, -45.0, 89.0, -301.0, -219.0, -158.0, 19.0, 12.0, 105.0, 0.0, -400.0, -233.0, -185.0, -360.0, -229.0, 142.0, 134.0, 51.0, -11.0, 7.0, -376.0, 0.0, 49.0, -321.0, 0.0, -350.0, -269.0, 0.0, -2.0, 0.0, -70.0, -63.0, 17.0, -40.0, 95.0, -63.0, -174.0, -18.0, -99.0, 8.0, 0.0, -136.0, -302.0, -72.0, 0.0, 0.0, -395.0, -128.0, -155.0, -178.0, 56.0, -346.0, -373.0, 0.0, -251.0, 0.0, 0.0, -8.0, -332.0, -158.0, -23.0, 0.0, 0.0, -392.0, -180.0, -200.0, -142.0, 0.0, 0.0, -141.0, -109.0, -400.0, -95.0, 0.0, -136.0, -169.0, -364.0, -311.0, -254.0, -373.0, 0.0, -103.0, -198.0, -213.0, 0.0, 0.0, -150.0, -90.0, 41.0, -345.0, 94.0, -6.0, -280.0, 9.0, 0.0, 50.0, 0.0, -142.0, -201.0, -348.0, 0.0, 47.0, 20.0, -138.0, -61.0, 40.0, -169.0, -398.0, 0.0, 52.0, 16.0], "policy_predator_policy_reward": [94.0, 129.0, 156.0, 156.0, 80.0, 79.0, 1.0, 29.0, 120.0, 10.0, 9.0, 21.0, 0.0, 12.0, 193.0, 167.0, 175.0, 177.0, 177.0, 9.0, 6.0, 4.0, 0.0, 22.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 18.0, 61.0, 9.0, 15.0, 0.0, 13.0, 162.0, 185.0, 179.0, 15.0, 17.0, 56.0, 118.0, 86.0, 131.0, 0.0, 31.0, 15.0, 30.0, 15.0, 58.0, 64.0, 15.0, 55.0, 113.0, 103.0, 157.0, 85.0, 7.0, 11.0, 0.0, 17.0, 0.0, 27.0, 88.0, 0.0, 36.0, 95.0, 81.0, 13.0, 0.0, 18.0, 66.0, 92.0, 167.0, 19.0, 36.0, 5.0, 14.0, 54.0, 83.0, 197.0, 124.0, 18.0, 96.0, 54.0, 106.0, 54.0, 57.0, 49.0, 67.0, 66.0, 148.0, 163.0, 56.0, 114.0, 9.0, 1.0, 97.0, 200.0, 13.0, 168.0, 111.0, 180.0, 5.0, 11.0, 48.0, 15.0, 53.0, 194.0, 28.0, 0.0, 167.0, 16.0, 182.0, 92.0, 1.0, 0.0, 13.0, 27.0, 79.0, 24.0, 46.0, 40.0, 75.0, 93.0, 23.0, 76.0, 6.0, 30.0, 0.0, 170.0, 30.0, 68.0, 194.0, 153.0, 170.0, 59.0, 107.0, 38.0, 199.0, 168.0, 50.0, 135.0, 0.0, 0.0, 167.0, 78.0, 93.0, 31.0, 0.0, 0.0, 84.0, 185.0, 104.0, 0.0, 0.0, 0.0, 81.0, 94.0, 165.0, 196.0, 83.0, 111.0, 124.0, 188.0, 145.0, 150.0, 129.0, 117.0, 112.0, 71.0, 83.0, 131.0, 108.0, 11.0, 4.0, 75.0, 178.0, 103.0, 112.0, 96.0, 11.0, 16.0, 5.0, 0.0, 154.0, 89.0, 116.0, 166.0, 38.0, 6.0, 111.0, 30.0, 6.0, 102.0, 17.0, 199.0, 51.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0396658390007298, "mean_inference_ms": 3.2675757752159353, "mean_action_processing_ms": 0.46809150611290334, "mean_env_wait_ms": 0.3725507189149119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010770440101623535, "StateBufferConnector_ms": 0.00868678092956543, "ViewRequirementAgentConnector_ms": 0.15643370151519775}, "num_episodes": 18, "episode_return_max": 305.0, "episode_return_min": -352.0, "episode_return_mean": -22.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.10062497305313, "num_env_steps_trained_throughput_per_sec": 325.10062497305313, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 13354.884, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13354.824, "sample_time_ms": 2317.55, "learn_time_ms": 11014.784, "learn_throughput": 363.148, "synch_weights_time_ms": 18.764}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "e1352_00002", "date": "2024-08-13_19-39-48", "timestamp": 1723592388, "time_this_iter_s": 12.354337215423584, "time_total_s": 2277.680768728256, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e7c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2277.680768728256, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 63.74117647058823, "ram_util_percent": 74.78823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2128101801194213, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 7.951010661150413, "policy_loss": -0.003792855234954644, "vf_loss": 7.954556444208458, "vf_explained_var": 0.0010722226882107044, "kl": 0.008226870040293146, "entropy": 0.9165842817889319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.79847927916617, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.684718220322221, "policy_loss": -0.0025565373859116956, "vf_loss": 8.687256525180958, "vf_explained_var": -0.488545209137851, "kl": 0.014580244475580519, "entropy": 0.7918388737887933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 292.0, "episode_reward_min": -352.0, "episode_reward_mean": -41.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 144.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -101.335, "predator_policy": 80.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.0, 94.0, 39.0, 107.0, 181.0, -64.0, -96.0, 148.0, 60.0, -8.0, -24.0, 31.0, 21.0, 4.0, 94.0, -119.0, 81.0, 57.0, -154.0, -5.0, -96.0, -96.0, 60.0, 177.0, -209.0, 31.0, 127.0, -103.0, -237.0, -298.0, 292.0, 103.0, -122.0, 77.0, -138.0, -345.0, -1.0, -30.0, 57.0, 141.0, -69.0, -18.0, 44.0, -268.0, 26.0, -48.0, -54.0, 23.0, -352.0, -66.0, 0.0, -95.0, -57.0, 0.0, -303.0, -238.0, 0.0, -75.0, -134.0, 58.0, -221.0, -270.0, -127.0, -118.0, 1.0, -31.0, 30.0, 30.0, -78.0, 36.0, 55.0, -100.0, -66.0, 111.0, -58.0, -21.0, -182.0, 137.0, 49.0, 61.0, -64.0, -219.0, -149.0, 19.0, -192.0, -344.0, 71.0, -92.0, 47.0, 79.0, 0.0, 27.0, 103.0, -92.0, -275.0, -214.0, -346.0, 41.0, -11.0, 83.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.0, -223.0, 48.0, 0.0, 0.0, -6.0, -24.0, 9.0, 33.0, 78.0, -239.0, -41.0, -26.0, -312.0, -14.0, 144.0, 0.0, 43.0, -35.0, 0.0, 6.0, -118.0, -74.0, -26.0, -20.0, -53.0, 0.0, -14.0, -187.0, 123.0, 45.0, -350.0, 40.0, 0.0, 0.0, -11.0, -34.0, -400.0, -15.0, -132.0, 0.0, -246.0, -181.0, -75.0, 0.0, -46.0, -45.0, 89.0, -301.0, -219.0, -158.0, 19.0, 12.0, 105.0, 0.0, -400.0, -233.0, -185.0, -360.0, -229.0, 142.0, 134.0, 51.0, -11.0, 7.0, -376.0, 0.0, 49.0, -321.0, 0.0, -350.0, -269.0, 0.0, -2.0, 0.0, -70.0, -63.0, 17.0, -40.0, 95.0, -63.0, -174.0, -18.0, -99.0, 8.0, 0.0, -136.0, -302.0, -72.0, 0.0, 0.0, -395.0, -128.0, -155.0, -178.0, 56.0, -346.0, -373.0, 0.0, -251.0, 0.0, 0.0, -8.0, -332.0, -158.0, -23.0, 0.0, 0.0, -392.0, -180.0, -200.0, -142.0, 0.0, 0.0, -141.0, -109.0, -400.0, -95.0, 0.0, -136.0, -169.0, -364.0, -311.0, -254.0, -373.0, 0.0, -103.0, -198.0, -213.0, 0.0, 0.0, -150.0, -90.0, 41.0, -345.0, 94.0, -6.0, -280.0, 9.0, 0.0, 50.0, 0.0, -142.0, -201.0, -348.0, 0.0, 47.0, 20.0, -138.0, -61.0, 40.0, -169.0, -398.0, 0.0, 52.0, 16.0, 49.0, 0.0, 69.0, -50.0, -360.0, 33.0, -182.0, -337.0, -123.0, -281.0, -185.0, 57.0, -95.0, -328.0, -321.0, -286.0, 21.0, -112.0, -289.0, -114.0, 120.0, -309.0, 0.0, 32.0, -206.0, 0.0, 49.0, -215.0, 44.0, -99.0, -386.0, -66.0, -362.0, -167.0, -188.0, -280.0, -376.0, -353.0, -332.0, 85.0, -6.0, -216.0, -113.0, 22.0], "policy_predator_policy_reward": [131.0, 0.0, 31.0, 15.0, 30.0, 15.0, 58.0, 64.0, 15.0, 55.0, 113.0, 103.0, 157.0, 85.0, 7.0, 11.0, 0.0, 17.0, 0.0, 27.0, 88.0, 0.0, 36.0, 95.0, 81.0, 13.0, 0.0, 18.0, 66.0, 92.0, 167.0, 19.0, 36.0, 5.0, 14.0, 54.0, 83.0, 197.0, 124.0, 18.0, 96.0, 54.0, 106.0, 54.0, 57.0, 49.0, 67.0, 66.0, 148.0, 163.0, 56.0, 114.0, 9.0, 1.0, 97.0, 200.0, 13.0, 168.0, 111.0, 180.0, 5.0, 11.0, 48.0, 15.0, 53.0, 194.0, 28.0, 0.0, 167.0, 16.0, 182.0, 92.0, 1.0, 0.0, 13.0, 27.0, 79.0, 24.0, 46.0, 40.0, 75.0, 93.0, 23.0, 76.0, 6.0, 30.0, 0.0, 170.0, 30.0, 68.0, 194.0, 153.0, 170.0, 59.0, 107.0, 38.0, 199.0, 168.0, 50.0, 135.0, 0.0, 0.0, 167.0, 78.0, 93.0, 31.0, 0.0, 0.0, 84.0, 185.0, 104.0, 0.0, 0.0, 0.0, 81.0, 94.0, 165.0, 196.0, 83.0, 111.0, 124.0, 188.0, 145.0, 150.0, 129.0, 117.0, 112.0, 71.0, 83.0, 131.0, 108.0, 11.0, 4.0, 75.0, 178.0, 103.0, 112.0, 96.0, 11.0, 16.0, 5.0, 0.0, 154.0, 89.0, 116.0, 166.0, 38.0, 6.0, 111.0, 30.0, 6.0, 102.0, 17.0, 199.0, 51.0, 18.0, 0.0, 0.0, 0.0, 42.0, 81.0, 182.0, 115.0, 185.0, 156.0, 99.0, 118.0, 29.0, 149.0, 82.0, 121.0, 142.0, 92.0, 70.0, 149.0, 162.0, 109.0, 127.0, 13.0, 34.0, 131.0, 75.0, 90.0, 103.0, 89.0, 69.0, 169.0, 191.0, 184.0, 70.0, 139.0, 115.0, 192.0, 191.0, 110.0, 178.0, 125.0, 86.0, 111.0, 63.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.03932378367576, "mean_inference_ms": 3.268168685830415, "mean_action_processing_ms": 0.4671721188103453, "mean_env_wait_ms": 0.3722344713125535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014965534210205078, "StateBufferConnector_ms": 0.007291913032531738, "ViewRequirementAgentConnector_ms": 0.16337907314300537}, "num_episodes": 22, "episode_return_max": 292.0, "episode_return_min": -352.0, "episode_return_mean": -41.51, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.74919052238334, "num_env_steps_trained_throughput_per_sec": 300.74919052238334, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 13480.138, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13480.09, "sample_time_ms": 2269.073, "learn_time_ms": 11189.946, "learn_throughput": 357.464, "synch_weights_time_ms": 17.735}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "e1352_00002", "date": "2024-08-13_19-40-01", "timestamp": 1723592401, "time_this_iter_s": 13.320577144622803, "time_total_s": 2291.001345872879, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d411f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2291.001345872879, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 62.821052631578944, "ram_util_percent": 78.10526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1793848689113346, "cur_kl_coeff": 0.030033874511718742, "cur_lr": 0.00010000000000000003, "total_loss": 7.818830998738607, "policy_loss": -0.002200430594557137, "vf_loss": 7.820763882127388, "vf_explained_var": -0.012855859565987159, "kl": 0.008907880305778085, "entropy": 0.9424785119200509, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.757773014824224, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 0.00010000000000000003, "total_loss": 8.790262649929712, "policy_loss": -0.000503162207899901, "vf_loss": 8.79075398369441, "vf_explained_var": -0.4293181201137563, "kl": 0.00944379209925085, "entropy": 0.7919349842916721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 292.0, "episode_reward_min": -405.0, "episode_reward_mean": -46.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -109.44, "predator_policy": 86.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154.0, -5.0, -96.0, -96.0, 60.0, 177.0, -209.0, 31.0, 127.0, -103.0, -237.0, -298.0, 292.0, 103.0, -122.0, 77.0, -138.0, -345.0, -1.0, -30.0, 57.0, 141.0, -69.0, -18.0, 44.0, -268.0, 26.0, -48.0, -54.0, 23.0, -352.0, -66.0, 0.0, -95.0, -57.0, 0.0, -303.0, -238.0, 0.0, -75.0, -134.0, 58.0, -221.0, -270.0, -127.0, -118.0, 1.0, -31.0, 30.0, 30.0, -78.0, 36.0, 55.0, -100.0, -66.0, 111.0, -58.0, -21.0, -182.0, 137.0, 49.0, 61.0, -64.0, -219.0, -149.0, 19.0, -192.0, -344.0, 71.0, -92.0, 47.0, 79.0, 0.0, 27.0, 103.0, -92.0, -275.0, -214.0, -346.0, 41.0, -11.0, 83.0, -58.0, 203.0, 238.0, -32.0, -47.0, 114.0, 214.0, -405.0, 0.0, 234.0, 0.0, 31.0, -114.0, 97.0, -40.0, -189.0, 7.0, -191.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.0, -400.0, -15.0, -132.0, 0.0, -246.0, -181.0, -75.0, 0.0, -46.0, -45.0, 89.0, -301.0, -219.0, -158.0, 19.0, 12.0, 105.0, 0.0, -400.0, -233.0, -185.0, -360.0, -229.0, 142.0, 134.0, 51.0, -11.0, 7.0, -376.0, 0.0, 49.0, -321.0, 0.0, -350.0, -269.0, 0.0, -2.0, 0.0, -70.0, -63.0, 17.0, -40.0, 95.0, -63.0, -174.0, -18.0, -99.0, 8.0, 0.0, -136.0, -302.0, -72.0, 0.0, 0.0, -395.0, -128.0, -155.0, -178.0, 56.0, -346.0, -373.0, 0.0, -251.0, 0.0, 0.0, -8.0, -332.0, -158.0, -23.0, 0.0, 0.0, -392.0, -180.0, -200.0, -142.0, 0.0, 0.0, -141.0, -109.0, -400.0, -95.0, 0.0, -136.0, -169.0, -364.0, -311.0, -254.0, -373.0, 0.0, -103.0, -198.0, -213.0, 0.0, 0.0, -150.0, -90.0, 41.0, -345.0, 94.0, -6.0, -280.0, 9.0, 0.0, 50.0, 0.0, -142.0, -201.0, -348.0, 0.0, 47.0, 20.0, -138.0, -61.0, 40.0, -169.0, -398.0, 0.0, 52.0, 16.0, 49.0, 0.0, 69.0, -50.0, -360.0, 33.0, -182.0, -337.0, -123.0, -281.0, -185.0, 57.0, -95.0, -328.0, -321.0, -286.0, 21.0, -112.0, -289.0, -114.0, 120.0, -309.0, 0.0, 32.0, -206.0, 0.0, 49.0, -215.0, 44.0, -99.0, -386.0, -66.0, -362.0, -167.0, -188.0, -280.0, -376.0, -353.0, -332.0, 85.0, -6.0, -216.0, -113.0, 22.0, 0.0, -366.0, 137.0, -135.0, 198.0, 33.0, -30.0, -385.0, -218.0, 7.0, -42.0, 128.0, 55.0, 91.0, -379.0, -343.0, 0.0, 0.0, 14.0, 74.0, 0.0, 0.0, -8.0, -148.0, -208.0, -156.0, 2.0, -14.0, -170.0, 3.0, -154.0, -162.0, 99.0, -250.0, -165.0, -313.0], "policy_predator_policy_reward": [83.0, 197.0, 124.0, 18.0, 96.0, 54.0, 106.0, 54.0, 57.0, 49.0, 67.0, 66.0, 148.0, 163.0, 56.0, 114.0, 9.0, 1.0, 97.0, 200.0, 13.0, 168.0, 111.0, 180.0, 5.0, 11.0, 48.0, 15.0, 53.0, 194.0, 28.0, 0.0, 167.0, 16.0, 182.0, 92.0, 1.0, 0.0, 13.0, 27.0, 79.0, 24.0, 46.0, 40.0, 75.0, 93.0, 23.0, 76.0, 6.0, 30.0, 0.0, 170.0, 30.0, 68.0, 194.0, 153.0, 170.0, 59.0, 107.0, 38.0, 199.0, 168.0, 50.0, 135.0, 0.0, 0.0, 167.0, 78.0, 93.0, 31.0, 0.0, 0.0, 84.0, 185.0, 104.0, 0.0, 0.0, 0.0, 81.0, 94.0, 165.0, 196.0, 83.0, 111.0, 124.0, 188.0, 145.0, 150.0, 129.0, 117.0, 112.0, 71.0, 83.0, 131.0, 108.0, 11.0, 4.0, 75.0, 178.0, 103.0, 112.0, 96.0, 11.0, 16.0, 5.0, 0.0, 154.0, 89.0, 116.0, 166.0, 38.0, 6.0, 111.0, 30.0, 6.0, 102.0, 17.0, 199.0, 51.0, 18.0, 0.0, 0.0, 0.0, 42.0, 81.0, 182.0, 115.0, 185.0, 156.0, 99.0, 118.0, 29.0, 149.0, 82.0, 121.0, 142.0, 92.0, 70.0, 149.0, 162.0, 109.0, 127.0, 13.0, 34.0, 131.0, 75.0, 90.0, 103.0, 89.0, 69.0, 169.0, 191.0, 184.0, 70.0, 139.0, 115.0, 192.0, 191.0, 110.0, 178.0, 125.0, 86.0, 111.0, 63.0, 181.0, 127.0, 91.0, 110.0, 0.0, 7.0, 194.0, 189.0, 45.0, 119.0, 7.0, 21.0, 37.0, 31.0, 193.0, 124.0, 0.0, 0.0, 78.0, 68.0, 0.0, 0.0, 118.0, 69.0, 142.0, 108.0, 78.0, 31.0, 97.0, 30.0, 48.0, 79.0, 148.0, 10.0, 116.0, 171.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0384139973978956, "mean_inference_ms": 3.2671791896589673, "mean_action_processing_ms": 0.4663013993551516, "mean_env_wait_ms": 0.3718862051822828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014536619186401367, "StateBufferConnector_ms": 0.0062713623046875, "ViewRequirementAgentConnector_ms": 0.1568131446838379}, "num_episodes": 18, "episode_return_max": 292.0, "episode_return_min": -405.0, "episode_return_mean": -46.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.80415394398204, "num_env_steps_trained_throughput_per_sec": 310.80415394398204, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 13370.314, "restore_workers_time_ms": 0.018, "training_step_time_ms": 13370.253, "sample_time_ms": 2263.329, "learn_time_ms": 11086.347, "learn_throughput": 360.804, "synch_weights_time_ms": 18.008}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "e1352_00002", "date": "2024-08-13_19-40-14", "timestamp": 1723592414, "time_this_iter_s": 12.914543867111206, "time_total_s": 2303.9158897399902, "pid": 29307, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d13160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2303.9158897399902, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 63.15263157894737, "ram_util_percent": 77.33157894736841}}
